(function(){const et=document.createElement("link").relList;if(et&&et.supports&&et.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))G(W);new MutationObserver(W=>{for(const d of W)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&G(v)}).observe(document,{childList:!0,subtree:!0});function m(W){const d={};return W.integrity&&(d.integrity=W.integrity),W.referrerpolicy&&(d.referrerPolicy=W.referrerpolicy),W.crossorigin==="use-credentials"?d.credentials="include":W.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function G(W){if(W.ep)return;W.ep=!0;const d=m(W);fetch(W.href,d)}})();function Uh(Pe,et){const m=Object.create(null),G=Pe.split(",");for(let W=0;W<G.length;W++)m[G[W]]=!0;return et?W=>!!m[W.toLowerCase()]:W=>!!m[W]}const zg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Rg=Uh(zg);function h0(Pe){return!!Pe||Pe===""}function Vh(Pe){if(ta(Pe)){const et={};for(let m=0;m<Pe.length;m++){const G=Pe[m],W=os(G)?Ng(G):Vh(G);if(W)for(const d in W)et[d]=W[d]}return et}else{if(os(Pe))return Pe;if(Oo(Pe))return Pe}}const Fg=/;(?![^(]*\))/g,Bg=/:(.+)/;function Ng(Pe){const et={};return Pe.split(Fg).forEach(m=>{if(m){const G=m.split(Bg);G.length>1&&(et[G[0].trim()]=G[1].trim())}}),et}function Hh(Pe){let et="";if(os(Pe))et=Pe;else if(ta(Pe))for(let m=0;m<Pe.length;m++){const G=Hh(Pe[m]);G&&(et+=G+" ")}else if(Oo(Pe))for(const m in Pe)Pe[m]&&(et+=m+" ");return et.trim()}const Xa={},Nc=[],el=()=>{},jg=()=>!1,Ug=/^on[^a-z]/,Tf=Pe=>Ug.test(Pe),qh=Pe=>Pe.startsWith("onUpdate:"),as=Object.assign,Gh=(Pe,et)=>{const m=Pe.indexOf(et);m>-1&&Pe.splice(m,1)},Vg=Object.prototype.hasOwnProperty,fa=(Pe,et)=>Vg.call(Pe,et),ta=Array.isArray,vu=Pe=>kf(Pe)==="[object Map]",Hg=Pe=>kf(Pe)==="[object Set]",la=Pe=>typeof Pe=="function",os=Pe=>typeof Pe=="string",Yh=Pe=>typeof Pe=="symbol",Oo=Pe=>Pe!==null&&typeof Pe=="object",p0=Pe=>Oo(Pe)&&la(Pe.then)&&la(Pe.catch),qg=Object.prototype.toString,kf=Pe=>qg.call(Pe),Gg=Pe=>kf(Pe).slice(8,-1),Yg=Pe=>kf(Pe)==="[object Object]",Wh=Pe=>os(Pe)&&Pe!=="NaN"&&Pe[0]!=="-"&&""+parseInt(Pe,10)===Pe,df=Uh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Mf=Pe=>{const et=Object.create(null);return m=>et[m]||(et[m]=Pe(m))},Wg=/-(\w)/g,Vc=Mf(Pe=>Pe.replace(Wg,(et,m)=>m?m.toUpperCase():"")),Zg=/\B([A-Z])/g,qc=Mf(Pe=>Pe.replace(Zg,"-$1").toLowerCase()),d0=Mf(Pe=>Pe.charAt(0).toUpperCase()+Pe.slice(1)),yh=Mf(Pe=>Pe?`on${d0(Pe)}`:""),yf=(Pe,et)=>!Object.is(Pe,et),xh=(Pe,et)=>{for(let m=0;m<Pe.length;m++)Pe[m](et)},xf=(Pe,et,m)=>{Object.defineProperty(Pe,et,{configurable:!0,enumerable:!1,value:m})},Xg=Pe=>{const et=parseFloat(Pe);return isNaN(et)?Pe:et};let Bd;const Kg=()=>Bd||(Bd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let fl;class Jg{constructor(et=!1){this.detached=et,this.active=!0,this.effects=[],this.cleanups=[],this.parent=fl,!et&&fl&&(this.index=(fl.scopes||(fl.scopes=[])).push(this)-1)}run(et){if(this.active){const m=fl;try{return fl=this,et()}finally{fl=m}}}on(){fl=this}off(){fl=this.parent}stop(et){if(this.active){let m,G;for(m=0,G=this.effects.length;m<G;m++)this.effects[m].stop();for(m=0,G=this.cleanups.length;m<G;m++)this.cleanups[m]();if(this.scopes)for(m=0,G=this.scopes.length;m<G;m++)this.scopes[m].stop(!0);if(!this.detached&&this.parent&&!et){const W=this.parent.scopes.pop();W&&W!==this&&(this.parent.scopes[this.index]=W,W.index=this.index)}this.parent=void 0,this.active=!1}}}function $g(Pe,et=fl){et&&et.active&&et.effects.push(Pe)}const Zh=Pe=>{const et=new Set(Pe);return et.w=0,et.n=0,et},m0=Pe=>(Pe.w&Ul)>0,g0=Pe=>(Pe.n&Ul)>0,Qg=({deps:Pe})=>{if(Pe.length)for(let et=0;et<Pe.length;et++)Pe[et].w|=Ul},e1=Pe=>{const{deps:et}=Pe;if(et.length){let m=0;for(let G=0;G<et.length;G++){const W=et[G];m0(W)&&!g0(W)?W.delete(Pe):et[m++]=W,W.w&=~Ul,W.n&=~Ul}et.length=m}},Sh=new WeakMap;let gu=0,Ul=1;const Eh=30;let $s;const lc=Symbol(""),Lh=Symbol("");class Xh{constructor(et,m=null,G){this.fn=et,this.scheduler=m,this.active=!0,this.deps=[],this.parent=void 0,$g(this,G)}run(){if(!this.active)return this.fn();let et=$s,m=Nl;for(;et;){if(et===this)return;et=et.parent}try{return this.parent=$s,$s=this,Nl=!0,Ul=1<<++gu,gu<=Eh?Qg(this):Nd(this),this.fn()}finally{gu<=Eh&&e1(this),Ul=1<<--gu,$s=this.parent,Nl=m,this.parent=void 0,this.deferStop&&this.stop()}}stop(){$s===this?this.deferStop=!0:this.active&&(Nd(this),this.onStop&&this.onStop(),this.active=!1)}}function Nd(Pe){const{deps:et}=Pe;if(et.length){for(let m=0;m<et.length;m++)et[m].delete(Pe);et.length=0}}let Nl=!0;const v0=[];function Gc(){v0.push(Nl),Nl=!1}function Yc(){const Pe=v0.pop();Nl=Pe===void 0?!0:Pe}function Ls(Pe,et,m){if(Nl&&$s){let G=Sh.get(Pe);G||Sh.set(Pe,G=new Map);let W=G.get(m);W||G.set(m,W=Zh()),y0(W)}}function y0(Pe,et){let m=!1;gu<=Eh?g0(Pe)||(Pe.n|=Ul,m=!m0(Pe)):m=!Pe.has($s),m&&(Pe.add($s),$s.deps.push(Pe))}function Ml(Pe,et,m,G,W,d){const v=Sh.get(Pe);if(!v)return;let w=[];if(et==="clear")w=[...v.values()];else if(m==="length"&&ta(Pe))v.forEach((y,e)=>{(e==="length"||e>=G)&&w.push(y)});else switch(m!==void 0&&w.push(v.get(m)),et){case"add":ta(Pe)?Wh(m)&&w.push(v.get("length")):(w.push(v.get(lc)),vu(Pe)&&w.push(v.get(Lh)));break;case"delete":ta(Pe)||(w.push(v.get(lc)),vu(Pe)&&w.push(v.get(Lh)));break;case"set":vu(Pe)&&w.push(v.get(lc));break}if(w.length===1)w[0]&&Ch(w[0]);else{const y=[];for(const e of w)e&&y.push(...e);Ch(Zh(y))}}function Ch(Pe,et){const m=ta(Pe)?Pe:[...Pe];for(const G of m)G.computed&&jd(G);for(const G of m)G.computed||jd(G)}function jd(Pe,et){(Pe!==$s||Pe.allowRecurse)&&(Pe.scheduler?Pe.scheduler():Pe.run())}const t1=Uh("__proto__,__v_isRef,__isVue"),x0=new Set(Object.getOwnPropertyNames(Symbol).filter(Pe=>Pe!=="arguments"&&Pe!=="caller").map(Pe=>Symbol[Pe]).filter(Yh)),r1=Kh(),n1=Kh(!1,!0),i1=Kh(!0),Ud=a1();function a1(){const Pe={};return["includes","indexOf","lastIndexOf"].forEach(et=>{Pe[et]=function(...m){const G=Da(this);for(let d=0,v=this.length;d<v;d++)Ls(G,"get",d+"");const W=G[et](...m);return W===-1||W===!1?G[et](...m.map(Da)):W}}),["push","pop","shift","unshift","splice"].forEach(et=>{Pe[et]=function(...m){Gc();const G=Da(this)[et].apply(this,m);return Yc(),G}}),Pe}function Kh(Pe=!1,et=!1){return function(G,W,d){if(W==="__v_isReactive")return!Pe;if(W==="__v_isReadonly")return Pe;if(W==="__v_isShallow")return et;if(W==="__v_raw"&&d===(Pe?et?_1:k0:et?T0:w0).get(G))return G;const v=ta(G);if(!Pe&&v&&fa(Ud,W))return Reflect.get(Ud,W,d);const w=Reflect.get(G,W,d);return(Yh(W)?x0.has(W):t1(W))||(Pe||Ls(G,"get",W),et)?w:gs(w)?v&&Wh(W)?w:w.value:Oo(w)?Pe?M0(w):Qh(w):w}}const o1=b0(),s1=b0(!0);function b0(Pe=!1){return function(m,G,W,d){let v=m[G];if(xu(v)&&gs(v)&&!gs(W))return!1;if(!Pe&&(!Ph(W)&&!xu(W)&&(v=Da(v),W=Da(W)),!ta(m)&&gs(v)&&!gs(W)))return v.value=W,!0;const w=ta(m)&&Wh(G)?Number(G)<m.length:fa(m,G),y=Reflect.set(m,G,W,d);return m===Da(d)&&(w?yf(W,v)&&Ml(m,"set",G,W):Ml(m,"add",G,W)),y}}function l1(Pe,et){const m=fa(Pe,et);Pe[et];const G=Reflect.deleteProperty(Pe,et);return G&&m&&Ml(Pe,"delete",et,void 0),G}function c1(Pe,et){const m=Reflect.has(Pe,et);return(!Yh(et)||!x0.has(et))&&Ls(Pe,"has",et),m}function u1(Pe){return Ls(Pe,"iterate",ta(Pe)?"length":lc),Reflect.ownKeys(Pe)}const _0={get:r1,set:o1,deleteProperty:l1,has:c1,ownKeys:u1},f1={get:i1,set(Pe,et){return!0},deleteProperty(Pe,et){return!0}},h1=as({},_0,{get:n1,set:s1}),Jh=Pe=>Pe,Af=Pe=>Reflect.getPrototypeOf(Pe);function lf(Pe,et,m=!1,G=!1){Pe=Pe.__v_raw;const W=Da(Pe),d=Da(et);m||(et!==d&&Ls(W,"get",et),Ls(W,"get",d));const{has:v}=Af(W),w=G?Jh:m?rp:tp;if(v.call(W,et))return w(Pe.get(et));if(v.call(W,d))return w(Pe.get(d));Pe!==W&&Pe.get(et)}function cf(Pe,et=!1){const m=this.__v_raw,G=Da(m),W=Da(Pe);return et||(Pe!==W&&Ls(G,"has",Pe),Ls(G,"has",W)),Pe===W?m.has(Pe):m.has(Pe)||m.has(W)}function uf(Pe,et=!1){return Pe=Pe.__v_raw,!et&&Ls(Da(Pe),"iterate",lc),Reflect.get(Pe,"size",Pe)}function Vd(Pe){Pe=Da(Pe);const et=Da(this);return Af(et).has.call(et,Pe)||(et.add(Pe),Ml(et,"add",Pe,Pe)),this}function Hd(Pe,et){et=Da(et);const m=Da(this),{has:G,get:W}=Af(m);let d=G.call(m,Pe);d||(Pe=Da(Pe),d=G.call(m,Pe));const v=W.call(m,Pe);return m.set(Pe,et),d?yf(et,v)&&Ml(m,"set",Pe,et):Ml(m,"add",Pe,et),this}function qd(Pe){const et=Da(this),{has:m,get:G}=Af(et);let W=m.call(et,Pe);W||(Pe=Da(Pe),W=m.call(et,Pe)),G&&G.call(et,Pe);const d=et.delete(Pe);return W&&Ml(et,"delete",Pe,void 0),d}function Gd(){const Pe=Da(this),et=Pe.size!==0,m=Pe.clear();return et&&Ml(Pe,"clear",void 0,void 0),m}function ff(Pe,et){return function(G,W){const d=this,v=d.__v_raw,w=Da(v),y=et?Jh:Pe?rp:tp;return!Pe&&Ls(w,"iterate",lc),v.forEach((e,t)=>G.call(W,y(e),y(t),d))}}function hf(Pe,et,m){return function(...G){const W=this.__v_raw,d=Da(W),v=vu(d),w=Pe==="entries"||Pe===Symbol.iterator&&v,y=Pe==="keys"&&v,e=W[Pe](...G),t=m?Jh:et?rp:tp;return!et&&Ls(d,"iterate",y?Lh:lc),{next(){const{value:n,done:a}=e.next();return a?{value:n,done:a}:{value:w?[t(n[0]),t(n[1])]:t(n),done:a}},[Symbol.iterator](){return this}}}}function Fl(Pe){return function(...et){return Pe==="delete"?!1:this}}function p1(){const Pe={get(d){return lf(this,d)},get size(){return uf(this)},has:cf,add:Vd,set:Hd,delete:qd,clear:Gd,forEach:ff(!1,!1)},et={get(d){return lf(this,d,!1,!0)},get size(){return uf(this)},has:cf,add:Vd,set:Hd,delete:qd,clear:Gd,forEach:ff(!1,!0)},m={get(d){return lf(this,d,!0)},get size(){return uf(this,!0)},has(d){return cf.call(this,d,!0)},add:Fl("add"),set:Fl("set"),delete:Fl("delete"),clear:Fl("clear"),forEach:ff(!0,!1)},G={get(d){return lf(this,d,!0,!0)},get size(){return uf(this,!0)},has(d){return cf.call(this,d,!0)},add:Fl("add"),set:Fl("set"),delete:Fl("delete"),clear:Fl("clear"),forEach:ff(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{Pe[d]=hf(d,!1,!1),m[d]=hf(d,!0,!1),et[d]=hf(d,!1,!0),G[d]=hf(d,!0,!0)}),[Pe,m,et,G]}const[d1,m1,g1,v1]=p1();function $h(Pe,et){const m=et?Pe?v1:g1:Pe?m1:d1;return(G,W,d)=>W==="__v_isReactive"?!Pe:W==="__v_isReadonly"?Pe:W==="__v_raw"?G:Reflect.get(fa(m,W)&&W in G?m:G,W,d)}const y1={get:$h(!1,!1)},x1={get:$h(!1,!0)},b1={get:$h(!0,!1)},w0=new WeakMap,T0=new WeakMap,k0=new WeakMap,_1=new WeakMap;function w1(Pe){switch(Pe){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function T1(Pe){return Pe.__v_skip||!Object.isExtensible(Pe)?0:w1(Gg(Pe))}function Qh(Pe){return xu(Pe)?Pe:ep(Pe,!1,_0,y1,w0)}function k1(Pe){return ep(Pe,!1,h1,x1,T0)}function M0(Pe){return ep(Pe,!0,f1,b1,k0)}function ep(Pe,et,m,G,W){if(!Oo(Pe)||Pe.__v_raw&&!(et&&Pe.__v_isReactive))return Pe;const d=W.get(Pe);if(d)return d;const v=T1(Pe);if(v===0)return Pe;const w=new Proxy(Pe,v===2?G:m);return W.set(Pe,w),w}function jc(Pe){return xu(Pe)?jc(Pe.__v_raw):!!(Pe&&Pe.__v_isReactive)}function xu(Pe){return!!(Pe&&Pe.__v_isReadonly)}function Ph(Pe){return!!(Pe&&Pe.__v_isShallow)}function A0(Pe){return jc(Pe)||xu(Pe)}function Da(Pe){const et=Pe&&Pe.__v_raw;return et?Da(et):Pe}function S0(Pe){return xf(Pe,"__v_skip",!0),Pe}const tp=Pe=>Oo(Pe)?Qh(Pe):Pe,rp=Pe=>Oo(Pe)?M0(Pe):Pe;function M1(Pe){Nl&&$s&&(Pe=Da(Pe),y0(Pe.dep||(Pe.dep=Zh())))}function A1(Pe,et){Pe=Da(Pe),Pe.dep&&Ch(Pe.dep)}function gs(Pe){return!!(Pe&&Pe.__v_isRef===!0)}function S1(Pe){return gs(Pe)?Pe.value:Pe}const E1={get:(Pe,et,m)=>S1(Reflect.get(Pe,et,m)),set:(Pe,et,m,G)=>{const W=Pe[et];return gs(W)&&!gs(m)?(W.value=m,!0):Reflect.set(Pe,et,m,G)}};function E0(Pe){return jc(Pe)?Pe:new Proxy(Pe,E1)}var L0;class L1{constructor(et,m,G,W){this._setter=m,this.dep=void 0,this.__v_isRef=!0,this[L0]=!1,this._dirty=!0,this.effect=new Xh(et,()=>{this._dirty||(this._dirty=!0,A1(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!W,this.__v_isReadonly=G}get value(){const et=Da(this);return M1(et),(et._dirty||!et._cacheable)&&(et._dirty=!1,et._value=et.effect.run()),et._value}set value(et){this._setter(et)}}L0="__v_isReadonly";function C1(Pe,et,m=!1){let G,W;const d=la(Pe);return d?(G=Pe,W=el):(G=Pe.get,W=Pe.set),new L1(G,W,d||!W,m)}function jl(Pe,et,m,G){let W;try{W=G?Pe(...G):Pe()}catch(d){Sf(d,et,m)}return W}function zs(Pe,et,m,G){if(la(Pe)){const d=jl(Pe,et,m,G);return d&&p0(d)&&d.catch(v=>{Sf(v,et,m)}),d}const W=[];for(let d=0;d<Pe.length;d++)W.push(zs(Pe[d],et,m,G));return W}function Sf(Pe,et,m,G=!0){const W=et?et.vnode:null;if(et){let d=et.parent;const v=et.proxy,w=m;for(;d;){const e=d.ec;if(e){for(let t=0;t<e.length;t++)if(e[t](Pe,v,w)===!1)return}d=d.parent}const y=et.appContext.config.errorHandler;if(y){jl(y,null,10,[Pe,v,w]);return}}P1(Pe,m,W,G)}function P1(Pe,et,m,G=!0){console.error(Pe)}let bu=!1,Ih=!1;const is=[];let pl=0;const Uc=[];let Tl=null,ac=0;const C0=Promise.resolve();let np=null;function I1(Pe){const et=np||C0;return Pe?et.then(this?Pe.bind(this):Pe):et}function O1(Pe){let et=pl+1,m=is.length;for(;et<m;){const G=et+m>>>1;_u(is[G])<Pe?et=G+1:m=G}return et}function ip(Pe){(!is.length||!is.includes(Pe,bu&&Pe.allowRecurse?pl+1:pl))&&(Pe.id==null?is.push(Pe):is.splice(O1(Pe.id),0,Pe),P0())}function P0(){!bu&&!Ih&&(Ih=!0,np=C0.then(O0))}function D1(Pe){const et=is.indexOf(Pe);et>pl&&is.splice(et,1)}function z1(Pe){ta(Pe)?Uc.push(...Pe):(!Tl||!Tl.includes(Pe,Pe.allowRecurse?ac+1:ac))&&Uc.push(Pe),P0()}function Yd(Pe,et=bu?pl+1:0){for(;et<is.length;et++){const m=is[et];m&&m.pre&&(is.splice(et,1),et--,m())}}function I0(Pe){if(Uc.length){const et=[...new Set(Uc)];if(Uc.length=0,Tl){Tl.push(...et);return}for(Tl=et,Tl.sort((m,G)=>_u(m)-_u(G)),ac=0;ac<Tl.length;ac++)Tl[ac]();Tl=null,ac=0}}const _u=Pe=>Pe.id==null?1/0:Pe.id,R1=(Pe,et)=>{const m=_u(Pe)-_u(et);if(m===0){if(Pe.pre&&!et.pre)return-1;if(et.pre&&!Pe.pre)return 1}return m};function O0(Pe){Ih=!1,bu=!0,is.sort(R1);const et=el;try{for(pl=0;pl<is.length;pl++){const m=is[pl];m&&m.active!==!1&&jl(m,null,14)}}finally{pl=0,is.length=0,I0(),bu=!1,np=null,(is.length||Uc.length)&&O0()}}function F1(Pe,et,...m){if(Pe.isUnmounted)return;const G=Pe.vnode.props||Xa;let W=m;const d=et.startsWith("update:"),v=d&&et.slice(7);if(v&&v in G){const t=`${v==="modelValue"?"model":v}Modifiers`,{number:n,trim:a}=G[t]||Xa;a&&(W=m.map(r=>r.trim())),n&&(W=m.map(Xg))}let w,y=G[w=yh(et)]||G[w=yh(Vc(et))];!y&&d&&(y=G[w=yh(qc(et))]),y&&zs(y,Pe,6,W);const e=G[w+"Once"];if(e){if(!Pe.emitted)Pe.emitted={};else if(Pe.emitted[w])return;Pe.emitted[w]=!0,zs(e,Pe,6,W)}}function D0(Pe,et,m=!1){const G=et.emitsCache,W=G.get(Pe);if(W!==void 0)return W;const d=Pe.emits;let v={},w=!1;if(!la(Pe)){const y=e=>{const t=D0(e,et,!0);t&&(w=!0,as(v,t))};!m&&et.mixins.length&&et.mixins.forEach(y),Pe.extends&&y(Pe.extends),Pe.mixins&&Pe.mixins.forEach(y)}return!d&&!w?(Oo(Pe)&&G.set(Pe,null),null):(ta(d)?d.forEach(y=>v[y]=null):as(v,d),Oo(Pe)&&G.set(Pe,v),v)}function Ef(Pe,et){return!Pe||!Tf(et)?!1:(et=et.slice(2).replace(/Once$/,""),fa(Pe,et[0].toLowerCase()+et.slice(1))||fa(Pe,qc(et))||fa(Pe,et))}let dl=null,Lf=null;function bf(Pe){const et=dl;return dl=Pe,Lf=Pe&&Pe.type.__scopeId||null,et}function z0(Pe){Lf=Pe}function R0(){Lf=null}function B1(Pe,et=dl,m){if(!et||Pe._n)return Pe;const G=(...W)=>{G._d&&r0(-1);const d=bf(et);let v;try{v=Pe(...W)}finally{bf(d),G._d&&r0(1)}return v};return G._n=!0,G._c=!0,G._d=!0,G}function bh(Pe){const{type:et,vnode:m,proxy:G,withProxy:W,props:d,propsOptions:[v],slots:w,attrs:y,emit:e,render:t,renderCache:n,data:a,setupState:r,ctx:g,inheritAttrs:u}=Pe;let s,h;const l=bf(Pe);try{if(m.shapeFlag&4){const p=W||G;s=hl(t.call(p,p,n,d,r,a,g)),h=y}else{const p=et;s=hl(p.length>1?p(d,{attrs:y,slots:w,emit:e}):p(d,null)),h=et.props?y:N1(y)}}catch(p){yu.length=0,Sf(p,Pe,1),s=tl(kl)}let o=s;if(h&&u!==!1){const p=Object.keys(h),{shapeFlag:c}=o;p.length&&c&7&&(v&&p.some(qh)&&(h=j1(h,v)),o=Vl(o,h))}return m.dirs&&(o=Vl(o),o.dirs=o.dirs?o.dirs.concat(m.dirs):m.dirs),m.transition&&(o.transition=m.transition),s=o,bf(l),s}const N1=Pe=>{let et;for(const m in Pe)(m==="class"||m==="style"||Tf(m))&&((et||(et={}))[m]=Pe[m]);return et},j1=(Pe,et)=>{const m={};for(const G in Pe)(!qh(G)||!(G.slice(9)in et))&&(m[G]=Pe[G]);return m};function U1(Pe,et,m){const{props:G,children:W,component:d}=Pe,{props:v,children:w,patchFlag:y}=et,e=d.emitsOptions;if(et.dirs||et.transition)return!0;if(m&&y>=0){if(y&1024)return!0;if(y&16)return G?Wd(G,v,e):!!v;if(y&8){const t=et.dynamicProps;for(let n=0;n<t.length;n++){const a=t[n];if(v[a]!==G[a]&&!Ef(e,a))return!0}}}else return(W||w)&&(!w||!w.$stable)?!0:G===v?!1:G?v?Wd(G,v,e):!0:!!v;return!1}function Wd(Pe,et,m){const G=Object.keys(et);if(G.length!==Object.keys(Pe).length)return!0;for(let W=0;W<G.length;W++){const d=G[W];if(et[d]!==Pe[d]&&!Ef(m,d))return!0}return!1}function V1({vnode:Pe,parent:et},m){for(;et&&et.subTree===Pe;)(Pe=et.vnode).el=m,et=et.parent}const H1=Pe=>Pe.__isSuspense;function q1(Pe,et){et&&et.pendingBranch?ta(Pe)?et.effects.push(...Pe):et.effects.push(Pe):z1(Pe)}function G1(Pe,et){if(Qo){let m=Qo.provides;const G=Qo.parent&&Qo.parent.provides;G===m&&(m=Qo.provides=Object.create(G)),m[Pe]=et}}function _h(Pe,et,m=!1){const G=Qo||dl;if(G){const W=G.parent==null?G.vnode.appContext&&G.vnode.appContext.provides:G.parent.provides;if(W&&Pe in W)return W[Pe];if(arguments.length>1)return m&&la(et)?et.call(G.proxy):et}}const Zd={};function wh(Pe,et,m){return F0(Pe,et,m)}function F0(Pe,et,{immediate:m,deep:G,flush:W,onTrack:d,onTrigger:v}=Xa){const w=Qo;let y,e=!1,t=!1;if(gs(Pe)?(y=()=>Pe.value,e=Ph(Pe)):jc(Pe)?(y=()=>Pe,G=!0):ta(Pe)?(t=!0,e=Pe.some(h=>jc(h)||Ph(h)),y=()=>Pe.map(h=>{if(gs(h))return h.value;if(jc(h))return Bc(h);if(la(h))return jl(h,w,2)})):la(Pe)?et?y=()=>jl(Pe,w,2):y=()=>{if(!(w&&w.isUnmounted))return n&&n(),zs(Pe,w,3,[a])}:y=el,et&&G){const h=y;y=()=>Bc(h())}let n,a=h=>{n=s.onStop=()=>{jl(h,w,4)}};if(Tu)return a=el,et?m&&zs(et,w,3,[y(),t?[]:void 0,a]):y(),el;let r=t?[]:Zd;const g=()=>{if(!!s.active)if(et){const h=s.run();(G||e||(t?h.some((l,o)=>yf(l,r[o])):yf(h,r)))&&(n&&n(),zs(et,w,3,[h,r===Zd?void 0:r,a]),r=h)}else s.run()};g.allowRecurse=!!et;let u;W==="sync"?u=g:W==="post"?u=()=>ws(g,w&&w.suspense):(g.pre=!0,w&&(g.id=w.uid),u=()=>ip(g));const s=new Xh(y,u);return et?m?g():r=s.run():W==="post"?ws(s.run.bind(s),w&&w.suspense):s.run(),()=>{s.stop(),w&&w.scope&&Gh(w.scope.effects,s)}}function Y1(Pe,et,m){const G=this.proxy,W=os(Pe)?Pe.includes(".")?B0(G,Pe):()=>G[Pe]:Pe.bind(G,G);let d;la(et)?d=et:(d=et.handler,m=et);const v=Qo;Hc(this);const w=F0(W,d.bind(G),m);return v?Hc(v):cc(),w}function B0(Pe,et){const m=et.split(".");return()=>{let G=Pe;for(let W=0;W<m.length&&G;W++)G=G[m[W]];return G}}function Bc(Pe,et){if(!Oo(Pe)||Pe.__v_skip||(et=et||new Set,et.has(Pe)))return Pe;if(et.add(Pe),gs(Pe))Bc(Pe.value,et);else if(ta(Pe))for(let m=0;m<Pe.length;m++)Bc(Pe[m],et);else if(Hg(Pe)||vu(Pe))Pe.forEach(m=>{Bc(m,et)});else if(Yg(Pe))for(const m in Pe)Bc(Pe[m],et);return Pe}function W1(){const Pe={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return V0(()=>{Pe.isMounted=!0}),H0(()=>{Pe.isUnmounting=!0}),Pe}const Ds=[Function,Array],Z1={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ds,onEnter:Ds,onAfterEnter:Ds,onEnterCancelled:Ds,onBeforeLeave:Ds,onLeave:Ds,onAfterLeave:Ds,onLeaveCancelled:Ds,onBeforeAppear:Ds,onAppear:Ds,onAfterAppear:Ds,onAppearCancelled:Ds},setup(Pe,{slots:et}){const m=zv(),G=W1();let W;return()=>{const d=et.default&&j0(et.default(),!0);if(!d||!d.length)return;let v=d[0];if(d.length>1){for(const u of d)if(u.type!==kl){v=u;break}}const w=Da(Pe),{mode:y}=w;if(G.isLeaving)return Th(v);const e=Xd(v);if(!e)return Th(v);const t=Oh(e,w,G,m);Dh(e,t);const n=m.subTree,a=n&&Xd(n);let r=!1;const{getTransitionKey:g}=e.type;if(g){const u=g();W===void 0?W=u:u!==W&&(W=u,r=!0)}if(a&&a.type!==kl&&(!oc(e,a)||r)){const u=Oh(a,w,G,m);if(Dh(a,u),y==="out-in")return G.isLeaving=!0,u.afterLeave=()=>{G.isLeaving=!1,m.update()},Th(v);y==="in-out"&&e.type!==kl&&(u.delayLeave=(s,h,l)=>{const o=N0(G,a);o[String(a.key)]=a,s._leaveCb=()=>{h(),s._leaveCb=void 0,delete t.delayedLeave},t.delayedLeave=l})}return v}}},X1=Z1;function N0(Pe,et){const{leavingVNodes:m}=Pe;let G=m.get(et.type);return G||(G=Object.create(null),m.set(et.type,G)),G}function Oh(Pe,et,m,G){const{appear:W,mode:d,persisted:v=!1,onBeforeEnter:w,onEnter:y,onAfterEnter:e,onEnterCancelled:t,onBeforeLeave:n,onLeave:a,onAfterLeave:r,onLeaveCancelled:g,onBeforeAppear:u,onAppear:s,onAfterAppear:h,onAppearCancelled:l}=et,o=String(Pe.key),p=N0(m,Pe),c=(f,_)=>{f&&zs(f,G,9,_)},i=(f,_)=>{const b=_[1];c(f,_),ta(f)?f.every(T=>T.length<=1)&&b():f.length<=1&&b()},x={mode:d,persisted:v,beforeEnter(f){let _=w;if(!m.isMounted)if(W)_=u||w;else return;f._leaveCb&&f._leaveCb(!0);const b=p[o];b&&oc(Pe,b)&&b.el._leaveCb&&b.el._leaveCb(),c(_,[f])},enter(f){let _=y,b=e,T=t;if(!m.isMounted)if(W)_=s||y,b=h||e,T=l||t;else return;let k=!1;const L=f._enterCb=A=>{k||(k=!0,A?c(T,[f]):c(b,[f]),x.delayedLeave&&x.delayedLeave(),f._enterCb=void 0)};_?i(_,[f,L]):L()},leave(f,_){const b=String(Pe.key);if(f._enterCb&&f._enterCb(!0),m.isUnmounting)return _();c(n,[f]);let T=!1;const k=f._leaveCb=L=>{T||(T=!0,_(),L?c(g,[f]):c(r,[f]),f._leaveCb=void 0,p[b]===Pe&&delete p[b])};p[b]=Pe,a?i(a,[f,k]):k()},clone(f){return Oh(f,et,m,G)}};return x}function Th(Pe){if(Cf(Pe))return Pe=Vl(Pe),Pe.children=null,Pe}function Xd(Pe){return Cf(Pe)?Pe.children?Pe.children[0]:void 0:Pe}function Dh(Pe,et){Pe.shapeFlag&6&&Pe.component?Dh(Pe.component.subTree,et):Pe.shapeFlag&128?(Pe.ssContent.transition=et.clone(Pe.ssContent),Pe.ssFallback.transition=et.clone(Pe.ssFallback)):Pe.transition=et}function j0(Pe,et=!1,m){let G=[],W=0;for(let d=0;d<Pe.length;d++){let v=Pe[d];const w=m==null?v.key:String(m)+String(v.key!=null?v.key:d);v.type===Js?(v.patchFlag&128&&W++,G=G.concat(j0(v.children,et,w))):(et||v.type!==kl)&&G.push(w!=null?Vl(v,{key:w}):v)}if(W>1)for(let d=0;d<G.length;d++)G[d].patchFlag=-2;return G}const mf=Pe=>!!Pe.type.__asyncLoader,Cf=Pe=>Pe.type.__isKeepAlive;function K1(Pe,et){U0(Pe,"a",et)}function J1(Pe,et){U0(Pe,"da",et)}function U0(Pe,et,m=Qo){const G=Pe.__wdc||(Pe.__wdc=()=>{let W=m;for(;W;){if(W.isDeactivated)return;W=W.parent}return Pe()});if(Pf(et,G,m),m){let W=m.parent;for(;W&&W.parent;)Cf(W.parent.vnode)&&$1(G,et,m,W),W=W.parent}}function $1(Pe,et,m,G){const W=Pf(et,Pe,G,!0);q0(()=>{Gh(G[et],W)},m)}function Pf(Pe,et,m=Qo,G=!1){if(m){const W=m[Pe]||(m[Pe]=[]),d=et.__weh||(et.__weh=(...v)=>{if(m.isUnmounted)return;Gc(),Hc(m);const w=zs(et,m,Pe,v);return cc(),Yc(),w});return G?W.unshift(d):W.push(d),d}}const Al=Pe=>(et,m=Qo)=>(!Tu||Pe==="sp")&&Pf(Pe,(...G)=>et(...G),m),Q1=Al("bm"),V0=Al("m"),ev=Al("bu"),tv=Al("u"),H0=Al("bum"),q0=Al("um"),rv=Al("sp"),nv=Al("rtg"),iv=Al("rtc");function av(Pe,et=Qo){Pf("ec",Pe,et)}function rc(Pe,et,m,G){const W=Pe.dirs,d=et&&et.dirs;for(let v=0;v<W.length;v++){const w=W[v];d&&(w.oldValue=d[v].value);let y=w.dir[G];y&&(Gc(),zs(y,m,8,[Pe.el,w,Pe,et]),Yc())}}const ov=Symbol(),zh=Pe=>Pe?em(Pe)?fp(Pe)||Pe.proxy:zh(Pe.parent):null,_f=as(Object.create(null),{$:Pe=>Pe,$el:Pe=>Pe.vnode.el,$data:Pe=>Pe.data,$props:Pe=>Pe.props,$attrs:Pe=>Pe.attrs,$slots:Pe=>Pe.slots,$refs:Pe=>Pe.refs,$parent:Pe=>zh(Pe.parent),$root:Pe=>zh(Pe.root),$emit:Pe=>Pe.emit,$options:Pe=>ap(Pe),$forceUpdate:Pe=>Pe.f||(Pe.f=()=>ip(Pe.update)),$nextTick:Pe=>Pe.n||(Pe.n=I1.bind(Pe.proxy)),$watch:Pe=>Y1.bind(Pe)}),sv={get({_:Pe},et){const{ctx:m,setupState:G,data:W,props:d,accessCache:v,type:w,appContext:y}=Pe;let e;if(et[0]!=="$"){const r=v[et];if(r!==void 0)switch(r){case 1:return G[et];case 2:return W[et];case 4:return m[et];case 3:return d[et]}else{if(G!==Xa&&fa(G,et))return v[et]=1,G[et];if(W!==Xa&&fa(W,et))return v[et]=2,W[et];if((e=Pe.propsOptions[0])&&fa(e,et))return v[et]=3,d[et];if(m!==Xa&&fa(m,et))return v[et]=4,m[et];Rh&&(v[et]=0)}}const t=_f[et];let n,a;if(t)return et==="$attrs"&&Ls(Pe,"get",et),t(Pe);if((n=w.__cssModules)&&(n=n[et]))return n;if(m!==Xa&&fa(m,et))return v[et]=4,m[et];if(a=y.config.globalProperties,fa(a,et))return a[et]},set({_:Pe},et,m){const{data:G,setupState:W,ctx:d}=Pe;return W!==Xa&&fa(W,et)?(W[et]=m,!0):G!==Xa&&fa(G,et)?(G[et]=m,!0):fa(Pe.props,et)||et[0]==="$"&&et.slice(1)in Pe?!1:(d[et]=m,!0)},has({_:{data:Pe,setupState:et,accessCache:m,ctx:G,appContext:W,propsOptions:d}},v){let w;return!!m[v]||Pe!==Xa&&fa(Pe,v)||et!==Xa&&fa(et,v)||(w=d[0])&&fa(w,v)||fa(G,v)||fa(_f,v)||fa(W.config.globalProperties,v)},defineProperty(Pe,et,m){return m.get!=null?Pe._.accessCache[et]=0:fa(m,"value")&&this.set(Pe,et,m.value,null),Reflect.defineProperty(Pe,et,m)}};let Rh=!0;function lv(Pe){const et=ap(Pe),m=Pe.proxy,G=Pe.ctx;Rh=!1,et.beforeCreate&&Kd(et.beforeCreate,Pe,"bc");const{data:W,computed:d,methods:v,watch:w,provide:y,inject:e,created:t,beforeMount:n,mounted:a,beforeUpdate:r,updated:g,activated:u,deactivated:s,beforeDestroy:h,beforeUnmount:l,destroyed:o,unmounted:p,render:c,renderTracked:i,renderTriggered:x,errorCaptured:f,serverPrefetch:_,expose:b,inheritAttrs:T,components:k,directives:L,filters:A}=et;if(e&&cv(e,G,null,Pe.appContext.config.unwrapInjectedRef),v)for(const S in v){const E=v[S];la(E)&&(G[S]=E.bind(m))}if(W){const S=W.call(m,m);Oo(S)&&(Pe.data=Qh(S))}if(Rh=!0,d)for(const S in d){const E=d[S],z=la(E)?E.bind(m,m):la(E.get)?E.get.bind(m,m):el,D=!la(E)&&la(E.set)?E.set.bind(m):el,j=Uv({get:z,set:D});Object.defineProperty(G,S,{enumerable:!0,configurable:!0,get:()=>j.value,set:V=>j.value=V})}if(w)for(const S in w)G0(w[S],G,m,S);if(y){const S=la(y)?y.call(m):y;Reflect.ownKeys(S).forEach(E=>{G1(E,S[E])})}t&&Kd(t,Pe,"c");function P(S,E){ta(E)?E.forEach(z=>S(z.bind(m))):E&&S(E.bind(m))}if(P(Q1,n),P(V0,a),P(ev,r),P(tv,g),P(K1,u),P(J1,s),P(av,f),P(iv,i),P(nv,x),P(H0,l),P(q0,p),P(rv,_),ta(b))if(b.length){const S=Pe.exposed||(Pe.exposed={});b.forEach(E=>{Object.defineProperty(S,E,{get:()=>m[E],set:z=>m[E]=z})})}else Pe.exposed||(Pe.exposed={});c&&Pe.render===el&&(Pe.render=c),T!=null&&(Pe.inheritAttrs=T),k&&(Pe.components=k),L&&(Pe.directives=L)}function cv(Pe,et,m=el,G=!1){ta(Pe)&&(Pe=Fh(Pe));for(const W in Pe){const d=Pe[W];let v;Oo(d)?"default"in d?v=_h(d.from||W,d.default,!0):v=_h(d.from||W):v=_h(d),gs(v)&&G?Object.defineProperty(et,W,{enumerable:!0,configurable:!0,get:()=>v.value,set:w=>v.value=w}):et[W]=v}}function Kd(Pe,et,m){zs(ta(Pe)?Pe.map(G=>G.bind(et.proxy)):Pe.bind(et.proxy),et,m)}function G0(Pe,et,m,G){const W=G.includes(".")?B0(m,G):()=>m[G];if(os(Pe)){const d=et[Pe];la(d)&&wh(W,d)}else if(la(Pe))wh(W,Pe.bind(m));else if(Oo(Pe))if(ta(Pe))Pe.forEach(d=>G0(d,et,m,G));else{const d=la(Pe.handler)?Pe.handler.bind(m):et[Pe.handler];la(d)&&wh(W,d,Pe)}}function ap(Pe){const et=Pe.type,{mixins:m,extends:G}=et,{mixins:W,optionsCache:d,config:{optionMergeStrategies:v}}=Pe.appContext,w=d.get(et);let y;return w?y=w:!W.length&&!m&&!G?y=et:(y={},W.length&&W.forEach(e=>wf(y,e,v,!0)),wf(y,et,v)),Oo(et)&&d.set(et,y),y}function wf(Pe,et,m,G=!1){const{mixins:W,extends:d}=et;d&&wf(Pe,d,m,!0),W&&W.forEach(v=>wf(Pe,v,m,!0));for(const v in et)if(!(G&&v==="expose")){const w=uv[v]||m&&m[v];Pe[v]=w?w(Pe[v],et[v]):et[v]}return Pe}const uv={data:Jd,props:ic,emits:ic,methods:ic,computed:ic,beforeCreate:ms,created:ms,beforeMount:ms,mounted:ms,beforeUpdate:ms,updated:ms,beforeDestroy:ms,beforeUnmount:ms,destroyed:ms,unmounted:ms,activated:ms,deactivated:ms,errorCaptured:ms,serverPrefetch:ms,components:ic,directives:ic,watch:hv,provide:Jd,inject:fv};function Jd(Pe,et){return et?Pe?function(){return as(la(Pe)?Pe.call(this,this):Pe,la(et)?et.call(this,this):et)}:et:Pe}function fv(Pe,et){return ic(Fh(Pe),Fh(et))}function Fh(Pe){if(ta(Pe)){const et={};for(let m=0;m<Pe.length;m++)et[Pe[m]]=Pe[m];return et}return Pe}function ms(Pe,et){return Pe?[...new Set([].concat(Pe,et))]:et}function ic(Pe,et){return Pe?as(as(Object.create(null),Pe),et):et}function hv(Pe,et){if(!Pe)return et;if(!et)return Pe;const m=as(Object.create(null),Pe);for(const G in et)m[G]=ms(Pe[G],et[G]);return m}function pv(Pe,et,m,G=!1){const W={},d={};xf(d,If,1),Pe.propsDefaults=Object.create(null),Y0(Pe,et,W,d);for(const v in Pe.propsOptions[0])v in W||(W[v]=void 0);m?Pe.props=G?W:k1(W):Pe.type.props?Pe.props=W:Pe.props=d,Pe.attrs=d}function dv(Pe,et,m,G){const{props:W,attrs:d,vnode:{patchFlag:v}}=Pe,w=Da(W),[y]=Pe.propsOptions;let e=!1;if((G||v>0)&&!(v&16)){if(v&8){const t=Pe.vnode.dynamicProps;for(let n=0;n<t.length;n++){let a=t[n];if(Ef(Pe.emitsOptions,a))continue;const r=et[a];if(y)if(fa(d,a))r!==d[a]&&(d[a]=r,e=!0);else{const g=Vc(a);W[g]=Bh(y,w,g,r,Pe,!1)}else r!==d[a]&&(d[a]=r,e=!0)}}}else{Y0(Pe,et,W,d)&&(e=!0);let t;for(const n in w)(!et||!fa(et,n)&&((t=qc(n))===n||!fa(et,t)))&&(y?m&&(m[n]!==void 0||m[t]!==void 0)&&(W[n]=Bh(y,w,n,void 0,Pe,!0)):delete W[n]);if(d!==w)for(const n in d)(!et||!fa(et,n)&&!0)&&(delete d[n],e=!0)}e&&Ml(Pe,"set","$attrs")}function Y0(Pe,et,m,G){const[W,d]=Pe.propsOptions;let v=!1,w;if(et)for(let y in et){if(df(y))continue;const e=et[y];let t;W&&fa(W,t=Vc(y))?!d||!d.includes(t)?m[t]=e:(w||(w={}))[t]=e:Ef(Pe.emitsOptions,y)||(!(y in G)||e!==G[y])&&(G[y]=e,v=!0)}if(d){const y=Da(m),e=w||Xa;for(let t=0;t<d.length;t++){const n=d[t];m[n]=Bh(W,y,n,e[n],Pe,!fa(e,n))}}return v}function Bh(Pe,et,m,G,W,d){const v=Pe[m];if(v!=null){const w=fa(v,"default");if(w&&G===void 0){const y=v.default;if(v.type!==Function&&la(y)){const{propsDefaults:e}=W;m in e?G=e[m]:(Hc(W),G=e[m]=y.call(null,et),cc())}else G=y}v[0]&&(d&&!w?G=!1:v[1]&&(G===""||G===qc(m))&&(G=!0))}return G}function W0(Pe,et,m=!1){const G=et.propsCache,W=G.get(Pe);if(W)return W;const d=Pe.props,v={},w=[];let y=!1;if(!la(Pe)){const t=n=>{y=!0;const[a,r]=W0(n,et,!0);as(v,a),r&&w.push(...r)};!m&&et.mixins.length&&et.mixins.forEach(t),Pe.extends&&t(Pe.extends),Pe.mixins&&Pe.mixins.forEach(t)}if(!d&&!y)return Oo(Pe)&&G.set(Pe,Nc),Nc;if(ta(d))for(let t=0;t<d.length;t++){const n=Vc(d[t]);$d(n)&&(v[n]=Xa)}else if(d)for(const t in d){const n=Vc(t);if($d(n)){const a=d[t],r=v[n]=ta(a)||la(a)?{type:a}:a;if(r){const g=t0(Boolean,r.type),u=t0(String,r.type);r[0]=g>-1,r[1]=u<0||g<u,(g>-1||fa(r,"default"))&&w.push(n)}}}const e=[v,w];return Oo(Pe)&&G.set(Pe,e),e}function $d(Pe){return Pe[0]!=="$"}function Qd(Pe){const et=Pe&&Pe.toString().match(/^\s*function (\w+)/);return et?et[1]:Pe===null?"null":""}function e0(Pe,et){return Qd(Pe)===Qd(et)}function t0(Pe,et){return ta(et)?et.findIndex(m=>e0(m,Pe)):la(et)&&e0(et,Pe)?0:-1}const Z0=Pe=>Pe[0]==="_"||Pe==="$stable",op=Pe=>ta(Pe)?Pe.map(hl):[hl(Pe)],mv=(Pe,et,m)=>{if(et._n)return et;const G=B1((...W)=>op(et(...W)),m);return G._c=!1,G},X0=(Pe,et,m)=>{const G=Pe._ctx;for(const W in Pe){if(Z0(W))continue;const d=Pe[W];if(la(d))et[W]=mv(W,d,G);else if(d!=null){const v=op(d);et[W]=()=>v}}},K0=(Pe,et)=>{const m=op(et);Pe.slots.default=()=>m},gv=(Pe,et)=>{if(Pe.vnode.shapeFlag&32){const m=et._;m?(Pe.slots=Da(et),xf(et,"_",m)):X0(et,Pe.slots={})}else Pe.slots={},et&&K0(Pe,et);xf(Pe.slots,If,1)},vv=(Pe,et,m)=>{const{vnode:G,slots:W}=Pe;let d=!0,v=Xa;if(G.shapeFlag&32){const w=et._;w?m&&w===1?d=!1:(as(W,et),!m&&w===1&&delete W._):(d=!et.$stable,X0(et,W)),v=et}else et&&(K0(Pe,et),v={default:1});if(d)for(const w in W)!Z0(w)&&!(w in v)&&delete W[w]};function J0(){return{app:null,config:{isNativeTag:jg,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yv=0;function xv(Pe,et){return function(G,W=null){la(G)||(G=Object.assign({},G)),W!=null&&!Oo(W)&&(W=null);const d=J0(),v=new Set;let w=!1;const y=d.app={_uid:yv++,_component:G,_props:W,_container:null,_context:d,_instance:null,version:Vv,get config(){return d.config},set config(e){},use(e,...t){return v.has(e)||(e&&la(e.install)?(v.add(e),e.install(y,...t)):la(e)&&(v.add(e),e(y,...t))),y},mixin(e){return d.mixins.includes(e)||d.mixins.push(e),y},component(e,t){return t?(d.components[e]=t,y):d.components[e]},directive(e,t){return t?(d.directives[e]=t,y):d.directives[e]},mount(e,t,n){if(!w){const a=tl(G,W);return a.appContext=d,t&&et?et(a,e):Pe(a,e,n),w=!0,y._container=e,e.__vue_app__=y,fp(a.component)||a.component.proxy}},unmount(){w&&(Pe(null,y._container),delete y._container.__vue_app__)},provide(e,t){return d.provides[e]=t,y}};return y}}function Nh(Pe,et,m,G,W=!1){if(ta(Pe)){Pe.forEach((a,r)=>Nh(a,et&&(ta(et)?et[r]:et),m,G,W));return}if(mf(G)&&!W)return;const d=G.shapeFlag&4?fp(G.component)||G.component.proxy:G.el,v=W?null:d,{i:w,r:y}=Pe,e=et&&et.r,t=w.refs===Xa?w.refs={}:w.refs,n=w.setupState;if(e!=null&&e!==y&&(os(e)?(t[e]=null,fa(n,e)&&(n[e]=null)):gs(e)&&(e.value=null)),la(y))jl(y,w,12,[v,t]);else{const a=os(y),r=gs(y);if(a||r){const g=()=>{if(Pe.f){const u=a?fa(n,y)?n[y]:t[y]:y.value;W?ta(u)&&Gh(u,d):ta(u)?u.includes(d)||u.push(d):a?(t[y]=[d],fa(n,y)&&(n[y]=t[y])):(y.value=[d],Pe.k&&(t[Pe.k]=y.value))}else a?(t[y]=v,fa(n,y)&&(n[y]=v)):r&&(y.value=v,Pe.k&&(t[Pe.k]=v))};v?(g.id=-1,ws(g,m)):g()}}}const ws=q1;function bv(Pe){return _v(Pe)}function _v(Pe,et){const m=Kg();m.__VUE__=!0;const{insert:G,remove:W,patchProp:d,createElement:v,createText:w,createComment:y,setText:e,setElementText:t,parentNode:n,nextSibling:a,setScopeId:r=el,insertStaticContent:g}=Pe,u=(B,X,J,ee=null,re=null,se=null,oe=!1,de=null,ce=!!X.dynamicChildren)=>{if(B===X)return;B&&!oc(B,X)&&(ee=ne(B),V(B,re,se,!0),B=null),X.patchFlag===-2&&(ce=!1,X.dynamicChildren=null);const{type:ve,ref:Ae,shapeFlag:fe}=X;switch(ve){case sp:s(B,X,J,ee);break;case kl:h(B,X,J,ee);break;case gf:B==null&&l(X,J,ee,oe);break;case Js:k(B,X,J,ee,re,se,oe,de,ce);break;default:fe&1?c(B,X,J,ee,re,se,oe,de,ce):fe&6?L(B,X,J,ee,re,se,oe,de,ce):(fe&64||fe&128)&&ve.process(B,X,J,ee,re,se,oe,de,ce,N)}Ae!=null&&re&&Nh(Ae,B&&B.ref,se,X||B,!X)},s=(B,X,J,ee)=>{if(B==null)G(X.el=w(X.children),J,ee);else{const re=X.el=B.el;X.children!==B.children&&e(re,X.children)}},h=(B,X,J,ee)=>{B==null?G(X.el=y(X.children||""),J,ee):X.el=B.el},l=(B,X,J,ee)=>{[B.el,B.anchor]=g(B.children,X,J,ee,B.el,B.anchor)},o=({el:B,anchor:X},J,ee)=>{let re;for(;B&&B!==X;)re=a(B),G(B,J,ee),B=re;G(X,J,ee)},p=({el:B,anchor:X})=>{let J;for(;B&&B!==X;)J=a(B),W(B),B=J;W(X)},c=(B,X,J,ee,re,se,oe,de,ce)=>{oe=oe||X.type==="svg",B==null?i(X,J,ee,re,se,oe,de,ce):_(B,X,re,se,oe,de,ce)},i=(B,X,J,ee,re,se,oe,de)=>{let ce,ve;const{type:Ae,props:fe,shapeFlag:me,transition:_e,dirs:le}=B;if(ce=B.el=v(B.type,se,fe&&fe.is,fe),me&8?t(ce,B.children):me&16&&f(B.children,ce,null,ee,re,se&&Ae!=="foreignObject",oe,de),le&&rc(B,null,ee,"created"),fe){for(const Te in fe)Te!=="value"&&!df(Te)&&d(ce,Te,null,fe[Te],se,B.children,ee,re,$);"value"in fe&&d(ce,"value",null,fe.value),(ve=fe.onVnodeBeforeMount)&&ul(ve,ee,B)}x(ce,B,B.scopeId,oe,ee),le&&rc(B,null,ee,"beforeMount");const ge=(!re||re&&!re.pendingBranch)&&_e&&!_e.persisted;ge&&_e.beforeEnter(ce),G(ce,X,J),((ve=fe&&fe.onVnodeMounted)||ge||le)&&ws(()=>{ve&&ul(ve,ee,B),ge&&_e.enter(ce),le&&rc(B,null,ee,"mounted")},re)},x=(B,X,J,ee,re)=>{if(J&&r(B,J),ee)for(let se=0;se<ee.length;se++)r(B,ee[se]);if(re){let se=re.subTree;if(X===se){const oe=re.vnode;x(B,oe,oe.scopeId,oe.slotScopeIds,re.parent)}}},f=(B,X,J,ee,re,se,oe,de,ce=0)=>{for(let ve=ce;ve<B.length;ve++){const Ae=B[ve]=de?Bl(B[ve]):hl(B[ve]);u(null,Ae,X,J,ee,re,se,oe,de)}},_=(B,X,J,ee,re,se,oe)=>{const de=X.el=B.el;let{patchFlag:ce,dynamicChildren:ve,dirs:Ae}=X;ce|=B.patchFlag&16;const fe=B.props||Xa,me=X.props||Xa;let _e;J&&nc(J,!1),(_e=me.onVnodeBeforeUpdate)&&ul(_e,J,X,B),Ae&&rc(X,B,J,"beforeUpdate"),J&&nc(J,!0);const le=re&&X.type!=="foreignObject";if(ve?b(B.dynamicChildren,ve,de,J,ee,le,se):oe||E(B,X,de,null,J,ee,le,se,!1),ce>0){if(ce&16)T(de,X,fe,me,J,ee,re);else if(ce&2&&fe.class!==me.class&&d(de,"class",null,me.class,re),ce&4&&d(de,"style",fe.style,me.style,re),ce&8){const ge=X.dynamicProps;for(let Te=0;Te<ge.length;Te++){const Se=ge[Te],Me=fe[Se],ze=me[Se];(ze!==Me||Se==="value")&&d(de,Se,Me,ze,re,B.children,J,ee,$)}}ce&1&&B.children!==X.children&&t(de,X.children)}else!oe&&ve==null&&T(de,X,fe,me,J,ee,re);((_e=me.onVnodeUpdated)||Ae)&&ws(()=>{_e&&ul(_e,J,X,B),Ae&&rc(X,B,J,"updated")},ee)},b=(B,X,J,ee,re,se,oe)=>{for(let de=0;de<X.length;de++){const ce=B[de],ve=X[de],Ae=ce.el&&(ce.type===Js||!oc(ce,ve)||ce.shapeFlag&70)?n(ce.el):J;u(ce,ve,Ae,null,ee,re,se,oe,!0)}},T=(B,X,J,ee,re,se,oe)=>{if(J!==ee){if(J!==Xa)for(const de in J)!df(de)&&!(de in ee)&&d(B,de,J[de],null,oe,X.children,re,se,$);for(const de in ee){if(df(de))continue;const ce=ee[de],ve=J[de];ce!==ve&&de!=="value"&&d(B,de,ve,ce,oe,X.children,re,se,$)}"value"in ee&&d(B,"value",J.value,ee.value)}},k=(B,X,J,ee,re,se,oe,de,ce)=>{const ve=X.el=B?B.el:w(""),Ae=X.anchor=B?B.anchor:w("");let{patchFlag:fe,dynamicChildren:me,slotScopeIds:_e}=X;_e&&(de=de?de.concat(_e):_e),B==null?(G(ve,J,ee),G(Ae,J,ee),f(X.children,J,Ae,re,se,oe,de,ce)):fe>0&&fe&64&&me&&B.dynamicChildren?(b(B.dynamicChildren,me,J,re,se,oe,de),(X.key!=null||re&&X===re.subTree)&&$0(B,X,!0)):E(B,X,J,Ae,re,se,oe,de,ce)},L=(B,X,J,ee,re,se,oe,de,ce)=>{X.slotScopeIds=de,B==null?X.shapeFlag&512?re.ctx.activate(X,J,ee,oe,ce):A(X,J,ee,re,se,oe,ce):I(B,X,ce)},A=(B,X,J,ee,re,se,oe)=>{const de=B.component=Dv(B,ee,re);if(Cf(B)&&(de.ctx.renderer=N),Rv(de),de.asyncDep){if(re&&re.registerDep(de,P),!B.el){const ce=de.subTree=tl(kl);h(null,ce,X,J)}return}P(de,B,X,J,re,se,oe)},I=(B,X,J)=>{const ee=X.component=B.component;if(U1(B,X,J))if(ee.asyncDep&&!ee.asyncResolved){S(ee,X,J);return}else ee.next=X,D1(ee.update),ee.update();else X.el=B.el,ee.vnode=X},P=(B,X,J,ee,re,se,oe)=>{const de=()=>{if(B.isMounted){let{next:Ae,bu:fe,u:me,parent:_e,vnode:le}=B,ge=Ae,Te;nc(B,!1),Ae?(Ae.el=le.el,S(B,Ae,oe)):Ae=le,fe&&xh(fe),(Te=Ae.props&&Ae.props.onVnodeBeforeUpdate)&&ul(Te,_e,Ae,le),nc(B,!0);const Se=bh(B),Me=B.subTree;B.subTree=Se,u(Me,Se,n(Me.el),ne(Me),B,re,se),Ae.el=Se.el,ge===null&&V1(B,Se.el),me&&ws(me,re),(Te=Ae.props&&Ae.props.onVnodeUpdated)&&ws(()=>ul(Te,_e,Ae,le),re)}else{let Ae;const{el:fe,props:me}=X,{bm:_e,m:le,parent:ge}=B,Te=mf(X);if(nc(B,!1),_e&&xh(_e),!Te&&(Ae=me&&me.onVnodeBeforeMount)&&ul(Ae,ge,X),nc(B,!0),fe&&te){const Se=()=>{B.subTree=bh(B),te(fe,B.subTree,B,re,null)};Te?X.type.__asyncLoader().then(()=>!B.isUnmounted&&Se()):Se()}else{const Se=B.subTree=bh(B);u(null,Se,J,ee,B,re,se),X.el=Se.el}if(le&&ws(le,re),!Te&&(Ae=me&&me.onVnodeMounted)){const Se=X;ws(()=>ul(Ae,ge,Se),re)}(X.shapeFlag&256||ge&&mf(ge.vnode)&&ge.vnode.shapeFlag&256)&&B.a&&ws(B.a,re),B.isMounted=!0,X=J=ee=null}},ce=B.effect=new Xh(de,()=>ip(ve),B.scope),ve=B.update=()=>ce.run();ve.id=B.uid,nc(B,!0),ve()},S=(B,X,J)=>{X.component=B;const ee=B.vnode.props;B.vnode=X,B.next=null,dv(B,X.props,ee,J),vv(B,X.children,J),Gc(),Yd(),Yc()},E=(B,X,J,ee,re,se,oe,de,ce=!1)=>{const ve=B&&B.children,Ae=B?B.shapeFlag:0,fe=X.children,{patchFlag:me,shapeFlag:_e}=X;if(me>0){if(me&128){D(ve,fe,J,ee,re,se,oe,de,ce);return}else if(me&256){z(ve,fe,J,ee,re,se,oe,de,ce);return}}_e&8?(Ae&16&&$(ve,re,se),fe!==ve&&t(J,fe)):Ae&16?_e&16?D(ve,fe,J,ee,re,se,oe,de,ce):$(ve,re,se,!0):(Ae&8&&t(J,""),_e&16&&f(fe,J,ee,re,se,oe,de,ce))},z=(B,X,J,ee,re,se,oe,de,ce)=>{B=B||Nc,X=X||Nc;const ve=B.length,Ae=X.length,fe=Math.min(ve,Ae);let me;for(me=0;me<fe;me++){const _e=X[me]=ce?Bl(X[me]):hl(X[me]);u(B[me],_e,J,null,re,se,oe,de,ce)}ve>Ae?$(B,re,se,!0,!1,fe):f(X,J,ee,re,se,oe,de,ce,fe)},D=(B,X,J,ee,re,se,oe,de,ce)=>{let ve=0;const Ae=X.length;let fe=B.length-1,me=Ae-1;for(;ve<=fe&&ve<=me;){const _e=B[ve],le=X[ve]=ce?Bl(X[ve]):hl(X[ve]);if(oc(_e,le))u(_e,le,J,null,re,se,oe,de,ce);else break;ve++}for(;ve<=fe&&ve<=me;){const _e=B[fe],le=X[me]=ce?Bl(X[me]):hl(X[me]);if(oc(_e,le))u(_e,le,J,null,re,se,oe,de,ce);else break;fe--,me--}if(ve>fe){if(ve<=me){const _e=me+1,le=_e<Ae?X[_e].el:ee;for(;ve<=me;)u(null,X[ve]=ce?Bl(X[ve]):hl(X[ve]),J,le,re,se,oe,de,ce),ve++}}else if(ve>me)for(;ve<=fe;)V(B[ve],re,se,!0),ve++;else{const _e=ve,le=ve,ge=new Map;for(ve=le;ve<=me;ve++){const Be=X[ve]=ce?Bl(X[ve]):hl(X[ve]);Be.key!=null&&ge.set(Be.key,ve)}let Te,Se=0;const Me=me-le+1;let ze=!1,Oe=0;const De=new Array(Me);for(ve=0;ve<Me;ve++)De[ve]=0;for(ve=_e;ve<=fe;ve++){const Be=B[ve];if(Se>=Me){V(Be,re,se,!0);continue}let Ie;if(Be.key!=null)Ie=ge.get(Be.key);else for(Te=le;Te<=me;Te++)if(De[Te-le]===0&&oc(Be,X[Te])){Ie=Te;break}Ie===void 0?V(Be,re,se,!0):(De[Ie-le]=ve+1,Ie>=Oe?Oe=Ie:ze=!0,u(Be,X[Ie],J,null,re,se,oe,de,ce),Se++)}const Xe=ze?wv(De):Nc;for(Te=Xe.length-1,ve=Me-1;ve>=0;ve--){const Be=le+ve,Ie=X[Be],Re=Be+1<Ae?X[Be+1].el:ee;De[ve]===0?u(null,Ie,J,Re,re,se,oe,de,ce):ze&&(Te<0||ve!==Xe[Te]?j(Ie,J,Re,2):Te--)}}},j=(B,X,J,ee,re=null)=>{const{el:se,type:oe,transition:de,children:ce,shapeFlag:ve}=B;if(ve&6){j(B.component.subTree,X,J,ee);return}if(ve&128){B.suspense.move(X,J,ee);return}if(ve&64){oe.move(B,X,J,N);return}if(oe===Js){G(se,X,J);for(let fe=0;fe<ce.length;fe++)j(ce[fe],X,J,ee);G(B.anchor,X,J);return}if(oe===gf){o(B,X,J);return}if(ee!==2&&ve&1&&de)if(ee===0)de.beforeEnter(se),G(se,X,J),ws(()=>de.enter(se),re);else{const{leave:fe,delayLeave:me,afterLeave:_e}=de,le=()=>G(se,X,J),ge=()=>{fe(se,()=>{le(),_e&&_e()})};me?me(se,le,ge):ge()}else G(se,X,J)},V=(B,X,J,ee=!1,re=!1)=>{const{type:se,props:oe,ref:de,children:ce,dynamicChildren:ve,shapeFlag:Ae,patchFlag:fe,dirs:me}=B;if(de!=null&&Nh(de,null,J,B,!0),Ae&256){X.ctx.deactivate(B);return}const _e=Ae&1&&me,le=!mf(B);let ge;if(le&&(ge=oe&&oe.onVnodeBeforeUnmount)&&ul(ge,X,B),Ae&6)K(B.component,J,ee);else{if(Ae&128){B.suspense.unmount(J,ee);return}_e&&rc(B,null,X,"beforeUnmount"),Ae&64?B.type.remove(B,X,J,re,N,ee):ve&&(se!==Js||fe>0&&fe&64)?$(ve,X,J,!1,!0):(se===Js&&fe&384||!re&&Ae&16)&&$(ce,X,J),ee&&Z(B)}(le&&(ge=oe&&oe.onVnodeUnmounted)||_e)&&ws(()=>{ge&&ul(ge,X,B),_e&&rc(B,null,X,"unmounted")},J)},Z=B=>{const{type:X,el:J,anchor:ee,transition:re}=B;if(X===Js){Q(J,ee);return}if(X===gf){p(B);return}const se=()=>{W(J),re&&!re.persisted&&re.afterLeave&&re.afterLeave()};if(B.shapeFlag&1&&re&&!re.persisted){const{leave:oe,delayLeave:de}=re,ce=()=>oe(J,se);de?de(B.el,se,ce):ce()}else se()},Q=(B,X)=>{let J;for(;B!==X;)J=a(B),W(B),B=J;W(X)},K=(B,X,J)=>{const{bum:ee,scope:re,update:se,subTree:oe,um:de}=B;ee&&xh(ee),re.stop(),se&&(se.active=!1,V(oe,B,X,J)),de&&ws(de,X),ws(()=>{B.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&B.asyncDep&&!B.asyncResolved&&B.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},$=(B,X,J,ee=!1,re=!1,se=0)=>{for(let oe=se;oe<B.length;oe++)V(B[oe],X,J,ee,re)},ne=B=>B.shapeFlag&6?ne(B.component.subTree):B.shapeFlag&128?B.suspense.next():a(B.anchor||B.el),H=(B,X,J)=>{B==null?X._vnode&&V(X._vnode,null,null,!0):u(X._vnode||null,B,X,null,null,null,J),Yd(),I0(),X._vnode=B},N={p:u,um:V,m:j,r:Z,mt:A,mc:f,pc:E,pbc:b,n:ne,o:Pe};let U,te;return et&&([U,te]=et(N)),{render:H,hydrate:U,createApp:xv(H,U)}}function nc({effect:Pe,update:et},m){Pe.allowRecurse=et.allowRecurse=m}function $0(Pe,et,m=!1){const G=Pe.children,W=et.children;if(ta(G)&&ta(W))for(let d=0;d<G.length;d++){const v=G[d];let w=W[d];w.shapeFlag&1&&!w.dynamicChildren&&((w.patchFlag<=0||w.patchFlag===32)&&(w=W[d]=Bl(W[d]),w.el=v.el),m||$0(v,w))}}function wv(Pe){const et=Pe.slice(),m=[0];let G,W,d,v,w;const y=Pe.length;for(G=0;G<y;G++){const e=Pe[G];if(e!==0){if(W=m[m.length-1],Pe[W]<e){et[G]=W,m.push(G);continue}for(d=0,v=m.length-1;d<v;)w=d+v>>1,Pe[m[w]]<e?d=w+1:v=w;e<Pe[m[d]]&&(d>0&&(et[G]=m[d-1]),m[d]=G)}}for(d=m.length,v=m[d-1];d-- >0;)m[d]=v,v=et[v];return m}const Tv=Pe=>Pe.__isTeleport,Js=Symbol(void 0),sp=Symbol(void 0),kl=Symbol(void 0),gf=Symbol(void 0),yu=[];let Qs=null;function lp(Pe=!1){yu.push(Qs=Pe?null:[])}function kv(){yu.pop(),Qs=yu[yu.length-1]||null}let wu=1;function r0(Pe){wu+=Pe}function Mv(Pe){return Pe.dynamicChildren=wu>0?Qs||Nc:null,kv(),wu>0&&Qs&&Qs.push(Pe),Pe}function cp(Pe,et,m,G,W,d){return Mv(uc(Pe,et,m,G,W,d,!0))}function Av(Pe){return Pe?Pe.__v_isVNode===!0:!1}function oc(Pe,et){return Pe.type===et.type&&Pe.key===et.key}const If="__vInternal",Q0=({key:Pe})=>Pe!=null?Pe:null,vf=({ref:Pe,ref_key:et,ref_for:m})=>Pe!=null?os(Pe)||gs(Pe)||la(Pe)?{i:dl,r:Pe,k:et,f:!!m}:Pe:null;function uc(Pe,et=null,m=null,G=0,W=null,d=Pe===Js?0:1,v=!1,w=!1){const y={__v_isVNode:!0,__v_skip:!0,type:Pe,props:et,key:et&&Q0(et),ref:et&&vf(et),scopeId:Lf,slotScopeIds:null,children:m,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:G,dynamicProps:W,dynamicChildren:null,appContext:null};return w?(up(y,m),d&128&&Pe.normalize(y)):m&&(y.shapeFlag|=os(m)?8:16),wu>0&&!v&&Qs&&(y.patchFlag>0||d&6)&&y.patchFlag!==32&&Qs.push(y),y}const tl=Sv;function Sv(Pe,et=null,m=null,G=0,W=null,d=!1){if((!Pe||Pe===ov)&&(Pe=kl),Av(Pe)){const w=Vl(Pe,et,!0);return m&&up(w,m),wu>0&&!d&&Qs&&(w.shapeFlag&6?Qs[Qs.indexOf(Pe)]=w:Qs.push(w)),w.patchFlag|=-2,w}if(jv(Pe)&&(Pe=Pe.__vccOpts),et){et=Ev(et);let{class:w,style:y}=et;w&&!os(w)&&(et.class=Hh(w)),Oo(y)&&(A0(y)&&!ta(y)&&(y=as({},y)),et.style=Vh(y))}const v=os(Pe)?1:H1(Pe)?128:Tv(Pe)?64:Oo(Pe)?4:la(Pe)?2:0;return uc(Pe,et,m,G,W,v,d,!0)}function Ev(Pe){return Pe?A0(Pe)||If in Pe?as({},Pe):Pe:null}function Vl(Pe,et,m=!1){const{props:G,ref:W,patchFlag:d,children:v}=Pe,w=et?Pv(G||{},et):G;return{__v_isVNode:!0,__v_skip:!0,type:Pe.type,props:w,key:w&&Q0(w),ref:et&&et.ref?m&&W?ta(W)?W.concat(vf(et)):[W,vf(et)]:vf(et):W,scopeId:Pe.scopeId,slotScopeIds:Pe.slotScopeIds,children:v,target:Pe.target,targetAnchor:Pe.targetAnchor,staticCount:Pe.staticCount,shapeFlag:Pe.shapeFlag,patchFlag:et&&Pe.type!==Js?d===-1?16:d|16:d,dynamicProps:Pe.dynamicProps,dynamicChildren:Pe.dynamicChildren,appContext:Pe.appContext,dirs:Pe.dirs,transition:Pe.transition,component:Pe.component,suspense:Pe.suspense,ssContent:Pe.ssContent&&Vl(Pe.ssContent),ssFallback:Pe.ssFallback&&Vl(Pe.ssFallback),el:Pe.el,anchor:Pe.anchor}}function Lv(Pe=" ",et=0){return tl(sp,null,Pe,et)}function Cv(Pe,et){const m=tl(gf,null,Pe);return m.staticCount=et,m}function hl(Pe){return Pe==null||typeof Pe=="boolean"?tl(kl):ta(Pe)?tl(Js,null,Pe.slice()):typeof Pe=="object"?Bl(Pe):tl(sp,null,String(Pe))}function Bl(Pe){return Pe.el===null&&Pe.patchFlag!==-1||Pe.memo?Pe:Vl(Pe)}function up(Pe,et){let m=0;const{shapeFlag:G}=Pe;if(et==null)et=null;else if(ta(et))m=16;else if(typeof et=="object")if(G&65){const W=et.default;W&&(W._c&&(W._d=!1),up(Pe,W()),W._c&&(W._d=!0));return}else{m=32;const W=et._;!W&&!(If in et)?et._ctx=dl:W===3&&dl&&(dl.slots._===1?et._=1:(et._=2,Pe.patchFlag|=1024))}else la(et)?(et={default:et,_ctx:dl},m=32):(et=String(et),G&64?(m=16,et=[Lv(et)]):m=8);Pe.children=et,Pe.shapeFlag|=m}function Pv(...Pe){const et={};for(let m=0;m<Pe.length;m++){const G=Pe[m];for(const W in G)if(W==="class")et.class!==G.class&&(et.class=Hh([et.class,G.class]));else if(W==="style")et.style=Vh([et.style,G.style]);else if(Tf(W)){const d=et[W],v=G[W];v&&d!==v&&!(ta(d)&&d.includes(v))&&(et[W]=d?[].concat(d,v):v)}else W!==""&&(et[W]=G[W])}return et}function ul(Pe,et,m,G=null){zs(Pe,et,7,[m,G])}const Iv=J0();let Ov=0;function Dv(Pe,et,m){const G=Pe.type,W=(et?et.appContext:Pe.appContext)||Iv,d={uid:Ov++,vnode:Pe,type:G,parent:et,appContext:W,root:null,next:null,subTree:null,effect:null,update:null,scope:new Jg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:et?et.provides:Object.create(W.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:W0(G,W),emitsOptions:D0(G,W),emit:null,emitted:null,propsDefaults:Xa,inheritAttrs:G.inheritAttrs,ctx:Xa,data:Xa,props:Xa,attrs:Xa,slots:Xa,refs:Xa,setupState:Xa,setupContext:null,suspense:m,suspenseId:m?m.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=et?et.root:d,d.emit=F1.bind(null,d),Pe.ce&&Pe.ce(d),d}let Qo=null;const zv=()=>Qo||dl,Hc=Pe=>{Qo=Pe,Pe.scope.on()},cc=()=>{Qo&&Qo.scope.off(),Qo=null};function em(Pe){return Pe.vnode.shapeFlag&4}let Tu=!1;function Rv(Pe,et=!1){Tu=et;const{props:m,children:G}=Pe.vnode,W=em(Pe);pv(Pe,m,W,et),gv(Pe,G);const d=W?Fv(Pe,et):void 0;return Tu=!1,d}function Fv(Pe,et){const m=Pe.type;Pe.accessCache=Object.create(null),Pe.proxy=S0(new Proxy(Pe.ctx,sv));const{setup:G}=m;if(G){const W=Pe.setupContext=G.length>1?Nv(Pe):null;Hc(Pe),Gc();const d=jl(G,Pe,0,[Pe.props,W]);if(Yc(),cc(),p0(d)){if(d.then(cc,cc),et)return d.then(v=>{n0(Pe,v,et)}).catch(v=>{Sf(v,Pe,0)});Pe.asyncDep=d}else n0(Pe,d,et)}else tm(Pe,et)}function n0(Pe,et,m){la(et)?Pe.type.__ssrInlineRender?Pe.ssrRender=et:Pe.render=et:Oo(et)&&(Pe.setupState=E0(et)),tm(Pe,m)}let i0;function tm(Pe,et,m){const G=Pe.type;if(!Pe.render){if(!et&&i0&&!G.render){const W=G.template||ap(Pe).template;if(W){const{isCustomElement:d,compilerOptions:v}=Pe.appContext.config,{delimiters:w,compilerOptions:y}=G,e=as(as({isCustomElement:d,delimiters:w},v),y);G.render=i0(W,e)}}Pe.render=G.render||el}Hc(Pe),Gc(),lv(Pe),Yc(),cc()}function Bv(Pe){return new Proxy(Pe.attrs,{get(et,m){return Ls(Pe,"get","$attrs"),et[m]}})}function Nv(Pe){const et=G=>{Pe.exposed=G||{}};let m;return{get attrs(){return m||(m=Bv(Pe))},slots:Pe.slots,emit:Pe.emit,expose:et}}function fp(Pe){if(Pe.exposed)return Pe.exposeProxy||(Pe.exposeProxy=new Proxy(E0(S0(Pe.exposed)),{get(et,m){if(m in et)return et[m];if(m in _f)return _f[m](Pe)}}))}function jv(Pe){return la(Pe)&&"__vccOpts"in Pe}const Uv=(Pe,et)=>C1(Pe,et,Tu),Vv="3.2.41",Hv="http://www.w3.org/2000/svg",sc=typeof document<"u"?document:null,a0=sc&&sc.createElement("template"),qv={insert:(Pe,et,m)=>{et.insertBefore(Pe,m||null)},remove:Pe=>{const et=Pe.parentNode;et&&et.removeChild(Pe)},createElement:(Pe,et,m,G)=>{const W=et?sc.createElementNS(Hv,Pe):sc.createElement(Pe,m?{is:m}:void 0);return Pe==="select"&&G&&G.multiple!=null&&W.setAttribute("multiple",G.multiple),W},createText:Pe=>sc.createTextNode(Pe),createComment:Pe=>sc.createComment(Pe),setText:(Pe,et)=>{Pe.nodeValue=et},setElementText:(Pe,et)=>{Pe.textContent=et},parentNode:Pe=>Pe.parentNode,nextSibling:Pe=>Pe.nextSibling,querySelector:Pe=>sc.querySelector(Pe),setScopeId(Pe,et){Pe.setAttribute(et,"")},insertStaticContent(Pe,et,m,G,W,d){const v=m?m.previousSibling:et.lastChild;if(W&&(W===d||W.nextSibling))for(;et.insertBefore(W.cloneNode(!0),m),!(W===d||!(W=W.nextSibling)););else{a0.innerHTML=G?`<svg>${Pe}</svg>`:Pe;const w=a0.content;if(G){const y=w.firstChild;for(;y.firstChild;)w.appendChild(y.firstChild);w.removeChild(y)}et.insertBefore(w,m)}return[v?v.nextSibling:et.firstChild,m?m.previousSibling:et.lastChild]}};function Gv(Pe,et,m){const G=Pe._vtc;G&&(et=(et?[et,...G]:[...G]).join(" ")),et==null?Pe.removeAttribute("class"):m?Pe.setAttribute("class",et):Pe.className=et}function Yv(Pe,et,m){const G=Pe.style,W=os(m);if(m&&!W){for(const d in m)jh(G,d,m[d]);if(et&&!os(et))for(const d in et)m[d]==null&&jh(G,d,"")}else{const d=G.display;W?et!==m&&(G.cssText=m):et&&Pe.removeAttribute("style"),"_vod"in Pe&&(G.display=d)}}const o0=/\s*!important$/;function jh(Pe,et,m){if(ta(m))m.forEach(G=>jh(Pe,et,G));else if(m==null&&(m=""),et.startsWith("--"))Pe.setProperty(et,m);else{const G=Wv(Pe,et);o0.test(m)?Pe.setProperty(qc(G),m.replace(o0,""),"important"):Pe[G]=m}}const s0=["Webkit","Moz","ms"],kh={};function Wv(Pe,et){const m=kh[et];if(m)return m;let G=Vc(et);if(G!=="filter"&&G in Pe)return kh[et]=G;G=d0(G);for(let W=0;W<s0.length;W++){const d=s0[W]+G;if(d in Pe)return kh[et]=d}return et}const l0="http://www.w3.org/1999/xlink";function Zv(Pe,et,m,G,W){if(G&&et.startsWith("xlink:"))m==null?Pe.removeAttributeNS(l0,et.slice(6,et.length)):Pe.setAttributeNS(l0,et,m);else{const d=Rg(et);m==null||d&&!h0(m)?Pe.removeAttribute(et):Pe.setAttribute(et,d?"":m)}}function Xv(Pe,et,m,G,W,d,v){if(et==="innerHTML"||et==="textContent"){G&&v(G,W,d),Pe[et]=m==null?"":m;return}if(et==="value"&&Pe.tagName!=="PROGRESS"&&!Pe.tagName.includes("-")){Pe._value=m;const y=m==null?"":m;(Pe.value!==y||Pe.tagName==="OPTION")&&(Pe.value=y),m==null&&Pe.removeAttribute(et);return}let w=!1;if(m===""||m==null){const y=typeof Pe[et];y==="boolean"?m=h0(m):m==null&&y==="string"?(m="",w=!0):y==="number"&&(m=0,w=!0)}try{Pe[et]=m}catch{}w&&Pe.removeAttribute(et)}function Kv(Pe,et,m,G){Pe.addEventListener(et,m,G)}function Jv(Pe,et,m,G){Pe.removeEventListener(et,m,G)}function $v(Pe,et,m,G,W=null){const d=Pe._vei||(Pe._vei={}),v=d[et];if(G&&v)v.value=G;else{const[w,y]=Qv(et);if(G){const e=d[et]=ry(G,W);Kv(Pe,w,e,y)}else v&&(Jv(Pe,w,v,y),d[et]=void 0)}}const c0=/(?:Once|Passive|Capture)$/;function Qv(Pe){let et;if(c0.test(Pe)){et={};let G;for(;G=Pe.match(c0);)Pe=Pe.slice(0,Pe.length-G[0].length),et[G[0].toLowerCase()]=!0}return[Pe[2]===":"?Pe.slice(3):qc(Pe.slice(2)),et]}let Mh=0;const ey=Promise.resolve(),ty=()=>Mh||(ey.then(()=>Mh=0),Mh=Date.now());function ry(Pe,et){const m=G=>{if(!G._vts)G._vts=Date.now();else if(G._vts<=m.attached)return;zs(ny(G,m.value),et,5,[G])};return m.value=Pe,m.attached=ty(),m}function ny(Pe,et){if(ta(et)){const m=Pe.stopImmediatePropagation;return Pe.stopImmediatePropagation=()=>{m.call(Pe),Pe._stopped=!0},et.map(G=>W=>!W._stopped&&G&&G(W))}else return et}const u0=/^on[a-z]/,iy=(Pe,et,m,G,W=!1,d,v,w,y)=>{et==="class"?Gv(Pe,G,W):et==="style"?Yv(Pe,m,G):Tf(et)?qh(et)||$v(Pe,et,m,G,v):(et[0]==="."?(et=et.slice(1),!0):et[0]==="^"?(et=et.slice(1),!1):ay(Pe,et,G,W))?Xv(Pe,et,G,d,v,w,y):(et==="true-value"?Pe._trueValue=G:et==="false-value"&&(Pe._falseValue=G),Zv(Pe,et,G,W))};function ay(Pe,et,m,G){return G?!!(et==="innerHTML"||et==="textContent"||et in Pe&&u0.test(et)&&la(m)):et==="spellcheck"||et==="draggable"||et==="translate"||et==="form"||et==="list"&&Pe.tagName==="INPUT"||et==="type"&&Pe.tagName==="TEXTAREA"||u0.test(et)&&os(m)?!1:et in Pe}const oy={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};X1.props;const sy=as({patchProp:iy},qv);let f0;function ly(){return f0||(f0=bv(sy))}const cy=(...Pe)=>{const et=ly().createApp(...Pe),{mount:m}=et;return et.mount=G=>{const W=uy(G);if(!W)return;const d=et._component;!la(d)&&!d.render&&!d.template&&(d.template=W.innerHTML),W.innerHTML="";const v=m(W,!1,W instanceof SVGElement);return W instanceof Element&&(W.removeAttribute("v-cloak"),W.setAttribute("data-v-app","")),v},et};function uy(Pe){return os(Pe)?document.querySelector(Pe):Pe}const Of=(Pe,et)=>{const m=Pe.__vccOpts||Pe;for(const[G,W]of et)m[G]=W;return m};const fy="/palbert/assets/background.d0017ff7.svg";const hy={},rm=Pe=>(z0("data-v-70bfa382"),Pe=Pe(),R0(),Pe),py={class:"container"},dy=rm(()=>uc("img",{alt:"",class:"b-image",src:fy},null,-1)),my=rm(()=>uc("h1",{class:"title"},"PALBERT: Teaching ALBERT to Ponder",-1)),gy=[dy,my];function vy(Pe,et){return lp(),cp("div",py,gy)}const yy=Of(hy,[["render",vy],["__scopeId","data-v-70bfa382"]]),xy="/palbert/assets/early_exit_vue.5fba34a8.svg",by="/palbert/assets/uncongd_prob_vue.2f6bf94f.svg",_y="/palbert/assets/loss_vue.36de9e28.svg";const wy={},Ty=Cv('<h1 data-v-8d074564>Early Exit</h1><div class="text" data-v-8d074564>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</div><div class="pic-container" data-v-8d074564><img class="pic" alt="" src="'+xy+'" data-v-8d074564></div><div class="text" data-v-8d074564>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore</div><div class="pic-container" data-v-8d074564><img class="pic-small" alt="" src="'+by+'" data-v-8d074564></div><div class="text" data-v-8d074564>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore</div><div class="pic-container" data-v-8d074564><img class="pic" alt="" src="'+_y+'" data-v-8d074564></div>',7);function ky(Pe,et){return Ty}const My=Of(wy,[["render",ky],["__scopeId","data-v-8d074564"]]);var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ay(Pe){return Pe&&Pe.__esModule&&Object.prototype.hasOwnProperty.call(Pe,"default")?Pe.default:Pe}function pf(Pe){throw new Error('Could not dynamically require "'+Pe+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nm={exports:{}};(function(Pe,et){(function(m){Pe.exports=m()})(function(){return function m(G,W,d){function v(e,t){if(!W[e]){if(!G[e]){var n=typeof pf=="function"&&pf;if(!t&&n)return n(e,!0);if(w)return w(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var r=W[e]={exports:{}};G[e][0].call(r.exports,function(g){return v(G[e][1][g]||g)},r,r.exports,m,G,W,d)}return W[e].exports}for(var w=typeof pf=="function"&&pf,y=0;y<d.length;y++)v(d[y]);return v}({1:[function(m,G,W){var d=m("../src/lib"),v={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var w in v){var y=w.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");d.addStyleRule(y,v[w])}},{"../src/lib":515}],2:[function(m,G,W){G.exports=m("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(m,G,W){G.exports=m("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(m,G,W){G.exports=m("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(m,G,W){G.exports=m("../src/traces/box")},{"../src/traces/box":688}],6:[function(m,G,W){G.exports=m("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(m,G,W){G.exports=m("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(m,G,W){G.exports=m("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(m,G,W){G.exports=m("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(m,G,W){G.exports=m("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(m,G,W){G.exports=m("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(m,G,W){G.exports=m("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(m,G,W){G.exports=m("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(m,G,W){G.exports=m("../src/core")},{"../src/core":493}],15:[function(m,G,W){G.exports=m("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(m,G,W){G.exports=m("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(m,G,W){G.exports=m("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(m,G,W){G.exports=m("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(m,G,W){G.exports=m("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(m,G,W){G.exports=m("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(m,G,W){G.exports=m("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(m,G,W){G.exports=m("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(m,G,W){G.exports=m("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(m,G,W){G.exports=m("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(m,G,W){G.exports=m("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(m,G,W){G.exports=m("../src/traces/image")},{"../src/traces/image":861}],27:[function(m,G,W){var d=m("./core");d.register([m("./bar"),m("./box"),m("./heatmap"),m("./histogram"),m("./histogram2d"),m("./histogram2dcontour"),m("./contour"),m("./scatterternary"),m("./violin"),m("./funnel"),m("./waterfall"),m("./image"),m("./pie"),m("./sunburst"),m("./treemap"),m("./icicle"),m("./funnelarea"),m("./scatter3d"),m("./surface"),m("./isosurface"),m("./volume"),m("./mesh3d"),m("./cone"),m("./streamtube"),m("./scattergeo"),m("./choropleth"),m("./scattergl"),m("./splom"),m("./pointcloud"),m("./heatmapgl"),m("./parcoords"),m("./parcats"),m("./scattermapbox"),m("./choroplethmapbox"),m("./densitymapbox"),m("./sankey"),m("./indicator"),m("./table"),m("./carpet"),m("./scattercarpet"),m("./contourcarpet"),m("./ohlc"),m("./candlestick"),m("./scatterpolar"),m("./scatterpolargl"),m("./barpolar"),m("./scattersmith"),m("./aggregate"),m("./filter"),m("./groupby"),m("./sort"),m("./calendars")]),G.exports=d},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(m,G,W){G.exports=m("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(m,G,W){G.exports=m("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(m,G,W){G.exports=m("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(m,G,W){G.exports=m("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(m,G,W){G.exports=m("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(m,G,W){G.exports=m("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(m,G,W){G.exports=m("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(m,G,W){G.exports=m("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(m,G,W){G.exports=m("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(m,G,W){G.exports=m("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(m,G,W){G.exports=m("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(m,G,W){G.exports=m("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(m,G,W){G.exports=m("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(m,G,W){G.exports=m("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(m,G,W){G.exports=m("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(m,G,W){G.exports=m("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(m,G,W){G.exports=m("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(m,G,W){G.exports=m("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(m,G,W){G.exports=m("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(m,G,W){G.exports=m("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(m,G,W){G.exports=m("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(m,G,W){G.exports=m("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(m,G,W){G.exports=m("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(m,G,W){G.exports=m("../src/traces/table")},{"../src/traces/table":1082}],52:[function(m,G,W){G.exports=m("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(m,G,W){G.exports=m("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(m,G,W){G.exports=m("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(m,G,W){G.exports=m("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-array"),m("d3-collection"),m("d3-shape"),m("elementary-circuits-directed-graph")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3,null)})(this,function(d,v,w,y,e){function t(ee){return ee.target.depth}function n(ee,re){return ee.sourceLinks.length?ee.depth:re-1}function a(ee){return function(){return ee}}e=e&&e.hasOwnProperty("default")?e.default:e;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee};function g(ee,re){return s(ee.source,re.source)||ee.index-re.index}function u(ee,re){return s(ee.target,re.target)||ee.index-re.index}function s(ee,re){return ee.partOfCycle===re.partOfCycle?ee.y0-re.y0:ee.circularLinkType==="top"||re.circularLinkType==="bottom"?-1:1}function h(ee){return ee.value}function l(ee){return(ee.y0+ee.y1)/2}function o(ee){return l(ee.source)}function p(ee){return l(ee.target)}function c(ee){return ee.index}function i(ee){return ee.nodes}function x(ee){return ee.links}function f(ee,re){var se=ee.get(re);if(!se)throw new Error("missing: "+re);return se}function _(ee,re){return re(ee)}function b(ee,re,se){var oe=0;if(se===null){for(var de=[],ce=0;ce<ee.links.length;ce++){var ve=ee.links[ce],Ae=ve.source.index,fe=ve.target.index;de[Ae]||(de[Ae]=[]),de[fe]||(de[fe]=[]),de[Ae].indexOf(fe)===-1&&de[Ae].push(fe)}var me=e(de);me.sort(function(ge,Te){return ge.length-Te.length});var _e={};for(ce=0;ce<me.length;ce++){var le=me[ce].slice(-2);_e[le[0]]||(_e[le[0]]={}),_e[le[0]][le[1]]=!0}ee.links.forEach(function(ge){var Te=ge.target.index,Se=ge.source.index;Te===Se||_e[Se]&&_e[Se][Te]?(ge.circular=!0,ge.circularLinkID=oe,oe+=1):ge.circular=!1})}else ee.links.forEach(function(ge){ge.source[se]<ge.target[se]?ge.circular=!1:(ge.circular=!0,ge.circularLinkID=oe,oe+=1)})}function T(ee,re){var se=0,oe=0;ee.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=se<oe?"top":"bottom",de.circularLinkType=="top"?se+=1:oe+=1,ee.nodes.forEach(function(ce){_(ce,re)!=_(de.source,re)&&_(ce,re)!=_(de.target,re)||(ce.circularLinkType=de.circularLinkType)}))}),ee.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),X(de,re)&&(de.circularLinkType=de.source.circularLinkType))})}function k(ee){var re=Math.abs(ee.y1-ee.y0),se=Math.abs(ee.target.x0-ee.source.x1);return Math.atan(se/re)}function L(ee,re){var se=0;ee.sourceLinks.forEach(function(de){se=de.circular&&!X(de,re)?se+1:se});var oe=0;return ee.targetLinks.forEach(function(de){oe=de.circular&&!X(de,re)?oe+1:oe}),se+oe}function A(ee){var re=ee.source.sourceLinks,se=0;re.forEach(function(ce){se=ce.circular?se+1:se});var oe=ee.target.targetLinks,de=0;return oe.forEach(function(ce){de=ce.circular?de+1:de}),!(se>1||de>1)}function I(ee,re,se){return ee.sort(S),ee.forEach(function(oe,de){var ce,ve,Ae=0;if(X(oe,se)&&A(oe))oe.circularPathData.verticalBuffer=Ae+oe.width/2;else{for(var fe=0;fe<de;fe++)if(ce=ee[de],ve=ee[fe],!(ce.source.column<ve.target.column||ce.target.column>ve.source.column)){var me=ee[fe].circularPathData.verticalBuffer+ee[fe].width/2+re;Ae=me>Ae?me:Ae}oe.circularPathData.verticalBuffer=Ae+oe.width/2}}),ee}function P(ee,re,se,oe){var de=v.min(ee.links,function(ce){return ce.source.y0});ee.links.forEach(function(ce){ce.circular&&(ce.circularPathData={})}),I(ee.links.filter(function(ce){return ce.circularLinkType=="top"}),re,oe),I(ee.links.filter(function(ce){return ce.circularLinkType=="bottom"}),re,oe),ee.links.forEach(function(ce){if(ce.circular){if(ce.circularPathData.arcRadius=ce.width+10,ce.circularPathData.leftNodeBuffer=5,ce.circularPathData.rightNodeBuffer=5,ce.circularPathData.sourceWidth=ce.source.x1-ce.source.x0,ce.circularPathData.sourceX=ce.source.x0+ce.circularPathData.sourceWidth,ce.circularPathData.targetX=ce.target.x0,ce.circularPathData.sourceY=ce.y0,ce.circularPathData.targetY=ce.y1,X(ce,oe)&&A(ce))ce.circularPathData.leftSmallArcRadius=10+ce.width/2,ce.circularPathData.leftLargeArcRadius=10+ce.width/2,ce.circularPathData.rightSmallArcRadius=10+ce.width/2,ce.circularPathData.rightLargeArcRadius=10+ce.width/2,ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=ce.source.y1+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=ce.source.y0-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius);else{var ve=ce.source.column,Ae=ce.circularLinkType,fe=ee.links.filter(function(le){return le.source.column==ve&&le.circularLinkType==Ae});ce.circularLinkType=="bottom"?fe.sort(z):fe.sort(E);var me=0;fe.forEach(function(le,ge){le.circularLinkID==ce.circularLinkID&&(ce.circularPathData.leftSmallArcRadius=10+ce.width/2+me,ce.circularPathData.leftLargeArcRadius=10+ce.width/2+ge*re+me),me+=le.width}),ve=ce.target.column,fe=ee.links.filter(function(le){return le.target.column==ve&&le.circularLinkType==Ae}),ce.circularLinkType=="bottom"?fe.sort(j):fe.sort(D),me=0,fe.forEach(function(le,ge){le.circularLinkID==ce.circularLinkID&&(ce.circularPathData.rightSmallArcRadius=10+ce.width/2+me,ce.circularPathData.rightLargeArcRadius=10+ce.width/2+ge*re+me),me+=le.width}),ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=Math.max(se,ce.source.y1,ce.target.y1)+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=de-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius)}ce.circularPathData.leftInnerExtent=ce.circularPathData.sourceX+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightInnerExtent=ce.circularPathData.targetX-ce.circularPathData.rightNodeBuffer,ce.circularPathData.leftFullExtent=ce.circularPathData.sourceX+ce.circularPathData.leftLargeArcRadius+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightFullExtent=ce.circularPathData.targetX-ce.circularPathData.rightLargeArcRadius-ce.circularPathData.rightNodeBuffer}if(ce.circular)ce.path=function(le){var ge="";return ge=le.circularLinkType=="top"?"M"+le.circularPathData.sourceX+" "+le.circularPathData.sourceY+" L"+le.circularPathData.leftInnerExtent+" "+le.circularPathData.sourceY+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftSmallArcRadius+" 0 0 0 "+le.circularPathData.leftFullExtent+" "+(le.circularPathData.sourceY-le.circularPathData.leftSmallArcRadius)+" L"+le.circularPathData.leftFullExtent+" "+le.circularPathData.verticalLeftInnerExtent+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftLargeArcRadius+" 0 0 0 "+le.circularPathData.leftInnerExtent+" "+le.circularPathData.verticalFullExtent+" L"+le.circularPathData.rightInnerExtent+" "+le.circularPathData.verticalFullExtent+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightLargeArcRadius+" 0 0 0 "+le.circularPathData.rightFullExtent+" "+le.circularPathData.verticalRightInnerExtent+" L"+le.circularPathData.rightFullExtent+" "+(le.circularPathData.targetY-le.circularPathData.rightSmallArcRadius)+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightSmallArcRadius+" 0 0 0 "+le.circularPathData.rightInnerExtent+" "+le.circularPathData.targetY+" L"+le.circularPathData.targetX+" "+le.circularPathData.targetY:"M"+le.circularPathData.sourceX+" "+le.circularPathData.sourceY+" L"+le.circularPathData.leftInnerExtent+" "+le.circularPathData.sourceY+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftSmallArcRadius+" 0 0 1 "+le.circularPathData.leftFullExtent+" "+(le.circularPathData.sourceY+le.circularPathData.leftSmallArcRadius)+" L"+le.circularPathData.leftFullExtent+" "+le.circularPathData.verticalLeftInnerExtent+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftLargeArcRadius+" 0 0 1 "+le.circularPathData.leftInnerExtent+" "+le.circularPathData.verticalFullExtent+" L"+le.circularPathData.rightInnerExtent+" "+le.circularPathData.verticalFullExtent+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightLargeArcRadius+" 0 0 1 "+le.circularPathData.rightFullExtent+" "+le.circularPathData.verticalRightInnerExtent+" L"+le.circularPathData.rightFullExtent+" "+(le.circularPathData.targetY+le.circularPathData.rightSmallArcRadius)+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightSmallArcRadius+" 0 0 1 "+le.circularPathData.rightInnerExtent+" "+le.circularPathData.targetY+" L"+le.circularPathData.targetX+" "+le.circularPathData.targetY,ge}(ce);else{var _e=y.linkHorizontal().source(function(le){return[le.source.x0+(le.source.x1-le.source.x0),le.y0]}).target(function(le){return[le.target.x0,le.y1]});ce.path=_e(ce)}})}function S(ee,re){return V(ee)==V(re)?ee.circularLinkType=="bottom"?z(ee,re):E(ee,re):V(re)-V(ee)}function E(ee,re){return ee.y0-re.y0}function z(ee,re){return re.y0-ee.y0}function D(ee,re){return ee.y1-re.y1}function j(ee,re){return re.y1-ee.y1}function V(ee){return ee.target.column-ee.source.column}function Z(ee){return ee.target.x0-ee.source.x1}function Q(ee,re){var se=k(ee),oe=Z(re)/Math.tan(se);return B(ee)=="up"?ee.y1+oe:ee.y1-oe}function K(ee,re){var se=k(ee),oe=Z(re)/Math.tan(se);return B(ee)=="up"?ee.y1-oe:ee.y1+oe}function $(ee,re,se,oe){ee.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var ce=de.source.column+1,ve=de.target.column-1,Ae=1,fe=ve-ce+1;for(Ae=1;ce<=ve;ce++,Ae++)ee.nodes.forEach(function(me){if(me.column==ce){var _e,le=Ae/(fe+1),ge=Math.pow(1-le,3),Te=3*le*Math.pow(1-le,2),Se=3*Math.pow(le,2)*(1-le),Me=Math.pow(le,3),ze=ge*de.y0+Te*de.y0+Se*de.y1+Me*de.y1,Oe=ze-de.width/2,De=ze+de.width/2;Oe>me.y0&&Oe<me.y1?(_e=me.y1-Oe+10,_e=me.circularLinkType=="bottom"?_e:-_e,me=H(me,_e,re,se),ee.nodes.forEach(function(Xe){_(Xe,oe)!=_(me,oe)&&Xe.column==me.column&&ne(me,Xe)&&H(Xe,_e,re,se)})):(De>me.y0&&De<me.y1||Oe<me.y0&&De>me.y1)&&(_e=De-me.y0+10,me=H(me,_e,re,se),ee.nodes.forEach(function(Xe){_(Xe,oe)!=_(me,oe)&&Xe.column==me.column&&Xe.y0<me.y1&&Xe.y1>me.y1&&H(Xe,_e,re,se)}))}})}})}function ne(ee,re){return ee.y0>re.y0&&ee.y0<re.y1||ee.y1>re.y0&&ee.y1<re.y1||ee.y0<re.y0&&ee.y1>re.y1}function H(ee,re,se,oe){return ee.y0+re>=se&&ee.y1+re<=oe&&(ee.y0=ee.y0+re,ee.y1=ee.y1+re,ee.targetLinks.forEach(function(de){de.y1=de.y1+re}),ee.sourceLinks.forEach(function(de){de.y0=de.y0+re})),ee}function N(ee,re,se,oe){ee.nodes.forEach(function(de){oe&&de.y+(de.y1-de.y0)>re&&(de.y=de.y-(de.y+(de.y1-de.y0)-re));var ce=ee.links.filter(function(fe){return _(fe.source,se)==_(de,se)}),ve=ce.length;ve>1&&ce.sort(function(fe,me){if(!fe.circular&&!me.circular){if(fe.target.column==me.target.column||!te(fe,me))return fe.y1-me.y1;if(fe.target.column>me.target.column){var _e=K(me,fe);return fe.y1-_e}if(me.target.column>fe.target.column)return K(fe,me)-me.y1}return fe.circular&&!me.circular?fe.circularLinkType=="top"?-1:1:me.circular&&!fe.circular?me.circularLinkType=="top"?1:-1:fe.circular&&me.circular?fe.circularLinkType===me.circularLinkType&&fe.circularLinkType=="top"?fe.target.column===me.target.column?fe.target.y1-me.target.y1:me.target.column-fe.target.column:fe.circularLinkType===me.circularLinkType&&fe.circularLinkType=="bottom"?fe.target.column===me.target.column?me.target.y1-fe.target.y1:fe.target.column-me.target.column:fe.circularLinkType=="top"?-1:1:void 0});var Ae=de.y0;ce.forEach(function(fe){fe.y0=Ae+fe.width/2,Ae+=fe.width}),ce.forEach(function(fe,me){if(fe.circularLinkType=="bottom"){for(var _e=me+1,le=0;_e<ve;_e++)le+=ce[_e].width;fe.y0=de.y1-le-fe.width/2}})})}function U(ee,re,se){ee.nodes.forEach(function(oe){var de=ee.links.filter(function(Ae){return _(Ae.target,se)==_(oe,se)}),ce=de.length;ce>1&&de.sort(function(Ae,fe){if(!Ae.circular&&!fe.circular){if(Ae.source.column==fe.source.column||!te(Ae,fe))return Ae.y0-fe.y0;if(fe.source.column<Ae.source.column){var me=Q(fe,Ae);return Ae.y0-me}if(Ae.source.column<fe.source.column)return Q(Ae,fe)-fe.y0}return Ae.circular&&!fe.circular?Ae.circularLinkType=="top"?-1:1:fe.circular&&!Ae.circular?fe.circularLinkType=="top"?1:-1:Ae.circular&&fe.circular?Ae.circularLinkType===fe.circularLinkType&&Ae.circularLinkType=="top"?Ae.source.column===fe.source.column?Ae.source.y1-fe.source.y1:Ae.source.column-fe.source.column:Ae.circularLinkType===fe.circularLinkType&&Ae.circularLinkType=="bottom"?Ae.source.column===fe.source.column?Ae.source.y1-fe.source.y1:fe.source.column-Ae.source.column:Ae.circularLinkType=="top"?-1:1:void 0});var ve=oe.y0;de.forEach(function(Ae){Ae.y1=ve+Ae.width/2,ve+=Ae.width}),de.forEach(function(Ae,fe){if(Ae.circularLinkType=="bottom"){for(var me=fe+1,_e=0;me<ce;me++)_e+=de[me].width;Ae.y1=oe.y1-_e-Ae.width/2}})})}function te(ee,re){return B(ee)==B(re)}function B(ee){return ee.y0-ee.y1>0?"up":"down"}function X(ee,re){return _(ee.source,re)==_(ee.target,re)}function J(ee,re,se){var oe=ee.nodes,de=ee.links,ce=!1,ve=!1;if(de.forEach(function(me){me.circularLinkType=="top"?ce=!0:me.circularLinkType=="bottom"&&(ve=!0)}),ce==0||ve==0){var Ae=v.min(oe,function(me){return me.y0}),fe=(se-re)/(v.max(oe,function(me){return me.y1})-Ae);oe.forEach(function(me){var _e=(me.y1-me.y0)*fe;me.y0=(me.y0-Ae)*fe,me.y1=me.y0+_e}),de.forEach(function(me){me.y0=(me.y0-Ae)*fe,me.y1=(me.y1-Ae)*fe,me.width=me.width*fe})}}d.sankeyCircular=function(){var ee,re,se=0,oe=0,de=1,ce=1,ve=24,Ae=c,fe=n,me=i,_e=x,le=32,ge=2,Te=null;function Se(){var Be={nodes:me.apply(null,arguments),links:_e.apply(null,arguments)};Me(Be),b(Be,Ae,Te),ze(Be),Oe(Be),T(Be,Ae),De(Be,le,Ae),Xe(Be);for(var Ie=4,Re=0;Re<Ie;Re++)N(Be,ce,Ae),U(Be,ce,Ae),$(Be,oe,ce,Ae),N(Be,ce,Ae),U(Be,ce,Ae);return J(Be,oe,ce),P(Be,ge,ce,Ae),Be}function Me(Be){Be.nodes.forEach(function(Re,Ye){Re.index=Ye,Re.sourceLinks=[],Re.targetLinks=[]});var Ie=w.map(Be.nodes,Ae);return Be.links.forEach(function(Re,Ye){Re.index=Ye;var Qe=Re.source,lt=Re.target;(Qe===void 0?"undefined":r(Qe))!=="object"&&(Qe=Re.source=f(Ie,Qe)),(lt===void 0?"undefined":r(lt))!=="object"&&(lt=Re.target=f(Ie,lt)),Qe.sourceLinks.push(Re),lt.targetLinks.push(Re)}),Be}function ze(Be){Be.nodes.forEach(function(Ie){Ie.partOfCycle=!1,Ie.value=Math.max(v.sum(Ie.sourceLinks,h),v.sum(Ie.targetLinks,h)),Ie.sourceLinks.forEach(function(Re){Re.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Re.circularLinkType)}),Ie.targetLinks.forEach(function(Re){Re.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Re.circularLinkType)})})}function Oe(Be){var Ie,Re,Ye;for(Ie=Be.nodes,Re=[],Ye=0;Ie.length;++Ye,Ie=Re,Re=[])Ie.forEach(function(Qe){Qe.depth=Ye,Qe.sourceLinks.forEach(function(lt){Re.indexOf(lt.target)<0&&!lt.circular&&Re.push(lt.target)})});for(Ie=Be.nodes,Re=[],Ye=0;Ie.length;++Ye,Ie=Re,Re=[])Ie.forEach(function(Qe){Qe.height=Ye,Qe.targetLinks.forEach(function(lt){Re.indexOf(lt.source)<0&&!lt.circular&&Re.push(lt.source)})});Be.nodes.forEach(function(Qe){Qe.column=Math.floor(fe.call(null,Qe,Ye))})}function De(Be,Ie,Re){var Ye=w.nest().key(function(bt){return bt.column}).sortKeys(v.ascending).entries(Be.nodes).map(function(bt){return bt.values});(function(bt){if(re){var nt=1/0;Ye.forEach(function(qt){var Jt=ce*re/(qt.length+1);nt=Jt<nt?Jt:nt}),ee=nt}var $e=v.min(Ye,function(qt){return(ce-oe-(qt.length-1)*ee)/v.sum(qt,h)});$e*=.3,Be.links.forEach(function(qt){qt.width=qt.value*$e});var vt=function(qt){var Jt=0,Wt=0,ar=0,Dt=0,Ne=v.max(qt.nodes,function(qe){return qe.column});return qt.links.forEach(function(qe){qe.circular&&(qe.circularLinkType=="top"?Jt+=qe.width:Wt+=qe.width,qe.target.column==0&&(Dt+=qe.width),qe.source.column==Ne&&(ar+=qe.width))}),{top:Jt=Jt>0?Jt+25+10:Jt,bottom:Wt=Wt>0?Wt+25+10:Wt,left:Dt=Dt>0?Dt+25+10:Dt,right:ar=ar>0?ar+25+10:ar}}(Be),Nt=function(qt,Jt){var Wt=v.max(qt.nodes,function(pe){return pe.column}),ar=de-se,Dt=ce-oe,Ne=ar/(ar+Jt.right+Jt.left),qe=Dt/(Dt+Jt.top+Jt.bottom);return se=se*Ne+Jt.left,de=Jt.right==0?de:de*Ne,oe=oe*qe+Jt.top,ce*=qe,qt.nodes.forEach(function(pe){pe.x0=se+pe.column*((de-se-ve)/Wt),pe.x1=pe.x0+ve}),qe}(Be,vt);$e*=Nt,Be.links.forEach(function(qt){qt.width=qt.value*$e}),Ye.forEach(function(qt){var Jt=qt.length;qt.forEach(function(Wt,ar){Wt.depth==Ye.length-1&&Jt==1||Wt.depth==0&&Jt==1?(Wt.y0=ce/2-Wt.value*$e,Wt.y1=Wt.y0+Wt.value*$e):Wt.partOfCycle?L(Wt,bt)==0?(Wt.y0=ce/2+ar,Wt.y1=Wt.y0+Wt.value*$e):Wt.circularLinkType=="top"?(Wt.y0=oe+ar,Wt.y1=Wt.y0+Wt.value*$e):(Wt.y0=ce-Wt.value*$e-ar,Wt.y1=Wt.y0+Wt.value*$e):vt.top==0||vt.bottom==0?(Wt.y0=(ce-oe)/Jt*ar,Wt.y1=Wt.y0+Wt.value*$e):(Wt.y0=(ce-oe)/2-Jt/2+ar,Wt.y1=Wt.y0+Wt.value*$e)})})})(Re),wt();for(var Qe=1,lt=Ie;lt>0;--lt)xt(Qe*=.99,Re),wt();function xt(bt,nt){var $e=Ye.length;Ye.forEach(function(vt){var Nt=vt.length,qt=vt[0].depth;vt.forEach(function(Jt){var Wt;if((Jt.sourceLinks.length||Jt.targetLinks.length)&&!(Jt.partOfCycle&&L(Jt,nt)>0))if(qt==0&&Nt==1)Wt=Jt.y1-Jt.y0,Jt.y0=ce/2-Wt/2,Jt.y1=ce/2+Wt/2;else if(qt==$e-1&&Nt==1)Wt=Jt.y1-Jt.y0,Jt.y0=ce/2-Wt/2,Jt.y1=ce/2+Wt/2;else{var ar=v.mean(Jt.sourceLinks,p),Dt=v.mean(Jt.targetLinks,o),Ne=((ar&&Dt?(ar+Dt)/2:ar||Dt)-l(Jt))*bt;Jt.y0+=Ne,Jt.y1+=Ne}})})}function wt(){Ye.forEach(function(bt){var nt,$e,vt,Nt=oe,qt=bt.length;for(bt.sort(s),vt=0;vt<qt;++vt)($e=Nt-(nt=bt[vt]).y0)>0&&(nt.y0+=$e,nt.y1+=$e),Nt=nt.y1+ee;if(($e=Nt-ee-ce)>0)for(Nt=nt.y0-=$e,nt.y1-=$e,vt=qt-2;vt>=0;--vt)($e=(nt=bt[vt]).y1+ee-Nt)>0&&(nt.y0-=$e,nt.y1-=$e),Nt=nt.y0})}}function Xe(Be){Be.nodes.forEach(function(Ie){Ie.sourceLinks.sort(u),Ie.targetLinks.sort(g)}),Be.nodes.forEach(function(Ie){var Re=Ie.y0,Ye=Re,Qe=Ie.y1,lt=Qe;Ie.sourceLinks.forEach(function(xt){xt.circular?(xt.y0=Qe-xt.width/2,Qe-=xt.width):(xt.y0=Re+xt.width/2,Re+=xt.width)}),Ie.targetLinks.forEach(function(xt){xt.circular?(xt.y1=lt-xt.width/2,lt-=xt.width):(xt.y1=Ye+xt.width/2,Ye+=xt.width)})})}return Se.nodeId=function(Be){return arguments.length?(Ae=typeof Be=="function"?Be:a(Be),Se):Ae},Se.nodeAlign=function(Be){return arguments.length?(fe=typeof Be=="function"?Be:a(Be),Se):fe},Se.nodeWidth=function(Be){return arguments.length?(ve=+Be,Se):ve},Se.nodePadding=function(Be){return arguments.length?(ee=+Be,Se):ee},Se.nodes=function(Be){return arguments.length?(me=typeof Be=="function"?Be:a(Be),Se):me},Se.links=function(Be){return arguments.length?(_e=typeof Be=="function"?Be:a(Be),Se):_e},Se.size=function(Be){return arguments.length?(se=oe=0,de=+Be[0],ce=+Be[1],Se):[de-se,ce-oe]},Se.extent=function(Be){return arguments.length?(se=+Be[0][0],de=+Be[1][0],oe=+Be[0][1],ce=+Be[1][1],Se):[[se,oe],[de,ce]]},Se.iterations=function(Be){return arguments.length?(le=+Be,Se):le},Se.circularLinkGap=function(Be){return arguments.length?(ge=+Be,Se):ge},Se.nodePaddingRatio=function(Be){return arguments.length?(re=+Be,Se):re},Se.sortNodes=function(Be){return arguments.length?(Te=Be,Se):Te},Se.update=function(Be){return T(Be,Ae),Xe(Be),Be.links.forEach(function(Ie){Ie.circular&&(Ie.circularLinkType=Ie.y0+Ie.y1<ce?"top":"bottom",Ie.source.circularLinkType=Ie.circularLinkType,Ie.target.circularLinkType=Ie.circularLinkType)}),N(Be,ce,Ae,!1),U(Be,ce,Ae),P(Be,ge,ce,Ae),Be},Se},d.sankeyCenter=function(ee){return ee.targetLinks.length?ee.depth:ee.sourceLinks.length?v.min(ee.sourceLinks,t)-1:0},d.sankeyLeft=function(ee){return ee.depth},d.sankeyRight=function(ee,re){return re-1-ee.height},d.sankeyJustify=n,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-array"),m("d3-collection"),m("d3-shape")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3)})(this,function(d,v,w,y){function e(_){return _.target.depth}function t(_,b){return _.sourceLinks.length?_.depth:b-1}function n(_){return function(){return _}}function a(_,b){return g(_.source,b.source)||_.index-b.index}function r(_,b){return g(_.target,b.target)||_.index-b.index}function g(_,b){return _.y0-b.y0}function u(_){return _.value}function s(_){return(_.y0+_.y1)/2}function h(_){return s(_.source)*_.value}function l(_){return s(_.target)*_.value}function o(_){return _.index}function p(_){return _.nodes}function c(_){return _.links}function i(_,b){var T=_.get(b);if(!T)throw new Error("missing: "+b);return T}function x(_){return[_.source.x1,_.y0]}function f(_){return[_.target.x0,_.y1]}d.sankey=function(){var _=0,b=0,T=1,k=1,L=24,A=8,I=o,P=t,S=p,E=c,z=32;function D(){var $={nodes:S.apply(null,arguments),links:E.apply(null,arguments)};return j($),V($),Z($),Q($),K($),$}function j($){$.nodes.forEach(function(H,N){H.index=N,H.sourceLinks=[],H.targetLinks=[]});var ne=w.map($.nodes,I);$.links.forEach(function(H,N){H.index=N;var U=H.source,te=H.target;typeof U!="object"&&(U=H.source=i(ne,U)),typeof te!="object"&&(te=H.target=i(ne,te)),U.sourceLinks.push(H),te.targetLinks.push(H)})}function V($){$.nodes.forEach(function(ne){ne.value=Math.max(v.sum(ne.sourceLinks,u),v.sum(ne.targetLinks,u))})}function Z($){var ne,H,N;for(ne=$.nodes,H=[],N=0;ne.length;++N,ne=H,H=[])ne.forEach(function(te){te.depth=N,te.sourceLinks.forEach(function(B){H.indexOf(B.target)<0&&H.push(B.target)})});for(ne=$.nodes,H=[],N=0;ne.length;++N,ne=H,H=[])ne.forEach(function(te){te.height=N,te.targetLinks.forEach(function(B){H.indexOf(B.source)<0&&H.push(B.source)})});var U=(T-_-L)/(N-1);$.nodes.forEach(function(te){te.x1=(te.x0=_+Math.max(0,Math.min(N-1,Math.floor(P.call(null,te,N))))*U)+L})}function Q($){var ne=w.nest().key(function(X){return X.x0}).sortKeys(v.ascending).entries($.nodes).map(function(X){return X.values});(function(){var X=v.max(ne,function(re){return re.length}),J=2/3*(k-b)/(X-1);A>J&&(A=J);var ee=v.min(ne,function(re){return(k-b-(re.length-1)*A)/v.sum(re,u)});ne.forEach(function(re){re.forEach(function(se,oe){se.y1=(se.y0=oe)+se.value*ee})}),$.links.forEach(function(re){re.width=re.value*ee})})(),B();for(var H=1,N=z;N>0;--N)te(H*=.99),B(),U(H),B();function U(X){ne.forEach(function(J){J.forEach(function(ee){if(ee.targetLinks.length){var re=(v.sum(ee.targetLinks,h)/v.sum(ee.targetLinks,u)-s(ee))*X;ee.y0+=re,ee.y1+=re}})})}function te(X){ne.slice().reverse().forEach(function(J){J.forEach(function(ee){if(ee.sourceLinks.length){var re=(v.sum(ee.sourceLinks,l)/v.sum(ee.sourceLinks,u)-s(ee))*X;ee.y0+=re,ee.y1+=re}})})}function B(){ne.forEach(function(X){var J,ee,re,se=b,oe=X.length;for(X.sort(g),re=0;re<oe;++re)(ee=se-(J=X[re]).y0)>0&&(J.y0+=ee,J.y1+=ee),se=J.y1+A;if((ee=se-A-k)>0)for(se=J.y0-=ee,J.y1-=ee,re=oe-2;re>=0;--re)(ee=(J=X[re]).y1+A-se)>0&&(J.y0-=ee,J.y1-=ee),se=J.y0})}}function K($){$.nodes.forEach(function(ne){ne.sourceLinks.sort(r),ne.targetLinks.sort(a)}),$.nodes.forEach(function(ne){var H=ne.y0,N=H;ne.sourceLinks.forEach(function(U){U.y0=H+U.width/2,H+=U.width}),ne.targetLinks.forEach(function(U){U.y1=N+U.width/2,N+=U.width})})}return D.update=function($){return K($),$},D.nodeId=function($){return arguments.length?(I=typeof $=="function"?$:n($),D):I},D.nodeAlign=function($){return arguments.length?(P=typeof $=="function"?$:n($),D):P},D.nodeWidth=function($){return arguments.length?(L=+$,D):L},D.nodePadding=function($){return arguments.length?(A=+$,D):A},D.nodes=function($){return arguments.length?(S=typeof $=="function"?$:n($),D):S},D.links=function($){return arguments.length?(E=typeof $=="function"?$:n($),D):E},D.size=function($){return arguments.length?(_=b=0,T=+$[0],k=+$[1],D):[T-_,k-b]},D.extent=function($){return arguments.length?(_=+$[0][0],T=+$[1][0],b=+$[0][1],k=+$[1][1],D):[[_,b],[T,k]]},D.iterations=function($){return arguments.length?(z=+$,D):z},D},d.sankeyCenter=function(_){return _.targetLinks.length?_.depth:_.sourceLinks.length?v.min(_.sourceLinks,e)-1:0},d.sankeyLeft=function(_){return _.depth},d.sankeyRight=function(_,b){return b-1-_.height},d.sankeyJustify=t,d.sankeyLinkHorizontal=function(){return y.linkHorizontal().source(x).target(f)},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(m,G,W){(function(){var d={version:"3.8.0"},v=[].slice,w=function(ue){return v.call(ue)},y=self.document;function e(ue){return ue&&(ue.ownerDocument||ue.document||ue).documentElement}function t(ue){return ue&&(ue.ownerDocument&&ue.ownerDocument.defaultView||ue.document&&ue||ue.defaultView)}if(y)try{w(y.documentElement.childNodes)[0].nodeType}catch{w=function(C){for(var R=C.length,F=new Array(R);R--;)F[R]=C[R];return F}}if(Date.now||(Date.now=function(){return+new Date}),y)try{y.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,a=n.setAttribute,r=n.setAttributeNS,g=this.CSSStyleDeclaration.prototype,u=g.setProperty;n.setAttribute=function(C,R){a.call(this,C,R+"")},n.setAttributeNS=function(C,R,F){r.call(this,C,R,F+"")},g.setProperty=function(C,R,F){u.call(this,C,R+"",F)}}function s(ue,C){return ue<C?-1:ue>C?1:ue>=C?0:NaN}function h(ue){return ue===null?NaN:+ue}function l(ue){return!isNaN(ue)}function o(ue){return{left:function(C,R,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ae=F+q>>>1;ue(C[ae],R)<0?F=ae+1:q=ae}return F},right:function(C,R,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ae=F+q>>>1;ue(C[ae],R)>0?q=ae:F=ae+1}return F}}}d.ascending=s,d.descending=function(ue,C){return C<ue?-1:C>ue?1:C>=ue?0:NaN},d.min=function(ue,C){var R,F,q=-1,ae=ue.length;if(arguments.length===1){for(;++q<ae;)if((F=ue[q])!=null&&F>=F){R=F;break}for(;++q<ae;)(F=ue[q])!=null&&R>F&&(R=F)}else{for(;++q<ae;)if((F=C.call(ue,ue[q],q))!=null&&F>=F){R=F;break}for(;++q<ae;)(F=C.call(ue,ue[q],q))!=null&&R>F&&(R=F)}return R},d.max=function(ue,C){var R,F,q=-1,ae=ue.length;if(arguments.length===1){for(;++q<ae;)if((F=ue[q])!=null&&F>=F){R=F;break}for(;++q<ae;)(F=ue[q])!=null&&F>R&&(R=F)}else{for(;++q<ae;)if((F=C.call(ue,ue[q],q))!=null&&F>=F){R=F;break}for(;++q<ae;)(F=C.call(ue,ue[q],q))!=null&&F>R&&(R=F)}return R},d.extent=function(ue,C){var R,F,q,ae=-1,he=ue.length;if(arguments.length===1){for(;++ae<he;)if((F=ue[ae])!=null&&F>=F){R=q=F;break}for(;++ae<he;)(F=ue[ae])!=null&&(R>F&&(R=F),q<F&&(q=F))}else{for(;++ae<he;)if((F=C.call(ue,ue[ae],ae))!=null&&F>=F){R=q=F;break}for(;++ae<he;)(F=C.call(ue,ue[ae],ae))!=null&&(R>F&&(R=F),q<F&&(q=F))}return[R,q]},d.sum=function(ue,C){var R,F=0,q=ue.length,ae=-1;if(arguments.length===1)for(;++ae<q;)l(R=+ue[ae])&&(F+=R);else for(;++ae<q;)l(R=+C.call(ue,ue[ae],ae))&&(F+=R);return F},d.mean=function(ue,C){var R,F=0,q=ue.length,ae=-1,he=q;if(arguments.length===1)for(;++ae<q;)l(R=h(ue[ae]))?F+=R:--he;else for(;++ae<q;)l(R=h(C.call(ue,ue[ae],ae)))?F+=R:--he;if(he)return F/he},d.quantile=function(ue,C){var R=(ue.length-1)*C+1,F=Math.floor(R),q=+ue[F-1],ae=R-F;return ae?q+ae*(ue[F]-q):q},d.median=function(ue,C){var R,F=[],q=ue.length,ae=-1;if(arguments.length===1)for(;++ae<q;)l(R=h(ue[ae]))&&F.push(R);else for(;++ae<q;)l(R=h(C.call(ue,ue[ae],ae)))&&F.push(R);if(F.length)return d.quantile(F.sort(s),.5)},d.variance=function(ue,C){var R,F,q=ue.length,ae=0,he=0,xe=-1,ke=0;if(arguments.length===1)for(;++xe<q;)l(R=h(ue[xe]))&&(he+=(F=R-ae)*(R-(ae+=F/++ke)));else for(;++xe<q;)l(R=h(C.call(ue,ue[xe],xe)))&&(he+=(F=R-ae)*(R-(ae+=F/++ke)));if(ke>1)return he/(ke-1)},d.deviation=function(){var ue=d.variance.apply(this,arguments);return ue&&Math.sqrt(ue)};var p=o(s);function c(ue){return ue.length}d.bisectLeft=p.left,d.bisect=d.bisectRight=p.right,d.bisector=function(ue){return o(ue.length===1?function(C,R){return s(ue(C),R)}:ue)},d.shuffle=function(ue,C,R){(ae=arguments.length)<3&&(R=ue.length,ae<2&&(C=0));for(var F,q,ae=R-C;ae;)q=Math.random()*ae--|0,F=ue[ae+C],ue[ae+C]=ue[q+C],ue[q+C]=F;return ue},d.permute=function(ue,C){for(var R=C.length,F=new Array(R);R--;)F[R]=ue[C[R]];return F},d.pairs=function(ue){for(var C=0,R=ue.length-1,F=ue[0],q=new Array(R<0?0:R);C<R;)q[C]=[F,F=ue[++C]];return q},d.transpose=function(ue){if(!(q=ue.length))return[];for(var C=-1,R=d.min(ue,c),F=new Array(R);++C<R;)for(var q,ae=-1,he=F[C]=new Array(q);++ae<q;)he[ae]=ue[ae][C];return F},d.zip=function(){return d.transpose(arguments)},d.keys=function(ue){var C=[];for(var R in ue)C.push(R);return C},d.values=function(ue){var C=[];for(var R in ue)C.push(ue[R]);return C},d.entries=function(ue){var C=[];for(var R in ue)C.push({key:R,value:ue[R]});return C},d.merge=function(ue){for(var C,R,F,q=ue.length,ae=-1,he=0;++ae<q;)he+=ue[ae].length;for(R=new Array(he);--q>=0;)for(C=(F=ue[q]).length;--C>=0;)R[--he]=F[C];return R};var i=Math.abs;function x(ue){for(var C=1;ue*C%1;)C*=10;return C}function f(ue,C){for(var R in C)Object.defineProperty(ue.prototype,R,{value:C[R],enumerable:!1})}function _(){this._=Object.create(null)}d.range=function(ue,C,R){if(arguments.length<3&&(R=1,arguments.length<2&&(C=ue,ue=0)),(C-ue)/R==1/0)throw new Error("infinite range");var F,q=[],ae=x(i(R)),he=-1;if(ue*=ae,C*=ae,(R*=ae)<0)for(;(F=ue+R*++he)>C;)q.push(F/ae);else for(;(F=ue+R*++he)<C;)q.push(F/ae);return q},d.map=function(ue,C){var R=new _;if(ue instanceof _)ue.forEach(function(xe,ke){R.set(xe,ke)});else if(Array.isArray(ue)){var F,q=-1,ae=ue.length;if(arguments.length===1)for(;++q<ae;)R.set(q,ue[q]);else for(;++q<ae;)R.set(C.call(ue,F=ue[q],q),F)}else for(var he in ue)R.set(he,ue[he]);return R};function b(ue){return(ue+="")=="__proto__"||ue[0]==="\0"?"\0"+ue:ue}function T(ue){return(ue+="")[0]==="\0"?ue.slice(1):ue}function k(ue){return b(ue)in this._}function L(ue){return(ue=b(ue))in this._&&delete this._[ue]}function A(){var ue=[];for(var C in this._)ue.push(T(C));return ue}function I(){var ue=0;for(var C in this._)++ue;return ue}function P(){for(var ue in this._)return!1;return!0}function S(){this._=Object.create(null)}function E(ue){return ue}function z(ue,C,R){return function(){var F=R.apply(C,arguments);return F===C?ue:F}}function D(ue,C){if(C in ue)return C;C=C.charAt(0).toUpperCase()+C.slice(1);for(var R=0,F=j.length;R<F;++R){var q=j[R]+C;if(q in ue)return q}}f(_,{has:k,get:function(ue){return this._[b(ue)]},set:function(ue,C){return this._[b(ue)]=C},remove:L,keys:A,values:function(){var ue=[];for(var C in this._)ue.push(this._[C]);return ue},entries:function(){var ue=[];for(var C in this._)ue.push({key:T(C),value:this._[C]});return ue},size:I,empty:P,forEach:function(ue){for(var C in this._)ue.call(this,T(C),this._[C])}}),d.nest=function(){var ue,C,R={},F=[],q=[];function ae(he,xe,ke){if(ke>=F.length)return C?C.call(R,xe):ue?xe.sort(ue):xe;for(var Le,He,Je,ot,Tt=-1,Ct=xe.length,At=F[ke++],Et=new _;++Tt<Ct;)(ot=Et.get(Le=At(He=xe[Tt])))?ot.push(He):Et.set(Le,[He]);return he?(He=he(),Je=function(_t,Ft){He.set(_t,ae(he,Ft,ke))}):(He={},Je=function(_t,Ft){He[_t]=ae(he,Ft,ke)}),Et.forEach(Je),He}return R.map=function(he,xe){return ae(xe,he,0)},R.entries=function(he){return function xe(ke,Le){if(Le>=F.length)return ke;var He=[],Je=q[Le++];return ke.forEach(function(ot,Tt){He.push({key:ot,values:xe(Tt,Le)})}),Je?He.sort(function(ot,Tt){return Je(ot.key,Tt.key)}):He}(ae(d.map,he,0),0)},R.key=function(he){return F.push(he),R},R.sortKeys=function(he){return q[F.length-1]=he,R},R.sortValues=function(he){return ue=he,R},R.rollup=function(he){return C=he,R},R},d.set=function(ue){var C=new S;if(ue)for(var R=0,F=ue.length;R<F;++R)C.add(ue[R]);return C},f(S,{has:k,add:function(ue){return this._[b(ue+="")]=!0,ue},remove:L,values:A,size:I,empty:P,forEach:function(ue){for(var C in this._)ue.call(this,T(C))}}),d.behavior={},d.rebind=function(ue,C){for(var R,F=1,q=arguments.length;++F<q;)ue[R=arguments[F]]=z(ue,C,C[R]);return ue};var j=["webkit","ms","moz","Moz","o","O"];function V(){}function Z(){}function Q(ue){var C=[],R=new _;function F(){for(var q,ae=C,he=-1,xe=ae.length;++he<xe;)(q=ae[he].on)&&q.apply(this,arguments);return ue}return F.on=function(q,ae){var he,xe=R.get(q);return arguments.length<2?xe&&xe.on:(xe&&(xe.on=null,C=C.slice(0,he=C.indexOf(xe)).concat(C.slice(he+1)),R.remove(q)),ae&&C.push(R.set(q,{on:ae})),ue)},F}function K(){d.event.preventDefault()}function $(){for(var ue,C=d.event;ue=C.sourceEvent;)C=ue;return C}function ne(ue){for(var C=new Z,R=0,F=arguments.length;++R<F;)C[arguments[R]]=Q(C);return C.of=function(q,ae){return function(he){try{var xe=he.sourceEvent=d.event;he.target=ue,d.event=he,C[he.type].apply(q,ae)}finally{d.event=xe}}},C}d.dispatch=function(){for(var ue=new Z,C=-1,R=arguments.length;++C<R;)ue[arguments[C]]=Q(ue);return ue},Z.prototype.on=function(ue,C){var R=ue.indexOf("."),F="";if(R>=0&&(F=ue.slice(R+1),ue=ue.slice(0,R)),ue)return arguments.length<2?this[ue].on(F):this[ue].on(F,C);if(arguments.length===2){if(C==null)for(ue in this)this.hasOwnProperty(ue)&&this[ue].on(F,null);return this}},d.event=null,d.requote=function(ue){return ue.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,N={}.__proto__?function(ue,C){ue.__proto__=C}:function(ue,C){for(var R in C)ue[R]=C[R]};function U(ue){return N(ue,J),ue}var te=function(ue,C){return C.querySelector(ue)},B=function(ue,C){return C.querySelectorAll(ue)},X=function(ue,C){var R=ue.matches||ue[D(ue,"matchesSelector")];return(X=function(F,q){return R.call(F,q)})(ue,C)};typeof Sizzle=="function"&&(te=function(ue,C){return Sizzle(ue,C)[0]||null},B=Sizzle,X=Sizzle.matchesSelector),d.selection=function(){return d.select(y.documentElement)};var J=d.selection.prototype=[];function ee(ue){return typeof ue=="function"?ue:function(){return te(ue,this)}}function re(ue){return typeof ue=="function"?ue:function(){return B(ue,this)}}J.select=function(ue){var C,R,F,q,ae=[];ue=ee(ue);for(var he=-1,xe=this.length;++he<xe;){ae.push(C=[]),C.parentNode=(F=this[he]).parentNode;for(var ke=-1,Le=F.length;++ke<Le;)(q=F[ke])?(C.push(R=ue.call(q,q.__data__,ke,he)),R&&"__data__"in q&&(R.__data__=q.__data__)):C.push(null)}return U(ae)},J.selectAll=function(ue){var C,R,F=[];ue=re(ue);for(var q=-1,ae=this.length;++q<ae;)for(var he=this[q],xe=-1,ke=he.length;++xe<ke;)(R=he[xe])&&(F.push(C=w(ue.call(R,R.__data__,xe,q))),C.parentNode=R);return U(F)};var se="http://www.w3.org/1999/xhtml",oe={svg:"http://www.w3.org/2000/svg",xhtml:se,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(ue,C){return ue=d.ns.qualify(ue),C==null?ue.local?function(){this.removeAttributeNS(ue.space,ue.local)}:function(){this.removeAttribute(ue)}:typeof C=="function"?ue.local?function(){var R=C.apply(this,arguments);R==null?this.removeAttributeNS(ue.space,ue.local):this.setAttributeNS(ue.space,ue.local,R)}:function(){var R=C.apply(this,arguments);R==null?this.removeAttribute(ue):this.setAttribute(ue,R)}:ue.local?function(){this.setAttributeNS(ue.space,ue.local,C)}:function(){this.setAttribute(ue,C)}}function ce(ue){return ue.trim().replace(/\s+/g," ")}function ve(ue){return new RegExp("(?:^|\\s+)"+d.requote(ue)+"(?:\\s+|$)","g")}function Ae(ue){return(ue+"").trim().split(/^|\s+/)}function fe(ue,C){var R=(ue=Ae(ue).map(me)).length;return typeof C=="function"?function(){for(var F=-1,q=C.apply(this,arguments);++F<R;)ue[F](this,q)}:function(){for(var F=-1;++F<R;)ue[F](this,C)}}function me(ue){var C=ve(ue);return function(R,F){if(q=R.classList)return F?q.add(ue):q.remove(ue);var q=R.getAttribute("class")||"";F?(C.lastIndex=0,C.test(q)||R.setAttribute("class",ce(q+" "+ue))):R.setAttribute("class",ce(q.replace(C," ")))}}function _e(ue,C,R){return C==null?function(){this.style.removeProperty(ue)}:typeof C=="function"?function(){var F=C.apply(this,arguments);F==null?this.style.removeProperty(ue):this.style.setProperty(ue,F,R)}:function(){this.style.setProperty(ue,C,R)}}function le(ue,C){return C==null?function(){delete this[ue]}:typeof C=="function"?function(){var R=C.apply(this,arguments);R==null?delete this[ue]:this[ue]=R}:function(){this[ue]=C}}function ge(ue){return typeof ue=="function"?ue:(ue=d.ns.qualify(ue)).local?function(){return this.ownerDocument.createElementNS(ue.space,ue.local)}:function(){var C=this.ownerDocument,R=this.namespaceURI;return R===se&&C.documentElement.namespaceURI===se?C.createElement(ue):C.createElementNS(R,ue)}}function Te(){var ue=this.parentNode;ue&&ue.removeChild(this)}function Se(ue){return{__data__:ue}}function Me(ue){return function(){return X(this,ue)}}function ze(ue){return arguments.length||(ue=s),function(C,R){return C&&R?ue(C.__data__,R.__data__):!C-!R}}function Oe(ue,C){for(var R=0,F=ue.length;R<F;R++)for(var q,ae=ue[R],he=0,xe=ae.length;he<xe;he++)(q=ae[he])&&C(q,he,R);return ue}function De(ue){return N(ue,Xe),ue}d.ns={prefix:oe,qualify:function(ue){var C=ue.indexOf(":"),R=ue;return C>=0&&(R=ue.slice(0,C))!=="xmlns"&&(ue=ue.slice(C+1)),oe.hasOwnProperty(R)?{space:oe[R],local:ue}:ue}},J.attr=function(ue,C){if(arguments.length<2){if(typeof ue=="string"){var R=this.node();return(ue=d.ns.qualify(ue)).local?R.getAttributeNS(ue.space,ue.local):R.getAttribute(ue)}for(C in ue)this.each(de(C,ue[C]));return this}return this.each(de(ue,C))},J.classed=function(ue,C){if(arguments.length<2){if(typeof ue=="string"){var R=this.node(),F=(ue=Ae(ue)).length,q=-1;if(C=R.classList){for(;++q<F;)if(!C.contains(ue[q]))return!1}else for(C=R.getAttribute("class");++q<F;)if(!ve(ue[q]).test(C))return!1;return!0}for(C in ue)this.each(fe(C,ue[C]));return this}return this.each(fe(ue,C))},J.style=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=""),ue)this.each(_e(R,ue[R],C));return this}if(F<2){var q=this.node();return t(q).getComputedStyle(q,null).getPropertyValue(ue)}R=""}return this.each(_e(ue,C,R))},J.property=function(ue,C){if(arguments.length<2){if(typeof ue=="string")return this.node()[ue];for(C in ue)this.each(le(C,ue[C]));return this}return this.each(le(ue,C))},J.text=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var C=ue.apply(this,arguments);this.textContent=C==null?"":C}:ue==null?function(){this.textContent=""}:function(){this.textContent=ue}):this.node().textContent},J.html=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var C=ue.apply(this,arguments);this.innerHTML=C==null?"":C}:ue==null?function(){this.innerHTML=""}:function(){this.innerHTML=ue}):this.node().innerHTML},J.append=function(ue){return ue=ge(ue),this.select(function(){return this.appendChild(ue.apply(this,arguments))})},J.insert=function(ue,C){return ue=ge(ue),C=ee(C),this.select(function(){return this.insertBefore(ue.apply(this,arguments),C.apply(this,arguments)||null)})},J.remove=function(){return this.each(Te)},J.data=function(ue,C){var R,F,q=-1,ae=this.length;if(!arguments.length){for(ue=new Array(ae=(R=this[0]).length);++q<ae;)(F=R[q])&&(ue[q]=F.__data__);return ue}function he(He,Je){var ot,Tt,Ct,At=He.length,Et=Je.length,_t=Math.min(At,Et),Ft=new Array(Et),zt=new Array(Et),Vt=new Array(At);if(C){var ir,gr=new _,Lr=new Array(At);for(ot=-1;++ot<At;)(Tt=He[ot])&&(gr.has(ir=C.call(Tt,Tt.__data__,ot))?Vt[ot]=Tt:gr.set(ir,Tt),Lr[ot]=ir);for(ot=-1;++ot<Et;)(Tt=gr.get(ir=C.call(Je,Ct=Je[ot],ot)))?Tt!==!0&&(Ft[ot]=Tt,Tt.__data__=Ct):zt[ot]=Se(Ct),gr.set(ir,!0);for(ot=-1;++ot<At;)ot in Lr&&gr.get(Lr[ot])!==!0&&(Vt[ot]=He[ot])}else{for(ot=-1;++ot<_t;)Tt=He[ot],Ct=Je[ot],Tt?(Tt.__data__=Ct,Ft[ot]=Tt):zt[ot]=Se(Ct);for(;ot<Et;++ot)zt[ot]=Se(Je[ot]);for(;ot<At;++ot)Vt[ot]=He[ot]}zt.update=Ft,zt.parentNode=Ft.parentNode=Vt.parentNode=He.parentNode,xe.push(zt),ke.push(Ft),Le.push(Vt)}var xe=De([]),ke=U([]),Le=U([]);if(typeof ue=="function")for(;++q<ae;)he(R=this[q],ue.call(R,R.parentNode.__data__,q));else for(;++q<ae;)he(R=this[q],ue);return ke.enter=function(){return xe},ke.exit=function(){return Le},ke},J.datum=function(ue){return arguments.length?this.property("__data__",ue):this.property("__data__")},J.filter=function(ue){var C,R,F,q=[];typeof ue!="function"&&(ue=Me(ue));for(var ae=0,he=this.length;ae<he;ae++){q.push(C=[]),C.parentNode=(R=this[ae]).parentNode;for(var xe=0,ke=R.length;xe<ke;xe++)(F=R[xe])&&ue.call(F,F.__data__,xe,ae)&&C.push(F)}return U(q)},J.order=function(){for(var ue=-1,C=this.length;++ue<C;)for(var R,F=this[ue],q=F.length-1,ae=F[q];--q>=0;)(R=F[q])&&(ae&&ae!==R.nextSibling&&ae.parentNode.insertBefore(R,ae),ae=R);return this},J.sort=function(ue){ue=ze.apply(this,arguments);for(var C=-1,R=this.length;++C<R;)this[C].sort(ue);return this.order()},J.each=function(ue){return Oe(this,function(C,R,F){ue.call(C,C.__data__,R,F)})},J.call=function(ue){var C=w(arguments);return ue.apply(C[0]=this,C),this},J.empty=function(){return!this.node()},J.node=function(){for(var ue=0,C=this.length;ue<C;ue++)for(var R=this[ue],F=0,q=R.length;F<q;F++){var ae=R[F];if(ae)return ae}return null},J.size=function(){var ue=0;return Oe(this,function(){++ue}),ue};var Xe=[];function Be(ue){var C,R;return function(F,q,ae){var he,xe=ue[ae].update,ke=xe.length;for(ae!=R&&(R=ae,C=0),q>=C&&(C=q+1);!(he=xe[C])&&++C<ke;);return he}}function Ie(ue,C,R){var F="__on"+ue,q=ue.indexOf("."),ae=Ye;q>0&&(ue=ue.slice(0,q));var he=Re.get(ue);function xe(){var ke=this[F];ke&&(this.removeEventListener(ue,ke,ke.$),delete this[F])}return he&&(ue=he,ae=Qe),q?C?function(){var ke=ae(C,w(arguments));xe.call(this),this.addEventListener(ue,this[F]=ke,ke.$=R),ke._=C}:xe:C?V:function(){var ke,Le=new RegExp("^__on([^.]+)"+d.requote(ue)+"$");for(var He in this)if(ke=He.match(Le)){var Je=this[He];this.removeEventListener(ke[1],Je,Je.$),delete this[He]}}}d.selection.enter=De,d.selection.enter.prototype=Xe,Xe.append=J.append,Xe.empty=J.empty,Xe.node=J.node,Xe.call=J.call,Xe.size=J.size,Xe.select=function(ue){for(var C,R,F,q,ae,he=[],xe=-1,ke=this.length;++xe<ke;){F=(q=this[xe]).update,he.push(C=[]),C.parentNode=q.parentNode;for(var Le=-1,He=q.length;++Le<He;)(ae=q[Le])?(C.push(F[Le]=R=ue.call(q.parentNode,ae.__data__,Le,xe)),R.__data__=ae.__data__):C.push(null)}return U(he)},Xe.insert=function(ue,C){return arguments.length<2&&(C=Be(this)),J.insert.call(this,ue,C)},d.select=function(ue){var C;return typeof ue=="string"?(C=[te(ue,y)]).parentNode=y.documentElement:(C=[ue]).parentNode=e(ue),U([C])},d.selectAll=function(ue){var C;return typeof ue=="string"?(C=w(B(ue,y))).parentNode=y.documentElement:(C=w(ue)).parentNode=null,U([C])},J.on=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=!1),ue)this.each(Ie(R,ue[R],C));return this}if(F<2)return(F=this.node()["__on"+ue])&&F._;R=!1}return this.each(Ie(ue,C,R))};var Re=d.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Ye(ue,C){return function(R){var F=d.event;d.event=R,C[0]=this.__data__;try{ue.apply(this,C)}finally{d.event=F}}}function Qe(ue,C){var R=Ye(ue,C);return function(F){var q=F.relatedTarget;q&&(q===this||8&q.compareDocumentPosition(this))||R.call(this,F)}}y&&Re.forEach(function(ue){"on"+ue in y&&Re.remove(ue)});var lt,xt=0;function wt(ue){var C=".dragsuppress-"+ ++xt,R="click"+C,F=d.select(t(ue)).on("touchmove"+C,K).on("dragstart"+C,K).on("selectstart"+C,K);if(lt==null&&(lt=!("onselectstart"in ue)&&D(ue.style,"userSelect")),lt){var q=e(ue).style,ae=q[lt];q[lt]="none"}return function(he){if(F.on(C,null),lt&&(q[lt]=ae),he){var xe=function(){F.on(R,null)};F.on(R,function(){K(),xe()},!0),setTimeout(xe,0)}}}d.mouse=function(ue){return nt(ue,$())};var bt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function nt(ue,C){C.changedTouches&&(C=C.changedTouches[0]);var R=ue.ownerSVGElement||ue;if(R.createSVGPoint){var F=R.createSVGPoint();if(bt<0){var q=t(ue);if(q.scrollX||q.scrollY){var ae=(R=d.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();bt=!(ae.f||ae.e),R.remove()}}return bt?(F.x=C.pageX,F.y=C.pageY):(F.x=C.clientX,F.y=C.clientY),[(F=F.matrixTransform(ue.getScreenCTM().inverse())).x,F.y]}var he=ue.getBoundingClientRect();return[C.clientX-he.left-ue.clientLeft,C.clientY-he.top-ue.clientTop]}function $e(){return d.event.changedTouches[0].identifier}d.touch=function(ue,C,R){if(arguments.length<3&&(R=C,C=$().changedTouches),C){for(var F,q=0,ae=C.length;q<ae;++q)if((F=C[q]).identifier===R)return nt(ue,F)}},d.behavior.drag=function(){var ue=ne(q,"drag","dragstart","dragend"),C=null,R=ae(V,d.mouse,t,"mousemove","mouseup"),F=ae($e,d.touch,E,"touchmove","touchend");function q(){this.on("mousedown.drag",R).on("touchstart.drag",F)}function ae(he,xe,ke,Le,He){return function(){var Je,ot=this,Tt=d.event.target.correspondingElement||d.event.target,Ct=ot.parentNode,At=ue.of(ot,arguments),Et=0,_t=he(),Ft=".drag"+(_t==null?"":"-"+_t),zt=d.select(ke(Tt)).on(Le+Ft,gr).on(He+Ft,Lr),Vt=wt(Tt),ir=xe(Ct,_t);function gr(){var Ar,$r,Jr=xe(Ct,_t);Jr&&(Ar=Jr[0]-ir[0],$r=Jr[1]-ir[1],Et|=Ar|$r,ir=Jr,At({type:"drag",x:Jr[0]+Je[0],y:Jr[1]+Je[1],dx:Ar,dy:$r}))}function Lr(){xe(Ct,_t)&&(zt.on(Le+Ft,null).on(He+Ft,null),Vt(Et),At({type:"dragend"}))}Je=C?[(Je=C.apply(ot,arguments)).x-ir[0],Je.y-ir[1]]:[0,0],At({type:"dragstart"})}}return q.origin=function(he){return arguments.length?(C=he,q):C},d.rebind(q,ue,"on")},d.touches=function(ue,C){return arguments.length<2&&(C=$().touches),C?w(C).map(function(R){var F=nt(ue,R);return F.identifier=R.identifier,F}):[]};var vt=1e-6,Nt=Math.PI,qt=2*Nt,Jt=qt-vt,Wt=Nt/2,ar=Nt/180,Dt=180/Nt;function Ne(ue){return ue>1?Wt:ue<-1?-Wt:Math.asin(ue)}function qe(ue){return((ue=Math.exp(ue))+1/ue)/2}var pe=Math.SQRT2;d.interpolateZoom=function(ue,C){var R,F,q=ue[0],ae=ue[1],he=ue[2],xe=C[0],ke=C[1],Le=C[2],He=xe-q,Je=ke-ae,ot=He*He+Je*Je;if(ot<1e-12)F=Math.log(Le/he)/pe,R=function(Ft){return[q+Ft*He,ae+Ft*Je,he*Math.exp(pe*Ft*F)]};else{var Tt=Math.sqrt(ot),Ct=(Le*Le-he*he+4*ot)/(2*he*2*Tt),At=(Le*Le-he*he-4*ot)/(2*Le*2*Tt),Et=Math.log(Math.sqrt(Ct*Ct+1)-Ct),_t=Math.log(Math.sqrt(At*At+1)-At);F=(_t-Et)/pe,R=function(Ft){var zt,Vt=Ft*F,ir=qe(Et),gr=he/(2*Tt)*(ir*(zt=pe*Vt+Et,((zt=Math.exp(2*zt))-1)/(zt+1))-function(Lr){return((Lr=Math.exp(Lr))-1/Lr)/2}(Et));return[q+gr*He,ae+gr*Je,he*ir/qe(pe*Vt+Et)]}}return R.duration=1e3*F,R},d.behavior.zoom=function(){var ue,C,R,F,q,ae,he,xe,ke,Le={x:0,y:0,k:1},He=[960,500],Je=Ve,ot=250,Tt=0,Ct="mousedown.zoom",At="mousemove.zoom",Et="mouseup.zoom",_t="touchstart.zoom",Ft=ne(zt,"zoomstart","zoom","zoomend");function zt(Yr){Yr.on(Ct,ln).on(Fe+".zoom",Xn).on("dblclick.zoom",hi).on(_t,Vn)}function Vt(Yr){return[(Yr[0]-Le.x)/Le.k,(Yr[1]-Le.y)/Le.k]}function ir(Yr){Le.k=Math.max(Je[0],Math.min(Je[1],Yr))}function gr(Yr,Sn){Sn=function(Kn){return[Kn[0]*Le.k+Le.x,Kn[1]*Le.k+Le.y]}(Sn),Le.x+=Yr[0]-Sn[0],Le.y+=Yr[1]-Sn[1]}function Lr(Yr,Sn,Kn,Yn){Yr.__chart__={x:Le.x,y:Le.y,k:Le.k},ir(Math.pow(2,Yn)),gr(C=Sn,Kn),Yr=d.select(Yr),ot>0&&(Yr=Yr.transition().duration(ot)),Yr.call(zt.event)}function Ar(){he&&he.domain(ae.range().map(function(Yr){return(Yr-Le.x)/Le.k}).map(ae.invert)),ke&&ke.domain(xe.range().map(function(Yr){return(Yr-Le.y)/Le.k}).map(xe.invert))}function $r(Yr){Tt++||Yr({type:"zoomstart"})}function Jr(Yr){Ar(),Yr({type:"zoom",scale:Le.k,translate:[Le.x,Le.y]})}function dn(Yr){--Tt||(Yr({type:"zoomend"}),C=null)}function ln(){var Yr=this,Sn=Ft.of(Yr,arguments),Kn=0,Yn=d.select(t(Yr)).on(At,Li).on(Et,ei),ai=Vt(d.mouse(Yr)),di=wt(Yr);function Li(){Kn=1,gr(d.mouse(Yr),ai),Jr(Sn)}function ei(){Yn.on(At,null).on(Et,null),di(Kn),dn(Sn)}js.call(Yr),$r(Sn)}function Vn(){var Yr,Sn=this,Kn=Ft.of(Sn,arguments),Yn={},ai=0,di=".zoom-"+d.event.changedTouches[0].identifier,Li="touchmove"+di,ei="touchend"+di,_i=[],yi=d.select(Sn),Ii=wt(Sn);function wi(){var Ra=d.touches(Sn);return Yr=Le.k,Ra.forEach(function(Fa){Fa.identifier in Yn&&(Yn[Fa.identifier]=Vt(Fa))}),Ra}function Oi(){var Ra=d.event.target;d.select(Ra).on(Li,Hi).on(ei,da),_i.push(Ra);for(var Fa=d.event.changedTouches,pa=0,Ea=Fa.length;pa<Ea;++pa)Yn[Fa[pa].identifier]=null;var ba=wi(),Mo=Date.now();if(ba.length===1){if(Mo-q<500){var Ja=ba[0];Lr(Sn,Ja,Yn[Ja.identifier],Math.floor(Math.log(Le.k)/Math.LN2)+1),K()}q=Mo}else if(ba.length>1){Ja=ba[0];var Vo=ba[1],Os=Ja[0]-Vo[0],ol=Ja[1]-Vo[1];ai=Os*Os+ol*ol}}function Hi(){var Ra,Fa,pa,Ea,ba=d.touches(Sn);js.call(Sn);for(var Mo=0,Ja=ba.length;Mo<Ja;++Mo,Ea=null)if(pa=ba[Mo],Ea=Yn[pa.identifier]){if(Fa)break;Ra=pa,Fa=Ea}if(Ea){var Vo=(Vo=pa[0]-Ra[0])*Vo+(Vo=pa[1]-Ra[1])*Vo,Os=ai&&Math.sqrt(Vo/ai);Ra=[(Ra[0]+pa[0])/2,(Ra[1]+pa[1])/2],Fa=[(Fa[0]+Ea[0])/2,(Fa[1]+Ea[1])/2],ir(Os*Yr)}q=null,gr(Ra,Fa),Jr(Kn)}function da(){if(d.event.touches.length){for(var Ra=d.event.changedTouches,Fa=0,pa=Ra.length;Fa<pa;++Fa)delete Yn[Ra[Fa].identifier];for(var Ea in Yn)return void wi()}d.selectAll(_i).on(di,null),yi.on(Ct,ln).on(_t,Vn),Ii(),dn(Kn)}Oi(),$r(Kn),yi.on(Ct,null).on(_t,Oi)}function Xn(){var Yr=Ft.of(this,arguments);F?clearTimeout(F):(js.call(this),ue=Vt(C=R||d.mouse(this)),$r(Yr)),F=setTimeout(function(){F=null,dn(Yr)},50),K(),ir(Math.pow(2,.002*be())*Le.k),gr(C,ue),Jr(Yr)}function hi(){var Yr=d.mouse(this),Sn=Math.log(Le.k)/Math.LN2;Lr(this,Yr,Vt(Yr),d.event.shiftKey?Math.ceil(Sn)-1:Math.floor(Sn)+1)}return Fe||(Fe="onwheel"in y?(be=function(){return-d.event.deltaY*(d.event.deltaMode?120:1)},"wheel"):"onmousewheel"in y?(be=function(){return d.event.wheelDelta},"mousewheel"):(be=function(){return-d.event.detail},"MozMousePixelScroll")),zt.event=function(Yr){Yr.each(function(){var Sn=Ft.of(this,arguments),Kn=Le;As?d.select(this).transition().each("start.zoom",function(){Le=this.__chart__||{x:0,y:0,k:1},$r(Sn)}).tween("zoom:zoom",function(){var Yn=He[0],ai=He[1],di=C?C[0]:Yn/2,Li=C?C[1]:ai/2,ei=d.interpolateZoom([(di-Le.x)/Le.k,(Li-Le.y)/Le.k,Yn/Le.k],[(di-Kn.x)/Kn.k,(Li-Kn.y)/Kn.k,Yn/Kn.k]);return function(_i){var yi=ei(_i),Ii=Yn/yi[2];this.__chart__=Le={x:di-yi[0]*Ii,y:Li-yi[1]*Ii,k:Ii},Jr(Sn)}}).each("interrupt.zoom",function(){dn(Sn)}).each("end.zoom",function(){dn(Sn)}):(this.__chart__=Le,$r(Sn),Jr(Sn),dn(Sn))})},zt.translate=function(Yr){return arguments.length?(Le={x:+Yr[0],y:+Yr[1],k:Le.k},Ar(),zt):[Le.x,Le.y]},zt.scale=function(Yr){return arguments.length?(Le={x:Le.x,y:Le.y,k:null},ir(+Yr),Ar(),zt):Le.k},zt.scaleExtent=function(Yr){return arguments.length?(Je=Yr==null?Ve:[+Yr[0],+Yr[1]],zt):Je},zt.center=function(Yr){return arguments.length?(R=Yr&&[+Yr[0],+Yr[1]],zt):R},zt.size=function(Yr){return arguments.length?(He=Yr&&[+Yr[0],+Yr[1]],zt):He},zt.duration=function(Yr){return arguments.length?(ot=+Yr,zt):ot},zt.x=function(Yr){return arguments.length?(he=Yr,ae=Yr.copy(),Le={x:0,y:0,k:1},zt):he},zt.y=function(Yr){return arguments.length?(ke=Yr,xe=Yr.copy(),Le={x:0,y:0,k:1},zt):ke},d.rebind(zt,Ft,"on")};var be,Fe,Ve=[0,1/0];function Ke(){}function Ge(ue,C,R){return this instanceof Ge?(this.h=+ue,this.s=+C,void(this.l=+R)):arguments.length<2?ue instanceof Ge?new Ge(ue.h,ue.s,ue.l):Mr(""+ue,hr,Ge):new Ge(ue,C,R)}d.color=Ke,Ke.prototype.toString=function(){return this.rgb()+""},d.hsl=Ge;var ct=Ge.prototype=new Ke;function st(ue,C,R){var F,q;function ae(he){return Math.round(255*function(xe){return xe>360?xe-=360:xe<0&&(xe+=360),xe<60?F+(q-F)*xe/60:xe<180?q:xe<240?F+(q-F)*(240-xe)/60:F}(he))}return ue=isNaN(ue)?0:(ue%=360)<0?ue+360:ue,C=isNaN(C)||C<0?0:C>1?1:C,F=2*(R=R<0?0:R>1?1:R)-(q=R<=.5?R*(1+C):R+C-R*C),new St(ae(ue+120),ae(ue),ae(ue-120))}function Mt(ue,C,R){return this instanceof Mt?(this.h=+ue,this.c=+C,void(this.l=+R)):arguments.length<2?ue instanceof Mt?new Mt(ue.h,ue.c,ue.l):Ee(ue instanceof ht?ue.l:(ue=Qt((ue=d.rgb(ue)).r,ue.g,ue.b)).l,ue.a,ue.b):new Mt(ue,C,R)}ct.brighter=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new Ge(this.h,this.s,this.l/ue)},ct.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new Ge(this.h,this.s,ue*this.l)},ct.rgb=function(){return st(this.h,this.s,this.l)},d.hcl=Mt;var Ot=Mt.prototype=new Ke;function it(ue,C,R){return isNaN(ue)&&(ue=0),isNaN(C)&&(C=0),new ht(R,Math.cos(ue*=ar)*C,Math.sin(ue)*C)}function ht(ue,C,R){return this instanceof ht?(this.l=+ue,this.a=+C,void(this.b=+R)):arguments.length<2?ue instanceof ht?new ht(ue.l,ue.a,ue.b):ue instanceof Mt?it(ue.h,ue.c,ue.l):Qt((ue=St(ue)).r,ue.g,ue.b):new ht(ue,C,R)}Ot.brighter=function(ue){return new Mt(this.h,this.c,Math.min(100,this.l+jt*(arguments.length?ue:1)))},Ot.darker=function(ue){return new Mt(this.h,this.c,Math.max(0,this.l-jt*(arguments.length?ue:1)))},Ot.rgb=function(){return it(this.h,this.c,this.l).rgb()},d.lab=ht;var jt=18,kt=ht.prototype=new Ke;function Pt(ue,C,R){var F=(ue+16)/116,q=F+C/500,ae=F-R/200;return new St(pt(3.2404542*(q=.95047*Ze(q))-1.5371385*(F=1*Ze(F))-.4985314*(ae=1.08883*Ze(ae))),pt(-.969266*q+1.8760108*F+.041556*ae),pt(.0556434*q-.2040259*F+1.0572252*ae))}function Ee(ue,C,R){return ue>0?new Mt(Math.atan2(R,C)*Dt,Math.sqrt(C*C+R*R),ue):new Mt(NaN,NaN,ue)}function Ze(ue){return ue>.206893034?ue*ue*ue:(ue-4/29)/7.787037}function at(ue){return ue>.008856?Math.pow(ue,1/3):7.787037*ue+4/29}function pt(ue){return Math.round(255*(ue<=.00304?12.92*ue:1.055*Math.pow(ue,1/2.4)-.055))}function St(ue,C,R){return this instanceof St?(this.r=~~ue,this.g=~~C,void(this.b=~~R)):arguments.length<2?ue instanceof St?new St(ue.r,ue.g,ue.b):Mr(""+ue,St,st):new St(ue,C,R)}function Ut(ue){return new St(ue>>16,ue>>8&255,255&ue)}function Kt(ue){return Ut(ue)+""}kt.brighter=function(ue){return new ht(Math.min(100,this.l+jt*(arguments.length?ue:1)),this.a,this.b)},kt.darker=function(ue){return new ht(Math.max(0,this.l-jt*(arguments.length?ue:1)),this.a,this.b)},kt.rgb=function(){return Pt(this.l,this.a,this.b)},d.rgb=St;var Ht=St.prototype=new Ke;function pr(ue){return ue<16?"0"+Math.max(0,ue).toString(16):Math.min(255,ue).toString(16)}function Mr(ue,C,R){var F,q,ae,he=0,xe=0,ke=0;if(F=/([a-z]+)\((.*)\)/.exec(ue=ue.toLowerCase()))switch(q=F[2].split(","),F[1]){case"hsl":return R(parseFloat(q[0]),parseFloat(q[1])/100,parseFloat(q[2])/100);case"rgb":return C(rr(q[0]),rr(q[1]),rr(q[2]))}return(ae=fr.get(ue))?C(ae.r,ae.g,ae.b):(ue==null||ue.charAt(0)!=="#"||isNaN(ae=parseInt(ue.slice(1),16))||(ue.length===4?(he=(3840&ae)>>4,he|=he>>4,xe=240&ae,xe|=xe>>4,ke=15&ae,ke|=ke<<4):ue.length===7&&(he=(16711680&ae)>>16,xe=(65280&ae)>>8,ke=255&ae)),C(he,xe,ke))}function hr(ue,C,R){var F,q,ae=Math.min(ue/=255,C/=255,R/=255),he=Math.max(ue,C,R),xe=he-ae,ke=(he+ae)/2;return xe?(q=ke<.5?xe/(he+ae):xe/(2-he-ae),F=ue==he?(C-R)/xe+(C<R?6:0):C==he?(R-ue)/xe+2:(ue-C)/xe+4,F*=60):(F=NaN,q=ke>0&&ke<1?0:F),new Ge(F,q,ke)}function Qt(ue,C,R){var F=at((.4124564*(ue=tr(ue))+.3575761*(C=tr(C))+.1804375*(R=tr(R)))/.95047),q=at((.2126729*ue+.7151522*C+.072175*R)/1);return ht(116*q-16,500*(F-q),200*(q-at((.0193339*ue+.119192*C+.9503041*R)/1.08883)))}function tr(ue){return(ue/=255)<=.04045?ue/12.92:Math.pow((ue+.055)/1.055,2.4)}function rr(ue){var C=parseFloat(ue);return ue.charAt(ue.length-1)==="%"?Math.round(2.55*C):C}Ht.brighter=function(ue){ue=Math.pow(.7,arguments.length?ue:1);var C=this.r,R=this.g,F=this.b,q=30;return C||R||F?(C&&C<q&&(C=q),R&&R<q&&(R=q),F&&F<q&&(F=q),new St(Math.min(255,C/ue),Math.min(255,R/ue),Math.min(255,F/ue))):new St(q,q,q)},Ht.darker=function(ue){return new St((ue=Math.pow(.7,arguments.length?ue:1))*this.r,ue*this.g,ue*this.b)},Ht.hsl=function(){return hr(this.r,this.g,this.b)},Ht.toString=function(){return"#"+pr(this.r)+pr(this.g)+pr(this.b)};var fr=d.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function yr(ue){return typeof ue=="function"?ue:function(){return ue}}function Sr(ue){return function(C,R,F){return arguments.length===2&&typeof R=="function"&&(F=R,R=null),Dr(C,R,ue,F)}}function Dr(ue,C,R,F){var q={},ae=d.dispatch("beforesend","progress","load","error"),he={},xe=new XMLHttpRequest,ke=null;function Le(){var He,Je=xe.status;if(!Je&&function(ot){var Tt=ot.responseType;return Tt&&Tt!=="text"?ot.response:ot.responseText}(xe)||Je>=200&&Je<300||Je===304){try{He=R.call(q,xe)}catch(ot){return void ae.error.call(q,ot)}ae.load.call(q,He)}else ae.error.call(q,xe)}return self.XDomainRequest&&!("withCredentials"in xe)&&/^(http(s)?:)?\/\//.test(ue)&&(xe=new XDomainRequest),"onload"in xe?xe.onload=xe.onerror=Le:xe.onreadystatechange=function(){xe.readyState>3&&Le()},xe.onprogress=function(He){var Je=d.event;d.event=He;try{ae.progress.call(q,xe)}finally{d.event=Je}},q.header=function(He,Je){return He=(He+"").toLowerCase(),arguments.length<2?he[He]:(Je==null?delete he[He]:he[He]=Je+"",q)},q.mimeType=function(He){return arguments.length?(C=He==null?null:He+"",q):C},q.responseType=function(He){return arguments.length?(ke=He,q):ke},q.response=function(He){return R=He,q},["get","post"].forEach(function(He){q[He]=function(){return q.send.apply(q,[He].concat(w(arguments)))}}),q.send=function(He,Je,ot){if(arguments.length===2&&typeof Je=="function"&&(ot=Je,Je=null),xe.open(He,ue,!0),C==null||"accept"in he||(he.accept=C+",*/*"),xe.setRequestHeader)for(var Tt in he)xe.setRequestHeader(Tt,he[Tt]);return C!=null&&xe.overrideMimeType&&xe.overrideMimeType(C),ke!=null&&(xe.responseType=ke),ot!=null&&q.on("error",ot).on("load",function(Ct){ot(null,Ct)}),ae.beforesend.call(q,xe),xe.send(Je==null?null:Je),q},q.abort=function(){return xe.abort(),q},d.rebind(q,ae,"on"),F==null?q:q.get(function(He){return He.length===1?function(Je,ot){He(Je==null?ot:null)}:He}(F))}fr.forEach(function(ue,C){fr.set(ue,Ut(C))}),d.functor=yr,d.xhr=Sr(E),d.dsv=function(ue,C){var R=new RegExp('["'+ue+`
]`),F=ue.charCodeAt(0);function q(Le,He,Je){arguments.length<3&&(Je=He,He=null);var ot=Dr(Le,C,He==null?ae:he(He),Je);return ot.row=function(Tt){return arguments.length?ot.response((He=Tt)==null?ae:he(Tt)):He},ot}function ae(Le){return q.parse(Le.responseText)}function he(Le){return function(He){return q.parse(He.responseText,Le)}}function xe(Le){return Le.map(ke).join(ue)}function ke(Le){return R.test(Le)?'"'+Le.replace(/\"/g,'""')+'"':Le}return q.parse=function(Le,He){var Je;return q.parseRows(Le,function(ot,Tt){if(Je)return Je(ot,Tt-1);var Ct=function(At){for(var Et={},_t=ot.length,Ft=0;Ft<_t;++Ft)Et[ot[Ft]]=At[Ft];return Et};Je=He?function(At,Et){return He(Ct(At),Et)}:Ct})},q.parseRows=function(Le,He){var Je,ot,Tt={},Ct={},At=[],Et=Le.length,_t=0,Ft=0;function zt(){if(_t>=Et)return Ct;if(ot)return ot=!1,Tt;var ir=_t;if(Le.charCodeAt(ir)===34){for(var gr=ir;gr++<Et;)if(Le.charCodeAt(gr)===34){if(Le.charCodeAt(gr+1)!==34)break;++gr}return _t=gr+2,(Lr=Le.charCodeAt(gr+1))===13?(ot=!0,Le.charCodeAt(gr+2)===10&&++_t):Lr===10&&(ot=!0),Le.slice(ir+1,gr).replace(/""/g,'"')}for(;_t<Et;){var Lr,Ar=1;if((Lr=Le.charCodeAt(_t++))===10)ot=!0;else if(Lr===13)ot=!0,Le.charCodeAt(_t)===10&&(++_t,++Ar);else if(Lr!==F)continue;return Le.slice(ir,_t-Ar)}return Le.slice(ir)}for(;(Je=zt())!==Ct;){for(var Vt=[];Je!==Tt&&Je!==Ct;)Vt.push(Je),Je=zt();He&&(Vt=He(Vt,Ft++))==null||At.push(Vt)}return At},q.format=function(Le){if(Array.isArray(Le[0]))return q.formatRows(Le);var He=new S,Je=[];return Le.forEach(function(ot){for(var Tt in ot)He.has(Tt)||Je.push(He.add(Tt))}),[Je.map(ke).join(ue)].concat(Le.map(function(ot){return Je.map(function(Tt){return ke(ot[Tt])}).join(ue)})).join(`
`)},q.formatRows=function(Le){return Le.map(xe).join(`
`)},q},d.csv=d.dsv(",","text/csv"),d.tsv=d.dsv("	","text/tab-separated-values");var Nr,Wr,hn,tn,Fn=this[D(this,"requestAnimationFrame")]||function(ue){setTimeout(ue,17)};function an(ue,C,R){var F=arguments.length;F<2&&(C=0),F<3&&(R=Date.now());var q=R+C,ae={c:ue,t:q,n:null};return Wr?Wr.n=ae:Nr=ae,Wr=ae,hn||(tn=clearTimeout(tn),hn=1,Fn(xn)),ae}function xn(){var ue=_n(),C=ti()-ue;C>24?(isFinite(C)&&(clearTimeout(tn),tn=setTimeout(xn,C)),hn=0):(hn=1,Fn(xn))}function _n(){for(var ue=Date.now(),C=Nr;C;)ue>=C.t&&C.c(ue-C.t)&&(C.c=null),C=C.n;return ue}function ti(){for(var ue,C=Nr,R=1/0;C;)C.c?(C.t<R&&(R=C.t),C=(ue=C).n):C=ue?ue.n=C.n:Nr=C.n;return Wr=ue,R}function jr(ue){return ue[0]}function nn(ue){return ue[1]}function vn(ue){for(var C,R,F,q=ue.length,ae=[0,1],he=2,xe=2;xe<q;xe++){for(;he>1&&(C=ue[ae[he-2]],R=ue[ae[he-1]],F=ue[xe],(R[0]-C[0])*(F[1]-C[1])-(R[1]-C[1])*(F[0]-C[0])<=0);)--he;ae[he++]=xe}return ae.slice(0,he)}function en(ue,C){return ue[0]-C[0]||ue[1]-C[1]}d.timer=function(){an.apply(this,arguments)},d.timer.flush=function(){_n(),ti()},d.round=function(ue,C){return C?Math.round(ue*(C=Math.pow(10,C)))/C:Math.round(ue)},d.geom={},d.geom.hull=function(ue){var C=jr,R=nn;if(arguments.length)return F(ue);function F(q){if(q.length<3)return[];var ae,he=yr(C),xe=yr(R),ke=q.length,Le=[],He=[];for(ae=0;ae<ke;ae++)Le.push([+he.call(this,q[ae],ae),+xe.call(this,q[ae],ae),ae]);for(Le.sort(en),ae=0;ae<ke;ae++)He.push([Le[ae][0],-Le[ae][1]]);var Je=vn(Le),ot=vn(He),Tt=ot[0]===Je[0],Ct=ot[ot.length-1]===Je[Je.length-1],At=[];for(ae=Je.length-1;ae>=0;--ae)At.push(q[Le[Je[ae]][2]]);for(ae=+Tt;ae<ot.length-Ct;++ae)At.push(q[Le[ot[ae]][2]]);return At}return F.x=function(q){return arguments.length?(C=q,F):C},F.y=function(q){return arguments.length?(R=q,F):R},F},d.geom.polygon=function(ue){return N(ue,fn),ue};var fn=d.geom.polygon.prototype=[];function Gn(ue,C,R){return(R[0]-C[0])*(ue[1]-C[1])<(R[1]-C[1])*(ue[0]-C[0])}function Tn(ue,C,R,F){var q=ue[0],ae=R[0],he=C[0]-q,xe=F[0]-ae,ke=ue[1],Le=R[1],He=C[1]-ke,Je=F[1]-Le,ot=(xe*(ke-Le)-Je*(q-ae))/(Je*he-xe*He);return[q+ot*he,ke+ot*He]}function Cn(ue){var C=ue[0],R=ue[ue.length-1];return!(C[0]-R[0]||C[1]-R[1])}fn.area=function(){for(var ue,C=-1,R=this.length,F=this[R-1],q=0;++C<R;)ue=F,F=this[C],q+=ue[1]*F[0]-ue[0]*F[1];return .5*q},fn.centroid=function(ue){var C,R,F=-1,q=this.length,ae=0,he=0,xe=this[q-1];for(arguments.length||(ue=-1/(6*this.area()));++F<q;)C=xe,xe=this[F],R=C[0]*xe[1]-xe[0]*C[1],ae+=(C[0]+xe[0])*R,he+=(C[1]+xe[1])*R;return[ae*ue,he*ue]},fn.clip=function(ue){for(var C,R,F,q,ae,he,xe=Cn(ue),ke=-1,Le=this.length-Cn(this),He=this[Le-1];++ke<Le;){for(C=ue.slice(),ue.length=0,q=this[ke],ae=C[(F=C.length-xe)-1],R=-1;++R<F;)Gn(he=C[R],He,q)?(Gn(ae,He,q)||ue.push(Tn(ae,he,He,q)),ue.push(he)):Gn(ae,He,q)&&ue.push(Tn(ae,he,He,q)),ae=he;xe&&ue.push(ue[0]),He=q}return ue};var oi,nr,vr,It,lr,dr=[],Br=[];function Fr(){En(this),this.edge=this.site=this.circle=null}function zr(ue){var C=dr.pop()||new Fr;return C.site=ue,C}function Er(ue){yn(ue),vr.remove(ue),dr.push(ue),En(ue)}function xr(ue){var C=ue.circle,R=C.x,F=C.cy,q={x:R,y:F},ae=ue.P,he=ue.N,xe=[ue];Er(ue);for(var ke=ae;ke.circle&&i(R-ke.circle.x)<vt&&i(F-ke.circle.cy)<vt;)ae=ke.P,xe.unshift(ke),Er(ke),ke=ae;xe.unshift(ke),yn(ke);for(var Le=he;Le.circle&&i(R-Le.circle.x)<vt&&i(F-Le.circle.cy)<vt;)he=Le.N,xe.push(Le),Er(Le),Le=he;xe.push(Le),yn(Le);var He,Je=xe.length;for(He=1;He<Je;++He)Le=xe[He],ke=xe[He-1],Zn(Le.edge,ke.site,Le.site,q);ke=xe[0],(Le=xe[Je-1]).edge=Pn(ke.site,Le.site,null,q),rn(ke),rn(Le)}function _r(ue){for(var C,R,F,q,ae=ue.x,he=ue.y,xe=vr._;xe;)if((F=kr(xe,he)-ae)>vt)xe=xe.L;else{if(!((q=ae-Cr(xe,he))>vt)){F>-vt?(C=xe.P,R=xe):q>-vt?(C=xe,R=xe.N):C=R=xe;break}if(!xe.R){C=xe;break}xe=xe.R}var ke=zr(ue);if(vr.insert(C,ke),C||R){if(C===R)return yn(C),R=zr(C.site),vr.insert(ke,R),ke.edge=R.edge=Pn(C.site,ke.site),rn(C),void rn(R);if(R){yn(C),yn(R);var Le=C.site,He=Le.x,Je=Le.y,ot=ue.x-He,Tt=ue.y-Je,Ct=R.site,At=Ct.x-He,Et=Ct.y-Je,_t=2*(ot*Et-Tt*At),Ft=ot*ot+Tt*Tt,zt=At*At+Et*Et,Vt={x:(Et*Ft-Tt*zt)/_t+He,y:(ot*zt-At*Ft)/_t+Je};Zn(R.edge,Le,Ct,Vt),ke.edge=Pn(Le,ue,null,Vt),R.edge=Pn(ue,Ct,null,Vt),rn(C),rn(R)}else ke.edge=Pn(C.site,ke.site)}}function kr(ue,C){var R=ue.site,F=R.x,q=R.y,ae=q-C;if(!ae)return F;var he=ue.P;if(!he)return-1/0;var xe=(R=he.site).x,ke=R.y,Le=ke-C;if(!Le)return xe;var He=xe-F,Je=1/ae-1/Le,ot=He/Le;return Je?(-ot+Math.sqrt(ot*ot-2*Je*(He*He/(-2*Le)-ke+Le/2+q-ae/2)))/Je+F:(F+xe)/2}function Cr(ue,C){var R=ue.N;if(R)return kr(R,C);var F=ue.site;return F.y===C?F.x:1/0}function Gr(ue){this.site=ue,this.edges=[]}function qr(ue,C){return C.angle-ue.angle}function Qr(){En(this),this.x=this.y=this.arc=this.site=this.cy=null}function rn(ue){var C=ue.P,R=ue.N;if(C&&R){var F=C.site,q=ue.site,ae=R.site;if(F!==ae){var he=q.x,xe=q.y,ke=F.x-he,Le=F.y-xe,He=ae.x-he,Je=2*(ke*(Et=ae.y-xe)-Le*He);if(!(Je>=-1e-12)){var ot=ke*ke+Le*Le,Tt=He*He+Et*Et,Ct=(Et*ot-Le*Tt)/Je,At=(ke*Tt-He*ot)/Je,Et=At+xe,_t=Br.pop()||new Qr;_t.arc=ue,_t.site=q,_t.x=Ct+he,_t.y=Et+Math.sqrt(Ct*Ct+At*At),_t.cy=Et,ue.circle=_t;for(var Ft=null,zt=lr._;zt;)if(_t.y<zt.y||_t.y===zt.y&&_t.x<=zt.x){if(!zt.L){Ft=zt.P;break}zt=zt.L}else{if(!zt.R){Ft=zt;break}zt=zt.R}lr.insert(Ft,_t),Ft||(It=_t)}}}}function yn(ue){var C=ue.circle;C&&(C.P||(It=C.N),lr.remove(C),Br.push(C),En(C),ue.circle=null)}function wn(ue,C){var R=ue.b;if(R)return!0;var F,q,ae=ue.a,he=C[0][0],xe=C[1][0],ke=C[0][1],Le=C[1][1],He=ue.l,Je=ue.r,ot=He.x,Tt=He.y,Ct=Je.x,At=Je.y,Et=(ot+Ct)/2,_t=(Tt+At)/2;if(At===Tt){if(Et<he||Et>=xe)return;if(ot>Ct){if(ae){if(ae.y>=Le)return}else ae={x:Et,y:ke};R={x:Et,y:Le}}else{if(ae){if(ae.y<ke)return}else ae={x:Et,y:Le};R={x:Et,y:ke}}}else if(q=_t-(F=(ot-Ct)/(At-Tt))*Et,F<-1||F>1)if(ot>Ct){if(ae){if(ae.y>=Le)return}else ae={x:(ke-q)/F,y:ke};R={x:(Le-q)/F,y:Le}}else{if(ae){if(ae.y<ke)return}else ae={x:(Le-q)/F,y:Le};R={x:(ke-q)/F,y:ke}}else if(Tt<At){if(ae){if(ae.x>=xe)return}else ae={x:he,y:F*he+q};R={x:xe,y:F*xe+q}}else{if(ae){if(ae.x<he)return}else ae={x:xe,y:F*xe+q};R={x:he,y:F*he+q}}return ue.a=ae,ue.b=R,!0}function kn(ue,C){this.l=ue,this.r=C,this.a=this.b=null}function Pn(ue,C,R,F){var q=new kn(ue,C);return oi.push(q),R&&Zn(q,ue,C,R),F&&Zn(q,C,ue,F),nr[ue.i].edges.push(new Ai(q,ue,C)),nr[C.i].edges.push(new Ai(q,C,ue)),q}function Dn(ue,C,R){var F=new kn(ue,null);return F.a=C,F.b=R,oi.push(F),F}function Zn(ue,C,R,F){ue.a||ue.b?ue.l===R?ue.b=F:ue.a=F:(ue.a=F,ue.l=C,ue.r=R)}function Ai(ue,C,R){var F=ue.a,q=ue.b;this.edge=ue,this.site=C,this.angle=R?Math.atan2(R.y-C.y,R.x-C.x):ue.l===C?Math.atan2(q.x-F.x,F.y-q.y):Math.atan2(F.x-q.x,q.y-F.y)}function Mi(){this._=null}function En(ue){ue.U=ue.C=ue.L=ue.R=ue.P=ue.N=null}function Qn(ue,C){var R=C,F=C.R,q=R.U;q?q.L===R?q.L=F:q.R=F:ue._=F,F.U=q,R.U=F,R.R=F.L,R.R&&(R.R.U=R),F.L=R}function Jn(ue,C){var R=C,F=C.L,q=R.U;q?q.L===R?q.L=F:q.R=F:ue._=F,F.U=q,R.U=F,R.L=F.R,R.L&&(R.L.U=R),F.R=R}function Di(ue){for(;ue.L;)ue=ue.L;return ue}function va(ue,C){var R,F,q,ae=ue.sort(Ba).pop();for(oi=[],nr=new Array(ue.length),vr=new Mi,lr=new Mi;;)if(q=It,ae&&(!q||ae.y<q.y||ae.y===q.y&&ae.x<q.x))ae.x===R&&ae.y===F||(nr[ae.i]=new Gr(ae),_r(ae),R=ae.x,F=ae.y),ae=ue.pop();else{if(!q)break;xr(q.arc)}C&&(function(xe){for(var ke,Le,He,Je,ot,Tt=oi,Ct=(Le=xe[0][0],He=xe[0][1],Je=xe[1][0],ot=xe[1][1],function(Et){var _t,Ft=Et.a,zt=Et.b,Vt=Ft.x,ir=Ft.y,gr=0,Lr=1,Ar=zt.x-Vt,$r=zt.y-ir;if(_t=Le-Vt,Ar||!(_t>0)){if(_t/=Ar,Ar<0){if(_t<gr)return;_t<Lr&&(Lr=_t)}else if(Ar>0){if(_t>Lr)return;_t>gr&&(gr=_t)}if(_t=Je-Vt,Ar||!(_t<0)){if(_t/=Ar,Ar<0){if(_t>Lr)return;_t>gr&&(gr=_t)}else if(Ar>0){if(_t<gr)return;_t<Lr&&(Lr=_t)}if(_t=He-ir,$r||!(_t>0)){if(_t/=$r,$r<0){if(_t<gr)return;_t<Lr&&(Lr=_t)}else if($r>0){if(_t>Lr)return;_t>gr&&(gr=_t)}if(_t=ot-ir,$r||!(_t<0)){if(_t/=$r,$r<0){if(_t>Lr)return;_t>gr&&(gr=_t)}else if($r>0){if(_t<gr)return;_t<Lr&&(Lr=_t)}return gr>0&&(Et.a={x:Vt+gr*Ar,y:ir+gr*$r}),Lr<1&&(Et.b={x:Vt+Lr*Ar,y:ir+Lr*$r}),Et}}}}}),At=Tt.length;At--;)(!wn(ke=Tt[At],xe)||!Ct(ke)||i(ke.a.x-ke.b.x)<vt&&i(ke.a.y-ke.b.y)<vt)&&(ke.a=ke.b=null,Tt.splice(At,1))}(C),function(xe){for(var ke,Le,He,Je,ot,Tt,Ct,At,Et,_t,Ft=xe[0][0],zt=xe[1][0],Vt=xe[0][1],ir=xe[1][1],gr=nr,Lr=gr.length;Lr--;)if((ot=gr[Lr])&&ot.prepare())for(At=(Ct=ot.edges).length,Tt=0;Tt<At;)He=(_t=Ct[Tt].end()).x,Je=_t.y,ke=(Et=Ct[++Tt%At].start()).x,Le=Et.y,(i(He-ke)>vt||i(Je-Le)>vt)&&(Ct.splice(Tt,0,new Ai(Dn(ot.site,_t,i(He-Ft)<vt&&ir-Je>vt?{x:Ft,y:i(ke-Ft)<vt?Le:ir}:i(Je-ir)<vt&&zt-He>vt?{x:i(Le-ir)<vt?ke:zt,y:ir}:i(He-zt)<vt&&Je-Vt>vt?{x:zt,y:i(ke-zt)<vt?Le:Vt}:i(Je-Vt)<vt&&He-Ft>vt?{x:i(Le-Vt)<vt?ke:Ft,y:Vt}:null),ot.site,null)),++At)}(C));var he={cells:nr,edges:oi};return vr=lr=oi=nr=null,he}function Ba(ue,C){return C.y-ue.y||C.x-ue.x}Gr.prototype.prepare=function(){for(var ue,C=this.edges,R=C.length;R--;)(ue=C[R].edge).b&&ue.a||C.splice(R,1);return C.sort(qr),C.length},Ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Mi.prototype={insert:function(ue,C){var R,F,q;if(ue){if(C.P=ue,C.N=ue.N,ue.N&&(ue.N.P=C),ue.N=C,ue.R){for(ue=ue.R;ue.L;)ue=ue.L;ue.L=C}else ue.R=C;R=ue}else this._?(ue=Di(this._),C.P=null,C.N=ue,ue.P=ue.L=C,R=ue):(C.P=C.N=null,this._=C,R=null);for(C.L=C.R=null,C.U=R,C.C=!0,ue=C;R&&R.C;)R===(F=R.U).L?(q=F.R)&&q.C?(R.C=q.C=!1,F.C=!0,ue=F):(ue===R.R&&(Qn(this,R),R=(ue=R).U),R.C=!1,F.C=!0,Jn(this,F)):(q=F.L)&&q.C?(R.C=q.C=!1,F.C=!0,ue=F):(ue===R.L&&(Jn(this,R),R=(ue=R).U),R.C=!1,F.C=!0,Qn(this,F)),R=ue.U;this._.C=!1},remove:function(ue){ue.N&&(ue.N.P=ue.P),ue.P&&(ue.P.N=ue.N),ue.N=ue.P=null;var C,R,F,q=ue.U,ae=ue.L,he=ue.R;if(R=ae?he?Di(he):ae:he,q?q.L===ue?q.L=R:q.R=R:this._=R,ae&&he?(F=R.C,R.C=ue.C,R.L=ae,ae.U=R,R!==he?(q=R.U,R.U=ue.U,ue=R.R,q.L=ue,R.R=he,he.U=R):(R.U=q,q=R,ue=R.R)):(F=ue.C,ue=R),ue&&(ue.U=q),!F)if(ue&&ue.C)ue.C=!1;else{do{if(ue===this._)break;if(ue===q.L){if((C=q.R).C&&(C.C=!1,q.C=!0,Qn(this,q),C=q.R),C.L&&C.L.C||C.R&&C.R.C){C.R&&C.R.C||(C.L.C=!1,C.C=!0,Jn(this,C),C=q.R),C.C=q.C,q.C=C.R.C=!1,Qn(this,q),ue=this._;break}}else if((C=q.L).C&&(C.C=!1,q.C=!0,Jn(this,q),C=q.L),C.L&&C.L.C||C.R&&C.R.C){C.L&&C.L.C||(C.R.C=!1,C.C=!0,Qn(this,C),C=q.L),C.C=q.C,q.C=C.L.C=!1,Jn(this,q),ue=this._;break}C.C=!0,ue=q,q=q.U}while(!ue.C);ue&&(ue.C=!1)}}},d.geom.voronoi=function(ue){var C=jr,R=nn,F=C,q=R,ae=mo;if(ue)return he(ue);function he(ke){var Le=new Array(ke.length),He=ae[0][0],Je=ae[0][1],ot=ae[1][0],Tt=ae[1][1];return va(xe(ke),ae).cells.forEach(function(Ct,At){var Et=Ct.edges,_t=Ct.site;(Le[At]=Et.length?Et.map(function(Ft){var zt=Ft.start();return[zt.x,zt.y]}):_t.x>=He&&_t.x<=ot&&_t.y>=Je&&_t.y<=Tt?[[He,Tt],[ot,Tt],[ot,Je],[He,Je]]:[]).point=ke[At]}),Le}function xe(ke){return ke.map(function(Le,He){return{x:Math.round(F(Le,He)/vt)*vt,y:Math.round(q(Le,He)/vt)*vt,i:He}})}return he.links=function(ke){return va(xe(ke)).edges.filter(function(Le){return Le.l&&Le.r}).map(function(Le){return{source:ke[Le.l.i],target:ke[Le.r.i]}})},he.triangles=function(ke){var Le=[];return va(xe(ke)).cells.forEach(function(He,Je){for(var ot,Tt,Ct,At,Et=He.site,_t=He.edges.sort(qr),Ft=-1,zt=_t.length,Vt=_t[zt-1].edge,ir=Vt.l===Et?Vt.r:Vt.l;++Ft<zt;)ot=ir,ir=(Vt=_t[Ft].edge).l===Et?Vt.r:Vt.l,Je<ot.i&&Je<ir.i&&(Ct=ot,At=ir,((Tt=Et).x-At.x)*(Ct.y-Tt.y)-(Tt.x-Ct.x)*(At.y-Tt.y)<0)&&Le.push([ke[Je],ke[ot.i],ke[ir.i]])}),Le},he.x=function(ke){return arguments.length?(F=yr(C=ke),he):C},he.y=function(ke){return arguments.length?(q=yr(R=ke),he):R},he.clipExtent=function(ke){return arguments.length?(ae=ke==null?mo:ke,he):ae===mo?null:ae},he.size=function(ke){return arguments.length?he.clipExtent(ke&&[[0,0],ke]):ae===mo?null:ae&&ae[1]},he};var mo=[[-1e6,-1e6],[1e6,1e6]];function Wi(ue){return ue.x}function Zi(ue){return ue.y}function to(ue,C,R,F,q,ae){if(!ue(C,R,F,q,ae)){var he=.5*(R+q),xe=.5*(F+ae),ke=C.nodes;ke[0]&&to(ue,ke[0],R,F,he,xe),ke[1]&&to(ue,ke[1],he,F,q,xe),ke[2]&&to(ue,ke[2],R,xe,he,ae),ke[3]&&to(ue,ke[3],he,xe,q,ae)}}function Ni(ue,C,R,F,q,ae,he){var xe,ke=1/0;return function Le(He,Je,ot,Tt,Ct){if(!(Je>ae||ot>he||Tt<F||Ct<q)){if(At=He.point){var At,Et=C-He.x,_t=R-He.y,Ft=Et*Et+_t*_t;if(Ft<ke){var zt=Math.sqrt(ke=Ft);F=C-zt,q=R-zt,ae=C+zt,he=R+zt,xe=At}}for(var Vt=He.nodes,ir=.5*(Je+Tt),gr=.5*(ot+Ct),Lr=(R>=gr)<<1|C>=ir,Ar=Lr+4;Lr<Ar;++Lr)if(He=Vt[3&Lr])switch(3&Lr){case 0:Le(He,Je,ot,ir,gr);break;case 1:Le(He,ir,ot,Tt,gr);break;case 2:Le(He,Je,gr,ir,Ct);break;case 3:Le(He,ir,gr,Tt,Ct)}}}(ue,F,q,ae,he),xe}function go(ue,C){ue=d.rgb(ue),C=d.rgb(C);var R=ue.r,F=ue.g,q=ue.b,ae=C.r-R,he=C.g-F,xe=C.b-q;return function(ke){return"#"+pr(Math.round(R+ae*ke))+pr(Math.round(F+he*ke))+pr(Math.round(q+xe*ke))}}function bo(ue,C){var R,F={},q={};for(R in ue)R in C?F[R]=Va(ue[R],C[R]):q[R]=ue[R];for(R in C)R in ue||(q[R]=C[R]);return function(ae){for(R in F)q[R]=F[R](ae);return q}}function Ma(ue,C){return ue=+ue,C=+C,function(R){return ue*(1-R)+C*R}}function ro(ue,C){var R,F,q,ae=_o.lastIndex=Co.lastIndex=0,he=-1,xe=[],ke=[];for(ue+="",C+="";(R=_o.exec(ue))&&(F=Co.exec(C));)(q=F.index)>ae&&(q=C.slice(ae,q),xe[he]?xe[he]+=q:xe[++he]=q),(R=R[0])===(F=F[0])?xe[he]?xe[he]+=F:xe[++he]=F:(xe[++he]=null,ke.push({i:he,x:Ma(R,F)})),ae=Co.lastIndex;return ae<C.length&&(q=C.slice(ae),xe[he]?xe[he]+=q:xe[++he]=q),xe.length<2?ke[0]?(C=ke[0].x,function(Le){return C(Le)+""}):function(){return C}:(C=ke.length,function(Le){for(var He,Je=0;Je<C;++Je)xe[(He=ke[Je]).i]=He.x(Le);return xe.join("")})}d.geom.delaunay=function(ue){return d.geom.voronoi().triangles(ue)},d.geom.quadtree=function(ue,C,R,F,q){var ae,he=jr,xe=nn;if(ae=arguments.length)return he=Wi,xe=Zi,ae===3&&(q=R,F=C,R=C=0),ke(ue);function ke(Le){var He,Je,ot,Tt,Ct,At,Et,_t,Ft,zt=yr(he),Vt=yr(xe);if(C!=null)At=C,Et=R,_t=F,Ft=q;else if(_t=Ft=-(At=Et=1/0),Je=[],ot=[],Ct=Le.length,ae)for(Tt=0;Tt<Ct;++Tt)(He=Le[Tt]).x<At&&(At=He.x),He.y<Et&&(Et=He.y),He.x>_t&&(_t=He.x),He.y>Ft&&(Ft=He.y),Je.push(He.x),ot.push(He.y);else for(Tt=0;Tt<Ct;++Tt){var ir=+zt(He=Le[Tt],Tt),gr=+Vt(He,Tt);ir<At&&(At=ir),gr<Et&&(Et=gr),ir>_t&&(_t=ir),gr>Ft&&(Ft=gr),Je.push(ir),ot.push(gr)}var Lr=_t-At,Ar=Ft-Et;function $r(ln,Vn,Xn,hi,Yr,Sn,Kn,Yn){if(!isNaN(Xn)&&!isNaN(hi))if(ln.leaf){var ai=ln.x,di=ln.y;if(ai!=null)if(i(ai-Xn)+i(di-hi)<.01)Jr(ln,Vn,Xn,hi,Yr,Sn,Kn,Yn);else{var Li=ln.point;ln.x=ln.y=ln.point=null,Jr(ln,Li,ai,di,Yr,Sn,Kn,Yn),Jr(ln,Vn,Xn,hi,Yr,Sn,Kn,Yn)}else ln.x=Xn,ln.y=hi,ln.point=Vn}else Jr(ln,Vn,Xn,hi,Yr,Sn,Kn,Yn)}function Jr(ln,Vn,Xn,hi,Yr,Sn,Kn,Yn){var ai=.5*(Yr+Kn),di=.5*(Sn+Yn),Li=Xn>=ai,ei=hi>=di,_i=ei<<1|Li;ln.leaf=!1,Li?Yr=ai:Kn=ai,ei?Sn=di:Yn=di,$r(ln=ln.nodes[_i]||(ln.nodes[_i]={leaf:!0,nodes:[],point:null,x:null,y:null}),Vn,Xn,hi,Yr,Sn,Kn,Yn)}Lr>Ar?Ft=Et+Lr:_t=At+Ar;var dn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(ln){$r(dn,ln,+zt(ln,++Tt),+Vt(ln,Tt),At,Et,_t,Ft)},visit:function(ln){to(ln,dn,At,Et,_t,Ft)},find:function(ln){return Ni(dn,ln[0],ln[1],At,Et,_t,Ft)}};if(Tt=-1,C==null){for(;++Tt<Ct;)$r(dn,Le[Tt],Je[Tt],ot[Tt],At,Et,_t,Ft);--Tt}else Le.forEach(dn.add);return Je=ot=Le=He=null,dn}return ke.x=function(Le){return arguments.length?(he=Le,ke):he},ke.y=function(Le){return arguments.length?(xe=Le,ke):xe},ke.extent=function(Le){return arguments.length?(Le==null?C=R=F=q=null:(C=+Le[0][0],R=+Le[0][1],F=+Le[1][0],q=+Le[1][1]),ke):C==null?null:[[C,R],[F,q]]},ke.size=function(Le){return arguments.length?(Le==null?C=R=F=q=null:(C=R=0,F=+Le[0],q=+Le[1]),ke):C==null?null:[F-C,q-R]},ke},d.interpolateRgb=go,d.interpolateObject=bo,d.interpolateNumber=Ma,d.interpolateString=ro;var _o=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Co=new RegExp(_o.source,"g");function Va(ue,C){for(var R,F=d.interpolators.length;--F>=0&&!(R=d.interpolators[F](ue,C)););return R}function ya(ue,C){var R,F=[],q=[],ae=ue.length,he=C.length,xe=Math.min(ue.length,C.length);for(R=0;R<xe;++R)F.push(Va(ue[R],C[R]));for(;R<ae;++R)q[R]=ue[R];for(;R<he;++R)q[R]=C[R];return function(ke){for(R=0;R<xe;++R)q[R]=F[R](ke);return q}}d.interpolate=Va,d.interpolators=[function(ue,C){var R=typeof C;return(R==="string"?fr.has(C.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(C)?go:ro:C instanceof Ke?go:Array.isArray(C)?ya:R==="object"&&isNaN(C)?bo:Ma)(ue,C)}],d.interpolateArray=ya;var Qa=function(){return E},Cs=d.map({linear:Qa,poly:function(ue){return function(C){return Math.pow(C,ue)}},quad:function(){return Fs},cubic:function(){return Bs},sin:function(){return Ns},exp:function(){return Do},circle:function(){return zo},elastic:function(ue,C){var R;return arguments.length<2&&(C=.45),arguments.length?R=C/qt*Math.asin(1/ue):(ue=1,R=C/4),function(F){return 1+ue*Math.pow(2,-10*F)*Math.sin((F-R)*qt/C)}},back:function(ue){return ue||(ue=1.70158),function(C){return C*C*((ue+1)*C-ue)}},bounce:function(){return Yo}}),Rs=d.map({in:E,out:Ts,"in-out":ss,"out-in":function(ue){return ss(Ts(ue))}});function Xi(ue){return function(C){return C<=0?0:C>=1?1:ue(C)}}function Ts(ue){return function(C){return 1-ue(1-C)}}function ss(ue){return function(C){return .5*(C<.5?ue(2*C):2-ue(2-2*C))}}function Fs(ue){return ue*ue}function Bs(ue){return ue*ue*ue}function Ps(ue){if(ue<=0)return 0;if(ue>=1)return 1;var C=ue*ue,R=C*ue;return 4*(ue<.5?R:3*(ue-C)+R-.75)}function Ns(ue){return 1-Math.cos(ue*Wt)}function Do(ue){return Math.pow(2,10*(ue-1))}function zo(ue){return 1-Math.sqrt(1-ue*ue)}function Yo(ue){return ue<1/2.75?7.5625*ue*ue:ue<2/2.75?7.5625*(ue-=1.5/2.75)*ue+.75:ue<2.5/2.75?7.5625*(ue-=2.25/2.75)*ue+.9375:7.5625*(ue-=2.625/2.75)*ue+.984375}function Wo(ue,C){return C-=ue,function(R){return Math.round(ue+C*R)}}function Zo(ue){var C,R,F,q=[ue.a,ue.b],ae=[ue.c,ue.d],he=wo(q),xe=ls(q,ae),ke=wo(((C=ae)[0]+=(F=-xe)*(R=q)[0],C[1]+=F*R[1],C))||0;q[0]*ae[1]<ae[0]*q[1]&&(q[0]*=-1,q[1]*=-1,he*=-1,xe*=-1),this.rotate=(he?Math.atan2(q[1],q[0]):Math.atan2(-ae[0],ae[1]))*Dt,this.translate=[ue.e,ue.f],this.scale=[he,ke],this.skew=ke?Math.atan2(xe,ke)*Dt:0}function ls(ue,C){return ue[0]*C[0]+ue[1]*C[1]}function wo(ue){var C=Math.sqrt(ls(ue,ue));return C&&(ue[0]/=C,ue[1]/=C),C}d.ease=function(ue){var C=ue.indexOf("-"),R=C>=0?ue.slice(0,C):ue,F=C>=0?ue.slice(C+1):"in";return R=Cs.get(R)||Qa,Xi((F=Rs.get(F)||E)(R.apply(null,v.call(arguments,1))))},d.interpolateHcl=function(ue,C){ue=d.hcl(ue),C=d.hcl(C);var R=ue.h,F=ue.c,q=ue.l,ae=C.h-R,he=C.c-F,xe=C.l-q;return isNaN(he)&&(he=0,F=isNaN(F)?C.c:F),isNaN(ae)?(ae=0,R=isNaN(R)?C.h:R):ae>180?ae-=360:ae<-180&&(ae+=360),function(ke){return it(R+ae*ke,F+he*ke,q+xe*ke)+""}},d.interpolateHsl=function(ue,C){ue=d.hsl(ue),C=d.hsl(C);var R=ue.h,F=ue.s,q=ue.l,ae=C.h-R,he=C.s-F,xe=C.l-q;return isNaN(he)&&(he=0,F=isNaN(F)?C.s:F),isNaN(ae)?(ae=0,R=isNaN(R)?C.h:R):ae>180?ae-=360:ae<-180&&(ae+=360),function(ke){return st(R+ae*ke,F+he*ke,q+xe*ke)+""}},d.interpolateLab=function(ue,C){ue=d.lab(ue),C=d.lab(C);var R=ue.l,F=ue.a,q=ue.b,ae=C.l-R,he=C.a-F,xe=C.b-q;return function(ke){return Pt(R+ae*ke,F+he*ke,q+xe*ke)+""}},d.interpolateRound=Wo,d.transform=function(ue){var C=y.createElementNS(d.ns.prefix.svg,"g");return(d.transform=function(R){if(R!=null){C.setAttribute("transform",R);var F=C.transform.baseVal.consolidate()}return new Zo(F?F.matrix:ks)})(ue)},Zo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ks={a:1,b:0,c:0,d:1,e:0,f:0};function vo(ue){return ue.length?ue.pop()+",":""}function Xo(ue,C){var R=[],F=[];return ue=d.transform(ue),C=d.transform(C),function(q,ae,he,xe){if(q[0]!==ae[0]||q[1]!==ae[1]){var ke=he.push("translate(",null,",",null,")");xe.push({i:ke-4,x:Ma(q[0],ae[0])},{i:ke-2,x:Ma(q[1],ae[1])})}else(ae[0]||ae[1])&&he.push("translate("+ae+")")}(ue.translate,C.translate,R,F),function(q,ae,he,xe){q!==ae?(q-ae>180?ae+=360:ae-q>180&&(q+=360),xe.push({i:he.push(vo(he)+"rotate(",null,")")-2,x:Ma(q,ae)})):ae&&he.push(vo(he)+"rotate("+ae+")")}(ue.rotate,C.rotate,R,F),function(q,ae,he,xe){q!==ae?xe.push({i:he.push(vo(he)+"skewX(",null,")")-2,x:Ma(q,ae)}):ae&&he.push(vo(he)+"skewX("+ae+")")}(ue.skew,C.skew,R,F),function(q,ae,he,xe){if(q[0]!==ae[0]||q[1]!==ae[1]){var ke=he.push(vo(he)+"scale(",null,",",null,")");xe.push({i:ke-4,x:Ma(q[0],ae[0])},{i:ke-2,x:Ma(q[1],ae[1])})}else ae[0]===1&&ae[1]===1||he.push(vo(he)+"scale("+ae+")")}(ue.scale,C.scale,R,F),ue=C=null,function(q){for(var ae,he=-1,xe=F.length;++he<xe;)R[(ae=F[he]).i]=ae.x(q);return R.join("")}}function Ms(ue,C){return C=(C-=ue=+ue)||1/C,function(R){return(R-ue)/C}}function Ro(ue,C){return C=(C-=ue=+ue)||1/C,function(R){return Math.max(0,Math.min(1,(R-ue)/C))}}function Gi(ue){for(var C=ue.source,R=ue.target,F=function(he,xe){if(he===xe)return he;for(var ke=Ue(he),Le=Ue(xe),He=ke.pop(),Je=Le.pop(),ot=null;He===Je;)ot=He,He=ke.pop(),Je=Le.pop();return ot}(C,R),q=[C];C!==F;)C=C.parent,q.push(C);for(var ae=q.length;R!==F;)q.splice(ae,0,R),R=R.parent;return q}function Ue(ue){for(var C=[],R=ue.parent;R!=null;)C.push(ue),ue=R,R=R.parent;return C.push(ue),C}function We(ue){ue.fixed|=2}function rt(ue){ue.fixed&=-7}function ut(ue){ue.fixed|=4,ue.px=ue.x,ue.py=ue.y}function yt(ue){ue.fixed&=-5}d.interpolateTransform=Xo,d.layout={},d.layout.bundle=function(){return function(ue){for(var C=[],R=-1,F=ue.length;++R<F;)C.push(Gi(ue[R]));return C}},d.layout.chord=function(){var ue,C,R,F,q,ae,he,xe={},ke=0;function Le(){var Je,ot,Tt,Ct,At,Et={},_t=[],Ft=d.range(F),zt=[];for(ue=[],C=[],Je=0,Ct=-1;++Ct<F;){for(ot=0,At=-1;++At<F;)ot+=R[Ct][At];_t.push(ot),zt.push(d.range(F)),Je+=ot}for(q&&Ft.sort(function(dn,ln){return q(_t[dn],_t[ln])}),ae&&zt.forEach(function(dn,ln){dn.sort(function(Vn,Xn){return ae(R[ln][Vn],R[ln][Xn])})}),Je=(qt-ke*F)/Je,ot=0,Ct=-1;++Ct<F;){for(Tt=ot,At=-1;++At<F;){var Vt=Ft[Ct],ir=zt[Vt][At],gr=R[Vt][ir],Lr=ot,Ar=ot+=gr*Je;Et[Vt+"-"+ir]={index:Vt,subindex:ir,startAngle:Lr,endAngle:Ar,value:gr}}C[Vt]={index:Vt,startAngle:Tt,endAngle:ot,value:_t[Vt]},ot+=ke}for(Ct=-1;++Ct<F;)for(At=Ct-1;++At<F;){var $r=Et[Ct+"-"+At],Jr=Et[At+"-"+Ct];($r.value||Jr.value)&&ue.push($r.value<Jr.value?{source:Jr,target:$r}:{source:$r,target:Jr})}he&&He()}function He(){ue.sort(function(Je,ot){return he((Je.source.value+Je.target.value)/2,(ot.source.value+ot.target.value)/2)})}return xe.matrix=function(Je){return arguments.length?(F=(R=Je)&&R.length,ue=C=null,xe):R},xe.padding=function(Je){return arguments.length?(ke=Je,ue=C=null,xe):ke},xe.sortGroups=function(Je){return arguments.length?(q=Je,ue=C=null,xe):q},xe.sortSubgroups=function(Je){return arguments.length?(ae=Je,ue=null,xe):ae},xe.sortChords=function(Je){return arguments.length?(he=Je,ue&&He(),xe):he},xe.chords=function(){return ue||Le(),ue},xe.groups=function(){return C||Le(),C},xe},d.layout.force=function(){var ue,C,R,F,q,ae,he={},xe=d.dispatch("start","tick","end"),ke=[1,1],Le=.9,He=mt,Je=Lt,ot=-30,Tt=$t,Ct=.1,At=.64,Et=[],_t=[];function Ft(Vt){return function(ir,gr,Lr,Ar){if(ir.point!==Vt){var $r=ir.cx-Vt.x,Jr=ir.cy-Vt.y,dn=Ar-gr,ln=$r*$r+Jr*Jr;if(dn*dn/At<ln){if(ln<Tt){var Vn=ir.charge/ln;Vt.px-=$r*Vn,Vt.py-=Jr*Vn}return!0}ir.point&&ln&&ln<Tt&&(Vn=ir.pointCharge/ln,Vt.px-=$r*Vn,Vt.py-=Jr*Vn)}return!ir.charge}}function zt(Vt){Vt.px=d.event.x,Vt.py=d.event.y,he.resume()}return he.tick=function(){if((R*=.99)<.005)return ue=null,xe.end({type:"end",alpha:R=0}),!0;var Vt,ir,gr,Lr,Ar,$r,Jr,dn,ln,Vn=Et.length,Xn=_t.length;for(ir=0;ir<Xn;++ir)Lr=(gr=_t[ir]).source,($r=(dn=(Ar=gr.target).x-Lr.x)*dn+(ln=Ar.y-Lr.y)*ln)&&(dn*=$r=R*q[ir]*(($r=Math.sqrt($r))-F[ir])/$r,ln*=$r,Ar.x-=dn*(Jr=Lr.weight+Ar.weight?Lr.weight/(Lr.weight+Ar.weight):.5),Ar.y-=ln*Jr,Lr.x+=dn*(Jr=1-Jr),Lr.y+=ln*Jr);if((Jr=R*Ct)&&(dn=ke[0]/2,ln=ke[1]/2,ir=-1,Jr))for(;++ir<Vn;)(gr=Et[ir]).x+=(dn-gr.x)*Jr,gr.y+=(ln-gr.y)*Jr;if(ot)for(function hi(Yr,Sn,Kn){var Yn=0,ai=0;if(Yr.charge=0,!Yr.leaf)for(var di,Li=Yr.nodes,ei=Li.length,_i=-1;++_i<ei;)(di=Li[_i])!=null&&(hi(di,Sn,Kn),Yr.charge+=di.charge,Yn+=di.charge*di.cx,ai+=di.charge*di.cy);if(Yr.point){Yr.leaf||(Yr.point.x+=Math.random()-.5,Yr.point.y+=Math.random()-.5);var yi=Sn*Kn[Yr.point.index];Yr.charge+=Yr.pointCharge=yi,Yn+=yi*Yr.point.x,ai+=yi*Yr.point.y}Yr.cx=Yn/Yr.charge,Yr.cy=ai/Yr.charge}(Vt=d.geom.quadtree(Et),R,ae),ir=-1;++ir<Vn;)(gr=Et[ir]).fixed||Vt.visit(Ft(gr));for(ir=-1;++ir<Vn;)(gr=Et[ir]).fixed?(gr.x=gr.px,gr.y=gr.py):(gr.x-=(gr.px-(gr.px=gr.x))*Le,gr.y-=(gr.py-(gr.py=gr.y))*Le);xe.tick({type:"tick",alpha:R})},he.nodes=function(Vt){return arguments.length?(Et=Vt,he):Et},he.links=function(Vt){return arguments.length?(_t=Vt,he):_t},he.size=function(Vt){return arguments.length?(ke=Vt,he):ke},he.linkDistance=function(Vt){return arguments.length?(He=typeof Vt=="function"?Vt:+Vt,he):He},he.distance=he.linkDistance,he.linkStrength=function(Vt){return arguments.length?(Je=typeof Vt=="function"?Vt:+Vt,he):Je},he.friction=function(Vt){return arguments.length?(Le=+Vt,he):Le},he.charge=function(Vt){return arguments.length?(ot=typeof Vt=="function"?Vt:+Vt,he):ot},he.chargeDistance=function(Vt){return arguments.length?(Tt=Vt*Vt,he):Math.sqrt(Tt)},he.gravity=function(Vt){return arguments.length?(Ct=+Vt,he):Ct},he.theta=function(Vt){return arguments.length?(At=Vt*Vt,he):Math.sqrt(At)},he.alpha=function(Vt){return arguments.length?(Vt=+Vt,R?Vt>0?R=Vt:(ue.c=null,ue.t=NaN,ue=null,xe.end({type:"end",alpha:R=0})):Vt>0&&(xe.start({type:"start",alpha:R=Vt}),ue=an(he.tick)),he):R},he.start=function(){var Vt,ir,gr,Lr=Et.length,Ar=_t.length,$r=ke[0],Jr=ke[1];for(Vt=0;Vt<Lr;++Vt)(gr=Et[Vt]).index=Vt,gr.weight=0;for(Vt=0;Vt<Ar;++Vt)typeof(gr=_t[Vt]).source=="number"&&(gr.source=Et[gr.source]),typeof gr.target=="number"&&(gr.target=Et[gr.target]),++gr.source.weight,++gr.target.weight;for(Vt=0;Vt<Lr;++Vt)gr=Et[Vt],isNaN(gr.x)&&(gr.x=dn("x",$r)),isNaN(gr.y)&&(gr.y=dn("y",Jr)),isNaN(gr.px)&&(gr.px=gr.x),isNaN(gr.py)&&(gr.py=gr.y);if(F=[],typeof He=="function")for(Vt=0;Vt<Ar;++Vt)F[Vt]=+He.call(this,_t[Vt],Vt);else for(Vt=0;Vt<Ar;++Vt)F[Vt]=He;if(q=[],typeof Je=="function")for(Vt=0;Vt<Ar;++Vt)q[Vt]=+Je.call(this,_t[Vt],Vt);else for(Vt=0;Vt<Ar;++Vt)q[Vt]=Je;if(ae=[],typeof ot=="function")for(Vt=0;Vt<Lr;++Vt)ae[Vt]=+ot.call(this,Et[Vt],Vt);else for(Vt=0;Vt<Lr;++Vt)ae[Vt]=ot;function dn(ln,Vn){if(!ir){for(ir=new Array(Lr),Sn=0;Sn<Lr;++Sn)ir[Sn]=[];for(Sn=0;Sn<Ar;++Sn){var Xn=_t[Sn];ir[Xn.source.index].push(Xn.target),ir[Xn.target.index].push(Xn.source)}}for(var hi,Yr=ir[Vt],Sn=-1,Kn=Yr.length;++Sn<Kn;)if(!isNaN(hi=Yr[Sn][ln]))return hi;return Math.random()*Vn}return he.resume()},he.resume=function(){return he.alpha(.1)},he.stop=function(){return he.alpha(0)},he.drag=function(){if(C||(C=d.behavior.drag().origin(E).on("dragstart.force",We).on("drag.force",zt).on("dragend.force",rt)),!arguments.length)return C;this.on("mouseover.force",ut).on("mouseout.force",yt).call(C)},d.rebind(he,xe,"on")};var mt=20,Lt=1,$t=1/0;function er(ue,C){return d.rebind(ue,C,"sort","children","value"),ue.nodes=ue,ue.links=Rr,ue}function Zt(ue,C){for(var R=[ue];(ue=R.pop())!=null;)if(C(ue),(q=ue.children)&&(F=q.length))for(var F,q;--F>=0;)R.push(q[F])}function or(ue,C){for(var R=[ue],F=[];(ue=R.pop())!=null;)if(F.push(ue),(ae=ue.children)&&(q=ae.length))for(var q,ae,he=-1;++he<q;)R.push(ae[he]);for(;(ue=F.pop())!=null;)C(ue)}function mr(ue){return ue.children}function wr(ue){return ue.value}function Tr(ue,C){return C.value-ue.value}function Rr(ue){return d.merge(ue.map(function(C){return(C.children||[]).map(function(R){return{source:C,target:R}})}))}d.layout.hierarchy=function(){var ue=Tr,C=mr,R=wr;function F(q){var ae,he=[q],xe=[];for(q.depth=0;(ae=he.pop())!=null;)if(xe.push(ae),(Le=C.call(F,ae,ae.depth))&&(ke=Le.length)){for(var ke,Le,He;--ke>=0;)he.push(He=Le[ke]),He.parent=ae,He.depth=ae.depth+1;R&&(ae.value=0),ae.children=Le}else R&&(ae.value=+R.call(F,ae,ae.depth)||0),delete ae.children;return or(q,function(Je){var ot,Tt;ue&&(ot=Je.children)&&ot.sort(ue),R&&(Tt=Je.parent)&&(Tt.value+=Je.value)}),xe}return F.sort=function(q){return arguments.length?(ue=q,F):ue},F.children=function(q){return arguments.length?(C=q,F):C},F.value=function(q){return arguments.length?(R=q,F):R},F.revalue=function(q){return R&&(Zt(q,function(ae){ae.children&&(ae.value=0)}),or(q,function(ae){var he;ae.children||(ae.value=+R.call(F,ae,ae.depth)||0),(he=ae.parent)&&(he.value+=ae.value)})),q},F},d.layout.partition=function(){var ue=d.layout.hierarchy(),C=[1,1];function R(F,q){var ae=ue.call(this,F,q);return function he(xe,ke,Le,He){var Je=xe.children;if(xe.x=ke,xe.y=xe.depth*He,xe.dx=Le,xe.dy=He,Je&&(ot=Je.length)){var ot,Tt,Ct,At=-1;for(Le=xe.value?Le/xe.value:0;++At<ot;)he(Tt=Je[At],ke,Ct=Tt.value*Le,He),ke+=Ct}}(ae[0],0,C[0],C[1]/function he(xe){var ke=xe.children,Le=0;if(ke&&(He=ke.length))for(var He,Je=-1;++Je<He;)Le=Math.max(Le,he(ke[Je]));return 1+Le}(ae[0])),ae}return R.size=function(F){return arguments.length?(C=F,R):C},er(R,ue)},d.layout.pie=function(){var ue=Number,C=on,R=0,F=qt,q=0;function ae(he){var xe,ke=he.length,Le=he.map(function(Ft,zt){return+ue.call(ae,Ft,zt)}),He=+(typeof R=="function"?R.apply(this,arguments):R),Je=(typeof F=="function"?F.apply(this,arguments):F)-He,ot=Math.min(Math.abs(Je)/ke,+(typeof q=="function"?q.apply(this,arguments):q)),Tt=ot*(Je<0?-1:1),Ct=d.sum(Le),At=Ct?(Je-ke*Tt)/Ct:0,Et=d.range(ke),_t=[];return C!=null&&Et.sort(C===on?function(Ft,zt){return Le[zt]-Le[Ft]}:function(Ft,zt){return C(he[Ft],he[zt])}),Et.forEach(function(Ft){_t[Ft]={data:he[Ft],value:xe=Le[Ft],startAngle:He,endAngle:He+=xe*At+Tt,padAngle:ot}}),_t}return ae.value=function(he){return arguments.length?(ue=he,ae):ue},ae.sort=function(he){return arguments.length?(C=he,ae):C},ae.startAngle=function(he){return arguments.length?(R=he,ae):R},ae.endAngle=function(he){return arguments.length?(F=he,ae):F},ae.padAngle=function(he){return arguments.length?(q=he,ae):q},ae};var on={};function mn(ue){return ue.x}function In(ue){return ue.y}function zn(ue,C,R){ue.y0=C,ue.y=R}d.layout.stack=function(){var ue=E,C=vi,R=Si,F=zn,q=mn,ae=In;function he(xe,ke){if(!(ot=xe.length))return xe;var Le=xe.map(function(Ft,zt){return ue.call(he,Ft,zt)}),He=Le.map(function(Ft){return Ft.map(function(zt,Vt){return[q.call(he,zt,Vt),ae.call(he,zt,Vt)]})}),Je=C.call(he,He,ke);Le=d.permute(Le,Je),He=d.permute(He,Je);var ot,Tt,Ct,At,Et=R.call(he,He,ke),_t=Le[0].length;for(Ct=0;Ct<_t;++Ct)for(F.call(he,Le[0][Ct],At=Et[Ct],He[0][Ct][1]),Tt=1;Tt<ot;++Tt)F.call(he,Le[Tt][Ct],At+=He[Tt-1][Ct][1],He[Tt][Ct][1]);return xe}return he.values=function(xe){return arguments.length?(ue=xe,he):ue},he.order=function(xe){return arguments.length?(C=typeof xe=="function"?xe:qn.get(xe)||vi,he):C},he.offset=function(xe){return arguments.length?(R=typeof xe=="function"?xe:Rn.get(xe)||Si,he):R},he.x=function(xe){return arguments.length?(q=xe,he):q},he.y=function(xe){return arguments.length?(ae=xe,he):ae},he.out=function(xe){return arguments.length?(F=xe,he):F},he};var qn=d.map({"inside-out":function(ue){var C,R,F=ue.length,q=ue.map(Ui),ae=ue.map(ji),he=d.range(F).sort(function(Je,ot){return q[Je]-q[ot]}),xe=0,ke=0,Le=[],He=[];for(C=0;C<F;++C)R=he[C],xe<ke?(xe+=ae[R],Le.push(R)):(ke+=ae[R],He.push(R));return He.reverse().concat(Le)},reverse:function(ue){return d.range(ue.length).reverse()},default:vi}),Rn=d.map({silhouette:function(ue){var C,R,F,q=ue.length,ae=ue[0].length,he=[],xe=0,ke=[];for(R=0;R<ae;++R){for(C=0,F=0;C<q;C++)F+=ue[C][R][1];F>xe&&(xe=F),he.push(F)}for(R=0;R<ae;++R)ke[R]=(xe-he[R])/2;return ke},wiggle:function(ue){var C,R,F,q,ae,he,xe,ke,Le,He=ue.length,Je=ue[0],ot=Je.length,Tt=[];for(Tt[0]=ke=Le=0,R=1;R<ot;++R){for(C=0,q=0;C<He;++C)q+=ue[C][R][1];for(C=0,ae=0,xe=Je[R][0]-Je[R-1][0];C<He;++C){for(F=0,he=(ue[C][R][1]-ue[C][R-1][1])/(2*xe);F<C;++F)he+=(ue[F][R][1]-ue[F][R-1][1])/xe;ae+=he*ue[C][R][1]}Tt[R]=ke-=q?ae/q*xe:0,ke<Le&&(Le=ke)}for(R=0;R<ot;++R)Tt[R]-=Le;return Tt},expand:function(ue){var C,R,F,q=ue.length,ae=ue[0].length,he=1/q,xe=[];for(R=0;R<ae;++R){for(C=0,F=0;C<q;C++)F+=ue[C][R][1];if(F)for(C=0;C<q;C++)ue[C][R][1]/=F;else for(C=0;C<q;C++)ue[C][R][1]=he}for(R=0;R<ae;++R)xe[R]=0;return xe},zero:Si});function vi(ue){return d.range(ue.length)}function Si(ue){for(var C=-1,R=ue[0].length,F=[];++C<R;)F[C]=0;return F}function Ui(ue){for(var C,R=1,F=0,q=ue[0][1],ae=ue.length;R<ae;++R)(C=ue[R][1])>q&&(F=R,q=C);return F}function ji(ue){return ue.reduce(Vi,0)}function Vi(ue,C){return ue+C[1]}function Aa(ue,C){return Ta(ue,Math.ceil(Math.log(C.length)/Math.LN2+1))}function Ta(ue,C){for(var R=-1,F=+ue[0],q=(ue[1]-F)/C,ae=[];++R<=C;)ae[R]=q*R+F;return ae}function ca(ue){return[d.min(ue),d.max(ue)]}function ua(ue,C){return ue.value-C.value}function ka(ue,C){var R=ue._pack_next;ue._pack_next=C,C._pack_prev=ue,C._pack_next=R,R._pack_prev=C}function Ha(ue,C){ue._pack_next=C,C._pack_prev=ue}function no(ue,C){var R=C.x-ue.x,F=C.y-ue.y,q=ue.r+C.r;return .999*q*q>R*R+F*F}function io(ue){if((C=ue.children)&&(ke=C.length)){var C,R,F,q,ae,he,xe,ke,Le=1/0,He=-1/0,Je=1/0,ot=-1/0;if(C.forEach(ao),(R=C[0]).x=-R.r,R.y=0,zt(R),ke>1&&((F=C[1]).x=F.r,F.y=0,zt(F),ke>2))for(zi(R,F,q=C[2]),zt(q),ka(R,q),R._pack_prev=q,ka(q,F),F=R._pack_next,ae=3;ae<ke;ae++){zi(R,F,q=C[ae]);var Tt=0,Ct=1,At=1;for(he=F._pack_next;he!==F;he=he._pack_next,Ct++)if(no(he,q)){Tt=1;break}if(Tt==1)for(xe=R._pack_prev;xe!==he._pack_prev&&!no(xe,q);xe=xe._pack_prev,At++);Tt?(Ct<At||Ct==At&&F.r<R.r?Ha(R,F=he):Ha(R=xe,F),ae--):(ka(R,q),F=q,zt(q))}var Et=(Le+He)/2,_t=(Je+ot)/2,Ft=0;for(ae=0;ae<ke;ae++)(q=C[ae]).x-=Et,q.y-=_t,Ft=Math.max(Ft,q.r+Math.sqrt(q.x*q.x+q.y*q.y));ue.r=Ft,C.forEach(oo)}function zt(Vt){Le=Math.min(Vt.x-Vt.r,Le),He=Math.max(Vt.x+Vt.r,He),Je=Math.min(Vt.y-Vt.r,Je),ot=Math.max(Vt.y+Vt.r,ot)}}function ao(ue){ue._pack_next=ue._pack_prev=ue}function oo(ue){delete ue._pack_next,delete ue._pack_prev}function zi(ue,C,R){var F=ue.r+R.r,q=C.x-ue.x,ae=C.y-ue.y;if(F&&(q||ae)){var he=C.r+R.r,xe=q*q+ae*ae,ke=.5+((F*=F)-(he*=he))/(2*xe),Le=Math.sqrt(Math.max(0,2*he*(F+xe)-(F-=xe)*F-he*he))/(2*xe);R.x=ue.x+ke*q+Le*ae,R.y=ue.y+ke*ae-Le*q}else R.x=ue.x+F,R.y=ue.y}function dt(ue,C){return ue.parent==C.parent?1:2}function Rt(ue){var C=ue.children;return C.length?C[0]:ue.t}function cr(ue){var C,R=ue.children;return(C=R.length)?R[C-1]:ue.t}function Gt(ue,C,R){var F=R/(C.i-ue.i);C.c-=F,C.s+=R,ue.c+=F,C.z+=R,C.m+=R}function ur(ue,C,R){return ue.a.parent===C.parent?ue.a:R}function Or(ue){return{x:ue.x,y:ue.y,dx:ue.dx,dy:ue.dy}}function Ur(ue,C){var R=ue.x+C[3],F=ue.y+C[0],q=ue.dx-C[1]-C[3],ae=ue.dy-C[0]-C[2];return q<0&&(R+=q/2,q=0),ae<0&&(F+=ae/2,ae=0),{x:R,y:F,dx:q,dy:ae}}function Xr(ue){var C=ue[0],R=ue[ue.length-1];return C<R?[C,R]:[R,C]}function cn(ue){return ue.rangeExtent?ue.rangeExtent():Xr(ue.range())}function sn(ue,C,R,F){var q=R(ue[0],ue[1]),ae=F(C[0],C[1]);return function(he){return ae(q(he))}}function gn(ue,C){var R,F=0,q=ue.length-1,ae=ue[F],he=ue[q];return he<ae&&(R=F,F=q,q=R,R=ae,ae=he,he=R),ue[F]=C.floor(ae),ue[q]=C.ceil(he),ue}function Mn(ue){return ue?{floor:function(C){return Math.floor(C/ue)*ue},ceil:function(C){return Math.ceil(C/ue)*ue}}:un}d.layout.histogram=function(){var ue=!0,C=Number,R=ca,F=Aa;function q(ae,he){for(var xe,ke,Le=[],He=ae.map(C,this),Je=R.call(this,He,he),ot=F.call(this,Je,He,he),Tt=(he=-1,He.length),Ct=ot.length-1,At=ue?1:1/Tt;++he<Ct;)(xe=Le[he]=[]).dx=ot[he+1]-(xe.x=ot[he]),xe.y=0;if(Ct>0)for(he=-1;++he<Tt;)(ke=He[he])>=Je[0]&&ke<=Je[1]&&((xe=Le[d.bisect(ot,ke,1,Ct)-1]).y+=At,xe.push(ae[he]));return Le}return q.value=function(ae){return arguments.length?(C=ae,q):C},q.range=function(ae){return arguments.length?(R=yr(ae),q):R},q.bins=function(ae){return arguments.length?(F=typeof ae=="number"?function(he){return Ta(he,ae)}:yr(ae),q):F},q.frequency=function(ae){return arguments.length?(ue=!!ae,q):ue},q},d.layout.pack=function(){var ue,C=d.layout.hierarchy().sort(ua),R=0,F=[1,1];function q(ae,he){var xe=C.call(this,ae,he),ke=xe[0],Le=F[0],He=F[1],Je=ue==null?Math.sqrt:typeof ue=="function"?ue:function(){return ue};if(ke.x=ke.y=0,or(ke,function(Tt){Tt.r=+Je(Tt.value)}),or(ke,io),R){var ot=R*(ue?1:Math.max(2*ke.r/Le,2*ke.r/He))/2;or(ke,function(Tt){Tt.r+=ot}),or(ke,io),or(ke,function(Tt){Tt.r-=ot})}return function Tt(Ct,At,Et,_t){var Ft=Ct.children;if(Ct.x=At+=_t*Ct.x,Ct.y=Et+=_t*Ct.y,Ct.r*=_t,Ft)for(var zt=-1,Vt=Ft.length;++zt<Vt;)Tt(Ft[zt],At,Et,_t)}(ke,Le/2,He/2,ue?1:1/Math.max(2*ke.r/Le,2*ke.r/He)),xe}return q.size=function(ae){return arguments.length?(F=ae,q):F},q.radius=function(ae){return arguments.length?(ue=ae==null||typeof ae=="function"?ae:+ae,q):ue},q.padding=function(ae){return arguments.length?(R=+ae,q):R},er(q,C)},d.layout.tree=function(){var ue=d.layout.hierarchy().sort(null).value(null),C=dt,R=[1,1],F=null;function q(ke,Le){var He=ue.call(this,ke,Le),Je=He[0],ot=function(zt){for(var Vt,ir={A:null,children:[zt]},gr=[ir];(Vt=gr.pop())!=null;)for(var Lr,Ar=Vt.children,$r=0,Jr=Ar.length;$r<Jr;++$r)gr.push((Ar[$r]=Lr={_:Ar[$r],parent:Vt,children:(Lr=Ar[$r].children)&&Lr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:$r}).a=Lr);return ir.children[0]}(Je);if(or(ot,ae),ot.parent.m=-ot.z,Zt(ot,he),F)Zt(Je,xe);else{var Tt=Je,Ct=Je,At=Je;Zt(Je,function(zt){zt.x<Tt.x&&(Tt=zt),zt.x>Ct.x&&(Ct=zt),zt.depth>At.depth&&(At=zt)});var Et=C(Tt,Ct)/2-Tt.x,_t=R[0]/(Ct.x+C(Ct,Tt)/2+Et),Ft=R[1]/(At.depth||1);Zt(Je,function(zt){zt.x=(zt.x+Et)*_t,zt.y=zt.depth*Ft})}return He}function ae(ke){var Le=ke.children,He=ke.parent.children,Je=ke.i?He[ke.i-1]:null;if(Le.length){(function(Tt){for(var Ct,At=0,Et=0,_t=Tt.children,Ft=_t.length;--Ft>=0;)(Ct=_t[Ft]).z+=At,Ct.m+=At,At+=Ct.s+(Et+=Ct.c)})(ke);var ot=(Le[0].z+Le[Le.length-1].z)/2;Je?(ke.z=Je.z+C(ke._,Je._),ke.m=ke.z-ot):ke.z=ot}else Je&&(ke.z=Je.z+C(ke._,Je._));ke.parent.A=function(Tt,Ct,At){if(Ct){for(var Et,_t=Tt,Ft=Tt,zt=Ct,Vt=_t.parent.children[0],ir=_t.m,gr=Ft.m,Lr=zt.m,Ar=Vt.m;zt=cr(zt),_t=Rt(_t),zt&&_t;)Vt=Rt(Vt),(Ft=cr(Ft)).a=Tt,(Et=zt.z+Lr-_t.z-ir+C(zt._,_t._))>0&&(Gt(ur(zt,Tt,At),Tt,Et),ir+=Et,gr+=Et),Lr+=zt.m,ir+=_t.m,Ar+=Vt.m,gr+=Ft.m;zt&&!cr(Ft)&&(Ft.t=zt,Ft.m+=Lr-gr),_t&&!Rt(Vt)&&(Vt.t=_t,Vt.m+=ir-Ar,At=Tt)}return At}(ke,Je,ke.parent.A||He[0])}function he(ke){ke._.x=ke.z+ke.parent.m,ke.m+=ke.parent.m}function xe(ke){ke.x*=R[0],ke.y=ke.depth*R[1]}return q.separation=function(ke){return arguments.length?(C=ke,q):C},q.size=function(ke){return arguments.length?(F=(R=ke)==null?xe:null,q):F?null:R},q.nodeSize=function(ke){return arguments.length?(F=(R=ke)==null?null:xe,q):F?R:null},er(q,ue)},d.layout.cluster=function(){var ue=d.layout.hierarchy().sort(null).value(null),C=dt,R=[1,1],F=!1;function q(ae,he){var xe,ke=ue.call(this,ae,he),Le=ke[0],He=0;or(Le,function(At){var Et=At.children;Et&&Et.length?(At.x=function(_t){return _t.reduce(function(Ft,zt){return Ft+zt.x},0)/_t.length}(Et),At.y=function(_t){return 1+d.max(_t,function(Ft){return Ft.y})}(Et)):(At.x=xe?He+=C(At,xe):0,At.y=0,xe=At)});var Je=function At(Et){var _t=Et.children;return _t&&_t.length?At(_t[0]):Et}(Le),ot=function At(Et){var _t,Ft=Et.children;return Ft&&(_t=Ft.length)?At(Ft[_t-1]):Et}(Le),Tt=Je.x-C(Je,ot)/2,Ct=ot.x+C(ot,Je)/2;return or(Le,F?function(At){At.x=(At.x-Le.x)*R[0],At.y=(Le.y-At.y)*R[1]}:function(At){At.x=(At.x-Tt)/(Ct-Tt)*R[0],At.y=(1-(Le.y?At.y/Le.y:1))*R[1]}),ke}return q.separation=function(ae){return arguments.length?(C=ae,q):C},q.size=function(ae){return arguments.length?(F=(R=ae)==null,q):F?null:R},q.nodeSize=function(ae){return arguments.length?(F=(R=ae)!=null,q):F?R:null},er(q,ue)},d.layout.treemap=function(){var ue,C=d.layout.hierarchy(),R=Math.round,F=[1,1],q=null,ae=Or,he=!1,xe="squarify",ke=.5*(1+Math.sqrt(5));function Le(At,Et){for(var _t,Ft,zt=-1,Vt=At.length;++zt<Vt;)Ft=(_t=At[zt]).value*(Et<0?0:Et),_t.area=isNaN(Ft)||Ft<=0?0:Ft}function He(At){var Et=At.children;if(Et&&Et.length){var _t,Ft,zt,Vt=ae(At),ir=[],gr=Et.slice(),Lr=1/0,Ar=xe==="slice"?Vt.dx:xe==="dice"?Vt.dy:xe==="slice-dice"?1&At.depth?Vt.dy:Vt.dx:Math.min(Vt.dx,Vt.dy);for(Le(gr,Vt.dx*Vt.dy/At.value),ir.area=0;(zt=gr.length)>0;)ir.push(_t=gr[zt-1]),ir.area+=_t.area,xe!=="squarify"||(Ft=ot(ir,Ar))<=Lr?(gr.pop(),Lr=Ft):(ir.area-=ir.pop().area,Tt(ir,Ar,Vt,!1),Ar=Math.min(Vt.dx,Vt.dy),ir.length=ir.area=0,Lr=1/0);ir.length&&(Tt(ir,Ar,Vt,!0),ir.length=ir.area=0),Et.forEach(He)}}function Je(At){var Et=At.children;if(Et&&Et.length){var _t,Ft=ae(At),zt=Et.slice(),Vt=[];for(Le(zt,Ft.dx*Ft.dy/At.value),Vt.area=0;_t=zt.pop();)Vt.push(_t),Vt.area+=_t.area,_t.z!=null&&(Tt(Vt,_t.z?Ft.dx:Ft.dy,Ft,!zt.length),Vt.length=Vt.area=0);Et.forEach(Je)}}function ot(At,Et){for(var _t,Ft=At.area,zt=0,Vt=1/0,ir=-1,gr=At.length;++ir<gr;)(_t=At[ir].area)&&(_t<Vt&&(Vt=_t),_t>zt&&(zt=_t));return Et*=Et,(Ft*=Ft)?Math.max(Et*zt*ke/Ft,Ft/(Et*Vt*ke)):1/0}function Tt(At,Et,_t,Ft){var zt,Vt=-1,ir=At.length,gr=_t.x,Lr=_t.y,Ar=Et?R(At.area/Et):0;if(Et==_t.dx){for((Ft||Ar>_t.dy)&&(Ar=_t.dy);++Vt<ir;)(zt=At[Vt]).x=gr,zt.y=Lr,zt.dy=Ar,gr+=zt.dx=Math.min(_t.x+_t.dx-gr,Ar?R(zt.area/Ar):0);zt.z=!0,zt.dx+=_t.x+_t.dx-gr,_t.y+=Ar,_t.dy-=Ar}else{for((Ft||Ar>_t.dx)&&(Ar=_t.dx);++Vt<ir;)(zt=At[Vt]).x=gr,zt.y=Lr,zt.dx=Ar,Lr+=zt.dy=Math.min(_t.y+_t.dy-Lr,Ar?R(zt.area/Ar):0);zt.z=!1,zt.dy+=_t.y+_t.dy-Lr,_t.x+=Ar,_t.dx-=Ar}}function Ct(At){var Et=ue||C(At),_t=Et[0];return _t.x=_t.y=0,_t.value?(_t.dx=F[0],_t.dy=F[1]):_t.dx=_t.dy=0,ue&&C.revalue(_t),Le([_t],_t.dx*_t.dy/_t.value),(ue?Je:He)(_t),he&&(ue=Et),Et}return Ct.size=function(At){return arguments.length?(F=At,Ct):F},Ct.padding=function(At){if(!arguments.length)return q;function Et(zt){var Vt=At.call(Ct,zt,zt.depth);return Vt==null?Or(zt):Ur(zt,typeof Vt=="number"?[Vt,Vt,Vt,Vt]:Vt)}function _t(zt){return Ur(zt,At)}var Ft;return ae=(q=At)==null?Or:(Ft=typeof At)=="function"?Et:(Ft==="number"&&(At=[At,At,At,At]),_t),Ct},Ct.round=function(At){return arguments.length?(R=At?Math.round:Number,Ct):R!=Number},Ct.sticky=function(At){return arguments.length?(he=At,ue=null,Ct):he},Ct.ratio=function(At){return arguments.length?(ke=At,Ct):ke},Ct.mode=function(At){return arguments.length?(xe=At+"",Ct):xe},er(Ct,C)},d.random={normal:function(ue,C){var R=arguments.length;return R<2&&(C=1),R<1&&(ue=0),function(){var F,q,ae;do ae=(F=2*Math.random()-1)*F+(q=2*Math.random()-1)*q;while(!ae||ae>1);return ue+C*F*Math.sqrt(-2*Math.log(ae)/ae)}},logNormal:function(){var ue=d.random.normal.apply(d,arguments);return function(){return Math.exp(ue())}},bates:function(ue){var C=d.random.irwinHall(ue);return function(){return C()/ue}},irwinHall:function(ue){return function(){for(var C=0,R=0;R<ue;R++)C+=Math.random();return C}}},d.scale={};var un={floor:E,ceil:E};function An(ue,C,R,F){var q=[],ae=[],he=0,xe=Math.min(ue.length,C.length)-1;for(ue[xe]<ue[0]&&(ue=ue.slice().reverse(),C=C.slice().reverse());++he<=xe;)q.push(R(ue[he-1],ue[he])),ae.push(F(C[he-1],C[he]));return function(ke){var Le=d.bisect(ue,ke,1,xe)-1;return ae[Le](q[Le](ke))}}function Bn(ue,C){return d.rebind(ue,C,"range","rangeRound","interpolate","clamp")}function Hn(ue,C){return gn(ue,Mn(si(ue,C)[2])),gn(ue,Mn(si(ue,C)[2])),ue}function si(ue,C){C==null&&(C=10);var R=Xr(ue),F=R[1]-R[0],q=Math.pow(10,Math.floor(Math.log(F/C)/Math.LN10)),ae=C/F*q;return ae<=.15?q*=10:ae<=.35?q*=5:ae<=.75&&(q*=2),R[0]=Math.ceil(R[0]/q)*q,R[1]=Math.floor(R[1]/q)*q+.5*q,R[2]=q,R}function Kr(ue,C){return d.range.apply(d,si(ue,C))}d.scale.linear=function(){return function ue(C,R,F,q){var ae,he;function xe(){var Le=Math.min(C.length,R.length)>2?An:sn,He=q?Ro:Ms;return ae=Le(C,R,He,F),he=Le(R,C,He,Va),ke}function ke(Le){return ae(Le)}return ke.invert=function(Le){return he(Le)},ke.domain=function(Le){return arguments.length?(C=Le.map(Number),xe()):C},ke.range=function(Le){return arguments.length?(R=Le,xe()):R},ke.rangeRound=function(Le){return ke.range(Le).interpolate(Wo)},ke.clamp=function(Le){return arguments.length?(q=Le,xe()):q},ke.interpolate=function(Le){return arguments.length?(F=Le,xe()):F},ke.ticks=function(Le){return Kr(C,Le)},ke.tickFormat=function(Le,He){return d3_scale_linearTickFormat(C,Le,He)},ke.nice=function(Le){return Hn(C,Le),xe()},ke.copy=function(){return ue(C,R,F,q)},xe()}([0,1],[0,1],Va,!1)},d.scale.log=function(){return function ue(C,R,F,q){function ae(ke){return(F?Math.log(ke<0?0:ke):-Math.log(ke>0?0:-ke))/Math.log(R)}function he(ke){return F?Math.pow(R,ke):-Math.pow(R,-ke)}function xe(ke){return C(ae(ke))}return xe.invert=function(ke){return he(C.invert(ke))},xe.domain=function(ke){return arguments.length?(F=ke[0]>=0,C.domain((q=ke.map(Number)).map(ae)),xe):q},xe.base=function(ke){return arguments.length?(R=+ke,C.domain(q.map(ae)),xe):R},xe.nice=function(){var ke=gn(q.map(ae),F?Math:ni);return C.domain(ke),q=ke.map(he),xe},xe.ticks=function(){var ke=Xr(q),Le=[],He=ke[0],Je=ke[1],ot=Math.floor(ae(He)),Tt=Math.ceil(ae(Je)),Ct=R%1?2:R;if(isFinite(Tt-ot)){if(F){for(;ot<Tt;ot++)for(var At=1;At<Ct;At++)Le.push(he(ot)*At);Le.push(he(ot))}else for(Le.push(he(ot));ot++<Tt;)for(At=Ct-1;At>0;At--)Le.push(he(ot)*At);for(ot=0;Le[ot]<He;ot++);for(Tt=Le.length;Le[Tt-1]>Je;Tt--);Le=Le.slice(ot,Tt)}return Le},xe.copy=function(){return ue(C.copy(),R,F,q)},Bn(xe,C)}(d.scale.linear().domain([0,1]),10,!0,[1,10])};var ni={floor:function(ue){return-Math.ceil(-ue)},ceil:function(ue){return-Math.floor(-ue)}};function On(ue){return function(C){return C<0?-Math.pow(-C,ue):Math.pow(C,ue)}}d.scale.pow=function(){return function ue(C,R,F){var q=On(R),ae=On(1/R);function he(xe){return C(q(xe))}return he.invert=function(xe){return ae(C.invert(xe))},he.domain=function(xe){return arguments.length?(C.domain((F=xe.map(Number)).map(q)),he):F},he.ticks=function(xe){return Kr(F,xe)},he.tickFormat=function(xe,ke){return d3_scale_linearTickFormat(F,xe,ke)},he.nice=function(xe){return he.domain(Hn(F,xe))},he.exponent=function(xe){return arguments.length?(q=On(R=xe),ae=On(1/R),C.domain(F.map(q)),he):R},he.copy=function(){return ue(C.copy(),R,F)},Bn(he,C)}(d.scale.linear(),1,[0,1])},d.scale.sqrt=function(){return d.scale.pow().exponent(.5)},d.scale.ordinal=function(){return function ue(C,R){var F,q,ae;function he(ke){return q[((F.get(ke)||(R.t==="range"?F.set(ke,C.push(ke)):NaN))-1)%q.length]}function xe(ke,Le){return d.range(C.length).map(function(He){return ke+Le*He})}return he.domain=function(ke){if(!arguments.length)return C;C=[],F=new _;for(var Le,He=-1,Je=ke.length;++He<Je;)F.has(Le=ke[He])||F.set(Le,C.push(Le));return he[R.t].apply(he,R.a)},he.range=function(ke){return arguments.length?(q=ke,ae=0,R={t:"range",a:arguments},he):q},he.rangePoints=function(ke,Le){arguments.length<2&&(Le=0);var He=ke[0],Je=ke[1],ot=C.length<2?(He=(He+Je)/2,0):(Je-He)/(C.length-1+Le);return q=xe(He+ot*Le/2,ot),ae=0,R={t:"rangePoints",a:arguments},he},he.rangeRoundPoints=function(ke,Le){arguments.length<2&&(Le=0);var He=ke[0],Je=ke[1],ot=C.length<2?(He=Je=Math.round((He+Je)/2),0):(Je-He)/(C.length-1+Le)|0;return q=xe(He+Math.round(ot*Le/2+(Je-He-(C.length-1+Le)*ot)/2),ot),ae=0,R={t:"rangeRoundPoints",a:arguments},he},he.rangeBands=function(ke,Le,He){arguments.length<2&&(Le=0),arguments.length<3&&(He=Le);var Je=ke[1]<ke[0],ot=ke[Je-0],Tt=ke[1-Je],Ct=(Tt-ot)/(C.length-Le+2*He);return q=xe(ot+Ct*He,Ct),Je&&q.reverse(),ae=Ct*(1-Le),R={t:"rangeBands",a:arguments},he},he.rangeRoundBands=function(ke,Le,He){arguments.length<2&&(Le=0),arguments.length<3&&(He=Le);var Je=ke[1]<ke[0],ot=ke[Je-0],Tt=ke[1-Je],Ct=Math.floor((Tt-ot)/(C.length-Le+2*He));return q=xe(ot+Math.round((Tt-ot-(C.length-Le)*Ct)/2),Ct),Je&&q.reverse(),ae=Math.round(Ct*(1-Le)),R={t:"rangeRoundBands",a:arguments},he},he.rangeBand=function(){return ae},he.rangeExtent=function(){return Xr(R.a[0])},he.copy=function(){return ue(C,R)},he.domain(C)}([],{t:"range",a:[[]]})},d.scale.category10=function(){return d.scale.ordinal().range(Un)},d.scale.category20=function(){return d.scale.ordinal().range(ri)},d.scale.category20b=function(){return d.scale.ordinal().range(ki)},d.scale.category20c=function(){return d.scale.ordinal().range(Pi)};var Un=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Kt),ri=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Kt),ki=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Kt),Pi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Kt);function Ln(){return 0}d.scale.quantile=function(){return function ue(C,R){var F;function q(){var he=0,xe=R.length;for(F=[];++he<xe;)F[he-1]=d.quantile(C,he/xe);return ae}function ae(he){if(!isNaN(he=+he))return R[d.bisect(F,he)]}return ae.domain=function(he){return arguments.length?(C=he.map(h).filter(l).sort(s),q()):C},ae.range=function(he){return arguments.length?(R=he,q()):R},ae.quantiles=function(){return F},ae.invertExtent=function(he){return(he=R.indexOf(he))<0?[NaN,NaN]:[he>0?F[he-1]:C[0],he<F.length?F[he]:C[C.length-1]]},ae.copy=function(){return ue(C,R)},q()}([],[])},d.scale.quantize=function(){return function ue(C,R,F){var q,ae;function he(ke){return F[Math.max(0,Math.min(ae,Math.floor(q*(ke-C))))]}function xe(){return q=F.length/(R-C),ae=F.length-1,he}return he.domain=function(ke){return arguments.length?(C=+ke[0],R=+ke[ke.length-1],xe()):[C,R]},he.range=function(ke){return arguments.length?(F=ke,xe()):F},he.invertExtent=function(ke){return[ke=(ke=F.indexOf(ke))<0?NaN:ke/q+C,ke+1/q]},he.copy=function(){return ue(C,R,F)},xe()}(0,1,[0,1])},d.scale.threshold=function(){return function ue(C,R){function F(q){if(q<=q)return R[d.bisect(C,q)]}return F.domain=function(q){return arguments.length?(C=q,F):C},F.range=function(q){return arguments.length?(R=q,F):R},F.invertExtent=function(q){return q=R.indexOf(q),[C[q-1],C[q]]},F.copy=function(){return ue(C,R)},F}([.5],[0,1])},d.scale.identity=function(){return function ue(C){function R(F){return+F}return R.invert=R,R.domain=R.range=function(F){return arguments.length?(C=F.map(R),R):C},R.ticks=function(F){return Kr(C,F)},R.tickFormat=function(F,q){return d3_scale_linearTickFormat(C,F,q)},R.copy=function(){return ue(C)},R}([0,1])},d.svg={},d.svg.arc=function(){var ue=Ci,C=gi,R=Ln,F=Ri,q=Fi,ae=Ei,he=ra;function xe(){var Le=Math.max(0,+ue.apply(this,arguments)),He=Math.max(0,+C.apply(this,arguments)),Je=q.apply(this,arguments)-Wt,ot=ae.apply(this,arguments)-Wt,Tt=Math.abs(ot-Je),Ct=Je>ot?0:1;if(He<Le&&(At=He,He=Le,Le=At),Tt>=Jt)return ke(He,Ct)+(Le?ke(Le,1-Ct):"")+"Z";var At,Et,_t,Ft,zt,Vt,ir,gr,Lr,Ar,$r,Jr,dn=0,ln=0,Vn=[];if((Ft=(+he.apply(this,arguments)||0)/2)&&(_t=F===Ri?Math.sqrt(Le*Le+He*He):+F.apply(this,arguments),Ct||(ln*=-1),He&&(ln=Ne(_t/He*Math.sin(Ft))),Le&&(dn=Ne(_t/Le*Math.sin(Ft)))),He){zt=He*Math.cos(Je+ln),Vt=He*Math.sin(Je+ln),ir=He*Math.cos(ot-ln),gr=He*Math.sin(ot-ln);var Xn=Math.abs(ot-Je-2*ln)<=Nt?0:1;if(ln&&ii(zt,Vt,ir,gr)===Ct^Xn){var hi=(Je+ot)/2;zt=He*Math.cos(hi),Vt=He*Math.sin(hi),ir=gr=null}}else zt=Vt=0;if(Le){Lr=Le*Math.cos(ot-dn),Ar=Le*Math.sin(ot-dn),$r=Le*Math.cos(Je+dn),Jr=Le*Math.sin(Je+dn);var Yr=Math.abs(Je-ot+2*dn)<=Nt?0:1;if(dn&&ii(Lr,Ar,$r,Jr)===1-Ct^Yr){var Sn=(Je+ot)/2;Lr=Le*Math.cos(Sn),Ar=Le*Math.sin(Sn),$r=Jr=null}}else Lr=Ar=0;if(Tt>vt&&(At=Math.min(Math.abs(He-Le)/2,+R.apply(this,arguments)))>.001){Et=Le<He^Ct?0:1;var Kn=At,Yn=At;if(Tt<Nt){var ai=$r==null?[Lr,Ar]:ir==null?[zt,Vt]:Tn([zt,Vt],[$r,Jr],[ir,gr],[Lr,Ar]),di=zt-ai[0],Li=Vt-ai[1],ei=ir-ai[0],_i=gr-ai[1],yi=1/Math.sin(Math.acos((di*ei+Li*_i)/(Math.sqrt(di*di+Li*Li)*Math.sqrt(ei*ei+_i*_i)))/2),Ii=Math.sqrt(ai[0]*ai[0]+ai[1]*ai[1]);Yn=Math.min(At,(Le-Ii)/(yi-1)),Kn=Math.min(At,(He-Ii)/(yi+1))}if(ir!=null){var wi=Ki($r==null?[Lr,Ar]:[$r,Jr],[zt,Vt],He,Kn,Ct),Oi=Ki([ir,gr],[Lr,Ar],He,Kn,Ct);At===Kn?Vn.push("M",wi[0],"A",Kn,",",Kn," 0 0,",Et," ",wi[1],"A",He,",",He," 0 ",1-Ct^ii(wi[1][0],wi[1][1],Oi[1][0],Oi[1][1]),",",Ct," ",Oi[1],"A",Kn,",",Kn," 0 0,",Et," ",Oi[0]):Vn.push("M",wi[0],"A",Kn,",",Kn," 0 1,",Et," ",Oi[0])}else Vn.push("M",zt,",",Vt);if($r!=null){var Hi=Ki([zt,Vt],[$r,Jr],Le,-Yn,Ct),da=Ki([Lr,Ar],ir==null?[zt,Vt]:[ir,gr],Le,-Yn,Ct);At===Yn?Vn.push("L",da[0],"A",Yn,",",Yn," 0 0,",Et," ",da[1],"A",Le,",",Le," 0 ",Ct^ii(da[1][0],da[1][1],Hi[1][0],Hi[1][1]),",",1-Ct," ",Hi[1],"A",Yn,",",Yn," 0 0,",Et," ",Hi[0]):Vn.push("L",da[0],"A",Yn,",",Yn," 0 0,",Et," ",Hi[0])}else Vn.push("L",Lr,",",Ar)}else Vn.push("M",zt,",",Vt),ir!=null&&Vn.push("A",He,",",He," 0 ",Xn,",",Ct," ",ir,",",gr),Vn.push("L",Lr,",",Ar),$r!=null&&Vn.push("A",Le,",",Le," 0 ",Yr,",",1-Ct," ",$r,",",Jr);return Vn.push("Z"),Vn.join("")}function ke(Le,He){return"M0,"+Le+"A"+Le+","+Le+" 0 1,"+He+" 0,"+-Le+"A"+Le+","+Le+" 0 1,"+He+" 0,"+Le}return xe.innerRadius=function(Le){return arguments.length?(ue=yr(Le),xe):ue},xe.outerRadius=function(Le){return arguments.length?(C=yr(Le),xe):C},xe.cornerRadius=function(Le){return arguments.length?(R=yr(Le),xe):R},xe.padRadius=function(Le){return arguments.length?(F=Le==Ri?Ri:yr(Le),xe):F},xe.startAngle=function(Le){return arguments.length?(q=yr(Le),xe):q},xe.endAngle=function(Le){return arguments.length?(ae=yr(Le),xe):ae},xe.padAngle=function(Le){return arguments.length?(he=yr(Le),xe):he},xe.centroid=function(){var Le=(+ue.apply(this,arguments)+ +C.apply(this,arguments))/2,He=(+q.apply(this,arguments)+ +ae.apply(this,arguments))/2-Wt;return[Math.cos(He)*Le,Math.sin(He)*Le]},xe};var Ri="auto";function Ci(ue){return ue.innerRadius}function gi(ue){return ue.outerRadius}function Fi(ue){return ue.startAngle}function Ei(ue){return ue.endAngle}function ra(ue){return ue&&ue.padAngle}function ii(ue,C,R,F){return(ue-R)*C-(C-F)*ue>0?0:1}function Ki(ue,C,R,F,q){var ae=ue[0]-C[0],he=ue[1]-C[1],xe=(q?F:-F)/Math.sqrt(ae*ae+he*he),ke=xe*he,Le=-xe*ae,He=ue[0]+ke,Je=ue[1]+Le,ot=C[0]+ke,Tt=C[1]+Le,Ct=(He+ot)/2,At=(Je+Tt)/2,Et=ot-He,_t=Tt-Je,Ft=Et*Et+_t*_t,zt=R-F,Vt=He*Tt-ot*Je,ir=(_t<0?-1:1)*Math.sqrt(Math.max(0,zt*zt*Ft-Vt*Vt)),gr=(Vt*_t-Et*ir)/Ft,Lr=(-Vt*Et-_t*ir)/Ft,Ar=(Vt*_t+Et*ir)/Ft,$r=(-Vt*Et+_t*ir)/Ft,Jr=gr-Ct,dn=Lr-At,ln=Ar-Ct,Vn=$r-At;return Jr*Jr+dn*dn>ln*ln+Vn*Vn&&(gr=Ar,Lr=$r),[[gr-ke,Lr-Le],[gr*R/zt,Lr*R/zt]]}function qa(){return!0}function es(ue){var C=jr,R=nn,F=qa,q=To,ae=q.key,he=.7;function xe(ke){var Le,He=[],Je=[],ot=-1,Tt=ke.length,Ct=yr(C),At=yr(R);function Et(){He.push("M",q(ue(Je),he))}for(;++ot<Tt;)F.call(this,Le=ke[ot],ot)?Je.push([+Ct.call(this,Le,ot),+At.call(this,Le,ot)]):Je.length&&(Et(),Je=[]);return Je.length&&Et(),He.length?He.join(""):null}return xe.x=function(ke){return arguments.length?(C=ke,xe):C},xe.y=function(ke){return arguments.length?(R=ke,xe):R},xe.defined=function(ke){return arguments.length?(F=ke,xe):F},xe.interpolate=function(ke){return arguments.length?(ae=typeof ke=="function"?q=ke:(q=Uo.get(ke)||To).key,xe):ae},xe.tension=function(ke){return arguments.length?(he=ke,xe):he},xe}d.svg.line=function(){return es(E)};var Uo=d.map({linear:To,"linear-closed":xi,step:function(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("H",(F[0]+(F=ue[C])[0])/2,"V",F[1]);return R>1&&q.push("H",F[0]),q.join("")},"step-before":xa,"step-after":ko,basis:Ka,"basis-open":function(ue){if(ue.length<4)return To(ue);for(var C,R=[],F=-1,q=ue.length,ae=[0],he=[0];++F<3;)C=ue[F],ae.push(C[0]),he.push(C[1]);for(R.push(ia(so,ae)+","+ia(so,he)),--F;++F<q;)C=ue[F],ae.shift(),ae.push(C[0]),he.shift(),he.push(C[1]),vs(R,ae,he);return R.join("")},"basis-closed":function(ue){for(var C,R,F=-1,q=ue.length,ae=q+4,he=[],xe=[];++F<4;)R=ue[F%q],he.push(R[0]),xe.push(R[1]);for(C=[ia(so,he),",",ia(so,xe)],--F;++F<ae;)R=ue[F%q],he.shift(),he.push(R[0]),xe.shift(),xe.push(R[1]),vs(C,he,xe);return C.join("")},bundle:function(ue,C){var R=ue.length-1;if(R)for(var F,q,ae=ue[0][0],he=ue[0][1],xe=ue[R][0]-ae,ke=ue[R][1]-he,Le=-1;++Le<=R;)F=ue[Le],q=Le/R,F[0]=C*F[0]+(1-C)*(ae+q*xe),F[1]=C*F[1]+(1-C)*(he+q*ke);return Ka(ue)},cardinal:function(ue,C){return ue.length<3?To(ue):ue[0]+Ji(ue,Sa(ue,C))},"cardinal-open":function(ue,C){return ue.length<4?To(ue):ue[1]+Ji(ue.slice(1,-1),Sa(ue,C))},"cardinal-closed":function(ue,C){return ue.length<3?xi(ue):ue[0]+Ji((ue.push(ue[0]),ue),Sa([ue[ue.length-2]].concat(ue,[ue[1]]),C))},monotone:function(ue){return ue.length<3?To(ue):ue[0]+Ji(ue,function(C){for(var R,F,q,ae,he=[],xe=function(He){for(var Je=0,ot=He.length-1,Tt=[],Ct=He[0],At=He[1],Et=Tt[0]=cs(Ct,At);++Je<ot;)Tt[Je]=(Et+(Et=cs(Ct=At,At=He[Je+1])))/2;return Tt[Je]=Et,Tt}(C),ke=-1,Le=C.length-1;++ke<Le;)R=cs(C[ke],C[ke+1]),i(R)<vt?xe[ke]=xe[ke+1]=0:(F=xe[ke]/R,q=xe[ke+1]/R,(ae=F*F+q*q)>9&&(ae=3*R/Math.sqrt(ae),xe[ke]=ae*F,xe[ke+1]=ae*q));for(ke=-1;++ke<=Le;)ae=(C[Math.min(Le,ke+1)][0]-C[Math.max(0,ke-1)][0])/(6*(1+xe[ke]*xe[ke])),he.push([ae||0,xe[ke]*ae||0]);return he}(ue))}});function To(ue){return ue.length>1?ue.join("L"):ue+"Z"}function xi(ue){return ue.join("L")+"Z"}function xa(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("V",(F=ue[C])[1],"H",F[0]);return q.join("")}function ko(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("H",(F=ue[C])[0],"V",F[1]);return q.join("")}function Ji(ue,C){if(C.length<1||ue.length!=C.length&&ue.length!=C.length+2)return To(ue);var R=ue.length!=C.length,F="",q=ue[0],ae=ue[1],he=C[0],xe=he,ke=1;if(R&&(F+="Q"+(ae[0]-2*he[0]/3)+","+(ae[1]-2*he[1]/3)+","+ae[0]+","+ae[1],q=ue[1],ke=2),C.length>1){xe=C[1],ae=ue[ke],ke++,F+="C"+(q[0]+he[0])+","+(q[1]+he[1])+","+(ae[0]-xe[0])+","+(ae[1]-xe[1])+","+ae[0]+","+ae[1];for(var Le=2;Le<C.length;Le++,ke++)ae=ue[ke],xe=C[Le],F+="S"+(ae[0]-xe[0])+","+(ae[1]-xe[1])+","+ae[0]+","+ae[1]}if(R){var He=ue[ke];F+="Q"+(ae[0]+2*xe[0]/3)+","+(ae[1]+2*xe[1]/3)+","+He[0]+","+He[1]}return F}function Sa(ue,C){for(var R,F=[],q=(1-C)/2,ae=ue[0],he=ue[1],xe=1,ke=ue.length;++xe<ke;)R=ae,ae=he,he=ue[xe],F.push([q*(he[0]-R[0]),q*(he[1]-R[1])]);return F}function Ka(ue){if(ue.length<3)return To(ue);var C=1,R=ue.length,F=ue[0],q=F[0],ae=F[1],he=[q,q,q,(F=ue[1])[0]],xe=[ae,ae,ae,F[1]],ke=[q,",",ae,"L",ia(so,he),",",ia(so,xe)];for(ue.push(ue[R-1]);++C<=R;)F=ue[C],he.shift(),he.push(F[0]),xe.shift(),xe.push(F[1]),vs(ke,he,xe);return ue.pop(),ke.push("L",F),ke.join("")}function ia(ue,C){return ue[0]*C[0]+ue[1]*C[1]+ue[2]*C[2]+ue[3]*C[3]}Uo.forEach(function(ue,C){C.key=ue,C.closed=/-closed$/.test(ue)});var yo=[0,2/3,1/3,0],aa=[0,1/3,2/3,0],so=[0,1/6,2/3,1/6];function vs(ue,C,R){ue.push("C",ia(yo,C),",",ia(yo,R),",",ia(aa,C),",",ia(aa,R),",",ia(so,C),",",ia(so,R))}function cs(ue,C){return(C[1]-ue[1])/(C[0]-ue[0])}function rl(ue){for(var C,R,F,q=-1,ae=ue.length;++q<ae;)R=(C=ue[q])[0],F=C[1]-Wt,C[0]=R*Math.cos(F),C[1]=R*Math.sin(F);return ue}function Na(ue){var C=jr,R=jr,F=0,q=nn,ae=qa,he=To,xe=he.key,ke=he,Le="L",He=.7;function Je(ot){var Tt,Ct,At,Et=[],_t=[],Ft=[],zt=-1,Vt=ot.length,ir=yr(C),gr=yr(F),Lr=C===R?function(){return Ct}:yr(R),Ar=F===q?function(){return At}:yr(q);function $r(){Et.push("M",he(ue(Ft),He),Le,ke(ue(_t.reverse()),He),"Z")}for(;++zt<Vt;)ae.call(this,Tt=ot[zt],zt)?(_t.push([Ct=+ir.call(this,Tt,zt),At=+gr.call(this,Tt,zt)]),Ft.push([+Lr.call(this,Tt,zt),+Ar.call(this,Tt,zt)])):_t.length&&($r(),_t=[],Ft=[]);return _t.length&&$r(),Et.length?Et.join(""):null}return Je.x=function(ot){return arguments.length?(C=R=ot,Je):R},Je.x0=function(ot){return arguments.length?(C=ot,Je):C},Je.x1=function(ot){return arguments.length?(R=ot,Je):R},Je.y=function(ot){return arguments.length?(F=q=ot,Je):q},Je.y0=function(ot){return arguments.length?(F=ot,Je):F},Je.y1=function(ot){return arguments.length?(q=ot,Je):q},Je.defined=function(ot){return arguments.length?(ae=ot,Je):ae},Je.interpolate=function(ot){return arguments.length?(xe=typeof ot=="function"?he=ot:(he=Uo.get(ot)||To).key,ke=he.reverse||he,Le=he.closed?"M":"L",Je):xe},Je.tension=function(ot){return arguments.length?(He=ot,Je):He},Je}function nl(ue){return ue.source}function ja(ue){return ue.target}function us(ue){return ue.radius}function fi(ue){return[ue.x,ue.y]}function bi(ue){return function(){var C=ue.apply(this,arguments),R=C[0],F=C[1]-Wt;return[R*Math.cos(F),R*Math.sin(F)]}}function il(){return 64}function al(){return"circle"}function fs(ue){var C=Math.sqrt(ue/Nt);return"M0,"+C+"A"+C+","+C+" 0 1,1 0,"+-C+"A"+C+","+C+" 0 1,1 0,"+C+"Z"}d.svg.line.radial=function(){var ue=es(rl);return ue.radius=ue.x,delete ue.x,ue.angle=ue.y,delete ue.y,ue},xa.reverse=ko,ko.reverse=xa,d.svg.area=function(){return Na(E)},d.svg.area.radial=function(){var ue=Na(rl);return ue.radius=ue.x,delete ue.x,ue.innerRadius=ue.x0,delete ue.x0,ue.outerRadius=ue.x1,delete ue.x1,ue.angle=ue.y,delete ue.y,ue.startAngle=ue.y0,delete ue.y0,ue.endAngle=ue.y1,delete ue.y1,ue},d.svg.chord=function(){var ue=nl,C=ja,R=us,F=Fi,q=Ei;function ae(Le,He){var Je,ot,Tt=he(this,ue,Le,He),Ct=he(this,C,Le,He);return"M"+Tt.p0+xe(Tt.r,Tt.p1,Tt.a1-Tt.a0)+(ot=Ct,((Je=Tt).a0==ot.a0&&Je.a1==ot.a1?ke(Tt.r,Tt.p1,Tt.r,Tt.p0):ke(Tt.r,Tt.p1,Ct.r,Ct.p0)+xe(Ct.r,Ct.p1,Ct.a1-Ct.a0)+ke(Ct.r,Ct.p1,Tt.r,Tt.p0))+"Z")}function he(Le,He,Je,ot){var Tt=He.call(Le,Je,ot),Ct=R.call(Le,Tt,ot),At=F.call(Le,Tt,ot)-Wt,Et=q.call(Le,Tt,ot)-Wt;return{r:Ct,a0:At,a1:Et,p0:[Ct*Math.cos(At),Ct*Math.sin(At)],p1:[Ct*Math.cos(Et),Ct*Math.sin(Et)]}}function xe(Le,He,Je){return"A"+Le+","+Le+" 0 "+ +(Je>Nt)+",1 "+He}function ke(Le,He,Je,ot){return"Q 0,0 "+ot}return ae.radius=function(Le){return arguments.length?(R=yr(Le),ae):R},ae.source=function(Le){return arguments.length?(ue=yr(Le),ae):ue},ae.target=function(Le){return arguments.length?(C=yr(Le),ae):C},ae.startAngle=function(Le){return arguments.length?(F=yr(Le),ae):F},ae.endAngle=function(Le){return arguments.length?(q=yr(Le),ae):q},ae},d.svg.diagonal=function(){var ue=nl,C=ja,R=fi;function F(q,ae){var he=ue.call(this,q,ae),xe=C.call(this,q,ae),ke=(he.y+xe.y)/2,Le=[he,{x:he.x,y:ke},{x:xe.x,y:ke},xe];return"M"+(Le=Le.map(R))[0]+"C"+Le[1]+" "+Le[2]+" "+Le[3]}return F.source=function(q){return arguments.length?(ue=yr(q),F):ue},F.target=function(q){return arguments.length?(C=yr(q),F):C},F.projection=function(q){return arguments.length?(R=q,F):R},F},d.svg.diagonal.radial=function(){var ue=d.svg.diagonal(),C=fi,R=ue.projection;return ue.projection=function(F){return arguments.length?R(bi(C=F)):C},ue},d.svg.symbol=function(){var ue=al,C=il;function R(F,q){return(Fo.get(ue.call(this,F,q))||fs)(C.call(this,F,q))}return R.type=function(F){return arguments.length?(ue=yr(F),R):ue},R.size=function(F){return arguments.length?(C=yr(F),R):C},R};var Fo=d.map({circle:fs,cross:function(ue){var C=Math.sqrt(ue/5)/2;return"M"+-3*C+","+-C+"H"+-C+"V"+-3*C+"H"+C+"V"+-C+"H"+3*C+"V"+C+"H"+C+"V"+3*C+"H"+-C+"V"+C+"H"+-3*C+"Z"},diamond:function(ue){var C=Math.sqrt(ue/(2*Sl)),R=C*Sl;return"M0,"+-C+"L"+R+",0 0,"+C+" "+-R+",0Z"},square:function(ue){var C=Math.sqrt(ue)/2;return"M"+-C+","+-C+"L"+C+","+-C+" "+C+","+C+" "+-C+","+C+"Z"},"triangle-down":function(ue){var C=Math.sqrt(ue/Ko),R=C*Ko/2;return"M0,"+R+"L"+C+","+-R+" "+-C+","+-R+"Z"},"triangle-up":function(ue){var C=Math.sqrt(ue/Ko),R=C*Ko/2;return"M0,"+-R+"L"+C+","+R+" "+-C+","+R+"Z"}});d.svg.symbolTypes=Fo.keys();var Ko=Math.sqrt(3),Sl=Math.tan(30*ar);J.transition=function(ue){for(var C,R,F=As||++Ss,q=Vs(ue),ae=[],he=ys||{time:Date.now(),ease:Ps,delay:0,duration:250},xe=-1,ke=this.length;++xe<ke;){ae.push(C=[]);for(var Le=this[xe],He=-1,Je=Le.length;++He<Je;)(R=Le[He])&&xs(R,He,q,F,he),C.push(R)}return oa(ae,q,F)},J.interrupt=function(ue){return this.each(ue==null?js:$i(Vs(ue)))};var js=$i(Vs());function $i(ue){return function(){var C,R,F;(C=this[ue])&&(F=C[R=C.active])&&(F.timer.c=null,F.timer.t=NaN,--C.count?delete C[R]:delete this[ue],C.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function oa(ue,C,R){return N(ue,za),ue.namespace=C,ue.id=R,ue}var As,ys,za=[],Ss=0;function Us(ue,C,R,F){var q=ue.id,ae=ue.namespace;return Oe(ue,typeof R=="function"?function(he,xe,ke){he[ae][q].tween.set(C,F(R.call(he,he.__data__,xe,ke)))}:(R=F(R),function(he){he[ae][q].tween.set(C,R)}))}function Is(ue){return ue==null&&(ue=""),function(){this.textContent=ue}}function Vs(ue){return ue==null?"__transition__":"__transition_"+ue+"__"}function xs(ue,C,R,F,q){var ae,he,xe,ke,Le,He=ue[R]||(ue[R]={active:0,count:0}),Je=He[F];function ot(Ct){var At=He.active,Et=He[At];for(var _t in Et&&(Et.timer.c=null,Et.timer.t=NaN,--He.count,delete He[At],Et.event&&Et.event.interrupt.call(ue,ue.__data__,Et.index)),He)if(+_t<F){var Ft=He[_t];Ft.timer.c=null,Ft.timer.t=NaN,--He.count,delete He[_t]}he.c=Tt,an(function(){return he.c&&Tt(Ct||1)&&(he.c=null,he.t=NaN),1},0,ae),He.active=F,Je.event&&Je.event.start.call(ue,ue.__data__,C),Le=[],Je.tween.forEach(function(zt,Vt){(Vt=Vt.call(ue,ue.__data__,C))&&Le.push(Vt)}),ke=Je.ease,xe=Je.duration}function Tt(Ct){for(var At=Ct/xe,Et=ke(At),_t=Le.length;_t>0;)Le[--_t].call(ue,Et);if(At>=1)return Je.event&&Je.event.end.call(ue,ue.__data__,C),--He.count?delete He[F]:delete ue[R],1}Je||(ae=q.time,he=an(function(Ct){var At=Je.delay;if(he.t=At+ae,At<=Ct)return ot(Ct-At);he.c=ot},0,ae),Je=He[F]={tween:new _,time:ae,timer:he,delay:q.delay,duration:q.duration,ease:q.ease,index:C},q=null,++He.count)}za.call=J.call,za.empty=J.empty,za.node=J.node,za.size=J.size,d.transition=function(ue,C){return ue&&ue.transition?As?ue.transition(C):ue:d.selection().transition(ue)},d.transition.prototype=za,za.select=function(ue){var C,R,F,q=this.id,ae=this.namespace,he=[];ue=ee(ue);for(var xe=-1,ke=this.length;++xe<ke;){he.push(C=[]);for(var Le=this[xe],He=-1,Je=Le.length;++He<Je;)(F=Le[He])&&(R=ue.call(F,F.__data__,He,xe))?("__data__"in F&&(R.__data__=F.__data__),xs(R,He,ae,q,F[ae][q]),C.push(R)):C.push(null)}return oa(he,ae,q)},za.selectAll=function(ue){var C,R,F,q,ae,he=this.id,xe=this.namespace,ke=[];ue=re(ue);for(var Le=-1,He=this.length;++Le<He;)for(var Je=this[Le],ot=-1,Tt=Je.length;++ot<Tt;)if(F=Je[ot]){ae=F[xe][he],R=ue.call(F,F.__data__,ot,Le),ke.push(C=[]);for(var Ct=-1,At=R.length;++Ct<At;)(q=R[Ct])&&xs(q,Ct,xe,he,ae),C.push(q)}return oa(ke,xe,he)},za.filter=function(ue){var C,R,F=[];typeof ue!="function"&&(ue=Me(ue));for(var q=0,ae=this.length;q<ae;q++){F.push(C=[]);for(var he,xe=0,ke=(he=this[q]).length;xe<ke;xe++)(R=he[xe])&&ue.call(R,R.__data__,xe,q)&&C.push(R)}return oa(F,this.namespace,this.id)},za.tween=function(ue,C){var R=this.id,F=this.namespace;return arguments.length<2?this.node()[F][R].tween.get(ue):Oe(this,C==null?function(q){q[F][R].tween.remove(ue)}:function(q){q[F][R].tween.set(ue,C)})},za.attr=function(ue,C){if(arguments.length<2){for(C in ue)this.attr(C,ue[C]);return this}var R=ue=="transform"?Xo:Va,F=d.ns.qualify(ue);function q(){this.removeAttribute(F)}function ae(){this.removeAttributeNS(F.space,F.local)}function he(ke){return ke==null?q:(ke+="",function(){var Le,He=this.getAttribute(F);return He!==ke&&(Le=R(He,ke),function(Je){this.setAttribute(F,Le(Je))})})}function xe(ke){return ke==null?ae:(ke+="",function(){var Le,He=this.getAttributeNS(F.space,F.local);return He!==ke&&(Le=R(He,ke),function(Je){this.setAttributeNS(F.space,F.local,Le(Je))})})}return Us(this,"attr."+ue,C,F.local?xe:he)},za.attrTween=function(ue,C){var R=d.ns.qualify(ue);return this.tween("attr."+ue,R.local?function(F,q){var ae=C.call(this,F,q,this.getAttributeNS(R.space,R.local));return ae&&function(he){this.setAttributeNS(R.space,R.local,ae(he))}}:function(F,q){var ae=C.call(this,F,q,this.getAttribute(R));return ae&&function(he){this.setAttribute(R,ae(he))}})},za.style=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=""),ue)this.style(R,ue[R],C);return this}R=""}function q(){this.style.removeProperty(ue)}function ae(he){return he==null?q:(he+="",function(){var xe,ke=t(this).getComputedStyle(this,null).getPropertyValue(ue);return ke!==he&&(xe=Va(ke,he),function(Le){this.style.setProperty(ue,xe(Le),R)})})}return Us(this,"style."+ue,C,ae)},za.styleTween=function(ue,C,R){function F(q,ae){var he=C.call(this,q,ae,t(this).getComputedStyle(this,null).getPropertyValue(ue));return he&&function(xe){this.style.setProperty(ue,he(xe),R)}}return arguments.length<3&&(R=""),this.tween("style."+ue,F)},za.text=function(ue){return Us(this,"text",ue,Is)},za.remove=function(){var ue=this.namespace;return this.each("end.transition",function(){var C;this[ue].count<2&&(C=this.parentNode)&&C.removeChild(this)})},za.ease=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].ease:(typeof ue!="function"&&(ue=d.ease.apply(d,arguments)),Oe(this,function(F){F[R][C].ease=ue}))},za.delay=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].delay:Oe(this,typeof ue=="function"?function(F,q,ae){F[R][C].delay=+ue.call(F,F.__data__,q,ae)}:(ue=+ue,function(F){F[R][C].delay=ue}))},za.duration=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].duration:Oe(this,typeof ue=="function"?function(F,q,ae){F[R][C].duration=Math.max(1,ue.call(F,F.__data__,q,ae))}:(ue=Math.max(1,ue),function(F){F[R][C].duration=ue}))},za.each=function(ue,C){var R=this.id,F=this.namespace;if(arguments.length<2){var q=ys,ae=As;try{As=R,Oe(this,function(he,xe,ke){ys=he[F][R],ue.call(he,he.__data__,xe,ke)})}finally{ys=q,As=ae}}else Oe(this,function(he){var xe=he[F][R];(xe.event||(xe.event=d.dispatch("start","end","interrupt"))).on(ue,C)});return this},za.transition=function(){for(var ue,C,R,F=this.id,q=++Ss,ae=this.namespace,he=[],xe=0,ke=this.length;xe<ke;xe++){he.push(ue=[]);for(var Le,He=0,Je=(Le=this[xe]).length;He<Je;He++)(C=Le[He])&&xs(C,He,ae,q,{time:(R=C[ae][F]).time,ease:R.ease,delay:R.delay+R.duration,duration:R.duration}),ue.push(C)}return oa(he,ae,q)},d.svg.axis=function(){var ue,C=d.scale.linear(),R=El,F=6,q=6,ae=3,he=[10],xe=null;function ke(Le){Le.each(function(){var He,Je=d.select(this),ot=this.__chart__||C,Tt=this.__chart__=C.copy(),Ct=xe==null?Tt.ticks?Tt.ticks.apply(Tt,he):Tt.domain():xe,At=ue==null?Tt.tickFormat?Tt.tickFormat.apply(Tt,he):E:ue,Et=Je.selectAll(".tick").data(Ct,Tt),_t=Et.enter().insert("g",".domain").attr("class","tick").style("opacity",vt),Ft=d.transition(Et.exit()).style("opacity",vt).remove(),zt=d.transition(Et.order()).style("opacity",1),Vt=Math.max(F,0)+ae,ir=cn(Tt),gr=Je.selectAll(".domain").data([0]),Lr=(gr.enter().append("path").attr("class","domain"),d.transition(gr));_t.append("line"),_t.append("text");var Ar,$r,Jr,dn,ln=_t.select("line"),Vn=zt.select("line"),Xn=Et.select("text").text(At),hi=_t.select("text"),Yr=zt.select("text"),Sn=R==="top"||R==="left"?-1:1;if(R==="bottom"||R==="top"?(He=Es,Ar="x",Jr="y",$r="x2",dn="y2",Xn.attr("dy",Sn<0?"0em":".71em").style("text-anchor","middle"),Lr.attr("d","M"+ir[0]+","+Sn*q+"V0H"+ir[1]+"V"+Sn*q)):(He=Ll,Ar="y",Jr="x",$r="y2",dn="x2",Xn.attr("dy",".32em").style("text-anchor",Sn<0?"end":"start"),Lr.attr("d","M"+Sn*q+","+ir[0]+"H0V"+ir[1]+"H"+Sn*q)),ln.attr(dn,Sn*F),hi.attr(Jr,Sn*Vt),Vn.attr($r,0).attr(dn,Sn*F),Yr.attr(Ar,0).attr(Jr,Sn*Vt),Tt.rangeBand){var Kn=Tt,Yn=Kn.rangeBand()/2;ot=Tt=function(ai){return Kn(ai)+Yn}}else ot.rangeBand?ot=Tt:Ft.call(He,Tt,ot);_t.call(He,ot,Tt),zt.call(He,Tt,Tt)})}return ke.scale=function(Le){return arguments.length?(C=Le,ke):C},ke.orient=function(Le){return arguments.length?(R=Le in Hl?Le+"":El,ke):R},ke.ticks=function(){return arguments.length?(he=w(arguments),ke):he},ke.tickValues=function(Le){return arguments.length?(xe=Le,ke):xe},ke.tickFormat=function(Le){return arguments.length?(ue=Le,ke):ue},ke.tickSize=function(Le){var He=arguments.length;return He?(F=+Le,q=+arguments[He-1],ke):F},ke.innerTickSize=function(Le){return arguments.length?(F=+Le,ke):F},ke.outerTickSize=function(Le){return arguments.length?(q=+Le,ke):q},ke.tickPadding=function(Le){return arguments.length?(ae=+Le,ke):ae},ke.tickSubdivide=function(){return arguments.length&&ke},ke};var El="bottom",Hl={top:1,right:1,bottom:1,left:1};function Es(ue,C,R){ue.attr("transform",function(F){var q=C(F);return"translate("+(isFinite(q)?q:R(F))+",0)"})}function Ll(ue,C,R){ue.attr("transform",function(F){var q=C(F);return"translate(0,"+(isFinite(q)?q:R(F))+")"})}d.svg.brush=function(){var ue,C,R=ne(He,"brushstart","brush","brushend"),F=null,q=null,ae=[0,0],he=[0,0],xe=!0,ke=!0,Le=lo[0];function He(At){At.each(function(){var Et=d.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Ct).on("touchstart.brush",Ct),_t=Et.selectAll(".background").data([0]);_t.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Et.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Ft=Et.selectAll(".resize").data(Le,E);Ft.exit().remove(),Ft.enter().append("g").attr("class",function(gr){return"resize "+gr}).style("cursor",function(gr){return Hs[gr]}).append("rect").attr("x",function(gr){return/[ew]$/.test(gr)?-3:null}).attr("y",function(gr){return/^[ns]/.test(gr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Ft.style("display",He.empty()?"none":null);var zt,Vt=d.transition(Et),ir=d.transition(_t);F&&(zt=cn(F),ir.attr("x",zt[0]).attr("width",zt[1]-zt[0]),ot(Vt)),q&&(zt=cn(q),ir.attr("y",zt[0]).attr("height",zt[1]-zt[0]),Tt(Vt)),Je(Vt)})}function Je(At){At.selectAll(".resize").attr("transform",function(Et){return"translate("+ae[+/e$/.test(Et)]+","+he[+/^s/.test(Et)]+")"})}function ot(At){At.select(".extent").attr("x",ae[0]),At.selectAll(".extent,.n>rect,.s>rect").attr("width",ae[1]-ae[0])}function Tt(At){At.select(".extent").attr("y",he[0]),At.selectAll(".extent,.e>rect,.w>rect").attr("height",he[1]-he[0])}function Ct(){var At,Et,_t=this,Ft=d.select(d.event.target),zt=R.of(_t,arguments),Vt=d.select(_t),ir=Ft.datum(),gr=!/^(n|s)$/.test(ir)&&F,Lr=!/^(e|w)$/.test(ir)&&q,Ar=Ft.classed("extent"),$r=wt(_t),Jr=d.mouse(_t),dn=d.select(t(_t)).on("keydown.brush",Xn).on("keyup.brush",hi);if(d.event.changedTouches?dn.on("touchmove.brush",Yr).on("touchend.brush",Kn):dn.on("mousemove.brush",Yr).on("mouseup.brush",Kn),Vt.interrupt().selectAll("*").interrupt(),Ar)Jr[0]=ae[0]-Jr[0],Jr[1]=he[0]-Jr[1];else if(ir){var ln=+/w$/.test(ir),Vn=+/^n/.test(ir);Et=[ae[1-ln]-Jr[0],he[1-Vn]-Jr[1]],Jr[0]=ae[ln],Jr[1]=he[Vn]}else d.event.altKey&&(At=Jr.slice());function Xn(){d.event.keyCode==32&&(Ar||(At=null,Jr[0]-=ae[1],Jr[1]-=he[1],Ar=2),K())}function hi(){d.event.keyCode==32&&Ar==2&&(Jr[0]+=ae[1],Jr[1]+=he[1],Ar=0,K())}function Yr(){var Yn=d.mouse(_t),ai=!1;Et&&(Yn[0]+=Et[0],Yn[1]+=Et[1]),Ar||(d.event.altKey?(At||(At=[(ae[0]+ae[1])/2,(he[0]+he[1])/2]),Jr[0]=ae[+(Yn[0]<At[0])],Jr[1]=he[+(Yn[1]<At[1])]):At=null),gr&&Sn(Yn,F,0)&&(ot(Vt),ai=!0),Lr&&Sn(Yn,q,1)&&(Tt(Vt),ai=!0),ai&&(Je(Vt),zt({type:"brush",mode:Ar?"move":"resize"}))}function Sn(Yn,ai,di){var Li,ei,_i=cn(ai),yi=_i[0],Ii=_i[1],wi=Jr[di],Oi=di?he:ae,Hi=Oi[1]-Oi[0];if(Ar&&(yi-=wi,Ii-=Hi+wi),Li=(di?ke:xe)?Math.max(yi,Math.min(Ii,Yn[di])):Yn[di],Ar?ei=(Li+=wi)+Hi:(At&&(wi=Math.max(yi,Math.min(Ii,2*At[di]-Li))),wi<Li?(ei=Li,Li=wi):ei=wi),Oi[0]!=Li||Oi[1]!=ei)return di?C=null:ue=null,Oi[0]=Li,Oi[1]=ei,!0}function Kn(){Yr(),Vt.style("pointer-events","all").selectAll(".resize").style("display",He.empty()?"none":null),d.select("body").style("cursor",null),dn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),$r(),zt({type:"brushend"})}Vt.style("pointer-events","none").selectAll(".resize").style("display",null),d.select("body").style("cursor",Ft.style("cursor")),zt({type:"brushstart"}),Yr()}return He.event=function(At){At.each(function(){var Et=R.of(this,arguments),_t={x:ae,y:he,i:ue,j:C},Ft=this.__chart__||_t;this.__chart__=_t,As?d.select(this).transition().each("start.brush",function(){ue=Ft.i,C=Ft.j,ae=Ft.x,he=Ft.y,Et({type:"brushstart"})}).tween("brush:brush",function(){var zt=ya(ae,_t.x),Vt=ya(he,_t.y);return ue=C=null,function(ir){ae=_t.x=zt(ir),he=_t.y=Vt(ir),Et({type:"brush",mode:"resize"})}}).each("end.brush",function(){ue=_t.i,C=_t.j,Et({type:"brush",mode:"resize"}),Et({type:"brushend"})}):(Et({type:"brushstart"}),Et({type:"brush",mode:"resize"}),Et({type:"brushend"}))})},He.x=function(At){return arguments.length?(Le=lo[!(F=At)<<1|!q],He):F},He.y=function(At){return arguments.length?(Le=lo[!F<<1|!(q=At)],He):q},He.clamp=function(At){return arguments.length?(F&&q?(xe=!!At[0],ke=!!At[1]):F?xe=!!At:q&&(ke=!!At),He):F&&q?[xe,ke]:F?xe:q?ke:null},He.extent=function(At){var Et,_t,Ft,zt,Vt;return arguments.length?(F&&(Et=At[0],_t=At[1],q&&(Et=Et[0],_t=_t[0]),ue=[Et,_t],F.invert&&(Et=F(Et),_t=F(_t)),_t<Et&&(Vt=Et,Et=_t,_t=Vt),Et==ae[0]&&_t==ae[1]||(ae=[Et,_t])),q&&(Ft=At[0],zt=At[1],F&&(Ft=Ft[1],zt=zt[1]),C=[Ft,zt],q.invert&&(Ft=q(Ft),zt=q(zt)),zt<Ft&&(Vt=Ft,Ft=zt,zt=Vt),Ft==he[0]&&zt==he[1]||(he=[Ft,zt])),He):(F&&(ue?(Et=ue[0],_t=ue[1]):(Et=ae[0],_t=ae[1],F.invert&&(Et=F.invert(Et),_t=F.invert(_t)),_t<Et&&(Vt=Et,Et=_t,_t=Vt))),q&&(C?(Ft=C[0],zt=C[1]):(Ft=he[0],zt=he[1],q.invert&&(Ft=q.invert(Ft),zt=q.invert(zt)),zt<Ft&&(Vt=Ft,Ft=zt,zt=Vt))),F&&q?[[Et,Ft],[_t,zt]]:F?[Et,_t]:q&&[Ft,zt])},He.clear=function(){return He.empty()||(ae=[0,0],he=[0,0],ue=C=null),He},He.empty=function(){return!!F&&ae[0]==ae[1]||!!q&&he[0]==he[1]},d.rebind(He,R,"on")};var Hs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},lo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function ql(ue){return JSON.parse(ue.responseText)}function Gl(ue){var C=y.createRange();return C.selectNode(y.body),C.createContextualFragment(ue.responseText)}d.text=Sr(function(ue){return ue.responseText}),d.json=function(ue,C){return Dr(ue,"application/json",ql,C)},d.html=function(ue,C){return Dr(ue,"text/html",Gl,C)},d.xml=Sr(function(ue){return ue.responseXML}),typeof G=="object"&&G.exports?G.exports=d:this.d3=d}).apply(self)},{}],59:[function(m,G,W){G.exports=m("./quad")},{"./quad":60}],60:[function(m,G,W){var d=m("binary-search-bounds"),v=m("clamp"),w=m("parse-rect"),y=m("array-bounds"),e=m("pick-by-alias"),t=m("defined"),n=m("flatten-vertex-data"),a=m("is-obj"),r=m("dtype"),g=m("math-log2");function u(s,h){for(var l=h[0],o=h[1],p=1/(h[2]-l),c=1/(h[3]-o),i=new Array(s.length),x=0,f=s.length/2;x<f;x++)i[2*x]=v((s[2*x]-l)*p,0,1),i[2*x+1]=v((s[2*x+1]-o)*c,0,1);return i}G.exports=function(s,h){h||(h={}),s=n(s,"float64"),h=e(h,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var l=t(h.maxDepth,255),o=t(h.bounds,y(s,2));o[0]===o[2]&&o[2]++,o[1]===o[3]&&o[3]++;var p,c=u(s,o),i=s.length>>>1;h.dtype||(h.dtype="array"),typeof h.dtype=="string"?p=new(r(h.dtype))(i):h.dtype&&(p=h.dtype,Array.isArray(p)&&(p.length=i));for(var x=0;x<i;++x)p[x]=x;var f=[],_=[],b=[],T=[];(function D(j,V,Z,Q,K,$){if(!Q.length)return null;var ne=f[K]||(f[K]=[]),H=b[K]||(b[K]=[]),N=_[K]||(_[K]=[]),U=ne.length;if(++K>l||$>1073741824){for(var te=0;te<Q.length;te++)ne.push(Q[te]),H.push($),N.push(null,null,null,null);return U}if(ne.push(Q[0]),H.push($),Q.length<=1)return N.push(null,null,null,null),U;for(var B=.5*Z,X=j+B,J=V+B,ee=[],re=[],se=[],oe=[],de=1,ce=Q.length;de<ce;de++){var ve=Q[de],Ae=c[2*ve],fe=c[2*ve+1];Ae<X?fe<J?ee.push(ve):re.push(ve):fe<J?se.push(ve):oe.push(ve)}return $<<=2,N.push(D(j,V,B,ee,K,$),D(j,J,B,re,K,$+1),D(X,V,B,se,K,$+2),D(X,J,B,oe,K,$+3)),U})(0,0,1,p,0,1);for(var k=0,L=0;L<f.length;L++){var A=f[L];if(p.set)p.set(A,k);else for(var I=0,P=A.length;I<P;I++)p[I+k]=A[I];var S=k+f[L].length;T[L]=[k,S],k=S}return p.range=function(){for(var D,j=[],V=arguments.length;V--;)j[V]=arguments[V];if(a(j[j.length-1])){var Z=j.pop();j.length||Z.x==null&&Z.l==null&&Z.left==null||(j=[Z],D={}),D=e(Z,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else D={};j.length||(j=o);var Q=w.apply(void 0,j),K=[Math.min(Q.x,Q.x+Q.width),Math.min(Q.y,Q.y+Q.height),Math.max(Q.x,Q.x+Q.width),Math.max(Q.y,Q.y+Q.height)],$=K[0],ne=K[1],H=K[2],N=K[3],U=u([$,ne,H,N],o),te=U[0],B=U[1],X=U[2],J=U[3],ee=t(D.level,f.length);if(D.d!=null){var re;typeof D.d=="number"?re=[D.d,D.d]:D.d.length&&(re=D.d),ee=Math.min(Math.max(Math.ceil(-g(Math.abs(re[0])/(o[2]-o[0]))),Math.ceil(-g(Math.abs(re[1])/(o[3]-o[1])))),ee)}if(ee=Math.min(ee,f.length),D.lod)return E(te,B,X,J,ee);var se=[];function oe(ce,ve,Ae,fe,me,_e){if(me!==null&&_e!==null&&!(te>ce+Ae||B>ve+Ae||X<ce||J<ve||fe>=ee||me===_e)){var le=f[fe];_e===void 0&&(_e=le.length);for(var ge=me;ge<_e;ge++){var Te=le[ge],Se=s[2*Te],Me=s[2*Te+1];Se>=$&&Se<=H&&Me>=ne&&Me<=N&&se.push(Te)}var ze=_[fe],Oe=ze[4*me+0],De=ze[4*me+1],Xe=ze[4*me+2],Be=ze[4*me+3],Ie=de(ze,me+1),Re=.5*Ae,Ye=fe+1;oe(ce,ve,Re,Ye,Oe,De||Xe||Be||Ie),oe(ce,ve+Re,Re,Ye,De,Xe||Be||Ie),oe(ce+Re,ve,Re,Ye,Xe,Be||Ie),oe(ce+Re,ve+Re,Re,Ye,Be,Ie)}}function de(ce,ve){for(var Ae=null,fe=0;Ae===null;)if(Ae=ce[4*ve+fe],++fe>ce.length)return null;return Ae}return oe(0,0,1,0,0,1),se},p;function E(D,j,V,Z,Q){for(var K=[],$=0;$<Q;$++){var ne=b[$],H=T[$][0],N=z(D,j,$),U=z(V,Z,$),te=d.ge(ne,N),B=d.gt(ne,U,te,ne.length-1);K[$]=[te+H,B+H]}return K}function z(D,j,V){for(var Z=1,Q=.5,K=.5,$=.5,ne=0;ne<V;ne++)Z<<=2,Z+=D<Q?j<K?0:1:j<K?2:3,$*=.5,Q+=D<Q?-$:$,K+=j<K?-$:$;return Z}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=m("@turf/meta");function v(e){var t=0;if(e&&e.length>0){t+=Math.abs(w(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(w(e[n]))}return t}function w(e){var t,n,a,r,g,u,s=0,h=e.length;if(h>2){for(u=0;u<h;u++)u===h-2?(a=h-2,r=h-1,g=0):u===h-1?(a=h-1,r=0,g=1):(a=u,r=u+1,g=u+2),t=e[a],n=e[r],s+=(y(e[g][0])-y(t[0]))*Math.sin(y(n[1]));s=6378137*s*6378137/2}return s}function y(e){return e*Math.PI/180}W.default=function(e){return d.geomReduce(e,function(t,n){return t+function(a){var r,g=0;switch(a.type){case"Polygon":return v(a.coordinates);case"MultiPolygon":for(r=0;r<a.coordinates.length;r++)g+=v(a.coordinates[r]);return g;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(n)},0)}},{"@turf/meta":63}],62:[function(m,G,W){function d(h,l,o){o===void 0&&(o={});var p={type:"Feature"};return(o.id===0||o.id)&&(p.id=o.id),o.bbox&&(p.bbox=o.bbox),p.properties=l||{},p.geometry=h,p}function v(h,l,o){if(o===void 0&&(o={}),!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(h[0])||!s(h[1]))throw new Error("coordinates must contain numbers");return d({type:"Point",coordinates:h},l,o)}function w(h,l,o){o===void 0&&(o={});for(var p=0,c=h;p<c.length;p++){var i=c[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<i[i.length-1].length;x++)if(i[i.length-1][x]!==i[0][x])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:h},l,o)}function y(h,l,o){if(o===void 0&&(o={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return d({type:"LineString",coordinates:h},l,o)}function e(h,l){l===void 0&&(l={});var o={type:"FeatureCollection"};return l.id&&(o.id=l.id),l.bbox&&(o.bbox=l.bbox),o.features=h,o}function t(h,l,o){return o===void 0&&(o={}),d({type:"MultiLineString",coordinates:h},l,o)}function n(h,l,o){return o===void 0&&(o={}),d({type:"MultiPoint",coordinates:h},l,o)}function a(h,l,o){return o===void 0&&(o={}),d({type:"MultiPolygon",coordinates:h},l,o)}function r(h,l){l===void 0&&(l="kilometers");var o=W.factors[l];if(!o)throw new Error(l+" units is invalid");return h*o}function g(h,l){l===void 0&&(l="kilometers");var o=W.factors[l];if(!o)throw new Error(l+" units is invalid");return h/o}function u(h){return 180*(h%(2*Math.PI))/Math.PI}function s(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}Object.defineProperty(W,"__esModule",{value:!0}),W.earthRadius=63710088e-1,W.factors={centimeters:100*W.earthRadius,centimetres:100*W.earthRadius,degrees:W.earthRadius/111325,feet:3.28084*W.earthRadius,inches:39.37*W.earthRadius,kilometers:W.earthRadius/1e3,kilometres:W.earthRadius/1e3,meters:W.earthRadius,metres:W.earthRadius,miles:W.earthRadius/1609.344,millimeters:1e3*W.earthRadius,millimetres:1e3*W.earthRadius,nauticalmiles:W.earthRadius/1852,radians:1,yards:1.0936*W.earthRadius},W.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/W.earthRadius,yards:1.0936133},W.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},W.feature=d,W.geometry=function(h,l,o){switch(h){case"Point":return v(l).geometry;case"LineString":return y(l).geometry;case"Polygon":return w(l).geometry;case"MultiPoint":return n(l).geometry;case"MultiLineString":return t(l).geometry;case"MultiPolygon":return a(l).geometry;default:throw new Error(h+" is invalid")}},W.point=v,W.points=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return v(p,l)}),o)},W.polygon=w,W.polygons=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return w(p,l)}),o)},W.lineString=y,W.lineStrings=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return y(p,l)}),o)},W.featureCollection=e,W.multiLineString=t,W.multiPoint=n,W.multiPolygon=a,W.geometryCollection=function(h,l,o){return o===void 0&&(o={}),d({type:"GeometryCollection",geometries:h},l,o)},W.round=function(h,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var o=Math.pow(10,l||0);return Math.round(h*o)/o},W.radiansToLength=r,W.lengthToRadians=g,W.lengthToDegrees=function(h,l){return u(g(h,l))},W.bearingToAzimuth=function(h){var l=h%360;return l<0&&(l+=360),l},W.radiansToDegrees=u,W.degreesToRadians=function(h){return h%360*Math.PI/180},W.convertLength=function(h,l,o){if(l===void 0&&(l="kilometers"),o===void 0&&(o="kilometers"),!(h>=0))throw new Error("length must be a positive number");return r(g(h,l),o)},W.convertArea=function(h,l,o){if(l===void 0&&(l="meters"),o===void 0&&(o="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=W.areaFactors[l];if(!p)throw new Error("invalid original units");var c=W.areaFactors[o];if(!c)throw new Error("invalid final units");return h/p*c},W.isNumber=s,W.isObject=function(h){return!!h&&h.constructor===Object},W.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(h.length!==4&&h.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(l){if(!s(l))throw new Error("bbox must only contain numbers")})},W.validateId=function(h){if(!h)throw new Error("id is required");if(["string","number"].indexOf(typeof h)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=m("@turf/helpers");function v(r,g,u){if(r!==null)for(var s,h,l,o,p,c,i,x,f=0,_=0,b=r.type,T=b==="FeatureCollection",k=b==="Feature",L=T?r.features.length:1,A=0;A<L;A++){p=(x=!!(i=T?r.features[A].geometry:k?r.geometry:r)&&i.type==="GeometryCollection")?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if((o=x?i.geometries[I]:i)!==null){c=o.coordinates;var E=o.type;switch(f=!u||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(g(c,_,A,P,S)===!1)return!1;_++,P++;break;case"LineString":case"MultiPoint":for(s=0;s<c.length;s++){if(g(c[s],_,A,P,S)===!1)return!1;_++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(s=0;s<c.length;s++){for(h=0;h<c[s].length-f;h++){if(g(c[s][h],_,A,P,S)===!1)return!1;_++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(s=0;s<c.length;s++){for(S=0,h=0;h<c[s].length;h++){for(l=0;l<c[s][h].length-f;l++){if(g(c[s][h][l],_,A,P,S)===!1)return!1;_++}S++}P++}break;case"GeometryCollection":for(s=0;s<o.geometries.length;s++)if(v(o.geometries[s],g,u)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w(r,g){var u;switch(r.type){case"FeatureCollection":for(u=0;u<r.features.length&&g(r.features[u].properties,u)!==!1;u++);break;case"Feature":g(r.properties,0)}}function y(r,g){if(r.type==="Feature")g(r,0);else if(r.type==="FeatureCollection")for(var u=0;u<r.features.length&&g(r.features[u],u)!==!1;u++);}function e(r,g){var u,s,h,l,o,p,c,i,x,f,_=0,b=r.type==="FeatureCollection",T=r.type==="Feature",k=b?r.features.length:1;for(u=0;u<k;u++){for(p=b?r.features[u].geometry:T?r.geometry:r,i=b?r.features[u].properties:T?r.properties:{},x=b?r.features[u].bbox:T?r.bbox:void 0,f=b?r.features[u].id:T?r.id:void 0,o=(c=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,h=0;h<o;h++)if((l=c?p.geometries[h]:p)!==null)switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(g(l,_,i,x,f)===!1)return!1;break;case"GeometryCollection":for(s=0;s<l.geometries.length;s++)if(g(l.geometries[s],_,i,x,f)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(g(null,_,i,x,f)===!1)return!1;_++}}function t(r,g){e(r,function(u,s,h,l,o){var p,c=u===null?null:u.type;switch(c){case null:case"Point":case"LineString":case"Polygon":return g(d.feature(u,h,{bbox:l,id:o}),s,0)!==!1&&void 0}switch(c){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<u.coordinates.length;i++){var x={type:p,coordinates:u.coordinates[i]};if(g(d.feature(x,h),s,i)===!1)return!1}})}function n(r,g){t(r,function(u,s,h){var l=0;if(u.geometry){var o=u.geometry.type;if(o!=="Point"&&o!=="MultiPoint"){var p,c=0,i=0,x=0;return v(u,function(f,_,b,T,k){if(p===void 0||s>c||T>i||k>x)return p=f,c=s,i=T,x=k,void(l=0);var L=d.lineString([p,f],u.properties);if(g(L,s,h,k,l)===!1)return!1;l++,p=f})!==!1&&void 0}}})}function a(r,g){if(!r)throw new Error("geojson is required");t(r,function(u,s,h){if(u.geometry!==null){var l=u.geometry.type,o=u.geometry.coordinates;switch(l){case"LineString":if(g(u,s,h,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<o.length;p++)if(g(d.lineString(o[p],u.properties),s,h,p)===!1)return!1}}})}W.coordEach=v,W.coordReduce=function(r,g,u,s){var h=u;return v(r,function(l,o,p,c,i){h=o===0&&u===void 0?l:g(h,l,o,p,c,i)},s),h},W.propEach=w,W.propReduce=function(r,g,u){var s=u;return w(r,function(h,l){s=l===0&&u===void 0?h:g(s,h,l)}),s},W.featureEach=y,W.featureReduce=function(r,g,u){var s=u;return y(r,function(h,l){s=l===0&&u===void 0?h:g(s,h,l)}),s},W.coordAll=function(r){var g=[];return v(r,function(u){g.push(u)}),g},W.geomEach=e,W.geomReduce=function(r,g,u){var s=u;return e(r,function(h,l,o,p,c){s=l===0&&u===void 0?h:g(s,h,l,o,p,c)}),s},W.flattenEach=t,W.flattenReduce=function(r,g,u){var s=u;return t(r,function(h,l,o){s=l===0&&o===0&&u===void 0?h:g(s,h,l,o)}),s},W.segmentEach=n,W.segmentReduce=function(r,g,u){var s=u,h=!1;return n(r,function(l,o,p,c,i){s=h===!1&&u===void 0?l:g(s,l,o,p,c,i),h=!0}),s},W.lineEach=a,W.lineReduce=function(r,g,u){var s=u;return a(r,function(h,l,o,p){s=l===0&&u===void 0?h:g(s,h,l,o,p)}),s},W.findSegment=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var u,s=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,o=g.segmentIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":s<0&&(s=r.features.length+s),p=p||r.features[s].properties,u=r.features[s].geometry;break;case"Feature":p=p||r.properties,u=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=r;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var c=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=c.length+o-1),d.lineString([c[o],c[o+1]],p,g);case"Polygon":return l<0&&(l=c.length+l),o<0&&(o=c[l].length+o-1),d.lineString([c[l][o],c[l][o+1]],p,g);case"MultiLineString":return h<0&&(h=c.length+h),o<0&&(o=c[h].length+o-1),d.lineString([c[h][o],c[h][o+1]],p,g);case"MultiPolygon":return h<0&&(h=c.length+h),l<0&&(l=c[h].length+l),o<0&&(o=c[h][l].length-o-1),d.lineString([c[h][l][o],c[h][l][o+1]],p,g)}throw new Error("geojson is invalid")},W.findPoint=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var u,s=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,o=g.coordIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":s<0&&(s=r.features.length+s),p=p||r.features[s].properties,u=r.features[s].geometry;break;case"Feature":p=p||r.properties,u=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=r;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var c=u.coordinates;switch(u.type){case"Point":return d.point(c,p,g);case"MultiPoint":return h<0&&(h=c.length+h),d.point(c[h],p,g);case"LineString":return o<0&&(o=c.length+o),d.point(c[o],p,g);case"Polygon":return l<0&&(l=c.length+l),o<0&&(o=c[l].length+o),d.point(c[l][o],p,g);case"MultiLineString":return h<0&&(h=c.length+h),o<0&&(o=c[h].length+o),d.point(c[h][o],p,g);case"MultiPolygon":return h<0&&(h=c.length+h),l<0&&(l=c[h].length+l),o<0&&(o=c[h][l].length-o),d.point(c[h][l][o],p,g)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=m("@turf/meta");function v(w){var y=[1/0,1/0,-1/0,-1/0];return d.coordEach(w,function(e){y[0]>e[0]&&(y[0]=e[0]),y[1]>e[1]&&(y[1]=e[1]),y[2]<e[0]&&(y[2]=e[0]),y[3]<e[1]&&(y[3]=e[1])}),y}v.default=v,W.default=v},{"@turf/meta":66}],65:[function(m,G,W){arguments[4][62][0].apply(W,arguments)},{dup:62}],66:[function(m,G,W){arguments[4][63][0].apply(W,arguments)},{"@turf/helpers":65,dup:63}],67:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=m("@turf/meta"),v=m("@turf/helpers");W.default=function(w,y){y===void 0&&(y={});var e=0,t=0,n=0;return d.coordEach(w,function(a){e+=a[0],t+=a[1],n++}),v.point([e/n,t/n],y.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(m,G,W){function d(h,l,o){o===void 0&&(o={});var p={type:"Feature"};return(o.id===0||o.id)&&(p.id=o.id),o.bbox&&(p.bbox=o.bbox),p.properties=l||{},p.geometry=h,p}function v(h,l,o){return o===void 0&&(o={}),d({type:"Point",coordinates:h},l,o)}function w(h,l,o){o===void 0&&(o={});for(var p=0,c=h;p<c.length;p++){var i=c[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<i[i.length-1].length;x++)if(i[i.length-1][x]!==i[0][x])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:h},l,o)}function y(h,l,o){if(o===void 0&&(o={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return d({type:"LineString",coordinates:h},l,o)}function e(h,l){l===void 0&&(l={});var o={type:"FeatureCollection"};return l.id&&(o.id=l.id),l.bbox&&(o.bbox=l.bbox),o.features=h,o}function t(h,l,o){return o===void 0&&(o={}),d({type:"MultiLineString",coordinates:h},l,o)}function n(h,l,o){return o===void 0&&(o={}),d({type:"MultiPoint",coordinates:h},l,o)}function a(h,l,o){return o===void 0&&(o={}),d({type:"MultiPolygon",coordinates:h},l,o)}function r(h,l){l===void 0&&(l="kilometers");var o=W.factors[l];if(!o)throw new Error(l+" units is invalid");return h*o}function g(h,l){l===void 0&&(l="kilometers");var o=W.factors[l];if(!o)throw new Error(l+" units is invalid");return h/o}function u(h){return 180*(h%(2*Math.PI))/Math.PI}function s(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)&&!/^\s*$/.test(h)}Object.defineProperty(W,"__esModule",{value:!0}),W.earthRadius=63710088e-1,W.factors={centimeters:100*W.earthRadius,centimetres:100*W.earthRadius,degrees:W.earthRadius/111325,feet:3.28084*W.earthRadius,inches:39.37*W.earthRadius,kilometers:W.earthRadius/1e3,kilometres:W.earthRadius/1e3,meters:W.earthRadius,metres:W.earthRadius,miles:W.earthRadius/1609.344,millimeters:1e3*W.earthRadius,millimetres:1e3*W.earthRadius,nauticalmiles:W.earthRadius/1852,radians:1,yards:W.earthRadius/1.0936},W.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/W.earthRadius,yards:1/1.0936},W.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},W.feature=d,W.geometry=function(h,l,o){switch(h){case"Point":return v(l).geometry;case"LineString":return y(l).geometry;case"Polygon":return w(l).geometry;case"MultiPoint":return n(l).geometry;case"MultiLineString":return t(l).geometry;case"MultiPolygon":return a(l).geometry;default:throw new Error(h+" is invalid")}},W.point=v,W.points=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return v(p,l)}),o)},W.polygon=w,W.polygons=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return w(p,l)}),o)},W.lineString=y,W.lineStrings=function(h,l,o){return o===void 0&&(o={}),e(h.map(function(p){return y(p,l)}),o)},W.featureCollection=e,W.multiLineString=t,W.multiPoint=n,W.multiPolygon=a,W.geometryCollection=function(h,l,o){return o===void 0&&(o={}),d({type:"GeometryCollection",geometries:h},l,o)},W.round=function(h,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var o=Math.pow(10,l||0);return Math.round(h*o)/o},W.radiansToLength=r,W.lengthToRadians=g,W.lengthToDegrees=function(h,l){return u(g(h,l))},W.bearingToAzimuth=function(h){var l=h%360;return l<0&&(l+=360),l},W.radiansToDegrees=u,W.degreesToRadians=function(h){return h%360*Math.PI/180},W.convertLength=function(h,l,o){if(l===void 0&&(l="kilometers"),o===void 0&&(o="kilometers"),!(h>=0))throw new Error("length must be a positive number");return r(g(h,l),o)},W.convertArea=function(h,l,o){if(l===void 0&&(l="meters"),o===void 0&&(o="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=W.areaFactors[l];if(!p)throw new Error("invalid original units");var c=W.areaFactors[o];if(!c)throw new Error("invalid final units");return h/p*c},W.isNumber=s,W.isObject=function(h){return!!h&&h.constructor===Object},W.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(h.length!==4&&h.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(l){if(!s(l))throw new Error("bbox must only contain numbers")})},W.validateId=function(h){if(!h)throw new Error("id is required");if(["string","number"].indexOf(typeof h)===-1)throw new Error("id must be a number or a string")},W.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},W.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},W.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},W.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},W.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},W.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},W.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=m("@turf/helpers");function v(r,g,u){if(r!==null)for(var s,h,l,o,p,c,i,x,f=0,_=0,b=r.type,T=b==="FeatureCollection",k=b==="Feature",L=T?r.features.length:1,A=0;A<L;A++){p=(x=!!(i=T?r.features[A].geometry:k?r.geometry:r)&&i.type==="GeometryCollection")?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if((o=x?i.geometries[I]:i)!==null){c=o.coordinates;var E=o.type;switch(f=!u||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(g(c,_,A,P,S)===!1)return!1;_++,P++;break;case"LineString":case"MultiPoint":for(s=0;s<c.length;s++){if(g(c[s],_,A,P,S)===!1)return!1;_++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(s=0;s<c.length;s++){for(h=0;h<c[s].length-f;h++){if(g(c[s][h],_,A,P,S)===!1)return!1;_++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(s=0;s<c.length;s++){for(S=0,h=0;h<c[s].length;h++){for(l=0;l<c[s][h].length-f;l++){if(g(c[s][h][l],_,A,P,S)===!1)return!1;_++}S++}P++}break;case"GeometryCollection":for(s=0;s<o.geometries.length;s++)if(v(o.geometries[s],g,u)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w(r,g){var u;switch(r.type){case"FeatureCollection":for(u=0;u<r.features.length&&g(r.features[u].properties,u)!==!1;u++);break;case"Feature":g(r.properties,0)}}function y(r,g){if(r.type==="Feature")g(r,0);else if(r.type==="FeatureCollection")for(var u=0;u<r.features.length&&g(r.features[u],u)!==!1;u++);}function e(r,g){var u,s,h,l,o,p,c,i,x,f,_=0,b=r.type==="FeatureCollection",T=r.type==="Feature",k=b?r.features.length:1;for(u=0;u<k;u++){for(p=b?r.features[u].geometry:T?r.geometry:r,i=b?r.features[u].properties:T?r.properties:{},x=b?r.features[u].bbox:T?r.bbox:void 0,f=b?r.features[u].id:T?r.id:void 0,o=(c=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,h=0;h<o;h++)if((l=c?p.geometries[h]:p)!==null)switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(g(l,_,i,x,f)===!1)return!1;break;case"GeometryCollection":for(s=0;s<l.geometries.length;s++)if(g(l.geometries[s],_,i,x,f)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(g(null,_,i,x,f)===!1)return!1;_++}}function t(r,g){e(r,function(u,s,h,l,o){var p,c=u===null?null:u.type;switch(c){case null:case"Point":case"LineString":case"Polygon":return g(d.feature(u,h,{bbox:l,id:o}),s,0)!==!1&&void 0}switch(c){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<u.coordinates.length;i++){var x={type:p,coordinates:u.coordinates[i]};if(g(d.feature(x,h),s,i)===!1)return!1}})}function n(r,g){t(r,function(u,s,h){var l=0;if(u.geometry){var o=u.geometry.type;if(o!=="Point"&&o!=="MultiPoint"){var p,c=0,i=0,x=0;return v(u,function(f,_,b,T,k){if(p===void 0||s>c||T>i||k>x)return p=f,c=s,i=T,x=k,void(l=0);var L=d.lineString([p,f],u.properties);if(g(L,s,h,k,l)===!1)return!1;l++,p=f})!==!1&&void 0}}})}function a(r,g){if(!r)throw new Error("geojson is required");t(r,function(u,s,h){if(u.geometry!==null){var l=u.geometry.type,o=u.geometry.coordinates;switch(l){case"LineString":if(g(u,s,h,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<o.length;p++)if(g(d.lineString(o[p],u.properties),s,h,p)===!1)return!1}}})}W.coordEach=v,W.coordReduce=function(r,g,u,s){var h=u;return v(r,function(l,o,p,c,i){h=o===0&&u===void 0?l:g(h,l,o,p,c,i)},s),h},W.propEach=w,W.propReduce=function(r,g,u){var s=u;return w(r,function(h,l){s=l===0&&u===void 0?h:g(s,h,l)}),s},W.featureEach=y,W.featureReduce=function(r,g,u){var s=u;return y(r,function(h,l){s=l===0&&u===void 0?h:g(s,h,l)}),s},W.coordAll=function(r){var g=[];return v(r,function(u){g.push(u)}),g},W.geomEach=e,W.geomReduce=function(r,g,u){var s=u;return e(r,function(h,l,o,p,c){s=l===0&&u===void 0?h:g(s,h,l,o,p,c)}),s},W.flattenEach=t,W.flattenReduce=function(r,g,u){var s=u;return t(r,function(h,l,o){s=l===0&&o===0&&u===void 0?h:g(s,h,l,o)}),s},W.segmentEach=n,W.segmentReduce=function(r,g,u){var s=u,h=!1;return n(r,function(l,o,p,c,i){s=h===!1&&u===void 0?l:g(s,l,o,p,c,i),h=!0}),s},W.lineEach=a,W.lineReduce=function(r,g,u){var s=u;return a(r,function(h,l,o,p){s=l===0&&u===void 0?h:g(s,h,l,o,p)}),s},W.findSegment=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var u,s=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,o=g.segmentIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":s<0&&(s=r.features.length+s),p=p||r.features[s].properties,u=r.features[s].geometry;break;case"Feature":p=p||r.properties,u=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=r;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var c=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=c.length+o-1),d.lineString([c[o],c[o+1]],p,g);case"Polygon":return l<0&&(l=c.length+l),o<0&&(o=c[l].length+o-1),d.lineString([c[l][o],c[l][o+1]],p,g);case"MultiLineString":return h<0&&(h=c.length+h),o<0&&(o=c[h].length+o-1),d.lineString([c[h][o],c[h][o+1]],p,g);case"MultiPolygon":return h<0&&(h=c.length+h),l<0&&(l=c[h].length+l),o<0&&(o=c[h][l].length-o-1),d.lineString([c[h][l][o],c[h][l][o+1]],p,g)}throw new Error("geojson is invalid")},W.findPoint=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var u,s=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,o=g.coordIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":s<0&&(s=r.features.length+s),p=p||r.features[s].properties,u=r.features[s].geometry;break;case"Feature":p=p||r.properties,u=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=r;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var c=u.coordinates;switch(u.type){case"Point":return d.point(c,p,g);case"MultiPoint":return h<0&&(h=c.length+h),d.point(c[h],p,g);case"LineString":return o<0&&(o=c.length+o),d.point(c[o],p,g);case"Polygon":return l<0&&(l=c.length+l),o<0&&(o=c[l].length+o),d.point(c[l][o],p,g);case"MultiLineString":return h<0&&(h=c.length+h),o<0&&(o=c[h].length+o),d.point(c[h][o],p,g);case"MultiPolygon":return h<0&&(h=c.length+h),l<0&&(l=c[h].length+l),o<0&&(o=c[h][l].length-o),d.point(c[h][l][o],p,g)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(m,G,W){G.exports=function(d){var v=0,w=0,y=0,e=0;return d.map(function(t){var n=(t=t.slice())[0],a=n.toUpperCase();if(n!=a)switch(t[0]=a,n){case"a":t[6]+=y,t[7]+=e;break;case"v":t[1]+=e;break;case"h":t[1]+=y;break;default:for(var r=1;r<t.length;)t[r++]+=y,t[r++]+=e}switch(a){case"Z":y=v,e=w;break;case"H":y=t[1];break;case"V":e=t[1];break;case"M":y=v=t[1],e=w=t[2];break;default:y=t[t.length-2],e=t[t.length-1]}return t})}},{}],71:[function(m,G,W){G.exports=function(d,v){if(!d||d.length==null)throw Error("Argument should be an array");v=v==null?1:Math.floor(v);for(var w=Array(2*v),y=0;y<v;y++){for(var e=-1/0,t=1/0,n=y,a=d.length;n<a;n+=v)d[n]>e&&(e=d[n]),d[n]<t&&(t=d[n]);w[y]=t,w[v+y]=e}return w}},{}],72:[function(m,G,W){G.exports=function(d,v,w){if(typeof Array.prototype.findIndex=="function")return d.findIndex(v,w);if(typeof v!="function")throw new TypeError("predicate must be a function");var y=Object(d),e=y.length;if(e===0)return-1;for(var t=0;t<e;t++)if(v.call(w,y[t],t,y))return t;return-1}},{}],73:[function(m,G,W){var d=m("array-bounds");G.exports=function(v,w,y){if(!v||v.length==null)throw Error("Argument should be an array");w==null&&(w=1),y==null&&(y=d(v,w));for(var e=0;e<w;e++){var t=y[w+e],n=y[e],a=e,r=v.length;if(t===1/0&&n===-1/0)for(a=e;a<r;a+=w)v[a]=v[a]===t?1:v[a]===n?0:.5;else if(t===1/0)for(a=e;a<r;a+=w)v[a]=v[a]===t?1:0;else if(n===-1/0)for(a=e;a<r;a+=w)v[a]=v[a]===n?0:1;else{var g=t-n;for(a=e;a<r;a+=w)isNaN(v[a])||(v[a]=g===0?.5:(v[a]-n)/g)}}return v}},{"array-bounds":71}],74:[function(m,G,W){G.exports=function(d,v){var w=typeof d=="number",y=typeof v=="number";w&&!y?(v=d,d=0):w||y||(d=0,v=0);var e=(v|=0)-(d|=0);if(e<0)throw new Error("array length must be positive");for(var t=new Array(e),n=0,a=d;n<e;n++,a++)t[n]=a;return t}},{}],75:[function(m,G,W){(function(d){(function(){var v=m("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function w(T,k){if(T===k)return 0;for(var L=T.length,A=k.length,I=0,P=Math.min(L,A);I<P;++I)if(T[I]!==k[I]){L=T[I],A=k[I];break}return L<A?-1:A<L?1:0}function y(T){return d.Buffer&&typeof d.Buffer.isBuffer=="function"?d.Buffer.isBuffer(T):!(T==null||!T._isBuffer)}var e=m("util/"),t=Object.prototype.hasOwnProperty,n=Array.prototype.slice,a=function(){}.name==="foo";function r(T){return Object.prototype.toString.call(T)}function g(T){return!y(T)&&typeof d.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(T):!!T&&(T instanceof DataView||!!(T.buffer&&T.buffer instanceof ArrayBuffer)))}var u=G.exports=c,s=/\s*function\s+([^\(\s]*)\s*/;function h(T){if(e.isFunction(T)){if(a)return T.name;var k=T.toString().match(s);return k&&k[1]}}function l(T,k){return typeof T=="string"?T.length<k?T:T.slice(0,k):T}function o(T){if(a||!e.isFunction(T))return e.inspect(T);var k=h(T);return"[Function"+(k?": "+k:"")+"]"}function p(T,k,L,A,I){throw new u.AssertionError({message:L,actual:T,expected:k,operator:A,stackStartFunction:I})}function c(T,k){T||p(T,!0,k,"==",u.ok)}function i(T,k,L,A){if(T===k)return!0;if(y(T)&&y(k))return w(T,k)===0;if(e.isDate(T)&&e.isDate(k))return T.getTime()===k.getTime();if(e.isRegExp(T)&&e.isRegExp(k))return T.source===k.source&&T.global===k.global&&T.multiline===k.multiline&&T.lastIndex===k.lastIndex&&T.ignoreCase===k.ignoreCase;if(T!==null&&typeof T=="object"||k!==null&&typeof k=="object"){if(g(T)&&g(k)&&r(T)===r(k)&&!(T instanceof Float32Array||T instanceof Float64Array))return w(new Uint8Array(T.buffer),new Uint8Array(k.buffer))===0;if(y(T)!==y(k))return!1;var I=(A=A||{actual:[],expected:[]}).actual.indexOf(T);return I!==-1&&I===A.expected.indexOf(k)||(A.actual.push(T),A.expected.push(k),function(P,S,E,z){if(P==null||S==null)return!1;if(e.isPrimitive(P)||e.isPrimitive(S))return P===S;if(E&&Object.getPrototypeOf(P)!==Object.getPrototypeOf(S))return!1;var D=x(P),j=x(S);if(D&&!j||!D&&j)return!1;if(D)return P=n.call(P),S=n.call(S),i(P,S,E);var V,Z,Q=b(P),K=b(S);if(Q.length!==K.length)return!1;for(Q.sort(),K.sort(),Z=Q.length-1;Z>=0;Z--)if(Q[Z]!==K[Z])return!1;for(Z=Q.length-1;Z>=0;Z--)if(V=Q[Z],!i(P[V],S[V],E,z))return!1;return!0}(T,k,L,A))}return L?T===k:T==k}function x(T){return Object.prototype.toString.call(T)=="[object Arguments]"}function f(T,k){if(!T||!k)return!1;if(Object.prototype.toString.call(k)=="[object RegExp]")return k.test(T);try{if(T instanceof k)return!0}catch{}return!Error.isPrototypeOf(k)&&k.call({},T)===!0}function _(T,k,L,A){var I;if(typeof k!="function")throw new TypeError('"block" argument must be a function');typeof L=="string"&&(A=L,L=null),I=function(E){var z;try{E()}catch(D){z=D}return z}(k),A=(L&&L.name?" ("+L.name+").":".")+(A?" "+A:"."),T&&!I&&p(I,L,"Missing expected exception"+A);var P=typeof A=="string",S=!T&&I&&!L;if((!T&&e.isError(I)&&P&&f(I,L)||S)&&p(I,L,"Got unwanted exception"+A),T&&I&&L&&!f(I,L)||!T&&I)throw I}u.AssertionError=function(T){this.name="AssertionError",this.actual=T.actual,this.expected=T.expected,this.operator=T.operator,T.message?(this.message=T.message,this.generatedMessage=!1):(this.message=function(E){return l(o(E.actual),128)+" "+E.operator+" "+l(o(E.expected),128)}(this),this.generatedMessage=!0);var k=T.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var L=new Error;if(L.stack){var A=L.stack,I=h(k),P=A.indexOf(`
`+I);if(P>=0){var S=A.indexOf(`
`,P+1);A=A.substring(S+1)}this.stack=A}}},e.inherits(u.AssertionError,Error),u.fail=p,u.ok=c,u.equal=function(T,k,L){T!=k&&p(T,k,L,"==",u.equal)},u.notEqual=function(T,k,L){T==k&&p(T,k,L,"!=",u.notEqual)},u.deepEqual=function(T,k,L){i(T,k,!1)||p(T,k,L,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(T,k,L){i(T,k,!0)||p(T,k,L,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(T,k,L){i(T,k,!1)&&p(T,k,L,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function T(k,L,A){i(k,L,!0)&&p(k,L,A,"notDeepStrictEqual",T)},u.strictEqual=function(T,k,L){T!==k&&p(T,k,L,"===",u.strictEqual)},u.notStrictEqual=function(T,k,L){T===k&&p(T,k,L,"!==",u.notStrictEqual)},u.throws=function(T,k,L){_(!0,T,k,L)},u.doesNotThrow=function(T,k,L){_(!1,T,k,L)},u.ifError=function(T){if(T)throw T},u.strict=v(function T(k,L){k||p(k,!0,L,"==",T)},u,{equal:u.strictEqual,deepEqual:u.deepStrictEqual,notEqual:u.notStrictEqual,notDeepEqual:u.notDeepStrictEqual}),u.strict.strict=u.strict;var b=Object.keys||function(T){var k=[];for(var L in T)t.call(T,L)&&k.push(L);return k}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(m,G,W){typeof Object.create=="function"?G.exports=function(d,v){d.super_=v,d.prototype=Object.create(v.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}})}:G.exports=function(d,v){d.super_=v;var w=function(){};w.prototype=v.prototype,d.prototype=new w,d.prototype.constructor=d}},{}],77:[function(m,G,W){G.exports=function(d){return d&&typeof d=="object"&&typeof d.copy=="function"&&typeof d.fill=="function"&&typeof d.readUInt8=="function"}},{}],78:[function(m,G,W){(function(d,v){(function(){var w=/%[sdj%]/g;W.format=function(P){if(!p(P)){for(var S=[],E=0;E<arguments.length;E++)S.push(t(arguments[E]));return S.join(" ")}E=1;for(var z=arguments,D=z.length,j=String(P).replace(w,function(Z){if(Z==="%%")return"%";if(E>=D)return Z;switch(Z){case"%s":return String(z[E++]);case"%d":return Number(z[E++]);case"%j":try{return JSON.stringify(z[E++])}catch{return"[Circular]"}default:return Z}}),V=z[E];E<D;V=z[++E])l(V)||!x(V)?j+=" "+V:j+=" "+t(V);return j},W.deprecate=function(P,S){if(c(v.process))return function(){return W.deprecate(P,S).apply(this,arguments)};if(d.noDeprecation===!0)return P;var E=!1;return function(){if(!E){if(d.throwDeprecation)throw new Error(S);d.traceDeprecation?console.trace(S):console.error(S),E=!0}return P.apply(this,arguments)}};var y,e={};function t(P,S){var E={seen:[],stylize:a};return arguments.length>=3&&(E.depth=arguments[2]),arguments.length>=4&&(E.colors=arguments[3]),h(S)?E.showHidden=S:S&&W._extend(E,S),c(E.showHidden)&&(E.showHidden=!1),c(E.depth)&&(E.depth=2),c(E.colors)&&(E.colors=!1),c(E.customInspect)&&(E.customInspect=!0),E.colors&&(E.stylize=n),r(E,P,E.depth)}function n(P,S){var E=t.styles[S];return E?"\x1B["+t.colors[E][0]+"m"+P+"\x1B["+t.colors[E][1]+"m":P}function a(P,S){return P}function r(P,S,E){if(P.customInspect&&S&&b(S.inspect)&&S.inspect!==W.inspect&&(!S.constructor||S.constructor.prototype!==S)){var z=S.inspect(E,P);return p(z)||(z=r(P,z,E)),z}var D=function(H,N){if(c(N))return H.stylize("undefined","undefined");if(p(N)){var U="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return H.stylize(U,"string")}if(o(N))return H.stylize(""+N,"number");if(h(N))return H.stylize(""+N,"boolean");if(l(N))return H.stylize("null","null")}(P,S);if(D)return D;var j=Object.keys(S),V=function(H){var N={};return H.forEach(function(U,te){N[U]=!0}),N}(j);if(P.showHidden&&(j=Object.getOwnPropertyNames(S)),_(S)&&(j.indexOf("message")>=0||j.indexOf("description")>=0))return g(S);if(j.length===0){if(b(S)){var Z=S.name?": "+S.name:"";return P.stylize("[Function"+Z+"]","special")}if(i(S))return P.stylize(RegExp.prototype.toString.call(S),"regexp");if(f(S))return P.stylize(Date.prototype.toString.call(S),"date");if(_(S))return g(S)}var Q,K="",$=!1,ne=["{","}"];return s(S)&&($=!0,ne=["[","]"]),b(S)&&(K=" [Function"+(S.name?": "+S.name:"")+"]"),i(S)&&(K=" "+RegExp.prototype.toString.call(S)),f(S)&&(K=" "+Date.prototype.toUTCString.call(S)),_(S)&&(K=" "+g(S)),j.length!==0||$&&S.length!=0?E<0?i(S)?P.stylize(RegExp.prototype.toString.call(S),"regexp"):P.stylize("[Object]","special"):(P.seen.push(S),Q=$?function(H,N,U,te,B){for(var X=[],J=0,ee=N.length;J<ee;++J)I(N,String(J))?X.push(u(H,N,U,te,String(J),!0)):X.push("");return B.forEach(function(re){re.match(/^\d+$/)||X.push(u(H,N,U,te,re,!0))}),X}(P,S,E,V,j):j.map(function(H){return u(P,S,E,V,H,$)}),P.seen.pop(),function(H,N,U){return H.reduce(function(te,B){return B.indexOf(`
`)>=0,te+B.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(N===""?"":N+`
 `)+" "+H.join(`,
  `)+" "+U[1]:U[0]+N+" "+H.join(", ")+" "+U[1]}(Q,K,ne)):ne[0]+K+ne[1]}function g(P){return"["+Error.prototype.toString.call(P)+"]"}function u(P,S,E,z,D,j){var V,Z,Q;if((Q=Object.getOwnPropertyDescriptor(S,D)||{value:S[D]}).get?Z=Q.set?P.stylize("[Getter/Setter]","special"):P.stylize("[Getter]","special"):Q.set&&(Z=P.stylize("[Setter]","special")),I(z,D)||(V="["+D+"]"),Z||(P.seen.indexOf(Q.value)<0?(Z=l(E)?r(P,Q.value,null):r(P,Q.value,E-1)).indexOf(`
`)>-1&&(Z=j?Z.split(`
`).map(function(K){return"  "+K}).join(`
`).substr(2):`
`+Z.split(`
`).map(function(K){return"   "+K}).join(`
`)):Z=P.stylize("[Circular]","special")),c(V)){if(j&&D.match(/^\d+$/))return Z;(V=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(V=V.substr(1,V.length-2),V=P.stylize(V,"name")):(V=V.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),V=P.stylize(V,"string"))}return V+": "+Z}function s(P){return Array.isArray(P)}function h(P){return typeof P=="boolean"}function l(P){return P===null}function o(P){return typeof P=="number"}function p(P){return typeof P=="string"}function c(P){return P===void 0}function i(P){return x(P)&&T(P)==="[object RegExp]"}function x(P){return typeof P=="object"&&P!==null}function f(P){return x(P)&&T(P)==="[object Date]"}function _(P){return x(P)&&(T(P)==="[object Error]"||P instanceof Error)}function b(P){return typeof P=="function"}function T(P){return Object.prototype.toString.call(P)}function k(P){return P<10?"0"+P.toString(10):P.toString(10)}W.debuglog=function(P){if(c(y)&&(y=d.env.NODE_DEBUG||""),P=P.toUpperCase(),!e[P])if(new RegExp("\\b"+P+"\\b","i").test(y)){var S=d.pid;e[P]=function(){var E=W.format.apply(W,arguments);console.error("%s %d: %s",P,S,E)}}else e[P]=function(){};return e[P]},W.inspect=t,t.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},t.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},W.isArray=s,W.isBoolean=h,W.isNull=l,W.isNullOrUndefined=function(P){return P==null},W.isNumber=o,W.isString=p,W.isSymbol=function(P){return typeof P=="symbol"},W.isUndefined=c,W.isRegExp=i,W.isObject=x,W.isDate=f,W.isError=_,W.isFunction=b,W.isPrimitive=function(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"||typeof P=="symbol"||P===void 0},W.isBuffer=m("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var P=new Date,S=[k(P.getHours()),k(P.getMinutes()),k(P.getSeconds())].join(":");return[P.getDate(),L[P.getMonth()],S].join(" ")}function I(P,S){return Object.prototype.hasOwnProperty.call(P,S)}W.log=function(){console.log("%s - %s",A(),W.format.apply(W,arguments))},W.inherits=m("inherits"),W._extend=function(P,S){if(!S||!x(S))return P;for(var E=Object.keys(S),z=E.length;z--;)P[E[z]]=S[E[z]];return P}}).call(this)}).call(this,m("_process"),typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(m,G,W){W.byteLength=function(r){var g=n(r),u=g[0],s=g[1];return 3*(u+s)/4-s},W.toByteArray=function(r){var g,u,s=n(r),h=s[0],l=s[1],o=new w(function(i,x,f){return 3*(x+f)/4-f}(0,h,l)),p=0,c=l>0?h-4:h;for(u=0;u<c;u+=4)g=v[r.charCodeAt(u)]<<18|v[r.charCodeAt(u+1)]<<12|v[r.charCodeAt(u+2)]<<6|v[r.charCodeAt(u+3)],o[p++]=g>>16&255,o[p++]=g>>8&255,o[p++]=255&g;return l===2&&(g=v[r.charCodeAt(u)]<<2|v[r.charCodeAt(u+1)]>>4,o[p++]=255&g),l===1&&(g=v[r.charCodeAt(u)]<<10|v[r.charCodeAt(u+1)]<<4|v[r.charCodeAt(u+2)]>>2,o[p++]=g>>8&255,o[p++]=255&g),o},W.fromByteArray=function(r){for(var g,u=r.length,s=u%3,h=[],l=0,o=u-s;l<o;l+=16383)h.push(a(r,l,l+16383>o?o:l+16383));return s===1?(g=r[u-1],h.push(d[g>>2]+d[g<<4&63]+"==")):s===2&&(g=(r[u-2]<<8)+r[u-1],h.push(d[g>>10]+d[g>>4&63]+d[g<<2&63]+"=")),h.join("")};for(var d=[],v=[],w=typeof Uint8Array<"u"?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,t=y.length;e<t;++e)d[e]=y[e],v[y.charCodeAt(e)]=e;function n(r){var g=r.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=r.indexOf("=");return u===-1&&(u=g),[u,u===g?0:4-u%4]}function a(r,g,u){for(var s,h,l=[],o=g;o<u;o+=3)s=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(255&r[o+2]),l.push(d[(h=s)>>18&63]+d[h>>12&63]+d[h>>6&63]+d[63&h]);return l.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63},{}],80:[function(m,G,W){function d(n,a,r,g,u){for(var s=u+1;g<=u;){var h=g+u>>>1,l=n[h];(r!==void 0?r(l,a):l-a)>=0?(s=h,u=h-1):g=h+1}return s}function v(n,a,r,g,u){for(var s=u+1;g<=u;){var h=g+u>>>1,l=n[h];(r!==void 0?r(l,a):l-a)>0?(s=h,u=h-1):g=h+1}return s}function w(n,a,r,g,u){for(var s=g-1;g<=u;){var h=g+u>>>1,l=n[h];(r!==void 0?r(l,a):l-a)<0?(s=h,g=h+1):u=h-1}return s}function y(n,a,r,g,u){for(var s=g-1;g<=u;){var h=g+u>>>1,l=n[h];(r!==void 0?r(l,a):l-a)<=0?(s=h,g=h+1):u=h-1}return s}function e(n,a,r,g,u){for(;g<=u;){var s=g+u>>>1,h=n[s],l=r!==void 0?r(h,a):h-a;if(l===0)return s;l<=0?g=s+1:u=s-1}return-1}function t(n,a,r,g,u,s){return typeof r=="function"?s(n,a,r,g===void 0?0:0|g,u===void 0?n.length-1:0|u):s(n,a,void 0,r===void 0?0:0|r,g===void 0?n.length-1:0|g)}G.exports={ge:function(n,a,r,g,u){return t(n,a,r,g,u,d)},gt:function(n,a,r,g,u){return t(n,a,r,g,u,v)},lt:function(n,a,r,g,u){return t(n,a,r,g,u,w)},le:function(n,a,r,g,u){return t(n,a,r,g,u,y)},eq:function(n,a,r,g,u){return t(n,a,r,g,u,e)}}},{}],81:[function(m,G,W){function d(w){var y=32;return(w&=-w)&&y--,65535&w&&(y-=16),16711935&w&&(y-=8),252645135&w&&(y-=4),858993459&w&&(y-=2),1431655765&w&&(y-=1),y}W.INT_BITS=32,W.INT_MAX=2147483647,W.INT_MIN=-1<<31,W.sign=function(w){return(w>0)-(w<0)},W.abs=function(w){var y=w>>31;return(w^y)-y},W.min=function(w,y){return y^(w^y)&-(w<y)},W.max=function(w,y){return w^(w^y)&-(w<y)},W.isPow2=function(w){return!(w&w-1||!w)},W.log2=function(w){var y,e;return y=(w>65535)<<4,y|=e=((w>>>=y)>255)<<3,y|=e=((w>>>=e)>15)<<2,(y|=e=((w>>>=e)>3)<<1)|(w>>>=e)>>1},W.log10=function(w){return w>=1e9?9:w>=1e8?8:w>=1e7?7:w>=1e6?6:w>=1e5?5:w>=1e4?4:w>=1e3?3:w>=100?2:w>=10?1:0},W.popCount=function(w){return 16843009*((w=(858993459&(w-=w>>>1&1431655765))+(w>>>2&858993459))+(w>>>4)&252645135)>>>24},W.countTrailingZeros=d,W.nextPow2=function(w){return w+=w===0,--w,w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,(w|=w>>>16)+1},W.prevPow2=function(w){return w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,(w|=w>>>16)-(w>>>1)},W.parity=function(w){return w^=w>>>16,w^=w>>>8,w^=w>>>4,27030>>>(w&=15)&1};var v=new Array(256);(function(w){for(var y=0;y<256;++y){var e=y,t=y,n=7;for(e>>>=1;e;e>>>=1)t<<=1,t|=1&e,--n;w[y]=t<<n&255}})(v),W.reverse=function(w){return v[255&w]<<24|v[w>>>8&255]<<16|v[w>>>16&255]<<8|v[w>>>24&255]},W.interleave2=function(w,y){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w&=65535)|w<<8))|w<<4))|w<<2))|w<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},W.deinterleave2=function(w,y){return(w=65535&((w=16711935&((w=252645135&((w=858993459&((w=w>>>y&1431655765)|w>>>1))|w>>>2))|w>>>4))|w>>>16))<<16>>16},W.interleave3=function(w,y,e){return w=1227133513&((w=3272356035&((w=251719695&((w=4278190335&((w&=1023)|w<<16))|w<<8))|w<<4))|w<<2),(w|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},W.deinterleave3=function(w,y){return(w=1023&((w=4278190335&((w=251719695&((w=3272356035&((w=w>>>y&1227133513)|w>>>2))|w>>>4))|w>>>8))|w>>>16))<<22>>22},W.nextCombination=function(w){var y=w|w-1;return y+1|(~y&-~y)-1>>>d(w)+1}},{}],82:[function(m,G,W){var d=m("clamp");G.exports=function(e,t){t||(t={});var n,a,r,g,u,s,h,l,o,p,c,i=t.cutoff==null?.25:t.cutoff,x=t.radius==null?8:t.radius,f=t.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");n=t.width,a=t.height,g=e,s=t.stride?t.stride:Math.floor(e.length/n/a)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(h=(l=e).getContext("2d"),n=l.width,a=l.height,o=h.getImageData(0,0,n,a),g=o.data,s=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(l=e.canvas,h=e,n=l.width,a=l.height,o=h.getImageData(0,0,n,a),g=o.data,s=4):window.ImageData&&e instanceof window.ImageData&&(o=e,n=e.width,a=e.height,g=o.data,s=4);if(r=Math.max(n,a),window.Uint8ClampedArray&&g instanceof window.Uint8ClampedArray||window.Uint8Array&&g instanceof window.Uint8Array)for(u=g,g=Array(n*a),p=0,c=u.length;p<c;p++)g[p]=u[p*s+f]/255;else if(s!==1)throw Error("Raw data can have only 1 value per pixel");var _=Array(n*a),b=Array(n*a),T=Array(r),k=Array(r),L=Array(r+1),A=Array(r);for(p=0,c=n*a;p<c;p++){var I=g[p];_[p]=I===1?0:I===0?v:Math.pow(Math.max(0,.5-I),2),b[p]=I===1?v:I===0?0:Math.pow(Math.max(0,I-.5),2)}w(_,n,a,T,k,A,L),w(b,n,a,T,k,A,L);var P=window.Float32Array?new Float32Array(n*a):new Array(n*a);for(p=0,c=n*a;p<c;p++)P[p]=d(1-((_[p]-b[p])/x+i),0,1);return P};var v=1e20;function w(e,t,n,a,r,g,u){for(var s=0;s<t;s++){for(var h=0;h<n;h++)a[h]=e[h*t+s];for(y(a,r,g,u,n),h=0;h<n;h++)e[h*t+s]=r[h]}for(h=0;h<n;h++){for(s=0;s<t;s++)a[s]=e[h*t+s];for(y(a,r,g,u,t),s=0;s<t;s++)e[h*t+s]=Math.sqrt(r[s])}}function y(e,t,n,a,r){n[0]=0,a[0]=-v,a[1]=+v;for(var g=1,u=0;g<r;g++){for(var s=(e[g]+g*g-(e[n[u]]+n[u]*n[u]))/(2*g-2*n[u]);s<=a[u];)u--,s=(e[g]+g*g-(e[n[u]]+n[u]*n[u]))/(2*g-2*n[u]);n[++u]=g,a[u]=s,a[u+1]=+v}for(g=0,u=0;g<r;g++){for(;a[u+1]<g;)u++;t[g]=(g-n[u])*(g-n[u])+e[n[u]]}}},{clamp:86}],83:[function(m,G,W){},{}],84:[function(m,G,W){var d,v=typeof Reflect=="object"?Reflect:null,w=v&&typeof v.apply=="function"?v.apply:function(o,p,c){return Function.prototype.apply.call(o,p,c)};d=v&&typeof v.ownKeys=="function"?v.ownKeys:Object.getOwnPropertySymbols?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:function(o){return Object.getOwnPropertyNames(o)};var y=Number.isNaN||function(o){return o!=o};function e(){e.init.call(this)}G.exports=e,G.exports.once=function(o,p){return new Promise(function(c,i){function x(){f!==void 0&&o.removeListener("error",f),c([].slice.call(arguments))}var f;p!=="error"&&(f=function(_){o.removeListener(p,x),i(_)},o.once("error",f)),o.once(p,x)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var t=10;function n(o){if(typeof o!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof o)}function a(o){return o._maxListeners===void 0?e.defaultMaxListeners:o._maxListeners}function r(o,p,c,i){var x,f,_,b;if(n(c),(f=o._events)===void 0?(f=o._events=Object.create(null),o._eventsCount=0):(f.newListener!==void 0&&(o.emit("newListener",p,c.listener?c.listener:c),f=o._events),_=f[p]),_===void 0)_=f[p]=c,++o._eventsCount;else if(typeof _=="function"?_=f[p]=i?[c,_]:[_,c]:i?_.unshift(c):_.push(c),(x=a(o))>0&&_.length>x&&!_.warned){_.warned=!0;var T=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(p)+" listeners added. Use emitter.setMaxListeners() to increase limit");T.name="MaxListenersExceededWarning",T.emitter=o,T.type=p,T.count=_.length,b=T,console&&console.warn&&console.warn(b)}return o}function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(o,p,c){var i={fired:!1,wrapFn:void 0,target:o,type:p,listener:c},x=g.bind(i);return x.listener=c,i.wrapFn=x,x}function s(o,p,c){var i=o._events;if(i===void 0)return[];var x=i[p];return x===void 0?[]:typeof x=="function"?c?[x.listener||x]:[x]:c?function(f){for(var _=new Array(f.length),b=0;b<_.length;++b)_[b]=f[b].listener||f[b];return _}(x):l(x,x.length)}function h(o){var p=this._events;if(p!==void 0){var c=p[o];if(typeof c=="function")return 1;if(c!==void 0)return c.length}return 0}function l(o,p){for(var c=new Array(p),i=0;i<p;++i)c[i]=o[i];return c}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return t},set:function(o){if(typeof o!="number"||o<0||y(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");t=o}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(o){if(typeof o!="number"||o<0||y(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this},e.prototype.getMaxListeners=function(){return a(this)},e.prototype.emit=function(o){for(var p=[],c=1;c<arguments.length;c++)p.push(arguments[c]);var i=o==="error",x=this._events;if(x!==void 0)i=i&&x.error===void 0;else if(!i)return!1;if(i){var f;if(p.length>0&&(f=p[0]),f instanceof Error)throw f;var _=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw _.context=f,_}var b=x[o];if(b===void 0)return!1;if(typeof b=="function")w(b,this,p);else{var T=b.length,k=l(b,T);for(c=0;c<T;++c)w(k[c],this,p)}return!0},e.prototype.addListener=function(o,p){return r(this,o,p,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(o,p){return r(this,o,p,!0)},e.prototype.once=function(o,p){return n(p),this.on(o,u(this,o,p)),this},e.prototype.prependOnceListener=function(o,p){return n(p),this.prependListener(o,u(this,o,p)),this},e.prototype.removeListener=function(o,p){var c,i,x,f,_;if(n(p),(i=this._events)===void 0)return this;if((c=i[o])===void 0)return this;if(c===p||c.listener===p)--this._eventsCount==0?this._events=Object.create(null):(delete i[o],i.removeListener&&this.emit("removeListener",o,c.listener||p));else if(typeof c!="function"){for(x=-1,f=c.length-1;f>=0;f--)if(c[f]===p||c[f].listener===p){_=c[f].listener,x=f;break}if(x<0)return this;x===0?c.shift():function(b,T){for(;T+1<b.length;T++)b[T]=b[T+1];b.pop()}(c,x),c.length===1&&(i[o]=c[0]),i.removeListener!==void 0&&this.emit("removeListener",o,_||p)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(o){var p,c,i;if((c=this._events)===void 0)return this;if(c.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):c[o]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete c[o]),this;if(arguments.length===0){var x,f=Object.keys(c);for(i=0;i<f.length;++i)(x=f[i])!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(p=c[o])=="function")this.removeListener(o,p);else if(p!==void 0)for(i=p.length-1;i>=0;i--)this.removeListener(o,p[i]);return this},e.prototype.listeners=function(o){return s(this,o,!0)},e.prototype.rawListeners=function(o){return s(this,o,!1)},e.listenerCount=function(o,p){return typeof o.listenerCount=="function"?o.listenerCount(p):h.call(o,p)},e.prototype.listenerCount=h,e.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},{}],85:[function(m,G,W){(function(d){(function(){var v=m("base64-js"),w=m("ieee754");W.Buffer=e,W.SlowBuffer=function(H){return+H!=H&&(H=0),e.alloc(+H)},W.INSPECT_MAX_BYTES=50;function y(H){if(H>2147483647)throw new RangeError('The value "'+H+'" is invalid for option "size"');var N=new Uint8Array(H);return N.__proto__=e.prototype,N}function e(H,N,U){if(typeof H=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(H)}return t(H,N,U)}function t(H,N,U){if(typeof H=="string")return function(X,J){if(typeof J=="string"&&J!==""||(J="utf8"),!e.isEncoding(J))throw new TypeError("Unknown encoding: "+J);var ee=0|u(X,J),re=y(ee),se=re.write(X,J);return se!==ee&&(re=re.slice(0,se)),re}(H,N);if(ArrayBuffer.isView(H))return r(H);if(H==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if($(H,ArrayBuffer)||H&&$(H.buffer,ArrayBuffer))return function(X,J,ee){if(J<0||X.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(X.byteLength<J+(ee||0))throw new RangeError('"length" is outside of buffer bounds');var re;return re=J===void 0&&ee===void 0?new Uint8Array(X):ee===void 0?new Uint8Array(X,J):new Uint8Array(X,J,ee),re.__proto__=e.prototype,re}(H,N,U);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var te=H.valueOf&&H.valueOf();if(te!=null&&te!==H)return e.from(te,N,U);var B=function(X){if(e.isBuffer(X)){var J=0|g(X.length),ee=y(J);return ee.length===0||X.copy(ee,0,0,J),ee}if(X.length!==void 0)return typeof X.length!="number"||ne(X.length)?y(0):r(X);if(X.type==="Buffer"&&Array.isArray(X.data))return r(X.data)}(H);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return e.from(H[Symbol.toPrimitive]("string"),N,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}function n(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function a(H){return n(H),y(H<0?0:0|g(H))}function r(H){for(var N=H.length<0?0:0|g(H.length),U=y(N),te=0;te<N;te+=1)U[te]=255&H[te];return U}function g(H){if(H>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|H}function u(H,N){if(e.isBuffer(H))return H.length;if(ArrayBuffer.isView(H)||$(H,ArrayBuffer))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);var U=H.length,te=arguments.length>2&&arguments[2]===!0;if(!te&&U===0)return 0;for(var B=!1;;)switch(N){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return Z(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*U;case"hex":return U>>>1;case"base64":return Q(H).length;default:if(B)return te?-1:Z(H).length;N=(""+N).toLowerCase(),B=!0}}function s(H,N,U){var te=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0)<=(N>>>=0))return"";for(H||(H="utf8");;)switch(H){case"hex":return A(this,N,U);case"utf8":case"utf-8":return T(this,N,U);case"ascii":return k(this,N,U);case"latin1":case"binary":return L(this,N,U);case"base64":return b(this,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,N,U);default:if(te)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),te=!0}}function h(H,N,U){var te=H[N];H[N]=H[U],H[U]=te}function l(H,N,U,te,B){if(H.length===0)return-1;if(typeof U=="string"?(te=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),ne(U=+U)&&(U=B?0:H.length-1),U<0&&(U=H.length+U),U>=H.length){if(B)return-1;U=H.length-1}else if(U<0){if(!B)return-1;U=0}if(typeof N=="string"&&(N=e.from(N,te)),e.isBuffer(N))return N.length===0?-1:o(H,N,U,te,B);if(typeof N=="number")return N&=255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(H,N,U):Uint8Array.prototype.lastIndexOf.call(H,N,U):o(H,[N],U,te,B);throw new TypeError("val must be string, number or Buffer")}function o(H,N,U,te,B){var X,J=1,ee=H.length,re=N.length;if(te!==void 0&&((te=String(te).toLowerCase())==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(H.length<2||N.length<2)return-1;J=2,ee/=2,re/=2,U/=2}function se(ve,Ae){return J===1?ve[Ae]:ve.readUInt16BE(Ae*J)}if(B){var oe=-1;for(X=U;X<ee;X++)if(se(H,X)===se(N,oe===-1?0:X-oe)){if(oe===-1&&(oe=X),X-oe+1===re)return oe*J}else oe!==-1&&(X-=X-oe),oe=-1}else for(U+re>ee&&(U=ee-re),X=U;X>=0;X--){for(var de=!0,ce=0;ce<re;ce++)if(se(H,X+ce)!==se(N,ce)){de=!1;break}if(de)return X}return-1}function p(H,N,U,te){U=Number(U)||0;var B=H.length-U;te?(te=Number(te))>B&&(te=B):te=B;var X=N.length;te>X/2&&(te=X/2);for(var J=0;J<te;++J){var ee=parseInt(N.substr(2*J,2),16);if(ne(ee))return J;H[U+J]=ee}return J}function c(H,N,U,te){return K(Z(N,H.length-U),H,U,te)}function i(H,N,U,te){return K(function(B){for(var X=[],J=0;J<B.length;++J)X.push(255&B.charCodeAt(J));return X}(N),H,U,te)}function x(H,N,U,te){return i(H,N,U,te)}function f(H,N,U,te){return K(Q(N),H,U,te)}function _(H,N,U,te){return K(function(B,X){for(var J,ee,re,se=[],oe=0;oe<B.length&&!((X-=2)<0);++oe)J=B.charCodeAt(oe),ee=J>>8,re=J%256,se.push(re),se.push(ee);return se}(N,H.length-U),H,U,te)}function b(H,N,U){return N===0&&U===H.length?v.fromByteArray(H):v.fromByteArray(H.slice(N,U))}function T(H,N,U){U=Math.min(H.length,U);for(var te=[],B=N;B<U;){var X,J,ee,re,se=H[B],oe=null,de=se>239?4:se>223?3:se>191?2:1;if(B+de<=U)switch(de){case 1:se<128&&(oe=se);break;case 2:(192&(X=H[B+1]))==128&&(re=(31&se)<<6|63&X)>127&&(oe=re);break;case 3:X=H[B+1],J=H[B+2],(192&X)==128&&(192&J)==128&&(re=(15&se)<<12|(63&X)<<6|63&J)>2047&&(re<55296||re>57343)&&(oe=re);break;case 4:X=H[B+1],J=H[B+2],ee=H[B+3],(192&X)==128&&(192&J)==128&&(192&ee)==128&&(re=(15&se)<<18|(63&X)<<12|(63&J)<<6|63&ee)>65535&&re<1114112&&(oe=re)}oe===null?(oe=65533,de=1):oe>65535&&(oe-=65536,te.push(oe>>>10&1023|55296),oe=56320|1023&oe),te.push(oe),B+=de}return function(ce){var ve=ce.length;if(ve<=4096)return String.fromCharCode.apply(String,ce);for(var Ae="",fe=0;fe<ve;)Ae+=String.fromCharCode.apply(String,ce.slice(fe,fe+=4096));return Ae}(te)}W.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var H=new Uint8Array(1);return H.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},H.foo()===42}catch{return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(H,N,U){return t(H,N,U)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(H,N,U){return function(te,B,X){return n(te),te<=0?y(te):B!==void 0?typeof X=="string"?y(te).fill(B,X):y(te).fill(B):y(te)}(H,N,U)},e.allocUnsafe=function(H){return a(H)},e.allocUnsafeSlow=function(H){return a(H)},e.isBuffer=function(H){return H!=null&&H._isBuffer===!0&&H!==e.prototype},e.compare=function(H,N){if($(H,Uint8Array)&&(H=e.from(H,H.offset,H.byteLength)),$(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),!e.isBuffer(H)||!e.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(H===N)return 0;for(var U=H.length,te=N.length,B=0,X=Math.min(U,te);B<X;++B)if(H[B]!==N[B]){U=H[B],te=N[B];break}return U<te?-1:te<U?1:0},e.isEncoding=function(H){switch(String(H).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(H,N){if(!Array.isArray(H))throw new TypeError('"list" argument must be an Array of Buffers');if(H.length===0)return e.alloc(0);var U;if(N===void 0)for(N=0,U=0;U<H.length;++U)N+=H[U].length;var te=e.allocUnsafe(N),B=0;for(U=0;U<H.length;++U){var X=H[U];if($(X,Uint8Array)&&(X=e.from(X)),!e.isBuffer(X))throw new TypeError('"list" argument must be an Array of Buffers');X.copy(te,B),B+=X.length}return te},e.byteLength=u,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var H=this.length;if(H%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<H;N+=2)h(this,N,N+1);return this},e.prototype.swap32=function(){var H=this.length;if(H%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<H;N+=4)h(this,N,N+3),h(this,N+1,N+2);return this},e.prototype.swap64=function(){var H=this.length;if(H%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<H;N+=8)h(this,N,N+7),h(this,N+1,N+6),h(this,N+2,N+5),h(this,N+3,N+4);return this},e.prototype.toString=function(){var H=this.length;return H===0?"":arguments.length===0?T(this,0,H):s.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(H){if(!e.isBuffer(H))throw new TypeError("Argument must be a Buffer");return this===H||e.compare(this,H)===0},e.prototype.inspect=function(){var H="",N=W.INSPECT_MAX_BYTES;return H=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(H+=" ... "),"<Buffer "+H+">"},e.prototype.compare=function(H,N,U,te,B){if($(H,Uint8Array)&&(H=e.from(H,H.offset,H.byteLength)),!e.isBuffer(H))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof H);if(N===void 0&&(N=0),U===void 0&&(U=H?H.length:0),te===void 0&&(te=0),B===void 0&&(B=this.length),N<0||U>H.length||te<0||B>this.length)throw new RangeError("out of range index");if(te>=B&&N>=U)return 0;if(te>=B)return-1;if(N>=U)return 1;if(this===H)return 0;for(var X=(B>>>=0)-(te>>>=0),J=(U>>>=0)-(N>>>=0),ee=Math.min(X,J),re=this.slice(te,B),se=H.slice(N,U),oe=0;oe<ee;++oe)if(re[oe]!==se[oe]){X=re[oe],J=se[oe];break}return X<J?-1:J<X?1:0},e.prototype.includes=function(H,N,U){return this.indexOf(H,N,U)!==-1},e.prototype.indexOf=function(H,N,U){return l(this,H,N,U,!0)},e.prototype.lastIndexOf=function(H,N,U){return l(this,H,N,U,!1)},e.prototype.write=function(H,N,U,te){if(N===void 0)te="utf8",U=this.length,N=0;else if(U===void 0&&typeof N=="string")te=N,U=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(U)?(U>>>=0,te===void 0&&(te="utf8")):(te=U,U=void 0)}var B=this.length-N;if((U===void 0||U>B)&&(U=B),H.length>0&&(U<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");te||(te="utf8");for(var X=!1;;)switch(te){case"hex":return p(this,H,N,U);case"utf8":case"utf-8":return c(this,H,N,U);case"ascii":return i(this,H,N,U);case"latin1":case"binary":return x(this,H,N,U);case"base64":return f(this,H,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,H,N,U);default:if(X)throw new TypeError("Unknown encoding: "+te);te=(""+te).toLowerCase(),X=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(H,N,U){var te="";U=Math.min(H.length,U);for(var B=N;B<U;++B)te+=String.fromCharCode(127&H[B]);return te}function L(H,N,U){var te="";U=Math.min(H.length,U);for(var B=N;B<U;++B)te+=String.fromCharCode(H[B]);return te}function A(H,N,U){var te=H.length;(!N||N<0)&&(N=0),(!U||U<0||U>te)&&(U=te);for(var B="",X=N;X<U;++X)B+=V(H[X]);return B}function I(H,N,U){for(var te=H.slice(N,U),B="",X=0;X<te.length;X+=2)B+=String.fromCharCode(te[X]+256*te[X+1]);return B}function P(H,N,U){if(H%1!=0||H<0)throw new RangeError("offset is not uint");if(H+N>U)throw new RangeError("Trying to access beyond buffer length")}function S(H,N,U,te,B,X){if(!e.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>B||N<X)throw new RangeError('"value" argument is out of bounds');if(U+te>H.length)throw new RangeError("Index out of range")}function E(H,N,U,te,B,X){if(U+te>H.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function z(H,N,U,te,B){return N=+N,U>>>=0,B||E(H,0,U,4),w.write(H,N,U,te,23,4),U+4}function D(H,N,U,te,B){return N=+N,U>>>=0,B||E(H,0,U,8),w.write(H,N,U,te,52,8),U+8}e.prototype.slice=function(H,N){var U=this.length;(H=~~H)<0?(H+=U)<0&&(H=0):H>U&&(H=U),(N=N===void 0?U:~~N)<0?(N+=U)<0&&(N=0):N>U&&(N=U),N<H&&(N=H);var te=this.subarray(H,N);return te.__proto__=e.prototype,te},e.prototype.readUIntLE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H],B=1,X=0;++X<N&&(B*=256);)te+=this[H+X]*B;return te},e.prototype.readUIntBE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H+--N],B=1;N>0&&(B*=256);)te+=this[H+--N]*B;return te},e.prototype.readUInt8=function(H,N){return H>>>=0,N||P(H,1,this.length),this[H]},e.prototype.readUInt16LE=function(H,N){return H>>>=0,N||P(H,2,this.length),this[H]|this[H+1]<<8},e.prototype.readUInt16BE=function(H,N){return H>>>=0,N||P(H,2,this.length),this[H]<<8|this[H+1]},e.prototype.readUInt32LE=function(H,N){return H>>>=0,N||P(H,4,this.length),(this[H]|this[H+1]<<8|this[H+2]<<16)+16777216*this[H+3]},e.prototype.readUInt32BE=function(H,N){return H>>>=0,N||P(H,4,this.length),16777216*this[H]+(this[H+1]<<16|this[H+2]<<8|this[H+3])},e.prototype.readIntLE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H],B=1,X=0;++X<N&&(B*=256);)te+=this[H+X]*B;return te>=(B*=128)&&(te-=Math.pow(2,8*N)),te},e.prototype.readIntBE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=N,B=1,X=this[H+--te];te>0&&(B*=256);)X+=this[H+--te]*B;return X>=(B*=128)&&(X-=Math.pow(2,8*N)),X},e.prototype.readInt8=function(H,N){return H>>>=0,N||P(H,1,this.length),128&this[H]?-1*(255-this[H]+1):this[H]},e.prototype.readInt16LE=function(H,N){H>>>=0,N||P(H,2,this.length);var U=this[H]|this[H+1]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt16BE=function(H,N){H>>>=0,N||P(H,2,this.length);var U=this[H+1]|this[H]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt32LE=function(H,N){return H>>>=0,N||P(H,4,this.length),this[H]|this[H+1]<<8|this[H+2]<<16|this[H+3]<<24},e.prototype.readInt32BE=function(H,N){return H>>>=0,N||P(H,4,this.length),this[H]<<24|this[H+1]<<16|this[H+2]<<8|this[H+3]},e.prototype.readFloatLE=function(H,N){return H>>>=0,N||P(H,4,this.length),w.read(this,H,!0,23,4)},e.prototype.readFloatBE=function(H,N){return H>>>=0,N||P(H,4,this.length),w.read(this,H,!1,23,4)},e.prototype.readDoubleLE=function(H,N){return H>>>=0,N||P(H,8,this.length),w.read(this,H,!0,52,8)},e.prototype.readDoubleBE=function(H,N){return H>>>=0,N||P(H,8,this.length),w.read(this,H,!1,52,8)},e.prototype.writeUIntLE=function(H,N,U,te){H=+H,N>>>=0,U>>>=0,te||S(this,H,N,U,Math.pow(2,8*U)-1,0);var B=1,X=0;for(this[N]=255&H;++X<U&&(B*=256);)this[N+X]=H/B&255;return N+U},e.prototype.writeUIntBE=function(H,N,U,te){H=+H,N>>>=0,U>>>=0,te||S(this,H,N,U,Math.pow(2,8*U)-1,0);var B=U-1,X=1;for(this[N+B]=255&H;--B>=0&&(X*=256);)this[N+B]=H/X&255;return N+U},e.prototype.writeUInt8=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,1,255,0),this[N]=255&H,N+1},e.prototype.writeUInt16LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,65535,0),this[N]=255&H,this[N+1]=H>>>8,N+2},e.prototype.writeUInt16BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,65535,0),this[N]=H>>>8,this[N+1]=255&H,N+2},e.prototype.writeUInt32LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,4294967295,0),this[N+3]=H>>>24,this[N+2]=H>>>16,this[N+1]=H>>>8,this[N]=255&H,N+4},e.prototype.writeUInt32BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,4294967295,0),this[N]=H>>>24,this[N+1]=H>>>16,this[N+2]=H>>>8,this[N+3]=255&H,N+4},e.prototype.writeIntLE=function(H,N,U,te){if(H=+H,N>>>=0,!te){var B=Math.pow(2,8*U-1);S(this,H,N,U,B-1,-B)}var X=0,J=1,ee=0;for(this[N]=255&H;++X<U&&(J*=256);)H<0&&ee===0&&this[N+X-1]!==0&&(ee=1),this[N+X]=(H/J>>0)-ee&255;return N+U},e.prototype.writeIntBE=function(H,N,U,te){if(H=+H,N>>>=0,!te){var B=Math.pow(2,8*U-1);S(this,H,N,U,B-1,-B)}var X=U-1,J=1,ee=0;for(this[N+X]=255&H;--X>=0&&(J*=256);)H<0&&ee===0&&this[N+X+1]!==0&&(ee=1),this[N+X]=(H/J>>0)-ee&255;return N+U},e.prototype.writeInt8=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,1,127,-128),H<0&&(H=255+H+1),this[N]=255&H,N+1},e.prototype.writeInt16LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,32767,-32768),this[N]=255&H,this[N+1]=H>>>8,N+2},e.prototype.writeInt16BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,32767,-32768),this[N]=H>>>8,this[N+1]=255&H,N+2},e.prototype.writeInt32LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,2147483647,-2147483648),this[N]=255&H,this[N+1]=H>>>8,this[N+2]=H>>>16,this[N+3]=H>>>24,N+4},e.prototype.writeInt32BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,2147483647,-2147483648),H<0&&(H=4294967295+H+1),this[N]=H>>>24,this[N+1]=H>>>16,this[N+2]=H>>>8,this[N+3]=255&H,N+4},e.prototype.writeFloatLE=function(H,N,U){return z(this,H,N,!0,U)},e.prototype.writeFloatBE=function(H,N,U){return z(this,H,N,!1,U)},e.prototype.writeDoubleLE=function(H,N,U){return D(this,H,N,!0,U)},e.prototype.writeDoubleBE=function(H,N,U){return D(this,H,N,!1,U)},e.prototype.copy=function(H,N,U,te){if(!e.isBuffer(H))throw new TypeError("argument should be a Buffer");if(U||(U=0),te||te===0||(te=this.length),N>=H.length&&(N=H.length),N||(N=0),te>0&&te<U&&(te=U),te===U||H.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("sourceEnd out of bounds");te>this.length&&(te=this.length),H.length-N<te-U&&(te=H.length-N+U);var B=te-U;if(this===H&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(N,U,te);else if(this===H&&U<N&&N<te)for(var X=B-1;X>=0;--X)H[X+N]=this[X+U];else Uint8Array.prototype.set.call(H,this.subarray(U,te),N);return B},e.prototype.fill=function(H,N,U,te){if(typeof H=="string"){if(typeof N=="string"?(te=N,N=0,U=this.length):typeof U=="string"&&(te=U,U=this.length),te!==void 0&&typeof te!="string")throw new TypeError("encoding must be a string");if(typeof te=="string"&&!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);if(H.length===1){var B=H.charCodeAt(0);(te==="utf8"&&B<128||te==="latin1")&&(H=B)}}else typeof H=="number"&&(H&=255);if(N<0||this.length<N||this.length<U)throw new RangeError("Out of range index");if(U<=N)return this;var X;if(N>>>=0,U=U===void 0?this.length:U>>>0,H||(H=0),typeof H=="number")for(X=N;X<U;++X)this[X]=H;else{var J=e.isBuffer(H)?H:e.from(H,te),ee=J.length;if(ee===0)throw new TypeError('The value "'+H+'" is invalid for argument "value"');for(X=0;X<U-N;++X)this[X+N]=J[X%ee]}return this};var j=/[^+/0-9A-Za-z-_]/g;function V(H){return H<16?"0"+H.toString(16):H.toString(16)}function Z(H,N){var U;N=N||1/0;for(var te=H.length,B=null,X=[],J=0;J<te;++J){if((U=H.charCodeAt(J))>55295&&U<57344){if(!B){if(U>56319){(N-=3)>-1&&X.push(239,191,189);continue}if(J+1===te){(N-=3)>-1&&X.push(239,191,189);continue}B=U;continue}if(U<56320){(N-=3)>-1&&X.push(239,191,189),B=U;continue}U=65536+(B-55296<<10|U-56320)}else B&&(N-=3)>-1&&X.push(239,191,189);if(B=null,U<128){if((N-=1)<0)break;X.push(U)}else if(U<2048){if((N-=2)<0)break;X.push(U>>6|192,63&U|128)}else if(U<65536){if((N-=3)<0)break;X.push(U>>12|224,U>>6&63|128,63&U|128)}else{if(!(U<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;X.push(U>>18|240,U>>12&63|128,U>>6&63|128,63&U|128)}}return X}function Q(H){return v.toByteArray(function(N){if((N=(N=N.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N}(H))}function K(H,N,U,te){for(var B=0;B<te&&!(B+U>=N.length||B>=H.length);++B)N[B+U]=H[B];return B}function $(H,N){return H instanceof N||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===N.name}function ne(H){return H!=H}}).call(this)}).call(this,m("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(m,G,W){G.exports=function(d,v,w){return v<w?d<v?v:d>w?w:d:d<w?w:d>v?v:d}},{}],87:[function(m,G,W){var d=m("clamp");function v(w,y){y==null&&(y=!0);var e=w[0],t=w[1],n=w[2],a=w[3];return a==null&&(a=y?1:255),y&&(e*=255,t*=255,n*=255,a*=255),16777216*(e=255&d(e,0,255))+((t=255&d(t,0,255))<<16)+((n=255&d(n,0,255))<<8)+(a=255&d(a,0,255))}G.exports=v,G.exports.to=v,G.exports.from=function(w,y){var e=(w=+w)>>>24,t=(16711680&w)>>>16,n=(65280&w)>>>8,a=255&w;return y===!1?[e,t,n,a]:[e/255,t/255,n/255,a/255]}},{clamp:86}],88:[function(m,G,W){G.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(m,G,W){var d=m("color-rgba"),v=m("clamp"),w=m("dtype");G.exports=function(y,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var t=new(w(e))(4),n=e!=="uint8"&&e!=="uint8_clamped";return y.length&&typeof y!="string"||((y=d(y))[0]/=255,y[1]/=255,y[2]/=255),function(a){return a instanceof Uint8Array||a instanceof Uint8ClampedArray||!!(Array.isArray(a)&&(a[0]>1||a[0]===0)&&(a[1]>1||a[1]===0)&&(a[2]>1||a[2]===0)&&(!a[3]||a[3]>1))}(y)?(t[0]=y[0],t[1]=y[1],t[2]=y[2],t[3]=y[3]!=null?y[3]:255,n&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(n?(t[0]=y[0],t[1]=y[1],t[2]=y[2],t[3]=y[3]!=null?y[3]:1):(t[0]=v(Math.floor(255*y[0]),0,255),t[1]=v(Math.floor(255*y[1]),0,255),t[2]=v(Math.floor(255*y[2]),0,255),t[3]=y[3]==null?255:v(Math.floor(255*y[3]),0,255)),t)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(m,G,W){(function(d){(function(){var v=m("color-name"),w=m("is-plain-obj"),y=m("defined");G.exports=function(t){var n,a,r=[],g=1;if(typeof t=="string")if(v[t])r=v[t].slice(),a="rgb";else if(t==="transparent")g=0,a="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var u=(l=t.slice(1)).length;g=1,u<=4?(r=[parseInt(l[0]+l[0],16),parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16)],u===4&&(g=parseInt(l[3]+l[3],16)/255)):(r=[parseInt(l[0]+l[1],16),parseInt(l[2]+l[3],16),parseInt(l[4]+l[5],16)],u===8&&(g=parseInt(l[6]+l[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),a="rgb"}else if(n=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var s=n[1],h=s==="rgb",l=s.replace(/a$/,"");a=l,u=l==="cmyk"?4:l==="gray"?1:3,r=n[2].trim().split(/\s*,\s*/).map(function(p,c){if(/%$/.test(p))return c===u?parseFloat(p)/100:l==="rgb"?255*parseFloat(p)/100:parseFloat(p);if(l[c]==="h"){if(/deg$/.test(p))return parseFloat(p);if(e[p]!==void 0)return e[p]}return parseFloat(p)}),s===l&&r.push(1),g=h||r[u]===void 0?1:r[u],r=r.slice(0,u)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(r=t.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),a=t.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(t))if(w(t)){var o=y(t.r,t.red,t.R,null);o!==null?(a="rgb",r=[o,y(t.g,t.green,t.G),y(t.b,t.blue,t.B)]):(a="hsl",r=[y(t.h,t.hue,t.H),y(t.s,t.saturation,t.S),y(t.l,t.lightness,t.L,t.b,t.brightness)]),g=y(t.a,t.alpha,t.opacity,1),t.opacity!=null&&(g/=100)}else(Array.isArray(t)||d.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t))&&(r=[t[0],t[1],t[2]],a="rgb",g=t.length===4?t[3]:1);else a="rgb",r=[t>>>16,(65280&t)>>>8,255&t];return{space:a,values:r,alpha:g}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(m,G,W){var d=m("color-parse"),v=m("color-space/hsl"),w=m("clamp");G.exports=function(y){var e,t=d(y);return t.space?((e=Array(3))[0]=w(t.values[0],0,255),e[1]=w(t.values[1],0,255),e[2]=w(t.values[2],0,255),t.space[0]==="h"&&(e=v.rgb(e)),e.push(w(t.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(m,G,W){var d=m("./rgb");G.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(v){var w,y,e,t,n,a=v[0]/360,r=v[1]/100,g=v[2]/100;if(r===0)return[n=255*g,n,n];w=2*g-(y=g<.5?g*(1+r):g+r-g*r),t=[0,0,0];for(var u=0;u<3;u++)(e=a+1/3*-(u-1))<0?e++:e>1&&e--,n=6*e<1?w+6*(y-w)*e:2*e<1?y:3*e<2?w+(y-w)*(2/3-e)*6:w,t[u]=255*n;return t}},d.hsl=function(v){var w,y,e=v[0]/255,t=v[1]/255,n=v[2]/255,a=Math.min(e,t,n),r=Math.max(e,t,n),g=r-a;return r===a?w=0:e===r?w=(t-n)/g:t===r?w=2+(n-e)/g:n===r&&(w=4+(e-t)/g),(w=Math.min(60*w,360))<0&&(w+=360),y=(a+r)/2,[w,100*(r===a?0:y<=.5?g/(r+a):g/(2-r-a)),100*y]}},{"./rgb":93}],93:[function(m,G,W){G.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(m,G,W){G.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(m,G,W){G.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(m,G,W){G.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(m,G,W){G.exports=["normal","italic","oblique"]},{}],98:[function(m,G,W){G.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(m,G,W){G.exports={parse:m("./parse"),stringify:m("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(m,G,W){var d=m("css-font-size-keywords");G.exports={isSize:function(v){return/^[\d\.]/.test(v)||v.indexOf("/")!==-1||d.indexOf(v)!==-1}}},{"css-font-size-keywords":95}],101:[function(m,G,W){var d=m("unquote"),v=m("css-global-keywords"),w=m("css-system-font-keywords"),y=m("css-font-weight-keywords"),e=m("css-font-style-keywords"),t=m("css-font-stretch-keywords"),n=m("string-split-by"),a=m("./lib/util").isSize;G.exports=g;var r=g.cache={};function g(s){if(typeof s!="string")throw new Error("Font argument must be a string.");if(r[s])return r[s];if(s==="")throw new Error("Cannot parse an empty string.");if(w.indexOf(s)!==-1)return r[s]={system:s};for(var h,l={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},o=n(s,/\s+/);h=o.shift();){if(v.indexOf(h)!==-1)return["style","variant","weight","stretch"].forEach(function(c){l[c]=h}),r[s]=l;if(e.indexOf(h)===-1)if(h!=="normal"&&h!=="small-caps")if(t.indexOf(h)===-1){if(y.indexOf(h)===-1){if(a(h)){var p=n(h,"/");if(l.size=p[0],p[1]!=null?l.lineHeight=u(p[1]):o[0]==="/"&&(o.shift(),l.lineHeight=u(o.shift())),!o.length)throw new Error("Missing required font-family.");return l.family=n(o.join(" "),/\s*,\s*/).map(d),r[s]=l}throw new Error("Unknown or unsupported font token: "+h)}l.weight=h}else l.stretch=h;else l.variant=h;else l.style=h}throw new Error("Missing required font-size.")}function u(s){var h=parseFloat(s);return h.toString()===s?h:s}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(m,G,W){var d=m("pick-by-alias"),v=m("./lib/util").isSize,w=h(m("css-global-keywords")),y=h(m("css-system-font-keywords")),e=h(m("css-font-weight-keywords")),t=h(m("css-font-style-keywords")),n=h(m("css-font-stretch-keywords")),a={normal:1,"small-caps":1},r={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},g="1rem",u="serif";function s(l,o){if(l&&!o[l]&&!w[l])throw Error("Unknown keyword `"+l+"`");return l}function h(l){for(var o={},p=0;p<l.length;p++)o[l[p]]=1;return o}G.exports=function(l){if((l=d(l,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return l.system&&s(l.system,y),l.system;if(s(l.style,t),s(l.variant,a),s(l.weight,e),s(l.stretch,n),l.size==null&&(l.size=g),typeof l.size=="number"&&(l.size+="px"),!v)throw Error("Bad size value `"+l.size+"`");l.family||(l.family=u),Array.isArray(l.family)&&(l.family.length||(l.family=[u]),l.family=l.family.map(function(p){return r[p]?p:'"'+p+'"'}).join(", "));var o=[];return o.push(l.style),l.variant!==l.style&&o.push(l.variant),l.weight!==l.variant&&l.weight!==l.style&&o.push(l.weight),l.stretch!==l.weight&&l.stretch!==l.variant&&l.stretch!==l.style&&o.push(l.stretch),o.push(l.size+(l.lineHeight==null||l.lineHeight==="normal"||l.lineHeight+""=="1"?"":"/"+l.lineHeight)),o.push(l.family),o.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(m,G,W){G.exports=["inherit","initial","unset"]},{}],104:[function(m,G,W){G.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(m,G,W){var d,v=m("type/value/is"),w=m("type/value/ensure"),y=m("type/plain-function/ensure"),e=m("es5-ext/object/copy"),t=m("es5-ext/object/normalize-options"),n=m("es5-ext/object/map"),a=Function.prototype.bind,r=Object.defineProperty,g=Object.prototype.hasOwnProperty;d=function(u,s,h){var l,o=w(s)&&y(s.value);return delete(l=e(s)).writable,delete l.value,l.get=function(){return!h.overwriteDefinition&&g.call(this,u)?o:(s.value=a.call(o,h.resolveContext?h.resolveContext(this):this),r(this,u,s),this[u])},l},G.exports=function(u){var s=t(arguments[1]);return v(s.resolveContext)&&y(s.resolveContext),n(u,function(h,l){return d(l,h,s)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(m,G,W){var d=m("type/value/is"),v=m("type/plain-function/is"),w=m("es5-ext/object/assign"),y=m("es5-ext/object/normalize-options"),e=m("es5-ext/string/#/contains");(G.exports=function(t,n){var a,r,g,u,s;return arguments.length<2||typeof t!="string"?(u=n,n=t,t=null):u=arguments[2],d(t)?(a=e.call(t,"c"),r=e.call(t,"e"),g=e.call(t,"w")):(a=g=!0,r=!1),s={value:n,configurable:a,enumerable:r,writable:g},u?w(y(u),s):s}).gs=function(t,n,a){var r,g,u,s;return typeof t!="string"?(u=a,a=n,n=t,t=null):u=arguments[3],d(n)?v(n)?d(a)?v(a)||(u=a,a=void 0):a=void 0:(u=n,n=a=void 0):n=void 0,d(t)?(r=e.call(t,"c"),g=e.call(t,"e")):(r=!0,g=!1),s={get:n,set:a,configurable:r,enumerable:g},u?w(y(u),s):s}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:d.d3=d.d3||{})})(this,function(d){function v(P,S){return P<S?-1:P>S?1:P>=S?0:NaN}function w(P){var S;return P.length===1&&(S=P,P=function(E,z){return v(S(E),z)}),{left:function(E,z,D,j){for(D==null&&(D=0),j==null&&(j=E.length);D<j;){var V=D+j>>>1;P(E[V],z)<0?D=V+1:j=V}return D},right:function(E,z,D,j){for(D==null&&(D=0),j==null&&(j=E.length);D<j;){var V=D+j>>>1;P(E[V],z)>0?j=V:D=V+1}return D}}}var y=w(v),e=y.right,t=y.left;function n(P,S){return[P,S]}function a(P){return P===null?NaN:+P}function r(P,S){var E,z,D=P.length,j=0,V=-1,Z=0,Q=0;if(S==null)for(;++V<D;)isNaN(E=a(P[V]))||(Q+=(z=E-Z)*(E-(Z+=z/++j)));else for(;++V<D;)isNaN(E=a(S(P[V],V,P)))||(Q+=(z=E-Z)*(E-(Z+=z/++j)));if(j>1)return Q/(j-1)}function g(P,S){var E=r(P,S);return E&&Math.sqrt(E)}function u(P,S){var E,z,D,j=P.length,V=-1;if(S==null){for(;++V<j;)if((E=P[V])!=null&&E>=E)for(z=D=E;++V<j;)(E=P[V])!=null&&(z>E&&(z=E),D<E&&(D=E))}else for(;++V<j;)if((E=S(P[V],V,P))!=null&&E>=E)for(z=D=E;++V<j;)(E=S(P[V],V,P))!=null&&(z>E&&(z=E),D<E&&(D=E));return[z,D]}var s=Array.prototype,h=s.slice,l=s.map;function o(P){return function(){return P}}function p(P){return P}function c(P,S,E){P=+P,S=+S,E=(D=arguments.length)<2?(S=P,P=0,1):D<3?1:+E;for(var z=-1,D=0|Math.max(0,Math.ceil((S-P)/E)),j=new Array(D);++z<D;)j[z]=P+z*E;return j}var i=Math.sqrt(50),x=Math.sqrt(10),f=Math.sqrt(2);function _(P,S,E){var z=(S-P)/Math.max(0,E),D=Math.floor(Math.log(z)/Math.LN10),j=z/Math.pow(10,D);return D>=0?(j>=i?10:j>=x?5:j>=f?2:1)*Math.pow(10,D):-Math.pow(10,-D)/(j>=i?10:j>=x?5:j>=f?2:1)}function b(P,S,E){var z=Math.abs(S-P)/Math.max(0,E),D=Math.pow(10,Math.floor(Math.log(z)/Math.LN10)),j=z/D;return j>=i?D*=10:j>=x?D*=5:j>=f&&(D*=2),S<P?-D:D}function T(P){return Math.ceil(Math.log(P.length)/Math.LN2)+1}function k(P,S,E){if(E==null&&(E=a),z=P.length){if((S=+S)<=0||z<2)return+E(P[0],0,P);if(S>=1)return+E(P[z-1],z-1,P);var z,D=(z-1)*S,j=Math.floor(D),V=+E(P[j],j,P);return V+(+E(P[j+1],j+1,P)-V)*(D-j)}}function L(P,S){var E,z,D=P.length,j=-1;if(S==null){for(;++j<D;)if((E=P[j])!=null&&E>=E)for(z=E;++j<D;)(E=P[j])!=null&&z>E&&(z=E)}else for(;++j<D;)if((E=S(P[j],j,P))!=null&&E>=E)for(z=E;++j<D;)(E=S(P[j],j,P))!=null&&z>E&&(z=E);return z}function A(P){if(!(D=P.length))return[];for(var S=-1,E=L(P,I),z=new Array(E);++S<E;)for(var D,j=-1,V=z[S]=new Array(D);++j<D;)V[j]=P[j][S];return z}function I(P){return P.length}d.bisect=e,d.bisectRight=e,d.bisectLeft=t,d.ascending=v,d.bisector=w,d.cross=function(P,S,E){var z,D,j,V,Z=P.length,Q=S.length,K=new Array(Z*Q);for(E==null&&(E=n),z=j=0;z<Z;++z)for(V=P[z],D=0;D<Q;++D,++j)K[j]=E(V,S[D]);return K},d.descending=function(P,S){return S<P?-1:S>P?1:S>=P?0:NaN},d.deviation=g,d.extent=u,d.histogram=function(){var P=p,S=u,E=T;function z(D){var j,V,Z=D.length,Q=new Array(Z);for(j=0;j<Z;++j)Q[j]=P(D[j],j,D);var K=S(Q),$=K[0],ne=K[1],H=E(Q,$,ne);Array.isArray(H)||(H=b($,ne,H),H=c(Math.ceil($/H)*H,ne,H));for(var N=H.length;H[0]<=$;)H.shift(),--N;for(;H[N-1]>ne;)H.pop(),--N;var U,te=new Array(N+1);for(j=0;j<=N;++j)(U=te[j]=[]).x0=j>0?H[j-1]:$,U.x1=j<N?H[j]:ne;for(j=0;j<Z;++j)$<=(V=Q[j])&&V<=ne&&te[e(H,V,0,N)].push(D[j]);return te}return z.value=function(D){return arguments.length?(P=typeof D=="function"?D:o(D),z):P},z.domain=function(D){return arguments.length?(S=typeof D=="function"?D:o([D[0],D[1]]),z):S},z.thresholds=function(D){return arguments.length?(E=typeof D=="function"?D:Array.isArray(D)?o(h.call(D)):o(D),z):E},z},d.thresholdFreedmanDiaconis=function(P,S,E){return P=l.call(P,a).sort(v),Math.ceil((E-S)/(2*(k(P,.75)-k(P,.25))*Math.pow(P.length,-1/3)))},d.thresholdScott=function(P,S,E){return Math.ceil((E-S)/(3.5*g(P)*Math.pow(P.length,-1/3)))},d.thresholdSturges=T,d.max=function(P,S){var E,z,D=P.length,j=-1;if(S==null){for(;++j<D;)if((E=P[j])!=null&&E>=E)for(z=E;++j<D;)(E=P[j])!=null&&E>z&&(z=E)}else for(;++j<D;)if((E=S(P[j],j,P))!=null&&E>=E)for(z=E;++j<D;)(E=S(P[j],j,P))!=null&&E>z&&(z=E);return z},d.mean=function(P,S){var E,z=P.length,D=z,j=-1,V=0;if(S==null)for(;++j<z;)isNaN(E=a(P[j]))?--D:V+=E;else for(;++j<z;)isNaN(E=a(S(P[j],j,P)))?--D:V+=E;if(D)return V/D},d.median=function(P,S){var E,z=P.length,D=-1,j=[];if(S==null)for(;++D<z;)isNaN(E=a(P[D]))||j.push(E);else for(;++D<z;)isNaN(E=a(S(P[D],D,P)))||j.push(E);return k(j.sort(v),.5)},d.merge=function(P){for(var S,E,z,D=P.length,j=-1,V=0;++j<D;)V+=P[j].length;for(E=new Array(V);--D>=0;)for(S=(z=P[D]).length;--S>=0;)E[--V]=z[S];return E},d.min=L,d.pairs=function(P,S){S==null&&(S=n);for(var E=0,z=P.length-1,D=P[0],j=new Array(z<0?0:z);E<z;)j[E]=S(D,D=P[++E]);return j},d.permute=function(P,S){for(var E=S.length,z=new Array(E);E--;)z[E]=P[S[E]];return z},d.quantile=k,d.range=c,d.scan=function(P,S){if(E=P.length){var E,z,D=0,j=0,V=P[j];for(S==null&&(S=v);++D<E;)(S(z=P[D],V)<0||S(V,V)!==0)&&(V=z,j=D);return S(V,V)===0?j:void 0}},d.shuffle=function(P,S,E){for(var z,D,j=(E==null?P.length:E)-(S=S==null?0:+S);j;)D=Math.random()*j--|0,z=P[j+S],P[j+S]=P[D+S],P[D+S]=z;return P},d.sum=function(P,S){var E,z=P.length,D=-1,j=0;if(S==null)for(;++D<z;)(E=+P[D])&&(j+=E);else for(;++D<z;)(E=+S(P[D],D,P))&&(j+=E);return j},d.ticks=function(P,S,E){var z,D,j,V,Z=-1;if(E=+E,(P=+P)==(S=+S)&&E>0)return[P];if((z=S<P)&&(D=P,P=S,S=D),(V=_(P,S,E))===0||!isFinite(V))return[];if(V>0)for(P=Math.ceil(P/V),S=Math.floor(S/V),j=new Array(D=Math.ceil(S-P+1));++Z<D;)j[Z]=(P+Z)*V;else for(P=Math.floor(P*V),S=Math.ceil(S*V),j=new Array(D=Math.ceil(P-S+1));++Z<D;)j[Z]=(P-Z)/V;return z&&j.reverse(),j},d.tickIncrement=_,d.tickStep=b,d.transpose=A,d.variance=r,d.zip=function(){return A(arguments)},Object.defineProperty(d,"__esModule",{value:!0})})},{}],108:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:d.d3=d.d3||{})})(this,function(d){function v(){}function w(u,s){var h=new v;if(u instanceof v)u.each(function(i,x){h.set(x,i)});else if(Array.isArray(u)){var l,o=-1,p=u.length;if(s==null)for(;++o<p;)h.set(o,u[o]);else for(;++o<p;)h.set(s(l=u[o],o,u),l)}else if(u)for(var c in u)h.set(c,u[c]);return h}function y(){return{}}function e(u,s,h){u[s]=h}function t(){return w()}function n(u,s,h){u.set(s,h)}function a(){}v.prototype=w.prototype={constructor:v,has:function(u){return"$"+u in this},get:function(u){return this["$"+u]},set:function(u,s){return this["$"+u]=s,this},remove:function(u){var s="$"+u;return s in this&&delete this[s]},clear:function(){for(var u in this)u[0]==="$"&&delete this[u]},keys:function(){var u=[];for(var s in this)s[0]==="$"&&u.push(s.slice(1));return u},values:function(){var u=[];for(var s in this)s[0]==="$"&&u.push(this[s]);return u},entries:function(){var u=[];for(var s in this)s[0]==="$"&&u.push({key:s.slice(1),value:this[s]});return u},size:function(){var u=0;for(var s in this)s[0]==="$"&&++u;return u},empty:function(){for(var u in this)if(u[0]==="$")return!1;return!0},each:function(u){for(var s in this)s[0]==="$"&&u(this[s],s.slice(1),this)}};var r=w.prototype;function g(u,s){var h=new a;if(u instanceof a)u.each(function(p){h.add(p)});else if(u){var l=-1,o=u.length;if(s==null)for(;++l<o;)h.add(u[l]);else for(;++l<o;)h.add(s(u[l],l,u))}return h}a.prototype=g.prototype={constructor:a,has:r.has,add:function(u){return this["$"+(u+="")]=u,this},remove:r.remove,clear:r.clear,values:r.keys,size:r.size,empty:r.empty,each:r.each},d.nest=function(){var u,s,h,l=[],o=[];function p(c,i,x,f){if(i>=l.length)return u!=null&&c.sort(u),s!=null?s(c):c;for(var _,b,T,k=-1,L=c.length,A=l[i++],I=w(),P=x();++k<L;)(T=I.get(_=A(b=c[k])+""))?T.push(b):I.set(_,[b]);return I.each(function(S,E){f(P,E,p(S,i,x,f))}),P}return h={object:function(c){return p(c,0,y,e)},map:function(c){return p(c,0,t,n)},entries:function(c){return function i(x,f){if(++f>l.length)return x;var _,b=o[f-1];return s!=null&&f>=l.length?_=x.entries():(_=[],x.each(function(T,k){_.push({key:k,values:i(T,f)})})),b!=null?_.sort(function(T,k){return b(T.key,k.key)}):_}(p(c,0,t,n),0)},key:function(c){return l.push(c),h},sortKeys:function(c){return o[l.length-1]=c,h},sortValues:function(c){return u=c,h},rollup:function(c){return s=c,h}}},d.set=g,d.map=w,d.keys=function(u){var s=[];for(var h in u)s.push(h);return s},d.values=function(u){var s=[];for(var h in u)s.push(u[h]);return s},d.entries=function(u){var s=[];for(var h in u)s.push({key:h,value:u[h]});return s},Object.defineProperty(d,"__esModule",{value:!0})})},{}],109:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){function v(le,ge,Te){le.prototype=ge.prototype=Te,Te.constructor=le}function w(le,ge){var Te=Object.create(le.prototype);for(var Se in ge)Te[Se]=ge[Se];return Te}function y(){}var e="\\s*([+-]?\\d+)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",n="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a=/^#([0-9a-f]{3,8})$/,r=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),g=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),u=new RegExp("^rgba\\("+[e,e,e,t]+"\\)$"),s=new RegExp("^rgba\\("+[n,n,n,t]+"\\)$"),h=new RegExp("^hsl\\("+[t,n,n]+"\\)$"),l=new RegExp("^hsla\\("+[t,n,n,t]+"\\)$"),o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function c(){return this.rgb().formatRgb()}function i(le){var ge,Te;return le=(le+"").trim().toLowerCase(),(ge=a.exec(le))?(Te=ge[1].length,ge=parseInt(ge[1],16),Te===6?x(ge):Te===3?new T(ge>>8&15|ge>>4&240,ge>>4&15|240&ge,(15&ge)<<4|15&ge,1):Te===8?f(ge>>24&255,ge>>16&255,ge>>8&255,(255&ge)/255):Te===4?f(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|240&ge,((15&ge)<<4|15&ge)/255):null):(ge=r.exec(le))?new T(ge[1],ge[2],ge[3],1):(ge=g.exec(le))?new T(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,1):(ge=u.exec(le))?f(ge[1],ge[2],ge[3],ge[4]):(ge=s.exec(le))?f(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,ge[4]):(ge=h.exec(le))?I(ge[1],ge[2]/100,ge[3]/100,1):(ge=l.exec(le))?I(ge[1],ge[2]/100,ge[3]/100,ge[4]):o.hasOwnProperty(le)?x(o[le]):le==="transparent"?new T(NaN,NaN,NaN,0):null}function x(le){return new T(le>>16&255,le>>8&255,255&le,1)}function f(le,ge,Te,Se){return Se<=0&&(le=ge=Te=NaN),new T(le,ge,Te,Se)}function _(le){return le instanceof y||(le=i(le)),le?new T((le=le.rgb()).r,le.g,le.b,le.opacity):new T}function b(le,ge,Te,Se){return arguments.length===1?_(le):new T(le,ge,Te,Se==null?1:Se)}function T(le,ge,Te,Se){this.r=+le,this.g=+ge,this.b=+Te,this.opacity=+Se}function k(){return"#"+A(this.r)+A(this.g)+A(this.b)}function L(){var le=this.opacity;return((le=isNaN(le)?1:Math.max(0,Math.min(1,le)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(le===1?")":", "+le+")")}function A(le){return((le=Math.max(0,Math.min(255,Math.round(le)||0)))<16?"0":"")+le.toString(16)}function I(le,ge,Te,Se){return Se<=0?le=ge=Te=NaN:Te<=0||Te>=1?le=ge=NaN:ge<=0&&(le=NaN),new E(le,ge,Te,Se)}function P(le){if(le instanceof E)return new E(le.h,le.s,le.l,le.opacity);if(le instanceof y||(le=i(le)),!le)return new E;if(le instanceof E)return le;var ge=(le=le.rgb()).r/255,Te=le.g/255,Se=le.b/255,Me=Math.min(ge,Te,Se),ze=Math.max(ge,Te,Se),Oe=NaN,De=ze-Me,Xe=(ze+Me)/2;return De?(Oe=ge===ze?(Te-Se)/De+6*(Te<Se):Te===ze?(Se-ge)/De+2:(ge-Te)/De+4,De/=Xe<.5?ze+Me:2-ze-Me,Oe*=60):De=Xe>0&&Xe<1?0:Oe,new E(Oe,De,Xe,le.opacity)}function S(le,ge,Te,Se){return arguments.length===1?P(le):new E(le,ge,Te,Se==null?1:Se)}function E(le,ge,Te,Se){this.h=+le,this.s=+ge,this.l=+Te,this.opacity=+Se}function z(le,ge,Te){return 255*(le<60?ge+(Te-ge)*le/60:le<180?Te:le<240?ge+(Te-ge)*(240-le)/60:ge)}v(y,i,{copy:function(le){return Object.assign(new this.constructor,this,le)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return P(this).formatHsl()},formatRgb:c,toString:c}),v(T,b,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new T(this.r*le,this.g*le,this.b*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new T(this.r*le,this.g*le,this.b*le,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:L,toString:L})),v(E,S,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new E(this.h,this.s,this.l*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new E(this.h,this.s,this.l*le,this.opacity)},rgb:function(){var le=this.h%360+360*(this.h<0),ge=isNaN(le)||isNaN(this.s)?0:this.s,Te=this.l,Se=Te+(Te<.5?Te:1-Te)*ge,Me=2*Te-Se;return new T(z(le>=240?le-240:le+120,Me,Se),z(le,Me,Se),z(le<120?le+240:le-120,Me,Se),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var le=this.opacity;return((le=isNaN(le)?1:Math.max(0,Math.min(1,le)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(le===1?")":", "+le+")")}}));var D=Math.PI/180,j=180/Math.PI,V=6/29,Z=3*V*V;function Q(le){if(le instanceof $)return new $(le.l,le.a,le.b,le.opacity);if(le instanceof X)return J(le);le instanceof T||(le=_(le));var ge,Te,Se=U(le.r),Me=U(le.g),ze=U(le.b),Oe=ne((.2225045*Se+.7168786*Me+.0606169*ze)/1);return Se===Me&&Me===ze?ge=Te=Oe:(ge=ne((.4360747*Se+.3850649*Me+.1430804*ze)/.96422),Te=ne((.0139322*Se+.0971045*Me+.7141733*ze)/.82521)),new $(116*Oe-16,500*(ge-Oe),200*(Oe-Te),le.opacity)}function K(le,ge,Te,Se){return arguments.length===1?Q(le):new $(le,ge,Te,Se==null?1:Se)}function $(le,ge,Te,Se){this.l=+le,this.a=+ge,this.b=+Te,this.opacity=+Se}function ne(le){return le>.008856451679035631?Math.pow(le,1/3):le/Z+4/29}function H(le){return le>V?le*le*le:Z*(le-4/29)}function N(le){return 255*(le<=.0031308?12.92*le:1.055*Math.pow(le,1/2.4)-.055)}function U(le){return(le/=255)<=.04045?le/12.92:Math.pow((le+.055)/1.055,2.4)}function te(le){if(le instanceof X)return new X(le.h,le.c,le.l,le.opacity);if(le instanceof $||(le=Q(le)),le.a===0&&le.b===0)return new X(NaN,0<le.l&&le.l<100?0:NaN,le.l,le.opacity);var ge=Math.atan2(le.b,le.a)*j;return new X(ge<0?ge+360:ge,Math.sqrt(le.a*le.a+le.b*le.b),le.l,le.opacity)}function B(le,ge,Te,Se){return arguments.length===1?te(le):new X(le,ge,Te,Se==null?1:Se)}function X(le,ge,Te,Se){this.h=+le,this.c=+ge,this.l=+Te,this.opacity=+Se}function J(le){if(isNaN(le.h))return new $(le.l,0,0,le.opacity);var ge=le.h*D;return new $(le.l,Math.cos(ge)*le.c,Math.sin(ge)*le.c,le.opacity)}v($,K,w(y,{brighter:function(le){return new $(this.l+18*(le==null?1:le),this.a,this.b,this.opacity)},darker:function(le){return new $(this.l-18*(le==null?1:le),this.a,this.b,this.opacity)},rgb:function(){var le=(this.l+16)/116,ge=isNaN(this.a)?le:le+this.a/500,Te=isNaN(this.b)?le:le-this.b/200;return new T(N(3.1338561*(ge=.96422*H(ge))-1.6168667*(le=1*H(le))-.4906146*(Te=.82521*H(Te))),N(-.9787684*ge+1.9161415*le+.033454*Te),N(.0719453*ge-.2289914*le+1.4052427*Te),this.opacity)}})),v(X,B,w(y,{brighter:function(le){return new X(this.h,this.c,this.l+18*(le==null?1:le),this.opacity)},darker:function(le){return new X(this.h,this.c,this.l-18*(le==null?1:le),this.opacity)},rgb:function(){return J(this).rgb()}}));var ee=-.14861,re=1.78277,se=-.29227,oe=-.90649,de=1.97294,ce=de*oe,ve=de*re,Ae=re*se-oe*ee;function fe(le){if(le instanceof _e)return new _e(le.h,le.s,le.l,le.opacity);le instanceof T||(le=_(le));var ge=le.r/255,Te=le.g/255,Se=le.b/255,Me=(Ae*Se+ce*ge-ve*Te)/(Ae+ce-ve),ze=Se-Me,Oe=(de*(Te-Me)-se*ze)/oe,De=Math.sqrt(Oe*Oe+ze*ze)/(de*Me*(1-Me)),Xe=De?Math.atan2(Oe,ze)*j-120:NaN;return new _e(Xe<0?Xe+360:Xe,De,Me,le.opacity)}function me(le,ge,Te,Se){return arguments.length===1?fe(le):new _e(le,ge,Te,Se==null?1:Se)}function _e(le,ge,Te,Se){this.h=+le,this.s=+ge,this.l=+Te,this.opacity=+Se}v(_e,me,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new _e(this.h,this.s,this.l*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new _e(this.h,this.s,this.l*le,this.opacity)},rgb:function(){var le=isNaN(this.h)?0:(this.h+120)*D,ge=+this.l,Te=isNaN(this.s)?0:this.s*ge*(1-ge),Se=Math.cos(le),Me=Math.sin(le);return new T(255*(ge+Te*(ee*Se+re*Me)),255*(ge+Te*(se*Se+oe*Me)),255*(ge+Te*(de*Se)),this.opacity)}})),d.color=i,d.cubehelix=me,d.gray=function(le,ge){return new $(le,0,0,ge==null?1:ge)},d.hcl=B,d.hsl=S,d.lab=K,d.lch=function(le,ge,Te,Se){return arguments.length===1?te(le):new X(Te,ge,le,Se==null?1:Se)},d.rgb=b,Object.defineProperty(d,"__esModule",{value:!0})})},{}],110:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){var v={value:function(){}};function w(){for(var a,r=0,g=arguments.length,u={};r<g;++r){if(!(a=arguments[r]+"")||a in u||/[\s.]/.test(a))throw new Error("illegal type: "+a);u[a]=[]}return new y(u)}function y(a){this._=a}function e(a,r){return a.trim().split(/^|\s+/).map(function(g){var u="",s=g.indexOf(".");if(s>=0&&(u=g.slice(s+1),g=g.slice(0,s)),g&&!r.hasOwnProperty(g))throw new Error("unknown type: "+g);return{type:g,name:u}})}function t(a,r){for(var g,u=0,s=a.length;u<s;++u)if((g=a[u]).name===r)return g.value}function n(a,r,g){for(var u=0,s=a.length;u<s;++u)if(a[u].name===r){a[u]=v,a=a.slice(0,u).concat(a.slice(u+1));break}return g!=null&&a.push({name:r,value:g}),a}y.prototype=w.prototype={constructor:y,on:function(a,r){var g,u=this._,s=e(a+"",u),h=-1,l=s.length;if(!(arguments.length<2)){if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++h<l;)if(g=(a=s[h]).type)u[g]=n(u[g],a.name,r);else if(r==null)for(g in u)u[g]=n(u[g],a.name,null);return this}for(;++h<l;)if((g=(a=s[h]).type)&&(g=t(u[g],a.name)))return g},copy:function(){var a={},r=this._;for(var g in r)a[g]=r[g].slice();return new y(a)},call:function(a,r){if((g=arguments.length-2)>0)for(var g,u,s=new Array(g),h=0;h<g;++h)s[h]=arguments[h+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(h=0,g=(u=this._[a]).length;h<g;++h)u[h].value.apply(r,s)},apply:function(a,r,g){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var u=this._[a],s=0,h=u.length;s<h;++s)u[s].value.apply(r,g)}},d.dispatch=w,Object.defineProperty(d,"__esModule",{value:!0})})},{}],111:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-quadtree"),m("d3-collection"),m("d3-dispatch"),m("d3-timer")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3,d.d3)})(this,function(d,v,w,y,e){function t(o){return function(){return o}}function n(){return 1e-6*(Math.random()-.5)}function a(o){return o.x+o.vx}function r(o){return o.y+o.vy}function g(o){return o.index}function u(o,p){var c=o.get(p);if(!c)throw new Error("missing: "+p);return c}function s(o){return o.x}function h(o){return o.y}var l=Math.PI*(3-Math.sqrt(5));d.forceCenter=function(o,p){var c;function i(){var x,f,_=c.length,b=0,T=0;for(x=0;x<_;++x)b+=(f=c[x]).x,T+=f.y;for(b=b/_-o,T=T/_-p,x=0;x<_;++x)(f=c[x]).x-=b,f.y-=T}return o==null&&(o=0),p==null&&(p=0),i.initialize=function(x){c=x},i.x=function(x){return arguments.length?(o=+x,i):o},i.y=function(x){return arguments.length?(p=+x,i):p},i},d.forceCollide=function(o){var p,c,i=1,x=1;function f(){for(var T,k,L,A,I,P,S,E=p.length,z=0;z<x;++z)for(k=v.quadtree(p,a,r).visitAfter(_),T=0;T<E;++T)L=p[T],P=c[L.index],S=P*P,A=L.x+L.vx,I=L.y+L.vy,k.visit(D);function D(j,V,Z,Q,K){var $=j.data,ne=j.r,H=P+ne;if(!$)return V>A+H||Q<A-H||Z>I+H||K<I-H;if($.index>L.index){var N=A-$.x-$.vx,U=I-$.y-$.vy,te=N*N+U*U;te<H*H&&(N===0&&(te+=(N=n())*N),U===0&&(te+=(U=n())*U),te=(H-(te=Math.sqrt(te)))/te*i,L.vx+=(N*=te)*(H=(ne*=ne)/(S+ne)),L.vy+=(U*=te)*H,$.vx-=N*(H=1-H),$.vy-=U*H)}}}function _(T){if(T.data)return T.r=c[T.data.index];for(var k=T.r=0;k<4;++k)T[k]&&T[k].r>T.r&&(T.r=T[k].r)}function b(){if(p){var T,k,L=p.length;for(c=new Array(L),T=0;T<L;++T)k=p[T],c[k.index]=+o(k,T,p)}}return typeof o!="function"&&(o=t(o==null?1:+o)),f.initialize=function(T){p=T,b()},f.iterations=function(T){return arguments.length?(x=+T,f):x},f.strength=function(T){return arguments.length?(i=+T,f):i},f.radius=function(T){return arguments.length?(o=typeof T=="function"?T:t(+T),b(),f):o},f},d.forceLink=function(o){var p,c,i,x,f,_=g,b=function(S){return 1/Math.min(x[S.source.index],x[S.target.index])},T=t(30),k=1;function L(S){for(var E=0,z=o.length;E<k;++E)for(var D,j,V,Z,Q,K,$,ne=0;ne<z;++ne)j=(D=o[ne]).source,Z=(V=D.target).x+V.vx-j.x-j.vx||n(),Q=V.y+V.vy-j.y-j.vy||n(),Z*=K=((K=Math.sqrt(Z*Z+Q*Q))-c[ne])/K*S*p[ne],Q*=K,V.vx-=Z*($=f[ne]),V.vy-=Q*$,j.vx+=Z*($=1-$),j.vy+=Q*$}function A(){if(i){var S,E,z=i.length,D=o.length,j=w.map(i,_);for(S=0,x=new Array(z);S<D;++S)(E=o[S]).index=S,typeof E.source!="object"&&(E.source=u(j,E.source)),typeof E.target!="object"&&(E.target=u(j,E.target)),x[E.source.index]=(x[E.source.index]||0)+1,x[E.target.index]=(x[E.target.index]||0)+1;for(S=0,f=new Array(D);S<D;++S)E=o[S],f[S]=x[E.source.index]/(x[E.source.index]+x[E.target.index]);p=new Array(D),I(),c=new Array(D),P()}}function I(){if(i)for(var S=0,E=o.length;S<E;++S)p[S]=+b(o[S],S,o)}function P(){if(i)for(var S=0,E=o.length;S<E;++S)c[S]=+T(o[S],S,o)}return o==null&&(o=[]),L.initialize=function(S){i=S,A()},L.links=function(S){return arguments.length?(o=S,A(),L):o},L.id=function(S){return arguments.length?(_=S,L):_},L.iterations=function(S){return arguments.length?(k=+S,L):k},L.strength=function(S){return arguments.length?(b=typeof S=="function"?S:t(+S),I(),L):b},L.distance=function(S){return arguments.length?(T=typeof S=="function"?S:t(+S),P(),L):T},L},d.forceManyBody=function(){var o,p,c,i,x=t(-30),f=1,_=1/0,b=.81;function T(I){var P,S=o.length,E=v.quadtree(o,s,h).visitAfter(L);for(c=I,P=0;P<S;++P)p=o[P],E.visit(A)}function k(){if(o){var I,P,S=o.length;for(i=new Array(S),I=0;I<S;++I)P=o[I],i[P.index]=+x(P,I,o)}}function L(I){var P,S,E,z,D,j=0,V=0;if(I.length){for(E=z=D=0;D<4;++D)(P=I[D])&&(S=Math.abs(P.value))&&(j+=P.value,V+=S,E+=S*P.x,z+=S*P.y);I.x=E/V,I.y=z/V}else{(P=I).x=P.data.x,P.y=P.data.y;do j+=i[P.data.index];while(P=P.next)}I.value=j}function A(I,P,S,E){if(!I.value)return!0;var z=I.x-p.x,D=I.y-p.y,j=E-P,V=z*z+D*D;if(j*j/b<V)return V<_&&(z===0&&(V+=(z=n())*z),D===0&&(V+=(D=n())*D),V<f&&(V=Math.sqrt(f*V)),p.vx+=z*I.value*c/V,p.vy+=D*I.value*c/V),!0;if(!(I.length||V>=_)){(I.data!==p||I.next)&&(z===0&&(V+=(z=n())*z),D===0&&(V+=(D=n())*D),V<f&&(V=Math.sqrt(f*V)));do I.data!==p&&(j=i[I.data.index]*c/V,p.vx+=z*j,p.vy+=D*j);while(I=I.next)}}return T.initialize=function(I){o=I,k()},T.strength=function(I){return arguments.length?(x=typeof I=="function"?I:t(+I),k(),T):x},T.distanceMin=function(I){return arguments.length?(f=I*I,T):Math.sqrt(f)},T.distanceMax=function(I){return arguments.length?(_=I*I,T):Math.sqrt(_)},T.theta=function(I){return arguments.length?(b=I*I,T):Math.sqrt(b)},T},d.forceRadial=function(o,p,c){var i,x,f,_=t(.1);function b(k){for(var L=0,A=i.length;L<A;++L){var I=i[L],P=I.x-p||1e-6,S=I.y-c||1e-6,E=Math.sqrt(P*P+S*S),z=(f[L]-E)*x[L]*k/E;I.vx+=P*z,I.vy+=S*z}}function T(){if(i){var k,L=i.length;for(x=new Array(L),f=new Array(L),k=0;k<L;++k)f[k]=+o(i[k],k,i),x[k]=isNaN(f[k])?0:+_(i[k],k,i)}}return typeof o!="function"&&(o=t(+o)),p==null&&(p=0),c==null&&(c=0),b.initialize=function(k){i=k,T()},b.strength=function(k){return arguments.length?(_=typeof k=="function"?k:t(+k),T(),b):_},b.radius=function(k){return arguments.length?(o=typeof k=="function"?k:t(+k),T(),b):o},b.x=function(k){return arguments.length?(p=+k,b):p},b.y=function(k){return arguments.length?(c=+k,b):c},b},d.forceSimulation=function(o){var p,c=1,i=.001,x=1-Math.pow(i,1/300),f=0,_=.6,b=w.map(),T=e.timer(L),k=y.dispatch("tick","end");function L(){A(),k.call("tick",p),c<i&&(T.stop(),k.call("end",p))}function A(S){var E,z,D=o.length;S===void 0&&(S=1);for(var j=0;j<S;++j)for(c+=(f-c)*x,b.each(function(V){V(c)}),E=0;E<D;++E)(z=o[E]).fx==null?z.x+=z.vx*=_:(z.x=z.fx,z.vx=0),z.fy==null?z.y+=z.vy*=_:(z.y=z.fy,z.vy=0);return p}function I(){for(var S,E=0,z=o.length;E<z;++E){if((S=o[E]).index=E,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var D=10*Math.sqrt(E),j=E*l;S.x=D*Math.cos(j),S.y=D*Math.sin(j)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function P(S){return S.initialize&&S.initialize(o),S}return o==null&&(o=[]),I(),p={tick:A,restart:function(){return T.restart(L),p},stop:function(){return T.stop(),p},nodes:function(S){return arguments.length?(o=S,I(),b.each(P),p):o},alpha:function(S){return arguments.length?(c=+S,p):c},alphaMin:function(S){return arguments.length?(i=+S,p):i},alphaDecay:function(S){return arguments.length?(x=+S,p):+x},alphaTarget:function(S){return arguments.length?(f=+S,p):f},velocityDecay:function(S){return arguments.length?(_=1-S,p):1-_},force:function(S,E){return arguments.length>1?(E==null?b.remove(S):b.set(S,P(E)),p):b.get(S)},find:function(S,E,z){var D,j,V,Z,Q,K=0,$=o.length;for(z==null?z=1/0:z*=z,K=0;K<$;++K)(V=(D=S-(Z=o[K]).x)*D+(j=E-Z.y)*j)<z&&(Q=Z,z=V);return Q},on:function(S,E){return arguments.length>1?(k.on(S,E),p):k.on(S)}}},d.forceX=function(o){var p,c,i,x=t(.1);function f(b){for(var T,k=0,L=p.length;k<L;++k)(T=p[k]).vx+=(i[k]-T.x)*c[k]*b}function _(){if(p){var b,T=p.length;for(c=new Array(T),i=new Array(T),b=0;b<T;++b)c[b]=isNaN(i[b]=+o(p[b],b,p))?0:+x(p[b],b,p)}}return typeof o!="function"&&(o=t(o==null?0:+o)),f.initialize=function(b){p=b,_()},f.strength=function(b){return arguments.length?(x=typeof b=="function"?b:t(+b),_(),f):x},f.x=function(b){return arguments.length?(o=typeof b=="function"?b:t(+b),_(),f):o},f},d.forceY=function(o){var p,c,i,x=t(.1);function f(b){for(var T,k=0,L=p.length;k<L;++k)(T=p[k]).vy+=(i[k]-T.y)*c[k]*b}function _(){if(p){var b,T=p.length;for(c=new Array(T),i=new Array(T),b=0;b<T;++b)c[b]=isNaN(i[b]=+o(p[b],b,p))?0:+x(p[b],b,p)}}return typeof o!="function"&&(o=t(o==null?0:+o)),f.initialize=function(b){p=b,_()},f.strength=function(b){return arguments.length?(x=typeof b=="function"?b:t(+b),_(),f):x},f.y=function(b){return arguments.length?(o=typeof b=="function"?b:t(+b),_(),f):o},f},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=typeof globalThis<"u"?globalThis:d||self).d3=d.d3||{})})(this,function(d){function v(p,c){if((i=(p=c?p.toExponential(c-1):p.toExponential()).indexOf("e"))<0)return null;var i,x=p.slice(0,i);return[x.length>1?x[0]+x.slice(2):x,+p.slice(i+1)]}function w(p){return(p=v(Math.abs(p)))?p[1]:NaN}var y,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function t(p){if(!(c=e.exec(p)))throw new Error("invalid format: "+p);var c;return new n({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}function n(p){this.fill=p.fill===void 0?" ":p.fill+"",this.align=p.align===void 0?">":p.align+"",this.sign=p.sign===void 0?"-":p.sign+"",this.symbol=p.symbol===void 0?"":p.symbol+"",this.zero=!!p.zero,this.width=p.width===void 0?void 0:+p.width,this.comma=!!p.comma,this.precision=p.precision===void 0?void 0:+p.precision,this.trim=!!p.trim,this.type=p.type===void 0?"":p.type+""}function a(p,c){var i=v(p,c);if(!i)return p+"";var x=i[0],f=i[1];return f<0?"0."+new Array(-f).join("0")+x:x.length>f+1?x.slice(0,f+1)+"."+x.slice(f+1):x+new Array(f-x.length+2).join("0")}t.prototype=n.prototype,n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var r={"%":function(p,c){return(100*p).toFixed(c)},b:function(p){return Math.round(p).toString(2)},c:function(p){return p+""},d:function(p){return Math.abs(p=Math.round(p))>=1e21?p.toLocaleString("en").replace(/,/g,""):p.toString(10)},e:function(p,c){return p.toExponential(c)},f:function(p,c){return p.toFixed(c)},g:function(p,c){return p.toPrecision(c)},o:function(p){return Math.round(p).toString(8)},p:function(p,c){return a(100*p,c)},r:a,s:function(p,c){var i=v(p,c);if(!i)return p+"";var x=i[0],f=i[1],_=f-(y=3*Math.max(-8,Math.min(8,Math.floor(f/3))))+1,b=x.length;return _===b?x:_>b?x+new Array(_-b+1).join("0"):_>0?x.slice(0,_)+"."+x.slice(_):"0."+new Array(1-_).join("0")+v(p,Math.max(0,c+_-1))[0]},X:function(p){return Math.round(p).toString(16).toUpperCase()},x:function(p){return Math.round(p).toString(16)}};function g(p){return p}var u,s=Array.prototype.map,h=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function l(p){var c,i,x=p.grouping===void 0||p.thousands===void 0?g:(c=s.call(p.grouping,Number),i=p.thousands+"",function(P,S){for(var E=P.length,z=[],D=0,j=c[0],V=0;E>0&&j>0&&(V+j+1>S&&(j=Math.max(1,S-V)),z.push(P.substring(E-=j,E+j)),!((V+=j+1)>S));)j=c[D=(D+1)%c.length];return z.reverse().join(i)}),f=p.currency===void 0?"":p.currency[0]+"",_=p.currency===void 0?"":p.currency[1]+"",b=p.decimal===void 0?".":p.decimal+"",T=p.numerals===void 0?g:function(P){return function(S){return S.replace(/[0-9]/g,function(E){return P[+E]})}}(s.call(p.numerals,String)),k=p.percent===void 0?"%":p.percent+"",L=p.minus===void 0?"-":p.minus+"",A=p.nan===void 0?"NaN":p.nan+"";function I(P){var S=(P=t(P)).fill,E=P.align,z=P.sign,D=P.symbol,j=P.zero,V=P.width,Z=P.comma,Q=P.precision,K=P.trim,$=P.type;$==="n"?(Z=!0,$="g"):r[$]||(Q===void 0&&(Q=12),K=!0,$="g"),(j||S==="0"&&E==="=")&&(j=!0,S="0",E="=");var ne=D==="$"?f:D==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",H=D==="$"?_:/[%p]/.test($)?k:"",N=r[$],U=/[defgprs%]/.test($);function te(B){var X,J,ee,re=ne,se=H;if($==="c")se=N(B)+se,B="";else{var oe=(B=+B)<0||1/B<0;if(B=isNaN(B)?A:N(Math.abs(B),Q),K&&(B=function(ve){e:for(var Ae,fe=ve.length,me=1,_e=-1;me<fe;++me)switch(ve[me]){case".":_e=Ae=me;break;case"0":_e===0&&(_e=me),Ae=me;break;default:if(!+ve[me])break e;_e>0&&(_e=0)}return _e>0?ve.slice(0,_e)+ve.slice(Ae+1):ve}(B)),oe&&+B==0&&z!=="+"&&(oe=!1),re=(oe?z==="("?z:L:z==="-"||z==="("?"":z)+re,se=($==="s"?h[8+y/3]:"")+se+(oe&&z==="("?")":""),U){for(X=-1,J=B.length;++X<J;)if(48>(ee=B.charCodeAt(X))||ee>57){se=(ee===46?b+B.slice(X+1):B.slice(X))+se,B=B.slice(0,X);break}}}Z&&!j&&(B=x(B,1/0));var de=re.length+B.length+se.length,ce=de<V?new Array(V-de+1).join(S):"";switch(Z&&j&&(B=x(ce+B,ce.length?V-se.length:1/0),ce=""),E){case"<":B=re+B+se+ce;break;case"=":B=re+ce+B+se;break;case"^":B=ce.slice(0,de=ce.length>>1)+re+B+se+ce.slice(de);break;default:B=ce+re+B+se}return T(B)}return Q=Q===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q)),te.toString=function(){return P+""},te}return{format:I,formatPrefix:function(P,S){var E=I(((P=t(P)).type="f",P)),z=3*Math.max(-8,Math.min(8,Math.floor(w(S)/3))),D=Math.pow(10,-z),j=h[8+z/3];return function(V){return E(D*V)+j}}}}function o(p){return u=l(p),d.format=u.format,d.formatPrefix=u.formatPrefix,u}o({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),d.FormatSpecifier=n,d.formatDefaultLocale=o,d.formatLocale=l,d.formatSpecifier=t,d.precisionFixed=function(p){return Math.max(0,-w(Math.abs(p)))},d.precisionPrefix=function(p,c){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(w(c)/3)))-w(Math.abs(p)))},d.precisionRound=function(p,c){return p=Math.abs(p),c=Math.abs(c)-p,Math.max(0,w(c)-w(p))+1},Object.defineProperty(d,"__esModule",{value:!0})})},{}],113:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-geo"),m("d3-array")):v(d.d3=d.d3||{},d.d3,d.d3)})(this,function(d,v,w){var y=Math.abs,e=Math.atan,t=Math.atan2,n=Math.cos,a=Math.exp,r=Math.floor,g=Math.log,u=Math.max,s=Math.min,h=Math.pow,l=Math.round,o=Math.sign||function(Ue){return Ue>0?1:Ue<0?-1:0},p=Math.sin,c=Math.tan,i=1e-6,x=Math.PI,f=x/2,_=x/4,b=Math.SQRT1_2,T=E(2),k=E(x),L=2*x,A=180/x,I=x/180;function P(Ue){return Ue>1?f:Ue<-1?-f:Math.asin(Ue)}function S(Ue){return Ue>1?0:Ue<-1?x:Math.acos(Ue)}function E(Ue){return Ue>0?Math.sqrt(Ue):0}function z(Ue){return(a(Ue)-a(-Ue))/2}function D(Ue){return(a(Ue)+a(-Ue))/2}function j(Ue){var We=c(Ue/2),rt=2*g(n(Ue/2))/(We*We);function ut(yt,mt){var Lt=n(yt),$t=n(mt),er=p(mt),Zt=$t*Lt,or=-((1-Zt?g((1+Zt)/2)/(1-Zt):-.5)+rt/(1+Zt));return[or*$t*p(yt),or*er]}return ut.invert=function(yt,mt){var Lt,$t=E(yt*yt+mt*mt),er=-Ue/2,Zt=50;if(!$t)return[0,0];do{var or=er/2,mr=n(or),wr=p(or),Tr=wr/mr,Rr=-g(y(mr));er-=Lt=(2/Tr*Rr-rt*Tr-$t)/(-Rr/(wr*wr)+1-rt/(2*mr*mr))*(mr<0?.7:1)}while(y(Lt)>i&&--Zt>0);var on=p(er);return[t(yt*on,$t*n(er)),P(mt*on/$t)]},ut}function V(Ue,We){var rt=n(We),ut=function(yt){return yt?yt/Math.sin(yt):1}(S(rt*n(Ue/=2)));return[2*rt*p(Ue)*ut,p(We)*ut]}function Z(Ue){var We=p(Ue),rt=n(Ue),ut=Ue>=0?1:-1,yt=c(ut*Ue),mt=(1+We-rt)/2;function Lt($t,er){var Zt=n(er),or=n($t/=2);return[(1+Zt)*p($t),(ut*er>-t(or,yt)-.001?0:10*-ut)+mt+p(er)*rt-(1+Zt)*We*or]}return Lt.invert=function($t,er){var Zt=0,or=0,mr=50;do{var wr=n(Zt),Tr=p(Zt),Rr=n(or),on=p(or),mn=1+Rr,In=mn*Tr-$t,zn=mt+on*rt-mn*We*wr-er,qn=mn*wr/2,Rn=-Tr*on,vi=We*mn*Tr/2,Si=rt*Rr+We*wr*on,Ui=Rn*vi-Si*qn,ji=(zn*Rn-In*Si)/Ui/2,Vi=(In*vi-zn*qn)/Ui;y(Vi)>2&&(Vi/=2),Zt-=ji,or-=Vi}while((y(ji)>i||y(Vi)>i)&&--mr>0);return ut*or>-t(n(Zt),yt)-.001?[2*Zt,or]:null},Lt}function Q(Ue,We){var rt=c(We/2),ut=E(1-rt*rt),yt=1+ut*n(Ue/=2),mt=p(Ue)*ut/yt,Lt=rt/yt,$t=mt*mt,er=Lt*Lt;return[4/3*mt*(3+$t-3*er),4/3*Lt*(3+3*$t-er)]}V.invert=function(Ue,We){if(!(Ue*Ue+4*We*We>x*x+i)){var rt=Ue,ut=We,yt=25;do{var mt,Lt=p(rt),$t=p(rt/2),er=n(rt/2),Zt=p(ut),or=n(ut),mr=p(2*ut),wr=Zt*Zt,Tr=or*or,Rr=$t*$t,on=1-Tr*er*er,mn=on?S(or*er)*E(mt=1/on):mt=0,In=2*mn*or*$t-Ue,zn=mn*Zt-We,qn=mt*(Tr*Rr+mn*or*er*wr),Rn=mt*(.5*Lt*mr-2*mn*Zt*$t),vi=.25*mt*(mr*$t-mn*Zt*Tr*Lt),Si=mt*(wr*er+mn*Rr*or),Ui=Rn*vi-Si*qn;if(!Ui)break;var ji=(zn*Rn-In*Si)/Ui,Vi=(In*vi-zn*qn)/Ui;rt-=ji,ut-=Vi}while((y(ji)>i||y(Vi)>i)&&--yt>0);return[rt,ut]}},Q.invert=function(Ue,We){if(We*=3/8,!(Ue*=3/8)&&y(We)>1)return null;var rt=1+Ue*Ue+We*We,ut=E((rt-E(rt*rt-4*We*We))/2),yt=P(ut)/3,mt=ut?function(Zt){return g(Zt+E(Zt*Zt-1))}(y(We/ut))/3:function(Zt){return g(Zt+E(Zt*Zt+1))}(y(Ue))/3,Lt=n(yt),$t=D(mt),er=$t*$t-Lt*Lt;return[2*o(Ue)*t(z(mt)*Lt,.25-er),2*o(We)*t($t*p(yt),.25+er)]};var K=E(8),$=g(1+T);function ne(Ue,We){var rt=y(We);return rt<_?[Ue,g(c(_+We/2))]:[Ue*n(rt)*(2*T-1/p(rt)),o(We)*(2*T*(rt-_)-g(c(rt/2)))]}function H(Ue){var We=2*x/Ue;function rt(ut,yt){var mt=v.geoAzimuthalEquidistantRaw(ut,yt);if(y(ut)>f){var Lt=t(mt[1],mt[0]),$t=E(mt[0]*mt[0]+mt[1]*mt[1]),er=We*l((Lt-f)/We)+f,Zt=t(p(Lt-=er),2-n(Lt));Lt=er+P(x/$t*p(Zt))-Zt,mt[0]=$t*n(Lt),mt[1]=$t*p(Lt)}return mt}return rt.invert=function(ut,yt){var mt=E(ut*ut+yt*yt);if(mt>f){var Lt=t(yt,ut),$t=We*l((Lt-f)/We)+f,er=Lt>$t?-1:1,Zt=mt*n($t-Lt),or=1/c(er*S((Zt-x)/E(x*(x-2*Zt)+mt*mt)));Lt=$t+2*e((or+er*E(or*or-3))/3),ut=mt*n(Lt),yt=mt*p(Lt)}return v.geoAzimuthalEquidistantRaw.invert(ut,yt)},rt}function N(Ue,We){if(arguments.length<2&&(We=Ue),We===1)return v.geoAzimuthalEqualAreaRaw;if(We===1/0)return U;function rt(ut,yt){var mt=v.geoAzimuthalEqualAreaRaw(ut/We,yt);return mt[0]*=Ue,mt}return rt.invert=function(ut,yt){var mt=v.geoAzimuthalEqualAreaRaw.invert(ut/Ue,yt);return mt[0]*=We,mt},rt}function U(Ue,We){return[Ue*n(We)/n(We/=2),2*p(We)]}function te(Ue,We,rt){var ut,yt,mt,Lt=100;rt=rt===void 0?0:+rt,We=+We;do(yt=Ue(rt))===(mt=Ue(rt+i))&&(mt=yt+i),rt-=ut=-1*i*(yt-We)/(yt-mt);while(Lt-- >0&&y(ut)>i);return Lt<0?NaN:rt}function B(Ue,We,rt){return We===void 0&&(We=40),rt===void 0&&(rt=1e-12),function(ut,yt,mt,Lt){var $t,er,Zt;mt=mt===void 0?0:+mt,Lt=Lt===void 0?0:+Lt;for(var or=0;or<We;or++){var mr=Ue(mt,Lt),wr=mr[0]-ut,Tr=mr[1]-yt;if(y(wr)<rt&&y(Tr)<rt)break;var Rr=wr*wr+Tr*Tr;if(Rr>$t)mt-=er/=2,Lt-=Zt/=2;else{$t=Rr;var on=(mt>0?-1:1)*rt,mn=(Lt>0?-1:1)*rt,In=Ue(mt+on,Lt),zn=Ue(mt,Lt+mn),qn=(In[0]-mr[0])/on,Rn=(In[1]-mr[1])/on,vi=(zn[0]-mr[0])/mn,Si=(zn[1]-mr[1])/mn,Ui=Si*qn-Rn*vi,ji=(y(Ui)<.5?.5:1)/Ui;if(mt+=er=(Tr*vi-wr*Si)*ji,Lt+=Zt=(wr*Rn-Tr*qn)*ji,y(er)<rt&&y(Zt)<rt)break}}return[mt,Lt]}}function X(){var Ue=N(1.68,2);function We(rt,ut){if(rt+ut<-1.4){var yt=(rt-ut+1.6)*(rt+ut+1.4)/8;rt+=yt,ut-=.8*yt*p(ut+x/2)}var mt=Ue(rt,ut),Lt=(1-n(rt*ut))/12;return mt[1]<0&&(mt[0]*=1+Lt),mt[1]>0&&(mt[1]*=1+Lt/1.5*mt[0]*mt[0]),mt}return We.invert=B(We),We}function J(Ue,We){var rt,ut=Ue*p(We),yt=30;do We-=rt=(We+p(We)-ut)/(1+n(We));while(y(rt)>i&&--yt>0);return We/2}function ee(Ue,We,rt){function ut(yt,mt){return[Ue*yt*n(mt=J(rt,mt)),We*p(mt)]}return ut.invert=function(yt,mt){return mt=P(mt/We),[yt/(Ue*n(mt)),P((2*mt+p(2*mt))/rt)]},ut}ne.invert=function(Ue,We){if((ut=y(We))<$)return[Ue,2*e(a(We))-f];var rt,ut,yt=_,mt=25;do{var Lt=n(yt/2),$t=c(yt/2);yt-=rt=(K*(yt-_)-g($t)-ut)/(K-Lt*Lt/(2*$t))}while(y(rt)>1e-12&&--mt>0);return[Ue/(n(yt)*(K-1/p(yt))),o(We)*yt]},U.invert=function(Ue,We){var rt=2*P(We/2);return[Ue*n(rt/2)/n(rt),rt]};var re=ee(T/f,T,x),se=2.00276,oe=1.11072;function de(Ue,We){var rt=J(x,We);return[se*Ue/(1/n(We)+oe/n(rt)),(We+T*p(rt))/se]}function ce(Ue){var We=0,rt=v.geoProjectionMutator(Ue),ut=rt(We);return ut.parallel=function(yt){return arguments.length?rt(We=yt*I):We*A},ut}function ve(Ue,We){return[Ue*n(We),We]}function Ae(Ue){if(!Ue)return ve;var We=1/c(Ue);function rt(ut,yt){var mt=We+Ue-yt,Lt=mt&&ut*n(yt)/mt;return[mt*p(Lt),We-mt*n(Lt)]}return rt.invert=function(ut,yt){var mt=E(ut*ut+(yt=We-yt)*yt),Lt=We+Ue-mt;return[mt/n(Lt)*t(ut,yt),Lt]},rt}function fe(Ue){function We(rt,ut){var yt=f-ut,mt=yt&&rt*Ue*p(yt)/yt;return[yt*p(mt)/Ue,f-yt*n(mt)]}return We.invert=function(rt,ut){var yt=rt*Ue,mt=f-ut,Lt=E(yt*yt+mt*mt),$t=t(yt,mt);return[(Lt?Lt/p(Lt):1)*$t/Ue,f-Lt]},We}de.invert=function(Ue,We){var rt,ut,yt=se*We,mt=We<0?-_:_,Lt=25;do ut=yt-T*p(mt),mt-=rt=(p(2*mt)+2*mt-x*p(ut))/(2*n(2*mt)+2+x*n(ut)*T*n(mt));while(y(rt)>i&&--Lt>0);return ut=yt-T*p(mt),[Ue*(1/n(ut)+oe/n(mt))/se,ut]},ve.invert=function(Ue,We){return[Ue/n(We),We]};var me=ee(1,4/x,x);function _e(Ue,We,rt,ut,yt,mt){var Lt,$t=n(mt);if(y(Ue)>1||y(mt)>1)Lt=S(rt*yt+We*ut*$t);else{var er=p(Ue/2),Zt=p(mt/2);Lt=2*P(E(er*er+We*ut*Zt*Zt))}return y(Lt)>i?[Lt,t(ut*p(mt),We*yt-rt*ut*$t)]:[0,0]}function le(Ue,We,rt){return S((Ue*Ue+We*We-rt*rt)/(2*Ue*We))}function ge(Ue){return Ue-2*x*r((Ue+x)/(2*x))}function Te(Ue,We,rt){for(var ut,yt=[[Ue[0],Ue[1],p(Ue[1]),n(Ue[1])],[We[0],We[1],p(We[1]),n(We[1])],[rt[0],rt[1],p(rt[1]),n(rt[1])]],mt=yt[2],Lt=0;Lt<3;++Lt,mt=ut)ut=yt[Lt],mt.v=_e(ut[1]-mt[1],mt[3],mt[2],ut[3],ut[2],ut[0]-mt[0]),mt.point=[0,0];var $t=le(yt[0].v[0],yt[2].v[0],yt[1].v[0]),er=le(yt[0].v[0],yt[1].v[0],yt[2].v[0]),Zt=x-$t;yt[2].point[1]=0,yt[0].point[0]=-(yt[1].point[0]=yt[0].v[0]/2);var or=[yt[2].point[0]=yt[0].point[0]+yt[2].v[0]*n($t),2*(yt[0].point[1]=yt[1].point[1]=yt[2].v[0]*p($t))];return function(mr,wr){var Tr,Rr=p(wr),on=n(wr),mn=new Array(3);for(Tr=0;Tr<3;++Tr){var In=yt[Tr];if(mn[Tr]=_e(wr-In[1],In[3],In[2],on,Rr,mr-In[0]),!mn[Tr][0])return In.point;mn[Tr][1]=ge(mn[Tr][1]-In.v[1])}var zn=or.slice();for(Tr=0;Tr<3;++Tr){var qn=Tr==2?0:Tr+1,Rn=le(yt[Tr].v[0],mn[Tr][0],mn[qn][0]);mn[Tr][1]<0&&(Rn=-Rn),Tr?Tr==1?(Rn=er-Rn,zn[0]-=mn[Tr][0]*n(Rn),zn[1]-=mn[Tr][0]*p(Rn)):(Rn=Zt-Rn,zn[0]+=mn[Tr][0]*n(Rn),zn[1]+=mn[Tr][0]*p(Rn)):(zn[0]+=mn[Tr][0]*n(Rn),zn[1]-=mn[Tr][0]*p(Rn))}return zn[0]/=3,zn[1]/=3,zn}}function Se(Ue){return Ue[0]*=I,Ue[1]*=I,Ue}function Me(Ue,We,rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:[Ue,We,rt]}),yt=[-ut[0],-ut[1]],mt=v.geoRotation(yt),Lt=Te(Se(mt(Ue)),Se(mt(We)),Se(mt(rt)));Lt.invert=B(Lt);var $t=v.geoProjection(Lt).rotate(yt),er=$t.center;return delete $t.rotate,$t.center=function(Zt){return arguments.length?er(mt(Zt)):mt.invert(er())},$t.clipAngle(90)}function ze(Ue,We){var rt=E(1-p(We));return[2/k*Ue*rt,k*(1-rt)]}function Oe(Ue){var We=c(Ue);function rt(ut,yt){return[ut,(ut?ut/p(ut):1)*(p(yt)*n(ut)-We*n(yt))]}return rt.invert=We?function(ut,yt){ut&&(yt*=p(ut)/ut);var mt=n(ut);return[ut,2*t(E(mt*mt+We*We-yt*yt)-mt,We-yt)]}:function(ut,yt){return[ut,P(ut?yt*c(ut)/ut:yt)]},rt}ze.invert=function(Ue,We){var rt=(rt=We/k-1)*rt;return[rt>0?Ue*E(x/rt)/2:0,P(1-rt)]};var De=E(3);function Xe(Ue,We){return[De*Ue*(2*n(2*We/3)-1)/k,De*k*p(We/3)]}function Be(Ue){var We=n(Ue);function rt(ut,yt){return[ut*We,p(yt)/We]}return rt.invert=function(ut,yt){return[ut/We,P(yt*We)]},rt}function Ie(Ue){var We=n(Ue);function rt(ut,yt){return[ut*We,(1+We)*c(yt/2)]}return rt.invert=function(ut,yt){return[ut/We,2*e(yt/(1+We))]},rt}function Re(Ue,We){var rt=E(8/(3*x));return[rt*Ue*(1-y(We)/x),rt*We]}function Ye(Ue,We){var rt=E(4-3*p(y(We)));return[2/E(6*x)*Ue*rt,o(We)*E(2*x/3)*(2-rt)]}function Qe(Ue,We){var rt=E(x*(4+x));return[2/rt*Ue*(1+E(1-4*We*We/(x*x))),4/rt*We]}function lt(Ue,We){var rt=(2+f)*p(We);We/=2;for(var ut=0,yt=1/0;ut<10&&y(yt)>i;ut++){var mt=n(We);We-=yt=(We+p(We)*(mt+2)-rt)/(2*mt*(1+mt))}return[2/E(x*(4+x))*Ue*(1+n(We)),2*E(x/(4+x))*p(We)]}function xt(Ue,We){return[Ue*(1+n(We))/E(2+x),2*We/E(2+x)]}function wt(Ue,We){for(var rt=(1+f)*p(We),ut=0,yt=1/0;ut<10&&y(yt)>i;ut++)We-=yt=(We+p(We)-rt)/(1+n(We));return rt=E(2+x),[Ue*(1+n(We))/rt,2*We/rt]}Xe.invert=function(Ue,We){var rt=3*P(We/(De*k));return[k*Ue/(De*(2*n(2*rt/3)-1)),rt]},Re.invert=function(Ue,We){var rt=E(8/(3*x)),ut=We/rt;return[Ue/(rt*(1-y(ut)/x)),ut]},Ye.invert=function(Ue,We){var rt=2-y(We)/E(2*x/3);return[Ue*E(6*x)/(2*rt),o(We)*P((4-rt*rt)/3)]},Qe.invert=function(Ue,We){var rt=E(x*(4+x))/2;return[Ue*rt/(1+E(1-We*We*(4+x)/(4*x))),We*rt/2]},lt.invert=function(Ue,We){var rt=We*E((4+x)/x)/2,ut=P(rt),yt=n(ut);return[Ue/(2/E(x*(4+x))*(1+yt)),P((ut+rt*(yt+2))/(2+f))]},xt.invert=function(Ue,We){var rt=E(2+x),ut=We*rt/2;return[rt*Ue/(1+n(ut)),ut]},wt.invert=function(Ue,We){var rt=1+f,ut=E(rt/2);return[2*Ue*ut/(1+n(We*=ut)),P((We+p(We))/rt)]};var bt=3+2*T;function nt(Ue,We){var rt=p(Ue/=2),ut=n(Ue),yt=E(n(We)),mt=n(We/=2),Lt=p(We)/(mt+T*ut*yt),$t=E(2/(1+Lt*Lt)),er=E((T*mt+(ut+rt)*yt)/(T*mt+(ut-rt)*yt));return[bt*($t*(er-1/er)-2*g(er)),bt*($t*Lt*(er+1/er)-2*e(Lt))]}nt.invert=function(Ue,We){if(!(rt=Q.invert(Ue/1.2,1.065*We)))return null;var rt,ut=rt[0],yt=rt[1],mt=20;Ue/=bt,We/=bt;do{var Lt=ut/2,$t=yt/2,er=p(Lt),Zt=n(Lt),or=p($t),mr=n($t),wr=n(yt),Tr=E(wr),Rr=or/(mr+T*Zt*Tr),on=Rr*Rr,mn=E(2/(1+on)),In=(T*mr+(Zt+er)*Tr)/(T*mr+(Zt-er)*Tr),zn=E(In),qn=zn-1/zn,Rn=zn+1/zn,vi=mn*qn-2*g(zn)-Ue,Si=mn*Rr*Rn-2*e(Rr)-We,Ui=or&&b*Tr*er*on/or,ji=(T*Zt*mr+Tr)/(2*(mr+T*Zt*Tr)*(mr+T*Zt*Tr)*Tr),Vi=-.5*Rr*mn*mn*mn,Aa=Vi*Ui,Ta=Vi*ji,ca=(ca=2*mr+T*Tr*(Zt-er))*ca*zn,ua=(T*Zt*mr*Tr+wr)/ca,ka=-T*er*or/(Tr*ca),Ha=qn*Aa-2*ua/zn+mn*(ua+ua/In),no=qn*Ta-2*ka/zn+mn*(ka+ka/In),io=Rr*Rn*Aa-2*Ui/(1+on)+mn*Rn*Ui+mn*Rr*(ua-ua/In),ao=Rr*Rn*Ta-2*ji/(1+on)+mn*Rn*ji+mn*Rr*(ka-ka/In),oo=no*io-ao*Ha;if(!oo)break;var zi=(Si*no-vi*ao)/oo,dt=(vi*io-Si*Ha)/oo;ut-=zi,yt=u(-f,s(f,yt-dt))}while((y(zi)>i||y(dt)>i)&&--mt>0);return y(y(yt)-f)<i?[0,yt]:mt&&[ut,yt]};var $e=n(35*I);function vt(Ue,We){var rt=c(We/2);return[Ue*$e*E(1-rt*rt),(1+$e)*rt]}function Nt(Ue,We){var rt=We/2,ut=n(rt);return[2*Ue/k*n(We)*ut*ut,k*c(rt)]}function qt(Ue){var We=1-Ue,rt=yt(x,0)[0]-yt(-x,0)[0],ut=E(2*(yt(0,f)[1]-yt(0,-f)[1])/rt);function yt($t,er){var Zt=n(er),or=p(er);return[Zt/(We+Ue*Zt)*$t,We*er+Ue*or]}function mt($t,er){var Zt=yt($t,er);return[Zt[0]*ut,Zt[1]/ut]}function Lt($t){return mt(0,$t)[1]}return mt.invert=function($t,er){var Zt=te(Lt,er);return[$t/ut*(Ue+We/n(Zt)),Zt]},mt}function Jt(Ue){return[Ue[0]/2,P(c(Ue[1]/2*I))*A]}function Wt(Ue){return[2*Ue[0],2*e(p(Ue[1]*I))*A]}function ar(Ue,We){var rt=2*x/We,ut=Ue*Ue;function yt(mt,Lt){var $t=v.geoAzimuthalEquidistantRaw(mt,Lt),er=$t[0],Zt=$t[1],or=er*er+Zt*Zt;if(or>ut){var mr=E(or),wr=t(Zt,er),Tr=rt*l(wr/rt),Rr=wr-Tr,on=Ue*n(Rr),mn=(Ue*p(Rr)-Rr*p(on))/(f-on),In=Dt(Rr,mn),zn=(x-Ue)/Ne(In,on,x);er=mr;var qn,Rn=50;do er-=qn=(Ue+Ne(In,on,er)*zn-mr)/(In(er)*zn);while(y(qn)>i&&--Rn>0);Zt=Rr*p(er),er<f&&(Zt-=mn*(er-f));var vi=p(Tr),Si=n(Tr);$t[0]=er*Si-Zt*vi,$t[1]=er*vi+Zt*Si}return $t}return yt.invert=function(mt,Lt){var $t=mt*mt+Lt*Lt;if($t>ut){var er=E($t),Zt=t(Lt,mt),or=rt*l(Zt/rt),mr=Zt-or;mt=er*n(mr),Lt=er*p(mr);for(var wr=mt-f,Tr=p(mt),Rr=Lt/Tr,on=mt<f?1/0:0,mn=10;;){var In=Ue*p(Rr),zn=Ue*n(Rr),qn=p(zn),Rn=f-zn,vi=(In-Rr*qn)/Rn,Si=Dt(Rr,vi);if(y(on)<1e-12||!--mn)break;Rr-=on=(Rr*Tr-vi*wr-Lt)/(Tr-2*wr*(Rn*(zn+Rr*In*n(zn)-qn)-In*(In-Rr*qn))/(Rn*Rn))}mt=(er=Ue+Ne(Si,zn,mt)*(x-Ue)/Ne(Si,zn,x))*n(Zt=or+Rr),Lt=er*p(Zt)}return v.geoAzimuthalEquidistantRaw.invert(mt,Lt)},yt}function Dt(Ue,We){return function(rt){var ut=Ue*n(rt);return rt<f&&(ut-=We),E(1+ut*ut)}}function Ne(Ue,We,rt){for(var ut=(rt-We)/50,yt=Ue(We)+Ue(rt),mt=1,Lt=We;mt<50;++mt)yt+=2*Ue(Lt+=ut);return .5*yt*ut}function qe(Ue,We,rt,ut,yt,mt,Lt,$t){function er(Zt,or){if(!or)return[Ue*Zt/x,0];var mr=or*or,wr=Ue+mr*(We+mr*(rt+mr*ut)),Tr=or*(yt-1+mr*(mt-$t+mr*Lt)),Rr=(wr*wr+Tr*Tr)/(2*Tr),on=Zt*P(wr/Rr)/x;return[Rr*p(on),or*(1+mr*$t)+Rr*(1-n(on))]}return arguments.length<8&&($t=0),er.invert=function(Zt,or){var mr,wr,Tr=x*Zt/Ue,Rr=or,on=50;do{var mn=Rr*Rr,In=Ue+mn*(We+mn*(rt+mn*ut)),zn=Rr*(yt-1+mn*(mt-$t+mn*Lt)),qn=In*In+zn*zn,Rn=2*zn,vi=qn/Rn,Si=vi*vi,Ui=P(In/vi)/x,ji=Tr*Ui,Vi=In*In,Aa=(2*We+mn*(4*rt+6*mn*ut))*Rr,Ta=yt+mn*(3*mt+5*mn*Lt),ca=(2*(In*Aa+zn*(Ta-1))*Rn-qn*(2*(Ta-1)))/(Rn*Rn),ua=n(ji),ka=p(ji),Ha=vi*ua,no=vi*ka,io=Tr/x*(1/E(1-Vi/Si))*(Aa*vi-In*ca)/Si,ao=no-Zt,oo=Rr*(1+mn*$t)+vi-Ha-or,zi=ca*ka+Ha*io,dt=Ha*Ui,Rt=1+ca-(ca*ua-no*io),cr=no*Ui,Gt=zi*cr-Rt*dt;if(!Gt)break;Tr-=mr=(oo*zi-ao*Rt)/Gt,Rr-=wr=(ao*cr-oo*dt)/Gt}while((y(mr)>i||y(wr)>i)&&--on>0);return[Tr,Rr]},er}vt.invert=function(Ue,We){var rt=We/(1+$e);return[Ue&&Ue/($e*E(1-rt*rt)),2*e(rt)]},Nt.invert=function(Ue,We){var rt=e(We/k),ut=n(rt),yt=2*rt;return[Ue*k/2/(n(yt)*ut*ut),yt]};var pe=qe(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),be=qe(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Fe=qe(5/6*x,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Ve(Ue,We){var rt=Ue*Ue,ut=We*We;return[Ue*(1-.162388*ut)*(.87-952426e-9*rt*rt),We*(1+ut/12)]}Ve.invert=function(Ue,We){var rt,ut=Ue,yt=We,mt=50;do{var Lt=yt*yt;yt-=rt=(yt*(1+Lt/12)-We)/(1+Lt/4)}while(y(rt)>i&&--mt>0);mt=50,Ue/=1-.162388*Lt;do{var $t=($t=ut*ut)*$t;ut-=rt=(ut*(.87-952426e-9*$t)-Ue)/(.87-.00476213*$t)}while(y(rt)>i&&--mt>0);return[ut,yt]};var Ke=qe(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Ge(Ue){var We=Ue(f,0)[0]-Ue(-f,0)[0];function rt(ut,yt){var mt=ut>0?-.5:.5,Lt=Ue(ut+mt*x,yt);return Lt[0]-=mt*We,Lt}return Ue.invert&&(rt.invert=function(ut,yt){var mt=ut>0?-.5:.5,Lt=Ue.invert(ut+mt*We,yt),$t=Lt[0]-mt*x;return $t<-x?$t+=2*x:$t>x&&($t-=2*x),Lt[0]=$t,Lt}),rt}function ct(Ue,We){var rt=o(Ue),ut=o(We),yt=n(We),mt=n(Ue)*yt,Lt=p(Ue)*yt,$t=p(ut*We);Ue=y(t(Lt,$t)),We=P(mt),y(Ue-f)>i&&(Ue%=f);var er=function(Zt,or){if(or===f)return[0,0];var mr,wr,Tr=p(or),Rr=Tr*Tr,on=Rr*Rr,mn=1+on,In=1+3*on,zn=1-on,qn=P(1/E(mn)),Rn=zn+Rr*mn*qn,vi=(1-Tr)/Rn,Si=E(vi),Ui=vi*mn,ji=E(Ui),Vi=Si*zn;if(Zt===0)return[0,-(Vi+Rr*ji)];var Aa,Ta=n(or),ca=1/Ta,ua=2*Tr*Ta,ka=(-Rn*Ta-(-3*Rr+qn*In)*ua*(1-Tr))/(Rn*Rn),Ha=-ca*ua,no=-ca*(Rr*mn*ka+vi*In*ua),io=-2*ca*(zn*(.5*ka/Si)-2*Rr*Si*ua),ao=4*Zt/x;if(Zt>.222*x||or<x/4&&Zt>.175*x){if(mr=(Vi+Rr*E(Ui*(1+on)-Vi*Vi))/(1+on),Zt>x/4)return[mr,mr];var oo=mr,zi=.5*mr;mr=.5*(zi+oo),wr=50;do{var dt=E(Ui-mr*mr),Rt=mr*(io+Ha*dt)+no*P(mr/ji)-ao;if(!Rt)break;Rt<0?zi=mr:oo=mr,mr=.5*(zi+oo)}while(y(oo-zi)>i&&--wr>0)}else{mr=i,wr=25;do{var cr=mr*mr,Gt=E(Ui-cr),ur=io+Ha*Gt,Or=mr*ur+no*P(mr/ji)-ao,Ur=ur+(no-Ha*cr)/Gt;mr-=Aa=Gt?Or/Ur:0}while(y(Aa)>i&&--wr>0)}return[mr,-Vi-Rr*E(Ui-mr*mr)]}(Ue>x/4?f-Ue:Ue,We);return Ue>x/4&&($t=er[0],er[0]=-er[1],er[1]=-$t),er[0]*=rt,er[1]*=-ut,er}function st(Ue,We){var rt,ut,yt,mt,Lt,$t;if(We<i)return[(mt=p(Ue))-(rt=We*(Ue-mt*(ut=n(Ue)))/4)*ut,ut+rt*mt,1-We*mt*mt/2,Ue-rt];if(We>=1-i)return rt=(1-We)/4,yt=1/(ut=D(Ue)),[(mt=(($t=a(2*($t=Ue)))-1)/($t+1))+rt*((Lt=ut*z(Ue))-Ue)/(ut*ut),yt-rt*mt*yt*(Lt-Ue),yt+rt*mt*yt*(Lt+Ue),2*e(a(Ue))-f+rt*(Lt-Ue)/ut];var er=[1,0,0,0,0,0,0,0,0],Zt=[E(We),0,0,0,0,0,0,0,0],or=0;for(ut=E(1-We),Lt=1;y(Zt[or]/er[or])>i&&or<8;)rt=er[or++],Zt[or]=(rt-ut)/2,er[or]=(rt+ut)/2,ut=E(rt*ut),Lt*=2;yt=Lt*er[or]*Ue;do yt=(P(mt=Zt[or]*p(ut=yt)/er[or])+yt)/2;while(--or);return[p(yt),mt=n(yt),mt/n(yt-ut),yt]}function Mt(Ue,We){if(!We)return Ue;if(We===1)return g(c(Ue/2+_));for(var rt=1,ut=E(1-We),yt=E(We),mt=0;y(yt)>i;mt++){if(Ue%x){var Lt=e(ut*c(Ue)/rt);Lt<0&&(Lt+=x),Ue+=Lt+~~(Ue/x)*x}else Ue+=Ue;yt=(rt+ut)/2,ut=E(rt*ut),yt=((rt=yt)-ut)/2}return Ue/(h(2,mt)*rt)}function Ot(Ue,We){var rt=(T-1)/(T+1),ut=E(1-rt*rt),yt=Mt(f,ut*ut),mt=g(c(x/4+y(We)/2)),Lt=a(-1*mt)/E(rt),$t=function(Zt,or){var mr=Zt*Zt,wr=or+1,Tr=1-mr-or*or;return[.5*((Zt>=0?f:-f)-t(Tr,2*Zt)),-.25*g(Tr*Tr+4*mr)+.5*g(wr*wr+mr)]}(Lt*n(-1*Ue),Lt*p(-1*Ue)),er=function(Zt,or,mr){var wr=y(Zt),Tr=z(y(or));if(wr){var Rr=1/p(wr),on=1/(c(wr)*c(wr)),mn=-(on+mr*(Tr*Tr*Rr*Rr)-1+mr),In=(-mn+E(mn*mn-4*((mr-1)*on)))/2;return[Mt(e(1/E(In)),mr)*o(Zt),Mt(e(E((In/on-1)/mr)),1-mr)*o(or)]}return[0,Mt(e(Tr),1-mr)*o(or)]}($t[0],$t[1],ut*ut);return[-er[1],(We>=0?1:-1)*(.5*yt-er[0])]}function it(Ue){var We=p(Ue),rt=n(Ue),ut=ht(Ue);function yt(mt,Lt){var $t=ut(mt,Lt);mt=$t[0],Lt=$t[1];var er=p(Lt),Zt=n(Lt),or=n(mt),mr=S(We*er+rt*Zt*or),wr=p(mr),Tr=y(wr)>i?mr/wr:1;return[Tr*rt*p(mt),(y(mt)>f?Tr:-Tr)*(We*Zt-rt*er*or)]}return ut.invert=ht(-Ue),yt.invert=function(mt,Lt){var $t=E(mt*mt+Lt*Lt),er=-p($t),Zt=n($t),or=$t*Zt,mr=-Lt*er,wr=$t*We,Tr=E(or*or+mr*mr-wr*wr),Rr=t(or*wr+mr*Tr,mr*wr-or*Tr),on=($t>f?-1:1)*t(mt*er,$t*n(Rr)*Zt+Lt*p(Rr)*er);return ut.invert(on,Rr)},yt}function ht(Ue){var We=p(Ue),rt=n(Ue);return function(ut,yt){var mt=n(yt),Lt=n(ut)*mt,$t=p(ut)*mt,er=p(yt);return[t($t,Lt*rt-er*We),P(er*rt+Lt*We)]}}ct.invert=function(Ue,We){y(Ue)>1&&(Ue=2*o(Ue)-Ue),y(We)>1&&(We=2*o(We)-We);var rt=o(Ue),ut=o(We),yt=-rt*Ue,mt=-ut*We,Lt=mt/yt<1,$t=function(mr,wr){for(var Tr=0,Rr=1,on=.5,mn=50;;){var In=on*on,zn=E(on),qn=P(1/E(1+In)),Rn=1-In+on*(1+In)*qn,vi=(1-zn)/Rn,Si=E(vi),Ui=vi*(1+In),ji=Si*(1-In),Vi=E(Ui-mr*mr),Aa=wr+ji+on*Vi;if(y(Rr-Tr)<1e-12||--mn==0||Aa===0)break;Aa>0?Tr=on:Rr=on,on=.5*(Tr+Rr)}if(!mn)return null;var Ta=P(zn),ca=n(Ta),ua=1/ca,ka=2*zn*ca,Ha=(-Rn*ca-(-3*on+qn*(1+3*In))*ka*(1-zn))/(Rn*Rn);return[x/4*(mr*(-2*ua*(.5*Ha/Si*(1-In)-2*on*Si*ka)+-ua*ka*Vi)+-ua*(on*(1+In)*Ha+vi*(1+3*In)*ka)*P(mr/E(Ui))),Ta]}(Lt?mt:yt,Lt?yt:mt),er=$t[0],Zt=$t[1],or=n(Zt);return Lt&&(er=-f-er),[rt*(t(p(er)*or,-p(Zt))+x),ut*P(n(er)*or)]},Ot.invert=function(Ue,We){var rt,ut,yt,mt,Lt,$t,er=(T-1)/(T+1),Zt=E(1-er*er),or=Mt(f,Zt*Zt),mr=(ut=-Ue,yt=Zt*Zt,(rt=.5*or-We)?(mt=st(rt,yt),ut?($t=(Lt=st(ut,1-yt))[1]*Lt[1]+yt*mt[0]*mt[0]*Lt[0]*Lt[0],[[mt[0]*Lt[2]/$t,mt[1]*mt[2]*Lt[0]*Lt[1]/$t],[mt[1]*Lt[1]/$t,-mt[0]*mt[2]*Lt[0]*Lt[2]/$t],[mt[2]*Lt[1]*Lt[2]/$t,-yt*mt[0]*mt[1]*Lt[0]/$t]]):[[mt[0],0],[mt[1],0],[mt[2],0]]):[[0,(Lt=st(ut,1-yt))[0]/Lt[1]],[1/Lt[1],0],[Lt[2]/Lt[1],0]]),wr=function(Tr,Rr){var on=Rr[0]*Rr[0]+Rr[1]*Rr[1];return[(Tr[0]*Rr[0]+Tr[1]*Rr[1])/on,(Tr[1]*Rr[0]-Tr[0]*Rr[1])/on]}(mr[0],mr[1]);return[t(wr[1],wr[0])/-1,2*e(a(-.5*g(er*wr[0]*wr[0]+er*wr[1]*wr[1])))-f]};var jt=P(1-1/3)*A,kt=Be(0);function Pt(Ue){var We=jt*I,rt=ze(x,We)[0]-ze(-x,We)[0],ut=kt(0,We)[1],yt=ze(0,We)[1],mt=k-yt,Lt=L/Ue,$t=4/L,er=ut+mt*mt*4/L;function Zt(or,mr){var wr,Tr=y(mr);if(Tr>We){var Rr=s(Ue-1,u(0,r((or+x)/Lt)));(wr=ze(or+=x*(Ue-1)/Ue-Rr*Lt,Tr))[0]=wr[0]*L/rt-L*(Ue-1)/(2*Ue)+Rr*L/Ue,wr[1]=ut+4*(wr[1]-yt)*mt/L,mr<0&&(wr[1]=-wr[1])}else wr=kt(or,mr);return wr[0]*=$t,wr[1]/=er,wr}return Zt.invert=function(or,mr){or/=$t;var wr=y(mr*=er);if(wr>ut){var Tr=s(Ue-1,u(0,r((or+x)/Lt)));or=(or+x*(Ue-1)/Ue-Tr*Lt)*rt/L;var Rr=ze.invert(or,.25*(wr-ut)*L/mt+yt);return Rr[0]-=x*(Ue-1)/Ue-Tr*Lt,mr<0&&(Rr[1]=-Rr[1]),Rr}return kt.invert(or,mr)},Zt}function Ee(Ue,We){return[Ue,1&We?90-i:jt]}function Ze(Ue,We){return[Ue,1&We?-90+i:-jt]}function at(Ue){return[Ue[0]*(1-i),Ue[1]]}function pt(Ue){var We,rt=1+Ue,ut=P(p(1/rt)),yt=2*E(x/(We=x+4*ut*rt)),mt=.5*yt*(rt+E(Ue*(2+Ue))),Lt=Ue*Ue,$t=rt*rt;function er(Zt,or){var mr,wr,Tr=1-p(or);if(Tr&&Tr<2){var Rr,on=f-or,mn=25;do{var In=p(on),zn=n(on),qn=ut+t(In,rt-zn),Rn=1+$t-2*rt*zn;on-=Rr=(on-Lt*ut-rt*In+Rn*qn-.5*Tr*We)/(2*rt*In*qn)}while(y(Rr)>1e-12&&--mn>0);mr=yt*E(Rn),wr=Zt*qn/x}else mr=yt*(Ue+Tr),wr=Zt*ut/x;return[mr*p(wr),mt-mr*n(wr)]}return er.invert=function(Zt,or){var mr=Zt*Zt+(or-=mt)*or,wr=(1+$t-mr/(yt*yt))/(2*rt),Tr=S(wr),Rr=p(Tr),on=ut+t(Rr,rt-wr);return[P(Zt/E(mr))*x/on,P(1-2*(Tr-Lt*ut-rt*Rr+(1+$t-2*rt*wr)*on)/We)]},er}function St(Ue,We){return We>-.7109889596207567?((Ue=re(Ue,We))[1]+=.0528035274542,Ue):ve(Ue,We)}function Ut(Ue,We){return y(We)>.7109889596207567?((Ue=re(Ue,We))[1]-=We>0?.0528035274542:-.0528035274542,Ue):ve(Ue,We)}function Kt(Ue,We,rt,ut){var yt=E(4*x/(2*rt+(1+Ue-We/2)*p(2*rt)+(Ue+We)/2*p(4*rt)+We/2*p(6*rt))),mt=E(ut*p(rt)*E((1+Ue*n(2*rt)+We*n(4*rt))/(1+Ue+We))),Lt=rt*er(1);function $t(mr){return E(1+Ue*n(2*mr)+We*n(4*mr))}function er(mr){var wr=mr*rt;return(2*wr+(1+Ue-We/2)*p(2*wr)+(Ue+We)/2*p(4*wr)+We/2*p(6*wr))/rt}function Zt(mr){return $t(mr)*p(mr)}var or=function(mr,wr){var Tr=rt*te(er,Lt*p(wr)/rt,wr/x);isNaN(Tr)&&(Tr=rt*o(wr));var Rr=yt*$t(Tr);return[Rr*mt*mr/x*n(Tr),Rr/mt*p(Tr)]};return or.invert=function(mr,wr){var Tr=te(Zt,wr*mt/yt);return[mr*x/(n(Tr)*yt*mt*$t(Tr)),P(rt*er(Tr/rt)/Lt)]},rt===0&&(yt=E(ut/x),(or=function(mr,wr){return[mr*yt,p(wr)/yt]}).invert=function(mr,wr){return[mr/yt,P(wr*yt)]}),or}function Ht(Ue,We,rt,ut,yt){ut===void 0&&(ut=1e-8),yt===void 0&&(yt=20);var mt=Ue(We),Lt=Ue(.5*(We+rt)),$t=Ue(rt);return function er(Zt,or,mr,wr,Tr,Rr,on,mn,In,zn,qn){if(qn.nanEncountered)return NaN;var Rn,vi,Si,Ui,ji,Vi,Aa,Ta,ca,ua;if(vi=Zt(or+.25*(Rn=mr-or)),Si=Zt(mr-.25*Rn),isNaN(vi))qn.nanEncountered=!0;else{if(!isNaN(Si))return ua=((Vi=(Ui=Rn*(wr+4*vi+Tr)/12)+(ji=Rn*(Tr+4*Si+Rr)/12))-on)/15,zn>In?(qn.maxDepthCount++,Vi+ua):Math.abs(ua)<mn?Vi+ua:(Ta=er(Zt,or,Aa=or+.5*Rn,wr,vi,Tr,Ui,.5*mn,In,zn+1,qn),isNaN(Ta)?(qn.nanEncountered=!0,NaN):(ca=er(Zt,Aa,mr,Tr,Si,Rr,ji,.5*mn,In,zn+1,qn),isNaN(ca)?(qn.nanEncountered=!0,NaN):Ta+ca));qn.nanEncountered=!0}}(Ue,We,rt,mt,Lt,$t,(mt+4*Lt+$t)*(rt-We)/6,ut,yt,1,{maxDepthCount:0,nanEncountered:!1})}function pr(Ue,We,rt){function ut(Tr){return Ue+(1-Ue)*h(1-h(Tr,We),1/We)}function yt(Tr){return Ht(ut,0,Tr,1e-4)}for(var mt=1/yt(1),Lt=1e3,$t=(1+1e-8)*mt,er=[],Zt=0;Zt<=Lt;Zt++)er.push(yt(Zt/Lt)*$t);function or(Tr){var Rr=0,on=Lt,mn=500;do er[mn]>Tr?on=mn:Rr=mn,mn=Rr+on>>1;while(mn>Rr);var In=er[mn+1]-er[mn];return In&&(In=(Tr-er[mn+1])/In),(mn+1+In)/Lt}var mr=2*or(1)/x*mt/rt,wr=function(Tr,Rr){var on=or(y(p(Rr))),mn=ut(on)*Tr;return on/=mr,[mn,Rr>=0?on:-on]};return wr.invert=function(Tr,Rr){var on;return y(Rr*=mr)<1&&(on=o(Rr)*P(yt(y(Rr))*mt)),[Tr/ut(y(Rr)),on]},wr}function Mr(Ue,We){return y(Ue[0]-We[0])<i&&y(Ue[1]-We[1])<i}function hr(Ue,We){for(var rt,ut,yt,mt=-1,Lt=Ue.length,$t=Ue[0],er=[];++mt<Lt;){ut=((rt=Ue[mt])[0]-$t[0])/We,yt=(rt[1]-$t[1])/We;for(var Zt=0;Zt<We;++Zt)er.push([$t[0]+Zt*ut,$t[1]+Zt*yt]);$t=rt}return er.push(rt),er}function Qt(Ue){var We,rt,ut,yt,mt,Lt,$t,er=[],Zt=Ue[0].length;for($t=0;$t<Zt;++$t)rt=(We=Ue[0][$t])[0][0],ut=We[0][1],yt=We[1][1],mt=We[2][0],Lt=We[2][1],er.push(hr([[rt+i,ut+i],[rt+i,yt-i],[mt-i,yt-i],[mt-i,Lt+i]],30));for($t=Ue[1].length-1;$t>=0;--$t)rt=(We=Ue[1][$t])[0][0],ut=We[0][1],yt=We[1][1],mt=We[2][0],Lt=We[2][1],er.push(hr([[mt-i,Lt-i],[mt-i,yt+i],[rt+i,yt+i],[rt+i,ut-i]],30));return{type:"Polygon",coordinates:[w.merge(er)]}}function tr(Ue,We,rt){var ut,yt;function mt(er,Zt){for(var or=Zt<0?-1:1,mr=We[+(Zt<0)],wr=0,Tr=mr.length-1;wr<Tr&&er>mr[wr][2][0];++wr);var Rr=Ue(er-mr[wr][1][0],Zt);return Rr[0]+=Ue(mr[wr][1][0],or*Zt>or*mr[wr][0][1]?mr[wr][0][1]:Zt)[0],Rr}rt?mt.invert=rt(mt):Ue.invert&&(mt.invert=function(er,Zt){for(var or=yt[+(Zt<0)],mr=We[+(Zt<0)],wr=0,Tr=or.length;wr<Tr;++wr){var Rr=or[wr];if(Rr[0][0]<=er&&er<Rr[1][0]&&Rr[0][1]<=Zt&&Zt<Rr[1][1]){var on=Ue.invert(er-Ue(mr[wr][1][0],0)[0],Zt);return on[0]+=mr[wr][1][0],Mr(mt(on[0],on[1]),[er,Zt])?on:null}}});var Lt=v.geoProjection(mt),$t=Lt.stream;return Lt.stream=function(er){var Zt=Lt.rotate(),or=$t(er),mr=(Lt.rotate([0,0]),$t(er));return Lt.rotate(Zt),or.sphere=function(){v.geoStream(ut,mr)},or},Lt.lobes=function(er){return arguments.length?(ut=Qt(er),We=er.map(function(Zt){return Zt.map(function(or){return[[or[0][0]*I,or[0][1]*I],[or[1][0]*I,or[1][1]*I],[or[2][0]*I,or[2][1]*I]]})}),yt=We.map(function(Zt){return Zt.map(function(or){var mr,wr=Ue(or[0][0],or[0][1])[0],Tr=Ue(or[2][0],or[2][1])[0],Rr=Ue(or[1][0],or[0][1])[1],on=Ue(or[1][0],or[1][1])[1];return Rr>on&&(mr=Rr,Rr=on,on=mr),[[wr,Rr],[Tr,on]]})}),Lt):We.map(function(Zt){return Zt.map(function(or){return[[or[0][0]*A,or[0][1]*A],[or[1][0]*A,or[1][1]*A],[or[2][0]*A,or[2][1]*A]]})})},We!=null&&Lt.lobes(We),Lt}St.invert=function(Ue,We){return We>-.7109889596207567?re.invert(Ue,We-.0528035274542):ve.invert(Ue,We)},Ut.invert=function(Ue,We){return y(We)>.7109889596207567?re.invert(Ue,We+(We>0?.0528035274542:-.0528035274542)):ve.invert(Ue,We)};var rr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],fr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],yr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Sr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Dr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Nr=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Wr(Ue,We){return[3/L*Ue*E(x*x/3-We*We),We]}function hn(Ue){function We(rt,ut){if(y(y(ut)-f)<i)return[0,ut<0?-2:2];var yt=p(ut),mt=h((1+yt)/(1-yt),Ue/2),Lt=.5*(mt+1/mt)+n(rt*=Ue);return[2*p(rt)/Lt,(mt-1/mt)/Lt]}return We.invert=function(rt,ut){var yt=y(ut);if(y(yt-2)<i)return rt?null:[0,o(ut)*f];if(yt>2)return null;var mt=(rt/=2)*rt,Lt=(ut/=2)*ut,$t=2*ut/(1+mt+Lt);return $t=h((1+$t)/(1-$t),1/Ue),[t(2*rt,1-mt-Lt)/Ue,P(($t-1)/($t+1))]},We}Wr.invert=function(Ue,We){return[L/3*Ue/E(x*x/3-We*We),We]};var tn=x/T;function Fn(Ue,We){return[Ue*(1+E(n(We)))/2,We/(n(We/2)*n(Ue/6))]}function an(Ue,We){var rt=Ue*Ue,ut=We*We;return[Ue*(.975534+ut*(-.0143059*rt-.119161+-.0547009*ut)),We*(1.00384+rt*(.0802894+-.02855*ut+199025e-9*rt)+ut*(.0998909+-.0491032*ut))]}function xn(Ue,We){return[p(Ue)/n(We),c(We)*n(Ue)]}function _n(Ue){var We=n(Ue),rt=c(_+Ue/2);function ut(yt,mt){var Lt=mt-Ue,$t=y(Lt)<i?yt*We:y($t=_+mt/2)<i||y(y($t)-f)<i?0:yt*Lt/g(c($t)/rt);return[$t,Lt]}return ut.invert=function(yt,mt){var Lt,$t=mt+Ue;return[y(mt)<i?yt/We:y(Lt=_+$t/2)<i||y(y(Lt)-f)<i?0:yt*g(c(Lt)/rt)/mt,$t]},ut}function ti(Ue,We){return[Ue,1.25*g(c(_+.4*We))]}function jr(Ue){var We=Ue.length-1;function rt(ut,yt){for(var mt,Lt=n(yt),$t=2/(1+Lt*n(ut)),er=$t*Lt*p(ut),Zt=$t*p(yt),or=We,mr=Ue[or],wr=mr[0],Tr=mr[1];--or>=0;)wr=(mr=Ue[or])[0]+er*(mt=wr)-Zt*Tr,Tr=mr[1]+er*Tr+Zt*mt;return[wr=er*(mt=wr)-Zt*Tr,Tr=er*Tr+Zt*mt]}return rt.invert=function(ut,yt){var mt=20,Lt=ut,$t=yt;do{for(var er,Zt=We,or=Ue[Zt],mr=or[0],wr=or[1],Tr=0,Rr=0;--Zt>=0;)Tr=mr+Lt*(er=Tr)-$t*Rr,Rr=wr+Lt*Rr+$t*er,mr=(or=Ue[Zt])[0]+Lt*(er=mr)-$t*wr,wr=or[1]+Lt*wr+$t*er;var on,mn,In=(Tr=mr+Lt*(er=Tr)-$t*Rr)*Tr+(Rr=wr+Lt*Rr+$t*er)*Rr;Lt-=on=((mr=Lt*(er=mr)-$t*wr-ut)*Tr+(wr=Lt*wr+$t*er-yt)*Rr)/In,$t-=mn=(wr*Tr-mr*Rr)/In}while(y(on)+y(mn)>1e-12&&--mt>0);if(mt){var zn=E(Lt*Lt+$t*$t),qn=2*e(.5*zn),Rn=p(qn);return[t(Lt*Rn,zn*n(qn)),zn?P($t*Rn/zn):0]}},rt}Fn.invert=function(Ue,We){var rt=y(Ue),ut=y(We),yt=i,mt=f;ut<tn?mt*=ut/tn:yt+=6*S(tn/ut);for(var Lt=0;Lt<25;Lt++){var $t=p(mt),er=E(n(mt)),Zt=p(mt/2),or=n(mt/2),mr=p(yt/6),wr=n(yt/6),Tr=.5*yt*(1+er)-rt,Rr=mt/(or*wr)-ut,on=er?-.25*yt*$t/er:0,mn=.5*(1+er),In=(1+.5*mt*Zt/or)/(or*wr),zn=mt/or*(mr/6)/(wr*wr),qn=on*zn-In*mn,Rn=(Tr*zn-Rr*mn)/qn,vi=(Rr*on-Tr*In)/qn;if(mt-=Rn,yt-=vi,y(Rn)<i&&y(vi)<i)break}return[Ue<0?-yt:yt,We<0?-mt:mt]},an.invert=function(Ue,We){var rt=o(Ue)*x,ut=We/2,yt=50;do{var mt=rt*rt,Lt=ut*ut,$t=rt*ut,er=rt*(.975534+Lt*(-.0143059*mt-.119161+-.0547009*Lt))-Ue,Zt=ut*(1.00384+mt*(.0802894+-.02855*Lt+199025e-9*mt)+Lt*(.0998909+-.0491032*Lt))-We,or=.975534-Lt*(.119161+3*mt*.0143059+.0547009*Lt),mr=-$t*(.238322+.2188036*Lt+.0286118*mt),wr=$t*(.1605788+7961e-7*mt+-.0571*Lt),Tr=1.00384+mt*(.0802894+199025e-9*mt)+Lt*(3*(.0998909-.02855*mt)-.245516*Lt),Rr=mr*wr-Tr*or,on=(Zt*mr-er*Tr)/Rr,mn=(er*wr-Zt*or)/Rr;rt-=on,ut-=mn}while((y(on)>i||y(mn)>i)&&--yt>0);return yt&&[rt,ut]},xn.invert=function(Ue,We){var rt=Ue*Ue,ut=We*We+1,yt=rt+ut,mt=Ue?b*E((yt-E(yt*yt-4*rt))/rt):1/E(ut);return[P(Ue*mt),o(We)*S(mt)]},ti.invert=function(Ue,We){return[Ue,2.5*e(a(.8*We))-.625*x]};var nn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],vn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],en=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],fn=[[.9245,0],[0,0],[.01943,0]],Gn=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Tn(Ue,We){var rt=v.geoProjection(jr(Ue)).rotate(We).clipAngle(90),ut=v.geoRotation(We),yt=rt.center;return delete rt.rotate,rt.center=function(mt){return arguments.length?yt(ut(mt)):ut.invert(yt())},rt}var Cn=E(6),oi=E(7);function nr(Ue,We){var rt=P(7*p(We)/(3*Cn));return[Cn*Ue*(2*n(2*rt/3)-1)/oi,9*p(rt/3)/oi]}function vr(Ue,We){for(var rt,ut=(1+b)*p(We),yt=We,mt=0;mt<25&&(yt-=rt=(p(yt/2)+p(yt)-ut)/(.5*n(yt/2)+n(yt)),!(y(rt)<i));mt++);return[Ue*(1+2*n(yt)/n(yt/2))/(3*T),2*E(3)*p(yt/2)/E(2+T)]}function It(Ue,We){for(var rt,ut=E(6/(4+x)),yt=(1+x/4)*p(We),mt=We/2,Lt=0;Lt<25&&(mt-=rt=(mt/2+p(mt)-yt)/(.5+n(mt)),!(y(rt)<i));Lt++);return[ut*(.5+n(mt))*Ue/1.5,ut*mt]}function lr(Ue,We){var rt=We*We,ut=rt*rt,yt=rt*ut;return[Ue*(.84719-.13063*rt+yt*yt*(.05494*rt-.04515-.02326*ut+.00331*yt)),We*(1.01183+ut*ut*(.01926*rt-.02625-.00396*ut))]}function dr(Ue,We){return[Ue*(1+n(We))/2,2*(We-c(We/2))]}nr.invert=function(Ue,We){var rt=3*P(We*oi/9);return[Ue*oi/(Cn*(2*n(2*rt/3)-1)),P(3*p(rt)*Cn/7)]},vr.invert=function(Ue,We){var rt=We*E(2+T)/(2*E(3)),ut=2*P(rt);return[3*T*Ue/(1+2*n(ut)/n(ut/2)),P((rt+p(ut))/(1+b))]},It.invert=function(Ue,We){var rt=E(6/(4+x)),ut=We/rt;return y(y(ut)-f)<i&&(ut=ut<0?-f:f),[1.5*Ue/(rt*(.5+n(ut))),P((ut/2+p(ut))/(1+x/4))]},lr.invert=function(Ue,We){var rt,ut,yt,mt,Lt=We,$t=25;do Lt-=rt=(Lt*(1.01183+(yt=(ut=Lt*Lt)*ut)*yt*(.01926*ut-.02625-.00396*yt))-We)/(1.01183+yt*yt*(.21186*ut-.23625+-.05148*yt));while(y(rt)>1e-12&&--$t>0);return[Ue/(.84719-.13063*(ut=Lt*Lt)+(mt=ut*(yt=ut*ut))*mt*(.05494*ut-.04515-.02326*yt+.00331*mt)),Lt]},dr.invert=function(Ue,We){for(var rt=We/2,ut=0,yt=1/0;ut<10&&y(yt)>i;++ut){var mt=n(We/2);We-=yt=(We-c(We/2)-rt)/(1-.5/(mt*mt))}return[2*Ue/(1+n(We)),We]};var Br=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Fr(Ue,We){var rt=p(We),ut=n(We),yt=o(Ue);if(Ue===0||y(We)===f)return[0,We];if(We===0)return[Ue,0];if(y(Ue)===f)return[Ue*ut,f*rt];var mt=x/(2*Ue)-2*Ue/x,Lt=2*We/x,$t=(1-Lt*Lt)/(rt-Lt),er=mt*mt,Zt=$t*$t,or=1+er/Zt,mr=1+Zt/er,wr=(mt*rt/$t-mt/2)/or,Tr=(Zt*rt/er+$t/2)/mr,Rr=Tr*Tr-(Zt*rt*rt/er+$t*rt-1)/mr;return[f*(wr+E(wr*wr+ut*ut/or)*yt),f*(Tr+E(Rr<0?0:Rr)*o(-We*mt)*yt)]}Fr.invert=function(Ue,We){var rt=(Ue/=f)*Ue,ut=rt+(We/=f)*We,yt=x*x;return[Ue?(ut-1+E((1-ut)*(1-ut)+4*rt))/(2*Ue)*f:0,te(function(mt){return ut*(x*p(mt)-2*mt)*x+4*mt*mt*(We-p(mt))+2*x*mt-yt*We},0)]};function zr(Ue,We){var rt=We*We;return[Ue,We*(1.0148+rt*rt*(.23185+rt*(.02406*rt-.14499)))]}function Er(Ue,We){if(y(We)<i)return[Ue,0];var rt=c(We),ut=Ue*p(We);return[p(ut)/rt,We+(1-n(ut))/rt]}function xr(Ue,We){var rt=kr(Ue[1],Ue[0]),ut=kr(We[1],We[0]),yt=function(Lt,$t){return t(Lt[0]*$t[1]-Lt[1]*$t[0],Lt[0]*$t[0]+Lt[1]*$t[1])}(rt,ut),mt=Cr(rt)/Cr(ut);return _r([1,0,Ue[0][0],0,1,Ue[0][1]],_r([mt,0,0,0,mt,0],_r([n(yt),p(yt),0,-p(yt),n(yt),0],[1,0,-We[0][0],0,1,-We[0][1]])))}function _r(Ue,We){return[Ue[0]*We[0]+Ue[1]*We[3],Ue[0]*We[1]+Ue[1]*We[4],Ue[0]*We[2]+Ue[1]*We[5]+Ue[2],Ue[3]*We[0]+Ue[4]*We[3],Ue[3]*We[1]+Ue[4]*We[4],Ue[3]*We[2]+Ue[4]*We[5]+Ue[5]]}function kr(Ue,We){return[Ue[0]-We[0],Ue[1]-We[1]]}function Cr(Ue){return E(Ue[0]*Ue[0]+Ue[1]*Ue[1])}function Gr(Ue,We,rt){function ut(Lt,$t){var er,Zt=We(Lt,$t),or=Zt.project([Lt*A,$t*A]);return(er=Zt.transform)?[er[0]*or[0]+er[1]*or[1]+er[2],-(er[3]*or[0]+er[4]*or[1]+er[5])]:(or[1]=-or[1],or)}(function Lt($t,er){if($t.edges=function(Rr){for(var on=Rr.length,mn=[],In=Rr[on-1],zn=0;zn<on;++zn)mn.push([In,In=Rr[zn]]);return mn}($t.face),er.face){var Zt=$t.shared=function(Rr,on){for(var mn,In,zn=Rr.length,qn=null,Rn=0;Rn<zn;++Rn){mn=Rr[Rn];for(var vi=on.length;--vi>=0;)if(In=on[vi],mn[0]===In[0]&&mn[1]===In[1]){if(qn)return[qn,mn];qn=mn}}}($t.face,er.face),or=xr(Zt.map(er.project),Zt.map($t.project));$t.transform=er.transform?_r(er.transform,or):or;for(var mr=er.edges,wr=0,Tr=mr.length;wr<Tr;++wr)qr(Zt[0],mr[wr][1])&&qr(Zt[1],mr[wr][0])&&(mr[wr]=$t),qr(Zt[0],mr[wr][0])&&qr(Zt[1],mr[wr][1])&&(mr[wr]=$t);for(mr=$t.edges,wr=0,Tr=mr.length;wr<Tr;++wr)qr(Zt[0],mr[wr][0])&&qr(Zt[1],mr[wr][1])&&(mr[wr]=er),qr(Zt[0],mr[wr][1])&&qr(Zt[1],mr[wr][0])&&(mr[wr]=er)}else $t.transform=er.transform;return $t.children&&$t.children.forEach(function(Rr){Lt(Rr,$t)}),$t})(Ue,{transform:null}),Qr(Ue)&&(ut.invert=function(Lt,$t){var er=function Zt(or,mr){var wr=or.project.invert,Tr=or.transform,Rr=mr;if(Tr&&(Tr=function(qn){var Rn=1/(qn[0]*qn[4]-qn[1]*qn[3]);return[Rn*qn[4],-Rn*qn[1],Rn*(qn[1]*qn[5]-qn[2]*qn[4]),-Rn*qn[3],Rn*qn[0],Rn*(qn[2]*qn[3]-qn[0]*qn[5])]}(Tr),Rr=[Tr[0]*Rr[0]+Tr[1]*Rr[1]+Tr[2],Tr[3]*Rr[0]+Tr[4]*Rr[1]+Tr[5]]),wr&&or===function(qn){return We(qn[0]*I,qn[1]*I)}(on=wr(Rr)))return on;for(var on,mn=or.children,In=0,zn=mn&&mn.length;In<zn;++In)if(on=Zt(mn[In],mr))return on}(Ue,[Lt,-$t]);return er&&(er[0]*=I,er[1]*=I,er)});var yt=v.geoProjection(ut),mt=yt.stream;return yt.stream=function(Lt){var $t=yt.rotate(),er=mt(Lt),Zt=(yt.rotate([0,0]),mt(Lt));return yt.rotate($t),er.sphere=function(){Zt.polygonStart(),Zt.lineStart(),function or(mr,wr,Tr){var Rr,on,mn=wr.edges,In=mn.length,zn={type:"MultiPoint",coordinates:wr.face},qn=wr.face.filter(function(Aa){return y(Aa[1])!==90}),Rn=v.geoBounds({type:"MultiPoint",coordinates:qn}),vi=!1,Si=-1,Ui=Rn[1][0]-Rn[0][0],ji=Ui===180||Ui===360?[(Rn[0][0]+Rn[1][0])/2,(Rn[0][1]+Rn[1][1])/2]:v.geoCentroid(zn);if(Tr)for(;++Si<In&&mn[Si]!==Tr;);++Si;for(var Vi=0;Vi<In;++Vi)on=mn[(Vi+Si)%In],Array.isArray(on)?(vi||(mr.point((Rr=v.geoInterpolate(on[0],ji)(i))[0],Rr[1]),vi=!0),mr.point((Rr=v.geoInterpolate(on[1],ji)(i))[0],Rr[1])):(vi=!1,on!==Tr&&or(mr,on,wr))}(Zt,Ue),Zt.lineEnd(),Zt.polygonEnd()},er},yt.angle(rt==null?-30:rt*A)}function qr(Ue,We){return Ue&&We&&Ue[0]===We[0]&&Ue[1]===We[1]}function Qr(Ue){return Ue.project.invert||Ue.children&&Ue.children.some(Qr)}zr.invert=function(Ue,We){We>1.790857183?We=1.790857183:We<-1.790857183&&(We=-1.790857183);var rt,ut=We;do{var yt=ut*ut;ut-=rt=(ut*(1.0148+yt*yt*(.23185+yt*(.02406*yt-.14499)))-We)/(1.0148+yt*yt*(5*.23185+yt*(.21654*yt-1.01493)))}while(y(rt)>i);return[Ue,ut]},Er.invert=function(Ue,We){if(y(We)<i)return[Ue,0];var rt,ut=Ue*Ue+We*We,yt=.5*We,mt=10;do{var Lt=c(yt),$t=1/n(yt),er=ut-2*We*yt+yt*yt;yt-=rt=(Lt*er+2*(yt-We))/(2+er*$t*$t+2*(yt-We)*Lt)}while(y(rt)>i&&--mt>0);return Lt=c(yt),[(y(We)<y(yt+1/Lt)?P(Ue*Lt):o(We)*o(Ue)*(S(y(Ue*Lt))+f))/p(yt),yt]};var rn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],yn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Ue){return Ue.map(function(We){return rn[We]})}),wn=2/E(3);function kn(Ue,We){var rt=ze(Ue,We);return[rt[0]*wn,rt[1]]}function Pn(Ue,We){for(var rt=0,ut=Ue.length,yt=0;rt<ut;++rt)yt+=Ue[rt]*We[rt];return yt}function Dn(Ue){return[t(Ue[1],Ue[0])*A,P(u(-1,s(1,Ue[2])))*A]}function Zn(Ue){var We=Ue[0]*I,rt=Ue[1]*I,ut=n(rt);return[ut*n(We),ut*p(We),p(rt)]}function Ai(){}function Mi(Ue,We){return{type:"FeatureCollection",features:Ue.features.map(function(rt){return En(rt,We)})}}function En(Ue,We){return{type:"Feature",id:Ue.id,properties:Ue.properties,geometry:Qn(Ue.geometry,We)}}function Qn(Ue,We){if(!Ue)return null;if(Ue.type==="GeometryCollection")return function(ut,yt){return{type:"GeometryCollection",geometries:ut.geometries.map(function(mt){return Qn(mt,yt)})}}(Ue,We);var rt;switch(Ue.type){case"Point":case"MultiPoint":rt=va;break;case"LineString":case"MultiLineString":rt=Ba;break;case"Polygon":case"MultiPolygon":case"Sphere":rt=mo;break;default:return null}return v.geoStream(Ue,We(rt)),rt.result()}kn.invert=function(Ue,We){return ze.invert(Ue/wn,We)};var Jn=[],Di=[],va={point:function(Ue,We){Jn.push([Ue,We])},result:function(){var Ue=Jn.length?Jn.length<2?{type:"Point",coordinates:Jn[0]}:{type:"MultiPoint",coordinates:Jn}:null;return Jn=[],Ue}},Ba={lineStart:Ai,point:function(Ue,We){Jn.push([Ue,We])},lineEnd:function(){Jn.length&&(Di.push(Jn),Jn=[])},result:function(){var Ue=Di.length?Di.length<2?{type:"LineString",coordinates:Di[0]}:{type:"MultiLineString",coordinates:Di}:null;return Di=[],Ue}},mo={polygonStart:Ai,lineStart:Ai,point:function(Ue,We){Jn.push([Ue,We])},lineEnd:function(){var Ue=Jn.length;if(Ue){do Jn.push(Jn[0].slice());while(++Ue<4);Di.push(Jn),Jn=[]}},polygonEnd:Ai,result:function(){if(!Di.length)return null;var Ue=[],We=[];return Di.forEach(function(rt){(function(ut){if((yt=ut.length)<4)return!1;for(var yt,mt=0,Lt=ut[yt-1][1]*ut[0][0]-ut[yt-1][0]*ut[0][1];++mt<yt;)Lt+=ut[mt-1][1]*ut[mt][0]-ut[mt-1][0]*ut[mt][1];return Lt<=0})(rt)?Ue.push([rt]):We.push(rt)}),We.forEach(function(rt){var ut=rt[0];Ue.some(function(yt){if(function(mt,Lt){for(var $t=Lt[0],er=Lt[1],Zt=!1,or=0,mr=mt.length,wr=mr-1;or<mr;wr=or++){var Tr=mt[or],Rr=Tr[0],on=Tr[1],mn=mt[wr],In=mn[0],zn=mn[1];on>er^zn>er&&$t<(In-Rr)*(er-on)/(zn-on)+Rr&&(Zt=!Zt)}return Zt}(yt[0],ut))return yt.push(rt),!0})||Ue.push([rt])}),Di=[],Ue.length?Ue.length>1?{type:"MultiPolygon",coordinates:Ue}:{type:"Polygon",coordinates:Ue[0]}:null}};function Wi(Ue){var We=Ue(f,0)[0]-Ue(-f,0)[0];function rt(ut,yt){var mt=y(ut)<f,Lt=Ue(mt?ut:ut>0?ut-x:ut+x,yt),$t=(Lt[0]-Lt[1])*b,er=(Lt[0]+Lt[1])*b;if(mt)return[$t,er];var Zt=We*b,or=$t>0^er>0?-1:1;return[or*$t-o(er)*Zt,or*er-o($t)*Zt]}return Ue.invert&&(rt.invert=function(ut,yt){var mt=(ut+yt)*b,Lt=(yt-ut)*b,$t=y(mt)<.5*We&&y(Lt)<.5*We;if(!$t){var er=We*b,Zt=mt>0^Lt>0?-1:1,or=-Zt*ut+(Lt>0?1:-1)*er,mr=-Zt*yt+(mt>0?1:-1)*er;mt=(-or-mr)*b,Lt=(or-mr)*b}var wr=Ue.invert(mt,Lt);return $t||(wr[0]+=mt>0?x:-x),wr}),v.geoProjection(rt).rotate([-90,-90,45]).clipAngle(179.999)}function Zi(){return Wi(Ot).scale(111.48)}function to(Ue){var We=p(Ue);function rt(ut,yt){var mt=We?c(ut*We/2)/We:ut/2;if(!yt)return[2*mt,-Ue];var Lt=2*e(mt*p(yt)),$t=1/c(yt);return[p(Lt)*$t,yt+(1-n(Lt))*$t-Ue]}return rt.invert=function(ut,yt){if(y(yt+=Ue)<i)return[We?2*e(We*ut/2)/We:ut,0];var mt,Lt=ut*ut+yt*yt,$t=0,er=10;do{var Zt=c($t),or=1/n($t),mr=Lt-2*yt*$t+$t*$t;$t-=mt=(Zt*mr+2*($t-yt))/(2+mr*or*or+2*($t-yt)*Zt)}while(y(mt)>i&&--er>0);var wr=ut*(Zt=c($t)),Tr=c(y(yt)<y($t+1/Zt)?.5*P(wr):.5*S(wr)+x/4)/p($t);return[We?2*e(We*Tr)/We:2*Tr,$t]},rt}var Ni=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function go(Ue,We){var rt,ut=s(18,36*y(We)/x),yt=r(ut),mt=ut-yt,Lt=(rt=Ni[yt])[0],$t=rt[1],er=(rt=Ni[++yt])[0],Zt=rt[1],or=(rt=Ni[s(19,++yt)])[0],mr=rt[1];return[Ue*(er+mt*(or-Lt)/2+mt*mt*(or-2*er+Lt)/2),(We>0?f:-f)*(Zt+mt*(mr-$t)/2+mt*mt*(mr-2*Zt+$t)/2)]}function bo(Ue,We){var rt=function(Lt){function $t(er,Zt){var or=n(Zt),mr=(Lt-1)/(Lt-or*n(er));return[mr*or*p(er),mr*p(Zt)]}return $t.invert=function(er,Zt){var or=er*er+Zt*Zt,mr=E(or),wr=(Lt-E(1-or*(Lt+1)/(Lt-1)))/((Lt-1)/mr+mr/(Lt-1));return[t(er*wr,mr*E(1-wr*wr)),mr?P(Zt*wr/mr):0]},$t}(Ue);if(!We)return rt;var ut=n(We),yt=p(We);function mt(Lt,$t){var er=rt(Lt,$t),Zt=er[1],or=Zt*yt/(Ue-1)+ut;return[er[0]*ut/or,Zt/or]}return mt.invert=function(Lt,$t){var er=(Ue-1)/(Ue-1-$t*yt);return rt.invert(er*Lt,er*$t*ut)},mt}Ni.forEach(function(Ue){Ue[1]*=1.0144}),go.invert=function(Ue,We){var rt=We/f,ut=90*rt,yt=s(18,y(ut/5)),mt=u(0,r(yt));do{var Lt=Ni[mt][1],$t=Ni[mt+1][1],er=Ni[s(19,mt+2)][1],Zt=er-Lt,or=er-2*$t+Lt,mr=2*(y(rt)-$t)/Zt,wr=or/Zt,Tr=mr*(1-wr*mr*(1-2*wr*mr));if(Tr>=0||mt===1){ut=(We>=0?5:-5)*(Tr+yt);var Rr,on=50;do Tr=(yt=s(18,y(ut)/5))-(mt=r(yt)),Lt=Ni[mt][1],$t=Ni[mt+1][1],er=Ni[s(19,mt+2)][1],ut-=(Rr=(We>=0?f:-f)*($t+Tr*(er-Lt)/2+Tr*Tr*(er-2*$t+Lt)/2)-We)*A;while(y(Rr)>1e-12&&--on>0);break}}while(--mt>=0);var mn=Ni[mt][0],In=Ni[mt+1][0],zn=Ni[s(19,mt+2)][0];return[Ue/(In+Tr*(zn-mn)/2+Tr*Tr*(zn-2*In+mn)/2),ut*I]};var Ma=-179.9999,ro=179.9999,_o=-89.9999;function Co(Ue){return Ue.length>0}function Va(Ue){return Ue===-90||Ue===90?[0,Ue]:[-180,(We=Ue,Math.floor(1e4*We)/1e4)];var We}function ya(Ue){var We=Ue[0],rt=Ue[1],ut=!1;return We<=Ma?(We=-180,ut=!0):We>=ro&&(We=180,ut=!0),rt<=_o?(rt=-90,ut=!0):rt>=89.9999&&(rt=90,ut=!0),ut?[We,rt]:Ue}function Qa(Ue){return Ue.map(ya)}function Cs(Ue,We,rt){for(var ut=0,yt=Ue.length;ut<yt;++ut){var mt=Ue[ut].slice();rt.push({index:-1,polygon:We,ring:mt});for(var Lt=0,$t=mt.length;Lt<$t;++Lt){var er=mt[Lt],Zt=er[0],or=er[1];if(Zt<=Ma||Zt>=ro||or<=_o||or>=89.9999){mt[Lt]=ya(er);for(var mr=Lt+1;mr<$t;++mr){var wr=mt[mr],Tr=wr[0],Rr=wr[1];if(Tr>Ma&&Tr<ro&&Rr>_o&&Rr<89.9999)break}if(mr===Lt+1)continue;if(Lt){var on={index:-1,polygon:We,ring:mt.slice(0,Lt+1)};on.ring[on.ring.length-1]=Va(or),rt[rt.length-1]=on}else rt.pop();if(mr>=$t)break;rt.push({index:-1,polygon:We,ring:mt=mt.slice(mr-1)}),mt[0]=Va(mt[0][1]),Lt=-1,$t=mt.length}}}}function Rs(Ue){var We,rt,ut,yt,mt,Lt,$t=Ue.length,er={},Zt={};for(We=0;We<$t;++We)ut=(rt=Ue[We]).ring[0],mt=rt.ring[rt.ring.length-1],ut[0]!==mt[0]||ut[1]!==mt[1]?(rt.index=We,er[ut]=Zt[mt]=rt):(rt.polygon.push(rt.ring),Ue[We]=null);for(We=0;We<$t;++We)if(rt=Ue[We]){if(ut=rt.ring[0],mt=rt.ring[rt.ring.length-1],yt=Zt[ut],Lt=er[mt],delete er[ut],delete Zt[mt],ut[0]===mt[0]&&ut[1]===mt[1]){rt.polygon.push(rt.ring);continue}yt?(delete Zt[ut],delete er[yt.ring[0]],yt.ring.pop(),Ue[yt.index]=null,rt={index:-1,polygon:yt.polygon,ring:yt.ring.concat(rt.ring)},yt===Lt?rt.polygon.push(rt.ring):(rt.index=$t++,Ue.push(er[rt.ring[0]]=Zt[rt.ring[rt.ring.length-1]]=rt))):Lt?(delete er[mt],delete Zt[Lt.ring[Lt.ring.length-1]],rt.ring.pop(),rt={index:$t++,polygon:Lt.polygon,ring:rt.ring.concat(Lt.ring)},Ue[Lt.index]=null,Ue.push(er[rt.ring[0]]=Zt[rt.ring[rt.ring.length-1]]=rt)):(rt.ring.push(rt.ring[0]),rt.polygon.push(rt.ring))}}function Xi(Ue){var We={type:"Feature",geometry:Ts(Ue.geometry)};return Ue.id!=null&&(We.id=Ue.id),Ue.bbox!=null&&(We.bbox=Ue.bbox),Ue.properties!=null&&(We.properties=Ue.properties),We}function Ts(Ue){if(Ue==null)return Ue;var We,rt,ut,yt;switch(Ue.type){case"GeometryCollection":We={type:"GeometryCollection",geometries:Ue.geometries.map(Ts)};break;case"Point":We={type:"Point",coordinates:ya(Ue.coordinates)};break;case"MultiPoint":case"LineString":We={type:Ue.type,coordinates:Qa(Ue.coordinates)};break;case"MultiLineString":We={type:"MultiLineString",coordinates:Ue.coordinates.map(Qa)};break;case"Polygon":var mt=[];Cs(Ue.coordinates,mt,rt=[]),Rs(rt),We={type:"Polygon",coordinates:mt};break;case"MultiPolygon":rt=[],ut=-1,yt=Ue.coordinates.length;for(var Lt=new Array(yt);++ut<yt;)Cs(Ue.coordinates[ut],Lt[ut]=[],rt);Rs(rt),We={type:"MultiPolygon",coordinates:Lt.filter(Co)};break;default:return Ue}return Ue.bbox!=null&&(We.bbox=Ue.bbox),We}function ss(Ue,We){var rt=c(We/2),ut=p(_*rt);return[Ue*(.74482-.34588*ut*ut),1.70711*rt]}function Fs(Ue,We,rt){var ut=v.geoInterpolate(We,rt),yt=ut(.5),mt=v.geoRotation([-yt[0],-yt[1]])(We),Lt=ut.distance/2,$t=-P(p(mt[1]*I)/p(Lt)),er=[-yt[0],-yt[1],-(mt[0]>0?x-$t:$t)*A],Zt=v.geoProjection(Ue(Lt)).rotate(er),or=v.geoRotation(er),mr=Zt.center;return delete Zt.rotate,Zt.center=function(wr){return arguments.length?mr(or(wr)):or.invert(mr())},Zt.clipAngle(90)}function Bs(Ue){var We=n(Ue);function rt(ut,yt){var mt=v.geoGnomonicRaw(ut,yt);return mt[0]*=We,mt}return rt.invert=function(ut,yt){return v.geoGnomonicRaw.invert(ut/We,yt)},rt}function Ps(Ue,We){return Fs(Bs,Ue,We)}function Ns(Ue){if(!(Ue*=2))return v.geoAzimuthalEquidistantRaw;var We=-Ue/2,rt=-We,ut=Ue*Ue,yt=c(rt),mt=.5/p(rt);function Lt($t,er){var Zt=S(n(er)*n($t-We)),or=S(n(er)*n($t-rt));return[((Zt*=Zt)-(or*=or))/(2*Ue),(er<0?-1:1)*E(4*ut*or-(ut-Zt+or)*(ut-Zt+or))/(2*Ue)]}return Lt.invert=function($t,er){var Zt,or,mr=er*er,wr=n(E(mr+(Zt=$t+We)*Zt)),Tr=n(E(mr+(Zt=$t+rt)*Zt));return[t(or=wr-Tr,Zt=(wr+Tr)*yt),(er<0?-1:1)*S(E(Zt*Zt+or*or)*mt)]},Lt}function Do(Ue,We){return Fs(Ns,Ue,We)}function zo(Ue,We){if(y(We)<i)return[Ue,0];var rt=y(We/f),ut=P(rt);if(y(Ue)<i||y(y(We)-f)<i)return[0,o(We)*x*c(ut/2)];var yt=n(ut),mt=y(x/Ue-Ue/x)/2,Lt=mt*mt,$t=yt/(rt+yt-1),er=$t*(2/rt-1),Zt=er*er,or=Zt+Lt,mr=$t-Zt,wr=Lt+$t;return[o(Ue)*x*(mt*mr+E(Lt*mr*mr-or*($t*$t-Zt)))/or,o(We)*x*(er*wr-mt*E((Lt+1)*or-wr*wr))/or]}function Yo(Ue,We){if(y(We)<i)return[Ue,0];var rt=y(We/f),ut=P(rt);if(y(Ue)<i||y(y(We)-f)<i)return[0,o(We)*x*c(ut/2)];var yt=n(ut),mt=y(x/Ue-Ue/x)/2,Lt=mt*mt,$t=yt*(E(1+Lt)-mt*yt)/(1+Lt*rt*rt);return[o(Ue)*x*$t,o(We)*x*E(1-$t*(2*mt+$t))]}function Wo(Ue,We){if(y(We)<i)return[Ue,0];var rt=We/f,ut=P(rt);if(y(Ue)<i||y(y(We)-f)<i)return[0,x*c(ut/2)];var yt=(x/Ue-Ue/x)/2,mt=rt/(1+n(ut));return[x*(o(Ue)*E(yt*yt+1-mt*mt)-yt),x*mt]}function Zo(Ue,We){if(!We)return[Ue,0];var rt=y(We);if(!Ue||rt===f)return[0,We];var ut=rt/f,yt=ut*ut,mt=(8*ut-yt*(yt+2)-5)/(2*yt*(ut-1)),Lt=mt*mt,$t=ut*mt,er=yt+Lt+2*$t,Zt=ut+3*mt,or=Ue/f,mr=or+1/or,wr=o(y(Ue)-f)*E(mr*mr-4),Tr=wr*wr,Rr=(wr*(er+Lt-1)+2*E(er*(yt+Lt*Tr-1)+(1-yt)*(yt*(Zt*Zt+4*Lt)+12*$t*Lt+4*Lt*Lt)))/(4*er+Tr);return[o(Ue)*f*Rr,o(We)*f*E(1+wr*y(Rr)-Rr*Rr)]}function ls(Ue,We,rt,ut){var yt=x/3;Ue=u(Ue,i),We=u(We,i),Ue=s(Ue,f),We=s(We,x-i),rt=u(rt,0),rt=s(rt,100-i);var mt=(ut=u(ut,i))/100,Lt=S((rt/100+1)*n(yt))/yt,$t=p(Ue)/p(Lt*f),er=We/x,Zt=E(mt*p(Ue/2)/p(We/2));return function(or,mr,wr,Tr,Rr){function on(mn,In){var zn=wr*p(Tr*In),qn=E(1-zn*zn),Rn=E(2/(1+qn*n(mn*=Rr)));return[or*qn*Rn*p(mn),mr*zn*Rn]}return on.invert=function(mn,In){var zn=mn/or,qn=In/mr,Rn=E(zn*zn+qn*qn),vi=2*P(Rn/2);return[t(mn*c(vi),or*Rn)/Rr,Rn&&P(In*p(vi)/(mr*wr*Rn))/Tr]},on}(Zt/E(er*$t*Lt),1/(Zt*E(er*$t*Lt)),$t,Lt,er)}function wo(){var Ue=65*I,We=60*I,rt=20,ut=200,yt=v.geoProjectionMutator(ls),mt=yt(Ue,We,rt,ut);return mt.poleline=function(Lt){return arguments.length?yt(Ue=+Lt*I,We,rt,ut):Ue*A},mt.parallels=function(Lt){return arguments.length?yt(Ue,We=+Lt*I,rt,ut):We*A},mt.inflation=function(Lt){return arguments.length?yt(Ue,We,rt=+Lt,ut):rt},mt.ratio=function(Lt){return arguments.length?yt(Ue,We,rt,ut=+Lt):ut},mt.scale(163.775)}ss.invert=function(Ue,We){var rt=We/1.70711,ut=p(_*rt);return[Ue/(.74482-.34588*ut*ut),2*e(rt)]},zo.invert=function(Ue,We){if(y(We)<i)return[Ue,0];if(y(Ue)<i)return[0,f*p(2*e(We/x))];var rt=(Ue/=x)*Ue,ut=(We/=x)*We,yt=rt+ut,mt=yt*yt,Lt=-y(We)*(1+yt),$t=Lt-2*ut+rt,er=-2*Lt+1+2*ut+mt,Zt=ut/er+(2*$t*$t*$t/(er*er*er)-9*Lt*$t/(er*er))/27,or=(Lt-$t*$t/(3*er))/er,mr=2*E(-or/3),wr=S(3*Zt/(or*mr))/3;return[x*(yt-1+E(1+2*(rt-ut)+mt))/(2*Ue),o(We)*x*(-mr*n(wr+x/3)-$t/(3*er))]},Yo.invert=function(Ue,We){if(!Ue)return[0,f*p(2*e(We/x))];var rt=y(Ue/x),ut=(1-rt*rt-(We/=x)*We)/(2*rt),yt=E(ut*ut+1);return[o(Ue)*x*(yt-ut),o(We)*f*p(2*t(E((1-2*ut*rt)*(ut+yt)-rt),E(yt+ut+rt)))]},Wo.invert=function(Ue,We){if(!We)return[Ue,0];var rt=We/x,ut=(x*x*(1-rt*rt)-Ue*Ue)/(2*x*Ue);return[Ue?x*(o(Ue)*E(ut*ut+1)-ut):0,f*p(2*e(rt))]},Zo.invert=function(Ue,We){var rt;if(!Ue||!We)return[Ue,We];We/=x;var ut=o(Ue)*Ue/f,yt=(ut*ut-1+4*We*We)/y(ut),mt=yt*yt,Lt=2*We,$t=50;do{var er=Lt*Lt,Zt=(8*Lt-er*(er+2)-5)/(2*er*(Lt-1)),or=(3*Lt-er*Lt-10)/(2*er*Lt),mr=Zt*Zt,wr=Lt*Zt,Tr=Lt+Zt,Rr=Tr*Tr,on=Lt+3*Zt,mn=-2*Tr*(4*wr*mr+(1-4*er+3*er*er)*(1+or)+mr*(14*er-6-mt+(8*er-8-2*mt)*or)+wr*(12*er-8+(10*er-10-mt)*or)),In=E(Rr*(er+mr*mt-1)+(1-er)*(er*(on*on+4*mr)+mr*(12*wr+4*mr)));Lt-=rt=(yt*(Rr+mr-1)+2*In-ut*(4*Rr+mt))/(yt*(2*Zt*or+2*Tr*(1+or))+mn/In-8*Tr*(yt*(-1+mr+Rr)+2*In)*(1+or)/(mt+4*Rr))}while(rt>i&&--$t>0);return[o(Ue)*(E(yt*yt+4)+yt)*x/4,f*Lt]};var ks=4*x+3*E(3),vo=2*E(2*x*E(3)/ks),Xo=ee(vo*E(3)/x,vo,ks/6);function Ms(Ue,We){return[Ue*E(1-3*We*We/(x*x)),We]}function Ro(Ue,We){var rt=n(We),ut=n(Ue)*rt,yt=1-ut,mt=n(Ue=t(p(Ue)*rt,-p(We))),Lt=p(Ue);return[Lt*(rt=E(1-ut*ut))-mt*yt,-mt*rt-Lt*yt]}function Gi(Ue,We){var rt=V(Ue,We);return[(rt[0]+Ue/f)/2,(rt[1]+We)/2]}Ms.invert=function(Ue,We){return[Ue/E(1-3*We*We/(x*x)),We]},Ro.invert=function(Ue,We){var rt=(Ue*Ue+We*We)/-2,ut=E(-rt*(2+rt)),yt=We*rt+Ue*ut,mt=Ue*rt-We*ut,Lt=E(mt*mt+yt*yt);return[t(ut*yt,Lt*(1+rt)),Lt?-P(ut*mt/Lt):0]},Gi.invert=function(Ue,We){var rt=Ue,ut=We,yt=25;do{var mt,Lt=n(ut),$t=p(ut),er=p(2*ut),Zt=$t*$t,or=Lt*Lt,mr=p(rt),wr=n(rt/2),Tr=p(rt/2),Rr=Tr*Tr,on=1-or*wr*wr,mn=on?S(Lt*wr)*E(mt=1/on):mt=0,In=.5*(2*mn*Lt*Tr+rt/f)-Ue,zn=.5*(mn*$t+ut)-We,qn=.5*mt*(or*Rr+mn*Lt*wr*Zt)+.5/f,Rn=mt*(mr*er/4-mn*$t*Tr),vi=.125*mt*(er*Tr-mn*$t*or*mr),Si=.5*mt*(Zt*wr+mn*Rr*Lt)+.5,Ui=Rn*vi-Si*qn,ji=(zn*Rn-In*Si)/Ui,Vi=(In*vi-zn*qn)/Ui;rt-=ji,ut-=Vi}while((y(ji)>i||y(Vi)>i)&&--yt>0);return[rt,ut]},d.geoNaturalEarth=v.geoNaturalEarth1,d.geoNaturalEarthRaw=v.geoNaturalEarth1Raw,d.geoAiry=function(){var Ue=f,We=v.geoProjectionMutator(j),rt=We(Ue);return rt.radius=function(ut){return arguments.length?We(Ue=ut*I):Ue*A},rt.scale(179.976).clipAngle(147)},d.geoAiryRaw=j,d.geoAitoff=function(){return v.geoProjection(V).scale(152.63)},d.geoAitoffRaw=V,d.geoArmadillo=function(){var Ue=20*I,We=Ue>=0?1:-1,rt=c(We*Ue),ut=v.geoProjectionMutator(Z),yt=ut(Ue),mt=yt.stream;return yt.parallel=function(Lt){return arguments.length?(rt=c((We=(Ue=Lt*I)>=0?1:-1)*Ue),ut(Ue)):Ue*A},yt.stream=function(Lt){var $t=yt.rotate(),er=mt(Lt),Zt=(yt.rotate([0,0]),mt(Lt)),or=yt.precision();return yt.rotate($t),er.sphere=function(){Zt.polygonStart(),Zt.lineStart();for(var mr=-180*We;We*mr<180;mr+=90*We)Zt.point(mr,90*We);if(Ue)for(;We*(mr-=3*We*or)>=-180;)Zt.point(mr,We*-t(n(mr*I/2),rt)*A);Zt.lineEnd(),Zt.polygonEnd()},er},yt.scale(218.695).center([0,28.0974])},d.geoArmadilloRaw=Z,d.geoAugust=function(){return v.geoProjection(Q).scale(66.1603)},d.geoAugustRaw=Q,d.geoBaker=function(){return v.geoProjection(ne).scale(112.314)},d.geoBakerRaw=ne,d.geoBerghaus=function(){var Ue=5,We=v.geoProjectionMutator(H),rt=We(Ue),ut=rt.stream,yt=-n(.01*I),mt=p(.01*I);return rt.lobes=function(Lt){return arguments.length?We(Ue=+Lt):Ue},rt.stream=function(Lt){var $t=rt.rotate(),er=ut(Lt),Zt=(rt.rotate([0,0]),ut(Lt));return rt.rotate($t),er.sphere=function(){Zt.polygonStart(),Zt.lineStart();for(var or=0,mr=360/Ue,wr=2*x/Ue,Tr=90-180/Ue,Rr=f;or<Ue;++or,Tr-=mr,Rr-=wr)Zt.point(t(mt*n(Rr),yt)*A,P(mt*p(Rr))*A),Tr<-90?(Zt.point(-90,-180-Tr-.01),Zt.point(-90,-180-Tr+.01)):(Zt.point(90,Tr+.01),Zt.point(90,Tr-.01));Zt.lineEnd(),Zt.polygonEnd()},er},rt.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},d.geoBerghausRaw=H,d.geoBertin1953=function(){return v.geoProjection(X()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},d.geoBertin1953Raw=X,d.geoBoggs=function(){return v.geoProjection(de).scale(160.857)},d.geoBoggsRaw=de,d.geoBonne=function(){return ce(Ae).scale(123.082).center([0,26.1441]).parallel(45)},d.geoBonneRaw=Ae,d.geoBottomley=function(){var Ue=.5,We=v.geoProjectionMutator(fe),rt=We(Ue);return rt.fraction=function(ut){return arguments.length?We(Ue=+ut):Ue},rt.scale(158.837)},d.geoBottomleyRaw=fe,d.geoBromley=function(){return v.geoProjection(me).scale(152.63)},d.geoBromleyRaw=me,d.geoChamberlin=Me,d.geoChamberlinRaw=Te,d.geoChamberlinAfrica=function(){return Me([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},d.geoCollignon=function(){return v.geoProjection(ze).scale(95.6464).center([0,30])},d.geoCollignonRaw=ze,d.geoCraig=function(){return ce(Oe).scale(249.828).clipAngle(90)},d.geoCraigRaw=Oe,d.geoCraster=function(){return v.geoProjection(Xe).scale(156.19)},d.geoCrasterRaw=Xe,d.geoCylindricalEqualArea=function(){return ce(Be).parallel(38.58).scale(195.044)},d.geoCylindricalEqualAreaRaw=Be,d.geoCylindricalStereographic=function(){return ce(Ie).scale(124.75)},d.geoCylindricalStereographicRaw=Ie,d.geoEckert1=function(){return v.geoProjection(Re).scale(165.664)},d.geoEckert1Raw=Re,d.geoEckert2=function(){return v.geoProjection(Ye).scale(165.664)},d.geoEckert2Raw=Ye,d.geoEckert3=function(){return v.geoProjection(Qe).scale(180.739)},d.geoEckert3Raw=Qe,d.geoEckert4=function(){return v.geoProjection(lt).scale(180.739)},d.geoEckert4Raw=lt,d.geoEckert5=function(){return v.geoProjection(xt).scale(173.044)},d.geoEckert5Raw=xt,d.geoEckert6=function(){return v.geoProjection(wt).scale(173.044)},d.geoEckert6Raw=wt,d.geoEisenlohr=function(){return v.geoProjection(nt).scale(62.5271)},d.geoEisenlohrRaw=nt,d.geoFahey=function(){return v.geoProjection(vt).scale(137.152)},d.geoFaheyRaw=vt,d.geoFoucaut=function(){return v.geoProjection(Nt).scale(135.264)},d.geoFoucautRaw=Nt,d.geoFoucautSinusoidal=function(){var Ue=.5,We=v.geoProjectionMutator(qt),rt=We(Ue);return rt.alpha=function(ut){return arguments.length?We(Ue=+ut):Ue},rt.scale(168.725)},d.geoFoucautSinusoidalRaw=qt,d.geoGilbert=function(Ue){Ue==null&&(Ue=v.geoOrthographic);var We=Ue(),rt=v.geoEquirectangular().scale(A).precision(0).clipAngle(null).translate([0,0]);function ut(mt){return We(Jt(mt))}function yt(mt){ut[mt]=function(){return arguments.length?(We[mt].apply(We,arguments),ut):We[mt]()}}return We.invert&&(ut.invert=function(mt){return Wt(We.invert(mt))}),ut.stream=function(mt){var Lt=We.stream(mt),$t=rt.stream({point:function(er,Zt){Lt.point(er/2,P(c(-Zt/2*I))*A)},lineStart:function(){Lt.lineStart()},lineEnd:function(){Lt.lineEnd()},polygonStart:function(){Lt.polygonStart()},polygonEnd:function(){Lt.polygonEnd()}});return $t.sphere=Lt.sphere,$t},ut.rotate=function(mt){return arguments.length?(rt.rotate(mt),ut):rt.rotate()},ut.center=function(mt){return arguments.length?(We.center(Jt(mt)),ut):Wt(We.center())},yt("angle"),yt("clipAngle"),yt("clipExtent"),yt("fitExtent"),yt("fitHeight"),yt("fitSize"),yt("fitWidth"),yt("scale"),yt("translate"),yt("precision"),ut.scale(249.5)},d.geoGingery=function(){var Ue=6,We=30*I,rt=n(We),ut=p(We),yt=v.geoProjectionMutator(ar),mt=yt(We,Ue),Lt=mt.stream,$t=-n(.01*I),er=p(.01*I);return mt.radius=function(Zt){return arguments.length?(rt=n(We=Zt*I),ut=p(We),yt(We,Ue)):We*A},mt.lobes=function(Zt){return arguments.length?yt(We,Ue=+Zt):Ue},mt.stream=function(Zt){var or=mt.rotate(),mr=Lt(Zt),wr=(mt.rotate([0,0]),Lt(Zt));return mt.rotate(or),mr.sphere=function(){wr.polygonStart(),wr.lineStart();for(var Tr=0,Rr=2*x/Ue,on=0;Tr<Ue;++Tr,on-=Rr)wr.point(t(er*n(on),$t)*A,P(er*p(on))*A),wr.point(t(ut*n(on-Rr/2),rt)*A,P(ut*p(on-Rr/2))*A);wr.lineEnd(),wr.polygonEnd()},mr},mt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},d.geoGingeryRaw=ar,d.geoGinzburg4=function(){return v.geoProjection(pe).scale(149.995)},d.geoGinzburg4Raw=pe,d.geoGinzburg5=function(){return v.geoProjection(be).scale(153.93)},d.geoGinzburg5Raw=be,d.geoGinzburg6=function(){return v.geoProjection(Fe).scale(130.945)},d.geoGinzburg6Raw=Fe,d.geoGinzburg8=function(){return v.geoProjection(Ve).scale(131.747)},d.geoGinzburg8Raw=Ve,d.geoGinzburg9=function(){return v.geoProjection(Ke).scale(131.087)},d.geoGinzburg9Raw=Ke,d.geoGringorten=function(){return v.geoProjection(Ge(ct)).scale(239.75)},d.geoGringortenRaw=ct,d.geoGuyou=function(){return v.geoProjection(Ge(Ot)).scale(151.496)},d.geoGuyouRaw=Ot,d.geoHammer=function(){var Ue=2,We=v.geoProjectionMutator(N),rt=We(Ue);return rt.coefficient=function(ut){return arguments.length?We(Ue=+ut):Ue},rt.scale(169.529)},d.geoHammerRaw=N,d.geoHammerRetroazimuthal=function(){var Ue=0,We=v.geoProjectionMutator(it),rt=We(Ue),ut=rt.rotate,yt=rt.stream,mt=v.geoCircle();return rt.parallel=function(Lt){if(!arguments.length)return Ue*A;var $t=rt.rotate();return We(Ue=Lt*I).rotate($t)},rt.rotate=function(Lt){return arguments.length?(ut.call(rt,[Lt[0],Lt[1]-Ue*A]),mt.center([-Lt[0],-Lt[1]]),rt):((Lt=ut.call(rt))[1]+=Ue*A,Lt)},rt.stream=function(Lt){return(Lt=yt(Lt)).sphere=function(){Lt.polygonStart();var $t,er=mt.radius(89.99)().coordinates[0],Zt=er.length-1,or=-1;for(Lt.lineStart();++or<Zt;)Lt.point(($t=er[or])[0],$t[1]);for(Lt.lineEnd(),Zt=(er=mt.radius(90.01)().coordinates[0]).length-1,Lt.lineStart();--or>=0;)Lt.point(($t=er[or])[0],$t[1]);Lt.lineEnd(),Lt.polygonEnd()},Lt},rt.scale(79.4187).parallel(45).clipAngle(179.999)},d.geoHammerRetroazimuthalRaw=it,d.geoHealpix=function(){var Ue=4,We=v.geoProjectionMutator(Pt),rt=We(Ue),ut=rt.stream;return rt.lobes=function(yt){return arguments.length?We(Ue=+yt):Ue},rt.stream=function(yt){var mt=rt.rotate(),Lt=ut(yt),$t=(rt.rotate([0,0]),ut(yt));return rt.rotate(mt),Lt.sphere=function(){var er,Zt;v.geoStream((er=180/Ue,Zt=[].concat(w.range(-180,180+er/2,er).map(Ee),w.range(180,-180-er/2,-er).map(Ze)),{type:"Polygon",coordinates:[er===180?Zt.map(at):Zt]}),$t)},Lt},rt.scale(239.75)},d.geoHealpixRaw=Pt,d.geoHill=function(){var Ue=1,We=v.geoProjectionMutator(pt),rt=We(Ue);return rt.ratio=function(ut){return arguments.length?We(Ue=+ut):Ue},rt.scale(167.774).center([0,18.67])},d.geoHillRaw=pt,d.geoHomolosine=function(){return v.geoProjection(Ut).scale(152.63)},d.geoHomolosineRaw=Ut,d.geoHufnagel=function(){var Ue=1,We=0,rt=45*I,ut=2,yt=v.geoProjectionMutator(Kt),mt=yt(Ue,We,rt,ut);return mt.a=function(Lt){return arguments.length?yt(Ue=+Lt,We,rt,ut):Ue},mt.b=function(Lt){return arguments.length?yt(Ue,We=+Lt,rt,ut):We},mt.psiMax=function(Lt){return arguments.length?yt(Ue,We,rt=+Lt*I,ut):rt*A},mt.ratio=function(Lt){return arguments.length?yt(Ue,We,rt,ut=+Lt):ut},mt.scale(180.739)},d.geoHufnagelRaw=Kt,d.geoHyperelliptical=function(){var Ue=0,We=2.5,rt=1.183136,ut=v.geoProjectionMutator(pr),yt=ut(Ue,We,rt);return yt.alpha=function(mt){return arguments.length?ut(Ue=+mt,We,rt):Ue},yt.k=function(mt){return arguments.length?ut(Ue,We=+mt,rt):We},yt.gamma=function(mt){return arguments.length?ut(Ue,We,rt=+mt):rt},yt.scale(152.63)},d.geoHyperellipticalRaw=pr,d.geoInterrupt=tr,d.geoInterruptedBoggs=function(){return tr(de,rr).scale(160.857)},d.geoInterruptedHomolosine=function(){return tr(Ut,fr).scale(152.63)},d.geoInterruptedMollweide=function(){return tr(re,yr).scale(169.529)},d.geoInterruptedMollweideHemispheres=function(){return tr(re,Sr).scale(169.529).rotate([20,0])},d.geoInterruptedSinuMollweide=function(){return tr(St,Dr,B).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},d.geoInterruptedSinusoidal=function(){return tr(ve,Nr).scale(152.63).rotate([-20,0])},d.geoKavrayskiy7=function(){return v.geoProjection(Wr).scale(158.837)},d.geoKavrayskiy7Raw=Wr,d.geoLagrange=function(){var Ue=.5,We=v.geoProjectionMutator(hn),rt=We(Ue);return rt.spacing=function(ut){return arguments.length?We(Ue=+ut):Ue},rt.scale(124.75)},d.geoLagrangeRaw=hn,d.geoLarrivee=function(){return v.geoProjection(Fn).scale(97.2672)},d.geoLarriveeRaw=Fn,d.geoLaskowski=function(){return v.geoProjection(an).scale(139.98)},d.geoLaskowskiRaw=an,d.geoLittrow=function(){return v.geoProjection(xn).scale(144.049).clipAngle(89.999)},d.geoLittrowRaw=xn,d.geoLoximuthal=function(){return ce(_n).parallel(40).scale(158.837)},d.geoLoximuthalRaw=_n,d.geoMiller=function(){return v.geoProjection(ti).scale(108.318)},d.geoMillerRaw=ti,d.geoModifiedStereographic=Tn,d.geoModifiedStereographicRaw=jr,d.geoModifiedStereographicAlaska=function(){return Tn(nn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},d.geoModifiedStereographicGs48=function(){return Tn(vn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},d.geoModifiedStereographicGs50=function(){return Tn(en,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},d.geoModifiedStereographicMiller=function(){return Tn(fn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},d.geoModifiedStereographicLee=function(){return Tn(Gn,[165,10]).scale(250).clipAngle(130).center([-165,-10])},d.geoMollweide=function(){return v.geoProjection(re).scale(169.529)},d.geoMollweideRaw=re,d.geoMtFlatPolarParabolic=function(){return v.geoProjection(nr).scale(164.859)},d.geoMtFlatPolarParabolicRaw=nr,d.geoMtFlatPolarQuartic=function(){return v.geoProjection(vr).scale(188.209)},d.geoMtFlatPolarQuarticRaw=vr,d.geoMtFlatPolarSinusoidal=function(){return v.geoProjection(It).scale(166.518)},d.geoMtFlatPolarSinusoidalRaw=It,d.geoNaturalEarth2=function(){return v.geoProjection(lr).scale(175.295)},d.geoNaturalEarth2Raw=lr,d.geoNellHammer=function(){return v.geoProjection(dr).scale(152.63)},d.geoNellHammerRaw=dr,d.geoInterruptedQuarticAuthalic=function(){return tr(N(1/0),Br).rotate([20,0]).scale(152.63)},d.geoNicolosi=function(){return v.geoProjection(Fr).scale(127.267)},d.geoNicolosiRaw=Fr,d.geoPatterson=function(){return v.geoProjection(zr).scale(139.319)},d.geoPattersonRaw=zr,d.geoPolyconic=function(){return v.geoProjection(Er).scale(103.74)},d.geoPolyconicRaw=Er,d.geoPolyhedral=Gr,d.geoPolyhedralButterfly=function(Ue){Ue=Ue||function(rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:rt});return v.geoGnomonic().scale(1).translate([0,0]).rotate([-ut[0],-ut[1]])};var We=yn.map(function(rt){return{face:rt,project:Ue(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var yt=We[rt];yt&&(yt.children||(yt.children=[])).push(We[ut])}),Gr(We[0],function(rt,ut){return We[rt<-x/2?ut<0?6:4:rt<0?ut<0?2:0:rt<x/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(101.858).center([0,45])},d.geoPolyhedralCollignon=function(Ue){Ue=Ue||function(rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:rt});return v.geoProjection(kn).translate([0,0]).scale(1).rotate(ut[1]>0?[-ut[0],0]:[180-ut[0],180])};var We=yn.map(function(rt){return{face:rt,project:Ue(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var yt=We[rt];yt&&(yt.children||(yt.children=[])).push(We[ut])}),Gr(We[0],function(rt,ut){return We[rt<-x/2?ut<0?6:4:rt<0?ut<0?2:0:rt<x/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},d.geoPolyhedralWaterman=function(Ue){Ue=Ue||function(mt){var Lt=mt.length===6?v.geoCentroid({type:"MultiPoint",coordinates:mt}):mt[0];return v.geoGnomonic().scale(1).translate([0,0]).rotate([-Lt[0],-Lt[1]])};var We=yn.map(function(mt){for(var Lt,$t=mt.map(Zn),er=$t.length,Zt=$t[er-1],or=[],mr=0;mr<er;++mr)Lt=$t[mr],or.push(Dn([.9486832980505138*Zt[0]+.31622776601683794*Lt[0],.9486832980505138*Zt[1]+.31622776601683794*Lt[1],.9486832980505138*Zt[2]+.31622776601683794*Lt[2]]),Dn([.9486832980505138*Lt[0]+.31622776601683794*Zt[0],.9486832980505138*Lt[1]+.31622776601683794*Zt[1],.9486832980505138*Lt[2]+.31622776601683794*Zt[2]])),Zt=Lt;return or}),rt=[],ut=[-1,0,0,1,0,1,4,5];We.forEach(function(mt,Lt){for(var $t,er,Zt=yn[Lt],or=Zt.length,mr=rt[Lt]=[],wr=0;wr<or;++wr)We.push([Zt[wr],mt[(2*wr+2)%(2*or)],mt[(2*wr+1)%(2*or)]]),ut.push(Lt),mr.push(($t=Zn(mt[(2*wr+2)%(2*or)]),er=Zn(mt[(2*wr+1)%(2*or)]),[$t[1]*er[2]-$t[2]*er[1],$t[2]*er[0]-$t[0]*er[2],$t[0]*er[1]-$t[1]*er[0]]))});var yt=We.map(function(mt){return{project:Ue(mt),face:mt}});return ut.forEach(function(mt,Lt){var $t=yt[mt];$t&&($t.children||($t.children=[])).push(yt[Lt])}),Gr(yt[0],function(mt,Lt){var $t=n(Lt),er=[$t*n(mt),$t*p(mt),p(Lt)],Zt=mt<-x/2?Lt<0?6:4:mt<0?Lt<0?2:0:mt<x/2?Lt<0?3:1:Lt<0?7:5,or=rt[Zt];return yt[Pn(or[0],er)<0?8+3*Zt:Pn(or[1],er)<0?8+3*Zt+1:Pn(or[2],er)<0?8+3*Zt+2:Zt]}).angle(-30).scale(110.625).center([0,45])},d.geoProject=function(Ue,We){var rt,ut=We.stream;if(!ut)throw new Error("invalid projection");switch(Ue&&Ue.type){case"Feature":rt=En;break;case"FeatureCollection":rt=Mi;break;default:rt=Qn}return rt(Ue,ut)},d.geoGringortenQuincuncial=function(){return Wi(ct).scale(176.423)},d.geoPeirceQuincuncial=Zi,d.geoPierceQuincuncial=Zi,d.geoQuantize=function(Ue,We){if(!(0<=(We=+We)&&We<=20))throw new Error("invalid digits");function rt(Zt){var or=Zt.length,mr=2,wr=new Array(or);for(wr[0]=+Zt[0].toFixed(We),wr[1]=+Zt[1].toFixed(We);mr<or;)wr[mr]=Zt[mr],++mr;return wr}function ut(Zt){return Zt.map(rt)}function yt(Zt){for(var or=rt(Zt[0]),mr=[or],wr=1;wr<Zt.length;wr++){var Tr=rt(Zt[wr]);(Tr.length>2||Tr[0]!=or[0]||Tr[1]!=or[1])&&(mr.push(Tr),or=Tr)}return mr.length===1&&Zt.length>1&&mr.push(rt(Zt[Zt.length-1])),mr}function mt(Zt){return Zt.map(yt)}function Lt(Zt){if(Zt==null)return Zt;var or;switch(Zt.type){case"GeometryCollection":or={type:"GeometryCollection",geometries:Zt.geometries.map(Lt)};break;case"Point":or={type:"Point",coordinates:rt(Zt.coordinates)};break;case"MultiPoint":or={type:Zt.type,coordinates:ut(Zt.coordinates)};break;case"LineString":or={type:Zt.type,coordinates:yt(Zt.coordinates)};break;case"MultiLineString":case"Polygon":or={type:Zt.type,coordinates:mt(Zt.coordinates)};break;case"MultiPolygon":or={type:"MultiPolygon",coordinates:Zt.coordinates.map(mt)};break;default:return Zt}return Zt.bbox!=null&&(or.bbox=Zt.bbox),or}function $t(Zt){var or={type:"Feature",properties:Zt.properties,geometry:Lt(Zt.geometry)};return Zt.id!=null&&(or.id=Zt.id),Zt.bbox!=null&&(or.bbox=Zt.bbox),or}if(Ue!=null)switch(Ue.type){case"Feature":return $t(Ue);case"FeatureCollection":var er={type:"FeatureCollection",features:Ue.features.map($t)};return Ue.bbox!=null&&(er.bbox=Ue.bbox),er;default:return Lt(Ue)}return Ue},d.geoQuincuncial=Wi,d.geoRectangularPolyconic=function(){return ce(to).scale(131.215)},d.geoRectangularPolyconicRaw=to,d.geoRobinson=function(){return v.geoProjection(go).scale(152.63)},d.geoRobinsonRaw=go,d.geoSatellite=function(){var Ue=2,We=0,rt=v.geoProjectionMutator(bo),ut=rt(Ue,We);return ut.distance=function(yt){return arguments.length?rt(Ue=+yt,We):Ue},ut.tilt=function(yt){return arguments.length?rt(Ue,We=yt*I):We*A},ut.scale(432.147).clipAngle(S(1/Ue)*A-1e-6)},d.geoSatelliteRaw=bo,d.geoSinuMollweide=function(){return v.geoProjection(St).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},d.geoSinuMollweideRaw=St,d.geoSinusoidal=function(){return v.geoProjection(ve).scale(152.63)},d.geoSinusoidalRaw=ve,d.geoStitch=function(Ue){if(Ue==null)return Ue;switch(Ue.type){case"Feature":return Xi(Ue);case"FeatureCollection":var We={type:"FeatureCollection",features:Ue.features.map(Xi)};return Ue.bbox!=null&&(We.bbox=Ue.bbox),We;default:return Ts(Ue)}},d.geoTimes=function(){return v.geoProjection(ss).scale(146.153)},d.geoTimesRaw=ss,d.geoTwoPointAzimuthal=Ps,d.geoTwoPointAzimuthalRaw=Bs,d.geoTwoPointAzimuthalUsa=function(){return Ps([-158,21.5],[-77,39]).clipAngle(60).scale(400)},d.geoTwoPointEquidistant=Do,d.geoTwoPointEquidistantRaw=Ns,d.geoTwoPointEquidistantUsa=function(){return Do([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},d.geoVanDerGrinten=function(){return v.geoProjection(zo).scale(79.4183)},d.geoVanDerGrintenRaw=zo,d.geoVanDerGrinten2=function(){return v.geoProjection(Yo).scale(79.4183)},d.geoVanDerGrinten2Raw=Yo,d.geoVanDerGrinten3=function(){return v.geoProjection(Wo).scale(79.4183)},d.geoVanDerGrinten3Raw=Wo,d.geoVanDerGrinten4=function(){return v.geoProjection(Zo).scale(127.16)},d.geoVanDerGrinten4Raw=Zo,d.geoWagner=wo,d.geoWagner7=function(){return wo().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},d.geoWagnerRaw=ls,d.geoWagner4=function(){return v.geoProjection(Xo).scale(176.84)},d.geoWagner4Raw=Xo,d.geoWagner6=function(){return v.geoProjection(Ms).scale(152.63)},d.geoWagner6Raw=Ms,d.geoWiechel=function(){return v.geoProjection(Ro).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},d.geoWiechelRaw=Ro,d.geoWinkel3=function(){return v.geoProjection(Gi).scale(158.837)},d.geoWinkel3Raw=Gi,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-array")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(){return new y}function y(){this.reset()}y.prototype={constructor:y,reset:function(){this.s=this.t=0},add:function(dt){t(e,dt,this.t),t(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new y;function t(dt,Rt,cr){var Gt=dt.s=Rt+cr,ur=Gt-Rt,Or=Gt-ur;dt.t=Rt-Or+(cr-ur)}var n=1e-6,a=Math.PI,r=a/2,g=a/4,u=2*a,s=180/a,h=a/180,l=Math.abs,o=Math.atan,p=Math.atan2,c=Math.cos,i=Math.ceil,x=Math.exp,f=Math.log,_=Math.pow,b=Math.sin,T=Math.sign||function(dt){return dt>0?1:dt<0?-1:0},k=Math.sqrt,L=Math.tan;function A(dt){return dt>1?0:dt<-1?a:Math.acos(dt)}function I(dt){return dt>1?r:dt<-1?-r:Math.asin(dt)}function P(dt){return(dt=b(dt/2))*dt}function S(){}function E(dt,Rt){dt&&D.hasOwnProperty(dt.type)&&D[dt.type](dt,Rt)}var z={Feature:function(dt,Rt){E(dt.geometry,Rt)},FeatureCollection:function(dt,Rt){for(var cr=dt.features,Gt=-1,ur=cr.length;++Gt<ur;)E(cr[Gt].geometry,Rt)}},D={Sphere:function(dt,Rt){Rt.sphere()},Point:function(dt,Rt){dt=dt.coordinates,Rt.point(dt[0],dt[1],dt[2])},MultiPoint:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)dt=cr[Gt],Rt.point(dt[0],dt[1],dt[2])},LineString:function(dt,Rt){j(dt.coordinates,Rt,0)},MultiLineString:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)j(cr[Gt],Rt,0)},Polygon:function(dt,Rt){V(dt.coordinates,Rt)},MultiPolygon:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)V(cr[Gt],Rt)},GeometryCollection:function(dt,Rt){for(var cr=dt.geometries,Gt=-1,ur=cr.length;++Gt<ur;)E(cr[Gt],Rt)}};function j(dt,Rt,cr){var Gt,ur=-1,Or=dt.length-cr;for(Rt.lineStart();++ur<Or;)Gt=dt[ur],Rt.point(Gt[0],Gt[1],Gt[2]);Rt.lineEnd()}function V(dt,Rt){var cr=-1,Gt=dt.length;for(Rt.polygonStart();++cr<Gt;)j(dt[cr],Rt,1);Rt.polygonEnd()}function Z(dt,Rt){dt&&z.hasOwnProperty(dt.type)?z[dt.type](dt,Rt):E(dt,Rt)}var Q,K,$,ne,H,N=w(),U=w(),te={point:S,lineStart:S,lineEnd:S,polygonStart:function(){N.reset(),te.lineStart=B,te.lineEnd=X},polygonEnd:function(){var dt=+N;U.add(dt<0?u+dt:dt),this.lineStart=this.lineEnd=this.point=S},sphere:function(){U.add(u)}};function B(){te.point=J}function X(){ee(Q,K)}function J(dt,Rt){te.point=ee,Q=dt,K=Rt,$=dt*=h,ne=c(Rt=(Rt*=h)/2+g),H=b(Rt)}function ee(dt,Rt){var cr=(dt*=h)-$,Gt=cr>=0?1:-1,ur=Gt*cr,Or=c(Rt=(Rt*=h)/2+g),Ur=b(Rt),Xr=H*Ur,cn=ne*Or+Xr*c(ur),sn=Xr*Gt*b(ur);N.add(p(sn,cn)),$=dt,ne=Or,H=Ur}function re(dt){return[p(dt[1],dt[0]),I(dt[2])]}function se(dt){var Rt=dt[0],cr=dt[1],Gt=c(cr);return[Gt*c(Rt),Gt*b(Rt),b(cr)]}function oe(dt,Rt){return dt[0]*Rt[0]+dt[1]*Rt[1]+dt[2]*Rt[2]}function de(dt,Rt){return[dt[1]*Rt[2]-dt[2]*Rt[1],dt[2]*Rt[0]-dt[0]*Rt[2],dt[0]*Rt[1]-dt[1]*Rt[0]]}function ce(dt,Rt){dt[0]+=Rt[0],dt[1]+=Rt[1],dt[2]+=Rt[2]}function ve(dt,Rt){return[dt[0]*Rt,dt[1]*Rt,dt[2]*Rt]}function Ae(dt){var Rt=k(dt[0]*dt[0]+dt[1]*dt[1]+dt[2]*dt[2]);dt[0]/=Rt,dt[1]/=Rt,dt[2]/=Rt}var fe,me,_e,le,ge,Te,Se,Me,ze,Oe,De,Xe,Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e,vt,Nt,qt,Jt=w(),Wt={point:ar,lineStart:Ne,lineEnd:qe,polygonStart:function(){Wt.point=pe,Wt.lineStart=be,Wt.lineEnd=Fe,Jt.reset(),te.polygonStart()},polygonEnd:function(){te.polygonEnd(),Wt.point=ar,Wt.lineStart=Ne,Wt.lineEnd=qe,N<0?(fe=-(_e=180),me=-(le=90)):Jt>n?le=90:Jt<-n&&(me=-90),Oe[0]=fe,Oe[1]=_e},sphere:function(){fe=-(_e=180),me=-(le=90)}};function ar(dt,Rt){ze.push(Oe=[fe=dt,_e=dt]),Rt<me&&(me=Rt),Rt>le&&(le=Rt)}function Dt(dt,Rt){var cr=se([dt*h,Rt*h]);if(Me){var Gt=de(Me,cr),ur=de([Gt[1],-Gt[0],0],Gt);Ae(ur),ur=re(ur);var Or,Ur=dt-ge,Xr=Ur>0?1:-1,cn=ur[0]*s*Xr,sn=l(Ur)>180;sn^(Xr*ge<cn&&cn<Xr*dt)?(Or=ur[1]*s)>le&&(le=Or):sn^(Xr*ge<(cn=(cn+360)%360-180)&&cn<Xr*dt)?(Or=-ur[1]*s)<me&&(me=Or):(Rt<me&&(me=Rt),Rt>le&&(le=Rt)),sn?dt<ge?Ve(fe,dt)>Ve(fe,_e)&&(_e=dt):Ve(dt,_e)>Ve(fe,_e)&&(fe=dt):_e>=fe?(dt<fe&&(fe=dt),dt>_e&&(_e=dt)):dt>ge?Ve(fe,dt)>Ve(fe,_e)&&(_e=dt):Ve(dt,_e)>Ve(fe,_e)&&(fe=dt)}else ze.push(Oe=[fe=dt,_e=dt]);Rt<me&&(me=Rt),Rt>le&&(le=Rt),Me=cr,ge=dt}function Ne(){Wt.point=Dt}function qe(){Oe[0]=fe,Oe[1]=_e,Wt.point=ar,Me=null}function pe(dt,Rt){if(Me){var cr=dt-ge;Jt.add(l(cr)>180?cr+(cr>0?360:-360):cr)}else Te=dt,Se=Rt;te.point(dt,Rt),Dt(dt,Rt)}function be(){te.lineStart()}function Fe(){pe(Te,Se),te.lineEnd(),l(Jt)>n&&(fe=-(_e=180)),Oe[0]=fe,Oe[1]=_e,Me=null}function Ve(dt,Rt){return(Rt-=dt)<0?Rt+360:Rt}function Ke(dt,Rt){return dt[0]-Rt[0]}function Ge(dt,Rt){return dt[0]<=dt[1]?dt[0]<=Rt&&Rt<=dt[1]:Rt<dt[0]||dt[1]<Rt}var ct={sphere:S,point:st,lineStart:Ot,lineEnd:jt,polygonStart:function(){ct.lineStart=kt,ct.lineEnd=Pt},polygonEnd:function(){ct.lineStart=Ot,ct.lineEnd=jt}};function st(dt,Rt){dt*=h;var cr=c(Rt*=h);Mt(cr*c(dt),cr*b(dt),b(Rt))}function Mt(dt,Rt,cr){++De,Be+=(dt-Be)/De,Ie+=(Rt-Ie)/De,Re+=(cr-Re)/De}function Ot(){ct.point=it}function it(dt,Rt){dt*=h;var cr=c(Rt*=h);vt=cr*c(dt),Nt=cr*b(dt),qt=b(Rt),ct.point=ht,Mt(vt,Nt,qt)}function ht(dt,Rt){dt*=h;var cr=c(Rt*=h),Gt=cr*c(dt),ur=cr*b(dt),Or=b(Rt),Ur=p(k((Ur=Nt*Or-qt*ur)*Ur+(Ur=qt*Gt-vt*Or)*Ur+(Ur=vt*ur-Nt*Gt)*Ur),vt*Gt+Nt*ur+qt*Or);Xe+=Ur,Ye+=Ur*(vt+(vt=Gt)),Qe+=Ur*(Nt+(Nt=ur)),lt+=Ur*(qt+(qt=Or)),Mt(vt,Nt,qt)}function jt(){ct.point=st}function kt(){ct.point=Ee}function Pt(){Ze(nt,$e),ct.point=st}function Ee(dt,Rt){nt=dt,$e=Rt,dt*=h,Rt*=h,ct.point=Ze;var cr=c(Rt);vt=cr*c(dt),Nt=cr*b(dt),qt=b(Rt),Mt(vt,Nt,qt)}function Ze(dt,Rt){dt*=h;var cr=c(Rt*=h),Gt=cr*c(dt),ur=cr*b(dt),Or=b(Rt),Ur=Nt*Or-qt*ur,Xr=qt*Gt-vt*Or,cn=vt*ur-Nt*Gt,sn=k(Ur*Ur+Xr*Xr+cn*cn),gn=I(sn),Mn=sn&&-gn/sn;xt+=Mn*Ur,wt+=Mn*Xr,bt+=Mn*cn,Xe+=gn,Ye+=gn*(vt+(vt=Gt)),Qe+=gn*(Nt+(Nt=ur)),lt+=gn*(qt+(qt=Or)),Mt(vt,Nt,qt)}function at(dt){return function(){return dt}}function pt(dt,Rt){function cr(Gt,ur){return Gt=dt(Gt,ur),Rt(Gt[0],Gt[1])}return dt.invert&&Rt.invert&&(cr.invert=function(Gt,ur){return(Gt=Rt.invert(Gt,ur))&&dt.invert(Gt[0],Gt[1])}),cr}function St(dt,Rt){return[l(dt)>a?dt+Math.round(-dt/u)*u:dt,Rt]}function Ut(dt,Rt,cr){return(dt%=u)?Rt||cr?pt(Ht(dt),pr(Rt,cr)):Ht(dt):Rt||cr?pr(Rt,cr):St}function Kt(dt){return function(Rt,cr){return[(Rt+=dt)>a?Rt-u:Rt<-a?Rt+u:Rt,cr]}}function Ht(dt){var Rt=Kt(dt);return Rt.invert=Kt(-dt),Rt}function pr(dt,Rt){var cr=c(dt),Gt=b(dt),ur=c(Rt),Or=b(Rt);function Ur(Xr,cn){var sn=c(cn),gn=c(Xr)*sn,Mn=b(Xr)*sn,un=b(cn),An=un*cr+gn*Gt;return[p(Mn*ur-An*Or,gn*cr-un*Gt),I(An*ur+Mn*Or)]}return Ur.invert=function(Xr,cn){var sn=c(cn),gn=c(Xr)*sn,Mn=b(Xr)*sn,un=b(cn),An=un*ur-Mn*Or;return[p(Mn*ur+un*Or,gn*cr+An*Gt),I(An*cr-gn*Gt)]},Ur}function Mr(dt){function Rt(cr){return(cr=dt(cr[0]*h,cr[1]*h))[0]*=s,cr[1]*=s,cr}return dt=Ut(dt[0]*h,dt[1]*h,dt.length>2?dt[2]*h:0),Rt.invert=function(cr){return(cr=dt.invert(cr[0]*h,cr[1]*h))[0]*=s,cr[1]*=s,cr},Rt}function hr(dt,Rt,cr,Gt,ur,Or){if(cr){var Ur=c(Rt),Xr=b(Rt),cn=Gt*cr;ur==null?(ur=Rt+Gt*u,Or=Rt-cn/2):(ur=Qt(Ur,ur),Or=Qt(Ur,Or),(Gt>0?ur<Or:ur>Or)&&(ur+=Gt*u));for(var sn,gn=ur;Gt>0?gn>Or:gn<Or;gn-=cn)sn=re([Ur,-Xr*c(gn),-Xr*b(gn)]),dt.point(sn[0],sn[1])}}function Qt(dt,Rt){(Rt=se(Rt))[0]-=dt,Ae(Rt);var cr=A(-Rt[1]);return((-Rt[2]<0?-cr:cr)+u-n)%u}function tr(){var dt,Rt=[];return{point:function(cr,Gt,ur){dt.push([cr,Gt,ur])},lineStart:function(){Rt.push(dt=[])},lineEnd:S,rejoin:function(){Rt.length>1&&Rt.push(Rt.pop().concat(Rt.shift()))},result:function(){var cr=Rt;return Rt=[],dt=null,cr}}}function rr(dt,Rt){return l(dt[0]-Rt[0])<n&&l(dt[1]-Rt[1])<n}function fr(dt,Rt,cr,Gt){this.x=dt,this.z=Rt,this.o=cr,this.e=Gt,this.v=!1,this.n=this.p=null}function yr(dt,Rt,cr,Gt,ur){var Or,Ur,Xr=[],cn=[];if(dt.forEach(function(Bn){if(!((Hn=Bn.length-1)<=0)){var Hn,si,Kr=Bn[0],ni=Bn[Hn];if(rr(Kr,ni)){if(!Kr[2]&&!ni[2]){for(ur.lineStart(),Or=0;Or<Hn;++Or)ur.point((Kr=Bn[Or])[0],Kr[1]);return void ur.lineEnd()}ni[0]+=2*n}Xr.push(si=new fr(Kr,Bn,null,!0)),cn.push(si.o=new fr(Kr,null,si,!1)),Xr.push(si=new fr(ni,Bn,null,!1)),cn.push(si.o=new fr(ni,null,si,!0))}}),Xr.length){for(cn.sort(Rt),Sr(Xr),Sr(cn),Or=0,Ur=cn.length;Or<Ur;++Or)cn[Or].e=cr=!cr;for(var sn,gn,Mn=Xr[0];;){for(var un=Mn,An=!0;un.v;)if((un=un.n)===Mn)return;sn=un.z,ur.lineStart();do{if(un.v=un.o.v=!0,un.e){if(An)for(Or=0,Ur=sn.length;Or<Ur;++Or)ur.point((gn=sn[Or])[0],gn[1]);else Gt(un.x,un.n.x,1,ur);un=un.n}else{if(An)for(sn=un.p.z,Or=sn.length-1;Or>=0;--Or)ur.point((gn=sn[Or])[0],gn[1]);else Gt(un.x,un.p.x,-1,ur);un=un.p}sn=(un=un.o).z,An=!An}while(!un.v);ur.lineEnd()}}}function Sr(dt){if(Rt=dt.length){for(var Rt,cr,Gt=0,ur=dt[0];++Gt<Rt;)ur.n=cr=dt[Gt],cr.p=ur,ur=cr;ur.n=cr=dt[0],cr.p=ur}}St.invert=St;var Dr=w();function Nr(dt){return l(dt[0])<=a?dt[0]:T(dt[0])*((l(dt[0])+a)%u-a)}function Wr(dt,Rt){var cr=Nr(Rt),Gt=Rt[1],ur=b(Gt),Or=[b(cr),-c(cr),0],Ur=0,Xr=0;Dr.reset(),ur===1?Gt=r+n:ur===-1&&(Gt=-r-n);for(var cn=0,sn=dt.length;cn<sn;++cn)if(Mn=(gn=dt[cn]).length)for(var gn,Mn,un=gn[Mn-1],An=Nr(un),Bn=un[1]/2+g,Hn=b(Bn),si=c(Bn),Kr=0;Kr<Mn;++Kr,An=On,Hn=ri,si=ki,un=ni){var ni=gn[Kr],On=Nr(ni),Un=ni[1]/2+g,ri=b(Un),ki=c(Un),Pi=On-An,Ln=Pi>=0?1:-1,Ri=Ln*Pi,Ci=Ri>a,gi=Hn*ri;if(Dr.add(p(gi*Ln*b(Ri),si*ki+gi*c(Ri))),Ur+=Ci?Pi+Ln*u:Pi,Ci^An>=cr^On>=cr){var Fi=de(se(un),se(ni));Ae(Fi);var Ei=de(Or,Fi);Ae(Ei);var ra=(Ci^Pi>=0?-1:1)*I(Ei[2]);(Gt>ra||Gt===ra&&(Fi[0]||Fi[1]))&&(Xr+=Ci^Pi>=0?1:-1)}}return(Ur<-n||Ur<n&&Dr<-n)^1&Xr}function hn(dt,Rt,cr,Gt){return function(ur){var Or,Ur,Xr,cn=Rt(ur),sn=tr(),gn=Rt(sn),Mn=!1,un={point:An,lineStart:Hn,lineEnd:si,polygonStart:function(){un.point=Kr,un.lineStart=ni,un.lineEnd=On,Ur=[],Or=[]},polygonEnd:function(){un.point=An,un.lineStart=Hn,un.lineEnd=si,Ur=v.merge(Ur);var Un=Wr(Or,Gt);Ur.length?(Mn||(ur.polygonStart(),Mn=!0),yr(Ur,Fn,Un,cr,ur)):Un&&(Mn||(ur.polygonStart(),Mn=!0),ur.lineStart(),cr(null,null,1,ur),ur.lineEnd()),Mn&&(ur.polygonEnd(),Mn=!1),Ur=Or=null},sphere:function(){ur.polygonStart(),ur.lineStart(),cr(null,null,1,ur),ur.lineEnd(),ur.polygonEnd()}};function An(Un,ri){dt(Un,ri)&&ur.point(Un,ri)}function Bn(Un,ri){cn.point(Un,ri)}function Hn(){un.point=Bn,cn.lineStart()}function si(){un.point=An,cn.lineEnd()}function Kr(Un,ri){Xr.push([Un,ri]),gn.point(Un,ri)}function ni(){gn.lineStart(),Xr=[]}function On(){Kr(Xr[0][0],Xr[0][1]),gn.lineEnd();var Un,ri,ki,Pi,Ln=gn.clean(),Ri=sn.result(),Ci=Ri.length;if(Xr.pop(),Or.push(Xr),Xr=null,Ci)if(1&Ln){if((ri=(ki=Ri[0]).length-1)>0){for(Mn||(ur.polygonStart(),Mn=!0),ur.lineStart(),Un=0;Un<ri;++Un)ur.point((Pi=ki[Un])[0],Pi[1]);ur.lineEnd()}}else Ci>1&&2&Ln&&Ri.push(Ri.pop().concat(Ri.shift())),Ur.push(Ri.filter(tn))}return un}}function tn(dt){return dt.length>1}function Fn(dt,Rt){return((dt=dt.x)[0]<0?dt[1]-r-n:r-dt[1])-((Rt=Rt.x)[0]<0?Rt[1]-r-n:r-Rt[1])}var an=hn(function(){return!0},function(dt){var Rt,cr=NaN,Gt=NaN,ur=NaN;return{lineStart:function(){dt.lineStart(),Rt=1},point:function(Or,Ur){var Xr=Or>0?a:-a,cn=l(Or-cr);l(cn-a)<n?(dt.point(cr,Gt=(Gt+Ur)/2>0?r:-r),dt.point(ur,Gt),dt.lineEnd(),dt.lineStart(),dt.point(Xr,Gt),dt.point(Or,Gt),Rt=0):ur!==Xr&&cn>=a&&(l(cr-ur)<n&&(cr-=ur*n),l(Or-Xr)<n&&(Or-=Xr*n),Gt=function(sn,gn,Mn,un){var An,Bn,Hn=b(sn-Mn);return l(Hn)>n?o((b(gn)*(Bn=c(un))*b(Mn)-b(un)*(An=c(gn))*b(sn))/(An*Bn*Hn)):(gn+un)/2}(cr,Gt,Or,Ur),dt.point(ur,Gt),dt.lineEnd(),dt.lineStart(),dt.point(Xr,Gt),Rt=0),dt.point(cr=Or,Gt=Ur),ur=Xr},lineEnd:function(){dt.lineEnd(),cr=Gt=NaN},clean:function(){return 2-Rt}}},function(dt,Rt,cr,Gt){var ur;if(dt==null)ur=cr*r,Gt.point(-a,ur),Gt.point(0,ur),Gt.point(a,ur),Gt.point(a,0),Gt.point(a,-ur),Gt.point(0,-ur),Gt.point(-a,-ur),Gt.point(-a,0),Gt.point(-a,ur);else if(l(dt[0]-Rt[0])>n){var Or=dt[0]<Rt[0]?a:-a;ur=cr*Or/2,Gt.point(-Or,ur),Gt.point(0,ur),Gt.point(Or,ur)}else Gt.point(Rt[0],Rt[1])},[-a,-r]);function xn(dt){var Rt=c(dt),cr=6*h,Gt=Rt>0,ur=l(Rt)>n;function Or(cn,sn){return c(cn)*c(sn)>Rt}function Ur(cn,sn,gn){var Mn=[1,0,0],un=de(se(cn),se(sn)),An=oe(un,un),Bn=un[0],Hn=An-Bn*Bn;if(!Hn)return!gn&&cn;var si=Rt*An/Hn,Kr=-Rt*Bn/Hn,ni=de(Mn,un),On=ve(Mn,si);ce(On,ve(un,Kr));var Un=ni,ri=oe(On,Un),ki=oe(Un,Un),Pi=ri*ri-ki*(oe(On,On)-1);if(!(Pi<0)){var Ln=k(Pi),Ri=ve(Un,(-ri-Ln)/ki);if(ce(Ri,On),Ri=re(Ri),!gn)return Ri;var Ci,gi=cn[0],Fi=sn[0],Ei=cn[1],ra=sn[1];Fi<gi&&(Ci=gi,gi=Fi,Fi=Ci);var ii=Fi-gi,Ki=l(ii-a)<n;if(!Ki&&ra<Ei&&(Ci=Ei,Ei=ra,ra=Ci),Ki||ii<n?Ki?Ei+ra>0^Ri[1]<(l(Ri[0]-gi)<n?Ei:ra):Ei<=Ri[1]&&Ri[1]<=ra:ii>a^(gi<=Ri[0]&&Ri[0]<=Fi)){var qa=ve(Un,(-ri+Ln)/ki);return ce(qa,On),[Ri,re(qa)]}}}function Xr(cn,sn){var gn=Gt?dt:a-dt,Mn=0;return cn<-gn?Mn|=1:cn>gn&&(Mn|=2),sn<-gn?Mn|=4:sn>gn&&(Mn|=8),Mn}return hn(Or,function(cn){var sn,gn,Mn,un,An;return{lineStart:function(){un=Mn=!1,An=1},point:function(Bn,Hn){var si,Kr=[Bn,Hn],ni=Or(Bn,Hn),On=Gt?ni?0:Xr(Bn,Hn):ni?Xr(Bn+(Bn<0?a:-a),Hn):0;if(!sn&&(un=Mn=ni)&&cn.lineStart(),ni!==Mn&&(!(si=Ur(sn,Kr))||rr(sn,si)||rr(Kr,si))&&(Kr[2]=1),ni!==Mn)An=0,ni?(cn.lineStart(),si=Ur(Kr,sn),cn.point(si[0],si[1])):(si=Ur(sn,Kr),cn.point(si[0],si[1],2),cn.lineEnd()),sn=si;else if(ur&&sn&&Gt^ni){var Un;On&gn||!(Un=Ur(Kr,sn,!0))||(An=0,Gt?(cn.lineStart(),cn.point(Un[0][0],Un[0][1]),cn.point(Un[1][0],Un[1][1]),cn.lineEnd()):(cn.point(Un[1][0],Un[1][1]),cn.lineEnd(),cn.lineStart(),cn.point(Un[0][0],Un[0][1],3)))}!ni||sn&&rr(sn,Kr)||cn.point(Kr[0],Kr[1]),sn=Kr,Mn=ni,gn=On},lineEnd:function(){Mn&&cn.lineEnd(),sn=null},clean:function(){return An|(un&&Mn)<<1}}},function(cn,sn,gn,Mn){hr(Mn,dt,cr,gn,cn,sn)},Gt?[0,-dt]:[-a,dt-a])}function _n(dt,Rt,cr,Gt){function ur(sn,gn){return dt<=sn&&sn<=cr&&Rt<=gn&&gn<=Gt}function Or(sn,gn,Mn,un){var An=0,Bn=0;if(sn==null||(An=Ur(sn,Mn))!==(Bn=Ur(gn,Mn))||cn(sn,gn)<0^Mn>0)do un.point(An===0||An===3?dt:cr,An>1?Gt:Rt);while((An=(An+Mn+4)%4)!==Bn);else un.point(gn[0],gn[1])}function Ur(sn,gn){return l(sn[0]-dt)<n?gn>0?0:3:l(sn[0]-cr)<n?gn>0?2:1:l(sn[1]-Rt)<n?gn>0?1:0:gn>0?3:2}function Xr(sn,gn){return cn(sn.x,gn.x)}function cn(sn,gn){var Mn=Ur(sn,1),un=Ur(gn,1);return Mn!==un?Mn-un:Mn===0?gn[1]-sn[1]:Mn===1?sn[0]-gn[0]:Mn===2?sn[1]-gn[1]:gn[0]-sn[0]}return function(sn){var gn,Mn,un,An,Bn,Hn,si,Kr,ni,On,Un,ri=sn,ki=tr(),Pi={point:Ln,lineStart:function(){Pi.point=Ri,Mn&&Mn.push(un=[]),On=!0,ni=!1,si=Kr=NaN},lineEnd:function(){gn&&(Ri(An,Bn),Hn&&ni&&ki.rejoin(),gn.push(ki.result())),Pi.point=Ln,ni&&ri.lineEnd()},polygonStart:function(){ri=ki,gn=[],Mn=[],Un=!0},polygonEnd:function(){var Ci=function(){for(var Ei=0,ra=0,ii=Mn.length;ra<ii;++ra)for(var Ki,qa,es=Mn[ra],Uo=1,To=es.length,xi=es[0],xa=xi[0],ko=xi[1];Uo<To;++Uo)Ki=xa,qa=ko,xi=es[Uo],xa=xi[0],ko=xi[1],qa<=Gt?ko>Gt&&(xa-Ki)*(Gt-qa)>(ko-qa)*(dt-Ki)&&++Ei:ko<=Gt&&(xa-Ki)*(Gt-qa)<(ko-qa)*(dt-Ki)&&--Ei;return Ei}(),gi=Un&&Ci,Fi=(gn=v.merge(gn)).length;(gi||Fi)&&(sn.polygonStart(),gi&&(sn.lineStart(),Or(null,null,1,sn),sn.lineEnd()),Fi&&yr(gn,Xr,Ci,Or,sn),sn.polygonEnd()),ri=sn,gn=Mn=un=null}};function Ln(Ci,gi){ur(Ci,gi)&&ri.point(Ci,gi)}function Ri(Ci,gi){var Fi=ur(Ci,gi);if(Mn&&un.push([Ci,gi]),On)An=Ci,Bn=gi,Hn=Fi,On=!1,Fi&&(ri.lineStart(),ri.point(Ci,gi));else if(Fi&&ni)ri.point(Ci,gi);else{var Ei=[si=Math.max(-1e9,Math.min(1e9,si)),Kr=Math.max(-1e9,Math.min(1e9,Kr))],ra=[Ci=Math.max(-1e9,Math.min(1e9,Ci)),gi=Math.max(-1e9,Math.min(1e9,gi))];(function(ii,Ki,qa,es,Uo,To){var xi,xa=ii[0],ko=ii[1],Ji=0,Sa=1,Ka=Ki[0]-xa,ia=Ki[1]-ko;if(xi=qa-xa,Ka||!(xi>0)){if(xi/=Ka,Ka<0){if(xi<Ji)return;xi<Sa&&(Sa=xi)}else if(Ka>0){if(xi>Sa)return;xi>Ji&&(Ji=xi)}if(xi=Uo-xa,Ka||!(xi<0)){if(xi/=Ka,Ka<0){if(xi>Sa)return;xi>Ji&&(Ji=xi)}else if(Ka>0){if(xi<Ji)return;xi<Sa&&(Sa=xi)}if(xi=es-ko,ia||!(xi>0)){if(xi/=ia,ia<0){if(xi<Ji)return;xi<Sa&&(Sa=xi)}else if(ia>0){if(xi>Sa)return;xi>Ji&&(Ji=xi)}if(xi=To-ko,ia||!(xi<0)){if(xi/=ia,ia<0){if(xi>Sa)return;xi>Ji&&(Ji=xi)}else if(ia>0){if(xi<Ji)return;xi<Sa&&(Sa=xi)}return Ji>0&&(ii[0]=xa+Ji*Ka,ii[1]=ko+Ji*ia),Sa<1&&(Ki[0]=xa+Sa*Ka,Ki[1]=ko+Sa*ia),!0}}}}})(Ei,ra,dt,Rt,cr,Gt)?(ni||(ri.lineStart(),ri.point(Ei[0],Ei[1])),ri.point(ra[0],ra[1]),Fi||ri.lineEnd(),Un=!1):Fi&&(ri.lineStart(),ri.point(Ci,gi),Un=!1)}si=Ci,Kr=gi,ni=Fi}return Pi}}var ti,jr,nn,vn=w(),en={sphere:S,point:S,lineStart:function(){en.point=Gn,en.lineEnd=fn},lineEnd:S,polygonStart:S,polygonEnd:S};function fn(){en.point=en.lineEnd=S}function Gn(dt,Rt){ti=dt*=h,jr=b(Rt*=h),nn=c(Rt),en.point=Tn}function Tn(dt,Rt){dt*=h;var cr=b(Rt*=h),Gt=c(Rt),ur=l(dt-ti),Or=c(ur),Ur=Gt*b(ur),Xr=nn*cr-jr*Gt*Or,cn=jr*cr+nn*Gt*Or;vn.add(p(k(Ur*Ur+Xr*Xr),cn)),ti=dt,jr=cr,nn=Gt}function Cn(dt){return vn.reset(),Z(dt,en),+vn}var oi=[null,null],nr={type:"LineString",coordinates:oi};function vr(dt,Rt){return oi[0]=dt,oi[1]=Rt,Cn(nr)}var It={Feature:function(dt,Rt){return dr(dt.geometry,Rt)},FeatureCollection:function(dt,Rt){for(var cr=dt.features,Gt=-1,ur=cr.length;++Gt<ur;)if(dr(cr[Gt].geometry,Rt))return!0;return!1}},lr={Sphere:function(){return!0},Point:function(dt,Rt){return Br(dt.coordinates,Rt)},MultiPoint:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)if(Br(cr[Gt],Rt))return!0;return!1},LineString:function(dt,Rt){return Fr(dt.coordinates,Rt)},MultiLineString:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)if(Fr(cr[Gt],Rt))return!0;return!1},Polygon:function(dt,Rt){return zr(dt.coordinates,Rt)},MultiPolygon:function(dt,Rt){for(var cr=dt.coordinates,Gt=-1,ur=cr.length;++Gt<ur;)if(zr(cr[Gt],Rt))return!0;return!1},GeometryCollection:function(dt,Rt){for(var cr=dt.geometries,Gt=-1,ur=cr.length;++Gt<ur;)if(dr(cr[Gt],Rt))return!0;return!1}};function dr(dt,Rt){return!(!dt||!lr.hasOwnProperty(dt.type))&&lr[dt.type](dt,Rt)}function Br(dt,Rt){return vr(dt,Rt)===0}function Fr(dt,Rt){for(var cr,Gt,ur,Or=0,Ur=dt.length;Or<Ur;Or++){if((Gt=vr(dt[Or],Rt))===0||Or>0&&(ur=vr(dt[Or],dt[Or-1]))>0&&cr<=ur&&Gt<=ur&&(cr+Gt-ur)*(1-Math.pow((cr-Gt)/ur,2))<1e-12*ur)return!0;cr=Gt}return!1}function zr(dt,Rt){return!!Wr(dt.map(Er),xr(Rt))}function Er(dt){return(dt=dt.map(xr)).pop(),dt}function xr(dt){return[dt[0]*h,dt[1]*h]}function _r(dt,Rt,cr){var Gt=v.range(dt,Rt-n,cr).concat(Rt);return function(ur){return Gt.map(function(Or){return[ur,Or]})}}function kr(dt,Rt,cr){var Gt=v.range(dt,Rt-n,cr).concat(Rt);return function(ur){return Gt.map(function(Or){return[Or,ur]})}}function Cr(){var dt,Rt,cr,Gt,ur,Or,Ur,Xr,cn,sn,gn,Mn,un=10,An=un,Bn=90,Hn=360,si=2.5;function Kr(){return{type:"MultiLineString",coordinates:ni()}}function ni(){return v.range(i(Gt/Bn)*Bn,cr,Bn).map(gn).concat(v.range(i(Xr/Hn)*Hn,Ur,Hn).map(Mn)).concat(v.range(i(Rt/un)*un,dt,un).filter(function(On){return l(On%Bn)>n}).map(cn)).concat(v.range(i(Or/An)*An,ur,An).filter(function(On){return l(On%Hn)>n}).map(sn))}return Kr.lines=function(){return ni().map(function(On){return{type:"LineString",coordinates:On}})},Kr.outline=function(){return{type:"Polygon",coordinates:[gn(Gt).concat(Mn(Ur).slice(1),gn(cr).reverse().slice(1),Mn(Xr).reverse().slice(1))]}},Kr.extent=function(On){return arguments.length?Kr.extentMajor(On).extentMinor(On):Kr.extentMinor()},Kr.extentMajor=function(On){return arguments.length?(Gt=+On[0][0],cr=+On[1][0],Xr=+On[0][1],Ur=+On[1][1],Gt>cr&&(On=Gt,Gt=cr,cr=On),Xr>Ur&&(On=Xr,Xr=Ur,Ur=On),Kr.precision(si)):[[Gt,Xr],[cr,Ur]]},Kr.extentMinor=function(On){return arguments.length?(Rt=+On[0][0],dt=+On[1][0],Or=+On[0][1],ur=+On[1][1],Rt>dt&&(On=Rt,Rt=dt,dt=On),Or>ur&&(On=Or,Or=ur,ur=On),Kr.precision(si)):[[Rt,Or],[dt,ur]]},Kr.step=function(On){return arguments.length?Kr.stepMajor(On).stepMinor(On):Kr.stepMinor()},Kr.stepMajor=function(On){return arguments.length?(Bn=+On[0],Hn=+On[1],Kr):[Bn,Hn]},Kr.stepMinor=function(On){return arguments.length?(un=+On[0],An=+On[1],Kr):[un,An]},Kr.precision=function(On){return arguments.length?(si=+On,cn=_r(Or,ur,90),sn=kr(Rt,dt,si),gn=_r(Xr,Ur,90),Mn=kr(Gt,cr,si),Kr):si},Kr.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Gr(dt){return dt}var qr,Qr,rn,yn,wn=w(),kn=w(),Pn={point:S,lineStart:S,lineEnd:S,polygonStart:function(){Pn.lineStart=Dn,Pn.lineEnd=Mi},polygonEnd:function(){Pn.lineStart=Pn.lineEnd=Pn.point=S,wn.add(l(kn)),kn.reset()},result:function(){var dt=wn/2;return wn.reset(),dt}};function Dn(){Pn.point=Zn}function Zn(dt,Rt){Pn.point=Ai,qr=rn=dt,Qr=yn=Rt}function Ai(dt,Rt){kn.add(yn*dt-rn*Rt),rn=dt,yn=Rt}function Mi(){Ai(qr,Qr)}var En=1/0,Qn=En,Jn=-En,Di=Jn,va={point:function(dt,Rt){dt<En&&(En=dt),dt>Jn&&(Jn=dt),Rt<Qn&&(Qn=Rt),Rt>Di&&(Di=Rt)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var dt=[[En,Qn],[Jn,Di]];return Jn=Di=-(Qn=En=1/0),dt}},Ba,mo,Wi,Zi,to=0,Ni=0,go=0,bo=0,Ma=0,ro=0,_o=0,Co=0,Va=0,ya={point:Qa,lineStart:Cs,lineEnd:Ts,polygonStart:function(){ya.lineStart=ss,ya.lineEnd=Fs},polygonEnd:function(){ya.point=Qa,ya.lineStart=Cs,ya.lineEnd=Ts},result:function(){var dt=Va?[_o/Va,Co/Va]:ro?[bo/ro,Ma/ro]:go?[to/go,Ni/go]:[NaN,NaN];return to=Ni=go=bo=Ma=ro=_o=Co=Va=0,dt}};function Qa(dt,Rt){to+=dt,Ni+=Rt,++go}function Cs(){ya.point=Rs}function Rs(dt,Rt){ya.point=Xi,Qa(Wi=dt,Zi=Rt)}function Xi(dt,Rt){var cr=dt-Wi,Gt=Rt-Zi,ur=k(cr*cr+Gt*Gt);bo+=ur*(Wi+dt)/2,Ma+=ur*(Zi+Rt)/2,ro+=ur,Qa(Wi=dt,Zi=Rt)}function Ts(){ya.point=Qa}function ss(){ya.point=Bs}function Fs(){Ps(Ba,mo)}function Bs(dt,Rt){ya.point=Ps,Qa(Ba=Wi=dt,mo=Zi=Rt)}function Ps(dt,Rt){var cr=dt-Wi,Gt=Rt-Zi,ur=k(cr*cr+Gt*Gt);bo+=ur*(Wi+dt)/2,Ma+=ur*(Zi+Rt)/2,ro+=ur,_o+=(ur=Zi*dt-Wi*Rt)*(Wi+dt),Co+=ur*(Zi+Rt),Va+=3*ur,Qa(Wi=dt,Zi=Rt)}function Ns(dt){this._context=dt}Ns.prototype={_radius:4.5,pointRadius:function(dt){return this._radius=dt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(dt,Rt){switch(this._point){case 0:this._context.moveTo(dt,Rt),this._point=1;break;case 1:this._context.lineTo(dt,Rt);break;default:this._context.moveTo(dt+this._radius,Rt),this._context.arc(dt,Rt,this._radius,0,u)}},result:S};var Do,zo,Yo,Wo,Zo,ls=w(),wo={point:S,lineStart:function(){wo.point=ks},lineEnd:function(){Do&&vo(zo,Yo),wo.point=S},polygonStart:function(){Do=!0},polygonEnd:function(){Do=null},result:function(){var dt=+ls;return ls.reset(),dt}};function ks(dt,Rt){wo.point=vo,zo=Wo=dt,Yo=Zo=Rt}function vo(dt,Rt){Wo-=dt,Zo-=Rt,ls.add(k(Wo*Wo+Zo*Zo)),Wo=dt,Zo=Rt}function Xo(){this._string=[]}function Ms(dt){return"m0,"+dt+"a"+dt+","+dt+" 0 1,1 0,"+-2*dt+"a"+dt+","+dt+" 0 1,1 0,"+2*dt+"z"}function Ro(dt){return function(Rt){var cr=new Gi;for(var Gt in dt)cr[Gt]=dt[Gt];return cr.stream=Rt,cr}}function Gi(){}function Ue(dt,Rt,cr){var Gt=dt.clipExtent&&dt.clipExtent();return dt.scale(150).translate([0,0]),Gt!=null&&dt.clipExtent(null),Z(cr,dt.stream(va)),Rt(va.result()),Gt!=null&&dt.clipExtent(Gt),dt}function We(dt,Rt,cr){return Ue(dt,function(Gt){var ur=Rt[1][0]-Rt[0][0],Or=Rt[1][1]-Rt[0][1],Ur=Math.min(ur/(Gt[1][0]-Gt[0][0]),Or/(Gt[1][1]-Gt[0][1])),Xr=+Rt[0][0]+(ur-Ur*(Gt[1][0]+Gt[0][0]))/2,cn=+Rt[0][1]+(Or-Ur*(Gt[1][1]+Gt[0][1]))/2;dt.scale(150*Ur).translate([Xr,cn])},cr)}function rt(dt,Rt,cr){return We(dt,[[0,0],Rt],cr)}function ut(dt,Rt,cr){return Ue(dt,function(Gt){var ur=+Rt,Or=ur/(Gt[1][0]-Gt[0][0]),Ur=(ur-Or*(Gt[1][0]+Gt[0][0]))/2,Xr=-Or*Gt[0][1];dt.scale(150*Or).translate([Ur,Xr])},cr)}function yt(dt,Rt,cr){return Ue(dt,function(Gt){var ur=+Rt,Or=ur/(Gt[1][1]-Gt[0][1]),Ur=-Or*Gt[0][0],Xr=(ur-Or*(Gt[1][1]+Gt[0][1]))/2;dt.scale(150*Or).translate([Ur,Xr])},cr)}Xo.prototype={_radius:4.5,_circle:Ms(4.5),pointRadius:function(dt){return(dt=+dt)!==this._radius&&(this._radius=dt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(dt,Rt){switch(this._point){case 0:this._string.push("M",dt,",",Rt),this._point=1;break;case 1:this._string.push("L",dt,",",Rt);break;default:this._circle==null&&(this._circle=Ms(this._radius)),this._string.push("M",dt,",",Rt,this._circle)}},result:function(){if(this._string.length){var dt=this._string.join("");return this._string=[],dt}return null}},Gi.prototype={constructor:Gi,point:function(dt,Rt){this.stream.point(dt,Rt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var mt=c(30*h);function Lt(dt,Rt){return+Rt?function(cr,Gt){function ur(Or,Ur,Xr,cn,sn,gn,Mn,un,An,Bn,Hn,si,Kr,ni){var On=Mn-Or,Un=un-Ur,ri=On*On+Un*Un;if(ri>4*Gt&&Kr--){var ki=cn+Bn,Pi=sn+Hn,Ln=gn+si,Ri=k(ki*ki+Pi*Pi+Ln*Ln),Ci=I(Ln/=Ri),gi=l(l(Ln)-1)<n||l(Xr-An)<n?(Xr+An)/2:p(Pi,ki),Fi=cr(gi,Ci),Ei=Fi[0],ra=Fi[1],ii=Ei-Or,Ki=ra-Ur,qa=Un*ii-On*Ki;(qa*qa/ri>Gt||l((On*ii+Un*Ki)/ri-.5)>.3||cn*Bn+sn*Hn+gn*si<mt)&&(ur(Or,Ur,Xr,cn,sn,gn,Ei,ra,gi,ki/=Ri,Pi/=Ri,Ln,Kr,ni),ni.point(Ei,ra),ur(Ei,ra,gi,ki,Pi,Ln,Mn,un,An,Bn,Hn,si,Kr,ni))}}return function(Or){var Ur,Xr,cn,sn,gn,Mn,un,An,Bn,Hn,si,Kr,ni={point:On,lineStart:Un,lineEnd:ki,polygonStart:function(){Or.polygonStart(),ni.lineStart=Pi},polygonEnd:function(){Or.polygonEnd(),ni.lineStart=Un}};function On(Ci,gi){Ci=cr(Ci,gi),Or.point(Ci[0],Ci[1])}function Un(){An=NaN,ni.point=ri,Or.lineStart()}function ri(Ci,gi){var Fi=se([Ci,gi]),Ei=cr(Ci,gi);ur(An,Bn,un,Hn,si,Kr,An=Ei[0],Bn=Ei[1],un=Ci,Hn=Fi[0],si=Fi[1],Kr=Fi[2],16,Or),Or.point(An,Bn)}function ki(){ni.point=On,Or.lineEnd()}function Pi(){Un(),ni.point=Ln,ni.lineEnd=Ri}function Ln(Ci,gi){ri(Ur=Ci,gi),Xr=An,cn=Bn,sn=Hn,gn=si,Mn=Kr,ni.point=ri}function Ri(){ur(An,Bn,un,Hn,si,Kr,Xr,cn,Ur,sn,gn,Mn,16,Or),ni.lineEnd=ki,ki()}return ni}}(dt,Rt):function(cr){return Ro({point:function(Gt,ur){Gt=cr(Gt,ur),this.stream.point(Gt[0],Gt[1])}})}(dt)}var $t=Ro({point:function(dt,Rt){this.stream.point(dt*h,Rt*h)}});function er(dt,Rt,cr,Gt,ur){function Or(Ur,Xr){return[Rt+dt*(Ur*=Gt),cr-dt*(Xr*=ur)]}return Or.invert=function(Ur,Xr){return[(Ur-Rt)/dt*Gt,(cr-Xr)/dt*ur]},Or}function Zt(dt,Rt,cr,Gt,ur,Or){var Ur=c(Or),Xr=b(Or),cn=Ur*dt,sn=Xr*dt,gn=Ur/dt,Mn=Xr/dt,un=(Xr*cr-Ur*Rt)/dt,An=(Xr*Rt+Ur*cr)/dt;function Bn(Hn,si){return[cn*(Hn*=Gt)-sn*(si*=ur)+Rt,cr-sn*Hn-cn*si]}return Bn.invert=function(Hn,si){return[Gt*(gn*Hn-Mn*si+un),ur*(An-Mn*Hn-gn*si)]},Bn}function or(dt){return mr(function(){return dt})()}function mr(dt){var Rt,cr,Gt,ur,Or,Ur,Xr,cn,sn,gn,Mn=150,un=480,An=250,Bn=0,Hn=0,si=0,Kr=0,ni=0,On=0,Un=1,ri=1,ki=null,Pi=an,Ln=null,Ri=Gr,Ci=.5;function gi(ii){return cn(ii[0]*h,ii[1]*h)}function Fi(ii){return(ii=cn.invert(ii[0],ii[1]))&&[ii[0]*s,ii[1]*s]}function Ei(){var ii=Zt(Mn,0,0,Un,ri,On).apply(null,Rt(Bn,Hn)),Ki=(On?Zt:er)(Mn,un-ii[0],An-ii[1],Un,ri,On);return cr=Ut(si,Kr,ni),Xr=pt(Rt,Ki),cn=pt(cr,Xr),Ur=Lt(Xr,Ci),ra()}function ra(){return sn=gn=null,gi}return gi.stream=function(ii){return sn&&gn===ii?sn:sn=$t(function(Ki){return Ro({point:function(qa,es){var Uo=Ki(qa,es);return this.stream.point(Uo[0],Uo[1])}})}(cr)(Pi(Ur(Ri(gn=ii)))))},gi.preclip=function(ii){return arguments.length?(Pi=ii,ki=void 0,ra()):Pi},gi.postclip=function(ii){return arguments.length?(Ri=ii,Ln=Gt=ur=Or=null,ra()):Ri},gi.clipAngle=function(ii){return arguments.length?(Pi=+ii?xn(ki=ii*h):(ki=null,an),ra()):ki*s},gi.clipExtent=function(ii){return arguments.length?(Ri=ii==null?(Ln=Gt=ur=Or=null,Gr):_n(Ln=+ii[0][0],Gt=+ii[0][1],ur=+ii[1][0],Or=+ii[1][1]),ra()):Ln==null?null:[[Ln,Gt],[ur,Or]]},gi.scale=function(ii){return arguments.length?(Mn=+ii,Ei()):Mn},gi.translate=function(ii){return arguments.length?(un=+ii[0],An=+ii[1],Ei()):[un,An]},gi.center=function(ii){return arguments.length?(Bn=ii[0]%360*h,Hn=ii[1]%360*h,Ei()):[Bn*s,Hn*s]},gi.rotate=function(ii){return arguments.length?(si=ii[0]%360*h,Kr=ii[1]%360*h,ni=ii.length>2?ii[2]%360*h:0,Ei()):[si*s,Kr*s,ni*s]},gi.angle=function(ii){return arguments.length?(On=ii%360*h,Ei()):On*s},gi.reflectX=function(ii){return arguments.length?(Un=ii?-1:1,Ei()):Un<0},gi.reflectY=function(ii){return arguments.length?(ri=ii?-1:1,Ei()):ri<0},gi.precision=function(ii){return arguments.length?(Ur=Lt(Xr,Ci=ii*ii),ra()):k(Ci)},gi.fitExtent=function(ii,Ki){return We(gi,ii,Ki)},gi.fitSize=function(ii,Ki){return rt(gi,ii,Ki)},gi.fitWidth=function(ii,Ki){return ut(gi,ii,Ki)},gi.fitHeight=function(ii,Ki){return yt(gi,ii,Ki)},function(){return Rt=dt.apply(this,arguments),gi.invert=Rt.invert&&Fi,Ei()}}function wr(dt){var Rt=0,cr=a/3,Gt=mr(dt),ur=Gt(Rt,cr);return ur.parallels=function(Or){return arguments.length?Gt(Rt=Or[0]*h,cr=Or[1]*h):[Rt*s,cr*s]},ur}function Tr(dt,Rt){var cr=b(dt),Gt=(cr+b(Rt))/2;if(l(Gt)<n)return function(Xr){var cn=c(Xr);function sn(gn,Mn){return[gn*cn,b(Mn)/cn]}return sn.invert=function(gn,Mn){return[gn/cn,I(Mn*cn)]},sn}(dt);var ur=1+cr*(2*Gt-cr),Or=k(ur)/Gt;function Ur(Xr,cn){var sn=k(ur-2*Gt*b(cn))/Gt;return[sn*b(Xr*=Gt),Or-sn*c(Xr)]}return Ur.invert=function(Xr,cn){var sn=Or-cn,gn=p(Xr,l(sn))*T(sn);return sn*Gt<0&&(gn-=a*T(Xr)*T(sn)),[gn/Gt,I((ur-(Xr*Xr+sn*sn)*Gt*Gt)/(2*Gt))]},Ur}function Rr(){return wr(Tr).scale(155.424).center([0,33.6442])}function on(){return Rr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function mn(dt){return function(Rt,cr){var Gt=c(Rt),ur=c(cr),Or=dt(Gt*ur);return[Or*ur*b(Rt),Or*b(cr)]}}function In(dt){return function(Rt,cr){var Gt=k(Rt*Rt+cr*cr),ur=dt(Gt),Or=b(ur),Ur=c(ur);return[p(Rt*Or,Gt*Ur),I(Gt&&cr*Or/Gt)]}}var zn=mn(function(dt){return k(2/(1+dt))});zn.invert=In(function(dt){return 2*I(dt/2)});var qn=mn(function(dt){return(dt=A(dt))&&dt/b(dt)});function Rn(dt,Rt){return[dt,f(L((r+Rt)/2))]}function vi(dt){var Rt,cr,Gt,ur=or(dt),Or=ur.center,Ur=ur.scale,Xr=ur.translate,cn=ur.clipExtent,sn=null;function gn(){var Mn=a*Ur(),un=ur(Mr(ur.rotate()).invert([0,0]));return cn(sn==null?[[un[0]-Mn,un[1]-Mn],[un[0]+Mn,un[1]+Mn]]:dt===Rn?[[Math.max(un[0]-Mn,sn),Rt],[Math.min(un[0]+Mn,cr),Gt]]:[[sn,Math.max(un[1]-Mn,Rt)],[cr,Math.min(un[1]+Mn,Gt)]])}return ur.scale=function(Mn){return arguments.length?(Ur(Mn),gn()):Ur()},ur.translate=function(Mn){return arguments.length?(Xr(Mn),gn()):Xr()},ur.center=function(Mn){return arguments.length?(Or(Mn),gn()):Or()},ur.clipExtent=function(Mn){return arguments.length?(Mn==null?sn=Rt=cr=Gt=null:(sn=+Mn[0][0],Rt=+Mn[0][1],cr=+Mn[1][0],Gt=+Mn[1][1]),gn()):sn==null?null:[[sn,Rt],[cr,Gt]]},gn()}function Si(dt){return L((r+dt)/2)}function Ui(dt,Rt){var cr=c(dt),Gt=dt===Rt?b(dt):f(cr/c(Rt))/f(Si(Rt)/Si(dt)),ur=cr*_(Si(dt),Gt)/Gt;if(!Gt)return Rn;function Or(Ur,Xr){ur>0?Xr<-r+n&&(Xr=-r+n):Xr>r-n&&(Xr=r-n);var cn=ur/_(Si(Xr),Gt);return[cn*b(Gt*Ur),ur-cn*c(Gt*Ur)]}return Or.invert=function(Ur,Xr){var cn=ur-Xr,sn=T(Gt)*k(Ur*Ur+cn*cn),gn=p(Ur,l(cn))*T(cn);return cn*Gt<0&&(gn-=a*T(Ur)*T(cn)),[gn/Gt,2*o(_(ur/sn,1/Gt))-r]},Or}function ji(dt,Rt){return[dt,Rt]}function Vi(dt,Rt){var cr=c(dt),Gt=dt===Rt?b(dt):(cr-c(Rt))/(Rt-dt),ur=cr/Gt+dt;if(l(Gt)<n)return ji;function Or(Ur,Xr){var cn=ur-Xr,sn=Gt*Ur;return[cn*b(sn),ur-cn*c(sn)]}return Or.invert=function(Ur,Xr){var cn=ur-Xr,sn=p(Ur,l(cn))*T(cn);return cn*Gt<0&&(sn-=a*T(Ur)*T(cn)),[sn/Gt,ur-T(Gt)*k(Ur*Ur+cn*cn)]},Or}qn.invert=In(function(dt){return dt}),Rn.invert=function(dt,Rt){return[dt,2*o(x(Rt))-r]},ji.invert=ji;var Aa=1.340264,Ta=-.081106,ca=893e-6,ua=.003796,ka=k(3)/2;function Ha(dt,Rt){var cr=I(ka*b(Rt)),Gt=cr*cr,ur=Gt*Gt*Gt;return[dt*c(cr)/(ka*(Aa+3*Ta*Gt+ur*(7*ca+9*ua*Gt))),cr*(Aa+Ta*Gt+ur*(ca+ua*Gt))]}function no(dt,Rt){var cr=c(Rt),Gt=c(dt)*cr;return[cr*b(dt)/Gt,b(Rt)/Gt]}function io(dt,Rt){var cr=Rt*Rt,Gt=cr*cr;return[dt*(.8707-.131979*cr+Gt*(Gt*(.003971*cr-.001529*Gt)-.013791)),Rt*(1.007226+cr*(.015085+Gt*(.028874*cr-.044475-.005916*Gt)))]}function ao(dt,Rt){return[c(Rt)*b(dt),b(Rt)]}function oo(dt,Rt){var cr=c(Rt),Gt=1+c(dt)*cr;return[cr*b(dt)/Gt,b(Rt)/Gt]}function zi(dt,Rt){return[f(L((r+Rt)/2)),-dt]}Ha.invert=function(dt,Rt){for(var cr,Gt=Rt,ur=Gt*Gt,Or=ur*ur*ur,Ur=0;Ur<12&&(Or=(ur=(Gt-=cr=(Gt*(Aa+Ta*ur+Or*(ca+ua*ur))-Rt)/(Aa+3*Ta*ur+Or*(7*ca+9*ua*ur)))*Gt)*ur*ur,!(l(cr)<1e-12));++Ur);return[ka*dt*(Aa+3*Ta*ur+Or*(7*ca+9*ua*ur))/c(Gt),I(b(Gt)/ka)]},no.invert=In(o),io.invert=function(dt,Rt){var cr,Gt=Rt,ur=25;do{var Or=Gt*Gt,Ur=Or*Or;Gt-=cr=(Gt*(1.007226+Or*(.015085+Ur*(.028874*Or-.044475-.005916*Ur)))-Rt)/(1.007226+Or*(.045255+Ur*(.259866*Or-.311325-.005916*11*Ur)))}while(l(cr)>n&&--ur>0);return[dt/(.8707+(Or=Gt*Gt)*(Or*(Or*Or*Or*(.003971-.001529*Or)-.013791)-.131979)),Gt]},ao.invert=In(I),oo.invert=In(function(dt){return 2*o(dt)}),zi.invert=function(dt,Rt){return[-Rt,2*o(x(dt))-r]},d.geoAlbers=on,d.geoAlbersUsa=function(){var dt,Rt,cr,Gt,ur,Or,Ur=on(),Xr=Rr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),cn=Rr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),sn={point:function(un,An){Or=[un,An]}};function gn(un){var An=un[0],Bn=un[1];return Or=null,cr.point(An,Bn),Or||(Gt.point(An,Bn),Or)||(ur.point(An,Bn),Or)}function Mn(){return dt=Rt=null,gn}return gn.invert=function(un){var An=Ur.scale(),Bn=Ur.translate(),Hn=(un[0]-Bn[0])/An,si=(un[1]-Bn[1])/An;return(si>=.12&&si<.234&&Hn>=-.425&&Hn<-.214?Xr:si>=.166&&si<.234&&Hn>=-.214&&Hn<-.115?cn:Ur).invert(un)},gn.stream=function(un){return dt&&Rt===un?dt:(An=[Ur.stream(Rt=un),Xr.stream(un),cn.stream(un)],Bn=An.length,dt={point:function(Hn,si){for(var Kr=-1;++Kr<Bn;)An[Kr].point(Hn,si)},sphere:function(){for(var Hn=-1;++Hn<Bn;)An[Hn].sphere()},lineStart:function(){for(var Hn=-1;++Hn<Bn;)An[Hn].lineStart()},lineEnd:function(){for(var Hn=-1;++Hn<Bn;)An[Hn].lineEnd()},polygonStart:function(){for(var Hn=-1;++Hn<Bn;)An[Hn].polygonStart()},polygonEnd:function(){for(var Hn=-1;++Hn<Bn;)An[Hn].polygonEnd()}});var An,Bn},gn.precision=function(un){return arguments.length?(Ur.precision(un),Xr.precision(un),cn.precision(un),Mn()):Ur.precision()},gn.scale=function(un){return arguments.length?(Ur.scale(un),Xr.scale(.35*un),cn.scale(un),gn.translate(Ur.translate())):Ur.scale()},gn.translate=function(un){if(!arguments.length)return Ur.translate();var An=Ur.scale(),Bn=+un[0],Hn=+un[1];return cr=Ur.translate(un).clipExtent([[Bn-.455*An,Hn-.238*An],[Bn+.455*An,Hn+.238*An]]).stream(sn),Gt=Xr.translate([Bn-.307*An,Hn+.201*An]).clipExtent([[Bn-.425*An+n,Hn+.12*An+n],[Bn-.214*An-n,Hn+.234*An-n]]).stream(sn),ur=cn.translate([Bn-.205*An,Hn+.212*An]).clipExtent([[Bn-.214*An+n,Hn+.166*An+n],[Bn-.115*An-n,Hn+.234*An-n]]).stream(sn),Mn()},gn.fitExtent=function(un,An){return We(gn,un,An)},gn.fitSize=function(un,An){return rt(gn,un,An)},gn.fitWidth=function(un,An){return ut(gn,un,An)},gn.fitHeight=function(un,An){return yt(gn,un,An)},gn.scale(1070)},d.geoArea=function(dt){return U.reset(),Z(dt,te),2*U},d.geoAzimuthalEqualArea=function(){return or(zn).scale(124.75).clipAngle(179.999)},d.geoAzimuthalEqualAreaRaw=zn,d.geoAzimuthalEquidistant=function(){return or(qn).scale(79.4188).clipAngle(179.999)},d.geoAzimuthalEquidistantRaw=qn,d.geoBounds=function(dt){var Rt,cr,Gt,ur,Or,Ur,Xr;if(le=_e=-(fe=me=1/0),ze=[],Z(dt,Wt),cr=ze.length){for(ze.sort(Ke),Rt=1,Or=[Gt=ze[0]];Rt<cr;++Rt)Ge(Gt,(ur=ze[Rt])[0])||Ge(Gt,ur[1])?(Ve(Gt[0],ur[1])>Ve(Gt[0],Gt[1])&&(Gt[1]=ur[1]),Ve(ur[0],Gt[1])>Ve(Gt[0],Gt[1])&&(Gt[0]=ur[0])):Or.push(Gt=ur);for(Ur=-1/0,Rt=0,Gt=Or[cr=Or.length-1];Rt<=cr;Gt=ur,++Rt)ur=Or[Rt],(Xr=Ve(Gt[1],ur[0]))>Ur&&(Ur=Xr,fe=ur[0],_e=Gt[1])}return ze=Oe=null,fe===1/0||me===1/0?[[NaN,NaN],[NaN,NaN]]:[[fe,me],[_e,le]]},d.geoCentroid=function(dt){De=Xe=Be=Ie=Re=Ye=Qe=lt=xt=wt=bt=0,Z(dt,ct);var Rt=xt,cr=wt,Gt=bt,ur=Rt*Rt+cr*cr+Gt*Gt;return ur<1e-12&&(Rt=Ye,cr=Qe,Gt=lt,Xe<n&&(Rt=Be,cr=Ie,Gt=Re),(ur=Rt*Rt+cr*cr+Gt*Gt)<1e-12)?[NaN,NaN]:[p(cr,Rt)*s,I(Gt/k(ur))*s]},d.geoCircle=function(){var dt,Rt,cr=at([0,0]),Gt=at(90),ur=at(6),Or={point:function(Xr,cn){dt.push(Xr=Rt(Xr,cn)),Xr[0]*=s,Xr[1]*=s}};function Ur(){var Xr=cr.apply(this,arguments),cn=Gt.apply(this,arguments)*h,sn=ur.apply(this,arguments)*h;return dt=[],Rt=Ut(-Xr[0]*h,-Xr[1]*h,0).invert,hr(Or,cn,sn,1),Xr={type:"Polygon",coordinates:[dt]},dt=Rt=null,Xr}return Ur.center=function(Xr){return arguments.length?(cr=typeof Xr=="function"?Xr:at([+Xr[0],+Xr[1]]),Ur):cr},Ur.radius=function(Xr){return arguments.length?(Gt=typeof Xr=="function"?Xr:at(+Xr),Ur):Gt},Ur.precision=function(Xr){return arguments.length?(ur=typeof Xr=="function"?Xr:at(+Xr),Ur):ur},Ur},d.geoClipAntimeridian=an,d.geoClipCircle=xn,d.geoClipExtent=function(){var dt,Rt,cr,Gt=0,ur=0,Or=960,Ur=500;return cr={stream:function(Xr){return dt&&Rt===Xr?dt:dt=_n(Gt,ur,Or,Ur)(Rt=Xr)},extent:function(Xr){return arguments.length?(Gt=+Xr[0][0],ur=+Xr[0][1],Or=+Xr[1][0],Ur=+Xr[1][1],dt=Rt=null,cr):[[Gt,ur],[Or,Ur]]}}},d.geoClipRectangle=_n,d.geoConicConformal=function(){return wr(Ui).scale(109.5).parallels([30,30])},d.geoConicConformalRaw=Ui,d.geoConicEqualArea=Rr,d.geoConicEqualAreaRaw=Tr,d.geoConicEquidistant=function(){return wr(Vi).scale(131.154).center([0,13.9389])},d.geoConicEquidistantRaw=Vi,d.geoContains=function(dt,Rt){return(dt&&It.hasOwnProperty(dt.type)?It[dt.type]:dr)(dt,Rt)},d.geoDistance=vr,d.geoEqualEarth=function(){return or(Ha).scale(177.158)},d.geoEqualEarthRaw=Ha,d.geoEquirectangular=function(){return or(ji).scale(152.63)},d.geoEquirectangularRaw=ji,d.geoGnomonic=function(){return or(no).scale(144.049).clipAngle(60)},d.geoGnomonicRaw=no,d.geoGraticule=Cr,d.geoGraticule10=function(){return Cr()()},d.geoIdentity=function(){var dt,Rt,cr,Gt,ur,Or,Ur,Xr=1,cn=0,sn=0,gn=1,Mn=1,un=0,An=null,Bn=1,Hn=1,si=Ro({point:function(Un,ri){var ki=On([Un,ri]);this.stream.point(ki[0],ki[1])}}),Kr=Gr;function ni(){return Bn=Xr*gn,Hn=Xr*Mn,Or=Ur=null,On}function On(Un){var ri=Un[0]*Bn,ki=Un[1]*Hn;if(un){var Pi=ki*dt-ri*Rt;ri=ri*dt+ki*Rt,ki=Pi}return[ri+cn,ki+sn]}return On.invert=function(Un){var ri=Un[0]-cn,ki=Un[1]-sn;if(un){var Pi=ki*dt+ri*Rt;ri=ri*dt-ki*Rt,ki=Pi}return[ri/Bn,ki/Hn]},On.stream=function(Un){return Or&&Ur===Un?Or:Or=si(Kr(Ur=Un))},On.postclip=function(Un){return arguments.length?(Kr=Un,An=cr=Gt=ur=null,ni()):Kr},On.clipExtent=function(Un){return arguments.length?(Kr=Un==null?(An=cr=Gt=ur=null,Gr):_n(An=+Un[0][0],cr=+Un[0][1],Gt=+Un[1][0],ur=+Un[1][1]),ni()):An==null?null:[[An,cr],[Gt,ur]]},On.scale=function(Un){return arguments.length?(Xr=+Un,ni()):Xr},On.translate=function(Un){return arguments.length?(cn=+Un[0],sn=+Un[1],ni()):[cn,sn]},On.angle=function(Un){return arguments.length?(Rt=b(un=Un%360*h),dt=c(un),ni()):un*s},On.reflectX=function(Un){return arguments.length?(gn=Un?-1:1,ni()):gn<0},On.reflectY=function(Un){return arguments.length?(Mn=Un?-1:1,ni()):Mn<0},On.fitExtent=function(Un,ri){return We(On,Un,ri)},On.fitSize=function(Un,ri){return rt(On,Un,ri)},On.fitWidth=function(Un,ri){return ut(On,Un,ri)},On.fitHeight=function(Un,ri){return yt(On,Un,ri)},On},d.geoInterpolate=function(dt,Rt){var cr=dt[0]*h,Gt=dt[1]*h,ur=Rt[0]*h,Or=Rt[1]*h,Ur=c(Gt),Xr=b(Gt),cn=c(Or),sn=b(Or),gn=Ur*c(cr),Mn=Ur*b(cr),un=cn*c(ur),An=cn*b(ur),Bn=2*I(k(P(Or-Gt)+Ur*cn*P(ur-cr))),Hn=b(Bn),si=Bn?function(Kr){var ni=b(Kr*=Bn)/Hn,On=b(Bn-Kr)/Hn,Un=On*gn+ni*un,ri=On*Mn+ni*An,ki=On*Xr+ni*sn;return[p(ri,Un)*s,p(ki,k(Un*Un+ri*ri))*s]}:function(){return[cr*s,Gt*s]};return si.distance=Bn,si},d.geoLength=Cn,d.geoMercator=function(){return vi(Rn).scale(961/u)},d.geoMercatorRaw=Rn,d.geoNaturalEarth1=function(){return or(io).scale(175.295)},d.geoNaturalEarth1Raw=io,d.geoOrthographic=function(){return or(ao).scale(249.5).clipAngle(90+n)},d.geoOrthographicRaw=ao,d.geoPath=function(dt,Rt){var cr,Gt,ur=4.5;function Or(Ur){return Ur&&(typeof ur=="function"&&Gt.pointRadius(+ur.apply(this,arguments)),Z(Ur,cr(Gt))),Gt.result()}return Or.area=function(Ur){return Z(Ur,cr(Pn)),Pn.result()},Or.measure=function(Ur){return Z(Ur,cr(wo)),wo.result()},Or.bounds=function(Ur){return Z(Ur,cr(va)),va.result()},Or.centroid=function(Ur){return Z(Ur,cr(ya)),ya.result()},Or.projection=function(Ur){return arguments.length?(cr=Ur==null?(dt=null,Gr):(dt=Ur).stream,Or):dt},Or.context=function(Ur){return arguments.length?(Gt=Ur==null?(Rt=null,new Xo):new Ns(Rt=Ur),typeof ur!="function"&&Gt.pointRadius(ur),Or):Rt},Or.pointRadius=function(Ur){return arguments.length?(ur=typeof Ur=="function"?Ur:(Gt.pointRadius(+Ur),+Ur),Or):ur},Or.projection(dt).context(Rt)},d.geoProjection=or,d.geoProjectionMutator=mr,d.geoRotation=Mr,d.geoStereographic=function(){return or(oo).scale(250).clipAngle(142)},d.geoStereographicRaw=oo,d.geoStream=Z,d.geoTransform=function(dt){return{stream:Ro(dt)}},d.geoTransverseMercator=function(){var dt=vi(zi),Rt=dt.center,cr=dt.rotate;return dt.center=function(Gt){return arguments.length?Rt([-Gt[1],Gt[0]]):[(Gt=Rt())[1],-Gt[0]]},dt.rotate=function(Gt){return arguments.length?cr([Gt[0],Gt[1],Gt.length>2?Gt[2]+90:90]):[(Gt=cr())[0],Gt[1],Gt[2]-90]},cr([0,0,90]).scale(159.155)},d.geoTransverseMercatorRaw=zi,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){function v(oe,de){return oe.parent===de.parent?1:2}function w(oe,de){return oe+de.x}function y(oe,de){return Math.max(oe,de.y)}function e(oe){var de=0,ce=oe.children,ve=ce&&ce.length;if(ve)for(;--ve>=0;)de+=ce[ve].value;else de=1;oe.value=de}function t(oe,de){var ce,ve,Ae,fe,me,_e=new g(oe),le=+oe.value&&(_e.value=oe.value),ge=[_e];for(de==null&&(de=n);ce=ge.pop();)if(le&&(ce.value=+ce.data.value),(Ae=de(ce.data))&&(me=Ae.length))for(ce.children=new Array(me),fe=me-1;fe>=0;--fe)ge.push(ve=ce.children[fe]=new g(Ae[fe])),ve.parent=ce,ve.depth=ce.depth+1;return _e.eachBefore(r)}function n(oe){return oe.children}function a(oe){oe.data=oe.data.data}function r(oe){var de=0;do oe.height=de;while((oe=oe.parent)&&oe.height<++de)}function g(oe){this.data=oe,this.depth=this.height=0,this.parent=null}g.prototype=t.prototype={constructor:g,count:function(){return this.eachAfter(e)},each:function(oe){var de,ce,ve,Ae,fe=this,me=[fe];do for(de=me.reverse(),me=[];fe=de.pop();)if(oe(fe),ce=fe.children)for(ve=0,Ae=ce.length;ve<Ae;++ve)me.push(ce[ve]);while(me.length);return this},eachAfter:function(oe){for(var de,ce,ve,Ae=this,fe=[Ae],me=[];Ae=fe.pop();)if(me.push(Ae),de=Ae.children)for(ce=0,ve=de.length;ce<ve;++ce)fe.push(de[ce]);for(;Ae=me.pop();)oe(Ae);return this},eachBefore:function(oe){for(var de,ce,ve=this,Ae=[ve];ve=Ae.pop();)if(oe(ve),de=ve.children)for(ce=de.length-1;ce>=0;--ce)Ae.push(de[ce]);return this},sum:function(oe){return this.eachAfter(function(de){for(var ce=+oe(de.data)||0,ve=de.children,Ae=ve&&ve.length;--Ae>=0;)ce+=ve[Ae].value;de.value=ce})},sort:function(oe){return this.eachBefore(function(de){de.children&&de.children.sort(oe)})},path:function(oe){for(var de=this,ce=function(fe,me){if(fe===me)return fe;var _e=fe.ancestors(),le=me.ancestors(),ge=null;for(fe=_e.pop(),me=le.pop();fe===me;)ge=fe,fe=_e.pop(),me=le.pop();return ge}(de,oe),ve=[de];de!==ce;)de=de.parent,ve.push(de);for(var Ae=ve.length;oe!==ce;)ve.splice(Ae,0,oe),oe=oe.parent;return ve},ancestors:function(){for(var oe=this,de=[oe];oe=oe.parent;)de.push(oe);return de},descendants:function(){var oe=[];return this.each(function(de){oe.push(de)}),oe},leaves:function(){var oe=[];return this.eachBefore(function(de){de.children||oe.push(de)}),oe},links:function(){var oe=this,de=[];return oe.each(function(ce){ce!==oe&&de.push({source:ce.parent,target:ce})}),de},copy:function(){return t(this).eachBefore(a)}};var u=Array.prototype.slice;function s(oe){for(var de,ce,ve=0,Ae=(oe=function(me){for(var _e,le,ge=me.length;ge;)le=Math.random()*ge--|0,_e=me[ge],me[ge]=me[le],me[le]=_e;return me}(u.call(oe))).length,fe=[];ve<Ae;)de=oe[ve],ce&&o(ce,de)?++ve:(ce=c(fe=h(fe,de)),ve=0);return ce}function h(oe,de){var ce,ve;if(p(de,oe))return[de];for(ce=0;ce<oe.length;++ce)if(l(de,oe[ce])&&p(i(oe[ce],de),oe))return[oe[ce],de];for(ce=0;ce<oe.length-1;++ce)for(ve=ce+1;ve<oe.length;++ve)if(l(i(oe[ce],oe[ve]),de)&&l(i(oe[ce],de),oe[ve])&&l(i(oe[ve],de),oe[ce])&&p(x(oe[ce],oe[ve],de),oe))return[oe[ce],oe[ve],de];throw new Error}function l(oe,de){var ce=oe.r-de.r,ve=de.x-oe.x,Ae=de.y-oe.y;return ce<0||ce*ce<ve*ve+Ae*Ae}function o(oe,de){var ce=oe.r-de.r+1e-6,ve=de.x-oe.x,Ae=de.y-oe.y;return ce>0&&ce*ce>ve*ve+Ae*Ae}function p(oe,de){for(var ce=0;ce<de.length;++ce)if(!o(oe,de[ce]))return!1;return!0}function c(oe){switch(oe.length){case 1:return{x:(de=oe[0]).x,y:de.y,r:de.r};case 2:return i(oe[0],oe[1]);case 3:return x(oe[0],oe[1],oe[2])}var de}function i(oe,de){var ce=oe.x,ve=oe.y,Ae=oe.r,fe=de.x,me=de.y,_e=de.r,le=fe-ce,ge=me-ve,Te=_e-Ae,Se=Math.sqrt(le*le+ge*ge);return{x:(ce+fe+le/Se*Te)/2,y:(ve+me+ge/Se*Te)/2,r:(Se+Ae+_e)/2}}function x(oe,de,ce){var ve=oe.x,Ae=oe.y,fe=oe.r,me=de.x,_e=de.y,le=de.r,ge=ce.x,Te=ce.y,Se=ce.r,Me=ve-me,ze=ve-ge,Oe=Ae-_e,De=Ae-Te,Xe=le-fe,Be=Se-fe,Ie=ve*ve+Ae*Ae-fe*fe,Re=Ie-me*me-_e*_e+le*le,Ye=Ie-ge*ge-Te*Te+Se*Se,Qe=ze*Oe-Me*De,lt=(Oe*Ye-De*Re)/(2*Qe)-ve,xt=(De*Xe-Oe*Be)/Qe,wt=(ze*Re-Me*Ye)/(2*Qe)-Ae,bt=(Me*Be-ze*Xe)/Qe,nt=xt*xt+bt*bt-1,$e=2*(fe+lt*xt+wt*bt),vt=lt*lt+wt*wt-fe*fe,Nt=-(nt?($e+Math.sqrt($e*$e-4*nt*vt))/(2*nt):vt/$e);return{x:ve+lt+xt*Nt,y:Ae+wt+bt*Nt,r:Nt}}function f(oe,de,ce){var ve,Ae,fe,me,_e=oe.x-de.x,le=oe.y-de.y,ge=_e*_e+le*le;ge?(Ae=de.r+ce.r,Ae*=Ae,me=oe.r+ce.r,Ae>(me*=me)?(ve=(ge+me-Ae)/(2*ge),fe=Math.sqrt(Math.max(0,me/ge-ve*ve)),ce.x=oe.x-ve*_e-fe*le,ce.y=oe.y-ve*le+fe*_e):(ve=(ge+Ae-me)/(2*ge),fe=Math.sqrt(Math.max(0,Ae/ge-ve*ve)),ce.x=de.x+ve*_e-fe*le,ce.y=de.y+ve*le+fe*_e)):(ce.x=de.x+ce.r,ce.y=de.y)}function _(oe,de){var ce=oe.r+de.r-1e-6,ve=de.x-oe.x,Ae=de.y-oe.y;return ce>0&&ce*ce>ve*ve+Ae*Ae}function b(oe){var de=oe._,ce=oe.next._,ve=de.r+ce.r,Ae=(de.x*ce.r+ce.x*de.r)/ve,fe=(de.y*ce.r+ce.y*de.r)/ve;return Ae*Ae+fe*fe}function T(oe){this._=oe,this.next=null,this.previous=null}function k(oe){if(!(Ae=oe.length))return 0;var de,ce,ve,Ae,fe,me,_e,le,ge,Te,Se;if((de=oe[0]).x=0,de.y=0,!(Ae>1))return de.r;if(ce=oe[1],de.x=-ce.r,ce.x=de.r,ce.y=0,!(Ae>2))return de.r+ce.r;f(ce,de,ve=oe[2]),de=new T(de),ce=new T(ce),ve=new T(ve),de.next=ve.previous=ce,ce.next=de.previous=ve,ve.next=ce.previous=de;e:for(_e=3;_e<Ae;++_e){f(de._,ce._,ve=oe[_e]),ve=new T(ve),le=ce.next,ge=de.previous,Te=ce._.r,Se=de._.r;do if(Te<=Se){if(_(le._,ve._)){ce=le,de.next=ce,ce.previous=de,--_e;continue e}Te+=le._.r,le=le.next}else{if(_(ge._,ve._)){(de=ge).next=ce,ce.previous=de,--_e;continue e}Se+=ge._.r,ge=ge.previous}while(le!==ge.next);for(ve.previous=de,ve.next=ce,de.next=ce.previous=ce=ve,fe=b(de);(ve=ve.next)!==ce;)(me=b(ve))<fe&&(de=ve,fe=me);ce=de.next}for(de=[ce._],ve=ce;(ve=ve.next)!==ce;)de.push(ve._);for(ve=s(de),_e=0;_e<Ae;++_e)(de=oe[_e]).x-=ve.x,de.y-=ve.y;return ve.r}function L(oe){return oe==null?null:A(oe)}function A(oe){if(typeof oe!="function")throw new Error;return oe}function I(){return 0}function P(oe){return function(){return oe}}function S(oe){return Math.sqrt(oe.value)}function E(oe){return function(de){de.children||(de.r=Math.max(0,+oe(de)||0))}}function z(oe,de){return function(ce){if(ve=ce.children){var ve,Ae,fe,me=ve.length,_e=oe(ce)*de||0;if(_e)for(Ae=0;Ae<me;++Ae)ve[Ae].r+=_e;if(fe=k(ve),_e)for(Ae=0;Ae<me;++Ae)ve[Ae].r-=_e;ce.r=fe+_e}}}function D(oe){return function(de){var ce=de.parent;de.r*=oe,ce&&(de.x=ce.x+oe*de.x,de.y=ce.y+oe*de.y)}}function j(oe){oe.x0=Math.round(oe.x0),oe.y0=Math.round(oe.y0),oe.x1=Math.round(oe.x1),oe.y1=Math.round(oe.y1)}function V(oe,de,ce,ve,Ae){for(var fe,me=oe.children,_e=-1,le=me.length,ge=oe.value&&(ve-de)/oe.value;++_e<le;)(fe=me[_e]).y0=ce,fe.y1=Ae,fe.x0=de,fe.x1=de+=fe.value*ge}var Z={depth:-1},Q={};function K(oe){return oe.id}function $(oe){return oe.parentId}function ne(oe,de){return oe.parent===de.parent?1:2}function H(oe){var de=oe.children;return de?de[0]:oe.t}function N(oe){var de=oe.children;return de?de[de.length-1]:oe.t}function U(oe,de,ce){var ve=ce/(de.i-oe.i);de.c-=ve,de.s+=ce,oe.c+=ve,de.z+=ce,de.m+=ce}function te(oe,de,ce){return oe.a.parent===de.parent?oe.a:ce}function B(oe,de){this._=oe,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function X(oe,de,ce,ve,Ae){for(var fe,me=oe.children,_e=-1,le=me.length,ge=oe.value&&(Ae-ce)/oe.value;++_e<le;)(fe=me[_e]).x0=de,fe.x1=ve,fe.y0=ce,fe.y1=ce+=fe.value*ge}B.prototype=Object.create(g.prototype);var J=(1+Math.sqrt(5))/2;function ee(oe,de,ce,ve,Ae,fe){for(var me,_e,le,ge,Te,Se,Me,ze,Oe,De,Xe,Be=[],Ie=de.children,Re=0,Ye=0,Qe=Ie.length,lt=de.value;Re<Qe;){le=Ae-ce,ge=fe-ve;do Te=Ie[Ye++].value;while(!Te&&Ye<Qe);for(Se=Me=Te,Xe=Te*Te*(De=Math.max(ge/le,le/ge)/(lt*oe)),Oe=Math.max(Me/Xe,Xe/Se);Ye<Qe;++Ye){if(Te+=_e=Ie[Ye].value,_e<Se&&(Se=_e),_e>Me&&(Me=_e),Xe=Te*Te*De,(ze=Math.max(Me/Xe,Xe/Se))>Oe){Te-=_e;break}Oe=ze}Be.push(me={value:Te,dice:le<ge,children:Ie.slice(Re,Ye)}),me.dice?V(me,ce,ve,Ae,lt?ve+=ge*Te/lt:fe):X(me,ce,ve,lt?ce+=le*Te/lt:Ae,fe),lt-=Te,Re=Ye}return Be}var re=function oe(de){function ce(ve,Ae,fe,me,_e){ee(de,ve,Ae,fe,me,_e)}return ce.ratio=function(ve){return oe((ve=+ve)>1?ve:1)},ce}(J),se=function oe(de){function ce(ve,Ae,fe,me,_e){if((le=ve._squarify)&&le.ratio===de)for(var le,ge,Te,Se,Me,ze=-1,Oe=le.length,De=ve.value;++ze<Oe;){for(Te=(ge=le[ze]).children,Se=ge.value=0,Me=Te.length;Se<Me;++Se)ge.value+=Te[Se].value;ge.dice?V(ge,Ae,fe,me,fe+=(_e-fe)*ge.value/De):X(ge,Ae,fe,Ae+=(me-Ae)*ge.value/De,_e),De-=ge.value}else ve._squarify=le=ee(de,ve,Ae,fe,me,_e),le.ratio=de}return ce.ratio=function(ve){return oe((ve=+ve)>1?ve:1)},ce}(J);d.cluster=function(){var oe=v,de=1,ce=1,ve=!1;function Ae(fe){var me,_e=0;fe.eachAfter(function(Me){var ze=Me.children;ze?(Me.x=function(Oe){return Oe.reduce(w,0)/Oe.length}(ze),Me.y=function(Oe){return 1+Oe.reduce(y,0)}(ze)):(Me.x=me?_e+=oe(Me,me):0,Me.y=0,me=Me)});var le=function(Me){for(var ze;ze=Me.children;)Me=ze[0];return Me}(fe),ge=function(Me){for(var ze;ze=Me.children;)Me=ze[ze.length-1];return Me}(fe),Te=le.x-oe(le,ge)/2,Se=ge.x+oe(ge,le)/2;return fe.eachAfter(ve?function(Me){Me.x=(Me.x-fe.x)*de,Me.y=(fe.y-Me.y)*ce}:function(Me){Me.x=(Me.x-Te)/(Se-Te)*de,Me.y=(1-(fe.y?Me.y/fe.y:1))*ce})}return Ae.separation=function(fe){return arguments.length?(oe=fe,Ae):oe},Ae.size=function(fe){return arguments.length?(ve=!1,de=+fe[0],ce=+fe[1],Ae):ve?null:[de,ce]},Ae.nodeSize=function(fe){return arguments.length?(ve=!0,de=+fe[0],ce=+fe[1],Ae):ve?[de,ce]:null},Ae},d.hierarchy=t,d.pack=function(){var oe=null,de=1,ce=1,ve=I;function Ae(fe){return fe.x=de/2,fe.y=ce/2,oe?fe.eachBefore(E(oe)).eachAfter(z(ve,.5)).eachBefore(D(1)):fe.eachBefore(E(S)).eachAfter(z(I,1)).eachAfter(z(ve,fe.r/Math.min(de,ce))).eachBefore(D(Math.min(de,ce)/(2*fe.r))),fe}return Ae.radius=function(fe){return arguments.length?(oe=L(fe),Ae):oe},Ae.size=function(fe){return arguments.length?(de=+fe[0],ce=+fe[1],Ae):[de,ce]},Ae.padding=function(fe){return arguments.length?(ve=typeof fe=="function"?fe:P(+fe),Ae):ve},Ae},d.packEnclose=s,d.packSiblings=function(oe){return k(oe),oe},d.partition=function(){var oe=1,de=1,ce=0,ve=!1;function Ae(fe){var me=fe.height+1;return fe.x0=fe.y0=ce,fe.x1=oe,fe.y1=de/me,fe.eachBefore(function(_e,le){return function(ge){ge.children&&V(ge,ge.x0,_e*(ge.depth+1)/le,ge.x1,_e*(ge.depth+2)/le);var Te=ge.x0,Se=ge.y0,Me=ge.x1-ce,ze=ge.y1-ce;Me<Te&&(Te=Me=(Te+Me)/2),ze<Se&&(Se=ze=(Se+ze)/2),ge.x0=Te,ge.y0=Se,ge.x1=Me,ge.y1=ze}}(de,me)),ve&&fe.eachBefore(j),fe}return Ae.round=function(fe){return arguments.length?(ve=!!fe,Ae):ve},Ae.size=function(fe){return arguments.length?(oe=+fe[0],de=+fe[1],Ae):[oe,de]},Ae.padding=function(fe){return arguments.length?(ce=+fe,Ae):ce},Ae},d.stratify=function(){var oe=K,de=$;function ce(ve){var Ae,fe,me,_e,le,ge,Te,Se=ve.length,Me=new Array(Se),ze={};for(fe=0;fe<Se;++fe)Ae=ve[fe],le=Me[fe]=new g(Ae),(ge=oe(Ae,fe,ve))!=null&&(ge+="")&&(ze[Te="$"+(le.id=ge)]=Te in ze?Q:le);for(fe=0;fe<Se;++fe)if(le=Me[fe],(ge=de(ve[fe],fe,ve))!=null&&(ge+="")){if(!(_e=ze["$"+ge]))throw new Error("missing: "+ge);if(_e===Q)throw new Error("ambiguous: "+ge);_e.children?_e.children.push(le):_e.children=[le],le.parent=_e}else{if(me)throw new Error("multiple roots");me=le}if(!me)throw new Error("no root");if(me.parent=Z,me.eachBefore(function(Oe){Oe.depth=Oe.parent.depth+1,--Se}).eachBefore(r),me.parent=null,Se>0)throw new Error("cycle");return me}return ce.id=function(ve){return arguments.length?(oe=A(ve),ce):oe},ce.parentId=function(ve){return arguments.length?(de=A(ve),ce):de},ce},d.tree=function(){var oe=ne,de=1,ce=1,ve=null;function Ae(le){var ge=function(Be){for(var Ie,Re,Ye,Qe,lt,xt=new B(Be,0),wt=[xt];Ie=wt.pop();)if(Ye=Ie._.children)for(Ie.children=new Array(lt=Ye.length),Qe=lt-1;Qe>=0;--Qe)wt.push(Re=Ie.children[Qe]=new B(Ye[Qe],Qe)),Re.parent=Ie;return(xt.parent=new B(null,0)).children=[xt],xt}(le);if(ge.eachAfter(fe),ge.parent.m=-ge.z,ge.eachBefore(me),ve)le.eachBefore(_e);else{var Te=le,Se=le,Me=le;le.eachBefore(function(Be){Be.x<Te.x&&(Te=Be),Be.x>Se.x&&(Se=Be),Be.depth>Me.depth&&(Me=Be)});var ze=Te===Se?1:oe(Te,Se)/2,Oe=ze-Te.x,De=de/(Se.x+ze+Oe),Xe=ce/(Me.depth||1);le.eachBefore(function(Be){Be.x=(Be.x+Oe)*De,Be.y=Be.depth*Xe})}return le}function fe(le){var ge=le.children,Te=le.parent.children,Se=le.i?Te[le.i-1]:null;if(ge){(function(ze){for(var Oe,De=0,Xe=0,Be=ze.children,Ie=Be.length;--Ie>=0;)(Oe=Be[Ie]).z+=De,Oe.m+=De,De+=Oe.s+(Xe+=Oe.c)})(le);var Me=(ge[0].z+ge[ge.length-1].z)/2;Se?(le.z=Se.z+oe(le._,Se._),le.m=le.z-Me):le.z=Me}else Se&&(le.z=Se.z+oe(le._,Se._));le.parent.A=function(ze,Oe,De){if(Oe){for(var Xe,Be=ze,Ie=ze,Re=Oe,Ye=Be.parent.children[0],Qe=Be.m,lt=Ie.m,xt=Re.m,wt=Ye.m;Re=N(Re),Be=H(Be),Re&&Be;)Ye=H(Ye),(Ie=N(Ie)).a=ze,(Xe=Re.z+xt-Be.z-Qe+oe(Re._,Be._))>0&&(U(te(Re,ze,De),ze,Xe),Qe+=Xe,lt+=Xe),xt+=Re.m,Qe+=Be.m,wt+=Ye.m,lt+=Ie.m;Re&&!N(Ie)&&(Ie.t=Re,Ie.m+=xt-lt),Be&&!H(Ye)&&(Ye.t=Be,Ye.m+=Qe-wt,De=ze)}return De}(le,Se,le.parent.A||Te[0])}function me(le){le._.x=le.z+le.parent.m,le.m+=le.parent.m}function _e(le){le.x*=de,le.y=le.depth*ce}return Ae.separation=function(le){return arguments.length?(oe=le,Ae):oe},Ae.size=function(le){return arguments.length?(ve=!1,de=+le[0],ce=+le[1],Ae):ve?null:[de,ce]},Ae.nodeSize=function(le){return arguments.length?(ve=!0,de=+le[0],ce=+le[1],Ae):ve?[de,ce]:null},Ae},d.treemap=function(){var oe=re,de=!1,ce=1,ve=1,Ae=[0],fe=I,me=I,_e=I,le=I,ge=I;function Te(Me){return Me.x0=Me.y0=0,Me.x1=ce,Me.y1=ve,Me.eachBefore(Se),Ae=[0],de&&Me.eachBefore(j),Me}function Se(Me){var ze=Ae[Me.depth],Oe=Me.x0+ze,De=Me.y0+ze,Xe=Me.x1-ze,Be=Me.y1-ze;Xe<Oe&&(Oe=Xe=(Oe+Xe)/2),Be<De&&(De=Be=(De+Be)/2),Me.x0=Oe,Me.y0=De,Me.x1=Xe,Me.y1=Be,Me.children&&(ze=Ae[Me.depth+1]=fe(Me)/2,Oe+=ge(Me)-ze,De+=me(Me)-ze,(Xe-=_e(Me)-ze)<Oe&&(Oe=Xe=(Oe+Xe)/2),(Be-=le(Me)-ze)<De&&(De=Be=(De+Be)/2),oe(Me,Oe,De,Xe,Be))}return Te.round=function(Me){return arguments.length?(de=!!Me,Te):de},Te.size=function(Me){return arguments.length?(ce=+Me[0],ve=+Me[1],Te):[ce,ve]},Te.tile=function(Me){return arguments.length?(oe=A(Me),Te):oe},Te.padding=function(Me){return arguments.length?Te.paddingInner(Me).paddingOuter(Me):Te.paddingInner()},Te.paddingInner=function(Me){return arguments.length?(fe=typeof Me=="function"?Me:P(+Me),Te):fe},Te.paddingOuter=function(Me){return arguments.length?Te.paddingTop(Me).paddingRight(Me).paddingBottom(Me).paddingLeft(Me):Te.paddingTop()},Te.paddingTop=function(Me){return arguments.length?(me=typeof Me=="function"?Me:P(+Me),Te):me},Te.paddingRight=function(Me){return arguments.length?(_e=typeof Me=="function"?Me:P(+Me),Te):_e},Te.paddingBottom=function(Me){return arguments.length?(le=typeof Me=="function"?Me:P(+Me),Te):le},Te.paddingLeft=function(Me){return arguments.length?(ge=typeof Me=="function"?Me:P(+Me),Te):ge},Te},d.treemapBinary=function(oe,de,ce,ve,Ae){var fe,me,_e=oe.children,le=_e.length,ge=new Array(le+1);for(ge[0]=me=fe=0;fe<le;++fe)ge[fe+1]=me+=_e[fe].value;(function Te(Se,Me,ze,Oe,De,Xe,Be){if(Se>=Me-1){var Ie=_e[Se];return Ie.x0=Oe,Ie.y0=De,Ie.x1=Xe,void(Ie.y1=Be)}for(var Re=ge[Se],Ye=ze/2+Re,Qe=Se+1,lt=Me-1;Qe<lt;){var xt=Qe+lt>>>1;ge[xt]<Ye?Qe=xt+1:lt=xt}Ye-ge[Qe-1]<ge[Qe]-Ye&&Se+1<Qe&&--Qe;var wt=ge[Qe]-Re,bt=ze-wt;if(Xe-Oe>Be-De){var nt=(Oe*bt+Xe*wt)/ze;Te(Se,Qe,wt,Oe,De,nt,Be),Te(Qe,Me,bt,nt,De,Xe,Be)}else{var $e=(De*bt+Be*wt)/ze;Te(Se,Qe,wt,Oe,De,Xe,$e),Te(Qe,Me,bt,Oe,$e,Xe,Be)}})(0,le,oe.value,de,ce,ve,Ae)},d.treemapDice=V,d.treemapResquarify=se,d.treemapSlice=X,d.treemapSliceDice=function(oe,de,ce,ve,Ae){(1&oe.depth?X:V)(oe,de,ce,ve,Ae)},d.treemapSquarify=re,Object.defineProperty(d,"__esModule",{value:!0})})},{}],116:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-color")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(J,ee,re,se,oe){var de=J*J,ce=de*J;return((1-3*J+3*de-ce)*ee+(4-6*de+3*ce)*re+(1+3*J+3*de-3*ce)*se+ce*oe)/6}function y(J){var ee=J.length-1;return function(re){var se=re<=0?re=0:re>=1?(re=1,ee-1):Math.floor(re*ee),oe=J[se],de=J[se+1],ce=se>0?J[se-1]:2*oe-de,ve=se<ee-1?J[se+2]:2*de-oe;return w((re-se/ee)*ee,ce,oe,de,ve)}}function e(J){var ee=J.length;return function(re){var se=Math.floor(((re%=1)<0?++re:re)*ee),oe=J[(se+ee-1)%ee],de=J[se%ee],ce=J[(se+1)%ee],ve=J[(se+2)%ee];return w((re-se/ee)*ee,oe,de,ce,ve)}}function t(J){return function(){return J}}function n(J,ee){return function(re){return J+re*ee}}function a(J,ee){var re=ee-J;return re?n(J,re>180||re<-180?re-360*Math.round(re/360):re):t(isNaN(J)?ee:J)}function r(J){return(J=+J)==1?g:function(ee,re){return re-ee?function(se,oe,de){return se=Math.pow(se,de),oe=Math.pow(oe,de)-se,de=1/de,function(ce){return Math.pow(se+ce*oe,de)}}(ee,re,J):t(isNaN(ee)?re:ee)}}function g(J,ee){var re=ee-J;return re?n(J,re):t(isNaN(J)?ee:J)}var u=function J(ee){var re=r(ee);function se(oe,de){var ce=re((oe=v.rgb(oe)).r,(de=v.rgb(de)).r),ve=re(oe.g,de.g),Ae=re(oe.b,de.b),fe=g(oe.opacity,de.opacity);return function(me){return oe.r=ce(me),oe.g=ve(me),oe.b=Ae(me),oe.opacity=fe(me),oe+""}}return se.gamma=J,se}(1);function s(J){return function(ee){var re,se,oe=ee.length,de=new Array(oe),ce=new Array(oe),ve=new Array(oe);for(re=0;re<oe;++re)se=v.rgb(ee[re]),de[re]=se.r||0,ce[re]=se.g||0,ve[re]=se.b||0;return de=J(de),ce=J(ce),ve=J(ve),se.opacity=1,function(Ae){return se.r=de(Ae),se.g=ce(Ae),se.b=ve(Ae),se+""}}}var h=s(y),l=s(e);function o(J,ee){ee||(ee=[]);var re,se=J?Math.min(ee.length,J.length):0,oe=ee.slice();return function(de){for(re=0;re<se;++re)oe[re]=J[re]*(1-de)+ee[re]*de;return oe}}function p(J){return ArrayBuffer.isView(J)&&!(J instanceof DataView)}function c(J,ee){var re,se=ee?ee.length:0,oe=J?Math.min(se,J.length):0,de=new Array(oe),ce=new Array(se);for(re=0;re<oe;++re)de[re]=k(J[re],ee[re]);for(;re<se;++re)ce[re]=ee[re];return function(ve){for(re=0;re<oe;++re)ce[re]=de[re](ve);return ce}}function i(J,ee){var re=new Date;return J=+J,ee=+ee,function(se){return re.setTime(J*(1-se)+ee*se),re}}function x(J,ee){return J=+J,ee=+ee,function(re){return J*(1-re)+ee*re}}function f(J,ee){var re,se={},oe={};for(re in J!==null&&typeof J=="object"||(J={}),ee!==null&&typeof ee=="object"||(ee={}),ee)re in J?se[re]=k(J[re],ee[re]):oe[re]=ee[re];return function(de){for(re in se)oe[re]=se[re](de);return oe}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(_.source,"g");function T(J,ee){var re,se,oe,de=_.lastIndex=b.lastIndex=0,ce=-1,ve=[],Ae=[];for(J+="",ee+="";(re=_.exec(J))&&(se=b.exec(ee));)(oe=se.index)>de&&(oe=ee.slice(de,oe),ve[ce]?ve[ce]+=oe:ve[++ce]=oe),(re=re[0])===(se=se[0])?ve[ce]?ve[ce]+=se:ve[++ce]=se:(ve[++ce]=null,Ae.push({i:ce,x:x(re,se)})),de=b.lastIndex;return de<ee.length&&(oe=ee.slice(de),ve[ce]?ve[ce]+=oe:ve[++ce]=oe),ve.length<2?Ae[0]?function(fe){return function(me){return fe(me)+""}}(Ae[0].x):function(fe){return function(){return fe}}(ee):(ee=Ae.length,function(fe){for(var me,_e=0;_e<ee;++_e)ve[(me=Ae[_e]).i]=me.x(fe);return ve.join("")})}function k(J,ee){var re,se=typeof ee;return ee==null||se==="boolean"?t(ee):(se==="number"?x:se==="string"?(re=v.color(ee))?(ee=re,u):T:ee instanceof v.color?u:ee instanceof Date?i:p(ee)?o:Array.isArray(ee)?c:typeof ee.valueOf!="function"&&typeof ee.toString!="function"||isNaN(ee)?f:x)(J,ee)}var L,A,I,P,S=180/Math.PI,E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function z(J,ee,re,se,oe,de){var ce,ve,Ae;return(ce=Math.sqrt(J*J+ee*ee))&&(J/=ce,ee/=ce),(Ae=J*re+ee*se)&&(re-=J*Ae,se-=ee*Ae),(ve=Math.sqrt(re*re+se*se))&&(re/=ve,se/=ve,Ae/=ve),J*se<ee*re&&(J=-J,ee=-ee,Ae=-Ae,ce=-ce),{translateX:oe,translateY:de,rotate:Math.atan2(ee,J)*S,skewX:Math.atan(Ae)*S,scaleX:ce,scaleY:ve}}function D(J,ee,re,se){function oe(de){return de.length?de.pop()+" ":""}return function(de,ce){var ve=[],Ae=[];return de=J(de),ce=J(ce),function(fe,me,_e,le,ge,Te){if(fe!==_e||me!==le){var Se=ge.push("translate(",null,ee,null,re);Te.push({i:Se-4,x:x(fe,_e)},{i:Se-2,x:x(me,le)})}else(_e||le)&&ge.push("translate("+_e+ee+le+re)}(de.translateX,de.translateY,ce.translateX,ce.translateY,ve,Ae),function(fe,me,_e,le){fe!==me?(fe-me>180?me+=360:me-fe>180&&(fe+=360),le.push({i:_e.push(oe(_e)+"rotate(",null,se)-2,x:x(fe,me)})):me&&_e.push(oe(_e)+"rotate("+me+se)}(de.rotate,ce.rotate,ve,Ae),function(fe,me,_e,le){fe!==me?le.push({i:_e.push(oe(_e)+"skewX(",null,se)-2,x:x(fe,me)}):me&&_e.push(oe(_e)+"skewX("+me+se)}(de.skewX,ce.skewX,ve,Ae),function(fe,me,_e,le,ge,Te){if(fe!==_e||me!==le){var Se=ge.push(oe(ge)+"scale(",null,",",null,")");Te.push({i:Se-4,x:x(fe,_e)},{i:Se-2,x:x(me,le)})}else _e===1&&le===1||ge.push(oe(ge)+"scale("+_e+","+le+")")}(de.scaleX,de.scaleY,ce.scaleX,ce.scaleY,ve,Ae),de=ce=null,function(fe){for(var me,_e=-1,le=Ae.length;++_e<le;)ve[(me=Ae[_e]).i]=me.x(fe);return ve.join("")}}}var j=D(function(J){return J==="none"?E:(L||(L=document.createElement("DIV"),A=document.documentElement,I=document.defaultView),L.style.transform=J,J=I.getComputedStyle(A.appendChild(L),null).getPropertyValue("transform"),A.removeChild(L),z(+(J=J.slice(7,-1).split(","))[0],+J[1],+J[2],+J[3],+J[4],+J[5]))},"px, ","px)","deg)"),V=D(function(J){return J==null?E:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",J),(J=P.transform.baseVal.consolidate())?z((J=J.matrix).a,J.b,J.c,J.d,J.e,J.f):E)},", ",")",")"),Z=Math.SQRT2;function Q(J){return((J=Math.exp(J))+1/J)/2}function K(J){return function(ee,re){var se=J((ee=v.hsl(ee)).h,(re=v.hsl(re)).h),oe=g(ee.s,re.s),de=g(ee.l,re.l),ce=g(ee.opacity,re.opacity);return function(ve){return ee.h=se(ve),ee.s=oe(ve),ee.l=de(ve),ee.opacity=ce(ve),ee+""}}}var $=K(a),ne=K(g);function H(J){return function(ee,re){var se=J((ee=v.hcl(ee)).h,(re=v.hcl(re)).h),oe=g(ee.c,re.c),de=g(ee.l,re.l),ce=g(ee.opacity,re.opacity);return function(ve){return ee.h=se(ve),ee.c=oe(ve),ee.l=de(ve),ee.opacity=ce(ve),ee+""}}}var N=H(a),U=H(g);function te(J){return function ee(re){function se(oe,de){var ce=J((oe=v.cubehelix(oe)).h,(de=v.cubehelix(de)).h),ve=g(oe.s,de.s),Ae=g(oe.l,de.l),fe=g(oe.opacity,de.opacity);return function(me){return oe.h=ce(me),oe.s=ve(me),oe.l=Ae(Math.pow(me,re)),oe.opacity=fe(me),oe+""}}return re=+re,se.gamma=ee,se}(1)}var B=te(a),X=te(g);d.interpolate=k,d.interpolateArray=function(J,ee){return(p(ee)?o:c)(J,ee)},d.interpolateBasis=y,d.interpolateBasisClosed=e,d.interpolateCubehelix=B,d.interpolateCubehelixLong=X,d.interpolateDate=i,d.interpolateDiscrete=function(J){var ee=J.length;return function(re){return J[Math.max(0,Math.min(ee-1,Math.floor(re*ee)))]}},d.interpolateHcl=N,d.interpolateHclLong=U,d.interpolateHsl=$,d.interpolateHslLong=ne,d.interpolateHue=function(J,ee){var re=a(+J,+ee);return function(se){var oe=re(se);return oe-360*Math.floor(oe/360)}},d.interpolateLab=function(J,ee){var re=g((J=v.lab(J)).l,(ee=v.lab(ee)).l),se=g(J.a,ee.a),oe=g(J.b,ee.b),de=g(J.opacity,ee.opacity);return function(ce){return J.l=re(ce),J.a=se(ce),J.b=oe(ce),J.opacity=de(ce),J+""}},d.interpolateNumber=x,d.interpolateNumberArray=o,d.interpolateObject=f,d.interpolateRgb=u,d.interpolateRgbBasis=h,d.interpolateRgbBasisClosed=l,d.interpolateRound=function(J,ee){return J=+J,ee=+ee,function(re){return Math.round(J*(1-re)+ee*re)}},d.interpolateString=T,d.interpolateTransformCss=j,d.interpolateTransformSvg=V,d.interpolateZoom=function(J,ee){var re,se,oe=J[0],de=J[1],ce=J[2],ve=ee[0],Ae=ee[1],fe=ee[2],me=ve-oe,_e=Ae-de,le=me*me+_e*_e;if(le<1e-12)se=Math.log(fe/ce)/Z,re=function(Oe){return[oe+Oe*me,de+Oe*_e,ce*Math.exp(Z*Oe*se)]};else{var ge=Math.sqrt(le),Te=(fe*fe-ce*ce+4*le)/(2*ce*2*ge),Se=(fe*fe-ce*ce-4*le)/(2*fe*2*ge),Me=Math.log(Math.sqrt(Te*Te+1)-Te),ze=Math.log(Math.sqrt(Se*Se+1)-Se);se=(ze-Me)/Z,re=function(Oe){var De,Xe=Oe*se,Be=Q(Me),Ie=ce/(2*ge)*(Be*(De=Z*Xe+Me,((De=Math.exp(2*De))-1)/(De+1))-function(Re){return((Re=Math.exp(Re))-1/Re)/2}(Me));return[oe+Ie*me,de+Ie*_e,ce*Be/Q(Z*Xe+Me)]}}return re.duration=1e3*se,re},d.piecewise=function(J,ee){for(var re=0,se=ee.length-1,oe=ee[0],de=new Array(se<0?0:se);re<se;)de[re]=J(oe,oe=ee[++re]);return function(ce){var ve=Math.max(0,Math.min(se-1,Math.floor(ce*=se)));return de[ve](ce-ve)}},d.quantize=function(J,ee){for(var re=new Array(ee),se=0;se<ee;++se)re[se]=J(se/(ee-1));return re},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){var v=Math.PI,w=2*v,y=w-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function t(){return new e}e.prototype=t.prototype={constructor:e,moveTo:function(n,a){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+a)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,a){this._+="L"+(this._x1=+n)+","+(this._y1=+a)},quadraticCurveTo:function(n,a,r,g){this._+="Q"+ +n+","+ +a+","+(this._x1=+r)+","+(this._y1=+g)},bezierCurveTo:function(n,a,r,g,u,s){this._+="C"+ +n+","+ +a+","+ +r+","+ +g+","+(this._x1=+u)+","+(this._y1=+s)},arcTo:function(n,a,r,g,u){n=+n,a=+a,r=+r,g=+g,u=+u;var s=this._x1,h=this._y1,l=r-n,o=g-a,p=s-n,c=h-a,i=p*p+c*c;if(u<0)throw new Error("negative radius: "+u);if(this._x1===null)this._+="M"+(this._x1=n)+","+(this._y1=a);else if(i>1e-6)if(Math.abs(c*l-o*p)>1e-6&&u){var x=r-s,f=g-h,_=l*l+o*o,b=x*x+f*f,T=Math.sqrt(_),k=Math.sqrt(i),L=u*Math.tan((v-Math.acos((_+i-b)/(2*T*k)))/2),A=L/k,I=L/T;Math.abs(A-1)>1e-6&&(this._+="L"+(n+A*p)+","+(a+A*c)),this._+="A"+u+","+u+",0,0,"+ +(c*x>p*f)+","+(this._x1=n+I*l)+","+(this._y1=a+I*o)}else this._+="L"+(this._x1=n)+","+(this._y1=a)},arc:function(n,a,r,g,u,s){n=+n,a=+a,s=!!s;var h=(r=+r)*Math.cos(g),l=r*Math.sin(g),o=n+h,p=a+l,c=1^s,i=s?g-u:u-g;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+o+","+p:(Math.abs(this._x1-o)>1e-6||Math.abs(this._y1-p)>1e-6)&&(this._+="L"+o+","+p),r&&(i<0&&(i=i%w+w),i>y?this._+="A"+r+","+r+",0,1,"+c+","+(n-h)+","+(a-l)+"A"+r+","+r+",0,1,"+c+","+(this._x1=o)+","+(this._y1=p):i>1e-6&&(this._+="A"+r+","+r+",0,"+ +(i>=v)+","+c+","+(this._x1=n+r*Math.cos(u))+","+(this._y1=a+r*Math.sin(u))))},rect:function(n,a,r,g){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+a)+"h"+ +r+"v"+ +g+"h"+-r+"Z"},toString:function(){return this._}},d.path=t,Object.defineProperty(d,"__esModule",{value:!0})})},{}],118:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){function v(g,u,s,h){if(isNaN(u)||isNaN(s))return g;var l,o,p,c,i,x,f,_,b,T=g._root,k={data:h},L=g._x0,A=g._y0,I=g._x1,P=g._y1;if(!T)return g._root=k,g;for(;T.length;)if((x=u>=(o=(L+I)/2))?L=o:I=o,(f=s>=(p=(A+P)/2))?A=p:P=p,l=T,!(T=T[_=f<<1|x]))return l[_]=k,g;if(c=+g._x.call(null,T.data),i=+g._y.call(null,T.data),u===c&&s===i)return k.next=T,l?l[_]=k:g._root=k,g;do l=l?l[_]=new Array(4):g._root=new Array(4),(x=u>=(o=(L+I)/2))?L=o:I=o,(f=s>=(p=(A+P)/2))?A=p:P=p;while((_=f<<1|x)==(b=(i>=p)<<1|c>=o));return l[b]=T,l[_]=k,g}function w(g,u,s,h,l){this.node=g,this.x0=u,this.y0=s,this.x1=h,this.y1=l}function y(g){return g[0]}function e(g){return g[1]}function t(g,u,s){var h=new n(u==null?y:u,s==null?e:s,NaN,NaN,NaN,NaN);return g==null?h:h.addAll(g)}function n(g,u,s,h,l,o){this._x=g,this._y=u,this._x0=s,this._y0=h,this._x1=l,this._y1=o,this._root=void 0}function a(g){for(var u={data:g.data},s=u;g=g.next;)s=s.next={data:g.data};return u}var r=t.prototype=n.prototype;r.copy=function(){var g,u,s=new n(this._x,this._y,this._x0,this._y0,this._x1,this._y1),h=this._root;if(!h)return s;if(!h.length)return s._root=a(h),s;for(g=[{source:h,target:s._root=new Array(4)}];h=g.pop();)for(var l=0;l<4;++l)(u=h.source[l])&&(u.length?g.push({source:u,target:h.target[l]=new Array(4)}):h.target[l]=a(u));return s},r.add=function(g){var u=+this._x.call(null,g),s=+this._y.call(null,g);return v(this.cover(u,s),u,s,g)},r.addAll=function(g){var u,s,h,l,o=g.length,p=new Array(o),c=new Array(o),i=1/0,x=1/0,f=-1/0,_=-1/0;for(s=0;s<o;++s)isNaN(h=+this._x.call(null,u=g[s]))||isNaN(l=+this._y.call(null,u))||(p[s]=h,c[s]=l,h<i&&(i=h),h>f&&(f=h),l<x&&(x=l),l>_&&(_=l));if(i>f||x>_)return this;for(this.cover(i,x).cover(f,_),s=0;s<o;++s)v(this,p[s],c[s],g[s]);return this},r.cover=function(g,u){if(isNaN(g=+g)||isNaN(u=+u))return this;var s=this._x0,h=this._y0,l=this._x1,o=this._y1;if(isNaN(s))l=(s=Math.floor(g))+1,o=(h=Math.floor(u))+1;else{for(var p,c,i=l-s,x=this._root;s>g||g>=l||h>u||u>=o;)switch(c=(u<h)<<1|g<s,(p=new Array(4))[c]=x,x=p,i*=2,c){case 0:l=s+i,o=h+i;break;case 1:s=l-i,o=h+i;break;case 2:l=s+i,h=o-i;break;case 3:s=l-i,h=o-i}this._root&&this._root.length&&(this._root=x)}return this._x0=s,this._y0=h,this._x1=l,this._y1=o,this},r.data=function(){var g=[];return this.visit(function(u){if(!u.length)do g.push(u.data);while(u=u.next)}),g},r.extent=function(g){return arguments.length?this.cover(+g[0][0],+g[0][1]).cover(+g[1][0],+g[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},r.find=function(g,u,s){var h,l,o,p,c,i,x,f=this._x0,_=this._y0,b=this._x1,T=this._y1,k=[],L=this._root;for(L&&k.push(new w(L,f,_,b,T)),s==null?s=1/0:(f=g-s,_=u-s,b=g+s,T=u+s,s*=s);i=k.pop();)if(!(!(L=i.node)||(l=i.x0)>b||(o=i.y0)>T||(p=i.x1)<f||(c=i.y1)<_))if(L.length){var A=(l+p)/2,I=(o+c)/2;k.push(new w(L[3],A,I,p,c),new w(L[2],l,I,A,c),new w(L[1],A,o,p,I),new w(L[0],l,o,A,I)),(x=(u>=I)<<1|g>=A)&&(i=k[k.length-1],k[k.length-1]=k[k.length-1-x],k[k.length-1-x]=i)}else{var P=g-+this._x.call(null,L.data),S=u-+this._y.call(null,L.data),E=P*P+S*S;if(E<s){var z=Math.sqrt(s=E);f=g-z,_=u-z,b=g+z,T=u+z,h=L.data}}return h},r.remove=function(g){if(isNaN(o=+this._x.call(null,g))||isNaN(p=+this._y.call(null,g)))return this;var u,s,h,l,o,p,c,i,x,f,_,b,T=this._root,k=this._x0,L=this._y0,A=this._x1,I=this._y1;if(!T)return this;if(T.length)for(;;){if((x=o>=(c=(k+A)/2))?k=c:A=c,(f=p>=(i=(L+I)/2))?L=i:I=i,u=T,!(T=T[_=f<<1|x]))return this;if(!T.length)break;(u[_+1&3]||u[_+2&3]||u[_+3&3])&&(s=u,b=_)}for(;T.data!==g;)if(h=T,!(T=T.next))return this;return(l=T.next)&&delete T.next,h?(l?h.next=l:delete h.next,this):u?(l?u[_]=l:delete u[_],(T=u[0]||u[1]||u[2]||u[3])&&T===(u[3]||u[2]||u[1]||u[0])&&!T.length&&(s?s[b]=T:this._root=T),this):(this._root=l,this)},r.removeAll=function(g){for(var u=0,s=g.length;u<s;++u)this.remove(g[u]);return this},r.root=function(){return this._root},r.size=function(){var g=0;return this.visit(function(u){if(!u.length)do++g;while(u=u.next)}),g},r.visit=function(g){var u,s,h,l,o,p,c=[],i=this._root;for(i&&c.push(new w(i,this._x0,this._y0,this._x1,this._y1));u=c.pop();)if(!g(i=u.node,h=u.x0,l=u.y0,o=u.x1,p=u.y1)&&i.length){var x=(h+o)/2,f=(l+p)/2;(s=i[3])&&c.push(new w(s,x,f,o,p)),(s=i[2])&&c.push(new w(s,h,f,x,p)),(s=i[1])&&c.push(new w(s,x,l,o,f)),(s=i[0])&&c.push(new w(s,h,l,x,f))}return this},r.visitAfter=function(g){var u,s=[],h=[];for(this._root&&s.push(new w(this._root,this._x0,this._y0,this._x1,this._y1));u=s.pop();){var l=u.node;if(l.length){var o,p=u.x0,c=u.y0,i=u.x1,x=u.y1,f=(p+i)/2,_=(c+x)/2;(o=l[0])&&s.push(new w(o,p,c,f,_)),(o=l[1])&&s.push(new w(o,f,c,i,_)),(o=l[2])&&s.push(new w(o,p,_,f,x)),(o=l[3])&&s.push(new w(o,f,_,i,x))}h.push(u)}for(;u=h.pop();)g(u.node,u.x0,u.y0,u.x1,u.y1);return this},r.x=function(g){return arguments.length?(this._x=g,this):this._x},r.y=function(g){return arguments.length?(this._y=g,this):this._y},d.quadtree=t,Object.defineProperty(d,"__esModule",{value:!0})})},{}],119:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-path")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(Ee){return function(){return Ee}}var y=Math.abs,e=Math.atan2,t=Math.cos,n=Math.max,a=Math.min,r=Math.sin,g=Math.sqrt,u=Math.PI,s=u/2,h=2*u;function l(Ee){return Ee>1?0:Ee<-1?u:Math.acos(Ee)}function o(Ee){return Ee>=1?s:Ee<=-1?-s:Math.asin(Ee)}function p(Ee){return Ee.innerRadius}function c(Ee){return Ee.outerRadius}function i(Ee){return Ee.startAngle}function x(Ee){return Ee.endAngle}function f(Ee){return Ee&&Ee.padAngle}function _(Ee,Ze,at,pt,St,Ut,Kt,Ht){var pr=at-Ee,Mr=pt-Ze,hr=Kt-St,Qt=Ht-Ut,tr=Qt*pr-hr*Mr;if(!(tr*tr<1e-12))return[Ee+(tr=(hr*(Ze-Ut)-Qt*(Ee-St))/tr)*pr,Ze+tr*Mr]}function b(Ee,Ze,at,pt,St,Ut,Kt){var Ht=Ee-at,pr=Ze-pt,Mr=(Kt?Ut:-Ut)/g(Ht*Ht+pr*pr),hr=Mr*pr,Qt=-Mr*Ht,tr=Ee+hr,rr=Ze+Qt,fr=at+hr,yr=pt+Qt,Sr=(tr+fr)/2,Dr=(rr+yr)/2,Nr=fr-tr,Wr=yr-rr,hn=Nr*Nr+Wr*Wr,tn=St-Ut,Fn=tr*yr-fr*rr,an=(Wr<0?-1:1)*g(n(0,tn*tn*hn-Fn*Fn)),xn=(Fn*Wr-Nr*an)/hn,_n=(-Fn*Nr-Wr*an)/hn,ti=(Fn*Wr+Nr*an)/hn,jr=(-Fn*Nr+Wr*an)/hn,nn=xn-Sr,vn=_n-Dr,en=ti-Sr,fn=jr-Dr;return nn*nn+vn*vn>en*en+fn*fn&&(xn=ti,_n=jr),{cx:xn,cy:_n,x01:-hr,y01:-Qt,x11:xn*(St/tn-1),y11:_n*(St/tn-1)}}function T(Ee){this._context=Ee}function k(Ee){return new T(Ee)}function L(Ee){return Ee[0]}function A(Ee){return Ee[1]}function I(){var Ee=L,Ze=A,at=w(!0),pt=null,St=k,Ut=null;function Kt(Ht){var pr,Mr,hr,Qt=Ht.length,tr=!1;for(pt==null&&(Ut=St(hr=v.path())),pr=0;pr<=Qt;++pr)!(pr<Qt&&at(Mr=Ht[pr],pr,Ht))===tr&&((tr=!tr)?Ut.lineStart():Ut.lineEnd()),tr&&Ut.point(+Ee(Mr,pr,Ht),+Ze(Mr,pr,Ht));if(hr)return Ut=null,hr+""||null}return Kt.x=function(Ht){return arguments.length?(Ee=typeof Ht=="function"?Ht:w(+Ht),Kt):Ee},Kt.y=function(Ht){return arguments.length?(Ze=typeof Ht=="function"?Ht:w(+Ht),Kt):Ze},Kt.defined=function(Ht){return arguments.length?(at=typeof Ht=="function"?Ht:w(!!Ht),Kt):at},Kt.curve=function(Ht){return arguments.length?(St=Ht,pt!=null&&(Ut=St(pt)),Kt):St},Kt.context=function(Ht){return arguments.length?(Ht==null?pt=Ut=null:Ut=St(pt=Ht),Kt):pt},Kt}function P(){var Ee=L,Ze=null,at=w(0),pt=A,St=w(!0),Ut=null,Kt=k,Ht=null;function pr(hr){var Qt,tr,rr,fr,yr,Sr=hr.length,Dr=!1,Nr=new Array(Sr),Wr=new Array(Sr);for(Ut==null&&(Ht=Kt(yr=v.path())),Qt=0;Qt<=Sr;++Qt){if(!(Qt<Sr&&St(fr=hr[Qt],Qt,hr))===Dr)if(Dr=!Dr)tr=Qt,Ht.areaStart(),Ht.lineStart();else{for(Ht.lineEnd(),Ht.lineStart(),rr=Qt-1;rr>=tr;--rr)Ht.point(Nr[rr],Wr[rr]);Ht.lineEnd(),Ht.areaEnd()}Dr&&(Nr[Qt]=+Ee(fr,Qt,hr),Wr[Qt]=+at(fr,Qt,hr),Ht.point(Ze?+Ze(fr,Qt,hr):Nr[Qt],pt?+pt(fr,Qt,hr):Wr[Qt]))}if(yr)return Ht=null,yr+""||null}function Mr(){return I().defined(St).curve(Kt).context(Ut)}return pr.x=function(hr){return arguments.length?(Ee=typeof hr=="function"?hr:w(+hr),Ze=null,pr):Ee},pr.x0=function(hr){return arguments.length?(Ee=typeof hr=="function"?hr:w(+hr),pr):Ee},pr.x1=function(hr){return arguments.length?(Ze=hr==null?null:typeof hr=="function"?hr:w(+hr),pr):Ze},pr.y=function(hr){return arguments.length?(at=typeof hr=="function"?hr:w(+hr),pt=null,pr):at},pr.y0=function(hr){return arguments.length?(at=typeof hr=="function"?hr:w(+hr),pr):at},pr.y1=function(hr){return arguments.length?(pt=hr==null?null:typeof hr=="function"?hr:w(+hr),pr):pt},pr.lineX0=pr.lineY0=function(){return Mr().x(Ee).y(at)},pr.lineY1=function(){return Mr().x(Ee).y(pt)},pr.lineX1=function(){return Mr().x(Ze).y(at)},pr.defined=function(hr){return arguments.length?(St=typeof hr=="function"?hr:w(!!hr),pr):St},pr.curve=function(hr){return arguments.length?(Kt=hr,Ut!=null&&(Ht=Kt(Ut)),pr):Kt},pr.context=function(hr){return arguments.length?(hr==null?Ut=Ht=null:Ht=Kt(Ut=hr),pr):Ut},pr}function S(Ee,Ze){return Ze<Ee?-1:Ze>Ee?1:Ze>=Ee?0:NaN}function E(Ee){return Ee}T.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2;default:this._context.lineTo(Ee,Ze)}}};var z=j(k);function D(Ee){this._curve=Ee}function j(Ee){function Ze(at){return new D(Ee(at))}return Ze._curve=Ee,Ze}function V(Ee){var Ze=Ee.curve;return Ee.angle=Ee.x,delete Ee.x,Ee.radius=Ee.y,delete Ee.y,Ee.curve=function(at){return arguments.length?Ze(j(at)):Ze()._curve},Ee}function Z(){return V(I().curve(z))}function Q(){var Ee=P().curve(z),Ze=Ee.curve,at=Ee.lineX0,pt=Ee.lineX1,St=Ee.lineY0,Ut=Ee.lineY1;return Ee.angle=Ee.x,delete Ee.x,Ee.startAngle=Ee.x0,delete Ee.x0,Ee.endAngle=Ee.x1,delete Ee.x1,Ee.radius=Ee.y,delete Ee.y,Ee.innerRadius=Ee.y0,delete Ee.y0,Ee.outerRadius=Ee.y1,delete Ee.y1,Ee.lineStartAngle=function(){return V(at())},delete Ee.lineX0,Ee.lineEndAngle=function(){return V(pt())},delete Ee.lineX1,Ee.lineInnerRadius=function(){return V(St())},delete Ee.lineY0,Ee.lineOuterRadius=function(){return V(Ut())},delete Ee.lineY1,Ee.curve=function(Kt){return arguments.length?Ze(j(Kt)):Ze()._curve},Ee}function K(Ee,Ze){return[(Ze=+Ze)*Math.cos(Ee-=Math.PI/2),Ze*Math.sin(Ee)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ee,Ze){this._curve.point(Ze*Math.sin(Ee),Ze*-Math.cos(Ee))}};var $=Array.prototype.slice;function ne(Ee){return Ee.source}function H(Ee){return Ee.target}function N(Ee){var Ze=ne,at=H,pt=L,St=A,Ut=null;function Kt(){var Ht,pr=$.call(arguments),Mr=Ze.apply(this,pr),hr=at.apply(this,pr);if(Ut||(Ut=Ht=v.path()),Ee(Ut,+pt.apply(this,(pr[0]=Mr,pr)),+St.apply(this,pr),+pt.apply(this,(pr[0]=hr,pr)),+St.apply(this,pr)),Ht)return Ut=null,Ht+""||null}return Kt.source=function(Ht){return arguments.length?(Ze=Ht,Kt):Ze},Kt.target=function(Ht){return arguments.length?(at=Ht,Kt):at},Kt.x=function(Ht){return arguments.length?(pt=typeof Ht=="function"?Ht:w(+Ht),Kt):pt},Kt.y=function(Ht){return arguments.length?(St=typeof Ht=="function"?Ht:w(+Ht),Kt):St},Kt.context=function(Ht){return arguments.length?(Ut=Ht==null?null:Ht,Kt):Ut},Kt}function U(Ee,Ze,at,pt,St){Ee.moveTo(Ze,at),Ee.bezierCurveTo(Ze=(Ze+pt)/2,at,Ze,St,pt,St)}function te(Ee,Ze,at,pt,St){Ee.moveTo(Ze,at),Ee.bezierCurveTo(Ze,at=(at+St)/2,pt,at,pt,St)}function B(Ee,Ze,at,pt,St){var Ut=K(Ze,at),Kt=K(Ze,at=(at+St)/2),Ht=K(pt,at),pr=K(pt,St);Ee.moveTo(Ut[0],Ut[1]),Ee.bezierCurveTo(Kt[0],Kt[1],Ht[0],Ht[1],pr[0],pr[1])}var X={draw:function(Ee,Ze){var at=Math.sqrt(Ze/u);Ee.moveTo(at,0),Ee.arc(0,0,at,0,h)}},J={draw:function(Ee,Ze){var at=Math.sqrt(Ze/5)/2;Ee.moveTo(-3*at,-at),Ee.lineTo(-at,-at),Ee.lineTo(-at,-3*at),Ee.lineTo(at,-3*at),Ee.lineTo(at,-at),Ee.lineTo(3*at,-at),Ee.lineTo(3*at,at),Ee.lineTo(at,at),Ee.lineTo(at,3*at),Ee.lineTo(-at,3*at),Ee.lineTo(-at,at),Ee.lineTo(-3*at,at),Ee.closePath()}},ee=Math.sqrt(1/3),re=2*ee,se={draw:function(Ee,Ze){var at=Math.sqrt(Ze/re),pt=at*ee;Ee.moveTo(0,-at),Ee.lineTo(pt,0),Ee.lineTo(0,at),Ee.lineTo(-pt,0),Ee.closePath()}},oe=Math.sin(u/10)/Math.sin(7*u/10),de=Math.sin(h/10)*oe,ce=-Math.cos(h/10)*oe,ve={draw:function(Ee,Ze){var at=Math.sqrt(.8908130915292852*Ze),pt=de*at,St=ce*at;Ee.moveTo(0,-at),Ee.lineTo(pt,St);for(var Ut=1;Ut<5;++Ut){var Kt=h*Ut/5,Ht=Math.cos(Kt),pr=Math.sin(Kt);Ee.lineTo(pr*at,-Ht*at),Ee.lineTo(Ht*pt-pr*St,pr*pt+Ht*St)}Ee.closePath()}},Ae={draw:function(Ee,Ze){var at=Math.sqrt(Ze),pt=-at/2;Ee.rect(pt,pt,at,at)}},fe=Math.sqrt(3),me={draw:function(Ee,Ze){var at=-Math.sqrt(Ze/(3*fe));Ee.moveTo(0,2*at),Ee.lineTo(-fe*at,-at),Ee.lineTo(fe*at,-at),Ee.closePath()}},_e=-.5,le=Math.sqrt(3)/2,ge=1/Math.sqrt(12),Te=3*(ge/2+1),Se={draw:function(Ee,Ze){var at=Math.sqrt(Ze/Te),pt=at/2,St=at*ge,Ut=pt,Kt=at*ge+at,Ht=-Ut,pr=Kt;Ee.moveTo(pt,St),Ee.lineTo(Ut,Kt),Ee.lineTo(Ht,pr),Ee.lineTo(_e*pt-le*St,le*pt+_e*St),Ee.lineTo(_e*Ut-le*Kt,le*Ut+_e*Kt),Ee.lineTo(_e*Ht-le*pr,le*Ht+_e*pr),Ee.lineTo(_e*pt+le*St,_e*St-le*pt),Ee.lineTo(_e*Ut+le*Kt,_e*Kt-le*Ut),Ee.lineTo(_e*Ht+le*pr,_e*pr-le*Ht),Ee.closePath()}},Me=[X,J,se,Ae,ve,me,Se];function ze(){}function Oe(Ee,Ze,at){Ee._context.bezierCurveTo((2*Ee._x0+Ee._x1)/3,(2*Ee._y0+Ee._y1)/3,(Ee._x0+2*Ee._x1)/3,(Ee._y0+2*Ee._y1)/3,(Ee._x0+4*Ee._x1+Ze)/6,(Ee._y0+4*Ee._y1+at)/6)}function De(Ee){this._context=Ee}function Xe(Ee){this._context=Ee}function Be(Ee){this._context=Ee}function Ie(Ee,Ze){this._basis=new De(Ee),this._beta=Ze}De.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Oe(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Oe(this,Ee,Ze)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ze}},Xe.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._x2=Ee,this._y2=Ze;break;case 1:this._point=2,this._x3=Ee,this._y3=Ze;break;case 2:this._point=3,this._x4=Ee,this._y4=Ze,this._context.moveTo((this._x0+4*this._x1+Ee)/6,(this._y0+4*this._y1+Ze)/6);break;default:Oe(this,Ee,Ze)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ze}},Be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var at=(this._x0+4*this._x1+Ee)/6,pt=(this._y0+4*this._y1+Ze)/6;this._line?this._context.lineTo(at,pt):this._context.moveTo(at,pt);break;case 3:this._point=4;default:Oe(this,Ee,Ze)}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ze}},Ie.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ee=this._x,Ze=this._y,at=Ee.length-1;if(at>0)for(var pt,St=Ee[0],Ut=Ze[0],Kt=Ee[at]-St,Ht=Ze[at]-Ut,pr=-1;++pr<=at;)pt=pr/at,this._basis.point(this._beta*Ee[pr]+(1-this._beta)*(St+pt*Kt),this._beta*Ze[pr]+(1-this._beta)*(Ut+pt*Ht));this._x=this._y=null,this._basis.lineEnd()},point:function(Ee,Ze){this._x.push(+Ee),this._y.push(+Ze)}};var Re=function Ee(Ze){function at(pt){return Ze===1?new De(pt):new Ie(pt,Ze)}return at.beta=function(pt){return Ee(+pt)},at}(.85);function Ye(Ee,Ze,at){Ee._context.bezierCurveTo(Ee._x1+Ee._k*(Ee._x2-Ee._x0),Ee._y1+Ee._k*(Ee._y2-Ee._y0),Ee._x2+Ee._k*(Ee._x1-Ze),Ee._y2+Ee._k*(Ee._y1-at),Ee._x2,Ee._y2)}function Qe(Ee,Ze){this._context=Ee,this._k=(1-Ze)/6}Qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ye(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2,this._x1=Ee,this._y1=Ze;break;case 2:this._point=3;default:Ye(this,Ee,Ze)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var lt=function Ee(Ze){function at(pt){return new Qe(pt,Ze)}return at.tension=function(pt){return Ee(+pt)},at}(0);function xt(Ee,Ze){this._context=Ee,this._k=(1-Ze)/6}xt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._x3=Ee,this._y3=Ze;break;case 1:this._point=2,this._context.moveTo(this._x4=Ee,this._y4=Ze);break;case 2:this._point=3,this._x5=Ee,this._y5=Ze;break;default:Ye(this,Ee,Ze)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var wt=function Ee(Ze){function at(pt){return new xt(pt,Ze)}return at.tension=function(pt){return Ee(+pt)},at}(0);function bt(Ee,Ze){this._context=Ee,this._k=(1-Ze)/6}bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ye(this,Ee,Ze)}this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var nt=function Ee(Ze){function at(pt){return new bt(pt,Ze)}return at.tension=function(pt){return Ee(+pt)},at}(0);function $e(Ee,Ze,at){var pt=Ee._x1,St=Ee._y1,Ut=Ee._x2,Kt=Ee._y2;if(Ee._l01_a>1e-12){var Ht=2*Ee._l01_2a+3*Ee._l01_a*Ee._l12_a+Ee._l12_2a,pr=3*Ee._l01_a*(Ee._l01_a+Ee._l12_a);pt=(pt*Ht-Ee._x0*Ee._l12_2a+Ee._x2*Ee._l01_2a)/pr,St=(St*Ht-Ee._y0*Ee._l12_2a+Ee._y2*Ee._l01_2a)/pr}if(Ee._l23_a>1e-12){var Mr=2*Ee._l23_2a+3*Ee._l23_a*Ee._l12_a+Ee._l12_2a,hr=3*Ee._l23_a*(Ee._l23_a+Ee._l12_a);Ut=(Ut*Mr+Ee._x1*Ee._l23_2a-Ze*Ee._l12_2a)/hr,Kt=(Kt*Mr+Ee._y1*Ee._l23_2a-at*Ee._l12_2a)/hr}Ee._context.bezierCurveTo(pt,St,Ut,Kt,Ee._x2,Ee._y2)}function vt(Ee,Ze){this._context=Ee,this._alpha=Ze}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){if(Ee=+Ee,Ze=+Ze,this._point){var at=this._x2-Ee,pt=this._y2-Ze;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(at*at+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2;break;case 2:this._point=3;default:$e(this,Ee,Ze)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var Nt=function Ee(Ze){function at(pt){return Ze?new vt(pt,Ze):new Qe(pt,0)}return at.alpha=function(pt){return Ee(+pt)},at}(.5);function qt(Ee,Ze){this._context=Ee,this._alpha=Ze}qt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ee,Ze){if(Ee=+Ee,Ze=+Ze,this._point){var at=this._x2-Ee,pt=this._y2-Ze;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(at*at+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ee,this._y3=Ze;break;case 1:this._point=2,this._context.moveTo(this._x4=Ee,this._y4=Ze);break;case 2:this._point=3,this._x5=Ee,this._y5=Ze;break;default:$e(this,Ee,Ze)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var Jt=function Ee(Ze){function at(pt){return Ze?new qt(pt,Ze):new xt(pt,0)}return at.alpha=function(pt){return Ee(+pt)},at}(.5);function Wt(Ee,Ze){this._context=Ee,this._alpha=Ze}Wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){if(Ee=+Ee,Ze=+Ze,this._point){var at=this._x2-Ee,pt=this._y2-Ze;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(at*at+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$e(this,Ee,Ze)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ee,this._y0=this._y1,this._y1=this._y2,this._y2=Ze}};var ar=function Ee(Ze){function at(pt){return Ze?new Wt(pt,Ze):new bt(pt,0)}return at.alpha=function(pt){return Ee(+pt)},at}(.5);function Dt(Ee){this._context=Ee}function Ne(Ee){return Ee<0?-1:1}function qe(Ee,Ze,at){var pt=Ee._x1-Ee._x0,St=Ze-Ee._x1,Ut=(Ee._y1-Ee._y0)/(pt||St<0&&-0),Kt=(at-Ee._y1)/(St||pt<0&&-0),Ht=(Ut*St+Kt*pt)/(pt+St);return(Ne(Ut)+Ne(Kt))*Math.min(Math.abs(Ut),Math.abs(Kt),.5*Math.abs(Ht))||0}function pe(Ee,Ze){var at=Ee._x1-Ee._x0;return at?(3*(Ee._y1-Ee._y0)/at-Ze)/2:Ze}function be(Ee,Ze,at){var pt=Ee._x0,St=Ee._y0,Ut=Ee._x1,Kt=Ee._y1,Ht=(Ut-pt)/3;Ee._context.bezierCurveTo(pt+Ht,St+Ht*Ze,Ut-Ht,Kt-Ht*at,Ut,Kt)}function Fe(Ee){this._context=Ee}function Ve(Ee){this._context=new Ke(Ee)}function Ke(Ee){this._context=Ee}function Ge(Ee){this._context=Ee}function ct(Ee){var Ze,at,pt=Ee.length-1,St=new Array(pt),Ut=new Array(pt),Kt=new Array(pt);for(St[0]=0,Ut[0]=2,Kt[0]=Ee[0]+2*Ee[1],Ze=1;Ze<pt-1;++Ze)St[Ze]=1,Ut[Ze]=4,Kt[Ze]=4*Ee[Ze]+2*Ee[Ze+1];for(St[pt-1]=2,Ut[pt-1]=7,Kt[pt-1]=8*Ee[pt-1]+Ee[pt],Ze=1;Ze<pt;++Ze)at=St[Ze]/Ut[Ze-1],Ut[Ze]-=at,Kt[Ze]-=at*Kt[Ze-1];for(St[pt-1]=Kt[pt-1]/Ut[pt-1],Ze=pt-2;Ze>=0;--Ze)St[Ze]=(Kt[Ze]-St[Ze+1])/Ut[Ze];for(Ut[pt-1]=(Ee[pt]+St[pt-1])/2,Ze=0;Ze<pt-1;++Ze)Ut[Ze]=2*Ee[Ze+1]-St[Ze+1];return[St,Ut]}function st(Ee,Ze){this._context=Ee,this._t=Ze}function Mt(Ee,Ze){if((St=Ee.length)>1)for(var at,pt,St,Ut=1,Kt=Ee[Ze[0]],Ht=Kt.length;Ut<St;++Ut)for(pt=Kt,Kt=Ee[Ze[Ut]],at=0;at<Ht;++at)Kt[at][1]+=Kt[at][0]=isNaN(pt[at][1])?pt[at][0]:pt[at][1]}function Ot(Ee){for(var Ze=Ee.length,at=new Array(Ze);--Ze>=0;)at[Ze]=Ze;return at}function it(Ee,Ze){return Ee[Ze]}function ht(Ee){var Ze=Ee.map(jt);return Ot(Ee).sort(function(at,pt){return Ze[at]-Ze[pt]})}function jt(Ee){for(var Ze,at=-1,pt=0,St=Ee.length,Ut=-1/0;++at<St;)(Ze=+Ee[at][1])>Ut&&(Ut=Ze,pt=at);return pt}function kt(Ee){var Ze=Ee.map(Pt);return Ot(Ee).sort(function(at,pt){return Ze[at]-Ze[pt]})}function Pt(Ee){for(var Ze,at=0,pt=-1,St=Ee.length;++pt<St;)(Ze=+Ee[pt][1])&&(at+=Ze);return at}Dt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ee,Ze){Ee=+Ee,Ze=+Ze,this._point?this._context.lineTo(Ee,Ze):(this._point=1,this._context.moveTo(Ee,Ze))}},Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:be(this,this._t0,pe(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ee,Ze){var at=NaN;if(Ze=+Ze,(Ee=+Ee)!==this._x1||Ze!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2;break;case 2:this._point=3,be(this,pe(this,at=qe(this,Ee,Ze)),at);break;default:be(this,this._t0,at=qe(this,Ee,Ze))}this._x0=this._x1,this._x1=Ee,this._y0=this._y1,this._y1=Ze,this._t0=at}}},(Ve.prototype=Object.create(Fe.prototype)).point=function(Ee,Ze){Fe.prototype.point.call(this,Ze,Ee)},Ke.prototype={moveTo:function(Ee,Ze){this._context.moveTo(Ze,Ee)},closePath:function(){this._context.closePath()},lineTo:function(Ee,Ze){this._context.lineTo(Ze,Ee)},bezierCurveTo:function(Ee,Ze,at,pt,St,Ut){this._context.bezierCurveTo(Ze,Ee,pt,at,Ut,St)}},Ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ee=this._x,Ze=this._y,at=Ee.length;if(at)if(this._line?this._context.lineTo(Ee[0],Ze[0]):this._context.moveTo(Ee[0],Ze[0]),at===2)this._context.lineTo(Ee[1],Ze[1]);else for(var pt=ct(Ee),St=ct(Ze),Ut=0,Kt=1;Kt<at;++Ut,++Kt)this._context.bezierCurveTo(pt[0][Ut],St[0][Ut],pt[1][Ut],St[1][Ut],Ee[Kt],Ze[Kt]);(this._line||this._line!==0&&at===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ee,Ze){this._x.push(+Ee),this._y.push(+Ze)}},st.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ee,Ze){switch(Ee=+Ee,Ze=+Ze,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ee,Ze):this._context.moveTo(Ee,Ze);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Ze),this._context.lineTo(Ee,Ze);else{var at=this._x*(1-this._t)+Ee*this._t;this._context.lineTo(at,this._y),this._context.lineTo(at,Ze)}}this._x=Ee,this._y=Ze}},d.arc=function(){var Ee=p,Ze=c,at=w(0),pt=null,St=i,Ut=x,Kt=f,Ht=null;function pr(){var Mr,hr,Qt=+Ee.apply(this,arguments),tr=+Ze.apply(this,arguments),rr=St.apply(this,arguments)-s,fr=Ut.apply(this,arguments)-s,yr=y(fr-rr),Sr=fr>rr;if(Ht||(Ht=Mr=v.path()),tr<Qt&&(hr=tr,tr=Qt,Qt=hr),tr>1e-12)if(yr>h-1e-12)Ht.moveTo(tr*t(rr),tr*r(rr)),Ht.arc(0,0,tr,rr,fr,!Sr),Qt>1e-12&&(Ht.moveTo(Qt*t(fr),Qt*r(fr)),Ht.arc(0,0,Qt,fr,rr,Sr));else{var Dr,Nr,Wr=rr,hn=fr,tn=rr,Fn=fr,an=yr,xn=yr,_n=Kt.apply(this,arguments)/2,ti=_n>1e-12&&(pt?+pt.apply(this,arguments):g(Qt*Qt+tr*tr)),jr=a(y(tr-Qt)/2,+at.apply(this,arguments)),nn=jr,vn=jr;if(ti>1e-12){var en=o(ti/Qt*r(_n)),fn=o(ti/tr*r(_n));(an-=2*en)>1e-12?(tn+=en*=Sr?1:-1,Fn-=en):(an=0,tn=Fn=(rr+fr)/2),(xn-=2*fn)>1e-12?(Wr+=fn*=Sr?1:-1,hn-=fn):(xn=0,Wr=hn=(rr+fr)/2)}var Gn=tr*t(Wr),Tn=tr*r(Wr),Cn=Qt*t(Fn),oi=Qt*r(Fn);if(jr>1e-12){var nr,vr=tr*t(hn),It=tr*r(hn),lr=Qt*t(tn),dr=Qt*r(tn);if(yr<u&&(nr=_(Gn,Tn,lr,dr,vr,It,Cn,oi))){var Br=Gn-nr[0],Fr=Tn-nr[1],zr=vr-nr[0],Er=It-nr[1],xr=1/r(l((Br*zr+Fr*Er)/(g(Br*Br+Fr*Fr)*g(zr*zr+Er*Er)))/2),_r=g(nr[0]*nr[0]+nr[1]*nr[1]);nn=a(jr,(Qt-_r)/(xr-1)),vn=a(jr,(tr-_r)/(xr+1))}}xn>1e-12?vn>1e-12?(Dr=b(lr,dr,Gn,Tn,tr,vn,Sr),Nr=b(vr,It,Cn,oi,tr,vn,Sr),Ht.moveTo(Dr.cx+Dr.x01,Dr.cy+Dr.y01),vn<jr?Ht.arc(Dr.cx,Dr.cy,vn,e(Dr.y01,Dr.x01),e(Nr.y01,Nr.x01),!Sr):(Ht.arc(Dr.cx,Dr.cy,vn,e(Dr.y01,Dr.x01),e(Dr.y11,Dr.x11),!Sr),Ht.arc(0,0,tr,e(Dr.cy+Dr.y11,Dr.cx+Dr.x11),e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),!Sr),Ht.arc(Nr.cx,Nr.cy,vn,e(Nr.y11,Nr.x11),e(Nr.y01,Nr.x01),!Sr))):(Ht.moveTo(Gn,Tn),Ht.arc(0,0,tr,Wr,hn,!Sr)):Ht.moveTo(Gn,Tn),Qt>1e-12&&an>1e-12?nn>1e-12?(Dr=b(Cn,oi,vr,It,Qt,-nn,Sr),Nr=b(Gn,Tn,lr,dr,Qt,-nn,Sr),Ht.lineTo(Dr.cx+Dr.x01,Dr.cy+Dr.y01),nn<jr?Ht.arc(Dr.cx,Dr.cy,nn,e(Dr.y01,Dr.x01),e(Nr.y01,Nr.x01),!Sr):(Ht.arc(Dr.cx,Dr.cy,nn,e(Dr.y01,Dr.x01),e(Dr.y11,Dr.x11),!Sr),Ht.arc(0,0,Qt,e(Dr.cy+Dr.y11,Dr.cx+Dr.x11),e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),Sr),Ht.arc(Nr.cx,Nr.cy,nn,e(Nr.y11,Nr.x11),e(Nr.y01,Nr.x01),!Sr))):Ht.arc(0,0,Qt,Fn,tn,Sr):Ht.lineTo(Cn,oi)}else Ht.moveTo(0,0);if(Ht.closePath(),Mr)return Ht=null,Mr+""||null}return pr.centroid=function(){var Mr=(+Ee.apply(this,arguments)+ +Ze.apply(this,arguments))/2,hr=(+St.apply(this,arguments)+ +Ut.apply(this,arguments))/2-u/2;return[t(hr)*Mr,r(hr)*Mr]},pr.innerRadius=function(Mr){return arguments.length?(Ee=typeof Mr=="function"?Mr:w(+Mr),pr):Ee},pr.outerRadius=function(Mr){return arguments.length?(Ze=typeof Mr=="function"?Mr:w(+Mr),pr):Ze},pr.cornerRadius=function(Mr){return arguments.length?(at=typeof Mr=="function"?Mr:w(+Mr),pr):at},pr.padRadius=function(Mr){return arguments.length?(pt=Mr==null?null:typeof Mr=="function"?Mr:w(+Mr),pr):pt},pr.startAngle=function(Mr){return arguments.length?(St=typeof Mr=="function"?Mr:w(+Mr),pr):St},pr.endAngle=function(Mr){return arguments.length?(Ut=typeof Mr=="function"?Mr:w(+Mr),pr):Ut},pr.padAngle=function(Mr){return arguments.length?(Kt=typeof Mr=="function"?Mr:w(+Mr),pr):Kt},pr.context=function(Mr){return arguments.length?(Ht=Mr==null?null:Mr,pr):Ht},pr},d.area=P,d.areaRadial=Q,d.curveBasis=function(Ee){return new De(Ee)},d.curveBasisClosed=function(Ee){return new Xe(Ee)},d.curveBasisOpen=function(Ee){return new Be(Ee)},d.curveBundle=Re,d.curveCardinal=lt,d.curveCardinalClosed=wt,d.curveCardinalOpen=nt,d.curveCatmullRom=Nt,d.curveCatmullRomClosed=Jt,d.curveCatmullRomOpen=ar,d.curveLinear=k,d.curveLinearClosed=function(Ee){return new Dt(Ee)},d.curveMonotoneX=function(Ee){return new Fe(Ee)},d.curveMonotoneY=function(Ee){return new Ve(Ee)},d.curveNatural=function(Ee){return new Ge(Ee)},d.curveStep=function(Ee){return new st(Ee,.5)},d.curveStepAfter=function(Ee){return new st(Ee,1)},d.curveStepBefore=function(Ee){return new st(Ee,0)},d.line=I,d.lineRadial=Z,d.linkHorizontal=function(){return N(U)},d.linkRadial=function(){var Ee=N(B);return Ee.angle=Ee.x,delete Ee.x,Ee.radius=Ee.y,delete Ee.y,Ee},d.linkVertical=function(){return N(te)},d.pie=function(){var Ee=E,Ze=S,at=null,pt=w(0),St=w(h),Ut=w(0);function Kt(Ht){var pr,Mr,hr,Qt,tr,rr=Ht.length,fr=0,yr=new Array(rr),Sr=new Array(rr),Dr=+pt.apply(this,arguments),Nr=Math.min(h,Math.max(-h,St.apply(this,arguments)-Dr)),Wr=Math.min(Math.abs(Nr)/rr,Ut.apply(this,arguments)),hn=Wr*(Nr<0?-1:1);for(pr=0;pr<rr;++pr)(tr=Sr[yr[pr]=pr]=+Ee(Ht[pr],pr,Ht))>0&&(fr+=tr);for(Ze!=null?yr.sort(function(tn,Fn){return Ze(Sr[tn],Sr[Fn])}):at!=null&&yr.sort(function(tn,Fn){return at(Ht[tn],Ht[Fn])}),pr=0,hr=fr?(Nr-rr*hn)/fr:0;pr<rr;++pr,Dr=Qt)Mr=yr[pr],Qt=Dr+((tr=Sr[Mr])>0?tr*hr:0)+hn,Sr[Mr]={data:Ht[Mr],index:pr,value:tr,startAngle:Dr,endAngle:Qt,padAngle:Wr};return Sr}return Kt.value=function(Ht){return arguments.length?(Ee=typeof Ht=="function"?Ht:w(+Ht),Kt):Ee},Kt.sortValues=function(Ht){return arguments.length?(Ze=Ht,at=null,Kt):Ze},Kt.sort=function(Ht){return arguments.length?(at=Ht,Ze=null,Kt):at},Kt.startAngle=function(Ht){return arguments.length?(pt=typeof Ht=="function"?Ht:w(+Ht),Kt):pt},Kt.endAngle=function(Ht){return arguments.length?(St=typeof Ht=="function"?Ht:w(+Ht),Kt):St},Kt.padAngle=function(Ht){return arguments.length?(Ut=typeof Ht=="function"?Ht:w(+Ht),Kt):Ut},Kt},d.pointRadial=K,d.radialArea=Q,d.radialLine=Z,d.stack=function(){var Ee=w([]),Ze=Ot,at=Mt,pt=it;function St(Ut){var Kt,Ht,pr=Ee.apply(this,arguments),Mr=Ut.length,hr=pr.length,Qt=new Array(hr);for(Kt=0;Kt<hr;++Kt){for(var tr,rr=pr[Kt],fr=Qt[Kt]=new Array(Mr),yr=0;yr<Mr;++yr)fr[yr]=tr=[0,+pt(Ut[yr],rr,yr,Ut)],tr.data=Ut[yr];fr.key=rr}for(Kt=0,Ht=Ze(Qt);Kt<hr;++Kt)Qt[Ht[Kt]].index=Kt;return at(Qt,Ht),Qt}return St.keys=function(Ut){return arguments.length?(Ee=typeof Ut=="function"?Ut:w($.call(Ut)),St):Ee},St.value=function(Ut){return arguments.length?(pt=typeof Ut=="function"?Ut:w(+Ut),St):pt},St.order=function(Ut){return arguments.length?(Ze=Ut==null?Ot:typeof Ut=="function"?Ut:w($.call(Ut)),St):Ze},St.offset=function(Ut){return arguments.length?(at=Ut==null?Mt:Ut,St):at},St},d.stackOffsetDiverging=function(Ee,Ze){if((Ht=Ee.length)>0)for(var at,pt,St,Ut,Kt,Ht,pr=0,Mr=Ee[Ze[0]].length;pr<Mr;++pr)for(Ut=Kt=0,at=0;at<Ht;++at)(St=(pt=Ee[Ze[at]][pr])[1]-pt[0])>0?(pt[0]=Ut,pt[1]=Ut+=St):St<0?(pt[1]=Kt,pt[0]=Kt+=St):(pt[0]=0,pt[1]=St)},d.stackOffsetExpand=function(Ee,Ze){if((pt=Ee.length)>0){for(var at,pt,St,Ut=0,Kt=Ee[0].length;Ut<Kt;++Ut){for(St=at=0;at<pt;++at)St+=Ee[at][Ut][1]||0;if(St)for(at=0;at<pt;++at)Ee[at][Ut][1]/=St}Mt(Ee,Ze)}},d.stackOffsetNone=Mt,d.stackOffsetSilhouette=function(Ee,Ze){if((at=Ee.length)>0){for(var at,pt=0,St=Ee[Ze[0]],Ut=St.length;pt<Ut;++pt){for(var Kt=0,Ht=0;Kt<at;++Kt)Ht+=Ee[Kt][pt][1]||0;St[pt][1]+=St[pt][0]=-Ht/2}Mt(Ee,Ze)}},d.stackOffsetWiggle=function(Ee,Ze){if((St=Ee.length)>0&&(pt=(at=Ee[Ze[0]]).length)>0){for(var at,pt,St,Ut=0,Kt=1;Kt<pt;++Kt){for(var Ht=0,pr=0,Mr=0;Ht<St;++Ht){for(var hr=Ee[Ze[Ht]],Qt=hr[Kt][1]||0,tr=(Qt-(hr[Kt-1][1]||0))/2,rr=0;rr<Ht;++rr){var fr=Ee[Ze[rr]];tr+=(fr[Kt][1]||0)-(fr[Kt-1][1]||0)}pr+=Qt,Mr+=tr*Qt}at[Kt-1][1]+=at[Kt-1][0]=Ut,pr&&(Ut-=Mr/pr)}at[Kt-1][1]+=at[Kt-1][0]=Ut,Mt(Ee,Ze)}},d.stackOrderAppearance=ht,d.stackOrderAscending=kt,d.stackOrderDescending=function(Ee){return kt(Ee).reverse()},d.stackOrderInsideOut=function(Ee){var Ze,at,pt=Ee.length,St=Ee.map(Pt),Ut=ht(Ee),Kt=0,Ht=0,pr=[],Mr=[];for(Ze=0;Ze<pt;++Ze)at=Ut[Ze],Kt<Ht?(Kt+=St[at],pr.push(at)):(Ht+=St[at],Mr.push(at));return Mr.reverse().concat(pr)},d.stackOrderNone=Ot,d.stackOrderReverse=function(Ee){return Ot(Ee).reverse()},d.symbol=function(){var Ee=w(X),Ze=w(64),at=null;function pt(){var St;if(at||(at=St=v.path()),Ee.apply(this,arguments).draw(at,+Ze.apply(this,arguments)),St)return at=null,St+""||null}return pt.type=function(St){return arguments.length?(Ee=typeof St=="function"?St:w(St),pt):Ee},pt.size=function(St){return arguments.length?(Ze=typeof St=="function"?St:w(+St),pt):Ze},pt.context=function(St){return arguments.length?(at=St==null?null:St,pt):at},pt},d.symbolCircle=X,d.symbolCross=J,d.symbolDiamond=se,d.symbolSquare=Ae,d.symbolStar=ve,d.symbolTriangle=me,d.symbolWye=Se,d.symbols=Me,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?v(W,m("d3-time")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(nt){if(0<=nt.y&&nt.y<100){var $e=new Date(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L);return $e.setFullYear(nt.y),$e}return new Date(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L)}function y(nt){if(0<=nt.y&&nt.y<100){var $e=new Date(Date.UTC(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L));return $e.setUTCFullYear(nt.y),$e}return new Date(Date.UTC(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L))}function e(nt,$e,vt){return{y:nt,m:$e,d:vt,H:0,M:0,S:0,L:0}}function t(nt){var $e=nt.dateTime,vt=nt.date,Nt=nt.time,qt=nt.periods,Jt=nt.days,Wt=nt.shortDays,ar=nt.months,Dt=nt.shortMonths,Ne=l(qt),qe=o(qt),pe=l(Jt),be=o(Jt),Fe=l(Wt),Ve=o(Wt),Ke=l(ar),Ge=o(ar),ct=l(Dt),st=o(Dt),Mt={a:function(Pt){return Wt[Pt.getDay()]},A:function(Pt){return Jt[Pt.getDay()]},b:function(Pt){return Dt[Pt.getMonth()]},B:function(Pt){return ar[Pt.getMonth()]},c:null,d:Q,e:Q,f:N,H:K,I:$,j:ne,L:H,m:U,M:te,p:function(Pt){return qt[+(Pt.getHours()>=12)]},q:function(Pt){return 1+~~(Pt.getMonth()/3)},Q:Qe,s:lt,S:B,u:X,U:J,V:ee,w:re,W:se,x:null,X:null,y:oe,Y:de,Z:ce,"%":Ye},Ot={a:function(Pt){return Wt[Pt.getUTCDay()]},A:function(Pt){return Jt[Pt.getUTCDay()]},b:function(Pt){return Dt[Pt.getUTCMonth()]},B:function(Pt){return ar[Pt.getUTCMonth()]},c:null,d:ve,e:ve,f:le,H:Ae,I:fe,j:me,L:_e,m:ge,M:Te,p:function(Pt){return qt[+(Pt.getUTCHours()>=12)]},q:function(Pt){return 1+~~(Pt.getUTCMonth()/3)},Q:Qe,s:lt,S:Se,u:Me,U:ze,V:Oe,w:De,W:Xe,x:null,X:null,y:Be,Y:Ie,Z:Re,"%":Ye},it={a:function(Pt,Ee,Ze){var at=Fe.exec(Ee.slice(Ze));return at?(Pt.w=Ve[at[0].toLowerCase()],Ze+at[0].length):-1},A:function(Pt,Ee,Ze){var at=pe.exec(Ee.slice(Ze));return at?(Pt.w=be[at[0].toLowerCase()],Ze+at[0].length):-1},b:function(Pt,Ee,Ze){var at=ct.exec(Ee.slice(Ze));return at?(Pt.m=st[at[0].toLowerCase()],Ze+at[0].length):-1},B:function(Pt,Ee,Ze){var at=Ke.exec(Ee.slice(Ze));return at?(Pt.m=Ge[at[0].toLowerCase()],Ze+at[0].length):-1},c:function(Pt,Ee,Ze){return kt(Pt,$e,Ee,Ze)},d:A,e:A,f:D,H:P,I:P,j:I,L:z,m:L,M:S,p:function(Pt,Ee,Ze){var at=Ne.exec(Ee.slice(Ze));return at?(Pt.p=qe[at[0].toLowerCase()],Ze+at[0].length):-1},q:k,Q:V,s:Z,S:E,u:c,U:i,V:x,w:p,W:f,x:function(Pt,Ee,Ze){return kt(Pt,vt,Ee,Ze)},X:function(Pt,Ee,Ze){return kt(Pt,Nt,Ee,Ze)},y:b,Y:_,Z:T,"%":j};function ht(Pt,Ee){return function(Ze){var at,pt,St,Ut=[],Kt=-1,Ht=0,pr=Pt.length;for(Ze instanceof Date||(Ze=new Date(+Ze));++Kt<pr;)Pt.charCodeAt(Kt)===37&&(Ut.push(Pt.slice(Ht,Kt)),(pt=a[at=Pt.charAt(++Kt)])!=null?at=Pt.charAt(++Kt):pt=at==="e"?" ":"0",(St=Ee[at])&&(at=St(Ze,pt)),Ut.push(at),Ht=Kt+1);return Ut.push(Pt.slice(Ht,Kt)),Ut.join("")}}function jt(Pt,Ee){return function(Ze){var at,pt,St=e(1900,void 0,1);if(kt(St,Pt,Ze+="",0)!=Ze.length)return null;if("Q"in St)return new Date(St.Q);if("s"in St)return new Date(1e3*St.s+("L"in St?St.L:0));if(Ee&&!("Z"in St)&&(St.Z=0),"p"in St&&(St.H=St.H%12+12*St.p),St.m===void 0&&(St.m="q"in St?St.q:0),"V"in St){if(St.V<1||St.V>53)return null;"w"in St||(St.w=1),"Z"in St?(pt=(at=y(e(St.y,0,1))).getUTCDay(),at=pt>4||pt===0?v.utcMonday.ceil(at):v.utcMonday(at),at=v.utcDay.offset(at,7*(St.V-1)),St.y=at.getUTCFullYear(),St.m=at.getUTCMonth(),St.d=at.getUTCDate()+(St.w+6)%7):(pt=(at=w(e(St.y,0,1))).getDay(),at=pt>4||pt===0?v.timeMonday.ceil(at):v.timeMonday(at),at=v.timeDay.offset(at,7*(St.V-1)),St.y=at.getFullYear(),St.m=at.getMonth(),St.d=at.getDate()+(St.w+6)%7)}else("W"in St||"U"in St)&&("w"in St||(St.w="u"in St?St.u%7:"W"in St?1:0),pt="Z"in St?y(e(St.y,0,1)).getUTCDay():w(e(St.y,0,1)).getDay(),St.m=0,St.d="W"in St?(St.w+6)%7+7*St.W-(pt+5)%7:St.w+7*St.U-(pt+6)%7);return"Z"in St?(St.H+=St.Z/100|0,St.M+=St.Z%100,y(St)):w(St)}}function kt(Pt,Ee,Ze,at){for(var pt,St,Ut=0,Kt=Ee.length,Ht=Ze.length;Ut<Kt;){if(at>=Ht)return-1;if((pt=Ee.charCodeAt(Ut++))===37){if(pt=Ee.charAt(Ut++),!(St=it[pt in a?Ee.charAt(Ut++):pt])||(at=St(Pt,Ze,at))<0)return-1}else if(pt!=Ze.charCodeAt(at++))return-1}return at}return Mt.x=ht(vt,Mt),Mt.X=ht(Nt,Mt),Mt.c=ht($e,Mt),Ot.x=ht(vt,Ot),Ot.X=ht(Nt,Ot),Ot.c=ht($e,Ot),{format:function(Pt){var Ee=ht(Pt+="",Mt);return Ee.toString=function(){return Pt},Ee},parse:function(Pt){var Ee=jt(Pt+="",!1);return Ee.toString=function(){return Pt},Ee},utcFormat:function(Pt){var Ee=ht(Pt+="",Ot);return Ee.toString=function(){return Pt},Ee},utcParse:function(Pt){var Ee=jt(Pt+="",!0);return Ee.toString=function(){return Pt},Ee}}}var n,a={"-":"",_:" ",0:"0"},r=/^\s*\d+/,g=/^%/,u=/[\\^$*+?|[\]().{}]/g;function s(nt,$e,vt){var Nt=nt<0?"-":"",qt=(Nt?-nt:nt)+"",Jt=qt.length;return Nt+(Jt<vt?new Array(vt-Jt+1).join($e)+qt:qt)}function h(nt){return nt.replace(u,"\\$&")}function l(nt){return new RegExp("^(?:"+nt.map(h).join("|")+")","i")}function o(nt){for(var $e={},vt=-1,Nt=nt.length;++vt<Nt;)$e[nt[vt].toLowerCase()]=vt;return $e}function p(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+1));return Nt?(nt.w=+Nt[0],vt+Nt[0].length):-1}function c(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+1));return Nt?(nt.u=+Nt[0],vt+Nt[0].length):-1}function i(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.U=+Nt[0],vt+Nt[0].length):-1}function x(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.V=+Nt[0],vt+Nt[0].length):-1}function f(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.W=+Nt[0],vt+Nt[0].length):-1}function _(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+4));return Nt?(nt.y=+Nt[0],vt+Nt[0].length):-1}function b(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.y=+Nt[0]+(+Nt[0]>68?1900:2e3),vt+Nt[0].length):-1}function T(nt,$e,vt){var Nt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec($e.slice(vt,vt+6));return Nt?(nt.Z=Nt[1]?0:-(Nt[2]+(Nt[3]||"00")),vt+Nt[0].length):-1}function k(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+1));return Nt?(nt.q=3*Nt[0]-3,vt+Nt[0].length):-1}function L(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.m=Nt[0]-1,vt+Nt[0].length):-1}function A(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.d=+Nt[0],vt+Nt[0].length):-1}function I(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+3));return Nt?(nt.m=0,nt.d=+Nt[0],vt+Nt[0].length):-1}function P(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.H=+Nt[0],vt+Nt[0].length):-1}function S(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.M=+Nt[0],vt+Nt[0].length):-1}function E(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+2));return Nt?(nt.S=+Nt[0],vt+Nt[0].length):-1}function z(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+3));return Nt?(nt.L=+Nt[0],vt+Nt[0].length):-1}function D(nt,$e,vt){var Nt=r.exec($e.slice(vt,vt+6));return Nt?(nt.L=Math.floor(Nt[0]/1e3),vt+Nt[0].length):-1}function j(nt,$e,vt){var Nt=g.exec($e.slice(vt,vt+1));return Nt?vt+Nt[0].length:-1}function V(nt,$e,vt){var Nt=r.exec($e.slice(vt));return Nt?(nt.Q=+Nt[0],vt+Nt[0].length):-1}function Z(nt,$e,vt){var Nt=r.exec($e.slice(vt));return Nt?(nt.s=+Nt[0],vt+Nt[0].length):-1}function Q(nt,$e){return s(nt.getDate(),$e,2)}function K(nt,$e){return s(nt.getHours(),$e,2)}function $(nt,$e){return s(nt.getHours()%12||12,$e,2)}function ne(nt,$e){return s(1+v.timeDay.count(v.timeYear(nt),nt),$e,3)}function H(nt,$e){return s(nt.getMilliseconds(),$e,3)}function N(nt,$e){return H(nt,$e)+"000"}function U(nt,$e){return s(nt.getMonth()+1,$e,2)}function te(nt,$e){return s(nt.getMinutes(),$e,2)}function B(nt,$e){return s(nt.getSeconds(),$e,2)}function X(nt){var $e=nt.getDay();return $e===0?7:$e}function J(nt,$e){return s(v.timeSunday.count(v.timeYear(nt)-1,nt),$e,2)}function ee(nt,$e){var vt=nt.getDay();return nt=vt>=4||vt===0?v.timeThursday(nt):v.timeThursday.ceil(nt),s(v.timeThursday.count(v.timeYear(nt),nt)+(v.timeYear(nt).getDay()===4),$e,2)}function re(nt){return nt.getDay()}function se(nt,$e){return s(v.timeMonday.count(v.timeYear(nt)-1,nt),$e,2)}function oe(nt,$e){return s(nt.getFullYear()%100,$e,2)}function de(nt,$e){return s(nt.getFullYear()%1e4,$e,4)}function ce(nt){var $e=nt.getTimezoneOffset();return($e>0?"-":($e*=-1,"+"))+s($e/60|0,"0",2)+s($e%60,"0",2)}function ve(nt,$e){return s(nt.getUTCDate(),$e,2)}function Ae(nt,$e){return s(nt.getUTCHours(),$e,2)}function fe(nt,$e){return s(nt.getUTCHours()%12||12,$e,2)}function me(nt,$e){return s(1+v.utcDay.count(v.utcYear(nt),nt),$e,3)}function _e(nt,$e){return s(nt.getUTCMilliseconds(),$e,3)}function le(nt,$e){return _e(nt,$e)+"000"}function ge(nt,$e){return s(nt.getUTCMonth()+1,$e,2)}function Te(nt,$e){return s(nt.getUTCMinutes(),$e,2)}function Se(nt,$e){return s(nt.getUTCSeconds(),$e,2)}function Me(nt){var $e=nt.getUTCDay();return $e===0?7:$e}function ze(nt,$e){return s(v.utcSunday.count(v.utcYear(nt)-1,nt),$e,2)}function Oe(nt,$e){var vt=nt.getUTCDay();return nt=vt>=4||vt===0?v.utcThursday(nt):v.utcThursday.ceil(nt),s(v.utcThursday.count(v.utcYear(nt),nt)+(v.utcYear(nt).getUTCDay()===4),$e,2)}function De(nt){return nt.getUTCDay()}function Xe(nt,$e){return s(v.utcMonday.count(v.utcYear(nt)-1,nt),$e,2)}function Be(nt,$e){return s(nt.getUTCFullYear()%100,$e,2)}function Ie(nt,$e){return s(nt.getUTCFullYear()%1e4,$e,4)}function Re(){return"+0000"}function Ye(){return"%"}function Qe(nt){return+nt}function lt(nt){return Math.floor(+nt/1e3)}function xt(nt){return n=t(nt),d.timeFormat=n.format,d.timeParse=n.parse,d.utcFormat=n.utcFormat,d.utcParse=n.utcParse,n}xt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var wt=Date.prototype.toISOString?function(nt){return nt.toISOString()}:d.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),bt=+new Date("2000-01-01T00:00:00.000Z")?function(nt){var $e=new Date(nt);return isNaN($e)?null:$e}:d.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");d.isoFormat=wt,d.isoParse=bt,d.timeFormatDefaultLocale=xt,d.timeFormatLocale=t,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){var v=new Date,w=new Date;function y(ge,Te,Se,Me){function ze(Oe){return ge(Oe=arguments.length===0?new Date:new Date(+Oe)),Oe}return ze.floor=function(Oe){return ge(Oe=new Date(+Oe)),Oe},ze.ceil=function(Oe){return ge(Oe=new Date(Oe-1)),Te(Oe,1),ge(Oe),Oe},ze.round=function(Oe){var De=ze(Oe),Xe=ze.ceil(Oe);return Oe-De<Xe-Oe?De:Xe},ze.offset=function(Oe,De){return Te(Oe=new Date(+Oe),De==null?1:Math.floor(De)),Oe},ze.range=function(Oe,De,Xe){var Be,Ie=[];if(Oe=ze.ceil(Oe),Xe=Xe==null?1:Math.floor(Xe),!(Oe<De&&Xe>0))return Ie;do Ie.push(Be=new Date(+Oe)),Te(Oe,Xe),ge(Oe);while(Be<Oe&&Oe<De);return Ie},ze.filter=function(Oe){return y(function(De){if(De>=De)for(;ge(De),!Oe(De);)De.setTime(De-1)},function(De,Xe){if(De>=De)if(Xe<0)for(;++Xe<=0;)for(;Te(De,-1),!Oe(De););else for(;--Xe>=0;)for(;Te(De,1),!Oe(De););})},Se&&(ze.count=function(Oe,De){return v.setTime(+Oe),w.setTime(+De),ge(v),ge(w),Math.floor(Se(v,w))},ze.every=function(Oe){return Oe=Math.floor(Oe),isFinite(Oe)&&Oe>0?Oe>1?ze.filter(Me?function(De){return Me(De)%Oe==0}:function(De){return ze.count(0,De)%Oe==0}):ze:null}),ze}var e=y(function(){},function(ge,Te){ge.setTime(+ge+Te)},function(ge,Te){return Te-ge});e.every=function(ge){return ge=Math.floor(ge),isFinite(ge)&&ge>0?ge>1?y(function(Te){Te.setTime(Math.floor(Te/ge)*ge)},function(Te,Se){Te.setTime(+Te+Se*ge)},function(Te,Se){return(Se-Te)/ge}):e:null};var t=e.range,n=y(function(ge){ge.setTime(ge-ge.getMilliseconds())},function(ge,Te){ge.setTime(+ge+1e3*Te)},function(ge,Te){return(Te-ge)/1e3},function(ge){return ge.getUTCSeconds()}),a=n.range,r=y(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds())},function(ge,Te){ge.setTime(+ge+6e4*Te)},function(ge,Te){return(Te-ge)/6e4},function(ge){return ge.getMinutes()}),g=r.range,u=y(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds()-6e4*ge.getMinutes())},function(ge,Te){ge.setTime(+ge+36e5*Te)},function(ge,Te){return(Te-ge)/36e5},function(ge){return ge.getHours()}),s=u.range,h=y(function(ge){ge.setHours(0,0,0,0)},function(ge,Te){ge.setDate(ge.getDate()+Te)},function(ge,Te){return(Te-ge-6e4*(Te.getTimezoneOffset()-ge.getTimezoneOffset()))/864e5},function(ge){return ge.getDate()-1}),l=h.range;function o(ge){return y(function(Te){Te.setDate(Te.getDate()-(Te.getDay()+7-ge)%7),Te.setHours(0,0,0,0)},function(Te,Se){Te.setDate(Te.getDate()+7*Se)},function(Te,Se){return(Se-Te-6e4*(Se.getTimezoneOffset()-Te.getTimezoneOffset()))/6048e5})}var p=o(0),c=o(1),i=o(2),x=o(3),f=o(4),_=o(5),b=o(6),T=p.range,k=c.range,L=i.range,A=x.range,I=f.range,P=_.range,S=b.range,E=y(function(ge){ge.setDate(1),ge.setHours(0,0,0,0)},function(ge,Te){ge.setMonth(ge.getMonth()+Te)},function(ge,Te){return Te.getMonth()-ge.getMonth()+12*(Te.getFullYear()-ge.getFullYear())},function(ge){return ge.getMonth()}),z=E.range,D=y(function(ge){ge.setMonth(0,1),ge.setHours(0,0,0,0)},function(ge,Te){ge.setFullYear(ge.getFullYear()+Te)},function(ge,Te){return Te.getFullYear()-ge.getFullYear()},function(ge){return ge.getFullYear()});D.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?y(function(Te){Te.setFullYear(Math.floor(Te.getFullYear()/ge)*ge),Te.setMonth(0,1),Te.setHours(0,0,0,0)},function(Te,Se){Te.setFullYear(Te.getFullYear()+Se*ge)}):null};var j=D.range,V=y(function(ge){ge.setUTCSeconds(0,0)},function(ge,Te){ge.setTime(+ge+6e4*Te)},function(ge,Te){return(Te-ge)/6e4},function(ge){return ge.getUTCMinutes()}),Z=V.range,Q=y(function(ge){ge.setUTCMinutes(0,0,0)},function(ge,Te){ge.setTime(+ge+36e5*Te)},function(ge,Te){return(Te-ge)/36e5},function(ge){return ge.getUTCHours()}),K=Q.range,$=y(function(ge){ge.setUTCHours(0,0,0,0)},function(ge,Te){ge.setUTCDate(ge.getUTCDate()+Te)},function(ge,Te){return(Te-ge)/864e5},function(ge){return ge.getUTCDate()-1}),ne=$.range;function H(ge){return y(function(Te){Te.setUTCDate(Te.getUTCDate()-(Te.getUTCDay()+7-ge)%7),Te.setUTCHours(0,0,0,0)},function(Te,Se){Te.setUTCDate(Te.getUTCDate()+7*Se)},function(Te,Se){return(Se-Te)/6048e5})}var N=H(0),U=H(1),te=H(2),B=H(3),X=H(4),J=H(5),ee=H(6),re=N.range,se=U.range,oe=te.range,de=B.range,ce=X.range,ve=J.range,Ae=ee.range,fe=y(function(ge){ge.setUTCDate(1),ge.setUTCHours(0,0,0,0)},function(ge,Te){ge.setUTCMonth(ge.getUTCMonth()+Te)},function(ge,Te){return Te.getUTCMonth()-ge.getUTCMonth()+12*(Te.getUTCFullYear()-ge.getUTCFullYear())},function(ge){return ge.getUTCMonth()}),me=fe.range,_e=y(function(ge){ge.setUTCMonth(0,1),ge.setUTCHours(0,0,0,0)},function(ge,Te){ge.setUTCFullYear(ge.getUTCFullYear()+Te)},function(ge,Te){return Te.getUTCFullYear()-ge.getUTCFullYear()},function(ge){return ge.getUTCFullYear()});_e.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?y(function(Te){Te.setUTCFullYear(Math.floor(Te.getUTCFullYear()/ge)*ge),Te.setUTCMonth(0,1),Te.setUTCHours(0,0,0,0)},function(Te,Se){Te.setUTCFullYear(Te.getUTCFullYear()+Se*ge)}):null};var le=_e.range;d.timeDay=h,d.timeDays=l,d.timeFriday=_,d.timeFridays=P,d.timeHour=u,d.timeHours=s,d.timeInterval=y,d.timeMillisecond=e,d.timeMilliseconds=t,d.timeMinute=r,d.timeMinutes=g,d.timeMonday=c,d.timeMondays=k,d.timeMonth=E,d.timeMonths=z,d.timeSaturday=b,d.timeSaturdays=S,d.timeSecond=n,d.timeSeconds=a,d.timeSunday=p,d.timeSundays=T,d.timeThursday=f,d.timeThursdays=I,d.timeTuesday=i,d.timeTuesdays=L,d.timeWednesday=x,d.timeWednesdays=A,d.timeWeek=p,d.timeWeeks=T,d.timeYear=D,d.timeYears=j,d.utcDay=$,d.utcDays=ne,d.utcFriday=J,d.utcFridays=ve,d.utcHour=Q,d.utcHours=K,d.utcMillisecond=e,d.utcMilliseconds=t,d.utcMinute=V,d.utcMinutes=Z,d.utcMonday=U,d.utcMondays=se,d.utcMonth=fe,d.utcMonths=me,d.utcSaturday=ee,d.utcSaturdays=Ae,d.utcSecond=n,d.utcSeconds=a,d.utcSunday=N,d.utcSundays=re,d.utcThursday=X,d.utcThursdays=ce,d.utcTuesday=te,d.utcTuesdays=oe,d.utcWednesday=B,d.utcWednesdays=de,d.utcWeek=N,d.utcWeeks=re,d.utcYear=_e,d.utcYears=le,Object.defineProperty(d,"__esModule",{value:!0})})},{}],122:[function(m,G,W){arguments[4][121][0].apply(W,arguments)},{dup:121}],123:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).d3=d.d3||{})})(this,function(d){var v,w,y=0,e=0,t=0,n=0,a=0,r=0,g=typeof performance=="object"&&performance.now?performance:Date,u=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function s(){return a||(u(h),a=g.now()+r)}function h(){a=0}function l(){this._call=this._time=this._next=null}function o(f,_,b){var T=new l;return T.restart(f,_,b),T}function p(){s(),++y;for(var f,_=v;_;)(f=a-_._time)>=0&&_._call.call(null,f),_=_._next;--y}function c(){a=(n=g.now())+r,y=e=0;try{p()}finally{y=0,function(){for(var f,_,b=v,T=1/0;b;)b._call?(T>b._time&&(T=b._time),f=b,b=b._next):(_=b._next,b._next=null,b=f?f._next=_:v=_);w=f,x(T)}(),a=0}}function i(){var f=g.now(),_=f-n;_>1e3&&(r-=_,n=f)}function x(f){y||(e&&(e=clearTimeout(e)),f-a>24?(f<1/0&&(e=setTimeout(c,f-g.now()-r)),t&&(t=clearInterval(t))):(t||(n=g.now(),t=setInterval(i,1e3)),y=1,u(c)))}l.prototype=o.prototype={constructor:l,restart:function(f,_,b){if(typeof f!="function")throw new TypeError("callback is not a function");b=(b==null?s():+b)+(_==null?0:+_),this._next||w===this||(w?w._next=this:v=this,w=this),this._call=f,this._time=b,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}},d.interval=function(f,_,b){var T=new l,k=_;return _==null?(T.restart(f,_,b),T):(_=+_,b=b==null?s():+b,T.restart(function L(A){A+=k,T.restart(L,k+=_,b),f(A)},_,b),T)},d.now=s,d.timeout=function(f,_,b){var T=new l;return _=_==null?0:+_,T.restart(function(k){T.stop(),f(k+_)},_,b),T},d.timer=o,d.timerFlush=p,Object.defineProperty(d,"__esModule",{value:!0})})},{}],124:[function(m,G,W){G.exports=function(){for(var d=0;d<arguments.length;d++)if(arguments[d]!==void 0)return arguments[d]}},{}],125:[function(m,G,W){G.exports=w;var d=(w.canvas=document.createElement("canvas")).getContext("2d"),v=y([32,126]);function w(e,t){Array.isArray(e)&&(e=e.join(", "));var n,a={},r=16,g=.05;t&&(t.length===2&&typeof t[0]=="number"?n=y(t):Array.isArray(t)?n=t:(t.o?n=y(t.o):t.pairs&&(n=t.pairs),t.fontSize&&(r=t.fontSize),t.threshold!=null&&(g=t.threshold))),n||(n=v),d.font=r+"px "+e;for(var u=0;u<n.length;u++){var s=n[u],h=d.measureText(s[0]).width+d.measureText(s[1]).width,l=d.measureText(s).width;if(Math.abs(h-l)>r*g){var o=(l-h)/r;a[s]=1e3*o}}return a}function y(e){for(var t=[],n=e[0];n<=e[1];n++)for(var a=String.fromCharCode(n),r=e[0];r<e[1];r++){var g=a+String.fromCharCode(r);t.push(g)}return t}w.createPairs=y,w.ascii=v},{}],126:[function(m,G,W){var d=m("abs-svg-path"),v=m("normalize-svg-path"),w={M:"moveTo",C:"bezierCurveTo"};G.exports=function(y,e){y.beginPath(),v(d(e)).forEach(function(t){var n=t[0],a=t.slice(1);y[w[n]].apply(y,a)}),y.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(m,G,W){G.exports=function(d){switch(d){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(m,G,W){G.exports=function(d,v){switch(v===void 0&&(v=0),typeof d){case"number":if(d>0)return function(w,y){var e,t;for(e=new Array(w),t=0;t<w;++t)e[t]=y;return e}(0|d,v);break;case"object":if(typeof d.length=="number")return function w(y,e,t){var n=0|y[t];if(n<=0)return[];var a,r=new Array(n);if(t===y.length-1)for(a=0;a<n;++a)r[a]=e;else for(a=0;a<n;++a)r[a]=w(y,e,t+1);return r}(d,v,0)}return[]}},{}],129:[function(m,G,W){function d(I,P,S){S=S||2;var E,z,D,j,V,Z,Q,K=P&&P.length,$=K?P[0]*S:I.length,ne=v(I,0,$,S,!0),H=[];if(!ne||ne.next===ne.prev)return H;if(K&&(ne=function(U,te,B,X){var J,ee,re,se,oe,de=[];for(J=0,ee=te.length;J<ee;J++)re=te[J]*X,se=J<ee-1?te[J+1]*X:U.length,(oe=v(U,re,se,X,!1))===oe.next&&(oe.steiner=!0),de.push(h(oe));for(de.sort(r),J=0;J<de.length;J++)g(de[J],B),B=w(B,B.next);return B}(I,P,ne,S)),I.length>80*S){E=D=I[0],z=j=I[1];for(var N=S;N<$;N+=S)(V=I[N])<E&&(E=V),(Z=I[N+1])<z&&(z=Z),V>D&&(D=V),Z>j&&(j=Z);Q=(Q=Math.max(D-E,j-z))!==0?1/Q:0}return y(ne,H,S,E,z,Q),H}function v(I,P,S,E,z){var D,j;if(z===A(I,P,S,E)>0)for(D=P;D<S;D+=E)j=T(D,I[D],I[D+1],j);else for(D=S-E;D>=P;D-=E)j=T(D,I[D],I[D+1],j);return j&&c(j,j.next)&&(k(j),j=j.next),j}function w(I,P){if(!I)return I;P||(P=I);var S,E=I;do if(S=!1,E.steiner||!c(E,E.next)&&p(E.prev,E,E.next)!==0)E=E.next;else{if(k(E),(E=P=E.prev)===E.next)break;S=!0}while(S||E!==P);return P}function y(I,P,S,E,z,D,j){if(I){!j&&D&&function(K,$,ne,H){var N=K;do N.z===null&&(N.z=s(N.x,N.y,$,ne,H)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==K);N.prevZ.nextZ=null,N.prevZ=null,function(U){var te,B,X,J,ee,re,se,oe,de=1;do{for(B=U,U=null,ee=null,re=0;B;){for(re++,X=B,se=0,te=0;te<de&&(se++,X=X.nextZ);te++);for(oe=de;se>0||oe>0&&X;)se!==0&&(oe===0||!X||B.z<=X.z)?(J=B,B=B.nextZ,se--):(J=X,X=X.nextZ,oe--),ee?ee.nextZ=J:U=J,J.prevZ=ee,ee=J;B=X}ee.nextZ=null,de*=2}while(re>1)}(N)}(I,E,z,D);for(var V,Z,Q=I;I.prev!==I.next;)if(V=I.prev,Z=I.next,D?t(I,E,z,D):e(I))P.push(V.i/S),P.push(I.i/S),P.push(Z.i/S),k(I),I=Z.next,Q=Z.next;else if((I=Z)===Q){j?j===1?y(I=n(w(I),P,S),P,S,E,z,D,2):j===2&&a(I,P,S,E,z,D):y(w(I),P,S,E,z,D,1);break}}}function e(I){var P=I.prev,S=I,E=I.next;if(p(P,S,E)>=0)return!1;for(var z=I.next.next;z!==I.prev;){if(l(P.x,P.y,S.x,S.y,E.x,E.y,z.x,z.y)&&p(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function t(I,P,S,E){var z=I.prev,D=I,j=I.next;if(p(z,D,j)>=0)return!1;for(var V=z.x<D.x?z.x<j.x?z.x:j.x:D.x<j.x?D.x:j.x,Z=z.y<D.y?z.y<j.y?z.y:j.y:D.y<j.y?D.y:j.y,Q=z.x>D.x?z.x>j.x?z.x:j.x:D.x>j.x?D.x:j.x,K=z.y>D.y?z.y>j.y?z.y:j.y:D.y>j.y?D.y:j.y,$=s(V,Z,P,S,E),ne=s(Q,K,P,S,E),H=I.prevZ,N=I.nextZ;H&&H.z>=$&&N&&N.z<=ne;){if(H!==I.prev&&H!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,H.x,H.y)&&p(H.prev,H,H.next)>=0||(H=H.prevZ,N!==I.prev&&N!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,N.x,N.y)&&p(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;H&&H.z>=$;){if(H!==I.prev&&H!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,H.x,H.y)&&p(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;N&&N.z<=ne;){if(N!==I.prev&&N!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,N.x,N.y)&&p(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function n(I,P,S){var E=I;do{var z=E.prev,D=E.next.next;!c(z,D)&&i(z,E,E.next,D)&&_(z,D)&&_(D,z)&&(P.push(z.i/S),P.push(E.i/S),P.push(D.i/S),k(E),k(E.next),E=I=D),E=E.next}while(E!==I);return w(E)}function a(I,P,S,E,z,D){var j=I;do{for(var V=j.next.next;V!==j.prev;){if(j.i!==V.i&&o(j,V)){var Z=b(j,V);return j=w(j,j.next),Z=w(Z,Z.next),y(j,P,S,E,z,D),void y(Z,P,S,E,z,D)}V=V.next}j=j.next}while(j!==I)}function r(I,P){return I.x-P.x}function g(I,P){if(P=function(E,z){var D,j=z,V=E.x,Z=E.y,Q=-1/0;do{if(Z<=j.y&&Z>=j.next.y&&j.next.y!==j.y){var K=j.x+(Z-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(K<=V&&K>Q){if(Q=K,K===V){if(Z===j.y)return j;if(Z===j.next.y)return j.next}D=j.x<j.next.x?j:j.next}}j=j.next}while(j!==z);if(!D)return null;if(V===Q)return D;var $,ne=D,H=D.x,N=D.y,U=1/0;j=D;do V>=j.x&&j.x>=H&&V!==j.x&&l(Z<N?V:Q,Z,H,N,Z<N?Q:V,Z,j.x,j.y)&&($=Math.abs(Z-j.y)/(V-j.x),_(j,E)&&($<U||$===U&&(j.x>D.x||j.x===D.x&&u(D,j)))&&(D=j,U=$)),j=j.next;while(j!==ne);return D}(I,P)){var S=b(P,I);w(P,P.next),w(S,S.next)}}function u(I,P){return p(I.prev,I,P.prev)<0&&p(P.next,I,I.next)<0}function s(I,P,S,E,z){return(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-S)*z)|I<<8))|I<<4))|I<<2))|I<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-E)*z)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function h(I){var P=I,S=I;do(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next;while(P!==I);return S}function l(I,P,S,E,z,D,j,V){return(z-j)*(P-V)-(I-j)*(D-V)>=0&&(I-j)*(E-V)-(S-j)*(P-V)>=0&&(S-j)*(D-V)-(z-j)*(E-V)>=0}function o(I,P){return I.next.i!==P.i&&I.prev.i!==P.i&&!function(S,E){var z=S;do{if(z.i!==S.i&&z.next.i!==S.i&&z.i!==E.i&&z.next.i!==E.i&&i(z,z.next,S,E))return!0;z=z.next}while(z!==S);return!1}(I,P)&&(_(I,P)&&_(P,I)&&function(S,E){var z=S,D=!1,j=(S.x+E.x)/2,V=(S.y+E.y)/2;do z.y>V!=z.next.y>V&&z.next.y!==z.y&&j<(z.next.x-z.x)*(V-z.y)/(z.next.y-z.y)+z.x&&(D=!D),z=z.next;while(z!==S);return D}(I,P)&&(p(I.prev,I,P.prev)||p(I,P.prev,P))||c(I,P)&&p(I.prev,I,I.next)>0&&p(P.prev,P,P.next)>0)}function p(I,P,S){return(P.y-I.y)*(S.x-P.x)-(P.x-I.x)*(S.y-P.y)}function c(I,P){return I.x===P.x&&I.y===P.y}function i(I,P,S,E){var z=f(p(I,P,S)),D=f(p(I,P,E)),j=f(p(S,E,I)),V=f(p(S,E,P));return z!==D&&j!==V||!(z!==0||!x(I,S,P))||!(D!==0||!x(I,E,P))||!(j!==0||!x(S,I,E))||!(V!==0||!x(S,P,E))}function x(I,P,S){return P.x<=Math.max(I.x,S.x)&&P.x>=Math.min(I.x,S.x)&&P.y<=Math.max(I.y,S.y)&&P.y>=Math.min(I.y,S.y)}function f(I){return I>0?1:I<0?-1:0}function _(I,P){return p(I.prev,I,I.next)<0?p(I,P,I.next)>=0&&p(I,I.prev,P)>=0:p(I,P,I.prev)<0||p(I,I.next,P)<0}function b(I,P){var S=new L(I.i,I.x,I.y),E=new L(P.i,P.x,P.y),z=I.next,D=P.prev;return I.next=P,P.prev=I,S.next=z,z.prev=S,E.next=S,S.prev=E,D.next=E,E.prev=D,E}function T(I,P,S,E){var z=new L(I,P,S);return E?(z.next=E.next,z.prev=E,E.next.prev=z,E.next=z):(z.prev=z,z.next=z),z}function k(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function L(I,P,S){this.i=I,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(I,P,S,E){for(var z=0,D=P,j=S-E;D<S;D+=E)z+=(I[j]-I[D])*(I[D+1]+I[j+1]),j=D;return z}G.exports=d,G.exports.default=d,d.deviation=function(I,P,S,E){var z=P&&P.length,D=z?P[0]*S:I.length,j=Math.abs(A(I,0,D,S));if(z)for(var V=0,Z=P.length;V<Z;V++){var Q=P[V]*S,K=V<Z-1?P[V+1]*S:I.length;j-=Math.abs(A(I,Q,K,S))}var $=0;for(V=0;V<E.length;V+=3){var ne=E[V]*S,H=E[V+1]*S,N=E[V+2]*S;$+=Math.abs((I[ne]-I[N])*(I[H+1]-I[ne+1])-(I[ne]-I[H])*(I[N+1]-I[ne+1]))}return j===0&&$===0?0:Math.abs(($-j)/j)},d.flatten=function(I){for(var P=I[0][0].length,S={vertices:[],holes:[],dimensions:P},E=0,z=0;z<I.length;z++){for(var D=0;D<I[z].length;D++)for(var j=0;j<P;j++)S.vertices.push(I[z][D][j]);z>0&&(E+=I[z-1].length,S.holes.push(E))}return S}},{}],130:[function(m,G,W){var d=m("strongly-connected-components");G.exports=function(v,w){var y,e=[],t=[],n=[],a={},r=[];function g(i){var x,f,_=!1;for(t.push(i),n[i]=!0,x=0;x<r[i].length;x++)(f=r[i][x])===y?(u(y,t),_=!0):n[f]||(_=g(f));if(_)(function T(k){n[k]=!1,a.hasOwnProperty(k)&&Object.keys(a[k]).forEach(function(L){delete a[k][L],n[L]&&T(L)})})(i);else for(x=0;x<r[i].length;x++){f=r[i][x];var b=a[f];b||(b={},a[f]=b),b[f]=!0}return t.pop(),_}function u(i,x){var f=[].concat(x).concat(i);w?w(g):e.push(f)}function s(i){(function(L){for(var A=0;A<v.length;A++)A<L&&(v[A]=[]),v[A]=v[A].filter(function(I){return I>=L})})(i);for(var x,f=d(v).components.filter(function(L){return L.length>1}),_=1/0,b=0;b<f.length;b++)for(var T=0;T<f[b].length;T++)f[b][T]<_&&(_=f[b][T],x=b);var k=f[x];return!!k&&{leastVertex:_,adjList:v.map(function(L,A){return k.indexOf(A)===-1?[]:L.filter(function(I){return k.indexOf(I)!==-1})})}}y=0;for(var h=v.length;y<h;){var l=s(y);if(y=l.leastVertex,r=l.adjList){for(var o=0;o<r.length;o++)for(var p=0;p<r[o].length;p++){var c=r[o][p];n[+c]=!1,a[c]={}}g(y),y+=1}else y=h}return w?void 0:e}},{"strongly-connected-components":307}],131:[function(m,G,W){var d=m("../../object/valid-value");G.exports=function(){return d(this).length=0,this}},{"../../object/valid-value":162}],132:[function(m,G,W){G.exports=m("./is-implemented")()?Array.from:m("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(m,G,W){G.exports=function(){var d,v,w=Array.from;return typeof w=="function"&&(v=w(d=["raz","dwa"]),Boolean(v&&v!==d&&v[1]==="dwa"))}},{}],134:[function(m,G,W){var d=m("es6-symbol").iterator,v=m("../../function/is-arguments"),w=m("../../function/is-function"),y=m("../../number/to-pos-integer"),e=m("../../object/valid-callable"),t=m("../../object/valid-value"),n=m("../../object/is-value"),a=m("../../string/is-string"),r=Array.isArray,g=Function.prototype.call,u={configurable:!0,enumerable:!0,writable:!0,value:null},s=Object.defineProperty;G.exports=function(h){var l,o,p,c,i,x,f,_,b,T,k=arguments[1],L=arguments[2];if(h=Object(t(h)),n(k)&&e(k),this&&this!==Array&&w(this))l=this;else{if(!k){if(v(h))return(i=h.length)!==1?Array.apply(null,h):((c=new Array(1))[0]=h[0],c);if(r(h)){for(c=new Array(i=h.length),o=0;o<i;++o)c[o]=h[o];return c}}c=[]}if(!r(h)){if((b=h[d])!==void 0){for(f=e(b).call(h),l&&(c=new l),_=f.next(),o=0;!_.done;)T=k?g.call(k,L,_.value,o):_.value,l?(u.value=T,s(c,o,u)):c[o]=T,_=f.next(),++o;i=o}else if(a(h)){for(i=h.length,l&&(c=new l),o=0,p=0;o<i;++o)T=h[o],o+1<i&&(x=T.charCodeAt(0))>=55296&&x<=56319&&(T+=h[++o]),T=k?g.call(k,L,T,p):T,l?(u.value=T,s(c,p,u)):c[p]=T,++p;i=p}}if(i===void 0)for(i=y(h.length),l&&(c=new l(i)),o=0;o<i;++o)T=k?g.call(k,L,h[o],o):h[o],l?(u.value=T,s(c,o,u)):c[o]=T;return l&&(u.value=null,c.length=i),c}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(m,G,W){var d=Object.prototype.toString,v=d.call(function(){return arguments}());G.exports=function(w){return d.call(w)===v}},{}],136:[function(m,G,W){var d=Object.prototype.toString,v=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);G.exports=function(w){return typeof w=="function"&&v(d.call(w))}},{}],137:[function(m,G,W){G.exports=function(){}},{}],138:[function(m,G,W){G.exports=m("./is-implemented")()?Math.sign:m("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(m,G,W){G.exports=function(){var d=Math.sign;return typeof d=="function"&&d(10)===1&&d(-20)===-1}},{}],140:[function(m,G,W){G.exports=function(d){return d=Number(d),isNaN(d)||d===0?d:d>0?1:-1}},{}],141:[function(m,G,W){var d=m("../math/sign"),v=Math.abs,w=Math.floor;G.exports=function(y){return isNaN(y)?0:(y=Number(y))!==0&&isFinite(y)?d(y)*w(v(y)):y}},{"../math/sign":138}],142:[function(m,G,W){var d=m("./to-integer"),v=Math.max;G.exports=function(w){return v(0,d(w))}},{"./to-integer":141}],143:[function(m,G,W){var d=m("./valid-callable"),v=m("./valid-value"),w=Function.prototype.bind,y=Function.prototype.call,e=Object.keys,t=Object.prototype.propertyIsEnumerable;G.exports=function(n,a){return function(r,g){var u,s=arguments[2],h=arguments[3];return r=Object(v(r)),d(g),u=e(r),h&&u.sort(typeof h=="function"?w.call(h,r):void 0),typeof n!="function"&&(n=u[n]),y.call(n,u,function(l,o){return t.call(r,l)?y.call(g,s,r[l],l,r,o):a})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(m,G,W){G.exports=m("./is-implemented")()?Object.assign:m("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(m,G,W){G.exports=function(){var d,v=Object.assign;return typeof v=="function"&&(v(d={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),d.foo+d.bar+d.trzy==="razdwatrzy")}},{}],146:[function(m,G,W){var d=m("../keys"),v=m("../valid-value"),w=Math.max;G.exports=function(y,e){var t,n,a,r=w(arguments.length,2);for(y=Object(v(y)),a=function(g){try{y[g]=e[g]}catch(u){t||(t=u)}},n=1;n<r;++n)d(e=arguments[n]).forEach(a);if(t!==void 0)throw t;return y}},{"../keys":152,"../valid-value":162}],147:[function(m,G,W){var d=m("../array/from"),v=m("./assign"),w=m("./valid-value");G.exports=function(y){var e=Object(w(y)),t=arguments[1],n=Object(arguments[2]);if(e!==y&&!t)return e;var a={};return t?d(t,function(r){(n.ensure||r in y)&&(a[r]=y[r])}):v(a,y),a}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(m,G,W){var d,v,w,y,e=Object.create;m("./set-prototype-of/is-implemented")()||(d=m("./set-prototype-of/shim")),G.exports=d?d.level!==1?e:(v={},w={},y={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(t){w[t]=t!=="__proto__"?y:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(v,w),Object.defineProperty(d,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:v}),function(t,n){return e(t===null?v:t,n)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(m,G,W){G.exports=m("./_iterate")("forEach")},{"./_iterate":143}],150:[function(m,G,W){var d=m("./is-value"),v={function:!0,object:!0};G.exports=function(w){return d(w)&&v[typeof w]||!1}},{"./is-value":151}],151:[function(m,G,W){var d=m("../function/noop")();G.exports=function(v){return v!==d&&v!==null}},{"../function/noop":137}],152:[function(m,G,W){G.exports=m("./is-implemented")()?Object.keys:m("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(m,G,W){G.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(m,G,W){var d=m("../is-value"),v=Object.keys;G.exports=function(w){return v(d(w)?Object(w):w)}},{"../is-value":151}],155:[function(m,G,W){var d=m("./valid-callable"),v=m("./for-each"),w=Function.prototype.call;G.exports=function(y,e){var t={},n=arguments[2];return d(e),v(y,function(a,r,g,u){t[r]=w.call(e,n,a,r,g,u)}),t}},{"./for-each":149,"./valid-callable":160}],156:[function(m,G,W){var d=m("./is-value"),v=Array.prototype.forEach,w=Object.create,y=function(e,t){var n;for(n in e)t[n]=e[n]};G.exports=function(e){var t=w(null);return v.call(arguments,function(n){d(n)&&y(Object(n),t)}),t}},{"./is-value":151}],157:[function(m,G,W){G.exports=m("./is-implemented")()?Object.setPrototypeOf:m("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(m,G,W){var d=Object.create,v=Object.getPrototypeOf,w={};G.exports=function(){var y=Object.setPrototypeOf,e=arguments[0]||d;return typeof y=="function"&&v(y(e(null),w))===w}},{}],159:[function(m,G,W){var d,v=m("../is-object"),w=m("../valid-value"),y=Object.prototype.isPrototypeOf,e=Object.defineProperty,t={configurable:!0,enumerable:!1,writable:!0,value:void 0};d=function(n,a){if(w(n),a===null||v(a))return n;throw new TypeError("Prototype must be null or an object")},G.exports=function(n){var a,r;return n?(n.level===2?n.set?(r=n.set,a=function(g,u){return r.call(d(g,u),u),g}):a=function(g,u){return d(g,u).__proto__=u,g}:a=function g(u,s){var h;return d(u,s),(h=y.call(g.nullPolyfill,u))&&delete g.nullPolyfill.__proto__,s===null&&(s=g.nullPolyfill),u.__proto__=s,h&&e(g.nullPolyfill,"__proto__",t),u},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n,a=Object.create(null),r={},g=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(g){try{(n=g.set).call(a,r)}catch{}if(Object.getPrototypeOf(a)===r)return{set:n,level:2}}return a.__proto__=r,Object.getPrototypeOf(a)===r?{level:2}:((a={}).__proto__=r,Object.getPrototypeOf(a)===r&&{level:1})}()),m("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(m,G,W){G.exports=function(d){if(typeof d!="function")throw new TypeError(d+" is not a function");return d}},{}],161:[function(m,G,W){var d=m("./is-object");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not an Object");return v}},{"./is-object":150}],162:[function(m,G,W){var d=m("./is-value");G.exports=function(v){if(!d(v))throw new TypeError("Cannot use null or undefined");return v}},{"./is-value":151}],163:[function(m,G,W){G.exports=m("./is-implemented")()?String.prototype.contains:m("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(m,G,W){var d="razdwatrzy";G.exports=function(){return typeof d.contains=="function"&&d.contains("dwa")===!0&&d.contains("foo")===!1}},{}],165:[function(m,G,W){var d=String.prototype.indexOf;G.exports=function(v){return d.call(this,v,arguments[1])>-1}},{}],166:[function(m,G,W){var d=Object.prototype.toString,v=d.call("");G.exports=function(w){return typeof w=="string"||w&&typeof w=="object"&&(w instanceof String||d.call(w)===v)||!1}},{}],167:[function(m,G,W){var d=Object.create(null),v=Math.random;G.exports=function(){var w;do w=v().toString(36).slice(2);while(d[w]);return w}},{}],168:[function(m,G,W){var d,v=m("es5-ext/object/set-prototype-of"),w=m("es5-ext/string/#/contains"),y=m("d"),e=m("es6-symbol"),t=m("./"),n=Object.defineProperty;d=G.exports=function(a,r){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");t.call(this,a),r=r?w.call(r,"key+value")?"key+value":w.call(r,"key")?"key":"value":"value",n(this,"__kind__",y("",r))},v&&v(d,t),delete d.prototype.constructor,d.prototype=Object.create(t.prototype,{_resolve:y(function(a){return this.__kind__==="value"?this.__list__[a]:this.__kind__==="key+value"?[a,this.__list__[a]]:a})}),n(d.prototype,e.toStringTag,y("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(m,G,W){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/object/valid-callable"),w=m("es5-ext/string/is-string"),y=m("./get"),e=Array.isArray,t=Function.prototype.call,n=Array.prototype.some;G.exports=function(a,r){var g,u,s,h,l,o,p,c,i=arguments[2];if(e(a)||d(a)?g="array":w(a)?g="string":a=y(a),v(r),s=function(){h=!0},g!=="array")if(g!=="string")for(u=a.next();!u.done;){if(t.call(r,i,u.value,s),h)return;u=a.next()}else for(o=a.length,l=0;l<o&&(p=a[l],l+1<o&&(c=p.charCodeAt(0))>=55296&&c<=56319&&(p+=a[++l]),t.call(r,i,p,s),!h);++l);else n.call(a,function(x){return t.call(r,i,x,s),h})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(m,G,W){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/string/is-string"),w=m("./array"),y=m("./string"),e=m("./valid-iterable"),t=m("es6-symbol").iterator;G.exports=function(n){return typeof e(n)[t]=="function"?n[t]():d(n)?new w(n):v(n)?new y(n):new w(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(m,G,W){var d,v=m("es5-ext/array/#/clear"),w=m("es5-ext/object/assign"),y=m("es5-ext/object/valid-callable"),e=m("es5-ext/object/valid-value"),t=m("d"),n=m("d/auto-bind"),a=m("es6-symbol"),r=Object.defineProperty,g=Object.defineProperties;G.exports=d=function(u,s){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");g(this,{__list__:t("w",e(u)),__context__:t("w",s),__nextIndex__:t("w",0)}),s&&(y(s.on),s.on("_add",this._onAdd),s.on("_delete",this._onDelete),s.on("_clear",this._onClear))},delete d.prototype.constructor,g(d.prototype,w({_next:t(function(){var u;if(this.__list__)return this.__redo__&&(u=this.__redo__.shift())!==void 0?u:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:t(function(){return this._createResult(this._next())}),_createResult:t(function(u){return u===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(u)}}),_resolve:t(function(u){return this.__list__[u]}),_unBind:t(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:t(function(){return"[object "+(this[a.toStringTag]||"Object")+"]"})},n({_onAdd:t(function(u){u>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(s,h){s>=u&&(this.__redo__[h]=++s)},this),this.__redo__.push(u)):r(this,"__redo__",t("c",[u])))}),_onDelete:t(function(u){var s;u>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((s=this.__redo__.indexOf(u))!==-1&&this.__redo__.splice(s,1),this.__redo__.forEach(function(h,l){h>u&&(this.__redo__[l]=--h)},this)))}),_onClear:t(function(){this.__redo__&&v.call(this.__redo__),this.__nextIndex__=0})}))),r(d.prototype,a.iterator,t(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(m,G,W){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/object/is-value"),w=m("es5-ext/string/is-string"),y=m("es6-symbol").iterator,e=Array.isArray;G.exports=function(t){return!!v(t)&&(!!e(t)||!!w(t)||!!d(t)||typeof t[y]=="function")}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(m,G,W){var d,v=m("es5-ext/object/set-prototype-of"),w=m("d"),y=m("es6-symbol"),e=m("./"),t=Object.defineProperty;d=G.exports=function(n){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");n=String(n),e.call(this,n),t(this,"__length__",w("",n.length))},v&&v(d,e),delete d.prototype.constructor,d.prototype=Object.create(e.prototype,{_next:w(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:w(function(n){var a,r=this.__list__[n];return this.__nextIndex__===this.__length__?r:(a=r.charCodeAt(0))>=55296&&a<=56319?r+this.__list__[this.__nextIndex__++]:r})}),t(d.prototype,y.toStringTag,w("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(m,G,W){var d=m("./is-iterable");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not iterable");return v}},{"./is-iterable":172}],175:[function(m,G,W){G.exports=m("./is-implemented")()?m("ext/global-this").Symbol:m("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(m,G,W){var d=m("ext/global-this"),v={object:!0,symbol:!0};G.exports=function(){var w,y=d.Symbol;if(typeof y!="function")return!1;w=y("test symbol");try{String(w)}catch{return!1}return!!v[typeof y.iterator]&&!!v[typeof y.toPrimitive]&&!!v[typeof y.toStringTag]}},{"ext/global-this":188}],177:[function(m,G,W){G.exports=function(d){return!!d&&(typeof d=="symbol"||!!d.constructor&&d.constructor.name==="Symbol"&&d[d.constructor.toStringTag]==="Symbol")}},{}],178:[function(m,G,W){var d=m("d"),v=Object.create,w=Object.defineProperty,y=Object.prototype,e=v(null);G.exports=function(t){for(var n,a,r=0;e[t+(r||"")];)++r;return e[t+=r||""]=!0,w(y,n="@@"+t,d.gs(null,function(g){a||(a=!0,w(this,n,d(g)),a=!1)})),n}},{d:106}],179:[function(m,G,W){var d=m("d"),v=m("ext/global-this").Symbol;G.exports=function(w){return Object.defineProperties(w,{hasInstance:d("",v&&v.hasInstance||w("hasInstance")),isConcatSpreadable:d("",v&&v.isConcatSpreadable||w("isConcatSpreadable")),iterator:d("",v&&v.iterator||w("iterator")),match:d("",v&&v.match||w("match")),replace:d("",v&&v.replace||w("replace")),search:d("",v&&v.search||w("search")),species:d("",v&&v.species||w("species")),split:d("",v&&v.split||w("split")),toPrimitive:d("",v&&v.toPrimitive||w("toPrimitive")),toStringTag:d("",v&&v.toStringTag||w("toStringTag")),unscopables:d("",v&&v.unscopables||w("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(m,G,W){var d=m("d"),v=m("../../../validate-symbol"),w=Object.create(null);G.exports=function(y){return Object.defineProperties(y,{for:d(function(e){return w[e]?w[e]:w[e]=y(String(e))}),keyFor:d(function(e){var t;for(t in v(e),w)if(w[t]===e)return t})})}},{"../../../validate-symbol":182,d:106}],181:[function(m,G,W){var d,v,w,y=m("d"),e=m("./validate-symbol"),t=m("ext/global-this").Symbol,n=m("./lib/private/generate-name"),a=m("./lib/private/setup/standard-symbols"),r=m("./lib/private/setup/symbol-registry"),g=Object.create,u=Object.defineProperties,s=Object.defineProperty;if(typeof t=="function")try{String(t()),w=!0}catch{}else t=null;v=function(h){if(this instanceof v)throw new TypeError("Symbol is not a constructor");return d(h)},G.exports=d=function h(l){var o;if(this instanceof h)throw new TypeError("Symbol is not a constructor");return w?t(l):(o=g(v.prototype),l=l===void 0?"":String(l),u(o,{__description__:y("",l),__name__:y("",n(l))}))},a(d),r(d),u(v.prototype,{constructor:y(d),toString:y("",function(){return this.__name__})}),u(d.prototype,{toString:y(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:y(function(){return e(this)})}),s(d.prototype,d.toPrimitive,y("",function(){var h=e(this);return typeof h=="symbol"?h:h.toString()})),s(d.prototype,d.toStringTag,y("c","Symbol")),s(v.prototype,d.toStringTag,y("c",d.prototype[d.toStringTag])),s(v.prototype,d.toPrimitive,y("c",d.prototype[d.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(m,G,W){var d=m("./is-symbol");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not a symbol");return v}},{"./is-symbol":177}],183:[function(m,G,W){G.exports=m("./is-implemented")()?WeakMap:m("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(m,G,W){G.exports=function(){var d,v;if(typeof WeakMap!="function")return!1;try{d=new WeakMap([[v={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return String(d)==="[object WeakMap]"&&typeof d.set=="function"&&d.set({},1)===d&&typeof d.delete=="function"&&typeof d.has=="function"&&d.get(v)==="one"}},{}],185:[function(m,G,W){G.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],186:[function(m,G,W){var d,v=m("es5-ext/object/is-value"),w=m("es5-ext/object/set-prototype-of"),y=m("es5-ext/object/valid-object"),e=m("es5-ext/object/valid-value"),t=m("es5-ext/string/random-uniq"),n=m("d"),a=m("es6-iterator/get"),r=m("es6-iterator/for-of"),g=m("es6-symbol").toStringTag,u=m("./is-native-implemented"),s=Array.isArray,h=Object.defineProperty,l=Object.prototype.hasOwnProperty,o=Object.getPrototypeOf;G.exports=d=function(){var p,c=arguments[0];if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");return p=u&&w&&WeakMap!==d?w(new WeakMap,o(this)):this,v(c)&&(s(c)||(c=a(c))),h(p,"__weakMapData__",n("c","$weakMap$"+t())),c&&r(c,function(i){e(i),p.set(i[0],i[1])}),p},u&&(w&&w(d,WeakMap),d.prototype=Object.create(WeakMap.prototype,{constructor:n(d)})),Object.defineProperties(d.prototype,{delete:n(function(p){return!!l.call(y(p),this.__weakMapData__)&&(delete p[this.__weakMapData__],!0)}),get:n(function(p){if(l.call(y(p),this.__weakMapData__))return p[this.__weakMapData__]}),has:n(function(p){return l.call(y(p),this.__weakMapData__)}),set:n(function(p,c){return h(y(p),this.__weakMapData__,n("c",c)),this}),toString:n(function(){return"[object WeakMap]"})}),h(d.prototype,g,n("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(m,G,W){var d=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};G.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return d()}try{return __global__||d()}finally{delete Object.prototype.__global__}}()},{}],188:[function(m,G,W){G.exports=m("./is-implemented")()?globalThis:m("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(m,G,W){G.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(m,G,W){var d=m("is-string-blank");G.exports=function(v){var w=typeof v;if(w==="string"){var y=v;if((v=+v)==0&&d(y))return!1}else if(w!=="number")return!1;return v-v<1}},{"is-string-blank":237}],191:[function(m,G,W){var d=m("dtype");G.exports=function(v,w,y){if(!v)throw new TypeError("must specify data as first parameter");if(y=0|+(y||0),Array.isArray(v)&&v[0]&&typeof v[0][0]=="number"){var e,t,n,a,r=v[0].length,g=v.length*r;w&&typeof w!="string"||(w=new(d(w||"float32"))(g+y));var u=w.length-y;if(g!==u)throw new Error("source length "+g+" ("+r+"x"+v.length+") does not match destination length "+u);for(e=0,n=y;e<v.length;e++)for(t=0;t<r;t++)w[n++]=v[e][t]===null?NaN:v[e][t]}else if(w&&typeof w!="string")w.set(v,y);else{var s=d(w||"float32");if(Array.isArray(v)||w==="array")for(w=new s(v.length+y),e=0,n=y,a=w.length;n<a;n++,e++)w[n]=v[e]===null?NaN:v[e];else y===0?w=new s(v):(w=new s(v.length+y)).set(v,y)}return w}},{dtype:127}],192:[function(m,G,W){var d=m("css-font/stringify"),v=[32,126];G.exports=function(w){var y=(w=w||{}).shape?w.shape:w.canvas?[w.canvas.width,w.canvas.height]:[512,512],e=w.canvas||document.createElement("canvas"),t=w.font,n=typeof w.step=="number"?[w.step,w.step]:w.step||[32,32],a=w.chars||v;if(t&&typeof t!="string"&&(t=d(t)),Array.isArray(a)){if(a.length===2&&typeof a[0]=="number"&&typeof a[1]=="number"){for(var r=[],g=a[0],u=0;g<=a[1];g++)r[u++]=String.fromCharCode(g);a=r}}else a=String(a).split("");y=y.slice(),e.width=y[0],e.height=y[1];var s=e.getContext("2d");s.fillStyle="#000",s.fillRect(0,0,e.width,e.height),s.font=t,s.textAlign="center",s.textBaseline="middle",s.fillStyle="#fff";var h=n[0]/2,l=n[1]/2;for(g=0;g<a.length;g++)s.fillText(a[g],h,l),(h+=n[0])>y[0]-n[0]/2&&(h=n[0]/2,l+=n[1]);return e}},{"css-font/stringify":102}],193:[function(m,G,W){function d(e,t){t||(t={}),(typeof e=="string"||Array.isArray(e))&&(t.family=e);var n=Array.isArray(t.family)?t.family.join(", "):t.family;if(!n)throw Error("`family` must be defined");var a=t.size||t.fontSize||t.em||48,r=t.weight||t.fontWeight||"",g=(e=[t.style||t.fontStyle||"",r,a].join(" ")+"px "+n,t.origin||"top");if(d.cache[n]&&a<=d.cache[n].em)return v(d.cache[n],g);var u=t.canvas||d.canvas,s=u.getContext("2d"),h={upper:t.upper!==void 0?t.upper:"H",lower:t.lower!==void 0?t.lower:"x",descent:t.descent!==void 0?t.descent:"p",ascent:t.ascent!==void 0?t.ascent:"h",tittle:t.tittle!==void 0?t.tittle:"i",overshoot:t.overshoot!==void 0?t.overshoot:"O"},l=Math.ceil(1.5*a);u.height=l,u.width=.5*l,s.font=e;var o={top:0};s.clearRect(0,0,l,l),s.textBaseline="top",s.fillStyle="black",s.fillText("H",0,0);var p=w(s.getImageData(0,0,l,l));s.clearRect(0,0,l,l),s.textBaseline="bottom",s.fillText("H",0,l);var c=w(s.getImageData(0,0,l,l));o.lineHeight=o.bottom=l-c+p,s.clearRect(0,0,l,l),s.textBaseline="alphabetic",s.fillText("H",0,l);var i=l-w(s.getImageData(0,0,l,l))-1+p;o.baseline=o.alphabetic=i,s.clearRect(0,0,l,l),s.textBaseline="middle",s.fillText("H",0,.5*l);var x=w(s.getImageData(0,0,l,l));o.median=o.middle=l-x-1+p-.5*l,s.clearRect(0,0,l,l),s.textBaseline="hanging",s.fillText("H",0,.5*l);var f=w(s.getImageData(0,0,l,l));o.hanging=l-f-1+p-.5*l,s.clearRect(0,0,l,l),s.textBaseline="ideographic",s.fillText("H",0,l);var _=w(s.getImageData(0,0,l,l));if(o.ideographic=l-_-1+p,h.upper&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.upper,0,0),o.upper=w(s.getImageData(0,0,l,l)),o.capHeight=o.baseline-o.upper),h.lower&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.lower,0,0),o.lower=w(s.getImageData(0,0,l,l)),o.xHeight=o.baseline-o.lower),h.tittle&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.tittle,0,0),o.tittle=w(s.getImageData(0,0,l,l))),h.ascent&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.ascent,0,0),o.ascent=w(s.getImageData(0,0,l,l))),h.descent&&(s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.descent,0,0),o.descent=y(s.getImageData(0,0,l,l))),h.overshoot){s.clearRect(0,0,l,l),s.textBaseline="top",s.fillText(h.overshoot,0,0);var b=y(s.getImageData(0,0,l,l));o.overshoot=b-i}for(var T in o)o[T]/=a;return o.em=a,d.cache[n]=o,v(o,g)}function v(e,t){var n={};for(var a in typeof t=="string"&&(t=e[t]),e)a!=="em"&&(n[a]=e[a]-t);return n}function w(e){for(var t=e.height,n=e.data,a=3;a<n.length;a+=4)if(n[a]!==0)return Math.floor(.25*(a-3)/t)}function y(e){for(var t=e.height,n=e.data,a=n.length-1;a>0;a-=4)if(n[a]!==0)return Math.floor(.25*(a-3)/t)}G.exports=d,d.canvas=document.createElement("canvas"),d.cache={}},{}],194:[function(m,G,W){G.exports=function(d,v){if(typeof d!="string")throw new TypeError("must specify type string");if(v=v||{},typeof document>"u"&&!v.canvas)return null;var w=v.canvas||document.createElement("canvas");typeof v.width=="number"&&(w.width=v.width),typeof v.height=="number"&&(w.height=v.height);var y,e=v;try{var t=[d];d.indexOf("webgl")===0&&t.push("experimental-"+d);for(var n=0;n<t.length;n++)if(y=w.getContext(t[n],e))return y}catch{y=null}return y||null}},{}],195:[function(m,G,W){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=v[4],a=v[5],r=v[6],g=v[7],u=v[8],s=v[9],h=v[10],l=v[11],o=v[12],p=v[13],c=v[14],i=v[15];return d[0]=a*(h*i-l*c)-s*(r*i-g*c)+p*(r*l-g*h),d[1]=-(y*(h*i-l*c)-s*(e*i-t*c)+p*(e*l-t*h)),d[2]=y*(r*i-g*c)-a*(e*i-t*c)+p*(e*g-t*r),d[3]=-(y*(r*l-g*h)-a*(e*l-t*h)+s*(e*g-t*r)),d[4]=-(n*(h*i-l*c)-u*(r*i-g*c)+o*(r*l-g*h)),d[5]=w*(h*i-l*c)-u*(e*i-t*c)+o*(e*l-t*h),d[6]=-(w*(r*i-g*c)-n*(e*i-t*c)+o*(e*g-t*r)),d[7]=w*(r*l-g*h)-n*(e*l-t*h)+u*(e*g-t*r),d[8]=n*(s*i-l*p)-u*(a*i-g*p)+o*(a*l-g*s),d[9]=-(w*(s*i-l*p)-u*(y*i-t*p)+o*(y*l-t*s)),d[10]=w*(a*i-g*p)-n*(y*i-t*p)+o*(y*g-t*a),d[11]=-(w*(a*l-g*s)-n*(y*l-t*s)+u*(y*g-t*a)),d[12]=-(n*(s*c-h*p)-u*(a*c-r*p)+o*(a*h-r*s)),d[13]=w*(s*c-h*p)-u*(y*c-e*p)+o*(y*h-e*s),d[14]=-(w*(a*c-r*p)-n*(y*c-e*p)+o*(y*r-e*a)),d[15]=w*(a*h-r*s)-n*(y*h-e*s)+u*(y*r-e*a),d}},{}],196:[function(m,G,W){G.exports=function(d){var v=new Float32Array(16);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v[6]=d[6],v[7]=d[7],v[8]=d[8],v[9]=d[9],v[10]=d[10],v[11]=d[11],v[12]=d[12],v[13]=d[13],v[14]=d[14],v[15]=d[15],v}},{}],197:[function(m,G,W){G.exports=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d[9]=v[9],d[10]=v[10],d[11]=v[11],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15],d}},{}],198:[function(m,G,W){G.exports=function(){var d=new Float32Array(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],199:[function(m,G,W){G.exports=function(d){var v=d[0],w=d[1],y=d[2],e=d[3],t=d[4],n=d[5],a=d[6],r=d[7],g=d[8],u=d[9],s=d[10],h=d[11],l=d[12],o=d[13],p=d[14],c=d[15];return(v*n-w*t)*(s*c-h*p)-(v*a-y*t)*(u*c-h*o)+(v*r-e*t)*(u*p-s*o)+(w*a-y*n)*(g*c-h*l)-(w*r-e*n)*(g*p-s*l)+(y*r-e*a)*(g*o-u*l)}},{}],200:[function(m,G,W){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=w+w,a=y+y,r=e+e,g=w*n,u=y*n,s=y*a,h=e*n,l=e*a,o=e*r,p=t*n,c=t*a,i=t*r;return d[0]=1-s-o,d[1]=u+i,d[2]=h-c,d[3]=0,d[4]=u-i,d[5]=1-g-o,d[6]=l+p,d[7]=0,d[8]=h+c,d[9]=l-p,d[10]=1-g-s,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],201:[function(m,G,W){G.exports=function(d,v,w){var y,e,t,n=w[0],a=w[1],r=w[2],g=Math.sqrt(n*n+a*a+r*r);return Math.abs(g)<1e-6?null:(n*=g=1/g,a*=g,r*=g,y=Math.sin(v),e=Math.cos(v),t=1-e,d[0]=n*n*t+e,d[1]=a*n*t+r*y,d[2]=r*n*t-a*y,d[3]=0,d[4]=n*a*t-r*y,d[5]=a*a*t+e,d[6]=r*a*t+n*y,d[7]=0,d[8]=n*r*t+a*y,d[9]=a*r*t-n*y,d[10]=r*r*t+e,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d)}},{}],202:[function(m,G,W){G.exports=function(d,v,w){var y=v[0],e=v[1],t=v[2],n=v[3],a=y+y,r=e+e,g=t+t,u=y*a,s=y*r,h=y*g,l=e*r,o=e*g,p=t*g,c=n*a,i=n*r,x=n*g;return d[0]=1-(l+p),d[1]=s+x,d[2]=h-i,d[3]=0,d[4]=s-x,d[5]=1-(u+p),d[6]=o+c,d[7]=0,d[8]=h+i,d[9]=o-c,d[10]=1-(u+l),d[11]=0,d[12]=w[0],d[13]=w[1],d[14]=w[2],d[15]=1,d}},{}],203:[function(m,G,W){G.exports=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=v[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=v[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],204:[function(m,G,W){G.exports=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=v[0],d[13]=v[1],d[14]=v[2],d[15]=1,d}},{}],205:[function(m,G,W){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=y,d[6]=w,d[7]=0,d[8]=0,d[9]=-w,d[10]=y,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],206:[function(m,G,W){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=y,d[1]=0,d[2]=-w,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=w,d[9]=0,d[10]=y,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],207:[function(m,G,W){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=y,d[1]=w,d[2]=0,d[3]=0,d[4]=-w,d[5]=y,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],208:[function(m,G,W){G.exports=function(d,v,w,y,e,t,n){var a=1/(w-v),r=1/(e-y),g=1/(t-n);return d[0]=2*t*a,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=2*t*r,d[6]=0,d[7]=0,d[8]=(w+v)*a,d[9]=(e+y)*r,d[10]=(n+t)*g,d[11]=-1,d[12]=0,d[13]=0,d[14]=n*t*2*g,d[15]=0,d}},{}],209:[function(m,G,W){G.exports=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],210:[function(m,G,W){G.exports={create:m("./create"),clone:m("./clone"),copy:m("./copy"),identity:m("./identity"),transpose:m("./transpose"),invert:m("./invert"),adjoint:m("./adjoint"),determinant:m("./determinant"),multiply:m("./multiply"),translate:m("./translate"),scale:m("./scale"),rotate:m("./rotate"),rotateX:m("./rotateX"),rotateY:m("./rotateY"),rotateZ:m("./rotateZ"),fromRotation:m("./fromRotation"),fromRotationTranslation:m("./fromRotationTranslation"),fromScaling:m("./fromScaling"),fromTranslation:m("./fromTranslation"),fromXRotation:m("./fromXRotation"),fromYRotation:m("./fromYRotation"),fromZRotation:m("./fromZRotation"),fromQuat:m("./fromQuat"),frustum:m("./frustum"),perspective:m("./perspective"),perspectiveFromFieldOfView:m("./perspectiveFromFieldOfView"),ortho:m("./ortho"),lookAt:m("./lookAt"),str:m("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(m,G,W){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=v[4],a=v[5],r=v[6],g=v[7],u=v[8],s=v[9],h=v[10],l=v[11],o=v[12],p=v[13],c=v[14],i=v[15],x=w*a-y*n,f=w*r-e*n,_=w*g-t*n,b=y*r-e*a,T=y*g-t*a,k=e*g-t*r,L=u*p-s*o,A=u*c-h*o,I=u*i-l*o,P=s*c-h*p,S=s*i-l*p,E=h*i-l*c,z=x*E-f*S+_*P+b*I-T*A+k*L;return z?(z=1/z,d[0]=(a*E-r*S+g*P)*z,d[1]=(e*S-y*E-t*P)*z,d[2]=(p*k-c*T+i*b)*z,d[3]=(h*T-s*k-l*b)*z,d[4]=(r*I-n*E-g*A)*z,d[5]=(w*E-e*I+t*A)*z,d[6]=(c*_-o*k-i*f)*z,d[7]=(u*k-h*_+l*f)*z,d[8]=(n*S-a*I+g*L)*z,d[9]=(y*I-w*S-t*L)*z,d[10]=(o*T-p*_+i*x)*z,d[11]=(s*_-u*T-l*x)*z,d[12]=(a*A-n*P-r*L)*z,d[13]=(w*P-y*A+e*L)*z,d[14]=(p*f-o*b-c*x)*z,d[15]=(u*b-s*f+h*x)*z,d):null}},{}],212:[function(m,G,W){var d=m("./identity");G.exports=function(v,w,y,e){var t,n,a,r,g,u,s,h,l,o,p=w[0],c=w[1],i=w[2],x=e[0],f=e[1],_=e[2],b=y[0],T=y[1],k=y[2];return Math.abs(p-b)<1e-6&&Math.abs(c-T)<1e-6&&Math.abs(i-k)<1e-6?d(v):(s=p-b,h=c-T,l=i-k,o=1/Math.sqrt(s*s+h*h+l*l),t=f*(l*=o)-_*(h*=o),n=_*(s*=o)-x*l,a=x*h-f*s,(o=Math.sqrt(t*t+n*n+a*a))?(t*=o=1/o,n*=o,a*=o):(t=0,n=0,a=0),r=h*a-l*n,g=l*t-s*a,u=s*n-h*t,(o=Math.sqrt(r*r+g*g+u*u))?(r*=o=1/o,g*=o,u*=o):(r=0,g=0,u=0),v[0]=t,v[1]=r,v[2]=s,v[3]=0,v[4]=n,v[5]=g,v[6]=h,v[7]=0,v[8]=a,v[9]=u,v[10]=l,v[11]=0,v[12]=-(t*p+n*c+a*i),v[13]=-(r*p+g*c+u*i),v[14]=-(s*p+h*c+l*i),v[15]=1,v)}},{"./identity":209}],213:[function(m,G,W){G.exports=function(d,v,w){var y=v[0],e=v[1],t=v[2],n=v[3],a=v[4],r=v[5],g=v[6],u=v[7],s=v[8],h=v[9],l=v[10],o=v[11],p=v[12],c=v[13],i=v[14],x=v[15],f=w[0],_=w[1],b=w[2],T=w[3];return d[0]=f*y+_*a+b*s+T*p,d[1]=f*e+_*r+b*h+T*c,d[2]=f*t+_*g+b*l+T*i,d[3]=f*n+_*u+b*o+T*x,f=w[4],_=w[5],b=w[6],T=w[7],d[4]=f*y+_*a+b*s+T*p,d[5]=f*e+_*r+b*h+T*c,d[6]=f*t+_*g+b*l+T*i,d[7]=f*n+_*u+b*o+T*x,f=w[8],_=w[9],b=w[10],T=w[11],d[8]=f*y+_*a+b*s+T*p,d[9]=f*e+_*r+b*h+T*c,d[10]=f*t+_*g+b*l+T*i,d[11]=f*n+_*u+b*o+T*x,f=w[12],_=w[13],b=w[14],T=w[15],d[12]=f*y+_*a+b*s+T*p,d[13]=f*e+_*r+b*h+T*c,d[14]=f*t+_*g+b*l+T*i,d[15]=f*n+_*u+b*o+T*x,d}},{}],214:[function(m,G,W){G.exports=function(d,v,w,y,e,t,n){var a=1/(v-w),r=1/(y-e),g=1/(t-n);return d[0]=-2*a,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*r,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*g,d[11]=0,d[12]=(v+w)*a,d[13]=(e+y)*r,d[14]=(n+t)*g,d[15]=1,d}},{}],215:[function(m,G,W){G.exports=function(d,v,w,y,e){var t=1/Math.tan(v/2),n=1/(y-e);return d[0]=t/w,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=t,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=(e+y)*n,d[11]=-1,d[12]=0,d[13]=0,d[14]=2*e*y*n,d[15]=0,d}},{}],216:[function(m,G,W){G.exports=function(d,v,w,y){var e=Math.tan(v.upDegrees*Math.PI/180),t=Math.tan(v.downDegrees*Math.PI/180),n=Math.tan(v.leftDegrees*Math.PI/180),a=Math.tan(v.rightDegrees*Math.PI/180),r=2/(n+a),g=2/(e+t);return d[0]=r,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=g,d[6]=0,d[7]=0,d[8]=-(n-a)*r*.5,d[9]=(e-t)*g*.5,d[10]=y/(w-y),d[11]=-1,d[12]=0,d[13]=0,d[14]=y*w/(w-y),d[15]=0,d}},{}],217:[function(m,G,W){G.exports=function(d,v,w,y){var e,t,n,a,r,g,u,s,h,l,o,p,c,i,x,f,_,b,T,k,L,A,I,P,S=y[0],E=y[1],z=y[2],D=Math.sqrt(S*S+E*E+z*z);return Math.abs(D)<1e-6?null:(S*=D=1/D,E*=D,z*=D,e=Math.sin(w),t=Math.cos(w),n=1-t,a=v[0],r=v[1],g=v[2],u=v[3],s=v[4],h=v[5],l=v[6],o=v[7],p=v[8],c=v[9],i=v[10],x=v[11],f=S*S*n+t,_=E*S*n+z*e,b=z*S*n-E*e,T=S*E*n-z*e,k=E*E*n+t,L=z*E*n+S*e,A=S*z*n+E*e,I=E*z*n-S*e,P=z*z*n+t,d[0]=a*f+s*_+p*b,d[1]=r*f+h*_+c*b,d[2]=g*f+l*_+i*b,d[3]=u*f+o*_+x*b,d[4]=a*T+s*k+p*L,d[5]=r*T+h*k+c*L,d[6]=g*T+l*k+i*L,d[7]=u*T+o*k+x*L,d[8]=a*A+s*I+p*P,d[9]=r*A+h*I+c*P,d[10]=g*A+l*I+i*P,d[11]=u*A+o*I+x*P,v!==d&&(d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d)}},{}],218:[function(m,G,W){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[4],n=v[5],a=v[6],r=v[7],g=v[8],u=v[9],s=v[10],h=v[11];return v!==d&&(d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[4]=t*e+g*y,d[5]=n*e+u*y,d[6]=a*e+s*y,d[7]=r*e+h*y,d[8]=g*e-t*y,d[9]=u*e-n*y,d[10]=s*e-a*y,d[11]=h*e-r*y,d}},{}],219:[function(m,G,W){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[0],n=v[1],a=v[2],r=v[3],g=v[8],u=v[9],s=v[10],h=v[11];return v!==d&&(d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[0]=t*e-g*y,d[1]=n*e-u*y,d[2]=a*e-s*y,d[3]=r*e-h*y,d[8]=t*y+g*e,d[9]=n*y+u*e,d[10]=a*y+s*e,d[11]=r*y+h*e,d}},{}],220:[function(m,G,W){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[0],n=v[1],a=v[2],r=v[3],g=v[4],u=v[5],s=v[6],h=v[7];return v!==d&&(d[8]=v[8],d[9]=v[9],d[10]=v[10],d[11]=v[11],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[0]=t*e+g*y,d[1]=n*e+u*y,d[2]=a*e+s*y,d[3]=r*e+h*y,d[4]=g*e-t*y,d[5]=u*e-n*y,d[6]=s*e-a*y,d[7]=h*e-r*y,d}},{}],221:[function(m,G,W){G.exports=function(d,v,w){var y=w[0],e=w[1],t=w[2];return d[0]=v[0]*y,d[1]=v[1]*y,d[2]=v[2]*y,d[3]=v[3]*y,d[4]=v[4]*e,d[5]=v[5]*e,d[6]=v[6]*e,d[7]=v[7]*e,d[8]=v[8]*t,d[9]=v[9]*t,d[10]=v[10]*t,d[11]=v[11]*t,d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15],d}},{}],222:[function(m,G,W){G.exports=function(d){return"mat4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+", "+d[9]+", "+d[10]+", "+d[11]+", "+d[12]+", "+d[13]+", "+d[14]+", "+d[15]+")"}},{}],223:[function(m,G,W){G.exports=function(d,v,w){var y,e,t,n,a,r,g,u,s,h,l,o,p=w[0],c=w[1],i=w[2];return v===d?(d[12]=v[0]*p+v[4]*c+v[8]*i+v[12],d[13]=v[1]*p+v[5]*c+v[9]*i+v[13],d[14]=v[2]*p+v[6]*c+v[10]*i+v[14],d[15]=v[3]*p+v[7]*c+v[11]*i+v[15]):(y=v[0],e=v[1],t=v[2],n=v[3],a=v[4],r=v[5],g=v[6],u=v[7],s=v[8],h=v[9],l=v[10],o=v[11],d[0]=y,d[1]=e,d[2]=t,d[3]=n,d[4]=a,d[5]=r,d[6]=g,d[7]=u,d[8]=s,d[9]=h,d[10]=l,d[11]=o,d[12]=y*p+a*c+s*i+v[12],d[13]=e*p+r*c+h*i+v[13],d[14]=t*p+g*c+l*i+v[14],d[15]=n*p+u*c+o*i+v[15]),d}},{}],224:[function(m,G,W){G.exports=function(d,v){if(d===v){var w=v[1],y=v[2],e=v[3],t=v[6],n=v[7],a=v[11];d[1]=v[4],d[2]=v[8],d[3]=v[12],d[4]=w,d[6]=v[9],d[7]=v[13],d[8]=y,d[9]=t,d[11]=v[14],d[12]=e,d[13]=n,d[14]=a}else d[0]=v[0],d[1]=v[4],d[2]=v[8],d[3]=v[12],d[4]=v[1],d[5]=v[5],d[6]=v[9],d[7]=v[13],d[8]=v[2],d[9]=v[6],d[10]=v[10],d[11]=v[14],d[12]=v[3],d[13]=v[7],d[14]=v[11],d[15]=v[15];return d}},{}],225:[function(m,G,W){var d=m("css-font"),v=m("pick-by-alias"),w=m("regl"),y=m("gl-util/context"),e=m("es6-weak-map"),t=m("color-normalize"),n=m("font-atlas"),a=m("typedarray-pool"),r=m("parse-rect"),g=m("is-plain-obj"),u=m("parse-unit"),s=m("to-px"),h=m("detect-kerning"),l=m("object-assign"),o=m("font-measure"),p=m("flatten-vertex-data"),c=m("bit-twiddle").nextPow2,i=new e,x=!1;if(document.body){var f=document.body.appendChild(document.createElement("div"));f.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(f).fontStretch&&(x=!0),document.body.removeChild(f)}var _=function(b){(function(T){return typeof T=="function"&&T._gl&&T.prop&&T.texture&&T.buffer})(b)?(b={regl:b},this.gl=b.regl._gl):this.gl=y(b),this.shader=i.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=b.regl||w({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),i.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(g(b)?b:{})};_.prototype.createShader=function(){var b=this.regl,T=b({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:b.prop("count"),offset:b.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:b.this("sizeBuffer")},width:{offset:0,stride:8,buffer:b.this("sizeBuffer")},char:b.this("charBuffer"),position:b.this("position")},uniforms:{atlasSize:function(k,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(k,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(k,L){return L.atlas.texture},charStep:function(k,L){return L.atlas.step},em:function(k,L){return L.atlas.em},color:b.prop("color"),opacity:b.prop("opacity"),viewport:b.this("viewportArray"),scale:b.this("scale"),align:b.prop("align"),baseline:b.prop("baseline"),translate:b.this("translate"),positionOffset:b.prop("positionOffset")},primitive:"points",viewport:b.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:b,draw:T,atlas:{}}},_.prototype.update=function(b){var T=this;if(typeof b=="string")b={text:b};else if(!b)return;(b=v(b,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(b.opacity)?this.opacity=b.opacity.map(function(ge){return parseFloat(ge)}):this.opacity=parseFloat(b.opacity)),b.viewport!=null&&(this.viewport=r(b.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),b.kerning!=null&&(this.kerning=b.kerning),b.offset!=null&&(typeof b.offset=="number"&&(b.offset=[b.offset,0]),this.positionOffset=p(b.offset)),b.direction&&(this.direction=b.direction),b.range&&(this.range=b.range,this.scale=[1/(b.range[2]-b.range[0]),1/(b.range[3]-b.range[1])],this.translate=[-b.range[0],-b.range[1]]),b.scale&&(this.scale=b.scale),b.translate&&(this.translate=b.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||b.font||(b.font=_.baseFontSize+"px sans-serif");var k,L=!1,A=!1;if(b.font&&(Array.isArray(b.font)?b.font:[b.font]).forEach(function(ge,Te){if(typeof ge=="string")try{ge=d.parse(ge)}catch{ge=d.parse(_.baseFontSize+"px "+ge)}else ge=d.parse(d.stringify(ge));var Se=d.stringify({size:_.baseFontSize,family:ge.family,stretch:x?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style}),Me=u(ge.size),ze=Math.round(Me[0]*s(Me[1]));if(ze!==T.fontSize[Te]&&(A=!0,T.fontSize[Te]=ze),!(T.font[Te]&&Se==T.font[Te].baseString||(L=!0,T.font[Te]=_.fonts[Se],T.font[Te]))){var Oe=ge.family.join(", "),De=[ge.style];ge.style!=ge.variant&&De.push(ge.variant),ge.variant!=ge.weight&&De.push(ge.weight),x&&ge.weight!=ge.stretch&&De.push(ge.stretch),T.font[Te]={baseString:Se,family:Oe,weight:ge.weight,stretch:ge.stretch,style:ge.style,variant:ge.variant,width:{},kerning:{},metrics:o(Oe,{origin:"top",fontSize:_.baseFontSize,fontStyle:De.join(" ")})},_.fonts[Se]=T.font[Te]}}),(L||A)&&this.font.forEach(function(ge,Te){var Se=d.stringify({size:T.fontSize[Te],family:ge.family,stretch:x?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style});if(T.fontAtlas[Te]=T.shader.atlas[Se],!T.fontAtlas[Te]){var Me=ge.metrics;T.shader.atlas[Se]=T.fontAtlas[Te]={fontString:Se,step:2*Math.ceil(T.fontSize[Te]*Me.bottom*.5),em:T.fontSize[Te],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:T.regl.texture()}}b.text==null&&(b.text=T.text)}),typeof b.text=="string"&&b.position&&b.position.length>2){for(var I=Array(.5*b.position.length),P=0;P<I.length;P++)I[P]=b.text;b.text=I}if(b.text!=null||L){if(this.textOffsets=[0],Array.isArray(b.text)){this.count=b.text[0].length,this.counts=[this.count];for(var S=1;S<b.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+b.text[S-1].length,this.count+=b.text[S].length,this.counts.push(b.text[S].length);this.text=b.text.join("")}else this.text=b.text,this.count=this.text.length,this.counts=[this.count];k=[],this.font.forEach(function(ge,Te){_.atlasContext.font=ge.baseString;for(var Se=T.fontAtlas[Te],Me=0;Me<T.text.length;Me++){var ze=T.text.charAt(Me);if(Se.ids[ze]==null&&(Se.ids[ze]=Se.chars.length,Se.chars.push(ze),k.push(ze)),ge.width[ze]==null&&(ge.width[ze]=_.atlasContext.measureText(ze).width/_.baseFontSize,T.kerning)){var Oe=[];for(var De in ge.width)Oe.push(De+ze,ze+De);l(ge.kerning,h(ge.family,{pairs:Oe}))}}})}if(b.position)if(b.position.length>2){for(var E=!b.position[0].length,z=a.mallocFloat(2*this.count),D=0,j=0;D<this.counts.length;D++){var V=this.counts[D];if(E)for(var Z=0;Z<V;Z++)z[j++]=b.position[2*D],z[j++]=b.position[2*D+1];else for(var Q=0;Q<V;Q++)z[j++]=b.position[D][0],z[j++]=b.position[D][1]}this.position.call?this.position({type:"float",data:z}):this.position=this.regl.buffer({type:"float",data:z}),a.freeFloat(z)}else this.position.destroy&&this.position.destroy(),this.position={constant:b.position};if(b.text||L){var K=a.mallocUint8(this.count),$=a.mallocFloat(2*this.count);this.textWidth=[];for(var ne=0,H=0;ne<this.counts.length;ne++){for(var N=this.counts[ne],U=this.font[ne]||this.font[0],te=this.fontAtlas[ne]||this.fontAtlas[0],B=0;B<N;B++){var X=this.text.charAt(H),J=this.text.charAt(H-1);if(K[H]=te.ids[X],$[2*H]=U.width[X],B){var ee=$[2*H-2],re=$[2*H],se=$[2*H-1]+.5*ee+.5*re;if(this.kerning){var oe=U.kerning[J+X];oe&&(se+=.001*oe)}$[2*H+1]=se}else $[2*H+1]=.5*$[2*H];H++}this.textWidth.push($.length?.5*$[2*H-2]+$[2*H-1]:0)}b.align||(b.align=this.align),this.charBuffer({data:K,type:"uint8",usage:"stream"}),this.sizeBuffer({data:$,type:"float",usage:"stream"}),a.freeUint8(K),a.freeFloat($),k.length&&this.font.forEach(function(ge,Te){var Se=T.fontAtlas[Te],Me=Se.step,ze=Math.floor(_.maxAtlasSize/Me),Oe=Math.min(ze,Se.chars.length),De=Math.ceil(Se.chars.length/Oe),Xe=c(Oe*Me),Be=c(De*Me);Se.width=Xe,Se.height=Be,Se.rows=De,Se.cols=Oe,Se.em&&Se.texture({data:n({canvas:_.atlasCanvas,font:Se.fontString,chars:Se.chars,shape:[Xe,Be],step:[Me,Me]})})})}if(b.align&&(this.align=b.align,this.alignOffset=this.textWidth.map(function(ge,Te){var Se=Array.isArray(T.align)?T.align.length>1?T.align[Te]:T.align[0]:T.align;if(typeof Se=="number")return Se;switch(Se){case"right":case"end":return-ge;case"center":case"centre":case"middle":return .5*-ge}return 0})),this.baseline==null&&b.baseline==null&&(b.baseline=0),b.baseline!=null&&(this.baseline=b.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ge,Te){var Se=(T.font[Te]||T.font[0]).metrics,Me=0;return Me+=.5*Se.bottom,Me+=typeof ge=="number"?ge-Se.baseline:-Se[ge],Me*=-1})),b.color!=null)if(b.color||(b.color="transparent"),typeof b.color!="string"&&isNaN(b.color)){var de;if(typeof b.color[0]=="number"&&b.color.length>this.counts.length){var ce=b.color.length;de=a.mallocUint8(ce);for(var ve=(b.color.subarray||b.color.slice).bind(b.color),Ae=0;Ae<ce;Ae+=4)de.set(t(ve(Ae,Ae+4),"uint8"),Ae)}else{var fe=b.color.length;de=a.mallocUint8(4*fe);for(var me=0;me<fe;me++)de.set(t(b.color[me]||0,"uint8"),4*me)}this.color=de}else this.color=t(b.color,"uint8");if(b.position||b.text||b.color||b.baseline||b.align||b.font||b.offset||b.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var _e=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(_e);for(var le=0;le<this.batch.length;le++)this.batch[le]={count:this.counts.length>1?this.counts[le]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[le]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*le,4*le+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[le]:this.opacity,baseline:this.baselineOffset[le]!=null?this.baselineOffset[le]:this.baselineOffset[0],align:this.align?this.alignOffset[le]!=null?this.alignOffset[le]:this.alignOffset[0]:0,atlas:this.fontAtlas[le]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*le,2*le+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={},G.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(m,G,W){(function(d){(function(){var v=m("pick-by-alias");function w(t){if(t.container)if(t.container==document.body)document.body.style.width||(t.canvas.width=t.width||t.pixelRatio*d.innerWidth),document.body.style.height||(t.canvas.height=t.height||t.pixelRatio*d.innerHeight);else{var n=t.container.getBoundingClientRect();t.canvas.width=t.width||n.right-n.left,t.canvas.height=t.height||n.bottom-n.top}}function y(t){return typeof t.getContext=="function"&&"width"in t&&"height"in t}function e(){var t=document.createElement("canvas");return t.style.position="absolute",t.style.top=0,t.style.left=0,t}G.exports=function(t){var n;if(t?typeof t=="string"&&(t={container:t}):t={},y(t)?t={container:t}:t=typeof(n=t).nodeName=="string"&&typeof n.appendChild=="function"&&typeof n.getBoundingClientRect=="function"?{container:t}:function(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}(t)?{gl:t}:v(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=d.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var a=document.querySelector(t.container);if(!a)throw Error("Element "+t.container+" is not found");t.container=a}y(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=e(),t.container.appendChild(t.canvas),w(t))}else if(!t.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");t.container=document.body||document.documentElement,t.canvas=e(),t.container.appendChild(t.canvas),w(t)}return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(r){try{t.gl=t.canvas.getContext(r,t.attrs)}catch{}return t.gl}),t.gl}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(m,G,W){G.exports=function(d){typeof d=="string"&&(d=[d]);for(var v=[].slice.call(arguments,1),w=[],y=0;y<d.length-1;y++)w.push(d[y],v[y]||"");return w.push(d[y]),w.join("")}},{}],228:[function(m,G,W){(function(d){(function(){var v,w=m("is-browser");v=typeof d.matchMedia=="function"?!d.matchMedia("(hover: none)").matches:w,G.exports=v}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(m,G,W){var d=m("is-browser");G.exports=d&&function(){var v=!1;try{var w=Object.defineProperty({},"passive",{get:function(){v=!0}});window.addEventListener("test",null,w),window.removeEventListener("test",null,w)}catch{v=!1}return v}()},{"is-browser":232}],230:[function(m,G,W){W.read=function(d,v,w,y,e){var t,n,a=8*e-y-1,r=(1<<a)-1,g=r>>1,u=-7,s=w?e-1:0,h=w?-1:1,l=d[v+s];for(s+=h,t=l&(1<<-u)-1,l>>=-u,u+=a;u>0;t=256*t+d[v+s],s+=h,u-=8);for(n=t&(1<<-u)-1,t>>=-u,u+=y;u>0;n=256*n+d[v+s],s+=h,u-=8);if(t===0)t=1-g;else{if(t===r)return n?NaN:1/0*(l?-1:1);n+=Math.pow(2,y),t-=g}return(l?-1:1)*n*Math.pow(2,t-y)},W.write=function(d,v,w,y,e,t){var n,a,r,g=8*t-e-1,u=(1<<g)-1,s=u>>1,h=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=y?0:t-1,o=y?1:-1,p=v<0||v===0&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(a=isNaN(v)?1:0,n=u):(n=Math.floor(Math.log(v)/Math.LN2),v*(r=Math.pow(2,-n))<1&&(n--,r*=2),(v+=n+s>=1?h/r:h*Math.pow(2,1-s))*r>=2&&(n++,r/=2),n+s>=u?(a=0,n=u):n+s>=1?(a=(v*r-1)*Math.pow(2,e),n+=s):(a=v*Math.pow(2,s-1)*Math.pow(2,e),n=0));e>=8;d[w+l]=255&a,l+=o,a/=256,e-=8);for(n=n<<e|a,g+=e;g>0;d[w+l]=255&n,l+=o,n/=256,g-=8);d[w+l-o]|=128*p}},{}],231:[function(m,G,W){typeof Object.create=="function"?G.exports=function(d,v){v&&(d.super_=v,d.prototype=Object.create(v.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}))}:G.exports=function(d,v){if(v){d.super_=v;var w=function(){};w.prototype=v.prototype,d.prototype=new w,d.prototype.constructor=d}}},{}],232:[function(m,G,W){G.exports=!0},{}],233:[function(m,G,W){G.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(m,G,W){G.exports=w,G.exports.isMobile=w,G.exports.default=w;var d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,v=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function w(y){y||(y={});var e=y.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var t=y.tablet?v.test(e):d.test(e);return!t&&y.tablet&&y.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}},{}],235:[function(m,G,W){G.exports=function(d){var v=typeof d;return d!==null&&(v==="object"||v==="function")}},{}],236:[function(m,G,W){var d=Object.prototype.toString;G.exports=function(v){var w;return d.call(v)==="[object Object]"&&((w=Object.getPrototypeOf(v))===null||w===Object.getPrototypeOf({}))}},{}],237:[function(m,G,W){G.exports=function(d){for(var v,w=d.length,y=0;y<w;y++)if(((v=d.charCodeAt(y))<9||v>13)&&v!==32&&v!==133&&v!==160&&v!==5760&&v!==6158&&(v<8192||v>8205)&&v!==8232&&v!==8233&&v!==8239&&v!==8287&&v!==8288&&v!==12288&&v!==65279)return!1;return!0}},{}],238:[function(m,G,W){G.exports=function(d){return typeof d=="string"&&(d=d.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(d)&&/[\dz]$/i.test(d)&&d.length>4))}},{}],239:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?G.exports=v():(d=d||self).mapboxgl=v()})(this,function(){var d,v,w;function y(e,t){if(d)if(v){var n="var sharedChunk = {}; ("+d+")(sharedChunk); ("+v+")(sharedChunk);",a={};d(a),(w=t(a)).workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}else v=t;else d=t}return y(0,function(e){function t(M,O){return M(O={exports:{}},O.exports),O.exports}var n=a;function a(M,O,Y,ie){this.cx=3*M,this.bx=3*(Y-M)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ie-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=M,this.p1y=ie,this.p2x=Y,this.p2y=ie}a.prototype.sampleCurveX=function(M){return((this.ax*M+this.bx)*M+this.cx)*M},a.prototype.sampleCurveY=function(M){return((this.ay*M+this.by)*M+this.cy)*M},a.prototype.sampleCurveDerivativeX=function(M){return(3*this.ax*M+2*this.bx)*M+this.cx},a.prototype.solveCurveX=function(M,O){var Y,ie,ye,we,Ce;for(O===void 0&&(O=1e-6),ye=M,Ce=0;Ce<8;Ce++){if(we=this.sampleCurveX(ye)-M,Math.abs(we)<O)return ye;var je=this.sampleCurveDerivativeX(ye);if(Math.abs(je)<1e-6)break;ye-=we/je}if((ye=M)<(Y=0))return Y;if(ye>(ie=1))return ie;for(;Y<ie;){if(we=this.sampleCurveX(ye),Math.abs(we-M)<O)return ye;M>we?Y=ye:ie=ye,ye=.5*(ie-Y)+Y}return ye},a.prototype.solve=function(M,O){return this.sampleCurveY(this.solveCurveX(M,O))};var r=g;function g(M,O){this.x=M,this.y=O}function u(M,O,Y,ie){var ye=new n(M,O,Y,ie);return function(we){return ye.solve(we)}}g.prototype={clone:function(){return new g(this.x,this.y)},add:function(M){return this.clone()._add(M)},sub:function(M){return this.clone()._sub(M)},multByPoint:function(M){return this.clone()._multByPoint(M)},divByPoint:function(M){return this.clone()._divByPoint(M)},mult:function(M){return this.clone()._mult(M)},div:function(M){return this.clone()._div(M)},rotate:function(M){return this.clone()._rotate(M)},rotateAround:function(M,O){return this.clone()._rotateAround(M,O)},matMult:function(M){return this.clone()._matMult(M)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(M){return this.x===M.x&&this.y===M.y},dist:function(M){return Math.sqrt(this.distSqr(M))},distSqr:function(M){var O=M.x-this.x,Y=M.y-this.y;return O*O+Y*Y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(M){return Math.atan2(this.y-M.y,this.x-M.x)},angleWith:function(M){return this.angleWithSep(M.x,M.y)},angleWithSep:function(M,O){return Math.atan2(this.x*O-this.y*M,this.x*M+this.y*O)},_matMult:function(M){var O=M[0]*this.x+M[1]*this.y,Y=M[2]*this.x+M[3]*this.y;return this.x=O,this.y=Y,this},_add:function(M){return this.x+=M.x,this.y+=M.y,this},_sub:function(M){return this.x-=M.x,this.y-=M.y,this},_mult:function(M){return this.x*=M,this.y*=M,this},_div:function(M){return this.x/=M,this.y/=M,this},_multByPoint:function(M){return this.x*=M.x,this.y*=M.y,this},_divByPoint:function(M){return this.x/=M.x,this.y/=M.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var M=this.y;return this.y=this.x,this.x=-M,this},_rotate:function(M){var O=Math.cos(M),Y=Math.sin(M),ie=O*this.x-Y*this.y,ye=Y*this.x+O*this.y;return this.x=ie,this.y=ye,this},_rotateAround:function(M,O){var Y=Math.cos(M),ie=Math.sin(M),ye=O.x+Y*(this.x-O.x)-ie*(this.y-O.y),we=O.y+ie*(this.x-O.x)+Y*(this.y-O.y);return this.x=ye,this.y=we,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},g.convert=function(M){return M instanceof g?M:Array.isArray(M)?new g(M[0],M[1]):M};var s=u(.25,.1,.25,1);function h(M,O,Y){return Math.min(Y,Math.max(O,M))}function l(M,O,Y){var ie=Y-O,ye=((M-O)%ie+ie)%ie+O;return ye===O?Y:ye}function o(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ie=0,ye=O;ie<ye.length;ie+=1){var we=ye[ie];for(var Ce in we)M[Ce]=we[Ce]}return M}var p=1;function c(){return p++}function i(){return function M(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,M)}()}function x(M){return!!M&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(M)}function f(M,O){M.forEach(function(Y){O[Y]&&(O[Y]=O[Y].bind(O))})}function _(M,O){return M.indexOf(O,M.length-O.length)!==-1}function b(M,O,Y){var ie={};for(var ye in M)ie[ye]=O.call(Y||this,M[ye],ye,M);return ie}function T(M,O,Y){var ie={};for(var ye in M)O.call(Y||this,M[ye],ye,M)&&(ie[ye]=M[ye]);return ie}function k(M){return Array.isArray(M)?M.map(k):typeof M=="object"&&M?b(M,k):M}var L={};function A(M){L[M]||(typeof console<"u"&&console.warn(M),L[M]=!0)}function I(M,O,Y){return(Y.y-M.y)*(O.x-M.x)>(O.y-M.y)*(Y.x-M.x)}function P(M){for(var O=0,Y=0,ie=M.length,ye=ie-1,we=void 0,Ce=void 0;Y<ie;ye=Y++)we=M[Y],O+=((Ce=M[ye]).x-we.x)*(we.y+Ce.y);return O}function S(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function E(M){var O={};if(M.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ie,ye,we,Ce){var je=we||Ce;return O[ye]=!je||je.toLowerCase(),""}),O["max-age"]){var Y=parseInt(O["max-age"],10);isNaN(Y)?delete O["max-age"]:O["max-age"]=Y}return O}var z=null;function D(M){if(z==null){var O=M.navigator?M.navigator.userAgent:null;z=!!M.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return z}function j(M){try{var O=self[M];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch{return!1}}var V,Z,Q,K,$=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),ne=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,H=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,N={now:$,frame:function(M){var O=ne(M);return{cancel:function(){return H(O)}}},getImageData:function(M,O){O===void 0&&(O=0);var Y=self.document.createElement("canvas"),ie=Y.getContext("2d");if(!ie)throw new Error("failed to create canvas 2d context");return Y.width=M.width,Y.height=M.height,ie.drawImage(M,0,0,M.width,M.height),ie.getImageData(-O,-O,M.width+2*O,M.height+2*O)},resolveURL:function(M){return V||(V=self.document.createElement("a")),V.href=M,V.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(Z==null&&(Z=self.matchMedia("(prefers-reduced-motion: reduce)")),Z.matches)}},U={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},te={supported:!1,testSupport:function(M){B||!K||(X?J(M):Q=M)}},B=!1,X=!1;function J(M){var O=M.createTexture();M.bindTexture(M.TEXTURE_2D,O);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,K),M.isContextLost())return;te.supported=!0}catch{}M.deleteTexture(O),B=!0}self.document&&((K=self.document.createElement("img")).onload=function(){Q&&J(Q),Q=null,X=!0},K.onerror=function(){B=!0,Q=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ee="01",re=function(M,O){this._transformRequestFn=M,this._customAccessToken=O,this._createSkuToken()};function se(M){return M.indexOf("mapbox:")===0}re.prototype._createSkuToken=function(){var M=function(){for(var O="",Y=0;Y<10;Y++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ee,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=M.token,this._skuTokenExpiresAt=M.tokenExpiresAt},re.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},re.prototype.transformRequest=function(M,O){return this._transformRequestFn&&this._transformRequestFn(M,O)||{url:M}},re.prototype.normalizeStyleURL=function(M,O){if(!se(M))return M;var Y=ve(M);return Y.path="/styles/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},re.prototype.normalizeGlyphsURL=function(M,O){if(!se(M))return M;var Y=ve(M);return Y.path="/fonts/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},re.prototype.normalizeSourceURL=function(M,O){if(!se(M))return M;var Y=ve(M);return Y.path="/v4/"+Y.authority+".json",Y.params.push("secure"),this._makeAPIURL(Y,this._customAccessToken||O)},re.prototype.normalizeSpriteURL=function(M,O,Y,ie){var ye=ve(M);return se(M)?(ye.path="/styles/v1"+ye.path+"/sprite"+O+Y,this._makeAPIURL(ye,this._customAccessToken||ie)):(ye.path+=""+O+Y,Ae(ye))},re.prototype.normalizeTileURL=function(M,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),M&&!se(M))return M;var Y=ve(M),ie=N.devicePixelRatio>=2||O===512?"@2x":"",ye=te.supported?".webp":"$1";Y.path=Y.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+ie+ye),Y.path=Y.path.replace(/^.+\/v4\//,"/"),Y.path="/v4"+Y.path;var we=this._customAccessToken||function(Ce){for(var je=0,tt=Ce;je<tt.length;je+=1){var ft=tt[je].match(/^access_token=(.*)$/);if(ft)return ft[1]}return null}(Y.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&we&&this._skuToken&&Y.params.push("sku="+this._skuToken),this._makeAPIURL(Y,we)},re.prototype.canonicalizeTileURL=function(M,O){var Y=ve(M);if(!Y.path.match(/(^\/v4\/)/)||!Y.path.match(/\.[\w]+$/))return M;var ie="mapbox://tiles/";ie+=Y.path.replace("/v4/","");var ye=Y.params;return O&&(ye=ye.filter(function(we){return!we.match(/^access_token=/)})),ye.length&&(ie+="?"+ye.join("&")),ie},re.prototype.canonicalizeTileset=function(M,O){for(var Y=!!O&&se(O),ie=[],ye=0,we=M.tiles||[];ye<we.length;ye+=1){var Ce=we[ye];de(Ce)?ie.push(this.canonicalizeTileURL(Ce,Y)):ie.push(Ce)}return ie},re.prototype._makeAPIURL=function(M,O){var Y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ie=ve(U.API_URL);if(M.protocol=ie.protocol,M.authority=ie.authority,ie.path!=="/"&&(M.path=""+ie.path+M.path),!U.REQUIRE_ACCESS_TOKEN)return Ae(M);if(!(O=O||U.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Y);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Y);return M.params=M.params.filter(function(ye){return ye.indexOf("access_token")===-1}),M.params.push("access_token="+O),Ae(M)};var oe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(M){return oe.test(M)}var ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(M){var O=M.match(ce);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function Ae(M){var O=M.params.length?"?"+M.params.join("&"):"";return M.protocol+"://"+M.authority+M.path+O}function fe(M){if(!M)return null;var O,Y=M.split(".");if(!Y||Y.length!==3)return null;try{return JSON.parse((O=Y[1],decodeURIComponent(self.atob(O).split("").map(function(ie){return"%"+("00"+ie.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch{return null}}var me=function(M){this.type=M,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};me.prototype.getStorageKey=function(M){var O,Y=fe(U.ACCESS_TOKEN),ie="";return Y&&Y.u?(O=Y.u,ie=self.btoa(encodeURIComponent(O).replace(/%([0-9A-F]{2})/g,function(ye,we){return String.fromCharCode(Number("0x"+we))}))):ie=U.ACCESS_TOKEN||"",M?"mapbox.eventData."+M+":"+ie:"mapbox.eventData:"+ie},me.prototype.fetchEventData=function(){var M=j("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(M)try{var ie=self.localStorage.getItem(O);ie&&(this.eventData=JSON.parse(ie));var ye=self.localStorage.getItem(Y);ye&&(this.anonId=ye)}catch{A("Unable to read from LocalStorage")}},me.prototype.saveEventData=function(){var M=j("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(M)try{self.localStorage.setItem(Y,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{A("Unable to write to LocalStorage")}},me.prototype.processRequests=function(M){},me.prototype.postEvent=function(M,O,Y,ie){var ye=this;if(U.EVENTS_URL){var we=ve(U.EVENTS_URL);we.params.push("access_token="+(ie||U.ACCESS_TOKEN||""));var Ce={event:this.type,created:new Date(M).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ee,userId:this.anonId},je=O?o(Ce,O):Ce,tt={url:Ae(we),headers:{"Content-Type":"text/plain"},body:JSON.stringify([je])};this.pendingRequest=Nt(tt,function(ft){ye.pendingRequest=null,Y(ft),ye.saveEventData(),ye.processRequests(ie)})}},me.prototype.queueRequest=function(M,O){this.queue.push(M),this.processRequests(O)};var _e,le,ge=function(M){function O(){M.call(this,"map.load"),this.success={},this.skuToken=""}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postMapLoadEvent=function(Y,ie,ye,we){this.skuToken=ye,(U.EVENTS_URL&&we||U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(Ce){return se(Ce)||de(Ce)}))&&this.queueRequest({id:ie,timestamp:Date.now()},we)},O.prototype.processRequests=function(Y){var ie=this;if(!this.pendingRequest&&this.queue.length!==0){var ye=this.queue.shift(),we=ye.id,Ce=ye.timestamp;we&&this.success[we]||(this.anonId||this.fetchEventData(),x(this.anonId)||(this.anonId=i()),this.postEvent(Ce,{skuToken:this.skuToken},function(je){je||we&&(ie.success[we]=!0)},Y))}},O}(me),Te=new(function(M){function O(Y){M.call(this,"appUserTurnstile"),this._customAccessToken=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postTurnstileEvent=function(Y,ie){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(ye){return se(ye)||de(ye)})&&this.queueRequest(Date.now(),ie)},O.prototype.processRequests=function(Y){var ie=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var ye=fe(U.ACCESS_TOKEN),we=ye?ye.u:U.ACCESS_TOKEN,Ce=we!==this.eventData.tokenU;x(this.anonId)||(this.anonId=i(),Ce=!0);var je=this.queue.shift();if(this.eventData.lastSuccess){var tt=new Date(this.eventData.lastSuccess),ft=new Date(je),gt=(je-this.eventData.lastSuccess)/864e5;Ce=Ce||gt>=1||gt<-1||tt.getDate()!==ft.getDate()}else Ce=!0;if(!Ce)return this.processRequests();this.postEvent(je,{"enabled.telemetry":!1},function(Bt){Bt||(ie.eventData.lastSuccess=je,ie.eventData.tokenU=we)},Y)}},O}(me)),Se=Te.postTurnstileEvent.bind(Te),Me=new ge,ze=Me.postMapLoadEvent.bind(Me),Oe=500,De=50;function Xe(){self.caches&&!_e&&(_e=self.caches.open("mapbox-tiles"))}function Be(M,O,Y){if(Xe(),_e){var ie={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(we,Ce){return ie.headers.set(Ce,we)});var ye=E(O.headers.get("Cache-Control")||"");ye["no-store"]||(ye["max-age"]&&ie.headers.set("Expires",new Date(Y+1e3*ye["max-age"]).toUTCString()),new Date(ie.headers.get("Expires")).getTime()-Y<42e4||function(we,Ce){if(le===void 0)try{new Response(new ReadableStream),le=!0}catch{le=!1}le?Ce(we.body):we.blob().then(Ce)}(O,function(we){var Ce=new self.Response(we,ie);Xe(),_e&&_e.then(function(je){return je.put(Ie(M.url),Ce)}).catch(function(je){return A(je.message)})}))}}function Ie(M){var O=M.indexOf("?");return O<0?M:M.slice(0,O)}function Re(M,O){if(Xe(),!_e)return O(null);var Y=Ie(M.url);_e.then(function(ie){ie.match(Y).then(function(ye){var we=function(Ce){if(!Ce)return!1;var je=new Date(Ce.headers.get("Expires")||0),tt=E(Ce.headers.get("Cache-Control")||"");return je>Date.now()&&!tt["no-cache"]}(ye);ie.delete(Y),we&&ie.put(Y,ye.clone()),O(null,ye,we)}).catch(O)}).catch(O)}var Ye,Qe=1/0;function lt(){return Ye==null&&(Ye=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ye}var xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xt);var wt=function(M){function O(Y,ie,ye){ie===401&&de(ye)&&(Y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),M.call(this,Y),this.status=ie,this.url=ye,this.name=this.constructor.name,this.message=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),bt=S()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function nt(M,O){var Y,ie=new self.AbortController,ye=new self.Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,referrer:bt(),signal:ie.signal}),we=!1,Ce=!1,je=(Y=ye.url).indexOf("sku=")>0&&de(Y);M.type==="json"&&ye.headers.set("Accept","application/json");var tt=function(gt,Bt,Xt){if(!Ce){if(gt&&gt.message!=="SecurityError"&&A(gt),Bt&&Xt)return ft(Bt);var Yt=Date.now();self.fetch(ye).then(function(sr){if(sr.ok){var br=je?sr.clone():null;return ft(sr,br,Yt)}return O(new wt(sr.statusText,sr.status,M.url))}).catch(function(sr){sr.code!==20&&O(new Error(sr.message))})}},ft=function(gt,Bt,Xt){(M.type==="arrayBuffer"?gt.arrayBuffer():M.type==="json"?gt.json():gt.text()).then(function(Yt){Ce||(Bt&&Xt&&Be(ye,Bt,Xt),we=!0,O(null,Yt,gt.headers.get("Cache-Control"),gt.headers.get("Expires")))}).catch(function(Yt){Ce||O(new Error(Yt.message))})};return je?Re(ye,tt):tt(null,null),{cancel:function(){Ce=!0,we||ie.abort()}}}var $e=function(M,O){if(Y=M.url,!(/^file:/.test(Y)||/^file:/.test(bt())&&!/^\w+:/.test(Y))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return nt(M,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",M,O,void 0,!0)}var Y;return function(ie,ye){var we=new self.XMLHttpRequest;for(var Ce in we.open(ie.method||"GET",ie.url,!0),ie.type==="arrayBuffer"&&(we.responseType="arraybuffer"),ie.headers)we.setRequestHeader(Ce,ie.headers[Ce]);return ie.type==="json"&&(we.responseType="text",we.setRequestHeader("Accept","application/json")),we.withCredentials=ie.credentials==="include",we.onerror=function(){ye(new Error(we.statusText))},we.onload=function(){if((we.status>=200&&we.status<300||we.status===0)&&we.response!==null){var je=we.response;if(ie.type==="json")try{je=JSON.parse(we.response)}catch(tt){return ye(tt)}ye(null,je,we.getResponseHeader("Cache-Control"),we.getResponseHeader("Expires"))}else ye(new wt(we.statusText,we.status,ie.url))},we.send(ie.body),{cancel:function(){return we.abort()}}}(M,O)},vt=function(M,O){return $e(o(M,{type:"arrayBuffer"}),O)},Nt=function(M,O){return $e(o(M,{method:"POST"}),O)},qt,Jt;qt=[],Jt=0;var Wt=function(M,O){if(te.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),Jt>=U.MAX_PARALLEL_IMAGE_REQUESTS){var Y={requestParameters:M,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return qt.push(Y),Y}Jt++;var ie=!1,ye=function(){if(!ie)for(ie=!0,Jt--;qt.length&&Jt<U.MAX_PARALLEL_IMAGE_REQUESTS;){var Ce=qt.shift(),je=Ce.requestParameters,tt=Ce.callback;Ce.cancelled||(Ce.cancel=Wt(je,tt).cancel)}},we=vt(M,function(Ce,je,tt,ft){ye(),Ce?O(Ce):je&&(lt()?function(gt,Bt){var Xt=new self.Blob([new Uint8Array(gt)],{type:"image/png"});self.createImageBitmap(Xt).then(function(Yt){Bt(null,Yt)}).catch(function(Yt){Bt(new Error("Could not load image because of "+Yt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(je,O):function(gt,Bt,Xt,Yt){var sr=new self.Image,br=self.URL;sr.onload=function(){Bt(null,sr),br.revokeObjectURL(sr.src)},sr.onerror=function(){return Bt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ir=new self.Blob([new Uint8Array(gt)],{type:"image/png"});sr.cacheControl=Xt,sr.expires=Yt,sr.src=gt.byteLength?br.createObjectURL(Ir):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(je,O,tt,ft))});return{cancel:function(){we.cancel(),ye()}}};function ar(M,O,Y){Y[M]&&Y[M].indexOf(O)!==-1||(Y[M]=Y[M]||[],Y[M].push(O))}function Dt(M,O,Y){if(Y&&Y[M]){var ie=Y[M].indexOf(O);ie!==-1&&Y[M].splice(ie,1)}}var Ne=function(M,O){O===void 0&&(O={}),o(this,O),this.type=M},qe=function(M){function O(Y,ie){ie===void 0&&(ie={}),M.call(this,"error",o({error:Y},ie))}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ne),pe=function(){};pe.prototype.on=function(M,O){return this._listeners=this._listeners||{},ar(M,O,this._listeners),this},pe.prototype.off=function(M,O){return Dt(M,O,this._listeners),Dt(M,O,this._oneTimeListeners),this},pe.prototype.once=function(M,O){return this._oneTimeListeners=this._oneTimeListeners||{},ar(M,O,this._oneTimeListeners),this},pe.prototype.fire=function(M,O){typeof M=="string"&&(M=new Ne(M,O||{}));var Y=M.type;if(this.listens(Y)){M.target=this;for(var ie=0,ye=this._listeners&&this._listeners[Y]?this._listeners[Y].slice():[];ie<ye.length;ie+=1)ye[ie].call(this,M);for(var we=0,Ce=this._oneTimeListeners&&this._oneTimeListeners[Y]?this._oneTimeListeners[Y].slice():[];we<Ce.length;we+=1){var je=Ce[we];Dt(Y,je,this._oneTimeListeners),je.call(this,M)}var tt=this._eventedParent;tt&&(o(M,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),tt.fire(M))}else M instanceof qe&&console.error(M.error);return this},pe.prototype.listens=function(M){return this._listeners&&this._listeners[M]&&this._listeners[M].length>0||this._oneTimeListeners&&this._oneTimeListeners[M]&&this._oneTimeListeners[M].length>0||this._eventedParent&&this._eventedParent.listens(M)},pe.prototype.setEventedParent=function(M,O){return this._eventedParent=M,this._eventedParentData=O,this};var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Fe=function(M,O,Y,ie){this.message=(M?M+": ":"")+Y,ie&&(this.identifier=ie),O!=null&&O.__line__&&(this.line=O.__line__)};function Ve(M){var O=M.key,Y=M.value;return Y?[new Fe(O,Y,"constants have been deprecated as of v8")]:[]}function Ke(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ie=0,ye=O;ie<ye.length;ie+=1){var we=ye[ie];for(var Ce in we)M[Ce]=we[Ce]}return M}function Ge(M){return M instanceof Number||M instanceof String||M instanceof Boolean?M.valueOf():M}function ct(M){if(Array.isArray(M))return M.map(ct);if(M instanceof Object&&!(M instanceof Number||M instanceof String||M instanceof Boolean)){var O={};for(var Y in M)O[Y]=ct(M[Y]);return O}return Ge(M)}var st=function(M){function O(Y,ie){M.call(this,ie),this.message=ie,this.key=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Error),Mt=function(M,O){O===void 0&&(O=[]),this.parent=M,this.bindings={};for(var Y=0,ie=O;Y<ie.length;Y+=1){var ye=ie[Y],we=ye[0],Ce=ye[1];this.bindings[we]=Ce}};Mt.prototype.concat=function(M){return new Mt(this,M)},Mt.prototype.get=function(M){if(this.bindings[M])return this.bindings[M];if(this.parent)return this.parent.get(M);throw new Error(M+" not found in scope.")},Mt.prototype.has=function(M){return!!this.bindings[M]||!!this.parent&&this.parent.has(M)};var Ot={kind:"null"},it={kind:"number"},ht={kind:"string"},jt={kind:"boolean"},kt={kind:"color"},Pt={kind:"object"},Ee={kind:"value"},Ze={kind:"collator"},at={kind:"formatted"},pt={kind:"resolvedImage"};function St(M,O){return{kind:"array",itemType:M,N:O}}function Ut(M){if(M.kind==="array"){var O=Ut(M.itemType);return typeof M.N=="number"?"array<"+O+", "+M.N+">":M.itemType.kind==="value"?"array":"array<"+O+">"}return M.kind}var Kt=[Ot,it,ht,jt,kt,at,Pt,St(Ee),pt];function Ht(M,O){if(O.kind==="error")return null;if(M.kind==="array"){if(O.kind==="array"&&(O.N===0&&O.itemType.kind==="value"||!Ht(M.itemType,O.itemType))&&(typeof M.N!="number"||M.N===O.N))return null}else{if(M.kind===O.kind)return null;if(M.kind==="value"){for(var Y=0,ie=Kt;Y<ie.length;Y+=1)if(!Ht(ie[Y],O))return null}}return"Expected "+Ut(M)+" but found "+Ut(O)+" instead."}function pr(M,O){return O.some(function(Y){return Y.kind===M.kind})}function Mr(M,O){return O.some(function(Y){return Y==="null"?M===null:Y==="array"?Array.isArray(M):Y==="object"?M&&!Array.isArray(M)&&typeof M=="object":Y===typeof M})}var hr=t(function(M,O){var Y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ie(tt){return(tt=Math.round(tt))<0?0:tt>255?255:tt}function ye(tt){return tt<0?0:tt>1?1:tt}function we(tt){return tt[tt.length-1]==="%"?ie(parseFloat(tt)/100*255):ie(parseInt(tt))}function Ce(tt){return tt[tt.length-1]==="%"?ye(parseFloat(tt)/100):ye(parseFloat(tt))}function je(tt,ft,gt){return gt<0?gt+=1:gt>1&&(gt-=1),6*gt<1?tt+(ft-tt)*gt*6:2*gt<1?ft:3*gt<2?tt+(ft-tt)*(2/3-gt)*6:tt}try{O.parseCSSColor=function(tt){var ft,gt=tt.replace(/ /g,"").toLowerCase();if(gt in Y)return Y[gt].slice();if(gt[0]==="#")return gt.length===4?(ft=parseInt(gt.substr(1),16))>=0&&ft<=4095?[(3840&ft)>>4|(3840&ft)>>8,240&ft|(240&ft)>>4,15&ft|(15&ft)<<4,1]:null:gt.length===7&&(ft=parseInt(gt.substr(1),16))>=0&&ft<=16777215?[(16711680&ft)>>16,(65280&ft)>>8,255&ft,1]:null;var Bt=gt.indexOf("("),Xt=gt.indexOf(")");if(Bt!==-1&&Xt+1===gt.length){var Yt=gt.substr(0,Bt),sr=gt.substr(Bt+1,Xt-(Bt+1)).split(","),br=1;switch(Yt){case"rgba":if(sr.length!==4)return null;br=Ce(sr.pop());case"rgb":return sr.length!==3?null:[we(sr[0]),we(sr[1]),we(sr[2]),br];case"hsla":if(sr.length!==4)return null;br=Ce(sr.pop());case"hsl":if(sr.length!==3)return null;var Ir=(parseFloat(sr[0])%360+360)%360/360,Pr=Ce(sr[1]),Vr=Ce(sr[2]),Hr=Vr<=.5?Vr*(Pr+1):Vr+Pr-Vr*Pr,Zr=2*Vr-Hr;return[ie(255*je(Zr,Hr,Ir+1/3)),ie(255*je(Zr,Hr,Ir)),ie(255*je(Zr,Hr,Ir-1/3)),br];default:return null}}return null}}catch{}}).parseCSSColor,Qt=function(M,O,Y,ie){ie===void 0&&(ie=1),this.r=M,this.g=O,this.b=Y,this.a=ie};Qt.parse=function(M){if(M){if(M instanceof Qt)return M;if(typeof M=="string"){var O=hr(M);if(O)return new Qt(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},Qt.prototype.toString=function(){var M=this.toArray(),O=M[0],Y=M[1],ie=M[2],ye=M[3];return"rgba("+Math.round(O)+","+Math.round(Y)+","+Math.round(ie)+","+ye+")"},Qt.prototype.toArray=function(){var M=this.r,O=this.g,Y=this.b,ie=this.a;return ie===0?[0,0,0,0]:[255*M/ie,255*O/ie,255*Y/ie,ie]},Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);var tr=function(M,O,Y){this.sensitivity=M?O?"variant":"case":O?"accent":"base",this.locale=Y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};tr.prototype.compare=function(M,O){return this.collator.compare(M,O)},tr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var rr=function(M,O,Y,ie,ye){this.text=M,this.image=O,this.scale=Y,this.fontStack=ie,this.textColor=ye},fr=function(M){this.sections=M};fr.fromString=function(M){return new fr([new rr(M,null,null,null,null)])},fr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(M){return M.text.length!==0||M.image&&M.image.name.length!==0})},fr.factory=function(M){return M instanceof fr?M:fr.fromString(M)},fr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(M){return M.text}).join("")},fr.prototype.serialize=function(){for(var M=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];if(ie.image)M.push(["image",ie.image.name]);else{M.push(ie.text);var ye={};ie.fontStack&&(ye["text-font"]=["literal",ie.fontStack.split(",")]),ie.scale&&(ye["font-scale"]=ie.scale),ie.textColor&&(ye["text-color"]=["rgba"].concat(ie.textColor.toArray())),M.push(ye)}}return M};var yr=function(M){this.name=M.name,this.available=M.available};function Sr(M,O,Y,ie){return typeof M=="number"&&M>=0&&M<=255&&typeof O=="number"&&O>=0&&O<=255&&typeof Y=="number"&&Y>=0&&Y<=255?ie===void 0||typeof ie=="number"&&ie>=0&&ie<=1?null:"Invalid rgba value ["+[M,O,Y,ie].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof ie=="number"?[M,O,Y,ie]:[M,O,Y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Dr(M){if(M===null||typeof M=="string"||typeof M=="boolean"||typeof M=="number"||M instanceof Qt||M instanceof tr||M instanceof fr||M instanceof yr)return!0;if(Array.isArray(M)){for(var O=0,Y=M;O<Y.length;O+=1)if(!Dr(Y[O]))return!1;return!0}if(typeof M=="object"){for(var ie in M)if(!Dr(M[ie]))return!1;return!0}return!1}function Nr(M){if(M===null)return Ot;if(typeof M=="string")return ht;if(typeof M=="boolean")return jt;if(typeof M=="number")return it;if(M instanceof Qt)return kt;if(M instanceof tr)return Ze;if(M instanceof fr)return at;if(M instanceof yr)return pt;if(Array.isArray(M)){for(var O,Y=M.length,ie=0,ye=M;ie<ye.length;ie+=1){var we=Nr(ye[ie]);if(O){if(O===we)continue;O=Ee;break}O=we}return St(O||Ee,Y)}return Pt}function Wr(M){var O=typeof M;return M===null?"":O==="string"||O==="number"||O==="boolean"?String(M):M instanceof Qt||M instanceof fr||M instanceof yr?M.toString():JSON.stringify(M)}yr.prototype.toString=function(){return this.name},yr.fromString=function(M){return M?new yr({name:M,available:!1}):null},yr.prototype.serialize=function(){return["image",this.name]};var hn=function(M,O){this.type=M,this.value=O};hn.parse=function(M,O){if(M.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(!Dr(M[1]))return O.error("invalid value");var Y=M[1],ie=Nr(Y),ye=O.expectedType;return ie.kind!=="array"||ie.N!==0||!ye||ye.kind!=="array"||typeof ye.N=="number"&&ye.N!==0||(ie=ye),new hn(ie,Y)},hn.prototype.evaluate=function(){return this.value},hn.prototype.eachChild=function(){},hn.prototype.outputDefined=function(){return!0},hn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qt?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value};var tn=function(M){this.name="ExpressionEvaluationError",this.message=M};tn.prototype.toJSON=function(){return this.message};var Fn={string:ht,number:it,boolean:jt,object:Pt},an=function(M,O){this.type=M,this.args=O};an.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y,ie=1,ye=M[0];if(ye==="array"){var we,Ce;if(M.length>2){var je=M[1];if(typeof je!="string"||!(je in Fn)||je==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);we=Fn[je],ie++}else we=Ee;if(M.length>3){if(M[2]!==null&&(typeof M[2]!="number"||M[2]<0||M[2]!==Math.floor(M[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Ce=M[2],ie++}Y=St(we,Ce)}else Y=Fn[ye];for(var tt=[];ie<M.length;ie++){var ft=O.parse(M[ie],ie,Ee);if(!ft)return null;tt.push(ft)}return new an(Y,tt)},an.prototype.evaluate=function(M){for(var O=0;O<this.args.length;O++){var Y=this.args[O].evaluate(M);if(!Ht(this.type,Nr(Y)))return Y;if(O===this.args.length-1)throw new tn("Expected value to be of type "+Ut(this.type)+", but found "+Ut(Nr(Y))+" instead.")}return null},an.prototype.eachChild=function(M){this.args.forEach(M)},an.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},an.prototype.serialize=function(){var M=this.type,O=[M.kind];if(M.kind==="array"){var Y=M.itemType;if(Y.kind==="string"||Y.kind==="number"||Y.kind==="boolean"){O.push(Y.kind);var ie=M.N;(typeof ie=="number"||this.args.length>1)&&O.push(ie)}}return O.concat(this.args.map(function(ye){return ye.serialize()}))};var xn=function(M){this.type=at,this.sections=M};xn.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y=M[1];if(!Array.isArray(Y)&&typeof Y=="object")return O.error("First argument must be an image or text section.");for(var ie=[],ye=!1,we=1;we<=M.length-1;++we){var Ce=M[we];if(ye&&typeof Ce=="object"&&!Array.isArray(Ce)){ye=!1;var je=null;if(Ce["font-scale"]&&!(je=O.parse(Ce["font-scale"],1,it)))return null;var tt=null;if(Ce["text-font"]&&!(tt=O.parse(Ce["text-font"],1,St(ht))))return null;var ft=null;if(Ce["text-color"]&&!(ft=O.parse(Ce["text-color"],1,kt)))return null;var gt=ie[ie.length-1];gt.scale=je,gt.font=tt,gt.textColor=ft}else{var Bt=O.parse(M[we],1,Ee);if(!Bt)return null;var Xt=Bt.type.kind;if(Xt!=="string"&&Xt!=="value"&&Xt!=="null"&&Xt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ye=!0,ie.push({content:Bt,scale:null,font:null,textColor:null})}}return new xn(ie)},xn.prototype.evaluate=function(M){return new fr(this.sections.map(function(O){var Y=O.content.evaluate(M);return Nr(Y)===pt?new rr("",Y,null,null,null):new rr(Wr(Y),null,O.scale?O.scale.evaluate(M):null,O.font?O.font.evaluate(M).join(","):null,O.textColor?O.textColor.evaluate(M):null)}))},xn.prototype.eachChild=function(M){for(var O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];M(ie.content),ie.scale&&M(ie.scale),ie.font&&M(ie.font),ie.textColor&&M(ie.textColor)}},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){for(var M=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ie=Y[O];M.push(ie.content.serialize());var ye={};ie.scale&&(ye["font-scale"]=ie.scale.serialize()),ie.font&&(ye["text-font"]=ie.font.serialize()),ie.textColor&&(ye["text-color"]=ie.textColor.serialize()),M.push(ye)}return M};var _n=function(M){this.type=pt,this.input=M};_n.parse=function(M,O){if(M.length!==2)return O.error("Expected two arguments.");var Y=O.parse(M[1],1,ht);return Y?new _n(Y):O.error("No image name provided.")},_n.prototype.evaluate=function(M){var O=this.input.evaluate(M),Y=yr.fromString(O);return Y&&M.availableImages&&(Y.available=M.availableImages.indexOf(O)>-1),Y},_n.prototype.eachChild=function(M){M(this.input)},_n.prototype.outputDefined=function(){return!1},_n.prototype.serialize=function(){return["image",this.input.serialize()]};var ti={"to-boolean":jt,"to-color":kt,"to-number":it,"to-string":ht},jr=function(M,O){this.type=M,this.args=O};jr.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y=M[0];if((Y==="to-boolean"||Y==="to-string")&&M.length!==2)return O.error("Expected one argument.");for(var ie=ti[Y],ye=[],we=1;we<M.length;we++){var Ce=O.parse(M[we],we,Ee);if(!Ce)return null;ye.push(Ce)}return new jr(ie,ye)},jr.prototype.evaluate=function(M){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(M));if(this.type.kind==="color"){for(var O,Y,ie=0,ye=this.args;ie<ye.length;ie+=1){if(Y=null,(O=ye[ie].evaluate(M))instanceof Qt)return O;if(typeof O=="string"){var we=M.parseColor(O);if(we)return we}else if(Array.isArray(O)&&!(Y=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Sr(O[0],O[1],O[2],O[3])))return new Qt(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new tn(Y||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}if(this.type.kind==="number"){for(var Ce=null,je=0,tt=this.args;je<tt.length;je+=1){if((Ce=tt[je].evaluate(M))===null)return 0;var ft=Number(Ce);if(!isNaN(ft))return ft}throw new tn("Could not convert "+JSON.stringify(Ce)+" to number.")}return this.type.kind==="formatted"?fr.fromString(Wr(this.args[0].evaluate(M))):this.type.kind==="resolvedImage"?yr.fromString(Wr(this.args[0].evaluate(M))):Wr(this.args[0].evaluate(M))},jr.prototype.eachChild=function(M){this.args.forEach(M)},jr.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},jr.prototype.serialize=function(){if(this.type.kind==="formatted")return new xn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _n(this.args[0]).serialize();var M=["to-"+this.type.kind];return this.eachChild(function(O){M.push(O.serialize())}),M};var nn=["Unknown","Point","LineString","Polygon"],vn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};vn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},vn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?nn[this.feature.type]:this.feature.type:null},vn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},vn.prototype.canonicalID=function(){return this.canonical},vn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},vn.prototype.parseColor=function(M){var O=this._parseColorCache[M];return O||(O=this._parseColorCache[M]=Qt.parse(M)),O};var en=function(M,O,Y,ie){this.name=M,this.type=O,this._evaluate=Y,this.args=ie};en.prototype.evaluate=function(M){return this._evaluate(M,this.args)},en.prototype.eachChild=function(M){this.args.forEach(M)},en.prototype.outputDefined=function(){return!1},en.prototype.serialize=function(){return[this.name].concat(this.args.map(function(M){return M.serialize()}))},en.parse=function(M,O){var Y,ie=M[0],ye=en.definitions[ie];if(!ye)return O.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0);for(var we=Array.isArray(ye)?ye[0]:ye.type,Ce=Array.isArray(ye)?[[ye[1],ye[2]]]:ye.overloads,je=Ce.filter(function(ci){var $n=ci[0];return!Array.isArray($n)||$n.length===M.length-1}),tt=null,ft=0,gt=je;ft<gt.length;ft+=1){var Bt=gt[ft],Xt=Bt[0],Yt=Bt[1];tt=new rn(O.registry,O.path,null,O.scope);for(var sr=[],br=!1,Ir=1;Ir<M.length;Ir++){var Pr=M[Ir],Vr=Array.isArray(Xt)?Xt[Ir-1]:Xt.type,Hr=tt.parse(Pr,1+sr.length,Vr);if(!Hr){br=!0;break}sr.push(Hr)}if(!br)if(Array.isArray(Xt)&&Xt.length!==sr.length)tt.error("Expected "+Xt.length+" arguments, but found "+sr.length+" instead.");else{for(var Zr=0;Zr<sr.length;Zr++){var pn=Array.isArray(Xt)?Xt[Zr]:Xt.type,bn=sr[Zr];tt.concat(Zr+1).checkSubtype(pn,bn.type)}if(tt.errors.length===0)return new en(ie,we,Yt,sr)}}if(je.length===1)(Y=O.errors).push.apply(Y,tt.errors);else{for(var jn=(je.length?je:Ce).map(function(ci){var $n,mi=ci[0];return $n=mi,Array.isArray($n)?"("+$n.map(Ut).join(", ")+")":"("+Ut($n.type)+"...)"}).join(" | "),Nn=[],Wn=1;Wn<M.length;Wn++){var li=O.parse(M[Wn],1+Nn.length);if(!li)return null;Nn.push(Ut(li.type))}O.error("Expected arguments of type "+jn+", but found ("+Nn.join(", ")+") instead.")}return null},en.register=function(M,O){for(var Y in en.definitions=O,O)M[Y]=en};var fn=function(M,O,Y){this.type=Ze,this.locale=Y,this.caseSensitive=M,this.diacriticSensitive=O};fn.parse=function(M,O){if(M.length!==2)return O.error("Expected one argument.");var Y=M[1];if(typeof Y!="object"||Array.isArray(Y))return O.error("Collator options argument must be an object.");var ie=O.parse(Y["case-sensitive"]!==void 0&&Y["case-sensitive"],1,jt);if(!ie)return null;var ye=O.parse(Y["diacritic-sensitive"]!==void 0&&Y["diacritic-sensitive"],1,jt);if(!ye)return null;var we=null;return Y.locale&&!(we=O.parse(Y.locale,1,ht))?null:new fn(ie,ye,we)},fn.prototype.evaluate=function(M){return new tr(this.caseSensitive.evaluate(M),this.diacriticSensitive.evaluate(M),this.locale?this.locale.evaluate(M):null)},fn.prototype.eachChild=function(M){M(this.caseSensitive),M(this.diacriticSensitive),this.locale&&M(this.locale)},fn.prototype.outputDefined=function(){return!1},fn.prototype.serialize=function(){var M={};return M["case-sensitive"]=this.caseSensitive.serialize(),M["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(M.locale=this.locale.serialize()),["collator",M]};function Gn(M,O){M[0]=Math.min(M[0],O[0]),M[1]=Math.min(M[1],O[1]),M[2]=Math.max(M[2],O[0]),M[3]=Math.max(M[3],O[1])}function Tn(M,O){return!(M[0]<=O[0])&&!(M[2]>=O[2])&&!(M[1]<=O[1])&&!(M[3]>=O[3])}function Cn(M,O){var Y,ie=(180+M[0])/360,ye=(Y=M[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Y*Math.PI/360)))/360),we=Math.pow(2,O.z);return[Math.round(ie*we*8192),Math.round(ye*we*8192)]}function oi(M,O,Y){return O[1]>M[1]!=Y[1]>M[1]&&M[0]<(Y[0]-O[0])*(M[1]-O[1])/(Y[1]-O[1])+O[0]}function nr(M,O){for(var Y,ie,ye,we,Ce,je,tt,ft=!1,gt=0,Bt=O.length;gt<Bt;gt++)for(var Xt=O[gt],Yt=0,sr=Xt.length;Yt<sr-1;Yt++){if(Y=M,ie=Xt[Yt],ye=Xt[Yt+1],we=void 0,Ce=void 0,je=void 0,tt=void 0,we=Y[0]-ie[0],Ce=Y[1]-ie[1],je=Y[0]-ye[0],tt=Y[1]-ye[1],we*tt-je*Ce==0&&we*je<=0&&Ce*tt<=0)return!1;oi(M,Xt[Yt],Xt[Yt+1])&&(ft=!ft)}return ft}function vr(M,O){for(var Y=0;Y<O.length;Y++)if(nr(M,O[Y]))return!0;return!1}function It(M,O,Y,ie){var ye=M[0]-Y[0],we=M[1]-Y[1],Ce=O[0]-Y[0],je=O[1]-Y[1],tt=ie[0]-Y[0],ft=ie[1]-Y[1],gt=ye*ft-tt*we,Bt=Ce*ft-tt*je;return gt>0&&Bt<0||gt<0&&Bt>0}function lr(M,O,Y){for(var ie=0,ye=Y;ie<ye.length;ie+=1)for(var we=ye[ie],Ce=0;Ce<we.length-1;++Ce)if(je=M,tt=O,ft=we[Ce],gt=we[Ce+1],Bt=void 0,Xt=void 0,Yt=void 0,sr=void 0,Yt=[tt[0]-je[0],tt[1]-je[1]],sr=[gt[0]-ft[0],gt[1]-ft[1]],(Bt=sr)[0]*(Xt=Yt)[1]-Bt[1]*Xt[0]!=0&&It(je,tt,ft,gt)&&It(ft,gt,je,tt))return!0;var je,tt,ft,gt,Bt,Xt,Yt,sr;return!1}function dr(M,O){for(var Y=0;Y<M.length;++Y)if(!nr(M[Y],O))return!1;for(var ie=0;ie<M.length-1;++ie)if(lr(M[ie],M[ie+1],O))return!1;return!0}function Br(M,O){for(var Y=0;Y<O.length;Y++)if(dr(M,O[Y]))return!0;return!1}function Fr(M,O,Y){for(var ie=[],ye=0;ye<M.length;ye++){for(var we=[],Ce=0;Ce<M[ye].length;Ce++){var je=Cn(M[ye][Ce],Y);Gn(O,je),we.push(je)}ie.push(we)}return ie}function zr(M,O,Y){for(var ie=[],ye=0;ye<M.length;ye++){var we=Fr(M[ye],O,Y);ie.push(we)}return ie}function Er(M,O,Y,ie){if(M[0]<Y[0]||M[0]>Y[2]){var ye=.5*ie,we=M[0]-Y[0]>ye?-ie:Y[0]-M[0]>ye?ie:0;we===0&&(we=M[0]-Y[2]>ye?-ie:Y[2]-M[0]>ye?ie:0),M[0]+=we}Gn(O,M)}function xr(M,O,Y,ie){for(var ye=8192*Math.pow(2,ie.z),we=[8192*ie.x,8192*ie.y],Ce=[],je=0,tt=M;je<tt.length;je+=1)for(var ft=0,gt=tt[je];ft<gt.length;ft+=1){var Bt=gt[ft],Xt=[Bt.x+we[0],Bt.y+we[1]];Er(Xt,O,Y,ye),Ce.push(Xt)}return Ce}function _r(M,O,Y,ie){for(var ye,we=8192*Math.pow(2,ie.z),Ce=[8192*ie.x,8192*ie.y],je=[],tt=0,ft=M;tt<ft.length;tt+=1){for(var gt=[],Bt=0,Xt=ft[tt];Bt<Xt.length;Bt+=1){var Yt=Xt[Bt],sr=[Yt.x+Ce[0],Yt.y+Ce[1]];Gn(O,sr),gt.push(sr)}je.push(gt)}if(O[2]-O[0]<=we/2){(ye=O)[0]=ye[1]=1/0,ye[2]=ye[3]=-1/0;for(var br=0,Ir=je;br<Ir.length;br+=1)for(var Pr=0,Vr=Ir[br];Pr<Vr.length;Pr+=1)Er(Vr[Pr],O,Y,we)}return je}var kr=function(M,O){this.type=jt,this.geojson=M,this.geometries=O};function Cr(M){if(M instanceof en&&(M.name==="get"&&M.args.length===1||M.name==="feature-state"||M.name==="has"&&M.args.length===1||M.name==="properties"||M.name==="geometry-type"||M.name==="id"||/^filter-/.test(M.name))||M instanceof kr)return!1;var O=!0;return M.eachChild(function(Y){O&&!Cr(Y)&&(O=!1)}),O}function Gr(M){if(M instanceof en&&M.name==="feature-state")return!1;var O=!0;return M.eachChild(function(Y){O&&!Gr(Y)&&(O=!1)}),O}function qr(M,O){if(M instanceof en&&O.indexOf(M.name)>=0)return!1;var Y=!0;return M.eachChild(function(ie){Y&&!qr(ie,O)&&(Y=!1)}),Y}kr.parse=function(M,O){if(M.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(Dr(M[1])){var Y=M[1];if(Y.type==="FeatureCollection")for(var ie=0;ie<Y.features.length;++ie){var ye=Y.features[ie].geometry.type;if(ye==="Polygon"||ye==="MultiPolygon")return new kr(Y,Y.features[ie].geometry)}else if(Y.type==="Feature"){var we=Y.geometry.type;if(we==="Polygon"||we==="MultiPolygon")return new kr(Y,Y.geometry)}else if(Y.type==="Polygon"||Y.type==="MultiPolygon")return new kr(Y,Y)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},kr.prototype.evaluate=function(M){if(M.geometry()!=null&&M.canonicalID()!=null){if(M.geometryType()==="Point")return function(O,Y){var ie=[1/0,1/0,-1/0,-1/0],ye=[1/0,1/0,-1/0,-1/0],we=O.canonicalID();if(Y.type==="Polygon"){var Ce=Fr(Y.coordinates,ye,we),je=xr(O.geometry(),ie,ye,we);if(!Tn(ie,ye))return!1;for(var tt=0,ft=je;tt<ft.length;tt+=1)if(!nr(ft[tt],Ce))return!1}if(Y.type==="MultiPolygon"){var gt=zr(Y.coordinates,ye,we),Bt=xr(O.geometry(),ie,ye,we);if(!Tn(ie,ye))return!1;for(var Xt=0,Yt=Bt;Xt<Yt.length;Xt+=1)if(!vr(Yt[Xt],gt))return!1}return!0}(M,this.geometries);if(M.geometryType()==="LineString")return function(O,Y){var ie=[1/0,1/0,-1/0,-1/0],ye=[1/0,1/0,-1/0,-1/0],we=O.canonicalID();if(Y.type==="Polygon"){var Ce=Fr(Y.coordinates,ye,we),je=_r(O.geometry(),ie,ye,we);if(!Tn(ie,ye))return!1;for(var tt=0,ft=je;tt<ft.length;tt+=1)if(!dr(ft[tt],Ce))return!1}if(Y.type==="MultiPolygon"){var gt=zr(Y.coordinates,ye,we),Bt=_r(O.geometry(),ie,ye,we);if(!Tn(ie,ye))return!1;for(var Xt=0,Yt=Bt;Xt<Yt.length;Xt+=1)if(!Br(Yt[Xt],gt))return!1}return!0}(M,this.geometries)}return!1},kr.prototype.eachChild=function(){},kr.prototype.outputDefined=function(){return!0},kr.prototype.serialize=function(){return["within",this.geojson]};var Qr=function(M,O){this.type=O.type,this.name=M,this.boundExpression=O};Qr.parse=function(M,O){if(M.length!==2||typeof M[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var Y=M[1];return O.scope.has(Y)?new Qr(Y,O.scope.get(Y)):O.error('Unknown variable "'+Y+'". Make sure "'+Y+'" has been bound in an enclosing "let" expression before using it.',1)},Qr.prototype.evaluate=function(M){return this.boundExpression.evaluate(M)},Qr.prototype.eachChild=function(){},Qr.prototype.outputDefined=function(){return!1},Qr.prototype.serialize=function(){return["var",this.name]};var rn=function(M,O,Y,ie,ye){O===void 0&&(O=[]),ie===void 0&&(ie=new Mt),ye===void 0&&(ye=[]),this.registry=M,this.path=O,this.key=O.map(function(we){return"["+we+"]"}).join(""),this.scope=ie,this.errors=ye,this.expectedType=Y};function yn(M,O){for(var Y,ie,ye=M.length-1,we=0,Ce=ye,je=0;we<=Ce;)if(Y=M[je=Math.floor((we+Ce)/2)],ie=M[je+1],Y<=O){if(je===ye||O<ie)return je;we=je+1}else{if(!(Y>O))throw new tn("Input is not a number.");Ce=je-1}return 0}rn.prototype.parse=function(M,O,Y,ie,ye){return ye===void 0&&(ye={}),O?this.concat(O,Y,ie)._parse(M,ye):this._parse(M,ye)},rn.prototype._parse=function(M,O){function Y(ft,gt,Bt){return Bt==="assert"?new an(gt,[ft]):Bt==="coerce"?new jr(gt,[ft]):ft}if(M!==null&&typeof M!="string"&&typeof M!="boolean"&&typeof M!="number"||(M=["literal",M]),Array.isArray(M)){if(M.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ie=M[0];if(typeof ie!="string")return this.error("Expression name must be a string, but found "+typeof ie+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var ye=this.registry[ie];if(ye){var we=ye.parse(M,this);if(!we)return null;if(this.expectedType){var Ce=this.expectedType,je=we.type;if(Ce.kind!=="string"&&Ce.kind!=="number"&&Ce.kind!=="boolean"&&Ce.kind!=="object"&&Ce.kind!=="array"||je.kind!=="value")if(Ce.kind!=="color"&&Ce.kind!=="formatted"&&Ce.kind!=="resolvedImage"||je.kind!=="value"&&je.kind!=="string"){if(this.checkSubtype(Ce,je))return null}else we=Y(we,Ce,O.typeAnnotation||"coerce");else we=Y(we,Ce,O.typeAnnotation||"assert")}if(!(we instanceof hn)&&we.type.kind!=="resolvedImage"&&function ft(gt){if(gt instanceof Qr)return ft(gt.boundExpression);if(gt instanceof en&&gt.name==="error"||gt instanceof fn||gt instanceof kr)return!1;var Bt=gt instanceof jr||gt instanceof an,Xt=!0;return gt.eachChild(function(Yt){Xt=Bt?Xt&&ft(Yt):Xt&&Yt instanceof hn}),Xt?Cr(gt)&&qr(gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(we)){var tt=new vn;try{we=new hn(we.type,we.evaluate(tt))}catch(ft){return this.error(ft.message),null}}return we}return this.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0)}return M===void 0?this.error("'undefined' value invalid. Use null instead."):typeof M=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof M+" instead.")},rn.prototype.concat=function(M,O,Y){var ie=typeof M=="number"?this.path.concat(M):this.path,ye=Y?this.scope.concat(Y):this.scope;return new rn(this.registry,ie,O||null,ye,this.errors)},rn.prototype.error=function(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];var ie=""+this.key+O.map(function(ye){return"["+ye+"]"}).join("");this.errors.push(new st(ie,M))},rn.prototype.checkSubtype=function(M,O){var Y=Ht(M,O);return Y&&this.error(Y),Y};var wn=function(M,O,Y){this.type=M,this.input=O,this.labels=[],this.outputs=[];for(var ie=0,ye=Y;ie<ye.length;ie+=1){var we=ye[ie],Ce=we[0],je=we[1];this.labels.push(Ce),this.outputs.push(je)}};function kn(M,O,Y){return M*(1-Y)+O*Y}wn.parse=function(M,O){if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");var Y=O.parse(M[1],1,it);if(!Y)return null;var ie=[],ye=null;O.expectedType&&O.expectedType.kind!=="value"&&(ye=O.expectedType);for(var we=1;we<M.length;we+=2){var Ce=we===1?-1/0:M[we],je=M[we+1],tt=we,ft=we+1;if(typeof Ce!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',tt);if(ie.length&&ie[ie.length-1][0]>=Ce)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',tt);var gt=O.parse(je,ft,ye);if(!gt)return null;ye=ye||gt.type,ie.push([Ce,gt])}return new wn(ye,Y,ie)},wn.prototype.evaluate=function(M){var O=this.labels,Y=this.outputs;if(O.length===1)return Y[0].evaluate(M);var ie=this.input.evaluate(M);if(ie<=O[0])return Y[0].evaluate(M);var ye=O.length;return ie>=O[ye-1]?Y[ye-1].evaluate(M):Y[yn(O,ie)].evaluate(M)},wn.prototype.eachChild=function(M){M(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)M(Y[O])},wn.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},wn.prototype.serialize=function(){for(var M=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&M.push(this.labels[O]),M.push(this.outputs[O].serialize());return M};var Pn=Object.freeze({__proto__:null,number:kn,color:function(M,O,Y){return new Qt(kn(M.r,O.r,Y),kn(M.g,O.g,Y),kn(M.b,O.b,Y),kn(M.a,O.a,Y))},array:function(M,O,Y){return M.map(function(ie,ye){return kn(ie,O[ye],Y)})}}),Dn=6/29,Zn=3*Dn*Dn,Ai=Math.PI/180,Mi=180/Math.PI;function En(M){return M>.008856451679035631?Math.pow(M,1/3):M/Zn+4/29}function Qn(M){return M>Dn?M*M*M:Zn*(M-4/29)}function Jn(M){return 255*(M<=.0031308?12.92*M:1.055*Math.pow(M,1/2.4)-.055)}function Di(M){return(M/=255)<=.04045?M/12.92:Math.pow((M+.055)/1.055,2.4)}function va(M){var O=Di(M.r),Y=Di(M.g),ie=Di(M.b),ye=En((.4124564*O+.3575761*Y+.1804375*ie)/.95047),we=En((.2126729*O+.7151522*Y+.072175*ie)/1);return{l:116*we-16,a:500*(ye-we),b:200*(we-En((.0193339*O+.119192*Y+.9503041*ie)/1.08883)),alpha:M.a}}function Ba(M){var O=(M.l+16)/116,Y=isNaN(M.a)?O:O+M.a/500,ie=isNaN(M.b)?O:O-M.b/200;return O=1*Qn(O),Y=.95047*Qn(Y),ie=1.08883*Qn(ie),new Qt(Jn(3.2404542*Y-1.5371385*O-.4985314*ie),Jn(-.969266*Y+1.8760108*O+.041556*ie),Jn(.0556434*Y-.2040259*O+1.0572252*ie),M.alpha)}function mo(M,O,Y){var ie=O-M;return M+Y*(ie>180||ie<-180?ie-360*Math.round(ie/360):ie)}var Wi={forward:va,reverse:Ba,interpolate:function(M,O,Y){return{l:kn(M.l,O.l,Y),a:kn(M.a,O.a,Y),b:kn(M.b,O.b,Y),alpha:kn(M.alpha,O.alpha,Y)}}},Zi={forward:function(M){var O=va(M),Y=O.l,ie=O.a,ye=O.b,we=Math.atan2(ye,ie)*Mi;return{h:we<0?we+360:we,c:Math.sqrt(ie*ie+ye*ye),l:Y,alpha:M.a}},reverse:function(M){var O=M.h*Ai,Y=M.c;return Ba({l:M.l,a:Math.cos(O)*Y,b:Math.sin(O)*Y,alpha:M.alpha})},interpolate:function(M,O,Y){return{h:mo(M.h,O.h,Y),c:kn(M.c,O.c,Y),l:kn(M.l,O.l,Y),alpha:kn(M.alpha,O.alpha,Y)}}},to=Object.freeze({__proto__:null,lab:Wi,hcl:Zi}),Ni=function(M,O,Y,ie,ye){this.type=M,this.operator=O,this.interpolation=Y,this.input=ie,this.labels=[],this.outputs=[];for(var we=0,Ce=ye;we<Ce.length;we+=1){var je=Ce[we],tt=je[0],ft=je[1];this.labels.push(tt),this.outputs.push(ft)}};function go(M,O,Y,ie){var ye=ie-Y,we=M-Y;return ye===0?0:O===1?we/ye:(Math.pow(O,we)-1)/(Math.pow(O,ye)-1)}Ni.interpolationFactor=function(M,O,Y,ie){var ye=0;if(M.name==="exponential")ye=go(O,M.base,Y,ie);else if(M.name==="linear")ye=go(O,1,Y,ie);else if(M.name==="cubic-bezier"){var we=M.controlPoints;ye=new n(we[0],we[1],we[2],we[3]).solve(go(O,1,Y,ie))}return ye},Ni.parse=function(M,O){var Y=M[0],ie=M[1],ye=M[2],we=M.slice(3);if(!Array.isArray(ie)||ie.length===0)return O.error("Expected an interpolation type expression.",1);if(ie[0]==="linear")ie={name:"linear"};else if(ie[0]==="exponential"){var Ce=ie[1];if(typeof Ce!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);ie={name:"exponential",base:Ce}}else{if(ie[0]!=="cubic-bezier")return O.error("Unknown interpolation type "+String(ie[0]),1,0);var je=ie.slice(1);if(je.length!==4||je.some(function(Ir){return typeof Ir!="number"||Ir<0||Ir>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ie={name:"cubic-bezier",controlPoints:je}}if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(ye=O.parse(ye,2,it)))return null;var tt=[],ft=null;Y==="interpolate-hcl"||Y==="interpolate-lab"?ft=kt:O.expectedType&&O.expectedType.kind!=="value"&&(ft=O.expectedType);for(var gt=0;gt<we.length;gt+=2){var Bt=we[gt],Xt=we[gt+1],Yt=gt+3,sr=gt+4;if(typeof Bt!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Yt);if(tt.length&&tt[tt.length-1][0]>=Bt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Yt);var br=O.parse(Xt,sr,ft);if(!br)return null;ft=ft||br.type,tt.push([Bt,br])}return ft.kind==="number"||ft.kind==="color"||ft.kind==="array"&&ft.itemType.kind==="number"&&typeof ft.N=="number"?new Ni(ft,Y,ie,ye,tt):O.error("Type "+Ut(ft)+" is not interpolatable.")},Ni.prototype.evaluate=function(M){var O=this.labels,Y=this.outputs;if(O.length===1)return Y[0].evaluate(M);var ie=this.input.evaluate(M);if(ie<=O[0])return Y[0].evaluate(M);var ye=O.length;if(ie>=O[ye-1])return Y[ye-1].evaluate(M);var we=yn(O,ie),Ce=O[we],je=O[we+1],tt=Ni.interpolationFactor(this.interpolation,ie,Ce,je),ft=Y[we].evaluate(M),gt=Y[we+1].evaluate(M);return this.operator==="interpolate"?Pn[this.type.kind.toLowerCase()](ft,gt,tt):this.operator==="interpolate-hcl"?Zi.reverse(Zi.interpolate(Zi.forward(ft),Zi.forward(gt),tt)):Wi.reverse(Wi.interpolate(Wi.forward(ft),Wi.forward(gt),tt))},Ni.prototype.eachChild=function(M){M(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)M(Y[O])},Ni.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},Ni.prototype.serialize=function(){var M;M=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,M,this.input.serialize()],Y=0;Y<this.labels.length;Y++)O.push(this.labels[Y],this.outputs[Y].serialize());return O};var bo=function(M,O){this.type=M,this.args=O};bo.parse=function(M,O){if(M.length<2)return O.error("Expectected at least one argument.");var Y=null,ie=O.expectedType;ie&&ie.kind!=="value"&&(Y=ie);for(var ye=[],we=0,Ce=M.slice(1);we<Ce.length;we+=1){var je=Ce[we],tt=O.parse(je,1+ye.length,Y,void 0,{typeAnnotation:"omit"});if(!tt)return null;Y=Y||tt.type,ye.push(tt)}var ft=ie&&ye.some(function(gt){return Ht(ie,gt.type)});return new bo(ft?Ee:Y,ye)},bo.prototype.evaluate=function(M){for(var O,Y=null,ie=0,ye=0,we=this.args;ye<we.length&&(ie++,(Y=we[ye].evaluate(M))&&Y instanceof yr&&!Y.available&&(O||(O=Y.name),Y=null,ie===this.args.length&&(Y=O)),Y===null);ye+=1);return Y},bo.prototype.eachChild=function(M){this.args.forEach(M)},bo.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},bo.prototype.serialize=function(){var M=["coalesce"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Ma=function(M,O){this.type=O.type,this.bindings=[].concat(M),this.result=O};Ma.prototype.evaluate=function(M){return this.result.evaluate(M)},Ma.prototype.eachChild=function(M){for(var O=0,Y=this.bindings;O<Y.length;O+=1)M(Y[O][1]);M(this.result)},Ma.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found "+(M.length-1)+" instead.");for(var Y=[],ie=1;ie<M.length-1;ie+=2){var ye=M[ie];if(typeof ye!="string")return O.error("Expected string, but found "+typeof ye+" instead.",ie);if(/[^a-zA-Z0-9_]/.test(ye))return O.error("Variable names must contain only alphanumeric characters or '_'.",ie);var we=O.parse(M[ie+1],ie+1);if(!we)return null;Y.push([ye,we])}var Ce=O.parse(M[M.length-1],M.length-1,O.expectedType,Y);return Ce?new Ma(Y,Ce):null},Ma.prototype.outputDefined=function(){return this.result.outputDefined()},Ma.prototype.serialize=function(){for(var M=["let"],O=0,Y=this.bindings;O<Y.length;O+=1){var ie=Y[O],ye=ie[0],we=ie[1];M.push(ye,we.serialize())}return M.push(this.result.serialize()),M};var ro=function(M,O,Y){this.type=M,this.index=O,this.input=Y};ro.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,it),ie=O.parse(M[2],2,St(O.expectedType||Ee));if(!Y||!ie)return null;var ye=ie.type;return new ro(ye.itemType,Y,ie)},ro.prototype.evaluate=function(M){var O=this.index.evaluate(M),Y=this.input.evaluate(M);if(O<0)throw new tn("Array index out of bounds: "+O+" < 0.");if(O>=Y.length)throw new tn("Array index out of bounds: "+O+" > "+(Y.length-1)+".");if(O!==Math.floor(O))throw new tn("Array index must be an integer, but found "+O+" instead.");return Y[O]},ro.prototype.eachChild=function(M){M(this.index),M(this.input)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var _o=function(M,O){this.type=jt,this.needle=M,this.haystack=O};_o.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ee),ie=O.parse(M[2],2,Ee);return Y&&ie?pr(Y.type,[jt,ht,it,Ot,Ee])?new _o(Y,ie):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Y.type)+" instead"):null},_o.prototype.evaluate=function(M){var O=this.needle.evaluate(M),Y=this.haystack.evaluate(M);if(!Y)return!1;if(!Mr(O,["boolean","string","number","null"]))throw new tn("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Nr(O))+" instead.");if(!Mr(Y,["string","array"]))throw new tn("Expected second argument to be of type array or string, but found "+Ut(Nr(Y))+" instead.");return Y.indexOf(O)>=0},_o.prototype.eachChild=function(M){M(this.needle),M(this.haystack)},_o.prototype.outputDefined=function(){return!0},_o.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Co=function(M,O,Y){this.type=it,this.needle=M,this.haystack=O,this.fromIndex=Y};Co.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ee),ie=O.parse(M[2],2,Ee);if(!Y||!ie)return null;if(!pr(Y.type,[jt,ht,it,Ot,Ee]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Y.type)+" instead");if(M.length===4){var ye=O.parse(M[3],3,it);return ye?new Co(Y,ie,ye):null}return new Co(Y,ie)},Co.prototype.evaluate=function(M){var O=this.needle.evaluate(M),Y=this.haystack.evaluate(M);if(!Mr(O,["boolean","string","number","null"]))throw new tn("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Nr(O))+" instead.");if(!Mr(Y,["string","array"]))throw new tn("Expected second argument to be of type array or string, but found "+Ut(Nr(Y))+" instead.");if(this.fromIndex){var ie=this.fromIndex.evaluate(M);return Y.indexOf(O,ie)}return Y.indexOf(O)},Co.prototype.eachChild=function(M){M(this.needle),M(this.haystack),this.fromIndex&&M(this.fromIndex)},Co.prototype.outputDefined=function(){return!1},Co.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var M=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),M]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Va=function(M,O,Y,ie,ye,we){this.inputType=M,this.type=O,this.input=Y,this.cases=ie,this.outputs=ye,this.otherwise=we};Va.parse=function(M,O){if(M.length<5)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if(M.length%2!=1)return O.error("Expected an even number of arguments.");var Y,ie;O.expectedType&&O.expectedType.kind!=="value"&&(ie=O.expectedType);for(var ye={},we=[],Ce=2;Ce<M.length-1;Ce+=2){var je=M[Ce],tt=M[Ce+1];Array.isArray(je)||(je=[je]);var ft=O.concat(Ce);if(je.length===0)return ft.error("Expected at least one branch label.");for(var gt=0,Bt=je;gt<Bt.length;gt+=1){var Xt=Bt[gt];if(typeof Xt!="number"&&typeof Xt!="string")return ft.error("Branch labels must be numbers or strings.");if(typeof Xt=="number"&&Math.abs(Xt)>Number.MAX_SAFE_INTEGER)return ft.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Xt=="number"&&Math.floor(Xt)!==Xt)return ft.error("Numeric branch labels must be integer values.");if(Y){if(ft.checkSubtype(Y,Nr(Xt)))return null}else Y=Nr(Xt);if(ye[String(Xt)]!==void 0)return ft.error("Branch labels must be unique.");ye[String(Xt)]=we.length}var Yt=O.parse(tt,Ce,ie);if(!Yt)return null;ie=ie||Yt.type,we.push(Yt)}var sr=O.parse(M[1],1,Ee);if(!sr)return null;var br=O.parse(M[M.length-1],M.length-1,ie);return br?sr.type.kind!=="value"&&O.concat(1).checkSubtype(Y,sr.type)?null:new Va(Y,ie,sr,ye,we,br):null},Va.prototype.evaluate=function(M){var O=this.input.evaluate(M);return(Nr(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(M)},Va.prototype.eachChild=function(M){M(this.input),this.outputs.forEach(M),M(this.otherwise)},Va.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})&&this.otherwise.outputDefined()},Va.prototype.serialize=function(){for(var M=this,O=["match",this.input.serialize()],Y=[],ie={},ye=0,we=Object.keys(this.cases).sort();ye<we.length;ye+=1){var Ce=we[ye];(Bt=ie[this.cases[Ce]])===void 0?(ie[this.cases[Ce]]=Y.length,Y.push([this.cases[Ce],[Ce]])):Y[Bt][1].push(Ce)}for(var je=function(Yt){return M.inputType.kind==="number"?Number(Yt):Yt},tt=0,ft=Y;tt<ft.length;tt+=1){var gt=ft[tt],Bt=gt[0],Xt=gt[1];Xt.length===1?O.push(je(Xt[0])):O.push(Xt.map(je)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var ya=function(M,O,Y){this.type=M,this.branches=O,this.otherwise=Y};ya.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found only "+(M.length-1)+".");if(M.length%2!=0)return O.error("Expected an odd number of arguments.");var Y;O.expectedType&&O.expectedType.kind!=="value"&&(Y=O.expectedType);for(var ie=[],ye=1;ye<M.length-1;ye+=2){var we=O.parse(M[ye],ye,jt);if(!we)return null;var Ce=O.parse(M[ye+1],ye+1,Y);if(!Ce)return null;ie.push([we,Ce]),Y=Y||Ce.type}var je=O.parse(M[M.length-1],M.length-1,Y);return je?new ya(Y,ie,je):null},ya.prototype.evaluate=function(M){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ie=Y[O],ye=ie[0],we=ie[1];if(ye.evaluate(M))return we.evaluate(M)}return this.otherwise.evaluate(M)},ya.prototype.eachChild=function(M){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ie=Y[O],ye=ie[0],we=ie[1];M(ye),M(we)}M(this.otherwise)},ya.prototype.outputDefined=function(){return this.branches.every(function(M){return M[0],M[1].outputDefined()})&&this.otherwise.outputDefined()},ya.prototype.serialize=function(){var M=["case"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Qa=function(M,O,Y,ie){this.type=M,this.input=O,this.beginIndex=Y,this.endIndex=ie};function Cs(M,O){return M==="=="||M==="!="?O.kind==="boolean"||O.kind==="string"||O.kind==="number"||O.kind==="null"||O.kind==="value":O.kind==="string"||O.kind==="number"||O.kind==="value"}function Rs(M,O,Y,ie){return ie.compare(O,Y)===0}function Xi(M,O,Y){var ie=M!=="=="&&M!=="!=";return function(){function ye(we,Ce,je){this.type=jt,this.lhs=we,this.rhs=Ce,this.collator=je,this.hasUntypedArgument=we.type.kind==="value"||Ce.type.kind==="value"}return ye.parse=function(we,Ce){if(we.length!==3&&we.length!==4)return Ce.error("Expected two or three arguments.");var je=we[0],tt=Ce.parse(we[1],1,Ee);if(!tt)return null;if(!Cs(je,tt.type))return Ce.concat(1).error('"'+je+`" comparisons are not supported for type '`+Ut(tt.type)+"'.");var ft=Ce.parse(we[2],2,Ee);if(!ft)return null;if(!Cs(je,ft.type))return Ce.concat(2).error('"'+je+`" comparisons are not supported for type '`+Ut(ft.type)+"'.");if(tt.type.kind!==ft.type.kind&&tt.type.kind!=="value"&&ft.type.kind!=="value")return Ce.error("Cannot compare types '"+Ut(tt.type)+"' and '"+Ut(ft.type)+"'.");ie&&(tt.type.kind==="value"&&ft.type.kind!=="value"?tt=new an(ft.type,[tt]):tt.type.kind!=="value"&&ft.type.kind==="value"&&(ft=new an(tt.type,[ft])));var gt=null;if(we.length===4){if(tt.type.kind!=="string"&&ft.type.kind!=="string"&&tt.type.kind!=="value"&&ft.type.kind!=="value")return Ce.error("Cannot use collator to compare non-string types.");if(!(gt=Ce.parse(we[3],3,Ze)))return null}return new ye(tt,ft,gt)},ye.prototype.evaluate=function(we){var Ce=this.lhs.evaluate(we),je=this.rhs.evaluate(we);if(ie&&this.hasUntypedArgument){var tt=Nr(Ce),ft=Nr(je);if(tt.kind!==ft.kind||tt.kind!=="string"&&tt.kind!=="number")throw new tn('Expected arguments for "'+M+'" to be (string, string) or (number, number), but found ('+tt.kind+", "+ft.kind+") instead.")}if(this.collator&&!ie&&this.hasUntypedArgument){var gt=Nr(Ce),Bt=Nr(je);if(gt.kind!=="string"||Bt.kind!=="string")return O(we,Ce,je)}return this.collator?Y(we,Ce,je,this.collator.evaluate(we)):O(we,Ce,je)},ye.prototype.eachChild=function(we){we(this.lhs),we(this.rhs),this.collator&&we(this.collator)},ye.prototype.outputDefined=function(){return!0},ye.prototype.serialize=function(){var we=[M];return this.eachChild(function(Ce){we.push(Ce.serialize())}),we},ye}()}Qa.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ee),ie=O.parse(M[2],2,it);if(!Y||!ie)return null;if(!pr(Y.type,[St(Ee),ht,Ee]))return O.error("Expected first argument to be of type array or string, but found "+Ut(Y.type)+" instead");if(M.length===4){var ye=O.parse(M[3],3,it);return ye?new Qa(Y.type,Y,ie,ye):null}return new Qa(Y.type,Y,ie)},Qa.prototype.evaluate=function(M){var O=this.input.evaluate(M),Y=this.beginIndex.evaluate(M);if(!Mr(O,["string","array"]))throw new tn("Expected first argument to be of type array or string, but found "+Ut(Nr(O))+" instead.");if(this.endIndex){var ie=this.endIndex.evaluate(M);return O.slice(Y,ie)}return O.slice(Y)},Qa.prototype.eachChild=function(M){M(this.input),M(this.beginIndex),this.endIndex&&M(this.endIndex)},Qa.prototype.outputDefined=function(){return!1},Qa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var M=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),M]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ts=Xi("==",function(M,O,Y){return O===Y},Rs),ss=Xi("!=",function(M,O,Y){return O!==Y},function(M,O,Y,ie){return!Rs(0,O,Y,ie)}),Fs=Xi("<",function(M,O,Y){return O<Y},function(M,O,Y,ie){return ie.compare(O,Y)<0}),Bs=Xi(">",function(M,O,Y){return O>Y},function(M,O,Y,ie){return ie.compare(O,Y)>0}),Ps=Xi("<=",function(M,O,Y){return O<=Y},function(M,O,Y,ie){return ie.compare(O,Y)<=0}),Ns=Xi(">=",function(M,O,Y){return O>=Y},function(M,O,Y,ie){return ie.compare(O,Y)>=0}),Do=function(M,O,Y,ie,ye){this.type=ht,this.number=M,this.locale=O,this.currency=Y,this.minFractionDigits=ie,this.maxFractionDigits=ye};Do.parse=function(M,O){if(M.length!==3)return O.error("Expected two arguments.");var Y=O.parse(M[1],1,it);if(!Y)return null;var ie=M[2];if(typeof ie!="object"||Array.isArray(ie))return O.error("NumberFormat options argument must be an object.");var ye=null;if(ie.locale&&!(ye=O.parse(ie.locale,1,ht)))return null;var we=null;if(ie.currency&&!(we=O.parse(ie.currency,1,ht)))return null;var Ce=null;if(ie["min-fraction-digits"]&&!(Ce=O.parse(ie["min-fraction-digits"],1,it)))return null;var je=null;return ie["max-fraction-digits"]&&!(je=O.parse(ie["max-fraction-digits"],1,it))?null:new Do(Y,ye,we,Ce,je)},Do.prototype.evaluate=function(M){return new Intl.NumberFormat(this.locale?this.locale.evaluate(M):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(M):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(M):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(M):void 0}).format(this.number.evaluate(M))},Do.prototype.eachChild=function(M){M(this.number),this.locale&&M(this.locale),this.currency&&M(this.currency),this.minFractionDigits&&M(this.minFractionDigits),this.maxFractionDigits&&M(this.maxFractionDigits)},Do.prototype.outputDefined=function(){return!1},Do.prototype.serialize=function(){var M={};return this.locale&&(M.locale=this.locale.serialize()),this.currency&&(M.currency=this.currency.serialize()),this.minFractionDigits&&(M["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(M["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),M]};var zo=function(M){this.type=it,this.input=M};zo.parse=function(M,O){if(M.length!==2)return O.error("Expected 1 argument, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1);return Y?Y.type.kind!=="array"&&Y.type.kind!=="string"&&Y.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+Ut(Y.type)+" instead."):new zo(Y):null},zo.prototype.evaluate=function(M){var O=this.input.evaluate(M);if(typeof O=="string"||Array.isArray(O))return O.length;throw new tn("Expected value to be of type string or array, but found "+Ut(Nr(O))+" instead.")},zo.prototype.eachChild=function(M){M(this.input)},zo.prototype.outputDefined=function(){return!1},zo.prototype.serialize=function(){var M=["length"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Yo={"==":Ts,"!=":ss,">":Bs,"<":Fs,">=":Ns,"<=":Ps,array:an,at:ro,boolean:an,case:ya,coalesce:bo,collator:fn,format:xn,image:_n,in:_o,"index-of":Co,interpolate:Ni,"interpolate-hcl":Ni,"interpolate-lab":Ni,length:zo,let:Ma,literal:hn,match:Va,number:an,"number-format":Do,object:an,slice:Qa,step:wn,string:an,"to-boolean":jr,"to-color":jr,"to-number":jr,"to-string":jr,var:Qr,within:kr};function Wo(M,O){var Y=O[0],ie=O[1],ye=O[2],we=O[3];Y=Y.evaluate(M),ie=ie.evaluate(M),ye=ye.evaluate(M);var Ce=we?we.evaluate(M):1,je=Sr(Y,ie,ye,Ce);if(je)throw new tn(je);return new Qt(Y/255*Ce,ie/255*Ce,ye/255*Ce,Ce)}function Zo(M,O){return M in O}function ls(M,O){var Y=O[M];return Y===void 0?null:Y}function wo(M){return{type:M}}function ks(M){return{result:"success",value:M}}function vo(M){return{result:"error",value:M}}function Xo(M){return M["property-type"]==="data-driven"||M["property-type"]==="cross-faded-data-driven"}function Ms(M){return!!M.expression&&M.expression.parameters.indexOf("zoom")>-1}function Ro(M){return!!M.expression&&M.expression.interpolated}function Gi(M){return M instanceof Number?"number":M instanceof String?"string":M instanceof Boolean?"boolean":Array.isArray(M)?"array":M===null?"null":typeof M}function Ue(M){return typeof M=="object"&&M!==null&&!Array.isArray(M)}function We(M){return M}function rt(M,O,Y){return M!==void 0?M:O!==void 0?O:Y!==void 0?Y:void 0}function ut(M,O,Y,ie,ye){return rt(typeof Y===ye?ie[Y]:void 0,M.default,O.default)}function yt(M,O,Y){if(Gi(Y)!=="number")return rt(M.default,O.default);var ie=M.stops.length;if(ie===1||Y<=M.stops[0][0])return M.stops[0][1];if(Y>=M.stops[ie-1][0])return M.stops[ie-1][1];var ye=yn(M.stops.map(function(we){return we[0]}),Y);return M.stops[ye][1]}function mt(M,O,Y){var ie=M.base!==void 0?M.base:1;if(Gi(Y)!=="number")return rt(M.default,O.default);var ye=M.stops.length;if(ye===1||Y<=M.stops[0][0])return M.stops[0][1];if(Y>=M.stops[ye-1][0])return M.stops[ye-1][1];var we=yn(M.stops.map(function(Bt){return Bt[0]}),Y),Ce=function(Bt,Xt,Yt,sr){var br=sr-Yt,Ir=Bt-Yt;return br===0?0:Xt===1?Ir/br:(Math.pow(Xt,Ir)-1)/(Math.pow(Xt,br)-1)}(Y,ie,M.stops[we][0],M.stops[we+1][0]),je=M.stops[we][1],tt=M.stops[we+1][1],ft=Pn[O.type]||We;if(M.colorSpace&&M.colorSpace!=="rgb"){var gt=to[M.colorSpace];ft=function(Bt,Xt){return gt.reverse(gt.interpolate(gt.forward(Bt),gt.forward(Xt),Ce))}}return typeof je.evaluate=="function"?{evaluate:function(){for(var Bt=[],Xt=arguments.length;Xt--;)Bt[Xt]=arguments[Xt];var Yt=je.evaluate.apply(void 0,Bt),sr=tt.evaluate.apply(void 0,Bt);if(Yt!==void 0&&sr!==void 0)return ft(Yt,sr,Ce)}}:ft(je,tt,Ce)}function Lt(M,O,Y){return O.type==="color"?Y=Qt.parse(Y):O.type==="formatted"?Y=fr.fromString(Y.toString()):O.type==="resolvedImage"?Y=yr.fromString(Y.toString()):Gi(Y)===O.type||O.type==="enum"&&O.values[Y]||(Y=void 0),rt(Y,M.default,O.default)}en.register(Yo,{error:[{kind:"error"},[ht],function(M,O){var Y=O[0];throw new tn(Y.evaluate(M))}],typeof:[ht,[Ee],function(M,O){return Ut(Nr(O[0].evaluate(M)))}],"to-rgba":[St(it,4),[kt],function(M,O){return O[0].evaluate(M).toArray()}],rgb:[kt,[it,it,it],Wo],rgba:[kt,[it,it,it,it],Wo],has:{type:jt,overloads:[[[ht],function(M,O){return Zo(O[0].evaluate(M),M.properties())}],[[ht,Pt],function(M,O){var Y=O[0],ie=O[1];return Zo(Y.evaluate(M),ie.evaluate(M))}]]},get:{type:Ee,overloads:[[[ht],function(M,O){return ls(O[0].evaluate(M),M.properties())}],[[ht,Pt],function(M,O){var Y=O[0],ie=O[1];return ls(Y.evaluate(M),ie.evaluate(M))}]]},"feature-state":[Ee,[ht],function(M,O){return ls(O[0].evaluate(M),M.featureState||{})}],properties:[Pt,[],function(M){return M.properties()}],"geometry-type":[ht,[],function(M){return M.geometryType()}],id:[Ee,[],function(M){return M.id()}],zoom:[it,[],function(M){return M.globals.zoom}],"heatmap-density":[it,[],function(M){return M.globals.heatmapDensity||0}],"line-progress":[it,[],function(M){return M.globals.lineProgress||0}],accumulated:[Ee,[],function(M){return M.globals.accumulated===void 0?null:M.globals.accumulated}],"+":[it,wo(it),function(M,O){for(var Y=0,ie=0,ye=O;ie<ye.length;ie+=1)Y+=ye[ie].evaluate(M);return Y}],"*":[it,wo(it),function(M,O){for(var Y=1,ie=0,ye=O;ie<ye.length;ie+=1)Y*=ye[ie].evaluate(M);return Y}],"-":{type:it,overloads:[[[it,it],function(M,O){var Y=O[0],ie=O[1];return Y.evaluate(M)-ie.evaluate(M)}],[[it],function(M,O){return-O[0].evaluate(M)}]]},"/":[it,[it,it],function(M,O){var Y=O[0],ie=O[1];return Y.evaluate(M)/ie.evaluate(M)}],"%":[it,[it,it],function(M,O){var Y=O[0],ie=O[1];return Y.evaluate(M)%ie.evaluate(M)}],ln2:[it,[],function(){return Math.LN2}],pi:[it,[],function(){return Math.PI}],e:[it,[],function(){return Math.E}],"^":[it,[it,it],function(M,O){var Y=O[0],ie=O[1];return Math.pow(Y.evaluate(M),ie.evaluate(M))}],sqrt:[it,[it],function(M,O){var Y=O[0];return Math.sqrt(Y.evaluate(M))}],log10:[it,[it],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))/Math.LN10}],ln:[it,[it],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))}],log2:[it,[it],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))/Math.LN2}],sin:[it,[it],function(M,O){var Y=O[0];return Math.sin(Y.evaluate(M))}],cos:[it,[it],function(M,O){var Y=O[0];return Math.cos(Y.evaluate(M))}],tan:[it,[it],function(M,O){var Y=O[0];return Math.tan(Y.evaluate(M))}],asin:[it,[it],function(M,O){var Y=O[0];return Math.asin(Y.evaluate(M))}],acos:[it,[it],function(M,O){var Y=O[0];return Math.acos(Y.evaluate(M))}],atan:[it,[it],function(M,O){var Y=O[0];return Math.atan(Y.evaluate(M))}],min:[it,wo(it),function(M,O){return Math.min.apply(Math,O.map(function(Y){return Y.evaluate(M)}))}],max:[it,wo(it),function(M,O){return Math.max.apply(Math,O.map(function(Y){return Y.evaluate(M)}))}],abs:[it,[it],function(M,O){var Y=O[0];return Math.abs(Y.evaluate(M))}],round:[it,[it],function(M,O){var Y=O[0].evaluate(M);return Y<0?-Math.round(-Y):Math.round(Y)}],floor:[it,[it],function(M,O){var Y=O[0];return Math.floor(Y.evaluate(M))}],ceil:[it,[it],function(M,O){var Y=O[0];return Math.ceil(Y.evaluate(M))}],"filter-==":[jt,[ht,Ee],function(M,O){var Y=O[0],ie=O[1];return M.properties()[Y.value]===ie.value}],"filter-id-==":[jt,[Ee],function(M,O){var Y=O[0];return M.id()===Y.value}],"filter-type-==":[jt,[ht],function(M,O){var Y=O[0];return M.geometryType()===Y.value}],"filter-<":[jt,[ht,Ee],function(M,O){var Y=O[0],ie=O[1],ye=M.properties()[Y.value],we=ie.value;return typeof ye==typeof we&&ye<we}],"filter-id-<":[jt,[Ee],function(M,O){var Y=O[0],ie=M.id(),ye=Y.value;return typeof ie==typeof ye&&ie<ye}],"filter->":[jt,[ht,Ee],function(M,O){var Y=O[0],ie=O[1],ye=M.properties()[Y.value],we=ie.value;return typeof ye==typeof we&&ye>we}],"filter-id->":[jt,[Ee],function(M,O){var Y=O[0],ie=M.id(),ye=Y.value;return typeof ie==typeof ye&&ie>ye}],"filter-<=":[jt,[ht,Ee],function(M,O){var Y=O[0],ie=O[1],ye=M.properties()[Y.value],we=ie.value;return typeof ye==typeof we&&ye<=we}],"filter-id-<=":[jt,[Ee],function(M,O){var Y=O[0],ie=M.id(),ye=Y.value;return typeof ie==typeof ye&&ie<=ye}],"filter->=":[jt,[ht,Ee],function(M,O){var Y=O[0],ie=O[1],ye=M.properties()[Y.value],we=ie.value;return typeof ye==typeof we&&ye>=we}],"filter-id->=":[jt,[Ee],function(M,O){var Y=O[0],ie=M.id(),ye=Y.value;return typeof ie==typeof ye&&ie>=ye}],"filter-has":[jt,[Ee],function(M,O){return O[0].value in M.properties()}],"filter-has-id":[jt,[],function(M){return M.id()!==null&&M.id()!==void 0}],"filter-type-in":[jt,[St(ht)],function(M,O){return O[0].value.indexOf(M.geometryType())>=0}],"filter-id-in":[jt,[St(Ee)],function(M,O){return O[0].value.indexOf(M.id())>=0}],"filter-in-small":[jt,[ht,St(Ee)],function(M,O){var Y=O[0];return O[1].value.indexOf(M.properties()[Y.value])>=0}],"filter-in-large":[jt,[ht,St(Ee)],function(M,O){var Y=O[0],ie=O[1];return function(ye,we,Ce,je){for(;Ce<=je;){var tt=Ce+je>>1;if(we[tt]===ye)return!0;we[tt]>ye?je=tt-1:Ce=tt+1}return!1}(M.properties()[Y.value],ie.value,0,ie.value.length-1)}],all:{type:jt,overloads:[[[jt,jt],function(M,O){var Y=O[0],ie=O[1];return Y.evaluate(M)&&ie.evaluate(M)}],[wo(jt),function(M,O){for(var Y=0,ie=O;Y<ie.length;Y+=1)if(!ie[Y].evaluate(M))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],function(M,O){var Y=O[0],ie=O[1];return Y.evaluate(M)||ie.evaluate(M)}],[wo(jt),function(M,O){for(var Y=0,ie=O;Y<ie.length;Y+=1)if(ie[Y].evaluate(M))return!0;return!1}]]},"!":[jt,[jt],function(M,O){return!O[0].evaluate(M)}],"is-supported-script":[jt,[ht],function(M,O){var Y=O[0],ie=M.globals&&M.globals.isSupportedScript;return!ie||ie(Y.evaluate(M))}],upcase:[ht,[ht],function(M,O){return O[0].evaluate(M).toUpperCase()}],downcase:[ht,[ht],function(M,O){return O[0].evaluate(M).toLowerCase()}],concat:[ht,wo(Ee),function(M,O){return O.map(function(Y){return Wr(Y.evaluate(M))}).join("")}],"resolved-locale":[ht,[Ze],function(M,O){return O[0].evaluate(M).resolvedLocale()}]});var $t=function(M,O){this.expression=M,this._warningHistory={},this._evaluator=new vn,this._defaultValue=O?function(Y){return Y.type==="color"&&Ue(Y.default)?new Qt(0,0,0,0):Y.type==="color"?Qt.parse(Y.default)||null:Y.default===void 0?null:Y.default}(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};function er(M){return Array.isArray(M)&&M.length>0&&typeof M[0]=="string"&&M[0]in Yo}function Zt(M,O){var Y=new rn(Yo,[],O?function(ye){var we={color:kt,string:ht,number:it,enum:ht,boolean:jt,formatted:at,resolvedImage:pt};return ye.type==="array"?St(we[ye.value]||Ee,ye.length):we[ye.type]}(O):void 0),ie=Y.parse(M,void 0,void 0,void 0,O&&O.type==="string"?{typeAnnotation:"coerce"}:void 0);return ie?ks(new $t(ie,O)):vo(Y.errors)}$t.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ie,ye,we){return this._evaluator.globals=M,this._evaluator.feature=O,this._evaluator.featureState=Y,this._evaluator.canonical=ie,this._evaluator.availableImages=ye||null,this._evaluator.formattedSection=we,this.expression.evaluate(this._evaluator)},$t.prototype.evaluate=function(M,O,Y,ie,ye,we){this._evaluator.globals=M,this._evaluator.feature=O||null,this._evaluator.featureState=Y||null,this._evaluator.canonical=ie,this._evaluator.availableImages=ye||null,this._evaluator.formattedSection=we||null;try{var Ce=this.expression.evaluate(this._evaluator);if(Ce==null||typeof Ce=="number"&&Ce!=Ce)return this._defaultValue;if(this._enumValues&&!(Ce in this._enumValues))throw new tn("Expected value to be one of "+Object.keys(this._enumValues).map(function(je){return JSON.stringify(je)}).join(", ")+", but found "+JSON.stringify(Ce)+" instead.");return Ce}catch(je){return this._warningHistory[je.message]||(this._warningHistory[je.message]=!0,typeof console<"u"&&console.warn(je.message)),this._defaultValue}};var or=function(M,O){this.kind=M,this._styleExpression=O,this.isStateDependent=M!=="constant"&&!Gr(O.expression)};or.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ie,ye,we){return this._styleExpression.evaluateWithoutErrorHandling(M,O,Y,ie,ye,we)},or.prototype.evaluate=function(M,O,Y,ie,ye,we){return this._styleExpression.evaluate(M,O,Y,ie,ye,we)};var mr=function(M,O,Y,ie){this.kind=M,this.zoomStops=Y,this._styleExpression=O,this.isStateDependent=M!=="camera"&&!Gr(O.expression),this.interpolationType=ie};function wr(M,O){if((M=Zt(M,O)).result==="error")return M;var Y=M.value.expression,ie=Cr(Y);if(!ie&&!Xo(O))return vo([new st("","data expressions not supported")]);var ye=qr(Y,["zoom"]);if(!ye&&!Ms(O))return vo([new st("","zoom expressions not supported")]);var we=function je(tt){var ft=null;if(tt instanceof Ma)ft=je(tt.result);else if(tt instanceof bo)for(var gt=0,Bt=tt.args;gt<Bt.length;gt+=1){var Xt=Bt[gt];if(ft=je(Xt))break}else(tt instanceof wn||tt instanceof Ni)&&tt.input instanceof en&&tt.input.name==="zoom"&&(ft=tt);return ft instanceof st||tt.eachChild(function(Yt){var sr=je(Yt);sr instanceof st?ft=sr:!ft&&sr?ft=new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ft&&sr&&ft!==sr&&(ft=new st("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ft}(Y);if(!we&&!ye)return vo([new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(we instanceof st)return vo([we]);if(we instanceof Ni&&!Ro(O))return vo([new st("",'"interpolate" expressions cannot be used with this property')]);if(!we)return ks(new or(ie?"constant":"source",M.value));var Ce=we instanceof Ni?we.interpolation:void 0;return ks(new mr(ie?"camera":"composite",M.value,we.labels,Ce))}mr.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ie,ye,we){return this._styleExpression.evaluateWithoutErrorHandling(M,O,Y,ie,ye,we)},mr.prototype.evaluate=function(M,O,Y,ie,ye,we){return this._styleExpression.evaluate(M,O,Y,ie,ye,we)},mr.prototype.interpolationFactor=function(M,O,Y){return this.interpolationType?Ni.interpolationFactor(this.interpolationType,M,O,Y):0};var Tr=function(M,O){this._parameters=M,this._specification=O,Ke(this,function Y(ie,ye){var we,Ce,je,tt=ye.type==="color",ft=ie.stops&&typeof ie.stops[0][0]=="object",gt=ft||ie.property!==void 0,Bt=ft||!gt,Xt=ie.type||(Ro(ye)?"exponential":"interval");if(tt&&((ie=Ke({},ie)).stops&&(ie.stops=ie.stops.map(function(ci){return[ci[0],Qt.parse(ci[1])]})),ie.default?ie.default=Qt.parse(ie.default):ie.default=Qt.parse(ye.default)),ie.colorSpace&&ie.colorSpace!=="rgb"&&!to[ie.colorSpace])throw new Error("Unknown color space: "+ie.colorSpace);if(Xt==="exponential")we=mt;else if(Xt==="interval")we=yt;else if(Xt==="categorical"){we=ut,Ce=Object.create(null);for(var Yt=0,sr=ie.stops;Yt<sr.length;Yt+=1){var br=sr[Yt];Ce[br[0]]=br[1]}je=typeof ie.stops[0][0]}else{if(Xt!=="identity")throw new Error('Unknown function type "'+Xt+'"');we=Lt}if(ft){for(var Ir={},Pr=[],Vr=0;Vr<ie.stops.length;Vr++){var Hr=ie.stops[Vr],Zr=Hr[0].zoom;Ir[Zr]===void 0&&(Ir[Zr]={zoom:Zr,type:ie.type,property:ie.property,default:ie.default,stops:[]},Pr.push(Zr)),Ir[Zr].stops.push([Hr[0].value,Hr[1]])}for(var pn=[],bn=0,jn=Pr;bn<jn.length;bn+=1){var Nn=jn[bn];pn.push([Ir[Nn].zoom,Y(Ir[Nn],ye)])}var Wn={name:"linear"};return{kind:"composite",interpolationType:Wn,interpolationFactor:Ni.interpolationFactor.bind(void 0,Wn),zoomStops:pn.map(function(ci){return ci[0]}),evaluate:function(ci,$n){var mi=ci.zoom;return mt({stops:pn,base:ie.base},ye,mi).evaluate(mi,$n)}}}if(Bt){var li=Xt==="exponential"?{name:"exponential",base:ie.base!==void 0?ie.base:1}:null;return{kind:"camera",interpolationType:li,interpolationFactor:Ni.interpolationFactor.bind(void 0,li),zoomStops:ie.stops.map(function(ci){return ci[0]}),evaluate:function(ci){var $n=ci.zoom;return we(ie,ye,$n,Ce,je)}}}return{kind:"source",evaluate:function(ci,$n){var mi=$n&&$n.properties?$n.properties[ie.property]:void 0;return mi===void 0?rt(ie.default,ye.default):we(ie,ye,mi,Ce,je)}}}(this._parameters,this._specification))};function Rr(M){var O=M.key,Y=M.value,ie=M.valueSpec||{},ye=M.objectElementValidators||{},we=M.style,Ce=M.styleSpec,je=[],tt=Gi(Y);if(tt!=="object")return[new Fe(O,Y,"object expected, "+tt+" found")];for(var ft in Y){var gt=ft.split(".")[0],Bt=ie[gt]||ie["*"],Xt=void 0;if(ye[gt])Xt=ye[gt];else if(ie[gt])Xt=cr;else if(ye["*"])Xt=ye["*"];else{if(!ie["*"]){je.push(new Fe(O,Y[ft],'unknown property "'+ft+'"'));continue}Xt=cr}je=je.concat(Xt({key:(O&&O+".")+ft,value:Y[ft],valueSpec:Bt,style:we,styleSpec:Ce,object:Y,objectKey:ft},Y))}for(var Yt in ie)ye[Yt]||ie[Yt].required&&ie[Yt].default===void 0&&Y[Yt]===void 0&&je.push(new Fe(O,Y,'missing required property "'+Yt+'"'));return je}function on(M){var O=M.value,Y=M.valueSpec,ie=M.style,ye=M.styleSpec,we=M.key,Ce=M.arrayElementValidator||cr;if(Gi(O)!=="array")return[new Fe(we,O,"array expected, "+Gi(O)+" found")];if(Y.length&&O.length!==Y.length)return[new Fe(we,O,"array length "+Y.length+" expected, length "+O.length+" found")];if(Y["min-length"]&&O.length<Y["min-length"])return[new Fe(we,O,"array length at least "+Y["min-length"]+" expected, length "+O.length+" found")];var je={type:Y.value,values:Y.values};ye.$version<7&&(je.function=Y.function),Gi(Y.value)==="object"&&(je=Y.value);for(var tt=[],ft=0;ft<O.length;ft++)tt=tt.concat(Ce({array:O,arrayIndex:ft,value:O[ft],valueSpec:je,style:ie,styleSpec:ye,key:we+"["+ft+"]"}));return tt}function mn(M){var O=M.key,Y=M.value,ie=M.valueSpec,ye=Gi(Y);return ye==="number"&&Y!=Y&&(ye="NaN"),ye!=="number"?[new Fe(O,Y,"number expected, "+ye+" found")]:"minimum"in ie&&Y<ie.minimum?[new Fe(O,Y,Y+" is less than the minimum value "+ie.minimum)]:"maximum"in ie&&Y>ie.maximum?[new Fe(O,Y,Y+" is greater than the maximum value "+ie.maximum)]:[]}function In(M){var O,Y,ie,ye=M.valueSpec,we=Ge(M.value.type),Ce={},je=we!=="categorical"&&M.value.property===void 0,tt=!je,ft=Gi(M.value.stops)==="array"&&Gi(M.value.stops[0])==="array"&&Gi(M.value.stops[0][0])==="object",gt=Rr({key:M.key,value:M.value,valueSpec:M.styleSpec.function,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{stops:function(Yt){if(we==="identity")return[new Fe(Yt.key,Yt.value,'identity function may not have a "stops" property')];var sr=[],br=Yt.value;return sr=sr.concat(on({key:Yt.key,value:br,valueSpec:Yt.valueSpec,style:Yt.style,styleSpec:Yt.styleSpec,arrayElementValidator:Bt})),Gi(br)==="array"&&br.length===0&&sr.push(new Fe(Yt.key,br,"array must have at least one stop")),sr},default:function(Yt){return cr({key:Yt.key,value:Yt.value,valueSpec:ye,style:Yt.style,styleSpec:Yt.styleSpec})}}});return we==="identity"&&je&&gt.push(new Fe(M.key,M.value,'missing required property "property"')),we==="identity"||M.value.stops||gt.push(new Fe(M.key,M.value,'missing required property "stops"')),we==="exponential"&&M.valueSpec.expression&&!Ro(M.valueSpec)&&gt.push(new Fe(M.key,M.value,"exponential functions not supported")),M.styleSpec.$version>=8&&(tt&&!Xo(M.valueSpec)?gt.push(new Fe(M.key,M.value,"property functions not supported")):je&&!Ms(M.valueSpec)&&gt.push(new Fe(M.key,M.value,"zoom functions not supported"))),we!=="categorical"&&!ft||M.value.property!==void 0||gt.push(new Fe(M.key,M.value,'"property" property is required')),gt;function Bt(Yt){var sr=[],br=Yt.value,Ir=Yt.key;if(Gi(br)!=="array")return[new Fe(Ir,br,"array expected, "+Gi(br)+" found")];if(br.length!==2)return[new Fe(Ir,br,"array length 2 expected, length "+br.length+" found")];if(ft){if(Gi(br[0])!=="object")return[new Fe(Ir,br,"object expected, "+Gi(br[0])+" found")];if(br[0].zoom===void 0)return[new Fe(Ir,br,"object stop key must have zoom")];if(br[0].value===void 0)return[new Fe(Ir,br,"object stop key must have value")];if(ie&&ie>Ge(br[0].zoom))return[new Fe(Ir,br[0].zoom,"stop zoom values must appear in ascending order")];Ge(br[0].zoom)!==ie&&(ie=Ge(br[0].zoom),Y=void 0,Ce={}),sr=sr.concat(Rr({key:Ir+"[0]",value:br[0],valueSpec:{zoom:{}},style:Yt.style,styleSpec:Yt.styleSpec,objectElementValidators:{zoom:mn,value:Xt}}))}else sr=sr.concat(Xt({key:Ir+"[0]",value:br[0],valueSpec:{},style:Yt.style,styleSpec:Yt.styleSpec},br));return er(ct(br[1]))?sr.concat([new Fe(Ir+"[1]",br[1],"expressions are not allowed in function stops.")]):sr.concat(cr({key:Ir+"[1]",value:br[1],valueSpec:ye,style:Yt.style,styleSpec:Yt.styleSpec}))}function Xt(Yt,sr){var br=Gi(Yt.value),Ir=Ge(Yt.value),Pr=Yt.value!==null?Yt.value:sr;if(O){if(br!==O)return[new Fe(Yt.key,Pr,br+" stop domain type must match previous stop domain type "+O)]}else O=br;if(br!=="number"&&br!=="string"&&br!=="boolean")return[new Fe(Yt.key,Pr,"stop domain value must be a number, string, or boolean")];if(br!=="number"&&we!=="categorical"){var Vr="number expected, "+br+" found";return Xo(ye)&&we===void 0&&(Vr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(Yt.key,Pr,Vr)]}return we!=="categorical"||br!=="number"||isFinite(Ir)&&Math.floor(Ir)===Ir?we!=="categorical"&&br==="number"&&Y!==void 0&&Ir<Y?[new Fe(Yt.key,Pr,"stop domain values must appear in ascending order")]:(Y=Ir,we==="categorical"&&Ir in Ce?[new Fe(Yt.key,Pr,"stop domain values must be unique")]:(Ce[Ir]=!0,[])):[new Fe(Yt.key,Pr,"integer expected, found "+Ir)]}}function zn(M){var O=(M.expressionContext==="property"?wr:Zt)(ct(M.value),M.valueSpec);if(O.result==="error")return O.value.map(function(ie){return new Fe(""+M.key+ie.key,M.value,ie.message)});var Y=O.value.expression||O.value._styleExpression.expression;if(M.expressionContext==="property"&&M.propertyKey==="text-font"&&!Y.outputDefined())return[new Fe(M.key,M.value,'Invalid data expression for "'+M.propertyKey+'". Output values must be contained as literals within the expression.')];if(M.expressionContext==="property"&&M.propertyType==="layout"&&!Gr(Y))return[new Fe(M.key,M.value,'"feature-state" data expressions are not supported with layout properties.')];if(M.expressionContext==="filter"&&!Gr(Y))return[new Fe(M.key,M.value,'"feature-state" data expressions are not supported with filters.')];if(M.expressionContext&&M.expressionContext.indexOf("cluster")===0){if(!qr(Y,["zoom","feature-state"]))return[new Fe(M.key,M.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(M.expressionContext==="cluster-initial"&&!Cr(Y))return[new Fe(M.key,M.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qn(M){var O=M.key,Y=M.value,ie=M.valueSpec,ye=[];return Array.isArray(ie.values)?ie.values.indexOf(Ge(Y))===-1&&ye.push(new Fe(O,Y,"expected one of ["+ie.values.join(", ")+"], "+JSON.stringify(Y)+" found")):Object.keys(ie.values).indexOf(Ge(Y))===-1&&ye.push(new Fe(O,Y,"expected one of ["+Object.keys(ie.values).join(", ")+"], "+JSON.stringify(Y)+" found")),ye}function Rn(M){if(M===!0||M===!1)return!0;if(!Array.isArray(M)||M.length===0)return!1;switch(M[0]){case"has":return M.length>=2&&M[1]!=="$id"&&M[1]!=="$type";case"in":return M.length>=3&&(typeof M[1]!="string"||Array.isArray(M[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return M.length!==3||Array.isArray(M[1])||Array.isArray(M[2]);case"any":case"all":for(var O=0,Y=M.slice(1);O<Y.length;O+=1){var ie=Y[O];if(!Rn(ie)&&typeof ie!="boolean")return!1}return!0;default:return!0}}Tr.deserialize=function(M){return new Tr(M._parameters,M._specification)},Tr.serialize=function(M){return{_parameters:M._parameters,_specification:M._specification}};var vi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Si(M){if(M==null)return{filter:function(){return!0},needGeometry:!1};Rn(M)||(M=ji(M));var O=Zt(M,vi);if(O.result==="error")throw new Error(O.value.map(function(Y){return Y.key+": "+Y.message}).join(", "));return{filter:function(Y,ie,ye){return O.value.evaluate(Y,ie,{},ye)},needGeometry:function Y(ie){if(!Array.isArray(ie))return!1;if(ie[0]==="within")return!0;for(var ye=1;ye<ie.length;ye++)if(Y(ie[ye]))return!0;return!1}(M)}}function Ui(M,O){return M<O?-1:M>O?1:0}function ji(M){if(!M)return!0;var O,Y=M[0];return M.length<=1?Y!=="any":Y==="=="?Vi(M[1],M[2],"=="):Y==="!="?ca(Vi(M[1],M[2],"==")):Y==="<"||Y===">"||Y==="<="||Y===">="?Vi(M[1],M[2],Y):Y==="any"?(O=M.slice(1),["any"].concat(O.map(ji))):Y==="all"?["all"].concat(M.slice(1).map(ji)):Y==="none"?["all"].concat(M.slice(1).map(ji).map(ca)):Y==="in"?Aa(M[1],M.slice(2)):Y==="!in"?ca(Aa(M[1],M.slice(2))):Y==="has"?Ta(M[1]):Y==="!has"?ca(Ta(M[1])):Y!=="within"||M}function Vi(M,O,Y){switch(M){case"$type":return["filter-type-"+Y,O];case"$id":return["filter-id-"+Y,O];default:return["filter-"+Y,M,O]}}function Aa(M,O){if(O.length===0)return!1;switch(M){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(Y){return typeof Y!=typeof O[0]})?["filter-in-large",M,["literal",O.sort(Ui)]]:["filter-in-small",M,["literal",O]]}}function Ta(M){switch(M){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",M]}}function ca(M){return["!",M]}function ua(M){return Rn(ct(M.value))?zn(Ke({},M,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(Y){var ie=Y.value,ye=Y.key;if(Gi(ie)!=="array")return[new Fe(ye,ie,"array expected, "+Gi(ie)+" found")];var we,Ce=Y.styleSpec,je=[];if(ie.length<1)return[new Fe(ye,ie,"filter array must have at least 1 element")];switch(je=je.concat(qn({key:ye+"[0]",value:ie[0],valueSpec:Ce.filter_operator,style:Y.style,styleSpec:Y.styleSpec})),Ge(ie[0])){case"<":case"<=":case">":case">=":ie.length>=2&&Ge(ie[1])==="$type"&&je.push(new Fe(ye,ie,'"$type" cannot be use with operator "'+ie[0]+'"'));case"==":case"!=":ie.length!==3&&je.push(new Fe(ye,ie,'filter array for operator "'+ie[0]+'" must have 3 elements'));case"in":case"!in":ie.length>=2&&(we=Gi(ie[1]))!=="string"&&je.push(new Fe(ye+"[1]",ie[1],"string expected, "+we+" found"));for(var tt=2;tt<ie.length;tt++)we=Gi(ie[tt]),Ge(ie[1])==="$type"?je=je.concat(qn({key:ye+"["+tt+"]",value:ie[tt],valueSpec:Ce.geometry_type,style:Y.style,styleSpec:Y.styleSpec})):we!=="string"&&we!=="number"&&we!=="boolean"&&je.push(new Fe(ye+"["+tt+"]",ie[tt],"string, number, or boolean expected, "+we+" found"));break;case"any":case"all":case"none":for(var ft=1;ft<ie.length;ft++)je=je.concat(O({key:ye+"["+ft+"]",value:ie[ft],style:Y.style,styleSpec:Y.styleSpec}));break;case"has":case"!has":we=Gi(ie[1]),ie.length!==2?je.push(new Fe(ye,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):we!=="string"&&je.push(new Fe(ye+"[1]",ie[1],"string expected, "+we+" found"));break;case"within":we=Gi(ie[1]),ie.length!==2?je.push(new Fe(ye,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):we!=="object"&&je.push(new Fe(ye+"[1]",ie[1],"object expected, "+we+" found"))}return je}(M)}function ka(M,O){var Y=M.key,ie=M.style,ye=M.styleSpec,we=M.value,Ce=M.objectKey,je=ye[O+"_"+M.layerType];if(!je)return[];var tt=Ce.match(/^(.*)-transition$/);if(O==="paint"&&tt&&je[tt[1]]&&je[tt[1]].transition)return cr({key:Y,value:we,valueSpec:ye.transition,style:ie,styleSpec:ye});var ft,gt=M.valueSpec||je[Ce];if(!gt)return[new Fe(Y,we,'unknown property "'+Ce+'"')];if(Gi(we)==="string"&&Xo(gt)&&!gt.tokens&&(ft=/^{([^}]+)}$/.exec(we)))return[new Fe(Y,we,'"'+Ce+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ft[1])+" }`.")];var Bt=[];return M.layerType==="symbol"&&(Ce==="text-field"&&ie&&!ie.glyphs&&Bt.push(new Fe(Y,we,'use of "text-field" requires a style "glyphs" property')),Ce==="text-font"&&Ue(ct(we))&&Ge(we.type)==="identity"&&Bt.push(new Fe(Y,we,'"text-font" does not support identity functions'))),Bt.concat(cr({key:M.key,value:we,valueSpec:gt,style:ie,styleSpec:ye,expressionContext:"property",propertyType:O,propertyKey:Ce}))}function Ha(M){return ka(M,"paint")}function no(M){return ka(M,"layout")}function io(M){var O=[],Y=M.value,ie=M.key,ye=M.style,we=M.styleSpec;Y.type||Y.ref||O.push(new Fe(ie,Y,'either "type" or "ref" is required'));var Ce,je=Ge(Y.type),tt=Ge(Y.ref);if(Y.id)for(var ft=Ge(Y.id),gt=0;gt<M.arrayIndex;gt++){var Bt=ye.layers[gt];Ge(Bt.id)===ft&&O.push(new Fe(ie,Y.id,'duplicate layer id "'+Y.id+'", previously used at line '+Bt.id.__line__))}if("ref"in Y)["type","source","source-layer","filter","layout"].forEach(function(sr){sr in Y&&O.push(new Fe(ie,Y[sr],'"'+sr+'" is prohibited for ref layers'))}),ye.layers.forEach(function(sr){Ge(sr.id)===tt&&(Ce=sr)}),Ce?Ce.ref?O.push(new Fe(ie,Y.ref,"ref cannot reference another ref layer")):je=Ge(Ce.type):O.push(new Fe(ie,Y.ref,'ref layer "'+tt+'" not found'));else if(je!=="background")if(Y.source){var Xt=ye.sources&&ye.sources[Y.source],Yt=Xt&&Ge(Xt.type);Xt?Yt==="vector"&&je==="raster"?O.push(new Fe(ie,Y.source,'layer "'+Y.id+'" requires a raster source')):Yt==="raster"&&je!=="raster"?O.push(new Fe(ie,Y.source,'layer "'+Y.id+'" requires a vector source')):Yt!=="vector"||Y["source-layer"]?Yt==="raster-dem"&&je!=="hillshade"?O.push(new Fe(ie,Y.source,"raster-dem source can only be used with layer type 'hillshade'.")):je!=="line"||!Y.paint||!Y.paint["line-gradient"]||Yt==="geojson"&&Xt.lineMetrics||O.push(new Fe(ie,Y,'layer "'+Y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new Fe(ie,Y,'layer "'+Y.id+'" must specify a "source-layer"')):O.push(new Fe(ie,Y.source,'source "'+Y.source+'" not found'))}else O.push(new Fe(ie,Y,'missing required property "source"'));return O=O.concat(Rr({key:ie,value:Y,valueSpec:we.layer,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return cr({key:ie+".type",value:Y.type,valueSpec:we.layer.type,style:M.style,styleSpec:M.styleSpec,object:Y,objectKey:"type"})},filter:ua,layout:function(sr){return Rr({layer:Y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(br){return no(Ke({layerType:je},br))}}})},paint:function(sr){return Rr({layer:Y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(br){return Ha(Ke({layerType:je},br))}}})}}}))}function ao(M){var O=M.value,Y=M.key,ie=Gi(O);return ie!=="string"?[new Fe(Y,O,"string expected, "+ie+" found")]:[]}var oo={promoteId:function(M){var O=M.key,Y=M.value;if(Gi(Y)==="string")return ao({key:O,value:Y});var ie=[];for(var ye in Y)ie.push.apply(ie,ao({key:O+"."+ye,value:Y[ye]}));return ie}};function zi(M){var O=M.value,Y=M.key,ie=M.styleSpec,ye=M.style;if(!O.type)return[new Fe(Y,O,'"type" is required')];var we,Ce=Ge(O.type);switch(Ce){case"vector":case"raster":case"raster-dem":return we=Rr({key:Y,value:O,valueSpec:ie["source_"+Ce.replace("-","_")],style:M.style,styleSpec:ie,objectElementValidators:oo});case"geojson":if(we=Rr({key:Y,value:O,valueSpec:ie.source_geojson,style:ye,styleSpec:ie,objectElementValidators:oo}),O.cluster)for(var je in O.clusterProperties){var tt=O.clusterProperties[je],ft=tt[0],gt=tt[1],Bt=typeof ft=="string"?[ft,["accumulated"],["get",je]]:ft;we.push.apply(we,zn({key:Y+"."+je+".map",value:gt,expressionContext:"cluster-map"})),we.push.apply(we,zn({key:Y+"."+je+".reduce",value:Bt,expressionContext:"cluster-reduce"}))}return we;case"video":return Rr({key:Y,value:O,valueSpec:ie.source_video,style:ye,styleSpec:ie});case"image":return Rr({key:Y,value:O,valueSpec:ie.source_image,style:ye,styleSpec:ie});case"canvas":return[new Fe(Y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qn({key:Y+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:ye,styleSpec:ie})}}function dt(M){var O=M.value,Y=M.styleSpec,ie=Y.light,ye=M.style,we=[],Ce=Gi(O);if(O===void 0)return we;if(Ce!=="object")return we=we.concat([new Fe("light",O,"object expected, "+Ce+" found")]);for(var je in O){var tt=je.match(/^(.*)-transition$/);we=tt&&ie[tt[1]]&&ie[tt[1]].transition?we.concat(cr({key:je,value:O[je],valueSpec:Y.transition,style:ye,styleSpec:Y})):ie[je]?we.concat(cr({key:je,value:O[je],valueSpec:ie[je],style:ye,styleSpec:Y})):we.concat([new Fe(je,O[je],'unknown property "'+je+'"')])}return we}var Rt={"*":function(){return[]},array:on,boolean:function(M){var O=M.value,Y=M.key,ie=Gi(O);return ie!=="boolean"?[new Fe(Y,O,"boolean expected, "+ie+" found")]:[]},number:mn,color:function(M){var O=M.key,Y=M.value,ie=Gi(Y);return ie!=="string"?[new Fe(O,Y,"color expected, "+ie+" found")]:hr(Y)===null?[new Fe(O,Y,'color expected, "'+Y+'" found')]:[]},constants:Ve,enum:qn,filter:ua,function:In,layer:io,object:Rr,source:zi,light:dt,string:ao,formatted:function(M){return ao(M).length===0?[]:zn(M)},resolvedImage:function(M){return ao(M).length===0?[]:zn(M)}};function cr(M){var O=M.value,Y=M.valueSpec,ie=M.styleSpec;return Y.expression&&Ue(Ge(O))?In(M):Y.expression&&er(ct(O))?zn(M):Y.type&&Rt[Y.type]?Rt[Y.type](M):Rr(Ke({},M,{valueSpec:Y.type?ie[Y.type]:Y}))}function Gt(M){var O=M.value,Y=M.key,ie=ao(M);return ie.length||(O.indexOf("{fontstack}")===-1&&ie.push(new Fe(Y,O,'"glyphs" url must include a "{fontstack}" token')),O.indexOf("{range}")===-1&&ie.push(new Fe(Y,O,'"glyphs" url must include a "{range}" token'))),ie}function ur(M,O){O===void 0&&(O=be);var Y=[];return Y=Y.concat(cr({key:"",value:M,valueSpec:O.$root,styleSpec:O,style:M,objectElementValidators:{glyphs:Gt,"*":function(){return[]}}})),M.constants&&(Y=Y.concat(Ve({key:"constants",value:M.constants,style:M,styleSpec:O}))),Or(Y)}function Or(M){return[].concat(M).sort(function(O,Y){return O.line-Y.line})}function Ur(M){return function(){for(var O=[],Y=arguments.length;Y--;)O[Y]=arguments[Y];return Or(M.apply(this,O))}}ur.source=Ur(zi),ur.light=Ur(dt),ur.layer=Ur(io),ur.filter=Ur(ua),ur.paintProperty=Ur(Ha),ur.layoutProperty=Ur(no);var Xr=ur,cn=Xr.light,sn=Xr.paintProperty,gn=Xr.layoutProperty;function Mn(M,O){var Y=!1;if(O&&O.length)for(var ie=0,ye=O;ie<ye.length;ie+=1){var we=ye[ie];M.fire(new qe(new Error(we.message))),Y=!0}return Y}var un=An;function An(M,O,Y){var ie=this.cells=[];if(M instanceof ArrayBuffer){this.arrayBuffer=M;var ye=new Int32Array(this.arrayBuffer);M=ye[0],O=ye[1],Y=ye[2],this.d=O+2*Y;for(var we=0;we<this.d*this.d;we++){var Ce=ye[3+we],je=ye[3+we+1];ie.push(Ce===je?null:ye.subarray(Ce,je))}var tt=ye[3+ie.length],ft=ye[3+ie.length+1];this.keys=ye.subarray(tt,ft),this.bboxes=ye.subarray(ft),this.insert=this._insertReadonly}else{this.d=O+2*Y;for(var gt=0;gt<this.d*this.d;gt++)ie.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=M,this.padding=Y,this.scale=O/M,this.uid=0;var Bt=Y/O*M;this.min=-Bt,this.max=M+Bt}An.prototype.insert=function(M,O,Y,ie,ye){this._forEachCell(O,Y,ie,ye,this._insertCell,this.uid++),this.keys.push(M),this.bboxes.push(O),this.bboxes.push(Y),this.bboxes.push(ie),this.bboxes.push(ye)},An.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},An.prototype._insertCell=function(M,O,Y,ie,ye,we){this.cells[ye].push(we)},An.prototype.query=function(M,O,Y,ie,ye){var we=this.min,Ce=this.max;if(M<=we&&O<=we&&Ce<=Y&&Ce<=ie&&!ye)return Array.prototype.slice.call(this.keys);var je=[];return this._forEachCell(M,O,Y,ie,this._queryCell,je,{},ye),je},An.prototype._queryCell=function(M,O,Y,ie,ye,we,Ce,je){var tt=this.cells[ye];if(tt!==null)for(var ft=this.keys,gt=this.bboxes,Bt=0;Bt<tt.length;Bt++){var Xt=tt[Bt];if(Ce[Xt]===void 0){var Yt=4*Xt;(je?je(gt[Yt+0],gt[Yt+1],gt[Yt+2],gt[Yt+3]):M<=gt[Yt+2]&&O<=gt[Yt+3]&&Y>=gt[Yt+0]&&ie>=gt[Yt+1])?(Ce[Xt]=!0,we.push(ft[Xt])):Ce[Xt]=!1}}},An.prototype._forEachCell=function(M,O,Y,ie,ye,we,Ce,je){for(var tt=this._convertToCellCoord(M),ft=this._convertToCellCoord(O),gt=this._convertToCellCoord(Y),Bt=this._convertToCellCoord(ie),Xt=tt;Xt<=gt;Xt++)for(var Yt=ft;Yt<=Bt;Yt++){var sr=this.d*Yt+Xt;if((!je||je(this._convertFromCellCoord(Xt),this._convertFromCellCoord(Yt),this._convertFromCellCoord(Xt+1),this._convertFromCellCoord(Yt+1)))&&ye.call(this,M,O,Y,ie,sr,we,Ce,je))return}},An.prototype._convertFromCellCoord=function(M){return(M-this.padding)/this.scale},An.prototype._convertToCellCoord=function(M){return Math.max(0,Math.min(this.d-1,Math.floor(M*this.scale)+this.padding))},An.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var M=this.cells,O=3+this.cells.length+1+1,Y=0,ie=0;ie<this.cells.length;ie++)Y+=this.cells[ie].length;var ye=new Int32Array(O+Y+this.keys.length+this.bboxes.length);ye[0]=this.extent,ye[1]=this.n,ye[2]=this.padding;for(var we=O,Ce=0;Ce<M.length;Ce++){var je=M[Ce];ye[3+Ce]=we,ye.set(je,we),we+=je.length}return ye[3+M.length]=we,ye.set(this.keys,we),we+=this.keys.length,ye[3+M.length+1]=we,ye.set(this.bboxes,we),we+=this.bboxes.length,ye.buffer};var Bn=self.ImageData,Hn=self.ImageBitmap,si={};function Kr(M,O,Y){Y===void 0&&(Y={}),Object.defineProperty(O,"_classRegistryKey",{value:M,writeable:!1}),si[M]={klass:O,omit:Y.omit||[],shallow:Y.shallow||[]}}for(var ni in Kr("Object",Object),un.serialize=function(M,O){var Y=M.toArrayBuffer();return O&&O.push(Y),{buffer:Y}},un.deserialize=function(M){return new un(M.buffer)},Kr("Grid",un),Kr("Color",Qt),Kr("Error",Error),Kr("ResolvedImage",yr),Kr("StylePropertyFunction",Tr),Kr("StyleExpression",$t,{omit:["_evaluator"]}),Kr("ZoomDependentExpression",mr),Kr("ZoomConstantExpression",or),Kr("CompoundExpression",en,{omit:["_evaluate"]}),Yo)Yo[ni]._classRegistryKey||Kr("Expression_"+ni,Yo[ni]);function On(M){return M&&typeof ArrayBuffer<"u"&&(M instanceof ArrayBuffer||M.constructor&&M.constructor.name==="ArrayBuffer")}function Un(M){return Hn&&M instanceof Hn}function ri(M,O){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp)return M;if(On(M)||Un(M))return O&&O.push(M),M;if(ArrayBuffer.isView(M)){var Y=M;return O&&O.push(Y.buffer),Y}if(M instanceof Bn)return O&&O.push(M.data.buffer),M;if(Array.isArray(M)){for(var ie=[],ye=0,we=M;ye<we.length;ye+=1){var Ce=we[ye];ie.push(ri(Ce,O))}return ie}if(typeof M=="object"){var je=M.constructor,tt=je._classRegistryKey;if(!tt)throw new Error("can't serialize object of unregistered class");var ft=je.serialize?je.serialize(M,O):{};if(!je.serialize){for(var gt in M)if(M.hasOwnProperty(gt)&&!(si[tt].omit.indexOf(gt)>=0)){var Bt=M[gt];ft[gt]=si[tt].shallow.indexOf(gt)>=0?Bt:ri(Bt,O)}M instanceof Error&&(ft.message=M.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return tt!=="Object"&&(ft.$name=tt),ft}throw new Error("can't serialize object of type "+typeof M)}function ki(M){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp||On(M)||Un(M)||ArrayBuffer.isView(M)||M instanceof Bn)return M;if(Array.isArray(M))return M.map(ki);if(typeof M=="object"){var O=M.$name||"Object",Y=si[O].klass;if(!Y)throw new Error("can't deserialize unregistered class "+O);if(Y.deserialize)return Y.deserialize(M);for(var ie=Object.create(Y.prototype),ye=0,we=Object.keys(M);ye<we.length;ye+=1){var Ce=we[ye];if(Ce!=="$name"){var je=M[Ce];ie[Ce]=si[O].shallow.indexOf(Ce)>=0?je:ki(je)}}return ie}throw new Error("can't deserialize object of type "+typeof M)}var Pi=function(){this.first=!0};Pi.prototype.update=function(M,O){var Y=Math.floor(M);return this.first?(this.first=!1,this.lastIntegerZoom=Y,this.lastIntegerZoomTime=0,this.lastZoom=M,this.lastFloorZoom=Y,!0):(this.lastFloorZoom>Y?(this.lastIntegerZoom=Y+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<Y&&(this.lastIntegerZoom=Y,this.lastIntegerZoomTime=O),M!==this.lastZoom&&(this.lastZoom=M,this.lastFloorZoom=Y,!0))};var Ln={"Latin-1 Supplement":function(M){return M>=128&&M<=255},Arabic:function(M){return M>=1536&&M<=1791},"Arabic Supplement":function(M){return M>=1872&&M<=1919},"Arabic Extended-A":function(M){return M>=2208&&M<=2303},"Hangul Jamo":function(M){return M>=4352&&M<=4607},"Unified Canadian Aboriginal Syllabics":function(M){return M>=5120&&M<=5759},Khmer:function(M){return M>=6016&&M<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(M){return M>=6320&&M<=6399},"General Punctuation":function(M){return M>=8192&&M<=8303},"Letterlike Symbols":function(M){return M>=8448&&M<=8527},"Number Forms":function(M){return M>=8528&&M<=8591},"Miscellaneous Technical":function(M){return M>=8960&&M<=9215},"Control Pictures":function(M){return M>=9216&&M<=9279},"Optical Character Recognition":function(M){return M>=9280&&M<=9311},"Enclosed Alphanumerics":function(M){return M>=9312&&M<=9471},"Geometric Shapes":function(M){return M>=9632&&M<=9727},"Miscellaneous Symbols":function(M){return M>=9728&&M<=9983},"Miscellaneous Symbols and Arrows":function(M){return M>=11008&&M<=11263},"CJK Radicals Supplement":function(M){return M>=11904&&M<=12031},"Kangxi Radicals":function(M){return M>=12032&&M<=12255},"Ideographic Description Characters":function(M){return M>=12272&&M<=12287},"CJK Symbols and Punctuation":function(M){return M>=12288&&M<=12351},Hiragana:function(M){return M>=12352&&M<=12447},Katakana:function(M){return M>=12448&&M<=12543},Bopomofo:function(M){return M>=12544&&M<=12591},"Hangul Compatibility Jamo":function(M){return M>=12592&&M<=12687},Kanbun:function(M){return M>=12688&&M<=12703},"Bopomofo Extended":function(M){return M>=12704&&M<=12735},"CJK Strokes":function(M){return M>=12736&&M<=12783},"Katakana Phonetic Extensions":function(M){return M>=12784&&M<=12799},"Enclosed CJK Letters and Months":function(M){return M>=12800&&M<=13055},"CJK Compatibility":function(M){return M>=13056&&M<=13311},"CJK Unified Ideographs Extension A":function(M){return M>=13312&&M<=19903},"Yijing Hexagram Symbols":function(M){return M>=19904&&M<=19967},"CJK Unified Ideographs":function(M){return M>=19968&&M<=40959},"Yi Syllables":function(M){return M>=40960&&M<=42127},"Yi Radicals":function(M){return M>=42128&&M<=42191},"Hangul Jamo Extended-A":function(M){return M>=43360&&M<=43391},"Hangul Syllables":function(M){return M>=44032&&M<=55215},"Hangul Jamo Extended-B":function(M){return M>=55216&&M<=55295},"Private Use Area":function(M){return M>=57344&&M<=63743},"CJK Compatibility Ideographs":function(M){return M>=63744&&M<=64255},"Arabic Presentation Forms-A":function(M){return M>=64336&&M<=65023},"Vertical Forms":function(M){return M>=65040&&M<=65055},"CJK Compatibility Forms":function(M){return M>=65072&&M<=65103},"Small Form Variants":function(M){return M>=65104&&M<=65135},"Arabic Presentation Forms-B":function(M){return M>=65136&&M<=65279},"Halfwidth and Fullwidth Forms":function(M){return M>=65280&&M<=65519}};function Ri(M){for(var O=0,Y=M;O<Y.length;O+=1)if(gi(Y[O].charCodeAt(0)))return!0;return!1}function Ci(M){return!Ln.Arabic(M)&&!Ln["Arabic Supplement"](M)&&!Ln["Arabic Extended-A"](M)&&!Ln["Arabic Presentation Forms-A"](M)&&!Ln["Arabic Presentation Forms-B"](M)}function gi(M){return M===746||M===747||!(M<4352)&&(!!Ln["Bopomofo Extended"](M)||!!Ln.Bopomofo(M)||!(!Ln["CJK Compatibility Forms"](M)||M>=65097&&M<=65103)||!!Ln["CJK Compatibility Ideographs"](M)||!!Ln["CJK Compatibility"](M)||!!Ln["CJK Radicals Supplement"](M)||!!Ln["CJK Strokes"](M)||!(!Ln["CJK Symbols and Punctuation"](M)||M>=12296&&M<=12305||M>=12308&&M<=12319||M===12336)||!!Ln["CJK Unified Ideographs Extension A"](M)||!!Ln["CJK Unified Ideographs"](M)||!!Ln["Enclosed CJK Letters and Months"](M)||!!Ln["Hangul Compatibility Jamo"](M)||!!Ln["Hangul Jamo Extended-A"](M)||!!Ln["Hangul Jamo Extended-B"](M)||!!Ln["Hangul Jamo"](M)||!!Ln["Hangul Syllables"](M)||!!Ln.Hiragana(M)||!!Ln["Ideographic Description Characters"](M)||!!Ln.Kanbun(M)||!!Ln["Kangxi Radicals"](M)||!!Ln["Katakana Phonetic Extensions"](M)||!(!Ln.Katakana(M)||M===12540)||!(!Ln["Halfwidth and Fullwidth Forms"](M)||M===65288||M===65289||M===65293||M>=65306&&M<=65310||M===65339||M===65341||M===65343||M>=65371&&M<=65503||M===65507||M>=65512&&M<=65519)||!(!Ln["Small Form Variants"](M)||M>=65112&&M<=65118||M>=65123&&M<=65126)||!!Ln["Unified Canadian Aboriginal Syllabics"](M)||!!Ln["Unified Canadian Aboriginal Syllabics Extended"](M)||!!Ln["Vertical Forms"](M)||!!Ln["Yijing Hexagram Symbols"](M)||!!Ln["Yi Syllables"](M)||!!Ln["Yi Radicals"](M))}function Fi(M){return!(gi(M)||function(O){return!(!Ln["Latin-1 Supplement"](O)||O!==167&&O!==169&&O!==174&&O!==177&&O!==188&&O!==189&&O!==190&&O!==215&&O!==247)||!(!Ln["General Punctuation"](O)||O!==8214&&O!==8224&&O!==8225&&O!==8240&&O!==8241&&O!==8251&&O!==8252&&O!==8258&&O!==8263&&O!==8264&&O!==8265&&O!==8273)||!!Ln["Letterlike Symbols"](O)||!!Ln["Number Forms"](O)||!(!Ln["Miscellaneous Technical"](O)||!(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||O===9003||O>=9085&&O<=9114||O>=9150&&O<=9165||O===9167||O>=9169&&O<=9179||O>=9186&&O<=9215))||!(!Ln["Control Pictures"](O)||O===9251)||!!Ln["Optical Character Recognition"](O)||!!Ln["Enclosed Alphanumerics"](O)||!!Ln["Geometric Shapes"](O)||!(!Ln["Miscellaneous Symbols"](O)||O>=9754&&O<=9759)||!(!Ln["Miscellaneous Symbols and Arrows"](O)||!(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243))||!!Ln["CJK Symbols and Punctuation"](O)||!!Ln.Katakana(O)||!!Ln["Private Use Area"](O)||!!Ln["CJK Compatibility Forms"](O)||!!Ln["Small Form Variants"](O)||!!Ln["Halfwidth and Fullwidth Forms"](O)||O===8734||O===8756||O===8757||O>=9984&&O<=10087||O>=10102&&O<=10131||O===65532||O===65533}(M))}function Ei(M){return M>=1424&&M<=2303||Ln["Arabic Presentation Forms-A"](M)||Ln["Arabic Presentation Forms-B"](M)}function ra(M,O){return!(!O&&Ei(M))&&!(M>=2304&&M<=3583||M>=3840&&M<=4255||Ln.Khmer(M))}function ii(M){for(var O=0,Y=M;O<Y.length;O+=1)if(Ei(Y[O].charCodeAt(0)))return!0;return!1}var Ki="deferred",qa="loading",es="loaded",Uo="error",To=null,xi="unavailable",xa=null,ko=function(M){M&&typeof M=="string"&&M.indexOf("NetworkError")>-1&&(xi=Uo),To&&To(M)};function Ji(){Sa.fire(new Ne("pluginStateChange",{pluginStatus:xi,pluginURL:xa}))}var Sa=new pe,Ka=function(){return xi},ia=function(){if(xi!==Ki||!xa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xi=qa,Ji(),xa&&vt({url:xa},function(M){M?ko(M):(xi=es,Ji())})},yo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return xi===es||yo.applyArabicShaping!=null},isLoading:function(){return xi===qa},setState:function(M){xi=M.pluginStatus,xa=M.pluginURL},isParsed:function(){return yo.applyArabicShaping!=null&&yo.processBidirectionalText!=null&&yo.processStyledBidirectionalText!=null},getPluginURL:function(){return xa}},aa=function(M,O){this.zoom=M,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pi,this.transition={})};aa.prototype.isSupportedScript=function(M){return function(O,Y){for(var ie=0,ye=O;ie<ye.length;ie+=1)if(!ra(ye[ie].charCodeAt(0),Y))return!1;return!0}(M,yo.isLoaded())},aa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},aa.prototype.getCrossfadeParameters=function(){var M=this.zoom,O=M-Math.floor(M),Y=this.crossFadingFactor();return M>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*Y}:{fromScale:.5,toScale:1,t:1-(1-Y)*O}};var so=function(M,O){this.property=M,this.value=O,this.expression=function(Y,ie){if(Ue(Y))return new Tr(Y,ie);if(er(Y)){var ye=wr(Y,ie);if(ye.result==="error")throw new Error(ye.value.map(function(Ce){return Ce.key+": "+Ce.message}).join(", "));return ye.value}var we=Y;return typeof Y=="string"&&ie.type==="color"&&(we=Qt.parse(Y)),{kind:"constant",evaluate:function(){return we}}}(O===void 0?M.specification.default:O,M.specification)};so.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},so.prototype.possiblyEvaluate=function(M,O,Y){return this.property.possiblyEvaluate(this,M,O,Y)};var vs=function(M){this.property=M,this.value=new so(M,void 0)};vs.prototype.transitioned=function(M,O){return new rl(this.property,this.value,O,o({},M.transition,this.transition),M.now)},vs.prototype.untransitioned=function(){return new rl(this.property,this.value,null,{},0)};var cs=function(M){this._properties=M,this._values=Object.create(M.defaultTransitionablePropertyValues)};cs.prototype.getValue=function(M){return k(this._values[M].value.value)},cs.prototype.setValue=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new vs(this._values[M].property)),this._values[M].value=new so(this._values[M].property,O===null?void 0:k(O))},cs.prototype.getTransition=function(M){return k(this._values[M].transition)},cs.prototype.setTransition=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new vs(this._values[M].property)),this._values[M].transition=k(O)||void 0},cs.prototype.serialize=function(){for(var M={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O],ye=this.getValue(ie);ye!==void 0&&(M[ie]=ye);var we=this.getTransition(ie);we!==void 0&&(M[ie+"-transition"]=we)}return M},cs.prototype.transitioned=function(M,O){for(var Y=new Na(this._properties),ie=0,ye=Object.keys(this._values);ie<ye.length;ie+=1){var we=ye[ie];Y._values[we]=this._values[we].transitioned(M,O._values[we])}return Y},cs.prototype.untransitioned=function(){for(var M=new Na(this._properties),O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O];M._values[ie]=this._values[ie].untransitioned()}return M};var rl=function(M,O,Y,ie,ye){this.property=M,this.value=O,this.begin=ye+ie.delay||0,this.end=this.begin+ie.duration||0,M.specification.transition&&(ie.delay||ie.duration)&&(this.prior=Y)};rl.prototype.possiblyEvaluate=function(M,O,Y){var ie=M.now||0,ye=this.value.possiblyEvaluate(M,O,Y),we=this.prior;if(we){if(ie>this.end)return this.prior=null,ye;if(this.value.isDataDriven())return this.prior=null,ye;if(ie<this.begin)return we.possiblyEvaluate(M,O,Y);var Ce=(ie-this.begin)/(this.end-this.begin);return this.property.interpolate(we.possiblyEvaluate(M,O,Y),ye,function(je){if(je<=0)return 0;if(je>=1)return 1;var tt=je*je,ft=tt*je;return 4*(je<.5?ft:3*(je-tt)+ft-.75)}(Ce))}return ye};var Na=function(M){this._properties=M,this._values=Object.create(M.defaultTransitioningPropertyValues)};Na.prototype.possiblyEvaluate=function(M,O,Y){for(var ie=new us(this._properties),ye=0,we=Object.keys(this._values);ye<we.length;ye+=1){var Ce=we[ye];ie._values[Ce]=this._values[Ce].possiblyEvaluate(M,O,Y)}return ie},Na.prototype.hasTransition=function(){for(var M=0,O=Object.keys(this._values);M<O.length;M+=1){var Y=O[M];if(this._values[Y].prior)return!0}return!1};var nl=function(M){this._properties=M,this._values=Object.create(M.defaultPropertyValues)};nl.prototype.getValue=function(M){return k(this._values[M].value)},nl.prototype.setValue=function(M,O){this._values[M]=new so(this._values[M].property,O===null?void 0:k(O))},nl.prototype.serialize=function(){for(var M={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ie=Y[O],ye=this.getValue(ie);ye!==void 0&&(M[ie]=ye)}return M},nl.prototype.possiblyEvaluate=function(M,O,Y){for(var ie=new us(this._properties),ye=0,we=Object.keys(this._values);ye<we.length;ye+=1){var Ce=we[ye];ie._values[Ce]=this._values[Ce].possiblyEvaluate(M,O,Y)}return ie};var ja=function(M,O,Y){this.property=M,this.value=O,this.parameters=Y};ja.prototype.isConstant=function(){return this.value.kind==="constant"},ja.prototype.constantOr=function(M){return this.value.kind==="constant"?this.value.value:M},ja.prototype.evaluate=function(M,O,Y,ie){return this.property.evaluate(this.value,this.parameters,M,O,Y,ie)};var us=function(M){this._properties=M,this._values=Object.create(M.defaultPossiblyEvaluatedValues)};us.prototype.get=function(M){return this._values[M]};var fi=function(M){this.specification=M};fi.prototype.possiblyEvaluate=function(M,O){return M.expression.evaluate(O)},fi.prototype.interpolate=function(M,O,Y){var ie=Pn[this.specification.type];return ie?ie(M,O,Y):M};var bi=function(M,O){this.specification=M,this.overrides=O};bi.prototype.possiblyEvaluate=function(M,O,Y,ie){return M.expression.kind==="constant"||M.expression.kind==="camera"?new ja(this,{kind:"constant",value:M.expression.evaluate(O,null,{},Y,ie)},O):new ja(this,M.expression,O)},bi.prototype.interpolate=function(M,O,Y){if(M.value.kind!=="constant"||O.value.kind!=="constant")return M;if(M.value.value===void 0||O.value.value===void 0)return new ja(this,{kind:"constant",value:void 0},M.parameters);var ie=Pn[this.specification.type];return ie?new ja(this,{kind:"constant",value:ie(M.value.value,O.value.value,Y)},M.parameters):M},bi.prototype.evaluate=function(M,O,Y,ie,ye,we){return M.kind==="constant"?M.value:M.evaluate(O,Y,ie,ye,we)};var il=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(Y,ie,ye,we){if(Y.value===void 0)return new ja(this,{kind:"constant",value:void 0},ie);if(Y.expression.kind==="constant"){var Ce=Y.expression.evaluate(ie,null,{},ye,we),je=Y.property.specification.type==="resolvedImage"&&typeof Ce!="string"?Ce.name:Ce,tt=this._calculate(je,je,je,ie);return new ja(this,{kind:"constant",value:tt},ie)}if(Y.expression.kind==="camera"){var ft=this._calculate(Y.expression.evaluate({zoom:ie.zoom-1}),Y.expression.evaluate({zoom:ie.zoom}),Y.expression.evaluate({zoom:ie.zoom+1}),ie);return new ja(this,{kind:"constant",value:ft},ie)}return new ja(this,Y.expression,ie)},O.prototype.evaluate=function(Y,ie,ye,we,Ce,je){if(Y.kind==="source"){var tt=Y.evaluate(ie,ye,we,Ce,je);return this._calculate(tt,tt,tt,ie)}return Y.kind==="composite"?this._calculate(Y.evaluate({zoom:Math.floor(ie.zoom)-1},ye,we),Y.evaluate({zoom:Math.floor(ie.zoom)},ye,we),Y.evaluate({zoom:Math.floor(ie.zoom)+1},ye,we),ie):Y.value},O.prototype._calculate=function(Y,ie,ye,we){return we.zoom>we.zoomHistory.lastIntegerZoom?{from:Y,to:ie}:{from:ye,to:ie}},O.prototype.interpolate=function(Y){return Y},O}(bi),al=function(M){this.specification=M};al.prototype.possiblyEvaluate=function(M,O,Y,ie){if(M.value!==void 0){if(M.expression.kind==="constant"){var ye=M.expression.evaluate(O,null,{},Y,ie);return this._calculate(ye,ye,ye,O)}return this._calculate(M.expression.evaluate(new aa(Math.floor(O.zoom-1),O)),M.expression.evaluate(new aa(Math.floor(O.zoom),O)),M.expression.evaluate(new aa(Math.floor(O.zoom+1),O)),O)}},al.prototype._calculate=function(M,O,Y,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:M,to:O}:{from:Y,to:O}},al.prototype.interpolate=function(M){return M};var fs=function(M){this.specification=M};fs.prototype.possiblyEvaluate=function(M,O,Y,ie){return!!M.expression.evaluate(O,null,{},Y,ie)},fs.prototype.interpolate=function(){return!1};var Fo=function(M){for(var O in this.properties=M,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],M){var Y=M[O];Y.specification.overridable&&this.overridableProperties.push(O);var ie=this.defaultPropertyValues[O]=new so(Y,void 0),ye=this.defaultTransitionablePropertyValues[O]=new vs(Y);this.defaultTransitioningPropertyValues[O]=ye.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ie.possiblyEvaluate({})}};Kr("DataDrivenProperty",bi),Kr("DataConstantProperty",fi),Kr("CrossFadedDataDrivenProperty",il),Kr("CrossFadedProperty",al),Kr("ColorRampProperty",fs);var Ko=function(M){function O(Y,ie){if(M.call(this),this.id=Y.id,this.type=Y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},Y.type!=="custom"&&(Y=Y,this.metadata=Y.metadata,this.minzoom=Y.minzoom,this.maxzoom=Y.maxzoom,Y.type!=="background"&&(this.source=Y.source,this.sourceLayer=Y["source-layer"],this.filter=Y.filter),ie.layout&&(this._unevaluatedLayout=new nl(ie.layout)),ie.paint)){for(var ye in this._transitionablePaint=new cs(ie.paint),Y.paint)this.setPaintProperty(ye,Y.paint[ye],{validate:!1});for(var we in Y.layout)this.setLayoutProperty(we,Y.layout[we],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new us(ie.paint)}}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(Y){return Y==="visibility"?this.visibility:this._unevaluatedLayout.getValue(Y)},O.prototype.setLayoutProperty=function(Y,ie,ye){if(ye===void 0&&(ye={}),ie!=null){var we="layers."+this.id+".layout."+Y;if(this._validate(gn,we,Y,ie,ye))return}Y!=="visibility"?this._unevaluatedLayout.setValue(Y,ie):this.visibility=ie},O.prototype.getPaintProperty=function(Y){return _(Y,"-transition")?this._transitionablePaint.getTransition(Y.slice(0,-11)):this._transitionablePaint.getValue(Y)},O.prototype.setPaintProperty=function(Y,ie,ye){if(ye===void 0&&(ye={}),ie!=null){var we="layers."+this.id+".paint."+Y;if(this._validate(sn,we,Y,ie,ye))return!1}if(_(Y,"-transition"))return this._transitionablePaint.setTransition(Y.slice(0,-11),ie||void 0),!1;var Ce=this._transitionablePaint._values[Y],je=Ce.property.specification["property-type"]==="cross-faded-data-driven",tt=Ce.value.isDataDriven(),ft=Ce.value;this._transitionablePaint.setValue(Y,ie),this._handleSpecialPaintPropertyUpdate(Y);var gt=this._transitionablePaint._values[Y].value;return gt.isDataDriven()||tt||je||this._handleOverridablePaintPropertyUpdate(Y,ft,gt)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ie,ye){return!1},O.prototype.isHidden=function(Y){return!!(this.minzoom&&Y<this.minzoom)||!!(this.maxzoom&&Y>=this.maxzoom)||this.visibility==="none"},O.prototype.updateTransitions=function(Y){this._transitioningPaint=this._transitionablePaint.transitioned(Y,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(Y,ie){Y.getCrossfadeParameters&&(this._crossfadeParameters=Y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Y,void 0,ie)),this.paint=this._transitioningPaint.possiblyEvaluate(Y,void 0,ie)},O.prototype.serialize=function(){var Y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Y.layout=Y.layout||{},Y.layout.visibility=this.visibility),T(Y,function(ie,ye){return!(ie===void 0||ye==="layout"&&!Object.keys(ie).length||ye==="paint"&&!Object.keys(ie).length)})},O.prototype._validate=function(Y,ie,ye,we,Ce){return Ce===void 0&&(Ce={}),(!Ce||Ce.validate!==!1)&&Mn(this,Y.call(Xr,{key:ie,layerType:this.type,objectKey:ye,value:we,styleSpec:be,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var Y in this.paint._values){var ie=this.paint.get(Y);if(ie instanceof ja&&Xo(ie.property.specification)&&(ie.value.kind==="source"||ie.value.kind==="composite")&&ie.value.isStateDependent)return!0}return!1},O}(pe),Sl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},js=function(M,O){this._structArray=M,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$i=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oa(M,O){O===void 0&&(O=1);var Y=0,ie=0;return{members:M.map(function(ye){var we,Ce=(we=ye.type,Sl[we].BYTES_PER_ELEMENT),je=Y=As(Y,Math.max(O,Ce)),tt=ye.components||1;return ie=Math.max(ie,Ce),Y+=Ce*tt,{name:ye.name,type:ye.type,components:tt,offset:je}}),size:As(Y,Math.max(ie,O)),alignment:O}}function As(M,O){return Math.ceil(M/O)*O}$i.serialize=function(M,O){return M._trim(),O&&(M.isTransferred=!0,O.push(M.arrayBuffer)),{length:M.length,arrayBuffer:M.arrayBuffer}},$i.deserialize=function(M){var O=Object.create(this.prototype);return O.arrayBuffer=M.arrayBuffer,O.length=M.length,O.capacity=M.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},$i.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$i.prototype.clear=function(){this.length=0},$i.prototype.resize=function(M){this.reserve(M),this.length=M},$i.prototype.reserve=function(M){if(M>this.capacity){this.capacity=Math.max(M,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},$i.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ys=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ie)},O.prototype.emplace=function(Y,ie,ye){var we=2*Y;return this.int16[we+0]=ie,this.int16[we+1]=ye,Y},O}($i);ys.prototype.bytesPerElement=4,Kr("StructArrayLayout2i4",ys);var za=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Y,ie,ye,we)},O.prototype.emplace=function(Y,ie,ye,we,Ce){var je=4*Y;return this.int16[je+0]=ie,this.int16[je+1]=ye,this.int16[je+2]=we,this.int16[je+3]=Ce,Y},O}($i);za.prototype.bytesPerElement=8,Kr("StructArrayLayout4i8",za);var Ss=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Y,ie,ye,we,Ce,je)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt){var ft=6*Y;return this.int16[ft+0]=ie,this.int16[ft+1]=ye,this.int16[ft+2]=we,this.int16[ft+3]=Ce,this.int16[ft+4]=je,this.int16[ft+5]=tt,Y},O}($i);Ss.prototype.bytesPerElement=12,Kr("StructArrayLayout2i4i12",Ss);var Us=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Y,ie,ye,we,Ce,je)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt){var ft=4*Y,gt=8*Y;return this.int16[ft+0]=ie,this.int16[ft+1]=ye,this.uint8[gt+4]=we,this.uint8[gt+5]=Ce,this.uint8[gt+6]=je,this.uint8[gt+7]=tt,Y},O}($i);Us.prototype.bytesPerElement=8,Kr("StructArrayLayout2i4ub8",Us);var Is=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt){var Xt=this.length;return this.resize(Xt+1),this.emplace(Xt,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt){var Yt=9*Y,sr=18*Y;return this.uint16[Yt+0]=ie,this.uint16[Yt+1]=ye,this.uint16[Yt+2]=we,this.uint16[Yt+3]=Ce,this.uint16[Yt+4]=je,this.uint16[Yt+5]=tt,this.uint16[Yt+6]=ft,this.uint16[Yt+7]=gt,this.uint8[sr+16]=Bt,this.uint8[sr+17]=Xt,Y},O}($i);Is.prototype.bytesPerElement=18,Kr("StructArrayLayout8ui2ub18",Is);var Vs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt){var sr=this.length;return this.resize(sr+1),this.emplace(sr,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr){var br=12*Y;return this.int16[br+0]=ie,this.int16[br+1]=ye,this.int16[br+2]=we,this.int16[br+3]=Ce,this.uint16[br+4]=je,this.uint16[br+5]=tt,this.uint16[br+6]=ft,this.uint16[br+7]=gt,this.int16[br+8]=Bt,this.int16[br+9]=Xt,this.int16[br+10]=Yt,this.int16[br+11]=sr,Y},O}($i);Vs.prototype.bytesPerElement=24,Kr("StructArrayLayout4i4ui4i24",Vs);var xs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,ye)},O.prototype.emplace=function(Y,ie,ye,we){var Ce=3*Y;return this.float32[Ce+0]=ie,this.float32[Ce+1]=ye,this.float32[Ce+2]=we,Y},O}($i);xs.prototype.bytesPerElement=12,Kr("StructArrayLayout3f12",xs);var El=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){var ye=1*Y;return this.uint32[ye+0]=ie,Y},O}($i);El.prototype.bytesPerElement=4,Kr("StructArrayLayout1ul4",El);var Hl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je,tt,ft,gt){var Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,Y,ie,ye,we,Ce,je,tt,ft,gt)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt){var Xt=10*Y,Yt=5*Y;return this.int16[Xt+0]=ie,this.int16[Xt+1]=ye,this.int16[Xt+2]=we,this.int16[Xt+3]=Ce,this.int16[Xt+4]=je,this.int16[Xt+5]=tt,this.uint32[Yt+3]=ft,this.uint16[Xt+8]=gt,this.uint16[Xt+9]=Bt,Y},O}($i);Hl.prototype.bytesPerElement=20,Kr("StructArrayLayout6i1ul2ui20",Hl);var Es=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Y,ie,ye,we,Ce,je)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt){var ft=6*Y;return this.int16[ft+0]=ie,this.int16[ft+1]=ye,this.int16[ft+2]=we,this.int16[ft+3]=Ce,this.int16[ft+4]=je,this.int16[ft+5]=tt,Y},O}($i);Es.prototype.bytesPerElement=12,Kr("StructArrayLayout2i2i2i12",Es);var Ll=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce){var je=this.length;return this.resize(je+1),this.emplace(je,Y,ie,ye,we,Ce)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je){var tt=4*Y,ft=8*Y;return this.float32[tt+0]=ie,this.float32[tt+1]=ye,this.float32[tt+2]=we,this.int16[ft+6]=Ce,this.int16[ft+7]=je,Y},O}($i);Ll.prototype.bytesPerElement=16,Kr("StructArrayLayout2f1f2i16",Ll);var Hs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Y,ie,ye,we)},O.prototype.emplace=function(Y,ie,ye,we,Ce){var je=12*Y,tt=3*Y;return this.uint8[je+0]=ie,this.uint8[je+1]=ye,this.float32[tt+1]=we,this.float32[tt+2]=Ce,Y},O}($i);Hs.prototype.bytesPerElement=12,Kr("StructArrayLayout2ub2f12",Hs);var lo=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,ye)},O.prototype.emplace=function(Y,ie,ye,we){var Ce=3*Y;return this.uint16[Ce+0]=ie,this.uint16[Ce+1]=ye,this.uint16[Ce+2]=we,Y},O}($i);lo.prototype.bytesPerElement=6,Kr("StructArrayLayout3ui6",lo);var ql=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr){var Hr=this.length;return this.resize(Hr+1),this.emplace(Hr,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr,Hr){var Zr=24*Y,pn=12*Y,bn=48*Y;return this.int16[Zr+0]=ie,this.int16[Zr+1]=ye,this.uint16[Zr+2]=we,this.uint16[Zr+3]=Ce,this.uint32[pn+2]=je,this.uint32[pn+3]=tt,this.uint32[pn+4]=ft,this.uint16[Zr+10]=gt,this.uint16[Zr+11]=Bt,this.uint16[Zr+12]=Xt,this.float32[pn+7]=Yt,this.float32[pn+8]=sr,this.uint8[bn+36]=br,this.uint8[bn+37]=Ir,this.uint8[bn+38]=Pr,this.uint32[pn+10]=Vr,this.int16[Zr+22]=Hr,Y},O}($i);ql.prototype.bytesPerElement=48,Kr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ql);var Gl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr,Hr,Zr,pn,bn,jn,Nn,Wn,li,ci,$n,mi){var pi=this.length;return this.resize(pi+1),this.emplace(pi,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr,Hr,Zr,pn,bn,jn,Nn,Wn,li,ci,$n,mi)},O.prototype.emplace=function(Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br,Ir,Pr,Vr,Hr,Zr,pn,bn,jn,Nn,Wn,li,ci,$n,mi,pi){var ui=34*Y,Qi=17*Y;return this.int16[ui+0]=ie,this.int16[ui+1]=ye,this.int16[ui+2]=we,this.int16[ui+3]=Ce,this.int16[ui+4]=je,this.int16[ui+5]=tt,this.int16[ui+6]=ft,this.int16[ui+7]=gt,this.uint16[ui+8]=Bt,this.uint16[ui+9]=Xt,this.uint16[ui+10]=Yt,this.uint16[ui+11]=sr,this.uint16[ui+12]=br,this.uint16[ui+13]=Ir,this.uint16[ui+14]=Pr,this.uint16[ui+15]=Vr,this.uint16[ui+16]=Hr,this.uint16[ui+17]=Zr,this.uint16[ui+18]=pn,this.uint16[ui+19]=bn,this.uint16[ui+20]=jn,this.uint16[ui+21]=Nn,this.uint16[ui+22]=Wn,this.uint32[Qi+12]=li,this.float32[Qi+13]=ci,this.float32[Qi+14]=$n,this.float32[Qi+15]=mi,this.float32[Qi+16]=pi,Y},O}($i);Gl.prototype.bytesPerElement=68,Kr("StructArrayLayout8i15ui1ul4f68",Gl);var ue=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){var ye=1*Y;return this.float32[ye+0]=ie,Y},O}($i);ue.prototype.bytesPerElement=4,Kr("StructArrayLayout1f4",ue);var C=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,ye)},O.prototype.emplace=function(Y,ie,ye,we){var Ce=3*Y;return this.int16[Ce+0]=ie,this.int16[Ce+1]=ye,this.int16[Ce+2]=we,Y},O}($i);C.prototype.bytesPerElement=6,Kr("StructArrayLayout3i6",C);var R=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye){var we=this.length;return this.resize(we+1),this.emplace(we,Y,ie,ye)},O.prototype.emplace=function(Y,ie,ye,we){var Ce=2*Y,je=4*Y;return this.uint32[Ce+0]=ie,this.uint16[je+2]=ye,this.uint16[je+3]=we,Y},O}($i);R.prototype.bytesPerElement=8,Kr("StructArrayLayout1ul2ui8",R);var F=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ie)},O.prototype.emplace=function(Y,ie,ye){var we=2*Y;return this.uint16[we+0]=ie,this.uint16[we+1]=ye,Y},O}($i);F.prototype.bytesPerElement=4,Kr("StructArrayLayout2ui4",F);var q=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ie=this.length;return this.resize(ie+1),this.emplace(ie,Y)},O.prototype.emplace=function(Y,ie){var ye=1*Y;return this.uint16[ye+0]=ie,Y},O}($i);q.prototype.bytesPerElement=2,Kr("StructArrayLayout1ui2",q);var ae=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ie)},O.prototype.emplace=function(Y,ie,ye){var we=2*Y;return this.float32[we+0]=ie,this.float32[we+1]=ye,Y},O}($i);ae.prototype.bytesPerElement=8,Kr("StructArrayLayout2f8",ae);var he=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ie,ye,we){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,Y,ie,ye,we)},O.prototype.emplace=function(Y,ie,ye,we,Ce){var je=4*Y;return this.float32[je+0]=ie,this.float32[je+1]=ye,this.float32[je+2]=we,this.float32[je+3]=Ce,Y},O}($i);he.prototype.bytesPerElement=16,Kr("StructArrayLayout4f16",he);var xe=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return Y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},Y.x1.get=function(){return this._structArray.int16[this._pos2+2]},Y.y1.get=function(){return this._structArray.int16[this._pos2+3]},Y.x2.get=function(){return this._structArray.int16[this._pos2+4]},Y.y2.get=function(){return this._structArray.int16[this._pos2+5]},Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,Y),O}(js);xe.prototype.size=20;var ke=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new xe(this,Y)},O}(Hl);Kr("CollisionBoxArray",ke);var Le=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},Y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},Y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},Y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},Y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},Y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},Y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},Y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},Y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},Y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},Y.placedOrientation.set=function(ie){this._structArray.uint8[this._pos1+37]=ie},Y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},Y.hidden.set=function(ie){this._structArray.uint8[this._pos1+38]=ie},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},Y.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+10]=ie},Y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,Y),O}(js);Le.prototype.size=48;var He=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new Le(this,Y)},O}(ql);Kr("PlacedSymbolArray",He);var Je=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},Y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},Y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},Y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},Y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},Y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},Y.key.get=function(){return this._structArray.uint16[this._pos2+8]},Y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},Y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},Y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},Y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},Y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},Y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},Y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},Y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},Y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},Y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},Y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},Y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},Y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},Y.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+12]=ie},Y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},Y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},Y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},Y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,Y),O}(js);Je.prototype.size=68;var ot=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new Je(this,Y)},O}(Gl);Kr("SymbolInstanceArray",ot);var Tt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getoffsetX=function(Y){return this.float32[1*Y+0]},O}(ue);Kr("GlyphOffsetArray",Tt);var Ct=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getx=function(Y){return this.int16[3*Y+0]},O.prototype.gety=function(Y){return this.int16[3*Y+1]},O.prototype.gettileUnitDistanceFromAnchor=function(Y){return this.int16[3*Y+2]},O}(C);Kr("SymbolLineVertexArray",Ct);var At=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,Y),O}(js);At.prototype.size=8;var Et=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new At(this,Y)},O}(R);Kr("FeatureIndexArray",Et);var _t=oa([{name:"a_pos",components:2,type:"Int16"}],4).members,Ft=function(M){M===void 0&&(M=[]),this.segments=M};function zt(M,O){return 256*(M=h(Math.floor(M),0,255))+(O=h(Math.floor(O),0,255))}Ft.prototype.prepareSegment=function(M,O,Y,ie){var ye=this.segments[this.segments.length-1];return M>Ft.MAX_VERTEX_ARRAY_LENGTH&&A("Max vertices per segment is "+Ft.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+M),(!ye||ye.vertexLength+M>Ft.MAX_VERTEX_ARRAY_LENGTH||ye.sortKey!==ie)&&(ye={vertexOffset:O.length,primitiveOffset:Y.length,vertexLength:0,primitiveLength:0},ie!==void 0&&(ye.sortKey=ie),this.segments.push(ye)),ye},Ft.prototype.get=function(){return this.segments},Ft.prototype.destroy=function(){for(var M=0,O=this.segments;M<O.length;M+=1){var Y=O[M];for(var ie in Y.vaos)Y.vaos[ie].destroy()}},Ft.simpleSegment=function(M,O,Y,ie){return new Ft([{vertexOffset:M,primitiveOffset:O,vertexLength:Y,primitiveLength:ie,vaos:{},sortKey:0}])},Ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kr("SegmentVector",Ft);var Vt=oa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),ir=t(function(M){M.exports=function(O,Y){var ie,ye,we,Ce,je,tt,ft,gt;for(ie=3&O.length,ye=O.length-ie,we=Y,je=3432918353,tt=461845907,gt=0;gt<ye;)ft=255&O.charCodeAt(gt)|(255&O.charCodeAt(++gt))<<8|(255&O.charCodeAt(++gt))<<16|(255&O.charCodeAt(++gt))<<24,++gt,we=27492+(65535&(Ce=5*(65535&(we=(we^=ft=(65535&(ft=(ft=(65535&ft)*je+(((ft>>>16)*je&65535)<<16)&4294967295)<<15|ft>>>17))*tt+(((ft>>>16)*tt&65535)<<16)&4294967295)<<13|we>>>19))+((5*(we>>>16)&65535)<<16)&4294967295))+((58964+(Ce>>>16)&65535)<<16);switch(ft=0,ie){case 3:ft^=(255&O.charCodeAt(gt+2))<<16;case 2:ft^=(255&O.charCodeAt(gt+1))<<8;case 1:we^=ft=(65535&(ft=(ft=(65535&(ft^=255&O.charCodeAt(gt)))*je+(((ft>>>16)*je&65535)<<16)&4294967295)<<15|ft>>>17))*tt+(((ft>>>16)*tt&65535)<<16)&4294967295}return we^=O.length,we=2246822507*(65535&(we^=we>>>16))+((2246822507*(we>>>16)&65535)<<16)&4294967295,we=3266489909*(65535&(we^=we>>>13))+((3266489909*(we>>>16)&65535)<<16)&4294967295,(we^=we>>>16)>>>0}}),gr=t(function(M){M.exports=function(O,Y){for(var ie,ye=O.length,we=Y^ye,Ce=0;ye>=4;)ie=1540483477*(65535&(ie=255&O.charCodeAt(Ce)|(255&O.charCodeAt(++Ce))<<8|(255&O.charCodeAt(++Ce))<<16|(255&O.charCodeAt(++Ce))<<24))+((1540483477*(ie>>>16)&65535)<<16),we=1540483477*(65535&we)+((1540483477*(we>>>16)&65535)<<16)^(ie=1540483477*(65535&(ie^=ie>>>24))+((1540483477*(ie>>>16)&65535)<<16)),ye-=4,++Ce;switch(ye){case 3:we^=(255&O.charCodeAt(Ce+2))<<16;case 2:we^=(255&O.charCodeAt(Ce+1))<<8;case 1:we=1540483477*(65535&(we^=255&O.charCodeAt(Ce)))+((1540483477*(we>>>16)&65535)<<16)}return we=1540483477*(65535&(we^=we>>>13))+((1540483477*(we>>>16)&65535)<<16),(we^=we>>>15)>>>0}}),Lr=ir,Ar=ir,$r=gr;Lr.murmur3=Ar,Lr.murmur2=$r;var Jr=function(){this.ids=[],this.positions=[],this.indexed=!1};Jr.prototype.add=function(M,O,Y,ie){this.ids.push(ln(M)),this.positions.push(O,Y,ie)},Jr.prototype.getPositions=function(M){for(var O=ln(M),Y=0,ie=this.ids.length-1;Y<ie;){var ye=Y+ie>>1;this.ids[ye]>=O?ie=ye:Y=ye+1}for(var we=[];this.ids[Y]===O;){var Ce=this.positions[3*Y],je=this.positions[3*Y+1],tt=this.positions[3*Y+2];we.push({index:Ce,start:je,end:tt}),Y++}return we},Jr.serialize=function(M,O){var Y=new Float64Array(M.ids),ie=new Uint32Array(M.positions);return function ye(we,Ce,je,tt){for(;je<tt;){for(var ft=we[je+tt>>1],gt=je-1,Bt=tt+1;;){do gt++;while(we[gt]<ft);do Bt--;while(we[Bt]>ft);if(gt>=Bt)break;Vn(we,gt,Bt),Vn(Ce,3*gt,3*Bt),Vn(Ce,3*gt+1,3*Bt+1),Vn(Ce,3*gt+2,3*Bt+2)}Bt-je<tt-Bt?(ye(we,Ce,je,Bt),je=Bt+1):(ye(we,Ce,Bt+1,tt),tt=Bt)}}(Y,ie,0,Y.length-1),O&&O.push(Y.buffer,ie.buffer),{ids:Y,positions:ie}},Jr.deserialize=function(M){var O=new Jr;return O.ids=M.ids,O.positions=M.positions,O.indexed=!0,O};var dn=Math.pow(2,53)-1;function ln(M){var O=+M;return!isNaN(O)&&O<=dn?O:Lr(String(M))}function Vn(M,O,Y){var ie=M[O];M[O]=M[Y],M[Y]=ie}Kr("FeaturePositionMap",Jr);var Xn=function(M,O){this.gl=M.gl,this.location=O},hi=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1i(this.location,Y))},O}(Xn),Yr=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1f(this.location,Y))},O}(Xn),Sn=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=[0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]||(this.current=Y,this.gl.uniform2f(this.location,Y[0],Y[1]))},O}(Xn),Kn=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=[0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]||(this.current=Y,this.gl.uniform3f(this.location,Y[0],Y[1],Y[2]))},O}(Xn),Yn=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=[0,0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]&&Y[3]===this.current[3]||(this.current=Y,this.gl.uniform4f(this.location,Y[0],Y[1],Y[2],Y[3]))},O}(Xn),ai=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=Qt.transparent}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y.r===this.current.r&&Y.g===this.current.g&&Y.b===this.current.b&&Y.a===this.current.a||(this.current=Y,this.gl.uniform4f(this.location,Y.r,Y.g,Y.b,Y.a))},O}(Xn),di=new Float32Array(16),Li=function(M){function O(Y,ie){M.call(this,Y,ie),this.current=di}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){if(Y[12]!==this.current[12]||Y[0]!==this.current[0])return this.current=Y,void this.gl.uniformMatrix4fv(this.location,!1,Y);for(var ie=1;ie<16;ie++)if(Y[ie]!==this.current[ie]){this.current=Y,this.gl.uniformMatrix4fv(this.location,!1,Y);break}},O}(Xn);function ei(M){return[zt(255*M.r,255*M.g),zt(255*M.b,255*M.a)]}var _i=function(M,O,Y){this.value=M,this.uniformNames=O.map(function(ie){return"u_"+ie}),this.type=Y};_i.prototype.setUniform=function(M,O,Y){M.set(Y.constantOr(this.value))},_i.prototype.getBinding=function(M,O,Y){return this.type==="color"?new ai(M,O):new Yr(M,O)};var yi=function(M,O){this.uniformNames=O.map(function(Y){return"u_"+Y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};yi.prototype.setConstantPatternPositions=function(M,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=M.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=M.tlbr},yi.prototype.setUniform=function(M,O,Y,ie){var ye=ie==="u_pattern_to"?this.patternTo:ie==="u_pattern_from"?this.patternFrom:ie==="u_pixel_ratio_to"?this.pixelRatioTo:ie==="u_pixel_ratio_from"?this.pixelRatioFrom:null;ye&&M.set(ye)},yi.prototype.getBinding=function(M,O,Y){return Y.substr(0,9)==="u_pattern"?new Yn(M,O):new Yr(M,O)};var Ii=function(M,O,Y,ie){this.expression=M,this.type=Y,this.maxValue=0,this.paintVertexAttributes=O.map(function(ye){return{name:"a_"+ye,type:"Float32",components:Y==="color"?2:1,offset:0}}),this.paintVertexArray=new ie};Ii.prototype.populatePaintArray=function(M,O,Y,ie,ye){var we=this.paintVertexArray.length,Ce=this.expression.evaluate(new aa(0),O,{},ie,[],ye);this.paintVertexArray.resize(M),this._setPaintValue(we,M,Ce)},Ii.prototype.updatePaintArray=function(M,O,Y,ie){var ye=this.expression.evaluate({zoom:0},Y,ie);this._setPaintValue(M,O,ye)},Ii.prototype._setPaintValue=function(M,O,Y){if(this.type==="color")for(var ie=ei(Y),ye=M;ye<O;ye++)this.paintVertexArray.emplace(ye,ie[0],ie[1]);else{for(var we=M;we<O;we++)this.paintVertexArray.emplace(we,Y);this.maxValue=Math.max(this.maxValue,Math.abs(Y))}},Ii.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ii.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var wi=function(M,O,Y,ie,ye,we){this.expression=M,this.uniformNames=O.map(function(Ce){return"u_"+Ce+"_t"}),this.type=Y,this.useIntegerZoom=ie,this.zoom=ye,this.maxValue=0,this.paintVertexAttributes=O.map(function(Ce){return{name:"a_"+Ce,type:"Float32",components:Y==="color"?4:2,offset:0}}),this.paintVertexArray=new we};wi.prototype.populatePaintArray=function(M,O,Y,ie,ye){var we=this.expression.evaluate(new aa(this.zoom),O,{},ie,[],ye),Ce=this.expression.evaluate(new aa(this.zoom+1),O,{},ie,[],ye),je=this.paintVertexArray.length;this.paintVertexArray.resize(M),this._setPaintValue(je,M,we,Ce)},wi.prototype.updatePaintArray=function(M,O,Y,ie){var ye=this.expression.evaluate({zoom:this.zoom},Y,ie),we=this.expression.evaluate({zoom:this.zoom+1},Y,ie);this._setPaintValue(M,O,ye,we)},wi.prototype._setPaintValue=function(M,O,Y,ie){if(this.type==="color")for(var ye=ei(Y),we=ei(ie),Ce=M;Ce<O;Ce++)this.paintVertexArray.emplace(Ce,ye[0],ye[1],we[0],we[1]);else{for(var je=M;je<O;je++)this.paintVertexArray.emplace(je,Y,ie);this.maxValue=Math.max(this.maxValue,Math.abs(Y),Math.abs(ie))}},wi.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},wi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},wi.prototype.setUniform=function(M,O){var Y=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ie=h(this.expression.interpolationFactor(Y,this.zoom,this.zoom+1),0,1);M.set(ie)},wi.prototype.getBinding=function(M,O,Y){return new Yr(M,O)};var Oi=function(M,O,Y,ie,ye,we){this.expression=M,this.type=O,this.useIntegerZoom=Y,this.zoom=ie,this.layerId=we,this.zoomInPaintVertexArray=new ye,this.zoomOutPaintVertexArray=new ye};Oi.prototype.populatePaintArray=function(M,O,Y){var ie=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(M),this.zoomOutPaintVertexArray.resize(M),this._setPaintValues(ie,M,O.patterns&&O.patterns[this.layerId],Y)},Oi.prototype.updatePaintArray=function(M,O,Y,ie,ye){this._setPaintValues(M,O,Y.patterns&&Y.patterns[this.layerId],ye)},Oi.prototype._setPaintValues=function(M,O,Y,ie){if(ie&&Y){var ye=Y.min,we=Y.mid,Ce=Y.max,je=ie[ye],tt=ie[we],ft=ie[Ce];if(je&&tt&&ft)for(var gt=M;gt<O;gt++)this.zoomInPaintVertexArray.emplace(gt,tt.tl[0],tt.tl[1],tt.br[0],tt.br[1],je.tl[0],je.tl[1],je.br[0],je.br[1],tt.pixelRatio,je.pixelRatio),this.zoomOutPaintVertexArray.emplace(gt,tt.tl[0],tt.tl[1],tt.br[0],tt.br[1],ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],tt.pixelRatio,ft.pixelRatio)}},Oi.prototype.upload=function(M){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=M.createVertexBuffer(this.zoomInPaintVertexArray,Vt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=M.createVertexBuffer(this.zoomOutPaintVertexArray,Vt.members,this.expression.isStateDependent))},Oi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Hi=function(M,O,Y,ie){this.binders={},this.layoutAttributes=ie,this._buffers=[];var ye=[];for(var we in M.paint._values)if(Y(we)){var Ce=M.paint.get(we);if(Ce instanceof ja&&Xo(Ce.property.specification)){var je=Ra(we,M.type),tt=Ce.value,ft=Ce.property.specification.type,gt=Ce.property.useIntegerZoom,Bt=Ce.property.specification["property-type"],Xt=Bt==="cross-faded"||Bt==="cross-faded-data-driven";if(tt.kind==="constant")this.binders[we]=Xt?new yi(tt.value,je):new _i(tt.value,je,ft),ye.push("/u_"+we);else if(tt.kind==="source"||Xt){var Yt=Fa(we,ft,"source");this.binders[we]=Xt?new Oi(tt,ft,gt,O,Yt,M.id):new Ii(tt,je,ft,Yt),ye.push("/a_"+we)}else{var sr=Fa(we,ft,"composite");this.binders[we]=new wi(tt,je,ft,gt,O,sr),ye.push("/z_"+we)}}}this.cacheKey=ye.sort().join("")};Hi.prototype.getMaxValue=function(M){var O=this.binders[M];return O instanceof Ii||O instanceof wi?O.maxValue:0},Hi.prototype.populatePaintArrays=function(M,O,Y,ie,ye){for(var we in this.binders){var Ce=this.binders[we];(Ce instanceof Ii||Ce instanceof wi||Ce instanceof Oi)&&Ce.populatePaintArray(M,O,Y,ie,ye)}},Hi.prototype.setConstantPatternPositions=function(M,O){for(var Y in this.binders){var ie=this.binders[Y];ie instanceof yi&&ie.setConstantPatternPositions(M,O)}},Hi.prototype.updatePaintArrays=function(M,O,Y,ie,ye){var we=!1;for(var Ce in M)for(var je=0,tt=O.getPositions(Ce);je<tt.length;je+=1){var ft=tt[je],gt=Y.feature(ft.index);for(var Bt in this.binders){var Xt=this.binders[Bt];if((Xt instanceof Ii||Xt instanceof wi||Xt instanceof Oi)&&Xt.expression.isStateDependent===!0){var Yt=ie.paint.get(Bt);Xt.expression=Yt.value,Xt.updatePaintArray(ft.start,ft.end,gt,M[Ce],ye),we=!0}}}return we},Hi.prototype.defines=function(){var M=[];for(var O in this.binders){var Y=this.binders[O];(Y instanceof _i||Y instanceof yi)&&M.push.apply(M,Y.uniformNames.map(function(ie){return"#define HAS_UNIFORM_"+ie}))}return M},Hi.prototype.getPaintVertexBuffers=function(){return this._buffers},Hi.prototype.getUniforms=function(M,O){var Y=[];for(var ie in this.binders){var ye=this.binders[ie];if(ye instanceof _i||ye instanceof yi||ye instanceof wi)for(var we=0,Ce=ye.uniformNames;we<Ce.length;we+=1){var je=Ce[we];if(O[je]){var tt=ye.getBinding(M,O[je],je);Y.push({name:je,property:ie,binding:tt})}}}return Y},Hi.prototype.setUniforms=function(M,O,Y,ie){for(var ye=0,we=O;ye<we.length;ye+=1){var Ce=we[ye],je=Ce.name,tt=Ce.property,ft=Ce.binding;this.binders[tt].setUniform(ft,ie,Y.get(tt),je)}},Hi.prototype.updatePaintBuffers=function(M){for(var O in this._buffers=[],this.binders){var Y=this.binders[O];if(M&&Y instanceof Oi){var ie=M.fromScale===2?Y.zoomInPaintVertexBuffer:Y.zoomOutPaintVertexBuffer;ie&&this._buffers.push(ie)}else(Y instanceof Ii||Y instanceof wi)&&Y.paintVertexBuffer&&this._buffers.push(Y.paintVertexBuffer)}},Hi.prototype.upload=function(M){for(var O in this.binders){var Y=this.binders[O];(Y instanceof Ii||Y instanceof wi||Y instanceof Oi)&&Y.upload(M)}this.updatePaintBuffers()},Hi.prototype.destroy=function(){for(var M in this.binders){var O=this.binders[M];(O instanceof Ii||O instanceof wi||O instanceof Oi)&&O.destroy()}};var da=function(M,O,Y,ie){ie===void 0&&(ie=function(){return!0}),this.programConfigurations={};for(var ye=0,we=O;ye<we.length;ye+=1){var Ce=we[ye];this.programConfigurations[Ce.id]=new Hi(Ce,Y,ie,M)}this.needsUpload=!1,this._featureMap=new Jr,this._bufferOffset=0};function Ra(M,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[M]||[M.replace(O+"-","").replace(/-/g,"_")]}function Fa(M,O,Y){var ie={color:{source:ae,composite:he},number:{source:ue,composite:ae}},ye=function(we){return{"line-pattern":{source:Is,composite:Is},"fill-pattern":{source:Is,composite:Is},"fill-extrusion-pattern":{source:Is,composite:Is}}[we]}(M);return ye&&ye[Y]||ie[O][Y]}da.prototype.populatePaintArrays=function(M,O,Y,ie,ye,we){for(var Ce in this.programConfigurations)this.programConfigurations[Ce].populatePaintArrays(M,O,ie,ye,we);O.id!==void 0&&this._featureMap.add(O.id,Y,this._bufferOffset,M),this._bufferOffset=M,this.needsUpload=!0},da.prototype.updatePaintArrays=function(M,O,Y,ie){for(var ye=0,we=Y;ye<we.length;ye+=1){var Ce=we[ye];this.needsUpload=this.programConfigurations[Ce.id].updatePaintArrays(M,this._featureMap,O,Ce,ie)||this.needsUpload}},da.prototype.get=function(M){return this.programConfigurations[M]},da.prototype.upload=function(M){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(M);this.needsUpload=!1}},da.prototype.destroy=function(){for(var M in this.programConfigurations)this.programConfigurations[M].destroy()},Kr("ConstantBinder",_i),Kr("CrossFadedConstantBinder",yi),Kr("SourceExpressionBinder",Ii),Kr("CrossFadedCompositeBinder",Oi),Kr("CompositeExpressionBinder",wi),Kr("ProgramConfiguration",Hi,{omit:["_buffers"]}),Kr("ProgramConfigurationSet",da);var pa,Ea=(pa=15,{min:-1*Math.pow(2,pa-1),max:Math.pow(2,pa-1)-1});function ba(M){for(var O=8192/M.extent,Y=M.loadGeometry(),ie=0;ie<Y.length;ie++)for(var ye=Y[ie],we=0;we<ye.length;we++){var Ce=ye[we];Ce.x=Math.round(Ce.x*O),Ce.y=Math.round(Ce.y*O),(Ce.x<Ea.min||Ce.x>Ea.max||Ce.y<Ea.min||Ce.y>Ea.max)&&(A("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ce.x=h(Ce.x,Ea.min,Ea.max),Ce.y=h(Ce.y,Ea.min,Ea.max))}return Y}function Mo(M,O,Y,ie,ye){M.emplaceBack(2*O+(ie+1)/2,2*Y+(ye+1)/2)}var Ja=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new ys,this.indexArray=new lo,this.segments=new Ft,this.programConfigurations=new da(_t,M.layers,M.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Vo(M,O){for(var Y=0;Y<M.length;Y++)if(hs(O,M[Y]))return!0;for(var ie=0;ie<O.length;ie++)if(hs(M,O[ie]))return!0;return!!Cl(M,O)}function Os(M,O,Y){return!!hs(M,O)||!!Ao(O,M,Y)}function ol(M,O){if(M.length===1)return Wl(O,M[0]);for(var Y=0;Y<O.length;Y++)for(var ie=O[Y],ye=0;ye<ie.length;ye++)if(hs(M,ie[ye]))return!0;for(var we=0;we<M.length;we++)if(Wl(O,M[we]))return!0;for(var Ce=0;Ce<O.length;Ce++)if(Cl(M,O[Ce]))return!0;return!1}function Yl(M,O,Y){if(M.length>1){if(Cl(M,O))return!0;for(var ie=0;ie<O.length;ie++)if(Ao(O[ie],M,Y))return!0}for(var ye=0;ye<M.length;ye++)if(Ao(M[ye],O,Y))return!0;return!1}function Cl(M,O){if(M.length===0||O.length===0)return!1;for(var Y=0;Y<M.length-1;Y++)for(var ie=M[Y],ye=M[Y+1],we=0;we<O.length-1;we++)if(Pl(ie,ye,O[we],O[we+1]))return!0;return!1}function Pl(M,O,Y,ie){return I(M,Y,ie)!==I(O,Y,ie)&&I(M,O,Y)!==I(M,O,ie)}function Ao(M,O,Y){var ie=Y*Y;if(O.length===1)return M.distSqr(O[0])<ie;for(var ye=1;ye<O.length;ye++)if(ml(M,O[ye-1],O[ye])<ie)return!0;return!1}function ml(M,O,Y){var ie=O.distSqr(Y);if(ie===0)return M.distSqr(O);var ye=((M.x-O.x)*(Y.x-O.x)+(M.y-O.y)*(Y.y-O.y))/ie;return ye<0?M.distSqr(O):ye>1?M.distSqr(Y):M.distSqr(Y.sub(O)._mult(ye)._add(O))}function Wl(M,O){for(var Y,ie,ye,we=!1,Ce=0;Ce<M.length;Ce++)for(var je=0,tt=(Y=M[Ce]).length-1;je<Y.length;tt=je++)ie=Y[je],ye=Y[tt],ie.y>O.y!=ye.y>O.y&&O.x<(ye.x-ie.x)*(O.y-ie.y)/(ye.y-ie.y)+ie.x&&(we=!we);return we}function hs(M,O){for(var Y=!1,ie=0,ye=M.length-1;ie<M.length;ye=ie++){var we=M[ie],Ce=M[ye];we.y>O.y!=Ce.y>O.y&&O.x<(Ce.x-we.x)*(O.y-we.y)/(Ce.y-we.y)+we.x&&(Y=!Y)}return Y}function Zl(M,O,Y){var ie=Y[0],ye=Y[2];if(M.x<ie.x&&O.x<ie.x||M.x>ye.x&&O.x>ye.x||M.y<ie.y&&O.y<ie.y||M.y>ye.y&&O.y>ye.y)return!1;var we=I(M,O,Y[0]);return we!==I(M,O,Y[1])||we!==I(M,O,Y[2])||we!==I(M,O,Y[3])}function La(M,O,Y){var ie=O.paint.get(M).value;return ie.kind==="constant"?ie.value:Y.programConfigurations.get(O.id).getMaxValue(M)}function Bo(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])}function No(M,O,Y,ie,ye){if(!O[0]&&!O[1])return M;var we=r.convert(O)._mult(ye);Y==="viewport"&&we._rotate(-ie);for(var Ce=[],je=0;je<M.length;je++){var tt=M[je];Ce.push(tt.sub(we))}return Ce}Ja.prototype.populate=function(M,O,Y){var ie=this.layers[0],ye=[],we=null;ie.type==="circle"&&(we=ie.layout.get("circle-sort-key"));for(var Ce=0,je=M;Ce<je.length;Ce+=1){var tt=je[Ce],ft=tt.feature,gt=tt.id,Bt=tt.index,Xt=tt.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,sr={type:ft.type,id:gt,properties:ft.properties,geometry:Yt?ba(ft):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),sr,Y)){Yt||(sr.geometry=ba(ft));var br=we?we.evaluate(sr,{},Y):void 0,Ir={id:gt,properties:ft.properties,type:ft.type,sourceLayerIndex:Xt,index:Bt,geometry:sr.geometry,patterns:{},sortKey:br};ye.push(Ir)}}we&&ye.sort(function(Wn,li){return Wn.sortKey-li.sortKey});for(var Pr=0,Vr=ye;Pr<Vr.length;Pr+=1){var Hr=Vr[Pr],Zr=Hr,pn=Zr.geometry,bn=Zr.index,jn=Zr.sourceLayerIndex,Nn=M[bn].feature;this.addFeature(Hr,pn,bn,Y),O.featureIndex.insert(Nn,pn,bn,jn,this.index)}},Ja.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},Ja.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ja.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ja.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,_t),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Ja.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ja.prototype.addFeature=function(M,O,Y,ie){for(var ye=0,we=O;ye<we.length;ye+=1)for(var Ce=0,je=we[ye];Ce<je.length;Ce+=1){var tt=je[Ce],ft=tt.x,gt=tt.y;if(!(ft<0||ft>=8192||gt<0||gt>=8192)){var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,M.sortKey),Xt=Bt.vertexLength;Mo(this.layoutVertexArray,ft,gt,-1,-1),Mo(this.layoutVertexArray,ft,gt,1,-1),Mo(this.layoutVertexArray,ft,gt,1,1),Mo(this.layoutVertexArray,ft,gt,-1,1),this.indexArray.emplaceBack(Xt,Xt+1,Xt+2),this.indexArray.emplaceBack(Xt,Xt+3,Xt+2),Bt.vertexLength+=4,Bt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,{},ie)},Kr("CircleBucket",Ja,{omit:["layers"]});var fc=new Fo({"circle-sort-key":new bi(be.layout_circle["circle-sort-key"])}),Df={paint:new Fo({"circle-radius":new bi(be.paint_circle["circle-radius"]),"circle-color":new bi(be.paint_circle["circle-color"]),"circle-blur":new bi(be.paint_circle["circle-blur"]),"circle-opacity":new bi(be.paint_circle["circle-opacity"]),"circle-translate":new fi(be.paint_circle["circle-translate"]),"circle-translate-anchor":new fi(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fi(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fi(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bi(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bi(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bi(be.paint_circle["circle-stroke-opacity"])}),layout:fc},ts=typeof Float32Array<"u"?Float32Array:Array;function Wc(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Xl(M,O,Y){var ie=O[0],ye=O[1],we=O[2],Ce=O[3],je=O[4],tt=O[5],ft=O[6],gt=O[7],Bt=O[8],Xt=O[9],Yt=O[10],sr=O[11],br=O[12],Ir=O[13],Pr=O[14],Vr=O[15],Hr=Y[0],Zr=Y[1],pn=Y[2],bn=Y[3];return M[0]=Hr*ie+Zr*je+pn*Bt+bn*br,M[1]=Hr*ye+Zr*tt+pn*Xt+bn*Ir,M[2]=Hr*we+Zr*ft+pn*Yt+bn*Pr,M[3]=Hr*Ce+Zr*gt+pn*sr+bn*Vr,Hr=Y[4],Zr=Y[5],pn=Y[6],bn=Y[7],M[4]=Hr*ie+Zr*je+pn*Bt+bn*br,M[5]=Hr*ye+Zr*tt+pn*Xt+bn*Ir,M[6]=Hr*we+Zr*ft+pn*Yt+bn*Pr,M[7]=Hr*Ce+Zr*gt+pn*sr+bn*Vr,Hr=Y[8],Zr=Y[9],pn=Y[10],bn=Y[11],M[8]=Hr*ie+Zr*je+pn*Bt+bn*br,M[9]=Hr*ye+Zr*tt+pn*Xt+bn*Ir,M[10]=Hr*we+Zr*ft+pn*Yt+bn*Pr,M[11]=Hr*Ce+Zr*gt+pn*sr+bn*Vr,Hr=Y[12],Zr=Y[13],pn=Y[14],bn=Y[15],M[12]=Hr*ie+Zr*je+pn*Bt+bn*br,M[13]=Hr*ye+Zr*tt+pn*Xt+bn*Ir,M[14]=Hr*we+Zr*ft+pn*Yt+bn*Pr,M[15]=Hr*Ce+Zr*gt+pn*sr+bn*Vr,M}Math.hypot||(Math.hypot=function(){for(var M=arguments,O=0,Y=arguments.length;Y--;)O+=M[Y]*M[Y];return Math.sqrt(O)});var zf=Xl,vl,Rf=function(M,O,Y){return M[0]=O[0]-Y[0],M[1]=O[1]-Y[1],M[2]=O[2]-Y[2],M};vl=new ts(3),ts!=Float32Array&&(vl[0]=0,vl[1]=0,vl[2]=0);function hc(M,O,Y){var ie=O[0],ye=O[1],we=O[2],Ce=O[3];return M[0]=Y[0]*ie+Y[4]*ye+Y[8]*we+Y[12]*Ce,M[1]=Y[1]*ie+Y[5]*ye+Y[9]*we+Y[13]*Ce,M[2]=Y[2]*ie+Y[6]*ye+Y[10]*we+Y[14]*Ce,M[3]=Y[3]*ie+Y[7]*ye+Y[11]*we+Y[15]*Ce,M}(function(){(function(){var M=new ts(4);return ts!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M})()})();var Zc=function(M){var O=M[0],Y=M[1];return O*O+Y*Y},im=(function(){(function(){var M=new ts(2);return ts!=Float32Array&&(M[0]=0,M[1]=0),M})()}(),function(M){function O(Y){M.call(this,Y,Df)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new Ja(Y)},O.prototype.queryRadius=function(Y){var ie=Y;return La("circle-radius",this,ie)+La("circle-stroke-width",this,ie)+Bo(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,ye,we,Ce,je,tt,ft){for(var gt=No(Y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),je.angle,tt),Bt=this.paint.get("circle-radius").evaluate(ie,ye)+this.paint.get("circle-stroke-width").evaluate(ie,ye),Xt=this.paint.get("circle-pitch-alignment")==="map",Yt=Xt?gt:function(jn,Nn){return jn.map(function(Wn){return hp(Wn,Nn)})}(gt,ft),sr=Xt?Bt*tt:Bt,br=0,Ir=we;br<Ir.length;br+=1)for(var Pr=0,Vr=Ir[br];Pr<Vr.length;Pr+=1){var Hr=Vr[Pr],Zr=Xt?Hr:hp(Hr,ft),pn=sr,bn=hc([],[Hr.x,Hr.y,0,1],ft);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pn*=bn[3]/je.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pn*=je.cameraToCenterDistance/bn[3]),Os(Yt,Zr,pn))return!0}return!1},O}(Ko));function hp(M,O){var Y=hc([],[M.x,M.y,0,1],O);return new r(Y[0]/Y[3],Y[1]/Y[3])}var pp=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ja);function Ff(M,O,Y,ie){var ye=O.width,we=O.height;if(ie){if(ie instanceof Uint8ClampedArray)ie=new Uint8Array(ie.buffer);else if(ie.length!==ye*we*Y)throw new RangeError("mismatched image size")}else ie=new Uint8Array(ye*we*Y);return M.width=ye,M.height=we,M.data=ie,M}function dp(M,O,Y){var ie=O.width,ye=O.height;if(ie!==M.width||ye!==M.height){var we=Ff({},{width:ie,height:ye},Y);Bf(M,we,{x:0,y:0},{x:0,y:0},{width:Math.min(M.width,ie),height:Math.min(M.height,ye)},Y),M.width=ie,M.height=ye,M.data=we.data}}function Bf(M,O,Y,ie,ye,we){if(ye.width===0||ye.height===0)return O;if(ye.width>M.width||ye.height>M.height||Y.x>M.width-ye.width||Y.y>M.height-ye.height)throw new RangeError("out of range source coordinates for image copy");if(ye.width>O.width||ye.height>O.height||ie.x>O.width-ye.width||ie.y>O.height-ye.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ce=M.data,je=O.data,tt=0;tt<ye.height;tt++)for(var ft=((Y.y+tt)*M.width+Y.x)*we,gt=((ie.y+tt)*O.width+ie.x)*we,Bt=0;Bt<ye.width*we;Bt++)je[gt+Bt]=Ce[ft+Bt];return O}Kr("HeatmapBucket",pp,{omit:["layers"]});var Kl=function(M,O){Ff(this,M,1,O)};Kl.prototype.resize=function(M){dp(this,M,1)},Kl.prototype.clone=function(){return new Kl({width:this.width,height:this.height},new Uint8Array(this.data))},Kl.copy=function(M,O,Y,ie,ye){Bf(M,O,Y,ie,ye,1)};var rs=function(M,O){Ff(this,M,4,O)};rs.prototype.resize=function(M){dp(this,M,4)},rs.prototype.replace=function(M,O){O?this.data.set(M):M instanceof Uint8ClampedArray?this.data=new Uint8Array(M.buffer):this.data=M},rs.prototype.clone=function(){return new rs({width:this.width,height:this.height},new Uint8Array(this.data))},rs.copy=function(M,O,Y,ie,ye){Bf(M,O,Y,ie,ye,4)},Kr("AlphaImage",Kl),Kr("RGBAImage",rs);var am={paint:new Fo({"heatmap-radius":new bi(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bi(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fi(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fs(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fi(be.paint_heatmap["heatmap-opacity"])})};function mp(M,O){for(var Y=new Uint8Array(1024),ie={},ye=0,we=0;ye<256;ye++,we+=4){ie[O]=ye/255;var Ce=M.evaluate(ie);Y[we+0]=Math.floor(255*Ce.r/Ce.a),Y[we+1]=Math.floor(255*Ce.g/Ce.a),Y[we+2]=Math.floor(255*Ce.b/Ce.a),Y[we+3]=Math.floor(255*Ce.a)}return new rs({width:256,height:1},Y)}var om=function(M){function O(Y){M.call(this,Y,am),this._updateColorRamp()}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new pp(Y)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){Y==="heatmap-color"&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){var Y=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=mp(Y,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},O}(Ko),sm={paint:new Fo({"hillshade-illumination-direction":new fi(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fi(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fi(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fi(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fi(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fi(be.paint_hillshade["hillshade-accent-color"])})},lm=function(M){function O(Y){M.call(this,Y,sm)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},O}(Ko),gp=oa([{name:"a_pos",components:2,type:"Int16"}],4).members,Nf=ku,cm=ku;function ku(M,O,Y){Y=Y||2;var ie,ye,we,Ce,je,tt,ft,gt=O&&O.length,Bt=gt?O[0]*Y:M.length,Xt=vp(M,0,Bt,Y,!0),Yt=[];if(!Xt||Xt.next===Xt.prev)return Yt;if(gt&&(Xt=function(br,Ir,Pr,Vr){var Hr,Zr,pn,bn,jn,Nn=[];for(Hr=0,Zr=Ir.length;Hr<Zr;Hr++)pn=Ir[Hr]*Vr,bn=Hr<Zr-1?Ir[Hr+1]*Vr:br.length,(jn=vp(br,pn,bn,Vr,!1))===jn.next&&(jn.steiner=!0),Nn.push(vm(jn));for(Nn.sort(dm),Hr=0;Hr<Nn.length;Hr++)mm(Nn[Hr],Pr),Pr=Il(Pr,Pr.next);return Pr}(M,O,Xt,Y)),M.length>80*Y){ie=we=M[0],ye=Ce=M[1];for(var sr=Y;sr<Bt;sr+=Y)(je=M[sr])<ie&&(ie=je),(tt=M[sr+1])<ye&&(ye=tt),je>we&&(we=je),tt>Ce&&(Ce=tt);ft=(ft=Math.max(we-ie,Ce-ye))!==0?1/ft:0}return Xc(Xt,Yt,Y,ie,ye,ft),Yt}function vp(M,O,Y,ie,ye){var we,Ce;if(ye===Vf(M,O,Y,ie)>0)for(we=O;we<Y;we+=ie)Ce=bp(we,M[we],M[we+1],Ce);else for(we=Y-ie;we>=O;we-=ie)Ce=bp(we,M[we],M[we+1],Ce);return Ce&&Mu(Ce,Ce.next)&&(Jc(Ce),Ce=Ce.next),Ce}function Il(M,O){if(!M)return M;O||(O=M);var Y,ie=M;do if(Y=!1,ie.steiner||!Mu(ie,ie.next)&&co(ie.prev,ie,ie.next)!==0)ie=ie.next;else{if(Jc(ie),(ie=O=ie.prev)===ie.next)break;Y=!0}while(Y||ie!==O);return O}function Xc(M,O,Y,ie,ye,we,Ce){if(M){!Ce&&we&&function(gt,Bt,Xt,Yt){var sr=gt;do sr.z===null&&(sr.z=jf(sr.x,sr.y,Bt,Xt,Yt)),sr.prevZ=sr.prev,sr.nextZ=sr.next,sr=sr.next;while(sr!==gt);sr.prevZ.nextZ=null,sr.prevZ=null,function(br){var Ir,Pr,Vr,Hr,Zr,pn,bn,jn,Nn=1;do{for(Pr=br,br=null,Zr=null,pn=0;Pr;){for(pn++,Vr=Pr,bn=0,Ir=0;Ir<Nn&&(bn++,Vr=Vr.nextZ);Ir++);for(jn=Nn;bn>0||jn>0&&Vr;)bn!==0&&(jn===0||!Vr||Pr.z<=Vr.z)?(Hr=Pr,Pr=Pr.nextZ,bn--):(Hr=Vr,Vr=Vr.nextZ,jn--),Zr?Zr.nextZ=Hr:br=Hr,Hr.prevZ=Zr,Zr=Hr;Pr=Vr}Zr.nextZ=null,Nn*=2}while(pn>1)}(sr)}(M,ie,ye,we);for(var je,tt,ft=M;M.prev!==M.next;)if(je=M.prev,tt=M.next,we?fm(M,ie,ye,we):um(M))O.push(je.i/Y),O.push(M.i/Y),O.push(tt.i/Y),Jc(M),M=tt.next,ft=tt.next;else if((M=tt)===ft){Ce?Ce===1?Xc(M=hm(Il(M),O,Y),O,Y,ie,ye,we,2):Ce===2&&pm(M,O,Y,ie,ye,we):Xc(Il(M),O,Y,ie,ye,we,1);break}}}function um(M){var O=M.prev,Y=M,ie=M.next;if(co(O,Y,ie)>=0)return!1;for(var ye=M.next.next;ye!==M.prev;){if(pc(O.x,O.y,Y.x,Y.y,ie.x,ie.y,ye.x,ye.y)&&co(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function fm(M,O,Y,ie){var ye=M.prev,we=M,Ce=M.next;if(co(ye,we,Ce)>=0)return!1;for(var je=ye.x<we.x?ye.x<Ce.x?ye.x:Ce.x:we.x<Ce.x?we.x:Ce.x,tt=ye.y<we.y?ye.y<Ce.y?ye.y:Ce.y:we.y<Ce.y?we.y:Ce.y,ft=ye.x>we.x?ye.x>Ce.x?ye.x:Ce.x:we.x>Ce.x?we.x:Ce.x,gt=ye.y>we.y?ye.y>Ce.y?ye.y:Ce.y:we.y>Ce.y?we.y:Ce.y,Bt=jf(je,tt,O,Y,ie),Xt=jf(ft,gt,O,Y,ie),Yt=M.prevZ,sr=M.nextZ;Yt&&Yt.z>=Bt&&sr&&sr.z<=Xt;){if(Yt!==M.prev&&Yt!==M.next&&pc(ye.x,ye.y,we.x,we.y,Ce.x,Ce.y,Yt.x,Yt.y)&&co(Yt.prev,Yt,Yt.next)>=0||(Yt=Yt.prevZ,sr!==M.prev&&sr!==M.next&&pc(ye.x,ye.y,we.x,we.y,Ce.x,Ce.y,sr.x,sr.y)&&co(sr.prev,sr,sr.next)>=0))return!1;sr=sr.nextZ}for(;Yt&&Yt.z>=Bt;){if(Yt!==M.prev&&Yt!==M.next&&pc(ye.x,ye.y,we.x,we.y,Ce.x,Ce.y,Yt.x,Yt.y)&&co(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.prevZ}for(;sr&&sr.z<=Xt;){if(sr!==M.prev&&sr!==M.next&&pc(ye.x,ye.y,we.x,we.y,Ce.x,Ce.y,sr.x,sr.y)&&co(sr.prev,sr,sr.next)>=0)return!1;sr=sr.nextZ}return!0}function hm(M,O,Y){var ie=M;do{var ye=ie.prev,we=ie.next.next;!Mu(ye,we)&&yp(ye,ie,ie.next,we)&&Kc(ye,we)&&Kc(we,ye)&&(O.push(ye.i/Y),O.push(ie.i/Y),O.push(we.i/Y),Jc(ie),Jc(ie.next),ie=M=we),ie=ie.next}while(ie!==M);return Il(ie)}function pm(M,O,Y,ie,ye,we){var Ce=M;do{for(var je=Ce.next.next;je!==Ce.prev;){if(Ce.i!==je.i&&ym(Ce,je)){var tt=xp(Ce,je);return Ce=Il(Ce,Ce.next),tt=Il(tt,tt.next),Xc(Ce,O,Y,ie,ye,we),void Xc(tt,O,Y,ie,ye,we)}je=je.next}Ce=Ce.next}while(Ce!==M)}function dm(M,O){return M.x-O.x}function mm(M,O){if(O=function(ie,ye){var we,Ce=ye,je=ie.x,tt=ie.y,ft=-1/0;do{if(tt<=Ce.y&&tt>=Ce.next.y&&Ce.next.y!==Ce.y){var gt=Ce.x+(tt-Ce.y)*(Ce.next.x-Ce.x)/(Ce.next.y-Ce.y);if(gt<=je&&gt>ft){if(ft=gt,gt===je){if(tt===Ce.y)return Ce;if(tt===Ce.next.y)return Ce.next}we=Ce.x<Ce.next.x?Ce:Ce.next}}Ce=Ce.next}while(Ce!==ye);if(!we)return null;if(je===ft)return we;var Bt,Xt=we,Yt=we.x,sr=we.y,br=1/0;Ce=we;do je>=Ce.x&&Ce.x>=Yt&&je!==Ce.x&&pc(tt<sr?je:ft,tt,Yt,sr,tt<sr?ft:je,tt,Ce.x,Ce.y)&&(Bt=Math.abs(tt-Ce.y)/(je-Ce.x),Kc(Ce,ie)&&(Bt<br||Bt===br&&(Ce.x>we.x||Ce.x===we.x&&gm(we,Ce)))&&(we=Ce,br=Bt)),Ce=Ce.next;while(Ce!==Xt);return we}(M,O)){var Y=xp(O,M);Il(O,O.next),Il(Y,Y.next)}}function gm(M,O){return co(M.prev,M,O.prev)<0&&co(O.next,M,M.next)<0}function jf(M,O,Y,ie,ye){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-Y)*ye)|M<<8))|M<<4))|M<<2))|M<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ie)*ye)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function vm(M){var O=M,Y=M;do(O.x<Y.x||O.x===Y.x&&O.y<Y.y)&&(Y=O),O=O.next;while(O!==M);return Y}function pc(M,O,Y,ie,ye,we,Ce,je){return(ye-Ce)*(O-je)-(M-Ce)*(we-je)>=0&&(M-Ce)*(ie-je)-(Y-Ce)*(O-je)>=0&&(Y-Ce)*(we-je)-(ye-Ce)*(ie-je)>=0}function ym(M,O){return M.next.i!==O.i&&M.prev.i!==O.i&&!function(Y,ie){var ye=Y;do{if(ye.i!==Y.i&&ye.next.i!==Y.i&&ye.i!==ie.i&&ye.next.i!==ie.i&&yp(ye,ye.next,Y,ie))return!0;ye=ye.next}while(ye!==Y);return!1}(M,O)&&(Kc(M,O)&&Kc(O,M)&&function(Y,ie){var ye=Y,we=!1,Ce=(Y.x+ie.x)/2,je=(Y.y+ie.y)/2;do ye.y>je!=ye.next.y>je&&ye.next.y!==ye.y&&Ce<(ye.next.x-ye.x)*(je-ye.y)/(ye.next.y-ye.y)+ye.x&&(we=!we),ye=ye.next;while(ye!==Y);return we}(M,O)&&(co(M.prev,M,O.prev)||co(M,O.prev,O))||Mu(M,O)&&co(M.prev,M,M.next)>0&&co(O.prev,O,O.next)>0)}function co(M,O,Y){return(O.y-M.y)*(Y.x-O.x)-(O.x-M.x)*(Y.y-O.y)}function Mu(M,O){return M.x===O.x&&M.y===O.y}function yp(M,O,Y,ie){var ye=Su(co(M,O,Y)),we=Su(co(M,O,ie)),Ce=Su(co(Y,ie,M)),je=Su(co(Y,ie,O));return ye!==we&&Ce!==je||!(ye!==0||!Au(M,Y,O))||!(we!==0||!Au(M,ie,O))||!(Ce!==0||!Au(Y,M,ie))||!(je!==0||!Au(Y,O,ie))}function Au(M,O,Y){return O.x<=Math.max(M.x,Y.x)&&O.x>=Math.min(M.x,Y.x)&&O.y<=Math.max(M.y,Y.y)&&O.y>=Math.min(M.y,Y.y)}function Su(M){return M>0?1:M<0?-1:0}function Kc(M,O){return co(M.prev,M,M.next)<0?co(M,O,M.next)>=0&&co(M,M.prev,O)>=0:co(M,O,M.prev)<0||co(M,M.next,O)<0}function xp(M,O){var Y=new Uf(M.i,M.x,M.y),ie=new Uf(O.i,O.x,O.y),ye=M.next,we=O.prev;return M.next=O,O.prev=M,Y.next=ye,ye.prev=Y,ie.next=Y,Y.prev=ie,we.next=ie,ie.prev=we,ie}function bp(M,O,Y,ie){var ye=new Uf(M,O,Y);return ie?(ye.next=ie.next,ye.prev=ie,ie.next.prev=ye,ie.next=ye):(ye.prev=ye,ye.next=ye),ye}function Jc(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function Uf(M,O,Y){this.i=M,this.x=O,this.y=Y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vf(M,O,Y,ie){for(var ye=0,we=O,Ce=Y-ie;we<Y;we+=ie)ye+=(M[Ce]-M[we])*(M[we+1]+M[Ce+1]),Ce=we;return ye}function xm(M,O,Y,ie,ye){(function we(Ce,je,tt,ft,gt){for(;ft>tt;){if(ft-tt>600){var Bt=ft-tt+1,Xt=je-tt+1,Yt=Math.log(Bt),sr=.5*Math.exp(2*Yt/3),br=.5*Math.sqrt(Yt*sr*(Bt-sr)/Bt)*(Xt-Bt/2<0?-1:1),Ir=Math.max(tt,Math.floor(je-Xt*sr/Bt+br)),Pr=Math.min(ft,Math.floor(je+(Bt-Xt)*sr/Bt+br));we(Ce,je,Ir,Pr,gt)}var Vr=Ce[je],Hr=tt,Zr=ft;for($c(Ce,tt,je),gt(Ce[ft],Vr)>0&&$c(Ce,tt,ft);Hr<Zr;){for($c(Ce,Hr,Zr),Hr++,Zr--;gt(Ce[Hr],Vr)<0;)Hr++;for(;gt(Ce[Zr],Vr)>0;)Zr--}gt(Ce[tt],Vr)===0?$c(Ce,tt,Zr):(Zr++,$c(Ce,Zr,ft)),Zr<=je&&(tt=Zr+1),je<=Zr&&(ft=Zr-1)}})(M,O,Y||0,ie||M.length-1,ye||bm)}function $c(M,O,Y){var ie=M[O];M[O]=M[Y],M[Y]=ie}function bm(M,O){return M<O?-1:M>O?1:0}function Hf(M,O){var Y=M.length;if(Y<=1)return[M];for(var ie,ye,we=[],Ce=0;Ce<Y;Ce++){var je=P(M[Ce]);je!==0&&(M[Ce].area=Math.abs(je),ye===void 0&&(ye=je<0),ye===je<0?(ie&&we.push(ie),ie=[M[Ce]]):ie.push(M[Ce]))}if(ie&&we.push(ie),O>1)for(var tt=0;tt<we.length;tt++)we[tt].length<=O||(xm(we[tt],O,1,we[tt].length-1,_m),we[tt]=we[tt].slice(0,O));return we}function _m(M,O){return O.area-M.area}function qf(M,O,Y){for(var ie=Y.patternDependencies,ye=!1,we=0,Ce=O;we<Ce.length;we+=1){var je=Ce[we].paint.get(M+"-pattern");je.isConstant()||(ye=!0);var tt=je.constantOr(null);tt&&(ye=!0,ie[tt.to]=!0,ie[tt.from]=!0)}return ye}function Gf(M,O,Y,ie,ye){for(var we=ye.patternDependencies,Ce=0,je=O;Ce<je.length;Ce+=1){var tt=je[Ce],ft=tt.paint.get(M+"-pattern").value;if(ft.kind!=="constant"){var gt=ft.evaluate({zoom:ie-1},Y,{},ye.availableImages),Bt=ft.evaluate({zoom:ie},Y,{},ye.availableImages),Xt=ft.evaluate({zoom:ie+1},Y,{},ye.availableImages);gt=gt&&gt.name?gt.name:gt,Bt=Bt&&Bt.name?Bt.name:Bt,Xt=Xt&&Xt.name?Xt.name:Xt,we[gt]=!0,we[Bt]=!0,we[Xt]=!0,Y.patterns[tt.id]={min:gt,mid:Bt,max:Xt}}}return Y}ku.deviation=function(M,O,Y,ie){var ye=O&&O.length,we=ye?O[0]*Y:M.length,Ce=Math.abs(Vf(M,0,we,Y));if(ye)for(var je=0,tt=O.length;je<tt;je++){var ft=O[je]*Y,gt=je<tt-1?O[je+1]*Y:M.length;Ce-=Math.abs(Vf(M,ft,gt,Y))}var Bt=0;for(je=0;je<ie.length;je+=3){var Xt=ie[je]*Y,Yt=ie[je+1]*Y,sr=ie[je+2]*Y;Bt+=Math.abs((M[Xt]-M[sr])*(M[Yt+1]-M[Xt+1])-(M[Xt]-M[Yt])*(M[sr+1]-M[Xt+1]))}return Ce===0&&Bt===0?0:Math.abs((Bt-Ce)/Ce)},ku.flatten=function(M){for(var O=M[0][0].length,Y={vertices:[],holes:[],dimensions:O},ie=0,ye=0;ye<M.length;ye++){for(var we=0;we<M[ye].length;we++)for(var Ce=0;Ce<O;Ce++)Y.vertices.push(M[ye][we][Ce]);ye>0&&(ie+=M[ye-1].length,Y.holes.push(ie))}return Y},Nf.default=cm;var qs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ys,this.indexArray=new lo,this.indexArray2=new F,this.programConfigurations=new da(gp,M.layers,M.zoom),this.segments=new Ft,this.segments2=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};qs.prototype.populate=function(M,O,Y){this.hasPattern=qf("fill",this.layers,O);for(var ie=this.layers[0].layout.get("fill-sort-key"),ye=[],we=0,Ce=M;we<Ce.length;we+=1){var je=Ce[we],tt=je.feature,ft=je.id,gt=je.index,Bt=je.sourceLayerIndex,Xt=this.layers[0]._featureFilter.needGeometry,Yt={type:tt.type,id:ft,properties:tt.properties,geometry:Xt?ba(tt):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),Yt,Y)){Xt||(Yt.geometry=ba(tt));var sr=ie?ie.evaluate(Yt,{},Y,O.availableImages):void 0,br={id:ft,properties:tt.properties,type:tt.type,sourceLayerIndex:Bt,index:gt,geometry:Yt.geometry,patterns:{},sortKey:sr};ye.push(br)}}ie&&ye.sort(function(Wn,li){return Wn.sortKey-li.sortKey});for(var Ir=0,Pr=ye;Ir<Pr.length;Ir+=1){var Vr=Pr[Ir],Hr=Vr,Zr=Hr.geometry,pn=Hr.index,bn=Hr.sourceLayerIndex;if(this.hasPattern){var jn=Gf("fill",this.layers,Vr,this.zoom,O);this.patternFeatures.push(jn)}else this.addFeature(Vr,Zr,pn,Y,{});var Nn=M[pn].feature;O.featureIndex.insert(Nn,Zr,pn,bn,this.index)}},qs.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},qs.prototype.addFeatures=function(M,O,Y){for(var ie=0,ye=this.patternFeatures;ie<ye.length;ie+=1){var we=ye[ie];this.addFeature(we,we.geometry,we.index,O,Y)}},qs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,gp),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.indexBuffer2=M.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(M),this.uploaded=!0},qs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},qs.prototype.addFeature=function(M,O,Y,ie,ye){for(var we=0,Ce=Hf(O,500);we<Ce.length;we+=1){for(var je=Ce[we],tt=0,ft=0,gt=je;ft<gt.length;ft+=1)tt+=gt[ft].length;for(var Bt=this.segments.prepareSegment(tt,this.layoutVertexArray,this.indexArray),Xt=Bt.vertexLength,Yt=[],sr=[],br=0,Ir=je;br<Ir.length;br+=1){var Pr=Ir[br];if(Pr.length!==0){Pr!==je[0]&&sr.push(Yt.length/2);var Vr=this.segments2.prepareSegment(Pr.length,this.layoutVertexArray,this.indexArray2),Hr=Vr.vertexLength;this.layoutVertexArray.emplaceBack(Pr[0].x,Pr[0].y),this.indexArray2.emplaceBack(Hr+Pr.length-1,Hr),Yt.push(Pr[0].x),Yt.push(Pr[0].y);for(var Zr=1;Zr<Pr.length;Zr++)this.layoutVertexArray.emplaceBack(Pr[Zr].x,Pr[Zr].y),this.indexArray2.emplaceBack(Hr+Zr-1,Hr+Zr),Yt.push(Pr[Zr].x),Yt.push(Pr[Zr].y);Vr.vertexLength+=Pr.length,Vr.primitiveLength+=Pr.length}}for(var pn=Nf(Yt,sr),bn=0;bn<pn.length;bn+=3)this.indexArray.emplaceBack(Xt+pn[bn],Xt+pn[bn+1],Xt+pn[bn+2]);Bt.vertexLength+=tt,Bt.primitiveLength+=pn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,ye,ie)},Kr("FillBucket",qs,{omit:["layers","patternFeatures"]});var wm=new Fo({"fill-sort-key":new bi(be.layout_fill["fill-sort-key"])}),Tm={paint:new Fo({"fill-antialias":new fi(be.paint_fill["fill-antialias"]),"fill-opacity":new bi(be.paint_fill["fill-opacity"]),"fill-color":new bi(be.paint_fill["fill-color"]),"fill-outline-color":new bi(be.paint_fill["fill-outline-color"]),"fill-translate":new fi(be.paint_fill["fill-translate"]),"fill-translate-anchor":new fi(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new il(be.paint_fill["fill-pattern"])}),layout:wm},km=function(M){function O(Y){M.call(this,Y,Tm)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(Y,ie){M.prototype.recalculate.call(this,Y,ie);var ye=this.paint._values["fill-outline-color"];ye.value.kind==="constant"&&ye.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(Y){return new qs(Y)},O.prototype.queryRadius=function(){return Bo(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,ye,we,Ce,je,tt){return ol(No(Y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),je.angle,tt),we)},O.prototype.isTileClipped=function(){return!0},O}(Ko),_p=oa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,wp=dc;function dc(M,O,Y,ie,ye){this.properties={},this.extent=Y,this.type=0,this._pbf=M,this._geometry=-1,this._keys=ie,this._values=ye,M.readFields(Mm,this,O)}function Mm(M,O,Y){M==1?O.id=Y.readVarint():M==2?function(ie,ye){for(var we=ie.readVarint()+ie.pos;ie.pos<we;){var Ce=ye._keys[ie.readVarint()],je=ye._values[ie.readVarint()];ye.properties[Ce]=je}}(Y,O):M==3?O.type=Y.readVarint():M==4&&(O._geometry=Y.pos)}function Am(M){for(var O,Y,ie=0,ye=0,we=M.length,Ce=we-1;ye<we;Ce=ye++)O=M[ye],ie+=((Y=M[Ce]).x-O.x)*(O.y+Y.y);return ie}dc.types=["Unknown","Point","LineString","Polygon"],dc.prototype.loadGeometry=function(){var M=this._pbf;M.pos=this._geometry;for(var O,Y=M.readVarint()+M.pos,ie=1,ye=0,we=0,Ce=0,je=[];M.pos<Y;){if(ye<=0){var tt=M.readVarint();ie=7&tt,ye=tt>>3}if(ye--,ie===1||ie===2)we+=M.readSVarint(),Ce+=M.readSVarint(),ie===1&&(O&&je.push(O),O=[]),O.push(new r(we,Ce));else{if(ie!==7)throw new Error("unknown command "+ie);O&&O.push(O[0].clone())}}return O&&je.push(O),je},dc.prototype.bbox=function(){var M=this._pbf;M.pos=this._geometry;for(var O=M.readVarint()+M.pos,Y=1,ie=0,ye=0,we=0,Ce=1/0,je=-1/0,tt=1/0,ft=-1/0;M.pos<O;){if(ie<=0){var gt=M.readVarint();Y=7&gt,ie=gt>>3}if(ie--,Y===1||Y===2)(ye+=M.readSVarint())<Ce&&(Ce=ye),ye>je&&(je=ye),(we+=M.readSVarint())<tt&&(tt=we),we>ft&&(ft=we);else if(Y!==7)throw new Error("unknown command "+Y)}return[Ce,tt,je,ft]},dc.prototype.toGeoJSON=function(M,O,Y){var ie,ye,we=this.extent*Math.pow(2,Y),Ce=this.extent*M,je=this.extent*O,tt=this.loadGeometry(),ft=dc.types[this.type];function gt(Yt){for(var sr=0;sr<Yt.length;sr++){var br=Yt[sr],Ir=180-360*(br.y+je)/we;Yt[sr]=[360*(br.x+Ce)/we-180,360/Math.PI*Math.atan(Math.exp(Ir*Math.PI/180))-90]}}switch(this.type){case 1:var Bt=[];for(ie=0;ie<tt.length;ie++)Bt[ie]=tt[ie][0];gt(tt=Bt);break;case 2:for(ie=0;ie<tt.length;ie++)gt(tt[ie]);break;case 3:for(tt=function(Yt){var sr=Yt.length;if(sr<=1)return[Yt];for(var br,Ir,Pr=[],Vr=0;Vr<sr;Vr++){var Hr=Am(Yt[Vr]);Hr!==0&&(Ir===void 0&&(Ir=Hr<0),Ir===Hr<0?(br&&Pr.push(br),br=[Yt[Vr]]):br.push(Yt[Vr]))}return br&&Pr.push(br),Pr}(tt),ie=0;ie<tt.length;ie++)for(ye=0;ye<tt[ie].length;ye++)gt(tt[ie][ye])}tt.length===1?tt=tt[0]:ft="Multi"+ft;var Xt={type:"Feature",geometry:{type:ft,coordinates:tt},properties:this.properties};return"id"in this&&(Xt.id=this.id),Xt};var Tp=kp;function kp(M,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=M,this._keys=[],this._values=[],this._features=[],M.readFields(Sm,this,O),this.length=this._features.length}function Sm(M,O,Y){M===15?O.version=Y.readVarint():M===1?O.name=Y.readString():M===5?O.extent=Y.readVarint():M===2?O._features.push(Y.pos):M===3?O._keys.push(Y.readString()):M===4&&O._values.push(function(ie){for(var ye=null,we=ie.readVarint()+ie.pos;ie.pos<we;){var Ce=ie.readVarint()>>3;ye=Ce===1?ie.readString():Ce===2?ie.readFloat():Ce===3?ie.readDouble():Ce===4?ie.readVarint64():Ce===5?ie.readVarint():Ce===6?ie.readSVarint():Ce===7?ie.readBoolean():null}return ye}(Y))}function Em(M,O,Y){if(M===3){var ie=new Tp(Y,Y.readVarint()+Y.pos);ie.length&&(O[ie.name]=ie)}}kp.prototype.feature=function(M){if(M<0||M>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[M];var O=this._pbf.readVarint()+this._pbf.pos;return new wp(this._pbf,O,this.extent,this._keys,this._values)};var mc={VectorTile:function(M,O){this.layers=M.readFields(Em,{},O)},VectorTileFeature:wp,VectorTileLayer:Tp},Lm=mc.VectorTileFeature.types,Yf=Math.pow(2,13);function Qc(M,O,Y,ie,ye,we,Ce,je){M.emplaceBack(O,Y,2*Math.floor(ie*Yf)+Ce,ye*Yf*2,we*Yf*2,Math.round(je))}var Gs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new Ss,this.indexArray=new lo,this.programConfigurations=new da(_p,M.layers,M.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Cm(M,O){return M.x===O.x&&(M.x<0||M.x>8192)||M.y===O.y&&(M.y<0||M.y>8192)}function Pm(M){return M.every(function(O){return O.x<0})||M.every(function(O){return O.x>8192})||M.every(function(O){return O.y<0})||M.every(function(O){return O.y>8192})}Gs.prototype.populate=function(M,O,Y){this.features=[],this.hasPattern=qf("fill-extrusion",this.layers,O);for(var ie=0,ye=M;ie<ye.length;ie+=1){var we=ye[ie],Ce=we.feature,je=we.id,tt=we.index,ft=we.sourceLayerIndex,gt=this.layers[0]._featureFilter.needGeometry,Bt={type:Ce.type,id:je,properties:Ce.properties,geometry:gt?ba(Ce):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),Bt,Y)){var Xt={id:je,sourceLayerIndex:ft,index:tt,geometry:gt?Bt.geometry:ba(Ce),properties:Ce.properties,type:Ce.type,patterns:{}};Ce.id!==void 0&&(Xt.id=Ce.id),this.hasPattern?this.features.push(Gf("fill-extrusion",this.layers,Xt,this.zoom,O)):this.addFeature(Xt,Xt.geometry,tt,Y,{}),O.featureIndex.insert(Ce,Xt.geometry,tt,ft,this.index,!0)}}},Gs.prototype.addFeatures=function(M,O,Y){for(var ie=0,ye=this.features;ie<ye.length;ie+=1){var we=ye[ie],Ce=we.geometry;this.addFeature(we,Ce,we.index,O,Y)}},Gs.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},Gs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Gs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Gs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,_p),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Gs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Gs.prototype.addFeature=function(M,O,Y,ie,ye){for(var we=0,Ce=Hf(O,500);we<Ce.length;we+=1){for(var je=Ce[we],tt=0,ft=0,gt=je;ft<gt.length;ft+=1)tt+=gt[ft].length;for(var Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Xt=0,Yt=je;Xt<Yt.length;Xt+=1){var sr=Yt[Xt];if(sr.length!==0&&!Pm(sr))for(var br=0,Ir=0;Ir<sr.length;Ir++){var Pr=sr[Ir];if(Ir>=1){var Vr=sr[Ir-1];if(!Cm(Pr,Vr)){Bt.vertexLength+4>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Hr=Pr.sub(Vr)._perp()._unit(),Zr=Vr.dist(Pr);br+Zr>32768&&(br=0),Qc(this.layoutVertexArray,Pr.x,Pr.y,Hr.x,Hr.y,0,0,br),Qc(this.layoutVertexArray,Pr.x,Pr.y,Hr.x,Hr.y,0,1,br),br+=Zr,Qc(this.layoutVertexArray,Vr.x,Vr.y,Hr.x,Hr.y,0,0,br),Qc(this.layoutVertexArray,Vr.x,Vr.y,Hr.x,Hr.y,0,1,br);var pn=Bt.vertexLength;this.indexArray.emplaceBack(pn,pn+2,pn+1),this.indexArray.emplaceBack(pn+1,pn+2,pn+3),Bt.vertexLength+=4,Bt.primitiveLength+=2}}}}if(Bt.vertexLength+tt>Ft.MAX_VERTEX_ARRAY_LENGTH&&(Bt=this.segments.prepareSegment(tt,this.layoutVertexArray,this.indexArray)),Lm[M.type]==="Polygon"){for(var bn=[],jn=[],Nn=Bt.vertexLength,Wn=0,li=je;Wn<li.length;Wn+=1){var ci=li[Wn];if(ci.length!==0){ci!==je[0]&&jn.push(bn.length/2);for(var $n=0;$n<ci.length;$n++){var mi=ci[$n];Qc(this.layoutVertexArray,mi.x,mi.y,0,0,1,1,0),bn.push(mi.x),bn.push(mi.y)}}}for(var pi=Nf(bn,jn),ui=0;ui<pi.length;ui+=3)this.indexArray.emplaceBack(Nn+pi[ui],Nn+pi[ui+2],Nn+pi[ui+1]);Bt.primitiveLength+=pi.length/3,Bt.vertexLength+=tt}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,ye,ie)},Kr("FillExtrusionBucket",Gs,{omit:["layers","features"]});var Im={paint:new Fo({"fill-extrusion-opacity":new fi(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bi(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fi(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fi(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new il(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bi(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bi(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fi(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Om=function(M){function O(Y){M.call(this,Y,Im)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new Gs(Y)},O.prototype.queryRadius=function(){return Bo(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(Y,ie,ye,we,Ce,je,tt,ft){var gt=No(Y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),je.angle,tt),Bt=this.paint.get("fill-extrusion-height").evaluate(ie,ye),Xt=this.paint.get("fill-extrusion-base").evaluate(ie,ye),Yt=function(br,Ir,Pr,Vr){for(var Hr=[],Zr=0,pn=br;Zr<pn.length;Zr+=1){var bn=pn[Zr],jn=[bn.x,bn.y,Vr,1];hc(jn,jn,Ir),Hr.push(new r(jn[0]/jn[3],jn[1]/jn[3]))}return Hr}(gt,ft,0,0),sr=function(br,Ir,Pr,Vr){for(var Hr=[],Zr=[],pn=Vr[8]*Ir,bn=Vr[9]*Ir,jn=Vr[10]*Ir,Nn=Vr[11]*Ir,Wn=Vr[8]*Pr,li=Vr[9]*Pr,ci=Vr[10]*Pr,$n=Vr[11]*Pr,mi=0,pi=br;mi<pi.length;mi+=1){for(var ui=pi[mi],Qi=[],qi=[],na=0,Ti=ui;na<Ti.length;na+=1){var Yi=Ti[na],wa=Yi.x,ma=Yi.y,Pa=Vr[0]*wa+Vr[4]*ma+Vr[12],ga=Vr[1]*wa+Vr[5]*ma+Vr[13],ho=Vr[2]*wa+Vr[6]*ma+Vr[14],Ia=Vr[3]*wa+Vr[7]*ma+Vr[15],jo=ho+jn,Eo=Ia+Nn,Po=Pa+Wn,Jo=ga+li,qo=ho+ci,po=Ia+$n,Io=new r((Pa+pn)/Eo,(ga+bn)/Eo);Io.z=jo/Eo,Qi.push(Io);var eo=new r(Po/po,Jo/po);eo.z=qo/po,qi.push(eo)}Hr.push(Qi),Zr.push(qi)}return[Hr,Zr]}(we,Xt,Bt,ft);return function(br,Ir,Pr){var Vr=1/0;ol(Pr,Ir)&&(Vr=Mp(Pr,Ir[0]));for(var Hr=0;Hr<Ir.length;Hr++)for(var Zr=Ir[Hr],pn=br[Hr],bn=0;bn<Zr.length-1;bn++){var jn=Zr[bn],Nn=Zr[bn+1],Wn=pn[bn],li=pn[bn+1],ci=[jn,Nn,li,Wn,jn];Vo(Pr,ci)&&(Vr=Math.min(Vr,Mp(Pr,ci)))}return Vr!==1/0&&Vr}(sr[0],sr[1],Yt)},O}(Ko);function eu(M,O){return M.x*O.x+M.y*O.y}function Mp(M,O){if(M.length===1){for(var Y,ie=0,ye=O[ie++];!Y||ye.equals(Y);)if(!(Y=O[ie++]))return 1/0;for(;ie<O.length;ie++){var we=O[ie],Ce=M[0],je=Y.sub(ye),tt=we.sub(ye),ft=Ce.sub(ye),gt=eu(je,je),Bt=eu(je,tt),Xt=eu(tt,tt),Yt=eu(ft,je),sr=eu(ft,tt),br=gt*Xt-Bt*Bt,Ir=(Xt*Yt-Bt*sr)/br,Pr=(gt*sr-Bt*Yt)/br,Vr=1-Ir-Pr,Hr=ye.z*Vr+Y.z*Ir+we.z*Pr;if(isFinite(Hr))return Hr}return 1/0}for(var Zr=1/0,pn=0,bn=O;pn<bn.length;pn+=1){var jn=bn[pn];Zr=Math.min(Zr,jn.z)}return Zr}var Ap=oa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Dm=mc.VectorTileFeature.types,zm=Math.cos(Math.PI/180*37.5),Sp=Math.pow(2,14)/.5,ns=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Us,this.indexArray=new lo,this.programConfigurations=new da(Ap,M.layers,M.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ns.prototype.populate=function(M,O,Y){this.hasPattern=qf("line",this.layers,O);for(var ie=this.layers[0].layout.get("line-sort-key"),ye=[],we=0,Ce=M;we<Ce.length;we+=1){var je=Ce[we],tt=je.feature,ft=je.id,gt=je.index,Bt=je.sourceLayerIndex,Xt=this.layers[0]._featureFilter.needGeometry,Yt={type:tt.type,id:ft,properties:tt.properties,geometry:Xt?ba(tt):[]};if(this.layers[0]._featureFilter.filter(new aa(this.zoom),Yt,Y)){Xt||(Yt.geometry=ba(tt));var sr=ie?ie.evaluate(Yt,{},Y):void 0,br={id:ft,properties:tt.properties,type:tt.type,sourceLayerIndex:Bt,index:gt,geometry:Yt.geometry,patterns:{},sortKey:sr};ye.push(br)}}ie&&ye.sort(function(Wn,li){return Wn.sortKey-li.sortKey});for(var Ir=0,Pr=ye;Ir<Pr.length;Ir+=1){var Vr=Pr[Ir],Hr=Vr,Zr=Hr.geometry,pn=Hr.index,bn=Hr.sourceLayerIndex;if(this.hasPattern){var jn=Gf("line",this.layers,Vr,this.zoom,O);this.patternFeatures.push(jn)}else this.addFeature(Vr,Zr,pn,Y,{});var Nn=M[pn].feature;O.featureIndex.insert(Nn,Zr,pn,bn,this.index)}},ns.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},ns.prototype.addFeatures=function(M,O,Y){for(var ie=0,ye=this.patternFeatures;ie<ye.length;ie+=1){var we=ye[ie];this.addFeature(we,we.geometry,we.index,O,Y)}},ns.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ns.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ns.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Ap),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ns.prototype.addFeature=function(M,O,Y,ie,ye){for(var we=this.layers[0].layout,Ce=we.get("line-join").evaluate(M,{}),je=we.get("line-cap"),tt=we.get("line-miter-limit"),ft=we.get("line-round-limit"),gt=0,Bt=O;gt<Bt.length;gt+=1){var Xt=Bt[gt];this.addLine(Xt,M,Ce,je,tt,ft)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,ye,ie)},ns.prototype.addLine=function(M,O,Y,ie,ye,we){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Ce=0;Ce<M.length-1;Ce++)this.totalDistance+=M[Ce].dist(M[Ce+1]);this.updateScaledDistance()}for(var je=Dm[O.type]==="Polygon",tt=M.length;tt>=2&&M[tt-1].equals(M[tt-2]);)tt--;for(var ft=0;ft<tt-1&&M[ft].equals(M[ft+1]);)ft++;if(!(tt<(je?3:2))){Y==="bevel"&&(ye=1.05);var gt,Bt=this.overscaling<=16?122880/(512*this.overscaling):0,Xt=this.segments.prepareSegment(10*tt,this.layoutVertexArray,this.indexArray),Yt=void 0,sr=void 0,br=void 0,Ir=void 0;this.e1=this.e2=-1,je&&(gt=M[tt-2],Ir=M[ft].sub(gt)._unit()._perp());for(var Pr=ft;Pr<tt;Pr++)if(!(sr=Pr===tt-1?je?M[ft+1]:void 0:M[Pr+1])||!M[Pr].equals(sr)){Ir&&(br=Ir),gt&&(Yt=gt),gt=M[Pr],Ir=sr?sr.sub(gt)._unit()._perp():br;var Vr=(br=br||Ir).add(Ir);Vr.x===0&&Vr.y===0||Vr._unit();var Hr=br.x*Ir.x+br.y*Ir.y,Zr=Vr.x*Ir.x+Vr.y*Ir.y,pn=Zr!==0?1/Zr:1/0,bn=2*Math.sqrt(2-2*Zr),jn=Zr<zm&&Yt&&sr,Nn=br.x*Ir.y-br.y*Ir.x>0;if(jn&&Pr>ft){var Wn=gt.dist(Yt);if(Wn>2*Bt){var li=gt.sub(gt.sub(Yt)._mult(Bt/Wn)._round());this.updateDistance(Yt,li),this.addCurrentVertex(li,br,0,0,Xt),Yt=li}}var ci=Yt&&sr,$n=ci?Y:je?"butt":ie;if(ci&&$n==="round"&&(pn<we?$n="miter":pn<=2&&($n="fakeround")),$n==="miter"&&pn>ye&&($n="bevel"),$n==="bevel"&&(pn>2&&($n="flipbevel"),pn<ye&&($n="miter")),Yt&&this.updateDistance(Yt,gt),$n==="miter")Vr._mult(pn),this.addCurrentVertex(gt,Vr,0,0,Xt);else if($n==="flipbevel"){if(pn>100)Vr=Ir.mult(-1);else{var mi=pn*br.add(Ir).mag()/br.sub(Ir).mag();Vr._perp()._mult(mi*(Nn?-1:1))}this.addCurrentVertex(gt,Vr,0,0,Xt),this.addCurrentVertex(gt,Vr.mult(-1),0,0,Xt)}else if($n==="bevel"||$n==="fakeround"){var pi=-Math.sqrt(pn*pn-1),ui=Nn?pi:0,Qi=Nn?0:pi;if(Yt&&this.addCurrentVertex(gt,br,ui,Qi,Xt),$n==="fakeround")for(var qi=Math.round(180*bn/Math.PI/20),na=1;na<qi;na++){var Ti=na/qi;if(Ti!==.5){var Yi=Ti-.5;Ti+=Ti*Yi*(Ti-1)*((1.0904+Hr*(Hr*(3.55645-1.43519*Hr)-3.2452))*Yi*Yi+(.848013+Hr*(.215638*Hr-1.06021)))}var wa=Ir.sub(br)._mult(Ti)._add(br)._unit()._mult(Nn?-1:1);this.addHalfVertex(gt,wa.x,wa.y,!1,Nn,0,Xt)}sr&&this.addCurrentVertex(gt,Ir,-ui,-Qi,Xt)}else if($n==="butt")this.addCurrentVertex(gt,Vr,0,0,Xt);else if($n==="square"){var ma=Yt?1:-1;this.addCurrentVertex(gt,Vr,ma,ma,Xt)}else $n==="round"&&(Yt&&(this.addCurrentVertex(gt,br,0,0,Xt),this.addCurrentVertex(gt,br,1,1,Xt,!0)),sr&&(this.addCurrentVertex(gt,Ir,-1,-1,Xt,!0),this.addCurrentVertex(gt,Ir,0,0,Xt)));if(jn&&Pr<tt-1){var Pa=gt.dist(sr);if(Pa>2*Bt){var ga=gt.add(sr.sub(gt)._mult(Bt/Pa)._round());this.updateDistance(gt,ga),this.addCurrentVertex(ga,Ir,0,0,Xt),gt=ga}}}}},ns.prototype.addCurrentVertex=function(M,O,Y,ie,ye,we){we===void 0&&(we=!1);var Ce=O.x+O.y*Y,je=O.y-O.x*Y,tt=-O.x+O.y*ie,ft=-O.y-O.x*ie;this.addHalfVertex(M,Ce,je,we,!1,Y,ye),this.addHalfVertex(M,tt,ft,we,!0,-ie,ye),this.distance>Sp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(M,O,Y,ie,ye,we))},ns.prototype.addHalfVertex=function(M,O,Y,ie,ye,we,Ce){var je=M.x,tt=M.y,ft=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((je<<1)+(ie?1:0),(tt<<1)+(ye?1:0),Math.round(63*O)+128,Math.round(63*Y)+128,1+(we===0?0:we<0?-1:1)|(63&ft)<<2,ft>>6);var gt=Ce.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,gt),Ce.primitiveLength++),ye?this.e2=gt:this.e1=gt},ns.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Sp-1):this.distance},ns.prototype.updateDistance=function(M,O){this.distance+=M.dist(O),this.updateScaledDistance()},Kr("LineBucket",ns,{omit:["layers","patternFeatures"]});var Rm=new Fo({"line-cap":new fi(be.layout_line["line-cap"]),"line-join":new bi(be.layout_line["line-join"]),"line-miter-limit":new fi(be.layout_line["line-miter-limit"]),"line-round-limit":new fi(be.layout_line["line-round-limit"]),"line-sort-key":new bi(be.layout_line["line-sort-key"])}),Ep={paint:new Fo({"line-opacity":new bi(be.paint_line["line-opacity"]),"line-color":new bi(be.paint_line["line-color"]),"line-translate":new fi(be.paint_line["line-translate"]),"line-translate-anchor":new fi(be.paint_line["line-translate-anchor"]),"line-width":new bi(be.paint_line["line-width"]),"line-gap-width":new bi(be.paint_line["line-gap-width"]),"line-offset":new bi(be.paint_line["line-offset"]),"line-blur":new bi(be.paint_line["line-blur"]),"line-dasharray":new al(be.paint_line["line-dasharray"]),"line-pattern":new il(be.paint_line["line-pattern"]),"line-gradient":new fs(be.paint_line["line-gradient"])}),layout:Rm},Lp=new(function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(Y,ie){return ie=new aa(Math.floor(ie.zoom),{now:ie.now,fadeDuration:ie.fadeDuration,zoomHistory:ie.zoomHistory,transition:ie.transition}),M.prototype.possiblyEvaluate.call(this,Y,ie)},O.prototype.evaluate=function(Y,ie,ye,we){return ie=o({},ie,{zoom:Math.floor(ie.zoom)}),M.prototype.evaluate.call(this,Y,ie,ye,we)},O}(bi))(Ep.paint.properties["line-width"].specification);Lp.useIntegerZoom=!0;var Fm=function(M){function O(Y){M.call(this,Y,Ep)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(Y){Y==="line-gradient"&&this._updateGradient()},O.prototype._updateGradient=function(){var Y=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=mp(Y,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(Y,ie){M.prototype.recalculate.call(this,Y,ie),this.paint._values["line-floorwidth"]=Lp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Y)},O.prototype.createBucket=function(Y){return new ns(Y)},O.prototype.queryRadius=function(Y){var ie=Y,ye=Cp(La("line-width",this,ie),La("line-gap-width",this,ie)),we=La("line-offset",this,ie);return ye/2+Math.abs(we)+Bo(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(Y,ie,ye,we,Ce,je,tt){var ft=No(Y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),je.angle,tt),gt=tt/2*Cp(this.paint.get("line-width").evaluate(ie,ye),this.paint.get("line-gap-width").evaluate(ie,ye)),Bt=this.paint.get("line-offset").evaluate(ie,ye);return Bt&&(we=function(Xt,Yt){for(var sr=[],br=new r(0,0),Ir=0;Ir<Xt.length;Ir++){for(var Pr=Xt[Ir],Vr=[],Hr=0;Hr<Pr.length;Hr++){var Zr=Pr[Hr-1],pn=Pr[Hr],bn=Pr[Hr+1],jn=Hr===0?br:pn.sub(Zr)._unit()._perp(),Nn=Hr===Pr.length-1?br:bn.sub(pn)._unit()._perp(),Wn=jn._add(Nn)._unit(),li=Wn.x*Nn.x+Wn.y*Nn.y;Wn._mult(1/li),Vr.push(Wn._mult(Yt)._add(pn))}sr.push(Vr)}return sr}(we,Bt*tt)),function(Xt,Yt,sr){for(var br=0;br<Yt.length;br++){var Ir=Yt[br];if(Xt.length>=3){for(var Pr=0;Pr<Ir.length;Pr++)if(hs(Xt,Ir[Pr]))return!0}if(Yl(Xt,Ir,sr))return!0}return!1}(ft,we,gt)},O.prototype.isTileClipped=function(){return!0},O}(Ko);function Cp(M,O){return O>0?O+2*M:M}var Wf=oa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bm=oa([{name:"a_projected_pos",components:3,type:"Float32"}],4),Nm=(oa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Pp=(oa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),jm=oa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);oa([{name:"triangle",components:3,type:"Uint16"}]),oa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oa([{type:"Float32",name:"offsetX"}]),oa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Um(M,O,Y){return M.sections.forEach(function(ie){ie.text=function(ye,we,Ce){var je=we.layout.get("text-transform").evaluate(Ce,{});return je==="uppercase"?ye=ye.toLocaleUpperCase():je==="lowercase"&&(ye=ye.toLocaleLowerCase()),yo.applyArabicShaping&&(ye=yo.applyArabicShaping(ye)),ye}(ie.text,O,Y)}),M}var tu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ip=function(M,O,Y,ie,ye){var we,Ce,je=8*ye-ie-1,tt=(1<<je)-1,ft=tt>>1,gt=-7,Bt=Y?ye-1:0,Xt=Y?-1:1,Yt=M[O+Bt];for(Bt+=Xt,we=Yt&(1<<-gt)-1,Yt>>=-gt,gt+=je;gt>0;we=256*we+M[O+Bt],Bt+=Xt,gt-=8);for(Ce=we&(1<<-gt)-1,we>>=-gt,gt+=ie;gt>0;Ce=256*Ce+M[O+Bt],Bt+=Xt,gt-=8);if(we===0)we=1-ft;else{if(we===tt)return Ce?NaN:1/0*(Yt?-1:1);Ce+=Math.pow(2,ie),we-=ft}return(Yt?-1:1)*Ce*Math.pow(2,we-ie)},Op=function(M,O,Y,ie,ye,we){var Ce,je,tt,ft=8*we-ye-1,gt=(1<<ft)-1,Bt=gt>>1,Xt=ye===23?Math.pow(2,-24)-Math.pow(2,-77):0,Yt=ie?0:we-1,sr=ie?1:-1,br=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(je=isNaN(O)?1:0,Ce=gt):(Ce=Math.floor(Math.log(O)/Math.LN2),O*(tt=Math.pow(2,-Ce))<1&&(Ce--,tt*=2),(O+=Ce+Bt>=1?Xt/tt:Xt*Math.pow(2,1-Bt))*tt>=2&&(Ce++,tt/=2),Ce+Bt>=gt?(je=0,Ce=gt):Ce+Bt>=1?(je=(O*tt-1)*Math.pow(2,ye),Ce+=Bt):(je=O*Math.pow(2,Bt-1)*Math.pow(2,ye),Ce=0));ye>=8;M[Y+Yt]=255&je,Yt+=sr,je/=256,ye-=8);for(Ce=Ce<<ye|je,ft+=ye;ft>0;M[Y+Yt]=255&Ce,Yt+=sr,Ce/=256,ft-=8);M[Y+Yt-sr]|=128*br},Eu=_a;function _a(M){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(M)?M:new Uint8Array(M||0),this.pos=0,this.type=0,this.length=this.buf.length}_a.Varint=0,_a.Fixed64=1,_a.Bytes=2,_a.Fixed32=5;var Dp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function yl(M){return M.type===_a.Bytes?M.readVarint()+M.pos:M.pos+1}function gc(M,O,Y){return Y?4294967296*O+(M>>>0):4294967296*(O>>>0)+(M>>>0)}function zp(M,O,Y){var ie=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));Y.realloc(ie);for(var ye=Y.pos-1;ye>=M;ye--)Y.buf[ye+ie]=Y.buf[ye]}function Vm(M,O){for(var Y=0;Y<M.length;Y++)O.writeVarint(M[Y])}function Hm(M,O){for(var Y=0;Y<M.length;Y++)O.writeSVarint(M[Y])}function qm(M,O){for(var Y=0;Y<M.length;Y++)O.writeFloat(M[Y])}function Gm(M,O){for(var Y=0;Y<M.length;Y++)O.writeDouble(M[Y])}function Ym(M,O){for(var Y=0;Y<M.length;Y++)O.writeBoolean(M[Y])}function Wm(M,O){for(var Y=0;Y<M.length;Y++)O.writeFixed32(M[Y])}function Zm(M,O){for(var Y=0;Y<M.length;Y++)O.writeSFixed32(M[Y])}function Xm(M,O){for(var Y=0;Y<M.length;Y++)O.writeFixed64(M[Y])}function Km(M,O){for(var Y=0;Y<M.length;Y++)O.writeSFixed64(M[Y])}function Lu(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+16777216*M[O+3]}function vc(M,O,Y){M[Y]=O,M[Y+1]=O>>>8,M[Y+2]=O>>>16,M[Y+3]=O>>>24}function Rp(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+(M[O+3]<<24)}_a.prototype={destroy:function(){this.buf=null},readFields:function(M,O,Y){for(Y=Y||this.length;this.pos<Y;){var ie=this.readVarint(),ye=ie>>3,we=this.pos;this.type=7&ie,M(ye,O,this),this.pos===we&&this.skip(ie)}return O},readMessage:function(M,O){return this.readFields(M,O,this.readVarint()+this.pos)},readFixed32:function(){var M=Lu(this.buf,this.pos);return this.pos+=4,M},readSFixed32:function(){var M=Rp(this.buf,this.pos);return this.pos+=4,M},readFixed64:function(){var M=Lu(this.buf,this.pos)+4294967296*Lu(this.buf,this.pos+4);return this.pos+=8,M},readSFixed64:function(){var M=Lu(this.buf,this.pos)+4294967296*Rp(this.buf,this.pos+4);return this.pos+=8,M},readFloat:function(){var M=Ip(this.buf,this.pos,!0,23,4);return this.pos+=4,M},readDouble:function(){var M=Ip(this.buf,this.pos,!0,52,8);return this.pos+=8,M},readVarint:function(M){var O,Y,ie=this.buf;return O=127&(Y=ie[this.pos++]),Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<7,Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<14,Y<128?O:(O|=(127&(Y=ie[this.pos++]))<<21,Y<128?O:function(ye,we,Ce){var je,tt,ft=Ce.buf;if(tt=ft[Ce.pos++],je=(112&tt)>>4,tt<128||(tt=ft[Ce.pos++],je|=(127&tt)<<3,tt<128)||(tt=ft[Ce.pos++],je|=(127&tt)<<10,tt<128)||(tt=ft[Ce.pos++],je|=(127&tt)<<17,tt<128)||(tt=ft[Ce.pos++],je|=(127&tt)<<24,tt<128)||(tt=ft[Ce.pos++],je|=(1&tt)<<31,tt<128))return gc(ye,je,we);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(Y=ie[this.pos]))<<28,M,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var M=this.readVarint();return M%2==1?(M+1)/-2:M/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var M=this.readVarint()+this.pos,O=this.pos;return this.pos=M,M-O>=12&&Dp?function(Y,ie,ye){return Dp.decode(Y.subarray(ie,ye))}(this.buf,O,M):function(Y,ie,ye){for(var we="",Ce=ie;Ce<ye;){var je,tt,ft,gt=Y[Ce],Bt=null,Xt=gt>239?4:gt>223?3:gt>191?2:1;if(Ce+Xt>ye)break;Xt===1?gt<128&&(Bt=gt):Xt===2?(192&(je=Y[Ce+1]))==128&&(Bt=(31&gt)<<6|63&je)<=127&&(Bt=null):Xt===3?(je=Y[Ce+1],tt=Y[Ce+2],(192&je)==128&&(192&tt)==128&&((Bt=(15&gt)<<12|(63&je)<<6|63&tt)<=2047||Bt>=55296&&Bt<=57343)&&(Bt=null)):Xt===4&&(je=Y[Ce+1],tt=Y[Ce+2],ft=Y[Ce+3],(192&je)==128&&(192&tt)==128&&(192&ft)==128&&((Bt=(15&gt)<<18|(63&je)<<12|(63&tt)<<6|63&ft)<=65535||Bt>=1114112)&&(Bt=null)),Bt===null?(Bt=65533,Xt=1):Bt>65535&&(Bt-=65536,we+=String.fromCharCode(Bt>>>10&1023|55296),Bt=56320|1023&Bt),we+=String.fromCharCode(Bt),Ce+=Xt}return we}(this.buf,O,M)},readBytes:function(){var M=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,M);return this.pos=M,O},readPackedVarint:function(M,O){if(this.type!==_a.Bytes)return M.push(this.readVarint(O));var Y=yl(this);for(M=M||[];this.pos<Y;)M.push(this.readVarint(O));return M},readPackedSVarint:function(M){if(this.type!==_a.Bytes)return M.push(this.readSVarint());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readSVarint());return M},readPackedBoolean:function(M){if(this.type!==_a.Bytes)return M.push(this.readBoolean());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readBoolean());return M},readPackedFloat:function(M){if(this.type!==_a.Bytes)return M.push(this.readFloat());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readFloat());return M},readPackedDouble:function(M){if(this.type!==_a.Bytes)return M.push(this.readDouble());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readDouble());return M},readPackedFixed32:function(M){if(this.type!==_a.Bytes)return M.push(this.readFixed32());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readFixed32());return M},readPackedSFixed32:function(M){if(this.type!==_a.Bytes)return M.push(this.readSFixed32());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed32());return M},readPackedFixed64:function(M){if(this.type!==_a.Bytes)return M.push(this.readFixed64());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readFixed64());return M},readPackedSFixed64:function(M){if(this.type!==_a.Bytes)return M.push(this.readSFixed64());var O=yl(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed64());return M},skip:function(M){var O=7&M;if(O===_a.Varint)for(;this.buf[this.pos++]>127;);else if(O===_a.Bytes)this.pos=this.readVarint()+this.pos;else if(O===_a.Fixed32)this.pos+=4;else{if(O!==_a.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(M,O){this.writeVarint(M<<3|O)},realloc:function(M){for(var O=this.length||16;O<this.pos+M;)O*=2;if(O!==this.length){var Y=new Uint8Array(O);Y.set(this.buf),this.buf=Y,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(M){this.realloc(4),vc(this.buf,M,this.pos),this.pos+=4},writeSFixed32:function(M){this.realloc(4),vc(this.buf,M,this.pos),this.pos+=4},writeFixed64:function(M){this.realloc(8),vc(this.buf,-1&M,this.pos),vc(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(M){this.realloc(8),vc(this.buf,-1&M,this.pos),vc(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(M){(M=+M||0)>268435455||M<0?function(O,Y){var ie,ye;if(O>=0?(ie=O%4294967296|0,ye=O/4294967296|0):(ye=~(-O/4294967296),4294967295^(ie=~(-O%4294967296))?ie=ie+1|0:(ie=0,ye=ye+1|0)),O>=18446744073709552e3||O<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),function(we,Ce,je){je.buf[je.pos++]=127&we|128,we>>>=7,je.buf[je.pos++]=127&we|128,we>>>=7,je.buf[je.pos++]=127&we|128,we>>>=7,je.buf[je.pos++]=127&we|128,we>>>=7,je.buf[je.pos]=127&we}(ie,0,Y),function(we,Ce){var je=(7&we)<<4;Ce.buf[Ce.pos++]|=je|((we>>>=3)?128:0),we&&(Ce.buf[Ce.pos++]=127&we|((we>>>=7)?128:0),we&&(Ce.buf[Ce.pos++]=127&we|((we>>>=7)?128:0),we&&(Ce.buf[Ce.pos++]=127&we|((we>>>=7)?128:0),we&&(Ce.buf[Ce.pos++]=127&we|((we>>>=7)?128:0),we&&(Ce.buf[Ce.pos++]=127&we)))))}(ye,Y)}(M,this):(this.realloc(4),this.buf[this.pos++]=127&M|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=M>>>7&127))))},writeSVarint:function(M){this.writeVarint(M<0?2*-M-1:2*M)},writeBoolean:function(M){this.writeVarint(Boolean(M))},writeString:function(M){M=String(M),this.realloc(4*M.length),this.pos++;var O=this.pos;this.pos=function(ie,ye,we){for(var Ce,je,tt=0;tt<ye.length;tt++){if((Ce=ye.charCodeAt(tt))>55295&&Ce<57344){if(!je){Ce>56319||tt+1===ye.length?(ie[we++]=239,ie[we++]=191,ie[we++]=189):je=Ce;continue}if(Ce<56320){ie[we++]=239,ie[we++]=191,ie[we++]=189,je=Ce;continue}Ce=je-55296<<10|Ce-56320|65536,je=null}else je&&(ie[we++]=239,ie[we++]=191,ie[we++]=189,je=null);Ce<128?ie[we++]=Ce:(Ce<2048?ie[we++]=Ce>>6|192:(Ce<65536?ie[we++]=Ce>>12|224:(ie[we++]=Ce>>18|240,ie[we++]=Ce>>12&63|128),ie[we++]=Ce>>6&63|128),ie[we++]=63&Ce|128)}return we}(this.buf,M,this.pos);var Y=this.pos-O;Y>=128&&zp(O,Y,this),this.pos=O-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(M){this.realloc(4),Op(this.buf,M,this.pos,!0,23,4),this.pos+=4},writeDouble:function(M){this.realloc(8),Op(this.buf,M,this.pos,!0,52,8),this.pos+=8},writeBytes:function(M){var O=M.length;this.writeVarint(O),this.realloc(O);for(var Y=0;Y<O;Y++)this.buf[this.pos++]=M[Y]},writeRawMessage:function(M,O){this.pos++;var Y=this.pos;M(O,this);var ie=this.pos-Y;ie>=128&&zp(Y,ie,this),this.pos=Y-1,this.writeVarint(ie),this.pos+=ie},writeMessage:function(M,O,Y){this.writeTag(M,_a.Bytes),this.writeRawMessage(O,Y)},writePackedVarint:function(M,O){O.length&&this.writeMessage(M,Vm,O)},writePackedSVarint:function(M,O){O.length&&this.writeMessage(M,Hm,O)},writePackedBoolean:function(M,O){O.length&&this.writeMessage(M,Ym,O)},writePackedFloat:function(M,O){O.length&&this.writeMessage(M,qm,O)},writePackedDouble:function(M,O){O.length&&this.writeMessage(M,Gm,O)},writePackedFixed32:function(M,O){O.length&&this.writeMessage(M,Wm,O)},writePackedSFixed32:function(M,O){O.length&&this.writeMessage(M,Zm,O)},writePackedFixed64:function(M,O){O.length&&this.writeMessage(M,Xm,O)},writePackedSFixed64:function(M,O){O.length&&this.writeMessage(M,Km,O)},writeBytesField:function(M,O){this.writeTag(M,_a.Bytes),this.writeBytes(O)},writeFixed32Field:function(M,O){this.writeTag(M,_a.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(M,O){this.writeTag(M,_a.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(M,O){this.writeTag(M,_a.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(M,O){this.writeTag(M,_a.Fixed64),this.writeSFixed64(O)},writeVarintField:function(M,O){this.writeTag(M,_a.Varint),this.writeVarint(O)},writeSVarintField:function(M,O){this.writeTag(M,_a.Varint),this.writeSVarint(O)},writeStringField:function(M,O){this.writeTag(M,_a.Bytes),this.writeString(O)},writeFloatField:function(M,O){this.writeTag(M,_a.Fixed32),this.writeFloat(O)},writeDoubleField:function(M,O){this.writeTag(M,_a.Fixed64),this.writeDouble(O)},writeBooleanField:function(M,O){this.writeVarintField(M,Boolean(O))}};function Jm(M,O,Y){M===1&&Y.readMessage($m,O)}function $m(M,O,Y){if(M===3){var ie=Y.readMessage(Qm,{}),ye=ie.id,we=ie.bitmap,Ce=ie.width,je=ie.height,tt=ie.left,ft=ie.top,gt=ie.advance;O.push({id:ye,bitmap:new Kl({width:Ce+6,height:je+6},we),metrics:{width:Ce,height:je,left:tt,top:ft,advance:gt}})}}function Qm(M,O,Y){M===1?O.id=Y.readVarint():M===2?O.bitmap=Y.readBytes():M===3?O.width=Y.readVarint():M===4?O.height=Y.readVarint():M===5?O.left=Y.readSVarint():M===6?O.top=Y.readSVarint():M===7&&(O.advance=Y.readVarint())}function Fp(M){for(var O=0,Y=0,ie=0,ye=M;ie<ye.length;ie+=1){var we=ye[ie];O+=we.w*we.h,Y=Math.max(Y,we.w)}M.sort(function(br,Ir){return Ir.h-br.h});for(var Ce=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),Y),h:1/0}],je=0,tt=0,ft=0,gt=M;ft<gt.length;ft+=1)for(var Bt=gt[ft],Xt=Ce.length-1;Xt>=0;Xt--){var Yt=Ce[Xt];if(!(Bt.w>Yt.w||Bt.h>Yt.h)){if(Bt.x=Yt.x,Bt.y=Yt.y,tt=Math.max(tt,Bt.y+Bt.h),je=Math.max(je,Bt.x+Bt.w),Bt.w===Yt.w&&Bt.h===Yt.h){var sr=Ce.pop();Xt<Ce.length&&(Ce[Xt]=sr)}else Bt.h===Yt.h?(Yt.x+=Bt.w,Yt.w-=Bt.w):Bt.w===Yt.w?(Yt.y+=Bt.h,Yt.h-=Bt.h):(Ce.push({x:Yt.x+Bt.w,y:Yt.y,w:Yt.w-Bt.w,h:Bt.h}),Yt.y+=Bt.h,Yt.h-=Bt.h);break}}return{w:je,h:tt,fill:O/(je*tt)||0}}var Cu=function(M,O){var Y=O.pixelRatio,ie=O.version,ye=O.stretchX,we=O.stretchY,Ce=O.content;this.paddedRect=M,this.pixelRatio=Y,this.stretchX=ye,this.stretchY=we,this.content=Ce,this.version=ie},ru={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ru.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ru.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ru.tlbr.get=function(){return this.tl.concat(this.br)},ru.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Cu.prototype,ru);var nu=function(M,O){var Y={},ie={};this.haveRenderCallbacks=[];var ye=[];this.addImages(M,Y,ye),this.addImages(O,ie,ye);var we=Fp(ye),Ce=we.w,je=we.h,tt=new rs({width:Ce||1,height:je||1});for(var ft in M){var gt=M[ft],Bt=Y[ft].paddedRect;rs.copy(gt.data,tt,{x:0,y:0},{x:Bt.x+1,y:Bt.y+1},gt.data)}for(var Xt in O){var Yt=O[Xt],sr=ie[Xt].paddedRect,br=sr.x+1,Ir=sr.y+1,Pr=Yt.data.width,Vr=Yt.data.height;rs.copy(Yt.data,tt,{x:0,y:0},{x:br,y:Ir},Yt.data),rs.copy(Yt.data,tt,{x:0,y:Vr-1},{x:br,y:Ir-1},{width:Pr,height:1}),rs.copy(Yt.data,tt,{x:0,y:0},{x:br,y:Ir+Vr},{width:Pr,height:1}),rs.copy(Yt.data,tt,{x:Pr-1,y:0},{x:br-1,y:Ir},{width:1,height:Vr}),rs.copy(Yt.data,tt,{x:0,y:0},{x:br+Pr,y:Ir},{width:1,height:Vr})}this.image=tt,this.iconPositions=Y,this.patternPositions=ie};nu.prototype.addImages=function(M,O,Y){for(var ie in M){var ye=M[ie],we={x:0,y:0,w:ye.data.width+2,h:ye.data.height+2};Y.push(we),O[ie]=new Cu(we,ye),ye.hasRenderCallback&&this.haveRenderCallbacks.push(ie)}},nu.prototype.patchUpdatedImages=function(M,O){for(var Y in M.dispatchRenderCallbacks(this.haveRenderCallbacks),M.updatedImages)this.patchUpdatedImage(this.iconPositions[Y],M.getImage(Y),O),this.patchUpdatedImage(this.patternPositions[Y],M.getImage(Y),O)},nu.prototype.patchUpdatedImage=function(M,O,Y){if(M&&O&&M.version!==O.version){M.version=O.version;var ie=M.tl,ye=ie[0],we=ie[1];Y.update(O.data,void 0,{x:ye,y:we})}},Kr("ImagePosition",Cu),Kr("ImageAtlas",nu);var bs={horizontal:1,vertical:2,horizontalOnly:3},yc=function(){this.scale=1,this.fontStack="",this.imageName=null};yc.forText=function(M,O){var Y=new yc;return Y.scale=M||1,Y.fontStack=O,Y},yc.forImage=function(M){var O=new yc;return O.imageName=M,O};var Ho=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Pu(M,O,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br){var Ir,Pr=Ho.fromFeature(M,ye);Bt===bs.vertical&&Pr.verticalizePunctuation();var Vr=yo.processBidirectionalText,Hr=yo.processStyledBidirectionalText;if(Vr&&Pr.sections.length===1){Ir=[];for(var Zr=0,pn=Vr(Pr.toString(),Zf(Pr,ft,we,O,ie,Yt,sr));Zr<pn.length;Zr+=1){var bn=pn[Zr],jn=new Ho;jn.text=bn,jn.sections=Pr.sections;for(var Nn=0;Nn<bn.length;Nn++)jn.sectionIndex.push(0);Ir.push(jn)}}else if(Hr){Ir=[];for(var Wn=0,li=Hr(Pr.text,Pr.sectionIndex,Zf(Pr,ft,we,O,ie,Yt,sr));Wn<li.length;Wn+=1){var ci=li[Wn],$n=new Ho;$n.text=ci[0],$n.sectionIndex=ci[1],$n.sections=Pr.sections,Ir.push($n)}}else Ir=function(ui,Qi){for(var qi=[],na=ui.text,Ti=0,Yi=0,wa=Qi;Yi<wa.length;Yi+=1){var ma=wa[Yi];qi.push(ui.substring(Ti,ma)),Ti=ma}return Ti<na.length&&qi.push(ui.substring(Ti,na.length)),qi}(Pr,Zf(Pr,ft,we,O,ie,Yt,sr));var mi=[],pi={positionedLines:mi,text:Pr.toString(),top:gt[1],bottom:gt[1],left:gt[0],right:gt[0],writingMode:Bt,iconsInText:!1,verticalizable:!1};return function(ui,Qi,qi,na,Ti,Yi,wa,ma,Pa,ga,ho,Ia){for(var jo=0,Eo=-17,Po=0,Jo=0,qo=ma==="right"?1:ma==="left"?0:.5,po=0,Io=0,eo=Ti;Io<eo.length;Io+=1){var xo=eo[Io];xo.trim();var Bi=xo.getMaxScale(),ea=24*(Bi-1),Ga={positionedGlyphs:[],lineOffset:0};ui.positionedLines[po]=Ga;var Ya=Ga.positionedGlyphs,Ua=0;if(xo.length()){for(var Oa=0;Oa<xo.length();Oa++){var sa=xo.getSection(Oa),Wa=xo.getSectionIndex(Oa),$o=xo.getCharCode(Oa),ds=0,Go=null,Ys=null,_l=null,Lo=24,Ws=!(Pa===bs.horizontal||!ho&&!gi($o)||ho&&(Iu[$o]||(Dl=$o,Ln.Arabic(Dl)||Ln["Arabic Supplement"](Dl)||Ln["Arabic Extended-A"](Dl)||Ln["Arabic Presentation Forms-A"](Dl)||Ln["Arabic Presentation Forms-B"](Dl))));if(sa.imageName){var Zs=na[sa.imageName];if(!Zs)continue;_l=sa.imageName,ui.iconsInText=ui.iconsInText||!0,Ys=Zs.paddedRect;var Xs=Zs.displaySize;sa.scale=24*sa.scale/Ia,Go={width:Xs[0],height:Xs[1],left:1,top:-3,advance:Ws?Xs[1]:Xs[0]};var ih=24-Xs[1]*sa.scale;ds=ea+ih,Lo=Go.advance;var Ac=Ws?Xs[0]*sa.scale-24*Bi:Xs[1]*sa.scale-24*Bi;Ac>0&&Ac>Ua&&(Ua=Ac)}else{var Uu=qi[sa.fontStack],ec=Uu&&Uu[$o];if(ec&&ec.rect)Ys=ec.rect,Go=ec.metrics;else{var Vu=Qi[sa.fontStack],Hu=Vu&&Vu[$o];if(!Hu)continue;Go=Hu.metrics}ds=24*(Bi-sa.scale)}Ws?(ui.verticalizable=!0,Ya.push({glyph:$o,imageName:_l,x:jo,y:Eo+ds,vertical:Ws,scale:sa.scale,fontStack:sa.fontStack,sectionIndex:Wa,metrics:Go,rect:Ys}),jo+=Lo*sa.scale+ga):(Ya.push({glyph:$o,imageName:_l,x:jo,y:Eo+ds,vertical:Ws,scale:sa.scale,fontStack:sa.fontStack,sectionIndex:Wa,metrics:Go,rect:Ys}),jo+=Go.advance*sa.scale+ga)}if(Ya.length!==0){var qu=jo-ga;Po=Math.max(qu,Po),tg(Ya,0,Ya.length-1,qo,Ua)}jo=0;var Gu=Yi*Bi+Ua;Ga.lineOffset=Math.max(Ua,ea),Eo+=Gu,Jo=Math.max(Gu,Jo),++po}else Eo+=Yi,++po}var Dl,Sc=Eo- -17,Yu=Xf(wa),Ec=Yu.horizontalAlign,zl=Yu.verticalAlign;(function(ou,Wu,Zu,Xu,su,Ku,lu,Ju,cu){var $u=(Wu-Zu)*su,Lc=0;Lc=Ku!==lu?-Ju*Xu- -17:(-Xu*cu+.5)*lu;for(var Cc=0,Pc=ou;Cc<Pc.length;Cc+=1)for(var Qu=Pc[Cc],Ic=0,uu=Qu.positionedGlyphs;Ic<uu.length;Ic+=1){var Oc=uu[Ic];Oc.x+=$u,Oc.y+=Lc}})(ui.positionedLines,qo,Ec,zl,Po,Jo,Yi,Sc,Ti.length),ui.top+=-zl*Sc,ui.bottom=ui.top+Sc,ui.left+=-Ec*Po,ui.right=ui.left+Po}(pi,O,Y,ie,Ir,Ce,je,tt,Bt,ft,Xt,br),!function(ui){for(var Qi=0,qi=ui;Qi<qi.length;Qi+=1)if(qi[Qi].positionedGlyphs.length!==0)return!1;return!0}(mi)&&pi}Ho.fromFeature=function(M,O){for(var Y=new Ho,ie=0;ie<M.sections.length;ie++){var ye=M.sections[ie];ye.image?Y.addImageSection(ye):Y.addTextSection(ye,O)}return Y},Ho.prototype.length=function(){return this.text.length},Ho.prototype.getSection=function(M){return this.sections[this.sectionIndex[M]]},Ho.prototype.getSectionIndex=function(M){return this.sectionIndex[M]},Ho.prototype.getCharCode=function(M){return this.text.charCodeAt(M)},Ho.prototype.verticalizePunctuation=function(){this.text=function(M){for(var O="",Y=0;Y<M.length;Y++){var ie=M.charCodeAt(Y+1)||null,ye=M.charCodeAt(Y-1)||null;(!ie||!Fi(ie)||tu[M[Y+1]])&&(!ye||!Fi(ye)||tu[M[Y-1]])&&tu[M[Y]]?O+=tu[M[Y]]:O+=M[Y]}return O}(this.text)},Ho.prototype.trim=function(){for(var M=0,O=0;O<this.text.length&&Iu[this.text.charCodeAt(O)];O++)M++;for(var Y=this.text.length,ie=this.text.length-1;ie>=0&&ie>=M&&Iu[this.text.charCodeAt(ie)];ie--)Y--;this.text=this.text.substring(M,Y),this.sectionIndex=this.sectionIndex.slice(M,Y)},Ho.prototype.substring=function(M,O){var Y=new Ho;return Y.text=this.text.substring(M,O),Y.sectionIndex=this.sectionIndex.slice(M,O),Y.sections=this.sections,Y},Ho.prototype.toString=function(){return this.text},Ho.prototype.getMaxScale=function(){var M=this;return this.sectionIndex.reduce(function(O,Y){return Math.max(O,M.sections[Y].scale)},0)},Ho.prototype.addTextSection=function(M,O){this.text+=M.text,this.sections.push(yc.forText(M.scale,M.fontStack||O));for(var Y=this.sections.length-1,ie=0;ie<M.text.length;++ie)this.sectionIndex.push(Y)},Ho.prototype.addImageSection=function(M){var O=M.image?M.image.name:"";if(O.length!==0){var Y=this.getNextImageSectionCharCode();Y?(this.text+=String.fromCharCode(Y),this.sections.push(yc.forImage(O)),this.sectionIndex.push(this.sections.length-1)):A("Reached maximum number of images 6401")}else A("Can't add FormattedSection with an empty image.")},Ho.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Iu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ps={};function Bp(M,O,Y,ie,ye,we){if(O.imageName){var Ce=ie[O.imageName];return Ce?Ce.displaySize[0]*O.scale*24/we+ye:0}var je=Y[O.fontStack],tt=je&&je[M];return tt?tt.metrics.advance*O.scale+ye:0}function Np(M,O,Y,ie){var ye=Math.pow(M-O,2);return ie?M<O?ye/2:2*ye:ye+Math.abs(Y)*Y}function eg(M,O,Y){var ie=0;return M===10&&(ie-=1e4),Y&&(ie+=150),M!==40&&M!==65288||(ie+=50),O!==41&&O!==65289||(ie+=50),ie}function jp(M,O,Y,ie,ye,we){for(var Ce=null,je=Np(O,Y,ye,we),tt=0,ft=ie;tt<ft.length;tt+=1){var gt=ft[tt],Bt=Np(O-gt.x,Y,ye,we)+gt.badness;Bt<=je&&(Ce=gt,je=Bt)}return{index:M,x:O,priorBreak:Ce,badness:je}}function Zf(M,O,Y,ie,ye,we,Ce){if(we!=="point")return[];if(!M)return[];for(var je,tt=[],ft=function(Ir,Pr,Vr,Hr,Zr,pn){for(var bn=0,jn=0;jn<Ir.length();jn++){var Nn=Ir.getSection(jn);bn+=Bp(Ir.getCharCode(jn),Nn,Hr,Zr,Pr,pn)}return bn/Math.max(1,Math.ceil(bn/Vr))}(M,O,Y,ie,ye,Ce),gt=M.text.indexOf("\u200B")>=0,Bt=0,Xt=0;Xt<M.length();Xt++){var Yt=M.getSection(Xt),sr=M.getCharCode(Xt);if(Iu[sr]||(Bt+=Bp(sr,Yt,ie,ye,O,Ce)),Xt<M.length()-1){var br=!!(!((je=sr)<11904)&&(Ln["Bopomofo Extended"](je)||Ln.Bopomofo(je)||Ln["CJK Compatibility Forms"](je)||Ln["CJK Compatibility Ideographs"](je)||Ln["CJK Compatibility"](je)||Ln["CJK Radicals Supplement"](je)||Ln["CJK Strokes"](je)||Ln["CJK Symbols and Punctuation"](je)||Ln["CJK Unified Ideographs Extension A"](je)||Ln["CJK Unified Ideographs"](je)||Ln["Enclosed CJK Letters and Months"](je)||Ln["Halfwidth and Fullwidth Forms"](je)||Ln.Hiragana(je)||Ln["Ideographic Description Characters"](je)||Ln["Kangxi Radicals"](je)||Ln["Katakana Phonetic Extensions"](je)||Ln.Katakana(je)||Ln["Vertical Forms"](je)||Ln["Yi Radicals"](je)||Ln["Yi Syllables"](je)));(ps[sr]||br||Yt.imageName)&&tt.push(jp(Xt+1,Bt,ft,tt,eg(sr,M.getCharCode(Xt+1),br&&gt),!1))}}return function Ir(Pr){return Pr?Ir(Pr.priorBreak).concat(Pr.index):[]}(jp(M.length(),Bt,ft,tt,0,!0))}function Xf(M){var O=.5,Y=.5;switch(M){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(M){case"bottom":case"bottom-right":case"bottom-left":Y=1;break;case"top":case"top-right":case"top-left":Y=0}return{horizontalAlign:O,verticalAlign:Y}}function tg(M,O,Y,ie,ye){if(ie||ye)for(var we=M[Y],Ce=we.metrics.advance*we.scale,je=(M[Y].x+Ce)*ie,tt=O;tt<=Y;tt++)M[tt].x-=je,M[tt].y+=ye}function Up(M,O,Y,ie,ye,we){var Ce,je=M.image;if(je.content){var tt=je.content,ft=je.pixelRatio||1;Ce=[tt[0]/ft,tt[1]/ft,je.displaySize[0]-tt[2]/ft,je.displaySize[1]-tt[3]/ft]}var gt,Bt,Xt,Yt,sr=O.left*we,br=O.right*we;Y==="width"||Y==="both"?(Yt=ye[0]+sr-ie[3],Bt=ye[0]+br+ie[1]):Bt=(Yt=ye[0]+(sr+br-je.displaySize[0])/2)+je.displaySize[0];var Ir=O.top*we,Pr=O.bottom*we;return Y==="height"||Y==="both"?(gt=ye[1]+Ir-ie[0],Xt=ye[1]+Pr+ie[2]):Xt=(gt=ye[1]+(Ir+Pr-je.displaySize[1])/2)+je.displaySize[1],{image:je,top:gt,right:Bt,bottom:Xt,left:Yt,collisionPadding:Ce}}ps[10]=!0,ps[32]=!0,ps[38]=!0,ps[40]=!0,ps[41]=!0,ps[43]=!0,ps[45]=!0,ps[47]=!0,ps[173]=!0,ps[183]=!0,ps[8203]=!0,ps[8208]=!0,ps[8211]=!0,ps[8231]=!0;var xc=function(M){function O(Y,ie,ye,we){M.call(this,Y,ie),this.angle=ye,we!==void 0&&(this.segment=we)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(r);Kr("Anchor",xc);function Kf(M,O){var Y=O.expression;if(Y.kind==="constant")return{kind:"constant",layoutSize:Y.evaluate(new aa(M+1))};if(Y.kind==="source")return{kind:"source"};for(var ie=Y.zoomStops,ye=Y.interpolationType,we=0;we<ie.length&&ie[we]<=M;)we++;for(var Ce=we=Math.max(0,we-1);Ce<ie.length&&ie[Ce]<M+1;)Ce++;Ce=Math.min(ie.length-1,Ce);var je=ie[we],tt=ie[Ce];return Y.kind==="composite"?{kind:"composite",minZoom:je,maxZoom:tt,interpolationType:ye}:{kind:"camera",minZoom:je,maxZoom:tt,minSize:Y.evaluate(new aa(je)),maxSize:Y.evaluate(new aa(tt)),interpolationType:ye}}function Vp(M,O,Y){var ie=O.uSize,ye=O.uSizeT,we=Y.lowerSize,Ce=Y.upperSize;return M.kind==="source"?we/128:M.kind==="composite"?kn(we/128,Ce/128,ye):ie}function Hp(M,O){var Y=0,ie=0;if(M.kind==="constant")ie=M.layoutSize;else if(M.kind!=="source"){var ye=M.interpolationType,we=M.minZoom,Ce=M.maxZoom,je=ye?h(Ni.interpolationFactor(ye,O,we,Ce),0,1):0;M.kind==="camera"?ie=kn(M.minSize,M.maxSize,je):Y=je}return{uSizeT:Y,uSize:ie}}var rg=Object.freeze({__proto__:null,getSizeData:Kf,evaluateSizeForFeature:Vp,evaluateSizeForZoom:Hp,SIZE_PACK_FACTOR:128});function qp(M,O,Y,ie,ye){if(O.segment===void 0)return!0;for(var we=O,Ce=O.segment+1,je=0;je>-Y/2;){if(--Ce<0)return!1;je-=M[Ce].dist(we),we=M[Ce]}je+=M[Ce].dist(M[Ce+1]),Ce++;for(var tt=[],ft=0;je<Y/2;){var gt=M[Ce-1],Bt=M[Ce],Xt=M[Ce+1];if(!Xt)return!1;var Yt=gt.angleTo(Bt)-Bt.angleTo(Xt);for(Yt=Math.abs((Yt+3*Math.PI)%(2*Math.PI)-Math.PI),tt.push({distance:je,angleDelta:Yt}),ft+=Yt;je-tt[0].distance>ie;)ft-=tt.shift().angleDelta;if(ft>ye)return!1;Ce++,je+=Bt.dist(Xt)}return!0}function Gp(M){for(var O=0,Y=0;Y<M.length-1;Y++)O+=M[Y].dist(M[Y+1]);return O}function Yp(M,O,Y){return M?.6*O*Y:0}function Wp(M,O){return Math.max(M?M.right-M.left:0,O?O.right-O.left:0)}function ng(M,O,Y,ie,ye,we){for(var Ce=Yp(Y,ye,we),je=Wp(Y,ie)*we,tt=0,ft=Gp(M)/2,gt=0;gt<M.length-1;gt++){var Bt=M[gt],Xt=M[gt+1],Yt=Bt.dist(Xt);if(tt+Yt>ft){var sr=(ft-tt)/Yt,br=kn(Bt.x,Xt.x,sr),Ir=kn(Bt.y,Xt.y,sr),Pr=new xc(br,Ir,Xt.angleTo(Bt),gt);return Pr._round(),!Ce||qp(M,Pr,je,Ce,O)?Pr:void 0}tt+=Yt}}function ig(M,O,Y,ie,ye,we,Ce,je,tt){var ft=Yp(ie,we,Ce),gt=Wp(ie,ye),Bt=gt*Ce,Xt=M[0].x===0||M[0].x===tt||M[0].y===0||M[0].y===tt;return O-Bt<O/4&&(O=Bt+O/4),function Yt(sr,br,Ir,Pr,Vr,Hr,Zr,pn,bn){for(var jn=Hr/2,Nn=Gp(sr),Wn=0,li=br-Ir,ci=[],$n=0;$n<sr.length-1;$n++){for(var mi=sr[$n],pi=sr[$n+1],ui=mi.dist(pi),Qi=pi.angleTo(mi);li+Ir<Wn+ui;){var qi=((li+=Ir)-Wn)/ui,na=kn(mi.x,pi.x,qi),Ti=kn(mi.y,pi.y,qi);if(na>=0&&na<bn&&Ti>=0&&Ti<bn&&li-jn>=0&&li+jn<=Nn){var Yi=new xc(na,Ti,Qi,$n);Yi._round(),Pr&&!qp(sr,Yi,Hr,Pr,Vr)||ci.push(Yi)}}Wn+=ui}return pn||ci.length||Zr||(ci=Yt(sr,Wn/2,Ir,Pr,Vr,Hr,Zr,!0,bn)),ci}(M,Xt?O/2*je%O:(gt/2+2*we)*Ce*je%O,O,ft,Y,Bt,Xt,!1,tt)}function Zp(M,O,Y,ie,ye){for(var we=[],Ce=0;Ce<M.length;Ce++)for(var je=M[Ce],tt=void 0,ft=0;ft<je.length-1;ft++){var gt=je[ft],Bt=je[ft+1];gt.x<O&&Bt.x<O||(gt.x<O?gt=new r(O,gt.y+(Bt.y-gt.y)*((O-gt.x)/(Bt.x-gt.x)))._round():Bt.x<O&&(Bt=new r(O,gt.y+(Bt.y-gt.y)*((O-gt.x)/(Bt.x-gt.x)))._round()),gt.y<Y&&Bt.y<Y||(gt.y<Y?gt=new r(gt.x+(Bt.x-gt.x)*((Y-gt.y)/(Bt.y-gt.y)),Y)._round():Bt.y<Y&&(Bt=new r(gt.x+(Bt.x-gt.x)*((Y-gt.y)/(Bt.y-gt.y)),Y)._round()),gt.x>=ie&&Bt.x>=ie||(gt.x>=ie?gt=new r(ie,gt.y+(Bt.y-gt.y)*((ie-gt.x)/(Bt.x-gt.x)))._round():Bt.x>=ie&&(Bt=new r(ie,gt.y+(Bt.y-gt.y)*((ie-gt.x)/(Bt.x-gt.x)))._round()),gt.y>=ye&&Bt.y>=ye||(gt.y>=ye?gt=new r(gt.x+(Bt.x-gt.x)*((ye-gt.y)/(Bt.y-gt.y)),ye)._round():Bt.y>=ye&&(Bt=new r(gt.x+(Bt.x-gt.x)*((ye-gt.y)/(Bt.y-gt.y)),ye)._round()),tt&&gt.equals(tt[tt.length-1])||(tt=[gt],we.push(tt)),tt.push(Bt)))))}return we}function Xp(M,O,Y,ie){var ye=[],we=M.image,Ce=we.pixelRatio,je=we.paddedRect.w-2,tt=we.paddedRect.h-2,ft=M.right-M.left,gt=M.bottom-M.top,Bt=we.stretchX||[[0,je]],Xt=we.stretchY||[[0,tt]],Yt=function(Yi,wa){return Yi+wa[1]-wa[0]},sr=Bt.reduce(Yt,0),br=Xt.reduce(Yt,0),Ir=je-sr,Pr=tt-br,Vr=0,Hr=sr,Zr=0,pn=br,bn=0,jn=Ir,Nn=0,Wn=Pr;if(we.content&&ie){var li=we.content;Vr=Ou(Bt,0,li[0]),Zr=Ou(Xt,0,li[1]),Hr=Ou(Bt,li[0],li[2]),pn=Ou(Xt,li[1],li[3]),bn=li[0]-Vr,Nn=li[1]-Zr,jn=li[2]-li[0]-Hr,Wn=li[3]-li[1]-pn}var ci=function(Yi,wa,ma,Pa){var ga=Du(Yi.stretch-Vr,Hr,ft,M.left),ho=zu(Yi.fixed-bn,jn,Yi.stretch,sr),Ia=Du(wa.stretch-Zr,pn,gt,M.top),jo=zu(wa.fixed-Nn,Wn,wa.stretch,br),Eo=Du(ma.stretch-Vr,Hr,ft,M.left),Po=zu(ma.fixed-bn,jn,ma.stretch,sr),Jo=Du(Pa.stretch-Zr,pn,gt,M.top),qo=zu(Pa.fixed-Nn,Wn,Pa.stretch,br),po=new r(ga,Ia),Io=new r(Eo,Ia),eo=new r(Eo,Jo),xo=new r(ga,Jo),Bi=new r(ho/Ce,jo/Ce),ea=new r(Po/Ce,qo/Ce),Ga=O*Math.PI/180;if(Ga){var Ya=Math.sin(Ga),Ua=Math.cos(Ga),Oa=[Ua,-Ya,Ya,Ua];po._matMult(Oa),Io._matMult(Oa),xo._matMult(Oa),eo._matMult(Oa)}var sa=Yi.stretch+Yi.fixed,Wa=ma.stretch+ma.fixed,$o=wa.stretch+wa.fixed,ds=Pa.stretch+Pa.fixed;return{tl:po,tr:Io,bl:xo,br:eo,tex:{x:we.paddedRect.x+1+sa,y:we.paddedRect.y+1+$o,w:Wa-sa,h:ds-$o},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Bi,pixelOffsetBR:ea,minFontScaleX:jn/Ce/ft,minFontScaleY:Wn/Ce/gt,isSDF:Y}};if(ie&&(we.stretchX||we.stretchY))for(var $n=Kp(Bt,Ir,sr),mi=Kp(Xt,Pr,br),pi=0;pi<$n.length-1;pi++)for(var ui=$n[pi],Qi=$n[pi+1],qi=0;qi<mi.length-1;qi++){var na=mi[qi],Ti=mi[qi+1];ye.push(ci(ui,na,Qi,Ti))}else ye.push(ci({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:je+1},{fixed:0,stretch:tt+1}));return ye}function Ou(M,O,Y){for(var ie=0,ye=0,we=M;ye<we.length;ye+=1){var Ce=we[ye];ie+=Math.max(O,Math.min(Y,Ce[1]))-Math.max(O,Math.min(Y,Ce[0]))}return ie}function Kp(M,O,Y){for(var ie=[{fixed:-1,stretch:0}],ye=0,we=M;ye<we.length;ye+=1){var Ce=we[ye],je=Ce[0],tt=Ce[1],ft=ie[ie.length-1];ie.push({fixed:je-ft.stretch,stretch:ft.stretch}),ie.push({fixed:je-ft.stretch,stretch:ft.stretch+(tt-je)})}return ie.push({fixed:O+1,stretch:Y}),ie}function Du(M,O,Y,ie){return M/O*Y+ie}function zu(M,O,Y,ie){return M-O*Y/ie}var Ru=function(M,O,Y,ie,ye,we,Ce,je,tt,ft){if(this.boxStartIndex=M.length,tt){var gt=we.top,Bt=we.bottom,Xt=we.collisionPadding;Xt&&(gt-=Xt[1],Bt+=Xt[3]);var Yt=Bt-gt;Yt>0&&(Yt=Math.max(10,Yt),this.circleDiameter=Yt)}else{var sr=we.top*Ce-je,br=we.bottom*Ce+je,Ir=we.left*Ce-je,Pr=we.right*Ce+je,Vr=we.collisionPadding;if(Vr&&(Ir-=Vr[0]*Ce,sr-=Vr[1]*Ce,Pr+=Vr[2]*Ce,br+=Vr[3]*Ce),ft){var Hr=new r(Ir,sr),Zr=new r(Pr,sr),pn=new r(Ir,br),bn=new r(Pr,br),jn=ft*Math.PI/180;Hr._rotate(jn),Zr._rotate(jn),pn._rotate(jn),bn._rotate(jn),Ir=Math.min(Hr.x,Zr.x,pn.x,bn.x),Pr=Math.max(Hr.x,Zr.x,pn.x,bn.x),sr=Math.min(Hr.y,Zr.y,pn.y,bn.y),br=Math.max(Hr.y,Zr.y,pn.y,bn.y)}M.emplaceBack(O.x,O.y,Ir,sr,Pr,br,Y,ie,ye)}this.boxEndIndex=M.length},bc=function(M,O){if(M===void 0&&(M=[]),O===void 0&&(O=ag),this.data=M,this.length=this.data.length,this.compare=O,this.length>0)for(var Y=(this.length>>1)-1;Y>=0;Y--)this._down(Y)};function ag(M,O){return M<O?-1:M>O?1:0}function og(M,O,Y){O===void 0&&(O=1),Y===void 0&&(Y=!1);for(var ie=1/0,ye=1/0,we=-1/0,Ce=-1/0,je=M[0],tt=0;tt<je.length;tt++){var ft=je[tt];(!tt||ft.x<ie)&&(ie=ft.x),(!tt||ft.y<ye)&&(ye=ft.y),(!tt||ft.x>we)&&(we=ft.x),(!tt||ft.y>Ce)&&(Ce=ft.y)}var gt=we-ie,Bt=Ce-ye,Xt=Math.min(gt,Bt),Yt=Xt/2,sr=new bc([],sg);if(Xt===0)return new r(ie,ye);for(var br=ie;br<we;br+=Xt)for(var Ir=ye;Ir<Ce;Ir+=Xt)sr.push(new _c(br+Yt,Ir+Yt,Yt,M));for(var Pr=function(Zr){for(var pn=0,bn=0,jn=0,Nn=Zr[0],Wn=0,li=Nn.length,ci=li-1;Wn<li;ci=Wn++){var $n=Nn[Wn],mi=Nn[ci],pi=$n.x*mi.y-mi.x*$n.y;bn+=($n.x+mi.x)*pi,jn+=($n.y+mi.y)*pi,pn+=3*pi}return new _c(bn/pn,jn/pn,0,Zr)}(M),Vr=sr.length;sr.length;){var Hr=sr.pop();(Hr.d>Pr.d||!Pr.d)&&(Pr=Hr,Y&&console.log("found best %d after %d probes",Math.round(1e4*Hr.d)/1e4,Vr)),Hr.max-Pr.d<=O||(Yt=Hr.h/2,sr.push(new _c(Hr.p.x-Yt,Hr.p.y-Yt,Yt,M)),sr.push(new _c(Hr.p.x+Yt,Hr.p.y-Yt,Yt,M)),sr.push(new _c(Hr.p.x-Yt,Hr.p.y+Yt,Yt,M)),sr.push(new _c(Hr.p.x+Yt,Hr.p.y+Yt,Yt,M)),Vr+=4)}return Y&&(console.log("num probes: "+Vr),console.log("best distance: "+Pr.d)),Pr.p}function sg(M,O){return O.max-M.max}function _c(M,O,Y,ie){this.p=new r(M,O),this.h=Y,this.d=function(ye,we){for(var Ce=!1,je=1/0,tt=0;tt<we.length;tt++)for(var ft=we[tt],gt=0,Bt=ft.length,Xt=Bt-1;gt<Bt;Xt=gt++){var Yt=ft[gt],sr=ft[Xt];Yt.y>ye.y!=sr.y>ye.y&&ye.x<(sr.x-Yt.x)*(ye.y-Yt.y)/(sr.y-Yt.y)+Yt.x&&(Ce=!Ce),je=Math.min(je,ml(ye,Yt,sr))}return(Ce?1:-1)*Math.sqrt(je)}(this.p,ie),this.max=this.d+this.h*Math.SQRT2}bc.prototype.push=function(M){this.data.push(M),this.length++,this._up(this.length-1)},bc.prototype.pop=function(){if(this.length!==0){var M=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),M}},bc.prototype.peek=function(){return this.data[0]},bc.prototype._up=function(M){for(var O=this.data,Y=this.compare,ie=O[M];M>0;){var ye=M-1>>1,we=O[ye];if(Y(ie,we)>=0)break;O[M]=we,M=ye}O[M]=ie},bc.prototype._down=function(M){for(var O=this.data,Y=this.compare,ie=this.length>>1,ye=O[M];M<ie;){var we=1+(M<<1),Ce=O[we],je=we+1;if(je<this.length&&Y(O[je],Ce)<0&&(we=je,Ce=O[je]),Y(Ce,ye)>=0)break;O[M]=Ce,M=we}O[M]=ye};var Jf=Number.POSITIVE_INFINITY;function Jp(M,O){return O[1]!==Jf?function(Y,ie,ye){var we=0,Ce=0;switch(ie=Math.abs(ie),ye=Math.abs(ye),Y){case"top-right":case"top-left":case"top":Ce=ye-7;break;case"bottom-right":case"bottom-left":case"bottom":Ce=7-ye}switch(Y){case"top-right":case"bottom-right":case"right":we=-ie;break;case"top-left":case"bottom-left":case"left":we=ie}return[we,Ce]}(M,O[0],O[1]):function(Y,ie){var ye=0,we=0;ie<0&&(ie=0);var Ce=ie/Math.sqrt(2);switch(Y){case"top-right":case"top-left":we=Ce-7;break;case"bottom-right":case"bottom-left":we=7-Ce;break;case"bottom":we=7-ie;break;case"top":we=ie-7}switch(Y){case"top-right":case"bottom-right":ye=-Ce;break;case"top-left":case"bottom-left":ye=Ce;break;case"left":ye=ie;break;case"right":ye=-ie}return[ye,we]}(M,O[0])}function $f(M){switch(M){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $p(M,O,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr){var br=function(Zr,pn,bn,jn,Nn,Wn,li,ci){for(var $n=jn.layout.get("text-rotate").evaluate(Wn,{})*Math.PI/180,mi=[],pi=0,ui=pn.positionedLines;pi<ui.length;pi+=1)for(var Qi=ui[pi],qi=0,na=Qi.positionedGlyphs;qi<na.length;qi+=1){var Ti=na[qi];if(Ti.rect){var Yi=Ti.rect||{},wa=4,ma=!0,Pa=1,ga=0,ho=(Nn||ci)&&Ti.vertical,Ia=Ti.metrics.advance*Ti.scale/2;if(ci&&pn.verticalizable){var jo=24*(Ti.scale-1),Eo=(24-Ti.metrics.width*Ti.scale)/2;ga=Qi.lineOffset/2-(Ti.imageName?-Eo:jo)}if(Ti.imageName){var Po=li[Ti.imageName];ma=Po.sdf,wa=1/(Pa=Po.pixelRatio)}var Jo=Nn?[Ti.x+Ia,Ti.y]:[0,0],qo=Nn?[0,0]:[Ti.x+Ia+bn[0],Ti.y+bn[1]-ga],po=[0,0];ho&&(po=qo,qo=[0,0]);var Io=(Ti.metrics.left-wa)*Ti.scale-Ia+qo[0],eo=(-Ti.metrics.top-wa)*Ti.scale+qo[1],xo=Io+Yi.w*Ti.scale/Pa,Bi=eo+Yi.h*Ti.scale/Pa,ea=new r(Io,eo),Ga=new r(xo,eo),Ya=new r(Io,Bi),Ua=new r(xo,Bi);if(ho){var Oa=new r(-Ia,Ia- -17),sa=-Math.PI/2,Wa=12-Ia,$o=Ti.imageName?Wa:0,ds=new r(22-Wa,-$o),Go=new(Function.prototype.bind.apply(r,[null].concat(po)));ea._rotateAround(sa,Oa)._add(ds)._add(Go),Ga._rotateAround(sa,Oa)._add(ds)._add(Go),Ya._rotateAround(sa,Oa)._add(ds)._add(Go),Ua._rotateAround(sa,Oa)._add(ds)._add(Go)}if($n){var Ys=Math.sin($n),_l=Math.cos($n),Lo=[_l,-Ys,Ys,_l];ea._matMult(Lo),Ga._matMult(Lo),Ya._matMult(Lo),Ua._matMult(Lo)}var Ws=new r(0,0),Zs=new r(0,0);mi.push({tl:ea,tr:Ga,bl:Ya,br:Ua,tex:Yi,writingMode:pn.writingMode,glyphOffset:Jo,sectionIndex:Ti.sectionIndex,isSDF:ma,pixelOffsetTL:Ws,pixelOffsetBR:Zs,minFontScaleX:0,minFontScaleY:0})}}return mi}(0,Y,je,ye,we,Ce,ie,M.allowVerticalPlacement),Ir=M.textSizeData,Pr=null;Ir.kind==="source"?(Pr=[128*ye.layout.get("text-size").evaluate(Ce,{})])[0]>32640&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Ir.kind==="composite"&&((Pr=[128*Yt.compositeTextSizes[0].evaluate(Ce,{},sr),128*Yt.compositeTextSizes[1].evaluate(Ce,{},sr)])[0]>32640||Pr[1]>32640)&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),M.addSymbols(M.text,br,Pr,je,we,Ce,ft,O,tt.lineStartIndex,tt.lineLength,Xt,sr);for(var Vr=0,Hr=gt;Vr<Hr.length;Vr+=1)Bt[Hr[Vr]]=M.text.placedSymbolArray.length-1;return 4*br.length}function Qp(M){for(var O in M)return M[O];return null}function lg(M,O,Y,ie){var ye=M.compareText;if(O in ye){for(var we=ye[O],Ce=we.length-1;Ce>=0;Ce--)if(ie.dist(we[Ce])<Y)return!0}else ye[O]=[];return ye[O].push(ie),!1}var cg=mc.VectorTileFeature.types,ug=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fu(M,O,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt){var Yt=je?Math.min(32640,Math.round(je[0])):0,sr=je?Math.min(32640,Math.round(je[1])):0;M.emplaceBack(O,Y,Math.round(32*ie),Math.round(32*ye),we,Ce,(Yt<<1)+(tt?1:0),sr,16*ft,16*gt,256*Bt,256*Xt)}function Qf(M,O,Y){M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y)}function fg(M){for(var O=0,Y=M.sections;O<Y.length;O+=1)if(ii(Y[O].text))return!0;return!1}var wc=function(M){this.layoutVertexArray=new Vs,this.indexArray=new lo,this.programConfigurations=M,this.segments=new Ft,this.dynamicLayoutVertexArray=new xs,this.opacityVertexArray=new El,this.placedSymbolArray=new He};wc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},wc.prototype.upload=function(M,O,Y,ie){this.isEmpty()||(Y&&(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Wf.members),this.indexBuffer=M.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=M.createVertexBuffer(this.dynamicLayoutVertexArray,Bm.members,!0),this.opacityVertexBuffer=M.createVertexBuffer(this.opacityVertexArray,ug,!0),this.opacityVertexBuffer.itemSize=1),(Y||ie)&&this.programConfigurations.upload(M))},wc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Kr("SymbolBuffers",wc);var iu=function(M,O,Y){this.layoutVertexArray=new M,this.layoutAttributes=O,this.indexArray=new Y,this.segments=new Ft,this.collisionVertexArray=new Hs};iu.prototype.upload=function(M){this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=M.createVertexBuffer(this.collisionVertexArray,Nm.members,!0)},iu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Kr("CollisionBuffers",iu);var ha=function(M){this.collisionBoxArray=M.collisionBoxArray,this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(Ce){return Ce.id}),this.index=M.index,this.pixelRatio=M.pixelRatio,this.sourceLayerIndex=M.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wc([]),this.placementViewportMatrix=Wc([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Kf(this.zoom,O["text-size"]),this.iconSizeData=Kf(this.zoom,O["icon-size"]);var Y=this.layers[0].layout,ie=Y.get("symbol-sort-key"),ye=Y.get("symbol-z-order");this.sortFeaturesByKey=ye!=="viewport-y"&&ie.constantOr(1)!==void 0;var we=ye==="viewport-y"||ye==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=we&&(Y.get("text-allow-overlap")||Y.get("icon-allow-overlap")||Y.get("text-ignore-placement")||Y.get("icon-ignore-placement")),Y.get("symbol-placement")==="point"&&(this.writingModes=Y.get("text-writing-mode").map(function(Ce){return bs[Ce]})),this.stateDependentLayerIds=this.layers.filter(function(Ce){return Ce.isStateDependent()}).map(function(Ce){return Ce.id}),this.sourceID=M.sourceID};ha.prototype.createArrays=function(){this.text=new wc(new da(Wf.members,this.layers,this.zoom,function(M){return/^text/.test(M)})),this.icon=new wc(new da(Wf.members,this.layers,this.zoom,function(M){return/^icon/.test(M)})),this.glyphOffsetArray=new Tt,this.lineVertexArray=new Ct,this.symbolInstances=new ot},ha.prototype.calculateGlyphDependencies=function(M,O,Y,ie,ye){for(var we=0;we<M.length;we++)if(O[M.charCodeAt(we)]=!0,(Y||ie)&&ye){var Ce=tu[M.charAt(we)];Ce&&(O[Ce.charCodeAt(0)]=!0)}},ha.prototype.populate=function(M,O,Y){var ie=this.layers[0],ye=ie.layout,we=ye.get("text-font"),Ce=ye.get("text-field"),je=ye.get("icon-image"),tt=(Ce.value.kind!=="constant"||Ce.value.value instanceof fr&&!Ce.value.value.isEmpty()||Ce.value.value.toString().length>0)&&(we.value.kind!=="constant"||we.value.value.length>0),ft=je.value.kind!=="constant"||!!je.value.value||Object.keys(je.parameters).length>0,gt=ye.get("symbol-sort-key");if(this.features=[],tt||ft){for(var Bt=O.iconDependencies,Xt=O.glyphDependencies,Yt=O.availableImages,sr=new aa(this.zoom),br=0,Ir=M;br<Ir.length;br+=1){var Pr=Ir[br],Vr=Pr.feature,Hr=Pr.id,Zr=Pr.index,pn=Pr.sourceLayerIndex,bn=ie._featureFilter.needGeometry,jn={type:Vr.type,id:Hr,properties:Vr.properties,geometry:bn?ba(Vr):[]};if(ie._featureFilter.filter(sr,jn,Y)){bn||(jn.geometry=ba(Vr));var Nn=void 0;if(tt){var Wn=ie.getValueAndResolveTokens("text-field",jn,Y,Yt),li=fr.factory(Wn);fg(li)&&(this.hasRTLText=!0),(!this.hasRTLText||Ka()==="unavailable"||this.hasRTLText&&yo.isParsed())&&(Nn=Um(li,ie,jn))}var ci=void 0;if(ft){var $n=ie.getValueAndResolveTokens("icon-image",jn,Y,Yt);ci=$n instanceof yr?$n:yr.fromString($n)}if(Nn||ci){var mi=this.sortFeaturesByKey?gt.evaluate(jn,{},Y):void 0,pi={id:Hr,text:Nn,icon:ci,index:Zr,sourceLayerIndex:pn,geometry:ba(Vr),properties:Vr.properties,type:cg[Vr.type],sortKey:mi};if(this.features.push(pi),ci&&(Bt[ci.name]=!0),Nn){var ui=we.evaluate(jn,{},Y).join(","),Qi=ye.get("text-rotation-alignment")==="map"&&ye.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(bs.vertical)>=0;for(var qi=0,na=Nn.sections;qi<na.length;qi+=1){var Ti=na[qi];if(Ti.image)Bt[Ti.image.name]=!0;else{var Yi=Ri(Nn.toString()),wa=Ti.fontStack||ui,ma=Xt[wa]=Xt[wa]||{};this.calculateGlyphDependencies(Ti.text,ma,Qi,this.allowVerticalPlacement,Yi)}}}}}}ye.get("symbol-placement")==="line"&&(this.features=function(Pa){var ga={},ho={},Ia=[],jo=0;function Eo(Ua){Ia.push(Pa[Ua]),jo++}function Po(Ua,Oa,sa){var Wa=ho[Ua];return delete ho[Ua],ho[Oa]=Wa,Ia[Wa].geometry[0].pop(),Ia[Wa].geometry[0]=Ia[Wa].geometry[0].concat(sa[0]),Wa}function Jo(Ua,Oa,sa){var Wa=ga[Oa];return delete ga[Oa],ga[Ua]=Wa,Ia[Wa].geometry[0].shift(),Ia[Wa].geometry[0]=sa[0].concat(Ia[Wa].geometry[0]),Wa}function qo(Ua,Oa,sa){var Wa=sa?Oa[0][Oa[0].length-1]:Oa[0][0];return Ua+":"+Wa.x+":"+Wa.y}for(var po=0;po<Pa.length;po++){var Io=Pa[po],eo=Io.geometry,xo=Io.text?Io.text.toString():null;if(xo){var Bi=qo(xo,eo),ea=qo(xo,eo,!0);if(Bi in ho&&ea in ga&&ho[Bi]!==ga[ea]){var Ga=Jo(Bi,ea,eo),Ya=Po(Bi,ea,Ia[Ga].geometry);delete ga[Bi],delete ho[ea],ho[qo(xo,Ia[Ya].geometry,!0)]=Ya,Ia[Ga].geometry=null}else Bi in ho?Po(Bi,ea,eo):ea in ga?Jo(Bi,ea,eo):(Eo(po),ga[Bi]=jo-1,ho[ea]=jo-1)}else Eo(po)}return Ia.filter(function(Ua){return Ua.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Pa,ga){return Pa.sortKey-ga.sortKey})}},ha.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(M,O,this.layers,Y),this.icon.programConfigurations.updatePaintArrays(M,O,this.layers,Y))},ha.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ha.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ha.prototype.upload=function(M){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(M),this.iconCollisionBox.upload(M)),this.text.upload(M,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(M,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ha.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ha.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ha.prototype.addToLineVertexArray=function(M,O){var Y=this.lineVertexArray.length;if(M.segment!==void 0){for(var ie=M.dist(O[M.segment+1]),ye=M.dist(O[M.segment]),we={},Ce=M.segment+1;Ce<O.length;Ce++)we[Ce]={x:O[Ce].x,y:O[Ce].y,tileUnitDistanceFromAnchor:ie},Ce<O.length-1&&(ie+=O[Ce+1].dist(O[Ce]));for(var je=M.segment||0;je>=0;je--)we[je]={x:O[je].x,y:O[je].y,tileUnitDistanceFromAnchor:ye},je>0&&(ye+=O[je-1].dist(O[je]));for(var tt=0;tt<O.length;tt++){var ft=we[tt];this.lineVertexArray.emplaceBack(ft.x,ft.y,ft.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Y,lineLength:this.lineVertexArray.length-Y}},ha.prototype.addSymbols=function(M,O,Y,ie,ye,we,Ce,je,tt,ft,gt,Bt){for(var Xt=M.indexArray,Yt=M.layoutVertexArray,sr=M.segments.prepareSegment(4*O.length,Yt,Xt,we.sortKey),br=this.glyphOffsetArray.length,Ir=sr.vertexLength,Pr=this.allowVerticalPlacement&&Ce===bs.vertical?Math.PI/2:0,Vr=we.text&&we.text.sections,Hr=0;Hr<O.length;Hr++){var Zr=O[Hr],pn=Zr.tl,bn=Zr.tr,jn=Zr.bl,Nn=Zr.br,Wn=Zr.tex,li=Zr.pixelOffsetTL,ci=Zr.pixelOffsetBR,$n=Zr.minFontScaleX,mi=Zr.minFontScaleY,pi=Zr.glyphOffset,ui=Zr.isSDF,Qi=Zr.sectionIndex,qi=sr.vertexLength,na=pi[1];Fu(Yt,je.x,je.y,pn.x,na+pn.y,Wn.x,Wn.y,Y,ui,li.x,li.y,$n,mi),Fu(Yt,je.x,je.y,bn.x,na+bn.y,Wn.x+Wn.w,Wn.y,Y,ui,ci.x,li.y,$n,mi),Fu(Yt,je.x,je.y,jn.x,na+jn.y,Wn.x,Wn.y+Wn.h,Y,ui,li.x,ci.y,$n,mi),Fu(Yt,je.x,je.y,Nn.x,na+Nn.y,Wn.x+Wn.w,Wn.y+Wn.h,Y,ui,ci.x,ci.y,$n,mi),Qf(M.dynamicLayoutVertexArray,je,Pr),Xt.emplaceBack(qi,qi+1,qi+2),Xt.emplaceBack(qi+1,qi+2,qi+3),sr.vertexLength+=4,sr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pi[0]),Hr!==O.length-1&&Qi===O[Hr+1].sectionIndex||M.programConfigurations.populatePaintArrays(Yt.length,we,we.index,{},Bt,Vr&&Vr[Qi])}M.placedSymbolArray.emplaceBack(je.x,je.y,br,this.glyphOffsetArray.length-br,Ir,tt,ft,je.segment,Y?Y[0]:0,Y?Y[1]:0,ie[0],ie[1],Ce,0,!1,0,gt)},ha.prototype._addCollisionDebugVertex=function(M,O,Y,ie,ye,we){return O.emplaceBack(0,0),M.emplaceBack(Y.x,Y.y,ie,ye,Math.round(we.x),Math.round(we.y))},ha.prototype.addCollisionDebugVertices=function(M,O,Y,ie,ye,we,Ce){var je=ye.segments.prepareSegment(4,ye.layoutVertexArray,ye.indexArray),tt=je.vertexLength,ft=ye.layoutVertexArray,gt=ye.collisionVertexArray,Bt=Ce.anchorX,Xt=Ce.anchorY;this._addCollisionDebugVertex(ft,gt,we,Bt,Xt,new r(M,O)),this._addCollisionDebugVertex(ft,gt,we,Bt,Xt,new r(Y,O)),this._addCollisionDebugVertex(ft,gt,we,Bt,Xt,new r(Y,ie)),this._addCollisionDebugVertex(ft,gt,we,Bt,Xt,new r(M,ie)),je.vertexLength+=4;var Yt=ye.indexArray;Yt.emplaceBack(tt,tt+1),Yt.emplaceBack(tt+1,tt+2),Yt.emplaceBack(tt+2,tt+3),Yt.emplaceBack(tt+3,tt),je.primitiveLength+=4},ha.prototype.addDebugCollisionBoxes=function(M,O,Y,ie){for(var ye=M;ye<O;ye++){var we=this.collisionBoxArray.get(ye),Ce=we.x1,je=we.y1,tt=we.x2,ft=we.y2;this.addCollisionDebugVertices(Ce,je,tt,ft,ie?this.textCollisionBox:this.iconCollisionBox,we.anchorPoint,Y)}},ha.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new iu(Es,Pp.members,F),this.iconCollisionBox=new iu(Es,Pp.members,F);for(var M=0;M<this.symbolInstances.length;M++){var O=this.symbolInstances.get(M);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},ha.prototype._deserializeCollisionBoxesForSymbol=function(M,O,Y,ie,ye,we,Ce,je,tt){for(var ft={},gt=O;gt<Y;gt++){var Bt=M.get(gt);ft.textBox={x1:Bt.x1,y1:Bt.y1,x2:Bt.x2,y2:Bt.y2,anchorPointX:Bt.anchorPointX,anchorPointY:Bt.anchorPointY},ft.textFeatureIndex=Bt.featureIndex;break}for(var Xt=ie;Xt<ye;Xt++){var Yt=M.get(Xt);ft.verticalTextBox={x1:Yt.x1,y1:Yt.y1,x2:Yt.x2,y2:Yt.y2,anchorPointX:Yt.anchorPointX,anchorPointY:Yt.anchorPointY},ft.verticalTextFeatureIndex=Yt.featureIndex;break}for(var sr=we;sr<Ce;sr++){var br=M.get(sr);ft.iconBox={x1:br.x1,y1:br.y1,x2:br.x2,y2:br.y2,anchorPointX:br.anchorPointX,anchorPointY:br.anchorPointY},ft.iconFeatureIndex=br.featureIndex;break}for(var Ir=je;Ir<tt;Ir++){var Pr=M.get(Ir);ft.verticalIconBox={x1:Pr.x1,y1:Pr.y1,x2:Pr.x2,y2:Pr.y2,anchorPointX:Pr.anchorPointX,anchorPointY:Pr.anchorPointY},ft.verticalIconFeatureIndex=Pr.featureIndex;break}return ft},ha.prototype.deserializeCollisionBoxes=function(M){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var Y=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(M,Y.textBoxStartIndex,Y.textBoxEndIndex,Y.verticalTextBoxStartIndex,Y.verticalTextBoxEndIndex,Y.iconBoxStartIndex,Y.iconBoxEndIndex,Y.verticalIconBoxStartIndex,Y.verticalIconBoxEndIndex))}},ha.prototype.hasTextData=function(){return this.text.segments.get().length>0},ha.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ha.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ha.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ha.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ha.prototype.addIndicesForPlacedSymbol=function(M,O){for(var Y=M.placedSymbolArray.get(O),ie=Y.vertexStartIndex+4*Y.numGlyphs,ye=Y.vertexStartIndex;ye<ie;ye+=4)M.indexArray.emplaceBack(ye,ye+1,ye+2),M.indexArray.emplaceBack(ye+1,ye+2,ye+3)},ha.prototype.getSortedSymbolIndexes=function(M){if(this.sortedAngle===M&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(M),Y=Math.cos(M),ie=[],ye=[],we=[],Ce=0;Ce<this.symbolInstances.length;++Ce){we.push(Ce);var je=this.symbolInstances.get(Ce);ie.push(0|Math.round(O*je.anchorX+Y*je.anchorY)),ye.push(je.featureIndex)}return we.sort(function(tt,ft){return ie[tt]-ie[ft]||ye[ft]-ye[tt]}),we},ha.prototype.addToSortKeyRanges=function(M,O){var Y=this.sortKeyRanges[this.sortKeyRanges.length-1];Y&&Y.sortKey===O?Y.symbolInstanceEnd=M+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:M,symbolInstanceEnd:M+1})},ha.prototype.sortFeatures=function(M){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==M&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(M),this.sortedAngle=M,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Y=0,ie=this.symbolInstanceIndexes;Y<ie.length;Y+=1){var ye=ie[Y],we=this.symbolInstances.get(ye);this.featureSortOrder.push(we.featureIndex),[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach(function(Ce,je,tt){Ce>=0&&tt.indexOf(Ce)===je&&O.addIndicesForPlacedSymbol(O.text,Ce)}),we.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,we.verticalPlacedTextSymbolIndex),we.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.placedIconSymbolIndex),we.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,we.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Kr("SymbolBucket",ha,{omit:["layers","collisionBoxArray","features","compareText"]}),ha.MAX_GLYPHS=65535,ha.addDynamicAttributes=Qf;var hg=new Fo({"symbol-placement":new fi(be.layout_symbol["symbol-placement"]),"symbol-spacing":new fi(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fi(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bi(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fi(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fi(be.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fi(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new fi(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fi(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new bi(be.layout_symbol["icon-size"]),"icon-text-fit":new fi(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fi(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new bi(be.layout_symbol["icon-image"]),"icon-rotate":new bi(be.layout_symbol["icon-rotate"]),"icon-padding":new fi(be.layout_symbol["icon-padding"]),"icon-keep-upright":new fi(be.layout_symbol["icon-keep-upright"]),"icon-offset":new bi(be.layout_symbol["icon-offset"]),"icon-anchor":new bi(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fi(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fi(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fi(be.layout_symbol["text-rotation-alignment"]),"text-field":new bi(be.layout_symbol["text-field"]),"text-font":new bi(be.layout_symbol["text-font"]),"text-size":new bi(be.layout_symbol["text-size"]),"text-max-width":new bi(be.layout_symbol["text-max-width"]),"text-line-height":new fi(be.layout_symbol["text-line-height"]),"text-letter-spacing":new bi(be.layout_symbol["text-letter-spacing"]),"text-justify":new bi(be.layout_symbol["text-justify"]),"text-radial-offset":new bi(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fi(be.layout_symbol["text-variable-anchor"]),"text-anchor":new bi(be.layout_symbol["text-anchor"]),"text-max-angle":new fi(be.layout_symbol["text-max-angle"]),"text-writing-mode":new fi(be.layout_symbol["text-writing-mode"]),"text-rotate":new bi(be.layout_symbol["text-rotate"]),"text-padding":new fi(be.layout_symbol["text-padding"]),"text-keep-upright":new fi(be.layout_symbol["text-keep-upright"]),"text-transform":new bi(be.layout_symbol["text-transform"]),"text-offset":new bi(be.layout_symbol["text-offset"]),"text-allow-overlap":new fi(be.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fi(be.layout_symbol["text-ignore-placement"]),"text-optional":new fi(be.layout_symbol["text-optional"])}),eh={paint:new Fo({"icon-opacity":new bi(be.paint_symbol["icon-opacity"]),"icon-color":new bi(be.paint_symbol["icon-color"]),"icon-halo-color":new bi(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new bi(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bi(be.paint_symbol["icon-halo-blur"]),"icon-translate":new fi(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new fi(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new bi(be.paint_symbol["text-opacity"]),"text-color":new bi(be.paint_symbol["text-color"],{runtimeType:kt,getOverride:function(M){return M.textColor},hasOverride:function(M){return!!M.textColor}}),"text-halo-color":new bi(be.paint_symbol["text-halo-color"]),"text-halo-width":new bi(be.paint_symbol["text-halo-width"]),"text-halo-blur":new bi(be.paint_symbol["text-halo-blur"]),"text-translate":new fi(be.paint_symbol["text-translate"]),"text-translate-anchor":new fi(be.paint_symbol["text-translate-anchor"])}),layout:hg},Tc=function(M){this.type=M.property.overrides?M.property.overrides.runtimeType:Ot,this.defaultValue=M};Tc.prototype.evaluate=function(M){if(M.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(M.formattedSection))return O.getOverride(M.formattedSection)}return M.feature&&M.featureState?this.defaultValue.evaluate(M.feature,M.featureState):this.defaultValue.property.specification.default},Tc.prototype.eachChild=function(M){this.defaultValue.isConstant()||M(this.defaultValue.value._styleExpression.expression)},Tc.prototype.outputDefined=function(){return!1},Tc.prototype.serialize=function(){return null},Kr("FormatSectionOverride",Tc,{omit:["defaultValue"]});var pg=function(M){function O(Y){M.call(this,Y,eh)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(Y,ie){if(M.prototype.recalculate.call(this,Y,ie),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var ye=this.layout.get("text-writing-mode");if(ye){for(var we=[],Ce=0,je=ye;Ce<je.length;Ce+=1){var tt=je[Ce];we.indexOf(tt)<0&&we.push(tt)}this.layout._values["text-writing-mode"]=we}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(Y,ie,ye,we){var Ce=this.layout.get(Y).evaluate(ie,{},ye,we),je=this._unevaluatedLayout._values[Y];return je.isDataDriven()||er(je.value)||!Ce?Ce:function(tt,ft){return ft.replace(/{([^{}]+)}/g,function(gt,Bt){return Bt in tt?String(tt[Bt]):""})}(ie.properties,Ce)},O.prototype.createBucket=function(Y){return new ha(Y)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var Y=0,ie=eh.paint.overridableProperties;Y<ie.length;Y+=1){var ye=ie[Y];if(O.hasPaintOverride(this.layout,ye)){var we=this.paint.get(ye),Ce=new Tc(we),je=new $t(Ce,we.property.specification),tt=null;tt=we.value.kind==="constant"||we.value.kind==="source"?new or("source",je):new mr("composite",je,we.value.zoomStops,we.value._interpolationType),this.paint._values[ye]=new ja(we.property,tt,we.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ie,ye){return!(!this.layout||ie.isDataDriven()||ye.isDataDriven())&&O.hasPaintOverride(this.layout,Y)},O.hasPaintOverride=function(Y,ie){var ye=Y.get("text-field"),we=eh.paint.properties[ie],Ce=!1,je=function(gt){for(var Bt=0,Xt=gt;Bt<Xt.length;Bt+=1){var Yt=Xt[Bt];if(we.overrides&&we.overrides.hasOverride(Yt))return void(Ce=!0)}};if(ye.value.kind==="constant"&&ye.value.value instanceof fr)je(ye.value.value.sections);else if(ye.value.kind==="source"){var tt=function(gt){if(!Ce)if(gt instanceof hn&&Nr(gt.value)===at){var Bt=gt.value;je(Bt.sections)}else gt instanceof xn?je(gt.sections):gt.eachChild(tt)},ft=ye.value;ft._styleExpression&&tt(ft._styleExpression.expression)}return Ce},O}(Ko),dg={paint:new Fo({"background-color":new fi(be.paint_background["background-color"]),"background-pattern":new al(be.paint_background["background-pattern"]),"background-opacity":new fi(be.paint_background["background-opacity"])})},mg=function(M){function O(Y){M.call(this,Y,dg)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ko),gg={paint:new Fo({"raster-opacity":new fi(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new fi(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fi(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fi(be.paint_raster["raster-brightness-max"]),"raster-saturation":new fi(be.paint_raster["raster-saturation"]),"raster-contrast":new fi(be.paint_raster["raster-contrast"]),"raster-resampling":new fi(be.paint_raster["raster-resampling"]),"raster-fade-duration":new fi(be.paint_raster["raster-fade-duration"])})},vg=function(M){function O(Y){M.call(this,Y,gg)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ko),yg=function(M){function O(Y){M.call(this,Y,{}),this.implementation=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},O.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(Y){this.implementation.onAdd&&this.implementation.onAdd(Y,Y.painter.context.gl)},O.prototype.onRemove=function(Y){this.implementation.onRemove&&this.implementation.onRemove(Y,Y.painter.context.gl)},O}(Ko),xg={circle:im,heatmap:om,hillshade:lm,fill:km,"fill-extrusion":Om,line:Fm,symbol:pg,background:mg,raster:vg},ed=self.HTMLImageElement,td=self.HTMLCanvasElement,rd=self.HTMLVideoElement,nd=self.ImageData,Bu=self.ImageBitmap,Jl=function(M,O,Y,ie){this.context=M,this.format=Y,this.texture=M.gl.createTexture(),this.update(O,ie)};Jl.prototype.update=function(M,O,Y){var ie=M.width,ye=M.height,we=!(this.size&&this.size[0]===ie&&this.size[1]===ye||Y),Ce=this.context,je=Ce.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),je.bindTexture(je.TEXTURE_2D,this.texture),Ce.pixelStoreUnpackFlipY.set(!1),Ce.pixelStoreUnpack.set(1),Ce.pixelStoreUnpackPremultiplyAlpha.set(this.format===je.RGBA&&(!O||O.premultiply!==!1)),we)this.size=[ie,ye],M instanceof ed||M instanceof td||M instanceof rd||M instanceof nd||Bu&&M instanceof Bu?je.texImage2D(je.TEXTURE_2D,0,this.format,this.format,je.UNSIGNED_BYTE,M):je.texImage2D(je.TEXTURE_2D,0,this.format,ie,ye,0,this.format,je.UNSIGNED_BYTE,M.data);else{var tt=Y||{x:0,y:0},ft=tt.x,gt=tt.y;M instanceof ed||M instanceof td||M instanceof rd||M instanceof nd||Bu&&M instanceof Bu?je.texSubImage2D(je.TEXTURE_2D,0,ft,gt,je.RGBA,je.UNSIGNED_BYTE,M):je.texSubImage2D(je.TEXTURE_2D,0,ft,gt,ie,ye,je.RGBA,je.UNSIGNED_BYTE,M.data)}this.useMipmap&&this.isSizePowerOfTwo()&&je.generateMipmap(je.TEXTURE_2D)},Jl.prototype.bind=function(M,O,Y){var ie=this.context.gl;ie.bindTexture(ie.TEXTURE_2D,this.texture),Y!==ie.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(Y=ie.LINEAR),M!==this.filter&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,M),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,Y||M),this.filter=M),O!==this.wrap&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,O),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,O),this.wrap=O)},Jl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Jl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var th=function(M){var O=this;this._callback=M,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};th.prototype.trigger=function(){var M=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){M._triggered=!1,M._callback()},0))},th.prototype.remove=function(){delete this._channel,this._callback=function(){}};var kc=function(M,O,Y){this.target=M,this.parent=O,this.mapId=Y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},f(["receive","process"],this),this.invoker=new th(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?M:self};function id(M,O,Y){var ie=2*Math.PI*6378137/256/Math.pow(2,Y);return[M*ie-2*Math.PI*6378137/2,O*ie-2*Math.PI*6378137/2]}kc.prototype.send=function(M,O,Y,ie,ye){var we=this;ye===void 0&&(ye=!1);var Ce=Math.round(1e18*Math.random()).toString(36).substring(0,10);Y&&(this.callbacks[Ce]=Y);var je=D(this.globalScope)?void 0:[];return this.target.postMessage({id:Ce,type:M,hasCallback:!!Y,targetMapId:ie,mustQueue:ye,sourceMapId:this.mapId,data:ri(O,je)},je),{cancel:function(){Y&&delete we.callbacks[Ce],we.target.postMessage({id:Ce,type:"<cancel>",targetMapId:ie,sourceMapId:we.mapId})}}},kc.prototype.receive=function(M){var O=M.data,Y=O.id;if(Y&&(!O.targetMapId||this.mapId===O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[Y];var ie=this.cancelCallbacks[Y];delete this.cancelCallbacks[Y],ie&&ie()}else S()||O.mustQueue?(this.tasks[Y]=O,this.taskQueue.push(Y),this.invoker.trigger()):this.processTask(Y,O)},kc.prototype.process=function(){if(this.taskQueue.length){var M=this.taskQueue.shift(),O=this.tasks[M];delete this.tasks[M],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(M,O)}},kc.prototype.processTask=function(M,O){var Y=this;if(O.type==="<response>"){var ie=this.callbacks[M];delete this.callbacks[M],ie&&(O.error?ie(ki(O.error)):ie(null,ki(O.data)))}else{var ye=!1,we=D(this.globalScope)?void 0:[],Ce=O.hasCallback?function(gt,Bt){ye=!0,delete Y.cancelCallbacks[M],Y.target.postMessage({id:M,type:"<response>",sourceMapId:Y.mapId,error:gt?ri(gt):null,data:ri(Bt,we)},we)}:function(gt){ye=!0},je=null,tt=ki(O.data);if(this.parent[O.type])je=this.parent[O.type](O.sourceMapId,tt,Ce);else if(this.parent.getWorkerSource){var ft=O.type.split(".");je=this.parent.getWorkerSource(O.sourceMapId,ft[0],tt.source)[ft[1]](tt,Ce)}else Ce(new Error("Could not find function "+O.type));!ye&&je&&je.cancel&&(this.cancelCallbacks[M]=je.cancel)}},kc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var uo=function(M,O){M&&(O?this.setSouthWest(M).setNorthEast(O):M.length===4?this.setSouthWest([M[0],M[1]]).setNorthEast([M[2],M[3]]):this.setSouthWest(M[0]).setNorthEast(M[1]))};uo.prototype.setNorthEast=function(M){return this._ne=M instanceof Ca?new Ca(M.lng,M.lat):Ca.convert(M),this},uo.prototype.setSouthWest=function(M){return this._sw=M instanceof Ca?new Ca(M.lng,M.lat):Ca.convert(M),this},uo.prototype.extend=function(M){var O,Y,ie=this._sw,ye=this._ne;if(M instanceof Ca)O=M,Y=M;else{if(!(M instanceof uo)){if(Array.isArray(M)){if(M.length===4||M.every(Array.isArray)){var we=M;return this.extend(uo.convert(we))}var Ce=M;return this.extend(Ca.convert(Ce))}return this}if(O=M._sw,Y=M._ne,!O||!Y)return this}return ie||ye?(ie.lng=Math.min(O.lng,ie.lng),ie.lat=Math.min(O.lat,ie.lat),ye.lng=Math.max(Y.lng,ye.lng),ye.lat=Math.max(Y.lat,ye.lat)):(this._sw=new Ca(O.lng,O.lat),this._ne=new Ca(Y.lng,Y.lat)),this},uo.prototype.getCenter=function(){return new Ca((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},uo.prototype.getSouthWest=function(){return this._sw},uo.prototype.getNorthEast=function(){return this._ne},uo.prototype.getNorthWest=function(){return new Ca(this.getWest(),this.getNorth())},uo.prototype.getSouthEast=function(){return new Ca(this.getEast(),this.getSouth())},uo.prototype.getWest=function(){return this._sw.lng},uo.prototype.getSouth=function(){return this._sw.lat},uo.prototype.getEast=function(){return this._ne.lng},uo.prototype.getNorth=function(){return this._ne.lat},uo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},uo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},uo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},uo.prototype.contains=function(M){var O=Ca.convert(M),Y=O.lng,ie=O.lat,ye=this._sw.lat<=ie&&ie<=this._ne.lat,we=this._sw.lng<=Y&&Y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(we=this._sw.lng>=Y&&Y>=this._ne.lng),ye&&we},uo.convert=function(M){return!M||M instanceof uo?M:new uo(M)};var Ca=function(M,O){if(isNaN(M)||isNaN(O))throw new Error("Invalid LngLat object: ("+M+", "+O+")");if(this.lng=+M,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ca.prototype.wrap=function(){return new Ca(l(this.lng,-180,180),this.lat)},Ca.prototype.toArray=function(){return[this.lng,this.lat]},Ca.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ca.prototype.distanceTo=function(M){var O=Math.PI/180,Y=this.lat*O,ie=M.lat*O,ye=Math.sin(Y)*Math.sin(ie)+Math.cos(Y)*Math.cos(ie)*Math.cos((M.lng-this.lng)*O);return 63710088e-1*Math.acos(Math.min(ye,1))},Ca.prototype.toBounds=function(M){M===void 0&&(M=0);var O=360*M/40075017,Y=O/Math.cos(Math.PI/180*this.lat);return new uo(new Ca(this.lng-Y,this.lat-O),new Ca(this.lng+Y,this.lat+O))},Ca.convert=function(M){if(M instanceof Ca)return M;if(Array.isArray(M)&&(M.length===2||M.length===3))return new Ca(Number(M[0]),Number(M[1]));if(!Array.isArray(M)&&typeof M=="object"&&M!==null)return new Ca(Number("lng"in M?M.lng:M.lon),Number(M.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ad=2*Math.PI*63710088e-1;function od(M){return ad*Math.cos(M*Math.PI/180)}function sd(M){return(180+M)/360}function ld(M){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+M*Math.PI/360)))/360}function cd(M,O){return M/od(O)}function rh(M){var O=180-360*M;return 360/Math.PI*Math.atan(Math.exp(O*Math.PI/180))-90}var $l=function(M,O,Y){Y===void 0&&(Y=0),this.x=+M,this.y=+O,this.z=+Y};$l.fromLngLat=function(M,O){O===void 0&&(O=0);var Y=Ca.convert(M);return new $l(sd(Y.lng),ld(Y.lat),cd(O,Y.lat))},$l.prototype.toLngLat=function(){return new Ca(360*this.x-180,rh(this.y))},$l.prototype.toAltitude=function(){return M=this.z,O=this.y,M*od(rh(O));var M,O},$l.prototype.meterInMercatorCoordinateUnits=function(){return 1/ad*(M=rh(this.y),1/Math.cos(M*Math.PI/180));var M};var Ql=function(M,O,Y){this.z=M,this.x=O,this.y=Y,this.key=au(0,M,M,O,Y)};Ql.prototype.equals=function(M){return this.z===M.z&&this.x===M.x&&this.y===M.y},Ql.prototype.url=function(M,O){var Y,ie,ye,we,Ce,je=(Y=this.x,ie=this.y,ye=this.z,we=id(256*Y,256*(ie=Math.pow(2,ye)-ie-1),ye),Ce=id(256*(Y+1),256*(ie+1),ye),we[0]+","+we[1]+","+Ce[0]+","+Ce[1]),tt=function(ft,gt,Bt){for(var Xt,Yt="",sr=ft;sr>0;sr--)Yt+=(gt&(Xt=1<<sr-1)?1:0)+(Bt&Xt?2:0);return Yt}(this.z,this.x,this.y);return M[(this.x+this.y)%M.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",tt).replace("{bbox-epsg-3857}",je)},Ql.prototype.getTilePoint=function(M){var O=Math.pow(2,this.z);return new r(8192*(M.x*O-this.x),8192*(M.y*O-this.y))},Ql.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var ud=function(M,O){this.wrap=M,this.canonical=O,this.key=au(M,O.z,O.z,O.x,O.y)},fo=function(M,O,Y,ie,ye){this.overscaledZ=M,this.wrap=O,this.canonical=new Ql(Y,+ie,+ye),this.key=au(O,M,Y,ie,ye)};function au(M,O,Y,ie,ye){(M*=2)<0&&(M=-1*M-1);var we=1<<Y;return(we*we*M+we*ye+ie).toString(36)+Y.toString(36)+O.toString(36)}fo.prototype.equals=function(M){return this.overscaledZ===M.overscaledZ&&this.wrap===M.wrap&&this.canonical.equals(M.canonical)},fo.prototype.scaledTo=function(M){var O=this.canonical.z-M;return M>this.canonical.z?new fo(M,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fo(M,this.wrap,M,this.canonical.x>>O,this.canonical.y>>O)},fo.prototype.calculateScaledKey=function(M,O){var Y=this.canonical.z-M;return M>this.canonical.z?au(this.wrap*+O,M,this.canonical.z,this.canonical.x,this.canonical.y):au(this.wrap*+O,M,M,this.canonical.x>>Y,this.canonical.y>>Y)},fo.prototype.isChildOf=function(M){if(M.wrap!==this.wrap)return!1;var O=this.canonical.z-M.canonical.z;return M.overscaledZ===0||M.overscaledZ<this.overscaledZ&&M.canonical.x===this.canonical.x>>O&&M.canonical.y===this.canonical.y>>O},fo.prototype.children=function(M){if(this.overscaledZ>=M)return[new fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,Y=2*this.canonical.x,ie=2*this.canonical.y;return[new fo(O,this.wrap,O,Y,ie),new fo(O,this.wrap,O,Y+1,ie),new fo(O,this.wrap,O,Y,ie+1),new fo(O,this.wrap,O,Y+1,ie+1)]},fo.prototype.isLessThan=function(M){return this.wrap<M.wrap||!(this.wrap>M.wrap)&&(this.overscaledZ<M.overscaledZ||!(this.overscaledZ>M.overscaledZ)&&(this.canonical.x<M.canonical.x||!(this.canonical.x>M.canonical.x)&&this.canonical.y<M.canonical.y))},fo.prototype.wrapped=function(){return new fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.unwrapTo=function(M){return new fo(this.overscaledZ,M,this.canonical.z,this.canonical.x,this.canonical.y)},fo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},fo.prototype.toUnwrapped=function(){return new ud(this.wrap,this.canonical)},fo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},fo.prototype.getTilePoint=function(M){return this.canonical.getTilePoint(new $l(M.x-this.wrap,M.y))},Kr("CanonicalTileID",Ql),Kr("OverscaledTileID",fo,{omit:["posMatrix"]});var xl=function(M,O,Y){if(this.uid=M,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(Y&&Y!=="mapbox"&&Y!=="terrarium")return A('"'+Y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ie=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=Y||"mapbox";for(var ye=0;ye<ie;ye++)this.data[this._idx(-1,ye)]=this.data[this._idx(0,ye)],this.data[this._idx(ie,ye)]=this.data[this._idx(ie-1,ye)],this.data[this._idx(ye,-1)]=this.data[this._idx(ye,0)],this.data[this._idx(ye,ie)]=this.data[this._idx(ye,ie-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ie,-1)]=this.data[this._idx(ie-1,0)],this.data[this._idx(-1,ie)]=this.data[this._idx(0,ie-1)],this.data[this._idx(ie,ie)]=this.data[this._idx(ie-1,ie-1)]};xl.prototype.get=function(M,O){var Y=new Uint8Array(this.data.buffer),ie=4*this._idx(M,O);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(Y[ie],Y[ie+1],Y[ie+2])},xl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},xl.prototype._idx=function(M,O){if(M<-1||M>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(M+1)},xl.prototype._unpackMapbox=function(M,O,Y){return(256*M*256+256*O+Y)/10-1e4},xl.prototype._unpackTerrarium=function(M,O,Y){return 256*M+O+Y/256-32768},xl.prototype.getPixels=function(){return new rs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},xl.prototype.backfillBorder=function(M,O,Y){if(this.dim!==M.dim)throw new Error("dem dimension mismatch");var ie=O*this.dim,ye=O*this.dim+this.dim,we=Y*this.dim,Ce=Y*this.dim+this.dim;switch(O){case-1:ie=ye-1;break;case 1:ye=ie+1}switch(Y){case-1:we=Ce-1;break;case 1:Ce=we+1}for(var je=-O*this.dim,tt=-Y*this.dim,ft=we;ft<Ce;ft++)for(var gt=ie;gt<ye;gt++)this.data[this._idx(gt,ft)]=M.data[this._idx(gt+je,ft+tt)]},Kr("DEMData",xl);var Nu=function(M){this._stringToNumber={},this._numberToString=[];for(var O=0;O<M.length;O++){var Y=M[O];this._stringToNumber[Y]=O,this._numberToString[O]=Y}};Nu.prototype.encode=function(M){return this._stringToNumber[M]},Nu.prototype.decode=function(M){return this._numberToString[M]};var ju=function(M,O,Y,ie,ye){this.type="Feature",this._vectorTileFeature=M,M._z=O,M._x=Y,M._y=ie,this.properties=M.properties,this.id=ye},nh={geometry:{configurable:!0}};nh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},nh.geometry.set=function(M){this._geometry=M},ju.prototype.toJSON=function(){var M={geometry:this.geometry};for(var O in this)O!=="_geometry"&&O!=="_vectorTileFeature"&&(M[O]=this[O]);return M},Object.defineProperties(ju.prototype,nh);var Mc=function(){this.state={},this.stateChanges={},this.deletedStates={}};Mc.prototype.updateState=function(M,O,Y){var ie=String(O);if(this.stateChanges[M]=this.stateChanges[M]||{},this.stateChanges[M][ie]=this.stateChanges[M][ie]||{},o(this.stateChanges[M][ie],Y),this.deletedStates[M]===null)for(var ye in this.deletedStates[M]={},this.state[M])ye!==ie&&(this.deletedStates[M][ye]=null);else if(this.deletedStates[M]&&this.deletedStates[M][ie]===null)for(var we in this.deletedStates[M][ie]={},this.state[M][ie])Y[we]||(this.deletedStates[M][ie][we]=null);else for(var Ce in Y)this.deletedStates[M]&&this.deletedStates[M][ie]&&this.deletedStates[M][ie][Ce]===null&&delete this.deletedStates[M][ie][Ce]},Mc.prototype.removeFeatureState=function(M,O,Y){if(this.deletedStates[M]!==null){var ie=String(O);if(this.deletedStates[M]=this.deletedStates[M]||{},Y&&O!==void 0)this.deletedStates[M][ie]!==null&&(this.deletedStates[M][ie]=this.deletedStates[M][ie]||{},this.deletedStates[M][ie][Y]=null);else if(O!==void 0)if(this.stateChanges[M]&&this.stateChanges[M][ie])for(Y in this.deletedStates[M][ie]={},this.stateChanges[M][ie])this.deletedStates[M][ie][Y]=null;else this.deletedStates[M][ie]=null;else this.deletedStates[M]=null}},Mc.prototype.getState=function(M,O){var Y=String(O),ie=this.state[M]||{},ye=this.stateChanges[M]||{},we=o({},ie[Y],ye[Y]);if(this.deletedStates[M]===null)return{};if(this.deletedStates[M]){var Ce=this.deletedStates[M][O];if(Ce===null)return{};for(var je in Ce)delete we[je]}return we},Mc.prototype.initializeTileState=function(M,O){M.setFeatureState(this.state,O)},Mc.prototype.coalesceChanges=function(M,O){var Y={};for(var ie in this.stateChanges){this.state[ie]=this.state[ie]||{};var ye={};for(var we in this.stateChanges[ie])this.state[ie][we]||(this.state[ie][we]={}),o(this.state[ie][we],this.stateChanges[ie][we]),ye[we]=this.state[ie][we];Y[ie]=ye}for(var Ce in this.deletedStates){this.state[Ce]=this.state[Ce]||{};var je={};if(this.deletedStates[Ce]===null)for(var tt in this.state[Ce])je[tt]={},this.state[Ce][tt]={};else for(var ft in this.deletedStates[Ce]){if(this.deletedStates[Ce][ft]===null)this.state[Ce][ft]={};else for(var gt=0,Bt=Object.keys(this.deletedStates[Ce][ft]);gt<Bt.length;gt+=1){var Xt=Bt[gt];delete this.state[Ce][ft][Xt]}je[ft]=this.state[Ce][ft]}Y[Ce]=Y[Ce]||{},o(Y[Ce],je)}if(this.stateChanges={},this.deletedStates={},Object.keys(Y).length!==0)for(var Yt in M)M[Yt].setFeatureState(Y,O)};var bl=function(M,O){this.tileID=M,this.x=M.canonical.x,this.y=M.canonical.y,this.z=M.canonical.z,this.grid=new un(8192,16,0),this.grid3D=new un(8192,16,0),this.featureIndexArray=new Et,this.promoteId=O};function fd(M,O,Y,ie,ye){return b(M,function(we,Ce){var je=O instanceof us?O.get(Ce):null;return je&&je.evaluate?je.evaluate(Y,ie,ye):je})}function hd(M){for(var O=1/0,Y=1/0,ie=-1/0,ye=-1/0,we=0,Ce=M;we<Ce.length;we+=1){var je=Ce[we];O=Math.min(O,je.x),Y=Math.min(Y,je.y),ie=Math.max(ie,je.x),ye=Math.max(ye,je.y)}return{minX:O,minY:Y,maxX:ie,maxY:ye}}function bg(M,O){return O-M}bl.prototype.insert=function(M,O,Y,ie,ye,we){var Ce=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Y,ie,ye);for(var je=we?this.grid3D:this.grid,tt=0;tt<O.length;tt++){for(var ft=O[tt],gt=[1/0,1/0,-1/0,-1/0],Bt=0;Bt<ft.length;Bt++){var Xt=ft[Bt];gt[0]=Math.min(gt[0],Xt.x),gt[1]=Math.min(gt[1],Xt.y),gt[2]=Math.max(gt[2],Xt.x),gt[3]=Math.max(gt[3],Xt.y)}gt[0]<8192&&gt[1]<8192&&gt[2]>=0&&gt[3]>=0&&je.insert(Ce,gt[0],gt[1],gt[2],gt[3])}},bl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new mc.VectorTile(new Eu(this.rawTileData)).layers,this.sourceLayerCoder=new Nu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},bl.prototype.query=function(M,O,Y,ie){var ye=this;this.loadVTLayers();for(var we=M.params||{},Ce=8192/M.tileSize/M.scale,je=Si(we.filter),tt=M.queryGeometry,ft=M.queryPadding*Ce,gt=hd(tt),Bt=this.grid.query(gt.minX-ft,gt.minY-ft,gt.maxX+ft,gt.maxY+ft),Xt=hd(M.cameraQueryGeometry),Yt=this.grid3D.query(Xt.minX-ft,Xt.minY-ft,Xt.maxX+ft,Xt.maxY+ft,function(pn,bn,jn,Nn){return function(Wn,li,ci,$n,mi){for(var pi=0,ui=Wn;pi<ui.length;pi+=1){var Qi=ui[pi];if(li<=Qi.x&&ci<=Qi.y&&$n>=Qi.x&&mi>=Qi.y)return!0}var qi=[new r(li,ci),new r(li,mi),new r($n,mi),new r($n,ci)];if(Wn.length>2){for(var na=0,Ti=qi;na<Ti.length;na+=1)if(hs(Wn,Ti[na]))return!0}for(var Yi=0;Yi<Wn.length-1;Yi++)if(Zl(Wn[Yi],Wn[Yi+1],qi))return!0;return!1}(M.cameraQueryGeometry,pn-ft,bn-ft,jn+ft,Nn+ft)}),sr=0,br=Yt;sr<br.length;sr+=1){var Ir=br[sr];Bt.push(Ir)}Bt.sort(bg);for(var Pr,Vr={},Hr=function(pn){var bn=Bt[pn];if(bn!==Pr){Pr=bn;var jn=ye.featureIndexArray.get(bn),Nn=null;ye.loadMatchingFeature(Vr,jn.bucketIndex,jn.sourceLayerIndex,jn.featureIndex,je,we.layers,we.availableImages,O,Y,ie,function(Wn,li,ci){return Nn||(Nn=ba(Wn)),li.queryIntersectsFeature(tt,Wn,ci,Nn,ye.z,M.transform,Ce,M.pixelPosMatrix)})}},Zr=0;Zr<Bt.length;Zr++)Hr(Zr);return Vr},bl.prototype.loadMatchingFeature=function(M,O,Y,ie,ye,we,Ce,je,tt,ft,gt){var Bt=this.bucketLayerIDs[O];if(!we||function(jn,Nn){for(var Wn=0;Wn<jn.length;Wn++)if(Nn.indexOf(jn[Wn])>=0)return!0;return!1}(we,Bt)){var Xt=this.sourceLayerCoder.decode(Y),Yt=this.vtLayers[Xt].feature(ie);if(ye.filter(new aa(this.tileID.overscaledZ),Yt))for(var sr=this.getId(Yt,Xt),br=0;br<Bt.length;br++){var Ir=Bt[br];if(!(we&&we.indexOf(Ir)<0)){var Pr=je[Ir];if(Pr){var Vr={};sr!==void 0&&ft&&(Vr=ft.getState(Pr.sourceLayer||"_geojsonTileLayer",sr));var Hr=tt[Ir];Hr.paint=fd(Hr.paint,Pr.paint,Yt,Vr,Ce),Hr.layout=fd(Hr.layout,Pr.layout,Yt,Vr,Ce);var Zr=!gt||gt(Yt,Pr,Vr);if(Zr){var pn=new ju(Yt,this.z,this.x,this.y,sr);pn.layer=Hr;var bn=M[Ir];bn===void 0&&(bn=M[Ir]=[]),bn.push({featureIndex:ie,feature:pn,intersectionZ:Zr})}}}}}},bl.prototype.lookupSymbolFeatures=function(M,O,Y,ie,ye,we,Ce,je){var tt={};this.loadVTLayers();for(var ft=Si(ye),gt=0,Bt=M;gt<Bt.length;gt+=1){var Xt=Bt[gt];this.loadMatchingFeature(tt,Y,ie,Xt,ft,we,Ce,je,O)}return tt},bl.prototype.hasLayer=function(M){for(var O=0,Y=this.bucketLayerIDs;O<Y.length;O+=1)for(var ie=0,ye=Y[O];ie<ye.length;ie+=1)if(M===ye[ie])return!0;return!1},bl.prototype.getId=function(M,O){var Y=M.id;if(this.promoteId){var ie=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];typeof(Y=M.properties[ie])=="boolean"&&(Y=Number(Y))}return Y},Kr("FeatureIndex",bl,{omit:["rawTileData","sourceLayerCoder"]});var So=function(M,O){this.tileID=M,this.uid=c(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};So.prototype.registerFadeDuration=function(M){var O=M+this.timeAdded;O<N.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},So.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},So.prototype.loadVectorData=function(M,O,Y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",M){for(var ie in M.featureIndex&&(this.latestFeatureIndex=M.featureIndex,M.rawTileData?(this.latestRawTileData=M.rawTileData,this.latestFeatureIndex.rawTileData=M.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=M.collisionBoxArray,this.buckets=function(ft,gt){var Bt={};if(!gt)return Bt;for(var Xt=function(){var br=sr[Yt],Ir=br.layerIds.map(function(Zr){return gt.getLayer(Zr)}).filter(Boolean);if(Ir.length!==0){br.layers=Ir,br.stateDependentLayerIds&&(br.stateDependentLayers=br.stateDependentLayerIds.map(function(Zr){return Ir.filter(function(pn){return pn.id===Zr})[0]}));for(var Pr=0,Vr=Ir;Pr<Vr.length;Pr+=1){var Hr=Vr[Pr];Bt[Hr.id]=br}}},Yt=0,sr=ft;Yt<sr.length;Yt+=1)Xt();return Bt}(M.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var ye=this.buckets[ie];if(ye instanceof ha){if(this.hasSymbolBuckets=!0,!Y)break;ye.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var we in this.buckets){var Ce=this.buckets[we];if(Ce instanceof ha&&Ce.hasRTLText){this.hasRTLText=!0,yo.isLoading()||yo.isLoaded()||Ka()!=="deferred"||ia();break}}for(var je in this.queryPadding=0,this.buckets){var tt=this.buckets[je];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(je).queryRadius(tt))}M.imageAtlas&&(this.imageAtlas=M.imageAtlas),M.glyphAtlasImage&&(this.glyphAtlasImage=M.glyphAtlasImage)}else this.collisionBoxArray=new ke},So.prototype.unloadVectorData=function(){for(var M in this.buckets)this.buckets[M].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},So.prototype.getBucket=function(M){return this.buckets[M.id]},So.prototype.upload=function(M){for(var O in this.buckets){var Y=this.buckets[O];Y.uploadPending()&&Y.upload(M)}var ie=M.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Jl(M,this.imageAtlas.image,ie.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Jl(M,this.glyphAtlasImage,ie.ALPHA),this.glyphAtlasImage=null)},So.prototype.prepare=function(M){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(M,this.imageAtlasTexture)},So.prototype.queryRenderedFeatures=function(M,O,Y,ie,ye,we,Ce,je,tt,ft){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ie,cameraQueryGeometry:ye,scale:we,tileSize:this.tileSize,pixelPosMatrix:ft,transform:je,params:Ce,queryPadding:this.queryPadding*tt},M,O,Y):{}},So.prototype.querySourceFeatures=function(M,O){var Y=this.latestFeatureIndex;if(Y&&Y.rawTileData){var ie=Y.loadVTLayers(),ye=O?O.sourceLayer:"",we=ie._geojsonTileLayer||ie[ye];if(we)for(var Ce=Si(O&&O.filter),je=this.tileID.canonical,tt=je.z,ft=je.x,gt=je.y,Bt={z:tt,x:ft,y:gt},Xt=0;Xt<we.length;Xt++){var Yt=we.feature(Xt);if(Ce.filter(new aa(this.tileID.overscaledZ),Yt)){var sr=Y.getId(Yt,ye),br=new ju(Yt,tt,ft,gt,sr);br.tile=Bt,M.push(br)}}}},So.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},So.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},So.prototype.setExpiryData=function(M){var O=this.expirationTime;if(M.cacheControl){var Y=E(M.cacheControl);Y["max-age"]&&(this.expirationTime=Date.now()+1e3*Y["max-age"])}else M.expires&&(this.expirationTime=new Date(M.expires).getTime());if(this.expirationTime){var ie=Date.now(),ye=!1;if(this.expirationTime>ie)ye=!1;else if(O)if(this.expirationTime<O)ye=!0;else{var we=this.expirationTime-O;we?this.expirationTime=ie+Math.max(we,3e4):ye=!0}else ye=!0;ye?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},So.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},So.prototype.setFeatureState=function(M,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(M).length!==0){var Y=this.latestFeatureIndex.loadVTLayers();for(var ie in this.buckets)if(O.style.hasLayer(ie)){var ye=this.buckets[ie],we=ye.layers[0].sourceLayer||"_geojsonTileLayer",Ce=Y[we],je=M[we];if(Ce&&je&&Object.keys(je).length!==0){ye.update(je,Ce,this.imageAtlas&&this.imageAtlas.patternPositions||{});var tt=O&&O.style&&O.style.getLayer(ie);tt&&(this.queryPadding=Math.max(this.queryPadding,tt.queryRadius(ye)))}}}},So.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},So.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},So.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},So.prototype.setHoldDuration=function(M){this.symbolFadeHoldUntil=N.now()+M},So.prototype.setDependencies=function(M,O){for(var Y={},ie=0,ye=O;ie<ye.length;ie+=1)Y[ye[ie]]=!0;this.dependencies[M]=Y},So.prototype.hasDependency=function(M,O){for(var Y=0,ie=M;Y<ie.length;Y+=1){var ye=ie[Y],we=this.dependencies[ye];if(we){for(var Ce=0,je=O;Ce<je.length;Ce+=1)if(we[je[Ce]])return!0}}return!1};var Ol=self.performance,pd=function(M){this._marks={start:[M.url,"start"].join("#"),end:[M.url,"end"].join("#"),measure:M.url.toString()},Ol.mark(this._marks.start)};pd.prototype.finish=function(){Ol.mark(this._marks.end);var M=Ol.getEntriesByName(this._marks.measure);return M.length===0&&(Ol.measure(this._marks.measure,this._marks.start,this._marks.end),M=Ol.getEntriesByName(this._marks.measure),Ol.clearMarks(this._marks.start),Ol.clearMarks(this._marks.end),Ol.clearMeasures(this._marks.measure)),M},e.Actor=kc,e.AlphaImage=Kl,e.CanonicalTileID=Ql,e.CollisionBoxArray=ke,e.Color=Qt,e.DEMData=xl,e.DataConstantProperty=fi,e.DictionaryCoder=Nu,e.EXTENT=8192,e.ErrorEvent=qe,e.EvaluationParameters=aa,e.Event=Ne,e.Evented=pe,e.FeatureIndex=bl,e.FillBucket=qs,e.FillExtrusionBucket=Gs,e.ImageAtlas=nu,e.ImagePosition=Cu,e.LineBucket=ns,e.LngLat=Ca,e.LngLatBounds=uo,e.MercatorCoordinate=$l,e.ONE_EM=24,e.OverscaledTileID=fo,e.Point=r,e.Point$1=r,e.Properties=Fo,e.Protobuf=Eu,e.RGBAImage=rs,e.RequestManager=re,e.RequestPerformance=pd,e.ResourceType=xt,e.SegmentVector=Ft,e.SourceFeatureState=Mc,e.StructArrayLayout1ui2=q,e.StructArrayLayout2f1f2i16=Ll,e.StructArrayLayout2i4=ys,e.StructArrayLayout3ui6=lo,e.StructArrayLayout4i8=za,e.SymbolBucket=ha,e.Texture=Jl,e.Tile=So,e.Transitionable=cs,e.Uniform1f=Yr,e.Uniform1i=hi,e.Uniform2f=Sn,e.Uniform3f=Kn,e.Uniform4f=Yn,e.UniformColor=ai,e.UniformMatrix4f=Li,e.UnwrappedTileID=ud,e.ValidationError=Fe,e.WritingMode=bs,e.ZoomHistory=Pi,e.add=function(M,O,Y){return M[0]=O[0]+Y[0],M[1]=O[1]+Y[1],M[2]=O[2]+Y[2],M},e.addDynamicAttributes=Qf,e.asyncAll=function(M,O,Y){if(!M.length)return Y(null,[]);var ie=M.length,ye=new Array(M.length),we=null;M.forEach(function(Ce,je){O(Ce,function(tt,ft){tt&&(we=tt),ye[je]=ft,--ie==0&&Y(we,ye)})})},e.bezier=u,e.bindAll=f,e.browser=N,e.cacheEntryPossiblyAdded=function(M){++Qe>De&&(M.getActor().send("enforceCacheSizeLimit",Oe),Qe=0)},e.clamp=h,e.clearTileCache=function(M){var O=self.caches.delete("mapbox-tiles");M&&O.catch(M).then(function(){return M()})},e.clipLine=Zp,e.clone=function(M){var O=new ts(16);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O[3]=M[3],O[4]=M[4],O[5]=M[5],O[6]=M[6],O[7]=M[7],O[8]=M[8],O[9]=M[9],O[10]=M[10],O[11]=M[11],O[12]=M[12],O[13]=M[13],O[14]=M[14],O[15]=M[15],O},e.clone$1=k,e.clone$2=function(M){var O=new ts(3);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O},e.collisionCircleLayout=jm,e.config=U,e.create=function(){var M=new ts(16);return ts!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0),M[0]=1,M[5]=1,M[10]=1,M[15]=1,M},e.create$1=function(){var M=new ts(9);return ts!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M},e.create$2=function(){var M=new ts(4);return ts!=Float32Array&&(M[1]=0,M[2]=0),M[0]=1,M[3]=1,M},e.createCommonjsModule=t,e.createExpression=Zt,e.createLayout=oa,e.createStyleLayer=function(M){return M.type==="custom"?new yg(M):new xg[M.type](M)},e.cross=function(M,O,Y){var ie=O[0],ye=O[1],we=O[2],Ce=Y[0],je=Y[1],tt=Y[2];return M[0]=ye*tt-we*je,M[1]=we*Ce-ie*tt,M[2]=ie*je-ye*Ce,M},e.deepEqual=function M(O,Y){if(Array.isArray(O)){if(!Array.isArray(Y)||O.length!==Y.length)return!1;for(var ie=0;ie<O.length;ie++)if(!M(O[ie],Y[ie]))return!1;return!0}if(typeof O=="object"&&O!==null&&Y!==null){if(typeof Y!="object"||Object.keys(O).length!==Object.keys(Y).length)return!1;for(var ye in O)if(!M(O[ye],Y[ye]))return!1;return!0}return O===Y},e.dot=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]},e.dot$1=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]+M[3]*O[3]},e.ease=s,e.emitValidationErrors=Mn,e.endsWith=_,e.enforceCacheSizeLimit=function(M){Xe(),_e&&_e.then(function(O){O.keys().then(function(Y){for(var ie=0;ie<Y.length-M;ie++)O.delete(Y[ie])})})},e.evaluateSizeForFeature=Vp,e.evaluateSizeForZoom=Hp,e.evaluateVariableOffset=Jp,e.evented=Sa,e.extend=o,e.featureFilter=Si,e.filterObject=T,e.fromRotation=function(M,O){var Y=Math.sin(O),ie=Math.cos(O);return M[0]=ie,M[1]=Y,M[2]=0,M[3]=-Y,M[4]=ie,M[5]=0,M[6]=0,M[7]=0,M[8]=1,M},e.getAnchorAlignment=Xf,e.getAnchorJustification=$f,e.getArrayBuffer=vt,e.getImage=Wt,e.getJSON=function(M,O){return $e(o(M,{type:"json"}),O)},e.getRTLTextPluginStatus=Ka,e.getReferrer=bt,e.getVideo=function(M,O){var Y,ie,ye=self.document.createElement("video");ye.muted=!0,ye.onloadstart=function(){O(null,ye)};for(var we=0;we<M.length;we++){var Ce=self.document.createElement("source");Y=M[we],ie=void 0,(ie=self.document.createElement("a")).href=Y,(ie.protocol!==self.document.location.protocol||ie.host!==self.document.location.host)&&(ye.crossOrigin="Anonymous"),Ce.src=M[we],ye.appendChild(Ce)}return{cancel:function(){}}},e.identity=Wc,e.invert=function(M,O){var Y=O[0],ie=O[1],ye=O[2],we=O[3],Ce=O[4],je=O[5],tt=O[6],ft=O[7],gt=O[8],Bt=O[9],Xt=O[10],Yt=O[11],sr=O[12],br=O[13],Ir=O[14],Pr=O[15],Vr=Y*je-ie*Ce,Hr=Y*tt-ye*Ce,Zr=Y*ft-we*Ce,pn=ie*tt-ye*je,bn=ie*ft-we*je,jn=ye*ft-we*tt,Nn=gt*br-Bt*sr,Wn=gt*Ir-Xt*sr,li=gt*Pr-Yt*sr,ci=Bt*Ir-Xt*br,$n=Bt*Pr-Yt*br,mi=Xt*Pr-Yt*Ir,pi=Vr*mi-Hr*$n+Zr*ci+pn*li-bn*Wn+jn*Nn;return pi?(pi=1/pi,M[0]=(je*mi-tt*$n+ft*ci)*pi,M[1]=(ye*$n-ie*mi-we*ci)*pi,M[2]=(br*jn-Ir*bn+Pr*pn)*pi,M[3]=(Xt*bn-Bt*jn-Yt*pn)*pi,M[4]=(tt*li-Ce*mi-ft*Wn)*pi,M[5]=(Y*mi-ye*li+we*Wn)*pi,M[6]=(Ir*Zr-sr*jn-Pr*Hr)*pi,M[7]=(gt*jn-Xt*Zr+Yt*Hr)*pi,M[8]=(Ce*$n-je*li+ft*Nn)*pi,M[9]=(ie*li-Y*$n-we*Nn)*pi,M[10]=(sr*bn-br*Zr+Pr*Vr)*pi,M[11]=(Bt*Zr-gt*bn-Yt*Vr)*pi,M[12]=(je*Wn-Ce*ci-tt*Nn)*pi,M[13]=(Y*ci-ie*Wn+ye*Nn)*pi,M[14]=(br*Hr-sr*pn-Ir*Vr)*pi,M[15]=(gt*pn-Bt*Hr+Xt*Vr)*pi,M):null},e.isChar=Ln,e.isMapboxURL=se,e.keysDifference=function(M,O){var Y=[];for(var ie in M)ie in O||Y.push(ie);return Y},e.makeRequest=$e,e.mapObject=b,e.mercatorXfromLng=sd,e.mercatorYfromLat=ld,e.mercatorZfromAltitude=cd,e.mul=zf,e.multiply=Xl,e.mvt=mc,e.normalize=function(M,O){var Y=O[0],ie=O[1],ye=O[2],we=Y*Y+ie*ie+ye*ye;return we>0&&(we=1/Math.sqrt(we)),M[0]=O[0]*we,M[1]=O[1]*we,M[2]=O[2]*we,M},e.number=kn,e.offscreenCanvasSupported=lt,e.ortho=function(M,O,Y,ie,ye,we,Ce){var je=1/(O-Y),tt=1/(ie-ye),ft=1/(we-Ce);return M[0]=-2*je,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*tt,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*ft,M[11]=0,M[12]=(O+Y)*je,M[13]=(ye+ie)*tt,M[14]=(Ce+we)*ft,M[15]=1,M},e.parseGlyphPBF=function(M){return new Eu(M).readFields(Jm,[])},e.pbf=Eu,e.performSymbolLayout=function(M,O,Y,ie,ye,we,Ce){M.createArrays();var je=512*M.overscaling;M.tilePixelRatio=8192/je,M.compareText={},M.iconsNeedLinear=!1;var tt=M.layers[0].layout,ft=M.layers[0]._unevaluatedLayout._values,gt={};if(M.textSizeData.kind==="composite"){var Bt=M.textSizeData,Xt=Bt.minZoom,Yt=Bt.maxZoom;gt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new aa(Xt),Ce),ft["text-size"].possiblyEvaluate(new aa(Yt),Ce)]}if(M.iconSizeData.kind==="composite"){var sr=M.iconSizeData,br=sr.minZoom,Ir=sr.maxZoom;gt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new aa(br),Ce),ft["icon-size"].possiblyEvaluate(new aa(Ir),Ce)]}gt.layoutTextSize=ft["text-size"].possiblyEvaluate(new aa(M.zoom+1),Ce),gt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new aa(M.zoom+1),Ce),gt.textMaxSize=ft["text-size"].possiblyEvaluate(new aa(18));for(var Pr=24*tt.get("text-line-height"),Vr=tt.get("text-rotation-alignment")==="map"&&tt.get("symbol-placement")!=="point",Hr=tt.get("text-keep-upright"),Zr=tt.get("text-size"),pn=function(){var Nn=jn[bn],Wn=tt.get("text-font").evaluate(Nn,{},Ce).join(","),li=Zr.evaluate(Nn,{},Ce),ci=gt.layoutTextSize.evaluate(Nn,{},Ce),$n=gt.layoutIconSize.evaluate(Nn,{},Ce),mi={horizontal:{},vertical:void 0},pi=Nn.text,ui=[0,0];if(pi){var Qi=pi.toString(),qi=24*tt.get("text-letter-spacing").evaluate(Nn,{},Ce),na=function(Bi){for(var ea=0,Ga=Bi;ea<Ga.length;ea+=1)if(!Ci(Ga[ea].charCodeAt(0)))return!1;return!0}(Qi)?qi:0,Ti=tt.get("text-anchor").evaluate(Nn,{},Ce),Yi=tt.get("text-variable-anchor");if(!Yi){var wa=tt.get("text-radial-offset").evaluate(Nn,{},Ce);ui=wa?Jp(Ti,[24*wa,Jf]):tt.get("text-offset").evaluate(Nn,{},Ce).map(function(Bi){return 24*Bi})}var ma=Vr?"center":tt.get("text-justify").evaluate(Nn,{},Ce),Pa=tt.get("symbol-placement"),ga=Pa==="point"?24*tt.get("text-max-width").evaluate(Nn,{},Ce):0,ho=function(){M.allowVerticalPlacement&&Ri(Qi)&&(mi.vertical=Pu(pi,O,Y,ye,Wn,ga,Pr,Ti,"left",na,ui,bs.vertical,!0,Pa,ci,li))};if(!Vr&&Yi){for(var Ia=ma==="auto"?Yi.map(function(Bi){return $f(Bi)}):[ma],jo=!1,Eo=0;Eo<Ia.length;Eo++){var Po=Ia[Eo];if(!mi.horizontal[Po])if(jo)mi.horizontal[Po]=mi.horizontal[0];else{var Jo=Pu(pi,O,Y,ye,Wn,ga,Pr,"center",Po,na,ui,bs.horizontal,!1,Pa,ci,li);Jo&&(mi.horizontal[Po]=Jo,jo=Jo.positionedLines.length===1)}}ho()}else{ma==="auto"&&(ma=$f(Ti));var qo=Pu(pi,O,Y,ye,Wn,ga,Pr,Ti,ma,na,ui,bs.horizontal,!1,Pa,ci,li);qo&&(mi.horizontal[ma]=qo),ho(),Ri(Qi)&&Vr&&Hr&&(mi.vertical=Pu(pi,O,Y,ye,Wn,ga,Pr,Ti,ma,na,ui,bs.vertical,!1,Pa,ci,li))}}var po=void 0,Io=!1;if(Nn.icon&&Nn.icon.name){var eo=ie[Nn.icon.name];eo&&(po=function(Bi,ea,Ga){var Ya=Xf(Ga),Ua=Ya.horizontalAlign,Oa=Ya.verticalAlign,sa=ea[0],Wa=ea[1],$o=sa-Bi.displaySize[0]*Ua,ds=$o+Bi.displaySize[0],Go=Wa-Bi.displaySize[1]*Oa;return{image:Bi,top:Go,bottom:Go+Bi.displaySize[1],left:$o,right:ds}}(ye[Nn.icon.name],tt.get("icon-offset").evaluate(Nn,{},Ce),tt.get("icon-anchor").evaluate(Nn,{},Ce)),Io=eo.sdf,M.sdfIcons===void 0?M.sdfIcons=eo.sdf:M.sdfIcons!==eo.sdf&&A("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(eo.pixelRatio!==M.pixelRatio||tt.get("icon-rotate").constantOr(1)!==0)&&(M.iconsNeedLinear=!0))}var xo=Qp(mi.horizontal)||mi.vertical;M.iconsInText=!!xo&&xo.iconsInText,(xo||po)&&function(Bi,ea,Ga,Ya,Ua,Oa,sa,Wa,$o,ds,Go){var Ys=Oa.textMaxSize.evaluate(ea,{});Ys===void 0&&(Ys=sa);var _l,Lo=Bi.layers[0].layout,Ws=Lo.get("icon-offset").evaluate(ea,{},Go),Zs=Qp(Ga.horizontal),Xs=sa/24,ih=Bi.tilePixelRatio*Xs,Ac=Bi.tilePixelRatio*Ys/24,Uu=Bi.tilePixelRatio*Wa,ec=Bi.tilePixelRatio*Lo.get("symbol-spacing"),Vu=Lo.get("text-padding")*Bi.tilePixelRatio,Hu=Lo.get("icon-padding")*Bi.tilePixelRatio,qu=Lo.get("text-max-angle")/180*Math.PI,Gu=Lo.get("text-rotation-alignment")==="map"&&Lo.get("symbol-placement")!=="point",Dl=Lo.get("icon-rotation-alignment")==="map"&&Lo.get("symbol-placement")!=="point",Sc=Lo.get("symbol-placement"),Yu=ec/2,Ec=Lo.get("icon-text-fit");Ya&&Ec!=="none"&&(Bi.allowVerticalPlacement&&Ga.vertical&&(_l=Up(Ya,Ga.vertical,Ec,Lo.get("icon-text-fit-padding"),Ws,Xs)),Zs&&(Ya=Up(Ya,Zs,Ec,Lo.get("icon-text-fit-padding"),Ws,Xs)));var zl=function(wg,fu){fu.x<0||fu.x>=8192||fu.y<0||fu.y>=8192||function($a,Ks,Tg,Rl,ch,vd,ef,sl,tf,hu,rf,nf,uh,yd,pu,xd,bd,_d,wd,Td,_s,af,kd,ll,kg){var fh,tc,Dc,zc,Rc,Fc=$a.addToLineVertexArray(Ks,Tg),Md=0,Ad=0,Sd=0,Ed=0,hh=-1,ph=-1,wl={},Ld=Lr(""),dh=0,mh=0;if(sl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(fh=sl.layout.get("text-offset").evaluate(_s,{},ll).map(function(mu){return 24*mu}),dh=fh[0],mh=fh[1]):(dh=24*sl.layout.get("text-radial-offset").evaluate(_s,{},ll),mh=Jf),$a.allowVerticalPlacement&&Rl.vertical){var Cd=sl.layout.get("text-rotate").evaluate(_s,{},ll)+90,Mg=Rl.vertical;zc=new Ru(tf,Ks,hu,rf,nf,Mg,uh,yd,pu,Cd),ef&&(Rc=new Ru(tf,Ks,hu,rf,nf,ef,bd,_d,pu,Cd))}if(ch){var gh=sl.layout.get("icon-rotate").evaluate(_s,{}),Pd=sl.layout.get("icon-text-fit")!=="none",Id=Xp(ch,gh,kd,Pd),vh=ef?Xp(ef,gh,kd,Pd):void 0;Dc=new Ru(tf,Ks,hu,rf,nf,ch,bd,_d,!1,gh),Md=4*Id.length;var Od=$a.iconSizeData,du=null;Od.kind==="source"?(du=[128*sl.layout.get("icon-size").evaluate(_s,{})])[0]>32640&&A($a.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Od.kind==="composite"&&((du=[128*af.compositeIconSizes[0].evaluate(_s,{},ll),128*af.compositeIconSizes[1].evaluate(_s,{},ll)])[0]>32640||du[1]>32640)&&A($a.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),$a.addSymbols($a.icon,Id,du,Td,wd,_s,!1,Ks,Fc.lineStartIndex,Fc.lineLength,-1,ll),hh=$a.icon.placedSymbolArray.length-1,vh&&(Ad=4*vh.length,$a.addSymbols($a.icon,vh,du,Td,wd,_s,bs.vertical,Ks,Fc.lineStartIndex,Fc.lineLength,-1,ll),ph=$a.icon.placedSymbolArray.length-1)}for(var Dd in Rl.horizontal){var of=Rl.horizontal[Dd];if(!tc){Ld=Lr(of.text);var Ag=sl.layout.get("text-rotate").evaluate(_s,{},ll);tc=new Ru(tf,Ks,hu,rf,nf,of,uh,yd,pu,Ag)}var zd=of.positionedLines.length===1;if(Sd+=$p($a,Ks,of,vd,sl,pu,_s,xd,Fc,Rl.vertical?bs.horizontal:bs.horizontalOnly,zd?Object.keys(Rl.horizontal):[Dd],wl,hh,af,ll),zd)break}Rl.vertical&&(Ed+=$p($a,Ks,Rl.vertical,vd,sl,pu,_s,xd,Fc,bs.vertical,["vertical"],wl,ph,af,ll));var Sg=tc?tc.boxStartIndex:$a.collisionBoxArray.length,Eg=tc?tc.boxEndIndex:$a.collisionBoxArray.length,Lg=zc?zc.boxStartIndex:$a.collisionBoxArray.length,Cg=zc?zc.boxEndIndex:$a.collisionBoxArray.length,Pg=Dc?Dc.boxStartIndex:$a.collisionBoxArray.length,Ig=Dc?Dc.boxEndIndex:$a.collisionBoxArray.length,Og=Rc?Rc.boxStartIndex:$a.collisionBoxArray.length,Dg=Rc?Rc.boxEndIndex:$a.collisionBoxArray.length,cl=-1,sf=function(mu,Fd){return mu&&mu.circleDiameter?Math.max(mu.circleDiameter,Fd):Fd};cl=sf(tc,cl),cl=sf(zc,cl),cl=sf(Dc,cl);var Rd=(cl=sf(Rc,cl))>-1?1:0;Rd&&(cl*=kg/24),$a.glyphOffsetArray.length>=ha.MAX_GLYPHS&&A("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),_s.sortKey!==void 0&&$a.addToSortKeyRanges($a.symbolInstances.length,_s.sortKey),$a.symbolInstances.emplaceBack(Ks.x,Ks.y,wl.right>=0?wl.right:-1,wl.center>=0?wl.center:-1,wl.left>=0?wl.left:-1,wl.vertical||-1,hh,ph,Ld,Sg,Eg,Lg,Cg,Pg,Ig,Og,Dg,hu,Sd,Ed,Md,Ad,Rd,0,uh,dh,mh,cl)}(Bi,fu,wg,Ga,Ya,Ua,_l,Bi.layers[0],Bi.collisionBoxArray,ea.index,ea.sourceLayerIndex,Bi.index,ih,Vu,Gu,$o,Uu,Hu,Dl,Ws,ea,Oa,ds,Go,sa)};if(Sc==="line")for(var ou=0,Wu=Zp(ea.geometry,0,0,8192,8192);ou<Wu.length;ou+=1)for(var Zu=Wu[ou],Xu=ig(Zu,ec,qu,Ga.vertical||Zs,Ya,24,Ac,Bi.overscaling,8192),su=0,Ku=Xu;su<Ku.length;su+=1){var lu=Ku[su],Ju=Zs;Ju&&lg(Bi,Ju.text,Yu,lu)||zl(Zu,lu)}else if(Sc==="line-center")for(var cu=0,$u=ea.geometry;cu<$u.length;cu+=1){var Lc=$u[cu];if(Lc.length>1){var Cc=ng(Lc,qu,Ga.vertical||Zs,Ya,24,Ac);Cc&&zl(Lc,Cc)}}else if(ea.type==="Polygon")for(var Pc=0,Qu=Hf(ea.geometry,0);Pc<Qu.length;Pc+=1){var Ic=Qu[Pc],uu=og(Ic,16);zl(Ic[0],new xc(uu.x,uu.y,0))}else if(ea.type==="LineString")for(var Oc=0,dd=ea.geometry;Oc<dd.length;Oc+=1){var ah=dd[Oc];zl(ah,new xc(ah[0].x,ah[0].y,0))}else if(ea.type==="Point")for(var oh=0,md=ea.geometry;oh<md.length;oh+=1)for(var _g=md[oh],sh=0,gd=_g;sh<gd.length;sh+=1){var lh=gd[sh];zl([lh],new xc(lh.x,lh.y,0))}}(M,Nn,mi,po,ie,gt,ci,$n,ui,Io,Ce)},bn=0,jn=M.features;bn<jn.length;bn+=1)pn();we&&M.generateCollisionDebugBuffers()},e.perspective=function(M,O,Y,ie,ye){var we,Ce=1/Math.tan(O/2);return M[0]=Ce/Y,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Ce,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,ye!=null&&ye!==1/0?(we=1/(ie-ye),M[10]=(ye+ie)*we,M[14]=2*ye*ie*we):(M[10]=-1,M[14]=-2*ie),M},e.pick=function(M,O){for(var Y={},ie=0;ie<O.length;ie++){var ye=O[ie];ye in M&&(Y[ye]=M[ye])}return Y},e.plugin=yo,e.polygonIntersectsPolygon=Vo,e.postMapLoadEvent=ze,e.postTurnstileEvent=Se,e.potpack=Fp,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Kr,e.registerForPluginStateChange=function(M){return M({pluginStatus:xi,pluginURL:xa}),Sa.on("pluginStateChange",M),M},e.rotate=function(M,O,Y){var ie=O[0],ye=O[1],we=O[2],Ce=O[3],je=Math.sin(Y),tt=Math.cos(Y);return M[0]=ie*tt+we*je,M[1]=ye*tt+Ce*je,M[2]=ie*-je+we*tt,M[3]=ye*-je+Ce*tt,M},e.rotateX=function(M,O,Y){var ie=Math.sin(Y),ye=Math.cos(Y),we=O[4],Ce=O[5],je=O[6],tt=O[7],ft=O[8],gt=O[9],Bt=O[10],Xt=O[11];return O!==M&&(M[0]=O[0],M[1]=O[1],M[2]=O[2],M[3]=O[3],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[4]=we*ye+ft*ie,M[5]=Ce*ye+gt*ie,M[6]=je*ye+Bt*ie,M[7]=tt*ye+Xt*ie,M[8]=ft*ye-we*ie,M[9]=gt*ye-Ce*ie,M[10]=Bt*ye-je*ie,M[11]=Xt*ye-tt*ie,M},e.rotateZ=function(M,O,Y){var ie=Math.sin(Y),ye=Math.cos(Y),we=O[0],Ce=O[1],je=O[2],tt=O[3],ft=O[4],gt=O[5],Bt=O[6],Xt=O[7];return O!==M&&(M[8]=O[8],M[9]=O[9],M[10]=O[10],M[11]=O[11],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[0]=we*ye+ft*ie,M[1]=Ce*ye+gt*ie,M[2]=je*ye+Bt*ie,M[3]=tt*ye+Xt*ie,M[4]=ft*ye-we*ie,M[5]=gt*ye-Ce*ie,M[6]=Bt*ye-je*ie,M[7]=Xt*ye-tt*ie,M},e.scale=function(M,O,Y){var ie=Y[0],ye=Y[1],we=Y[2];return M[0]=O[0]*ie,M[1]=O[1]*ie,M[2]=O[2]*ie,M[3]=O[3]*ie,M[4]=O[4]*ye,M[5]=O[5]*ye,M[6]=O[6]*ye,M[7]=O[7]*ye,M[8]=O[8]*we,M[9]=O[9]*we,M[10]=O[10]*we,M[11]=O[11]*we,M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15],M},e.scale$1=function(M,O,Y){return M[0]=O[0]*Y,M[1]=O[1]*Y,M[2]=O[2]*Y,M[3]=O[3]*Y,M},e.scale$2=function(M,O,Y){return M[0]=O[0]*Y,M[1]=O[1]*Y,M[2]=O[2]*Y,M},e.setCacheLimits=function(M,O){Oe=M,De=O},e.setRTLTextPlugin=function(M,O,Y){if(Y===void 0&&(Y=!1),xi===Ki||xi===qa||xi===es)throw new Error("setRTLTextPlugin cannot be called multiple times.");xa=N.resolveURL(M),xi=Ki,To=O,Ji(),Y||ia()},e.sphericalToCartesian=function(M){var O=M[0],Y=M[1],ie=M[2];return Y+=90,Y*=Math.PI/180,ie*=Math.PI/180,{x:O*Math.cos(Y)*Math.sin(ie),y:O*Math.sin(Y)*Math.sin(ie),z:O*Math.cos(ie)}},e.sqrLen=Zc,e.styleSpec=be,e.sub=Rf,e.symbolSize=rg,e.transformMat3=function(M,O,Y){var ie=O[0],ye=O[1],we=O[2];return M[0]=ie*Y[0]+ye*Y[3]+we*Y[6],M[1]=ie*Y[1]+ye*Y[4]+we*Y[7],M[2]=ie*Y[2]+ye*Y[5]+we*Y[8],M},e.transformMat4=hc,e.translate=function(M,O,Y){var ie,ye,we,Ce,je,tt,ft,gt,Bt,Xt,Yt,sr,br=Y[0],Ir=Y[1],Pr=Y[2];return O===M?(M[12]=O[0]*br+O[4]*Ir+O[8]*Pr+O[12],M[13]=O[1]*br+O[5]*Ir+O[9]*Pr+O[13],M[14]=O[2]*br+O[6]*Ir+O[10]*Pr+O[14],M[15]=O[3]*br+O[7]*Ir+O[11]*Pr+O[15]):(ie=O[0],ye=O[1],we=O[2],Ce=O[3],je=O[4],tt=O[5],ft=O[6],gt=O[7],Bt=O[8],Xt=O[9],Yt=O[10],sr=O[11],M[0]=ie,M[1]=ye,M[2]=we,M[3]=Ce,M[4]=je,M[5]=tt,M[6]=ft,M[7]=gt,M[8]=Bt,M[9]=Xt,M[10]=Yt,M[11]=sr,M[12]=ie*br+je*Ir+Bt*Pr+O[12],M[13]=ye*br+tt*Ir+Xt*Pr+O[13],M[14]=we*br+ft*Ir+Yt*Pr+O[14],M[15]=Ce*br+gt*Ir+sr*Pr+O[15]),M},e.triggerPluginCompletionEvent=ko,e.uniqueId=c,e.validateCustomStyleLayer=function(M){var O=[],Y=M.id;return Y===void 0&&O.push({message:"layers."+Y+': missing required property "id"'}),M.render===void 0&&O.push({message:"layers."+Y+': missing required method "render"'}),M.renderingMode&&M.renderingMode!=="2d"&&M.renderingMode!=="3d"&&O.push({message:"layers."+Y+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=cn,e.validateStyle=Xr,e.values=function(M){var O=[];for(var Y in M)O.push(M[Y]);return O},e.vectorTile=mc,e.version="1.10.1",e.warnOnce=A,e.webpSupported=te,e.window=self,e.wrap=l}),y(0,function(e){function t(Ne){var qe=typeof Ne;if(qe==="number"||qe==="boolean"||qe==="string"||Ne==null)return JSON.stringify(Ne);if(Array.isArray(Ne)){for(var pe="[",be=0,Fe=Ne;be<Fe.length;be+=1)pe+=t(Fe[be])+",";return pe+"]"}for(var Ve=Object.keys(Ne).sort(),Ke="{",Ge=0;Ge<Ve.length;Ge++)Ke+=JSON.stringify(Ve[Ge])+":"+t(Ne[Ve[Ge]])+",";return Ke+"}"}function n(Ne){for(var qe="",pe=0,be=e.refProperties;pe<be.length;pe+=1)qe+="/"+t(Ne[be[pe]]);return qe}var a=function(Ne){this.keyCache={},Ne&&this.replace(Ne)};a.prototype.replace=function(Ne){this._layerConfigs={},this._layers={},this.update(Ne,[])},a.prototype.update=function(Ne,qe){for(var pe=this,be=0,Fe=Ne;be<Fe.length;be+=1){var Ve=Fe[be];this._layerConfigs[Ve.id]=Ve;var Ke=this._layers[Ve.id]=e.createStyleLayer(Ve);Ke._featureFilter=e.featureFilter(Ke.filter),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id]}for(var Ge=0,ct=qe;Ge<ct.length;Ge+=1){var st=ct[Ge];delete this.keyCache[st],delete this._layerConfigs[st],delete this._layers[st]}this.familiesBySource={};for(var Mt=0,Ot=function(Ze,at){for(var pt={},St=0;St<Ze.length;St++){var Ut=at&&at[Ze[St].id]||n(Ze[St]);at&&(at[Ze[St].id]=Ut);var Kt=pt[Ut];Kt||(Kt=pt[Ut]=[]),Kt.push(Ze[St])}var Ht=[];for(var pr in pt)Ht.push(pt[pr]);return Ht}(e.values(this._layerConfigs),this.keyCache);Mt<Ot.length;Mt+=1){var it=Ot[Mt].map(function(Ze){return pe._layers[Ze.id]}),ht=it[0];if(ht.visibility!=="none"){var jt=ht.source||"",kt=this.familiesBySource[jt];kt||(kt=this.familiesBySource[jt]={});var Pt=ht.sourceLayer||"_geojsonTileLayer",Ee=kt[Pt];Ee||(Ee=kt[Pt]=[]),Ee.push(it)}}};var r=function(Ne){var qe={},pe=[];for(var be in Ne){var Fe=Ne[be],Ve=qe[be]={};for(var Ke in Fe){var Ge=Fe[+Ke];if(Ge&&Ge.bitmap.width!==0&&Ge.bitmap.height!==0){var ct={x:0,y:0,w:Ge.bitmap.width+2,h:Ge.bitmap.height+2};pe.push(ct),Ve[Ke]={rect:ct,metrics:Ge.metrics}}}}var st=e.potpack(pe),Mt=st.w,Ot=st.h,it=new e.AlphaImage({width:Mt||1,height:Ot||1});for(var ht in Ne){var jt=Ne[ht];for(var kt in jt){var Pt=jt[+kt];if(Pt&&Pt.bitmap.width!==0&&Pt.bitmap.height!==0){var Ee=qe[ht][kt].rect;e.AlphaImage.copy(Pt.bitmap,it,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},Pt.bitmap)}}}this.image=it,this.positions=qe};e.register("GlyphAtlas",r);var g=function(Ne){this.tileID=new e.OverscaledTileID(Ne.tileID.overscaledZ,Ne.tileID.wrap,Ne.tileID.canonical.z,Ne.tileID.canonical.x,Ne.tileID.canonical.y),this.uid=Ne.uid,this.zoom=Ne.zoom,this.pixelRatio=Ne.pixelRatio,this.tileSize=Ne.tileSize,this.source=Ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ne.showCollisionBoxes,this.collectResourceTiming=!!Ne.collectResourceTiming,this.returnDependencies=!!Ne.returnDependencies,this.promoteId=Ne.promoteId};function u(Ne,qe,pe){for(var be=new e.EvaluationParameters(qe),Fe=0,Ve=Ne;Fe<Ve.length;Fe+=1)Ve[Fe].recalculate(be,pe)}function s(Ne,qe){var pe=e.getArrayBuffer(Ne.request,function(be,Fe,Ve,Ke){be?qe(be):Fe&&qe(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Fe)),rawData:Fe,cacheControl:Ve,expires:Ke})});return function(){pe.cancel(),qe()}}g.prototype.parse=function(Ne,qe,pe,be,Fe){var Ve=this;this.status="parsing",this.data=Ne,this.collisionBoxArray=new e.CollisionBoxArray;var Ke=new e.DictionaryCoder(Object.keys(Ne.layers).sort()),Ge=new e.FeatureIndex(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];var ct,st,Mt,Ot,it={},ht={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pe},jt=qe.familiesBySource[this.source];for(var kt in jt){var Pt=Ne.layers[kt];if(Pt){Pt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+kt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ee=Ke.encode(kt),Ze=[],at=0;at<Pt.length;at++){var pt=Pt.feature(at),St=Ge.getId(pt,kt);Ze.push({feature:pt,id:St,index:at,sourceLayerIndex:Ee})}for(var Ut=0,Kt=jt[kt];Ut<Kt.length;Ut+=1){var Ht=Kt[Ut],pr=Ht[0];pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||pr.visibility!=="none"&&(u(Ht,this.zoom,pe),(it[pr.id]=pr.createBucket({index:Ge.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ee,sourceID:this.source})).populate(Ze,ht,this.tileID.canonical),Ge.bucketLayerIDs.push(Ht.map(function(rr){return rr.id})))}}}var Mr=e.mapObject(ht.glyphDependencies,function(rr){return Object.keys(rr).map(Number)});Object.keys(Mr).length?be.send("getGlyphs",{uid:this.uid,stacks:Mr},function(rr,fr){ct||(ct=rr,st=fr,tr.call(Ve))}):st={};var hr=Object.keys(ht.iconDependencies);hr.length?be.send("getImages",{icons:hr,source:this.source,tileID:this.tileID,type:"icons"},function(rr,fr){ct||(ct=rr,Mt=fr,tr.call(Ve))}):Mt={};var Qt=Object.keys(ht.patternDependencies);function tr(){if(ct)return Fe(ct);if(st&&Mt&&Ot){var rr=new r(st),fr=new e.ImageAtlas(Mt,Ot);for(var yr in it){var Sr=it[yr];Sr instanceof e.SymbolBucket?(u(Sr.layers,this.zoom,pe),e.performSymbolLayout(Sr,st,rr.positions,Mt,fr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Sr.hasPattern&&(Sr instanceof e.LineBucket||Sr instanceof e.FillBucket||Sr instanceof e.FillExtrusionBucket)&&(u(Sr.layers,this.zoom,pe),Sr.addFeatures(ht,this.tileID.canonical,fr.patternPositions))}this.status="done",Fe(null,{buckets:e.values(it).filter(function(Dr){return!Dr.isEmpty()}),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rr.image,imageAtlas:fr,glyphMap:this.returnDependencies?st:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?rr.positions:null})}}Qt.length?be.send("getImages",{icons:Qt,source:this.source,tileID:this.tileID,type:"patterns"},function(rr,fr){ct||(ct=rr,Ot=fr,tr.call(Ve))}):Ot={},tr.call(this)};var h=function(Ne,qe,pe,be){this.actor=Ne,this.layerIndex=qe,this.availableImages=pe,this.loadVectorData=be||s,this.loading={},this.loaded={}};h.prototype.loadTile=function(Ne,qe){var pe=this,be=Ne.uid;this.loading||(this.loading={});var Fe=!!(Ne&&Ne.request&&Ne.request.collectResourceTiming)&&new e.RequestPerformance(Ne.request),Ve=this.loading[be]=new g(Ne);Ve.abort=this.loadVectorData(Ne,function(Ke,Ge){if(delete pe.loading[be],Ke||!Ge)return Ve.status="done",pe.loaded[be]=Ve,qe(Ke);var ct=Ge.rawData,st={};Ge.expires&&(st.expires=Ge.expires),Ge.cacheControl&&(st.cacheControl=Ge.cacheControl);var Mt={};if(Fe){var Ot=Fe.finish();Ot&&(Mt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}Ve.vectorTile=Ge.vectorTile,Ve.parse(Ge.vectorTile,pe.layerIndex,pe.availableImages,pe.actor,function(it,ht){if(it||!ht)return qe(it);qe(null,e.extend({rawTileData:ct.slice(0)},ht,st,Mt))}),pe.loaded=pe.loaded||{},pe.loaded[be]=Ve})},h.prototype.reloadTile=function(Ne,qe){var pe=this,be=this.loaded,Fe=Ne.uid,Ve=this;if(be&&be[Fe]){var Ke=be[Fe];Ke.showCollisionBoxes=Ne.showCollisionBoxes;var Ge=function(ct,st){var Mt=Ke.reloadCallback;Mt&&(delete Ke.reloadCallback,Ke.parse(Ke.vectorTile,Ve.layerIndex,pe.availableImages,Ve.actor,Mt)),qe(ct,st)};Ke.status==="parsing"?Ke.reloadCallback=Ge:Ke.status==="done"&&(Ke.vectorTile?Ke.parse(Ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Ge):Ge())}},h.prototype.abortTile=function(Ne,qe){var pe=this.loading,be=Ne.uid;pe&&pe[be]&&pe[be].abort&&(pe[be].abort(),delete pe[be]),qe()},h.prototype.removeTile=function(Ne,qe){var pe=this.loaded,be=Ne.uid;pe&&pe[be]&&delete pe[be],qe()};var l=e.window.ImageBitmap,o=function(){this.loaded={}};o.prototype.loadTile=function(Ne,qe){var pe=Ne.uid,be=Ne.encoding,Fe=Ne.rawImageData,Ve=l&&Fe instanceof l?this.getImageData(Fe):Fe,Ke=new e.DEMData(pe,Ve,be);this.loaded=this.loaded||{},this.loaded[pe]=Ke,qe(null,Ke)},o.prototype.getImageData=function(Ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ne.width,Ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ne.width,this.offscreenCanvas.height=Ne.height,this.offscreenCanvasContext.drawImage(Ne,0,0,Ne.width,Ne.height);var qe=this.offscreenCanvasContext.getImageData(-1,-1,Ne.width+2,Ne.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:qe.width,height:qe.height},qe.data)},o.prototype.removeTile=function(Ne){var qe=this.loaded,pe=Ne.uid;qe&&qe[pe]&&delete qe[pe]};var p=function Ne(qe,pe){var be,Fe=qe&&qe.type;if(Fe==="FeatureCollection")for(be=0;be<qe.features.length;be++)Ne(qe.features[be],pe);else if(Fe==="GeometryCollection")for(be=0;be<qe.geometries.length;be++)Ne(qe.geometries[be],pe);else if(Fe==="Feature")Ne(qe.geometry,pe);else if(Fe==="Polygon")c(qe.coordinates,pe);else if(Fe==="MultiPolygon")for(be=0;be<qe.coordinates.length;be++)c(qe.coordinates[be],pe);return qe};function c(Ne,qe){if(Ne.length!==0){i(Ne[0],qe);for(var pe=1;pe<Ne.length;pe++)i(Ne[pe],!qe)}}function i(Ne,qe){for(var pe=0,be=0,Fe=Ne.length,Ve=Fe-1;be<Fe;Ve=be++)pe+=(Ne[be][0]-Ne[Ve][0])*(Ne[Ve][1]+Ne[be][1]);pe>=0!=!!qe&&Ne.reverse()}var x=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(Ne){this._feature=Ne,this.extent=e.EXTENT,this.type=Ne.type,this.properties=Ne.tags,"id"in Ne&&!isNaN(Ne.id)&&(this.id=parseInt(Ne.id,10))};f.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ne=[],qe=0,pe=this._feature.geometry;qe<pe.length;qe+=1){var be=pe[qe];Ne.push([new e.Point$1(be[0],be[1])])}return Ne}for(var Fe=[],Ve=0,Ke=this._feature.geometry;Ve<Ke.length;Ve+=1){for(var Ge=[],ct=0,st=Ke[Ve];ct<st.length;ct+=1){var Mt=st[ct];Ge.push(new e.Point$1(Mt[0],Mt[1]))}Fe.push(Ge)}return Fe},f.prototype.toGeoJSON=function(Ne,qe,pe){return x.call(this,Ne,qe,pe)};var _=function(Ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ne.length,this._features=Ne};_.prototype.feature=function(Ne){return new f(this._features[Ne])};var b=e.vectorTile.VectorTileFeature,T=k;function k(Ne,qe){this.options=qe||{},this.features=Ne,this.length=Ne.length}function L(Ne,qe){this.id=typeof Ne.id=="number"?Ne.id:void 0,this.type=Ne.type,this.rawGeometry=Ne.type===1?[Ne.geometry]:Ne.geometry,this.properties=Ne.tags,this.extent=qe||4096}k.prototype.feature=function(Ne){return new L(this.features[Ne],this.options.extent)},L.prototype.loadGeometry=function(){var Ne=this.rawGeometry;this.geometry=[];for(var qe=0;qe<Ne.length;qe++){for(var pe=Ne[qe],be=[],Fe=0;Fe<pe.length;Fe++)be.push(new e.Point$1(pe[Fe][0],pe[Fe][1]));this.geometry.push(be)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ne=this.geometry,qe=1/0,pe=-1/0,be=1/0,Fe=-1/0,Ve=0;Ve<Ne.length;Ve++)for(var Ke=Ne[Ve],Ge=0;Ge<Ke.length;Ge++){var ct=Ke[Ge];qe=Math.min(qe,ct.x),pe=Math.max(pe,ct.x),be=Math.min(be,ct.y),Fe=Math.max(Fe,ct.y)}return[qe,be,pe,Fe]},L.prototype.toGeoJSON=b.prototype.toGeoJSON;var A=E,I=E,P=function(Ne,qe){qe=qe||{};var pe={};for(var be in Ne)pe[be]=new T(Ne[be].features,qe),pe[be].name=be,pe[be].version=qe.version,pe[be].extent=qe.extent;return E({layers:pe})},S=T;function E(Ne){var qe=new e.pbf;return function(pe,be){for(var Fe in pe.layers)be.writeMessage(3,z,pe.layers[Fe])}(Ne,qe),qe.finish()}function z(Ne,qe){var pe;qe.writeVarintField(15,Ne.version||1),qe.writeStringField(1,Ne.name||""),qe.writeVarintField(5,Ne.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<Ne.length;pe++)be.feature=Ne.feature(pe),qe.writeMessage(2,D,be);var Fe=be.keys;for(pe=0;pe<Fe.length;pe++)qe.writeStringField(3,Fe[pe]);var Ve=be.values;for(pe=0;pe<Ve.length;pe++)qe.writeMessage(4,K,Ve[pe])}function D(Ne,qe){var pe=Ne.feature;pe.id!==void 0&&qe.writeVarintField(1,pe.id),qe.writeMessage(2,j,Ne),qe.writeVarintField(3,pe.type),qe.writeMessage(4,Q,pe)}function j(Ne,qe){var pe=Ne.feature,be=Ne.keys,Fe=Ne.values,Ve=Ne.keycache,Ke=Ne.valuecache;for(var Ge in pe.properties){var ct=Ve[Ge];ct===void 0&&(be.push(Ge),ct=be.length-1,Ve[Ge]=ct),qe.writeVarint(ct);var st=pe.properties[Ge],Mt=typeof st;Mt!=="string"&&Mt!=="boolean"&&Mt!=="number"&&(st=JSON.stringify(st));var Ot=Mt+":"+st,it=Ke[Ot];it===void 0&&(Fe.push(st),it=Fe.length-1,Ke[Ot]=it),qe.writeVarint(it)}}function V(Ne,qe){return(qe<<3)+(7&Ne)}function Z(Ne){return Ne<<1^Ne>>31}function Q(Ne,qe){for(var pe=Ne.loadGeometry(),be=Ne.type,Fe=0,Ve=0,Ke=pe.length,Ge=0;Ge<Ke;Ge++){var ct=pe[Ge],st=1;be===1&&(st=ct.length),qe.writeVarint(V(1,st));for(var Mt=be===3?ct.length-1:ct.length,Ot=0;Ot<Mt;Ot++){Ot===1&&be!==1&&qe.writeVarint(V(2,Mt-1));var it=ct[Ot].x-Fe,ht=ct[Ot].y-Ve;qe.writeVarint(Z(it)),qe.writeVarint(Z(ht)),Fe+=it,Ve+=ht}be===3&&qe.writeVarint(V(7,1))}}function K(Ne,qe){var pe=typeof Ne;pe==="string"?qe.writeStringField(1,Ne):pe==="boolean"?qe.writeBooleanField(7,Ne):pe==="number"&&(Ne%1!=0?qe.writeDoubleField(3,Ne):Ne<0?qe.writeSVarintField(6,Ne):qe.writeVarintField(5,Ne))}function $(Ne,qe,pe,be,Fe,Ve){if(!(Fe-be<=pe)){var Ke=be+Fe>>1;(function Ge(ct,st,Mt,Ot,it,ht){for(;it>Ot;){if(it-Ot>600){var jt=it-Ot+1,kt=Mt-Ot+1,Pt=Math.log(jt),Ee=.5*Math.exp(2*Pt/3),Ze=.5*Math.sqrt(Pt*Ee*(jt-Ee)/jt)*(kt-jt/2<0?-1:1),at=Math.max(Ot,Math.floor(Mt-kt*Ee/jt+Ze)),pt=Math.min(it,Math.floor(Mt+(jt-kt)*Ee/jt+Ze));Ge(ct,st,Mt,at,pt,ht)}var St=st[2*Mt+ht],Ut=Ot,Kt=it;for(ne(ct,st,Ot,Mt),st[2*it+ht]>St&&ne(ct,st,Ot,it);Ut<Kt;){for(ne(ct,st,Ut,Kt),Ut++,Kt--;st[2*Ut+ht]<St;)Ut++;for(;st[2*Kt+ht]>St;)Kt--}st[2*Ot+ht]===St?ne(ct,st,Ot,Kt):(Kt++,ne(ct,st,Kt,it)),Kt<=Mt&&(Ot=Kt+1),Mt<=Kt&&(it=Kt-1)}})(Ne,qe,Ke,be,Fe,Ve%2),$(Ne,qe,pe,be,Ke-1,Ve+1),$(Ne,qe,pe,Ke+1,Fe,Ve+1)}}function ne(Ne,qe,pe,be){H(Ne,pe,be),H(qe,2*pe,2*be),H(qe,2*pe+1,2*be+1)}function H(Ne,qe,pe){var be=Ne[qe];Ne[qe]=Ne[pe],Ne[pe]=be}function N(Ne,qe,pe,be){var Fe=Ne-pe,Ve=qe-be;return Fe*Fe+Ve*Ve}A.fromVectorTileJs=I,A.fromGeojsonVt=P,A.GeoJSONWrapper=S;var U=function(Ne){return Ne[0]},te=function(Ne){return Ne[1]},B=function(Ne,qe,pe,be,Fe){qe===void 0&&(qe=U),pe===void 0&&(pe=te),be===void 0&&(be=64),Fe===void 0&&(Fe=Float64Array),this.nodeSize=be,this.points=Ne;for(var Ve=Ne.length<65536?Uint16Array:Uint32Array,Ke=this.ids=new Ve(Ne.length),Ge=this.coords=new Fe(2*Ne.length),ct=0;ct<Ne.length;ct++)Ke[ct]=ct,Ge[2*ct]=qe(Ne[ct]),Ge[2*ct+1]=pe(Ne[ct]);$(Ke,Ge,be,0,Ke.length-1,0)};B.prototype.range=function(Ne,qe,pe,be){return function(Fe,Ve,Ke,Ge,ct,st,Mt){for(var Ot,it,ht=[0,Fe.length-1,0],jt=[];ht.length;){var kt=ht.pop(),Pt=ht.pop(),Ee=ht.pop();if(Pt-Ee<=Mt)for(var Ze=Ee;Ze<=Pt;Ze++)Ot=Ve[2*Ze],it=Ve[2*Ze+1],Ot>=Ke&&Ot<=ct&&it>=Ge&&it<=st&&jt.push(Fe[Ze]);else{var at=Math.floor((Ee+Pt)/2);Ot=Ve[2*at],it=Ve[2*at+1],Ot>=Ke&&Ot<=ct&&it>=Ge&&it<=st&&jt.push(Fe[at]);var pt=(kt+1)%2;(kt===0?Ke<=Ot:Ge<=it)&&(ht.push(Ee),ht.push(at-1),ht.push(pt)),(kt===0?ct>=Ot:st>=it)&&(ht.push(at+1),ht.push(Pt),ht.push(pt))}}return jt}(this.ids,this.coords,Ne,qe,pe,be,this.nodeSize)},B.prototype.within=function(Ne,qe,pe){return function(be,Fe,Ve,Ke,Ge,ct){for(var st=[0,be.length-1,0],Mt=[],Ot=Ge*Ge;st.length;){var it=st.pop(),ht=st.pop(),jt=st.pop();if(ht-jt<=ct)for(var kt=jt;kt<=ht;kt++)N(Fe[2*kt],Fe[2*kt+1],Ve,Ke)<=Ot&&Mt.push(be[kt]);else{var Pt=Math.floor((jt+ht)/2),Ee=Fe[2*Pt],Ze=Fe[2*Pt+1];N(Ee,Ze,Ve,Ke)<=Ot&&Mt.push(be[Pt]);var at=(it+1)%2;(it===0?Ve-Ge<=Ee:Ke-Ge<=Ze)&&(st.push(jt),st.push(Pt-1),st.push(at)),(it===0?Ve+Ge>=Ee:Ke+Ge>=Ze)&&(st.push(Pt+1),st.push(ht),st.push(at))}}return Mt}(this.ids,this.coords,Ne,qe,pe,this.nodeSize)};var X={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ne){return Ne}},J=function(Ne){this.options=ve(Object.create(X),Ne),this.trees=new Array(this.options.maxZoom+1)};function ee(Ne,qe,pe,be,Fe){return{x:Ne,y:qe,zoom:1/0,id:pe,parentId:-1,numPoints:be,properties:Fe}}function re(Ne,qe){var pe=Ne.geometry.coordinates,be=pe[0],Fe=pe[1];return{x:de(be),y:ce(Fe),zoom:1/0,index:qe,parentId:-1}}function se(Ne){return{type:"Feature",id:Ne.id,properties:oe(Ne),geometry:{type:"Point",coordinates:[(be=Ne.x,360*(be-.5)),(qe=Ne.y,pe=(180-360*qe)*Math.PI/180,360*Math.atan(Math.exp(pe))/Math.PI-90)]}};var qe,pe,be}function oe(Ne){var qe=Ne.numPoints,pe=qe>=1e4?Math.round(qe/1e3)+"k":qe>=1e3?Math.round(qe/100)/10+"k":qe;return ve(ve({},Ne.properties),{cluster:!0,cluster_id:Ne.id,point_count:qe,point_count_abbreviated:pe})}function de(Ne){return Ne/360+.5}function ce(Ne){var qe=Math.sin(Ne*Math.PI/180),pe=.5-.25*Math.log((1+qe)/(1-qe))/Math.PI;return pe<0?0:pe>1?1:pe}function ve(Ne,qe){for(var pe in qe)Ne[pe]=qe[pe];return Ne}function Ae(Ne){return Ne.x}function fe(Ne){return Ne.y}function me(Ne,qe,pe,be,Fe,Ve){var Ke=Fe-pe,Ge=Ve-be;if(Ke!==0||Ge!==0){var ct=((Ne-pe)*Ke+(qe-be)*Ge)/(Ke*Ke+Ge*Ge);ct>1?(pe=Fe,be=Ve):ct>0&&(pe+=Ke*ct,be+=Ge*ct)}return(Ke=Ne-pe)*Ke+(Ge=qe-be)*Ge}function _e(Ne,qe,pe,be){var Fe={id:Ne===void 0?null:Ne,type:qe,geometry:pe,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ve){var Ke=Ve.geometry,Ge=Ve.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")le(Ve,Ke);else if(Ge==="Polygon"||Ge==="MultiLineString")for(var ct=0;ct<Ke.length;ct++)le(Ve,Ke[ct]);else if(Ge==="MultiPolygon")for(ct=0;ct<Ke.length;ct++)for(var st=0;st<Ke[ct].length;st++)le(Ve,Ke[ct][st])}(Fe),Fe}function le(Ne,qe){for(var pe=0;pe<qe.length;pe+=3)Ne.minX=Math.min(Ne.minX,qe[pe]),Ne.minY=Math.min(Ne.minY,qe[pe+1]),Ne.maxX=Math.max(Ne.maxX,qe[pe]),Ne.maxY=Math.max(Ne.maxY,qe[pe+1])}function ge(Ne,qe,pe,be){if(qe.geometry){var Fe=qe.geometry.coordinates,Ve=qe.geometry.type,Ke=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),Ge=[],ct=qe.id;if(pe.promoteId?ct=qe.properties[pe.promoteId]:pe.generateId&&(ct=be||0),Ve==="Point")Te(Fe,Ge);else if(Ve==="MultiPoint")for(var st=0;st<Fe.length;st++)Te(Fe[st],Ge);else if(Ve==="LineString")Se(Fe,Ge,Ke,!1);else if(Ve==="MultiLineString"){if(pe.lineMetrics){for(st=0;st<Fe.length;st++)Ge=[],Se(Fe[st],Ge,Ke,!1),Ne.push(_e(ct,"LineString",Ge,qe.properties));return}Me(Fe,Ge,Ke,!1)}else if(Ve==="Polygon")Me(Fe,Ge,Ke,!0);else{if(Ve!=="MultiPolygon"){if(Ve==="GeometryCollection"){for(st=0;st<qe.geometry.geometries.length;st++)ge(Ne,{id:ct,geometry:qe.geometry.geometries[st],properties:qe.properties},pe,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(st=0;st<Fe.length;st++){var Mt=[];Me(Fe[st],Mt,Ke,!0),Ge.push(Mt)}}Ne.push(_e(ct,Ve,Ge,qe.properties))}}function Te(Ne,qe){qe.push(ze(Ne[0])),qe.push(Oe(Ne[1])),qe.push(0)}function Se(Ne,qe,pe,be){for(var Fe,Ve,Ke=0,Ge=0;Ge<Ne.length;Ge++){var ct=ze(Ne[Ge][0]),st=Oe(Ne[Ge][1]);qe.push(ct),qe.push(st),qe.push(0),Ge>0&&(Ke+=be?(Fe*st-ct*Ve)/2:Math.sqrt(Math.pow(ct-Fe,2)+Math.pow(st-Ve,2))),Fe=ct,Ve=st}var Mt=qe.length-3;qe[2]=1,function Ot(it,ht,jt,kt){for(var Pt,Ee=kt,Ze=jt-ht>>1,at=jt-ht,pt=it[ht],St=it[ht+1],Ut=it[jt],Kt=it[jt+1],Ht=ht+3;Ht<jt;Ht+=3){var pr=me(it[Ht],it[Ht+1],pt,St,Ut,Kt);if(pr>Ee)Pt=Ht,Ee=pr;else if(pr===Ee){var Mr=Math.abs(Ht-Ze);Mr<at&&(Pt=Ht,at=Mr)}}Ee>kt&&(Pt-ht>3&&Ot(it,ht,Pt,kt),it[Pt+2]=Ee,jt-Pt>3&&Ot(it,Pt,jt,kt))}(qe,0,Mt,pe),qe[Mt+2]=1,qe.size=Math.abs(Ke),qe.start=0,qe.end=qe.size}function Me(Ne,qe,pe,be){for(var Fe=0;Fe<Ne.length;Fe++){var Ve=[];Se(Ne[Fe],Ve,pe,be),qe.push(Ve)}}function ze(Ne){return Ne/360+.5}function Oe(Ne){var qe=Math.sin(Ne*Math.PI/180),pe=.5-.25*Math.log((1+qe)/(1-qe))/Math.PI;return pe<0?0:pe>1?1:pe}function De(Ne,qe,pe,be,Fe,Ve,Ke,Ge){if(be/=qe,Ve>=(pe/=qe)&&Ke<be)return Ne;if(Ke<pe||Ve>=be)return null;for(var ct=[],st=0;st<Ne.length;st++){var Mt=Ne[st],Ot=Mt.geometry,it=Mt.type,ht=Fe===0?Mt.minX:Mt.minY,jt=Fe===0?Mt.maxX:Mt.maxY;if(ht>=pe&&jt<be)ct.push(Mt);else if(!(jt<pe||ht>=be)){var kt=[];if(it==="Point"||it==="MultiPoint")Xe(Ot,kt,pe,be,Fe);else if(it==="LineString")Be(Ot,kt,pe,be,Fe,!1,Ge.lineMetrics);else if(it==="MultiLineString")Re(Ot,kt,pe,be,Fe,!1);else if(it==="Polygon")Re(Ot,kt,pe,be,Fe,!0);else if(it==="MultiPolygon")for(var Pt=0;Pt<Ot.length;Pt++){var Ee=[];Re(Ot[Pt],Ee,pe,be,Fe,!0),Ee.length&&kt.push(Ee)}if(kt.length){if(Ge.lineMetrics&&it==="LineString"){for(Pt=0;Pt<kt.length;Pt++)ct.push(_e(Mt.id,it,kt[Pt],Mt.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(kt.length===1?(it="LineString",kt=kt[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=kt.length===3?"Point":"MultiPoint"),ct.push(_e(Mt.id,it,kt,Mt.tags))}}}return ct.length?ct:null}function Xe(Ne,qe,pe,be,Fe){for(var Ve=0;Ve<Ne.length;Ve+=3){var Ke=Ne[Ve+Fe];Ke>=pe&&Ke<=be&&(qe.push(Ne[Ve]),qe.push(Ne[Ve+1]),qe.push(Ne[Ve+2]))}}function Be(Ne,qe,pe,be,Fe,Ve,Ke){for(var Ge,ct,st=Ie(Ne),Mt=Fe===0?Qe:lt,Ot=Ne.start,it=0;it<Ne.length-3;it+=3){var ht=Ne[it],jt=Ne[it+1],kt=Ne[it+2],Pt=Ne[it+3],Ee=Ne[it+4],Ze=Fe===0?ht:jt,at=Fe===0?Pt:Ee,pt=!1;Ke&&(Ge=Math.sqrt(Math.pow(ht-Pt,2)+Math.pow(jt-Ee,2))),Ze<pe?at>pe&&(ct=Mt(st,ht,jt,Pt,Ee,pe),Ke&&(st.start=Ot+Ge*ct)):Ze>be?at<be&&(ct=Mt(st,ht,jt,Pt,Ee,be),Ke&&(st.start=Ot+Ge*ct)):Ye(st,ht,jt,kt),at<pe&&Ze>=pe&&(ct=Mt(st,ht,jt,Pt,Ee,pe),pt=!0),at>be&&Ze<=be&&(ct=Mt(st,ht,jt,Pt,Ee,be),pt=!0),!Ve&&pt&&(Ke&&(st.end=Ot+Ge*ct),qe.push(st),st=Ie(Ne)),Ke&&(Ot+=Ge)}var St=Ne.length-3;ht=Ne[St],jt=Ne[St+1],kt=Ne[St+2],(Ze=Fe===0?ht:jt)>=pe&&Ze<=be&&Ye(st,ht,jt,kt),St=st.length-3,Ve&&St>=3&&(st[St]!==st[0]||st[St+1]!==st[1])&&Ye(st,st[0],st[1],st[2]),st.length&&qe.push(st)}function Ie(Ne){var qe=[];return qe.size=Ne.size,qe.start=Ne.start,qe.end=Ne.end,qe}function Re(Ne,qe,pe,be,Fe,Ve){for(var Ke=0;Ke<Ne.length;Ke++)Be(Ne[Ke],qe,pe,be,Fe,Ve,!1)}function Ye(Ne,qe,pe,be){Ne.push(qe),Ne.push(pe),Ne.push(be)}function Qe(Ne,qe,pe,be,Fe,Ve){var Ke=(Ve-qe)/(be-qe);return Ne.push(Ve),Ne.push(pe+(Fe-pe)*Ke),Ne.push(1),Ke}function lt(Ne,qe,pe,be,Fe,Ve){var Ke=(Ve-pe)/(Fe-pe);return Ne.push(qe+(be-qe)*Ke),Ne.push(Ve),Ne.push(1),Ke}function xt(Ne,qe){for(var pe=[],be=0;be<Ne.length;be++){var Fe,Ve=Ne[be],Ke=Ve.type;if(Ke==="Point"||Ke==="MultiPoint"||Ke==="LineString")Fe=wt(Ve.geometry,qe);else if(Ke==="MultiLineString"||Ke==="Polygon"){Fe=[];for(var Ge=0;Ge<Ve.geometry.length;Ge++)Fe.push(wt(Ve.geometry[Ge],qe))}else if(Ke==="MultiPolygon")for(Fe=[],Ge=0;Ge<Ve.geometry.length;Ge++){for(var ct=[],st=0;st<Ve.geometry[Ge].length;st++)ct.push(wt(Ve.geometry[Ge][st],qe));Fe.push(ct)}pe.push(_e(Ve.id,Ke,Fe,Ve.tags))}return pe}function wt(Ne,qe){var pe=[];pe.size=Ne.size,Ne.start!==void 0&&(pe.start=Ne.start,pe.end=Ne.end);for(var be=0;be<Ne.length;be+=3)pe.push(Ne[be]+qe,Ne[be+1],Ne[be+2]);return pe}function bt(Ne,qe){if(Ne.transformed)return Ne;var pe,be,Fe,Ve=1<<Ne.z,Ke=Ne.x,Ge=Ne.y;for(pe=0;pe<Ne.features.length;pe++){var ct=Ne.features[pe],st=ct.geometry,Mt=ct.type;if(ct.geometry=[],Mt===1)for(be=0;be<st.length;be+=2)ct.geometry.push(nt(st[be],st[be+1],qe,Ve,Ke,Ge));else for(be=0;be<st.length;be++){var Ot=[];for(Fe=0;Fe<st[be].length;Fe+=2)Ot.push(nt(st[be][Fe],st[be][Fe+1],qe,Ve,Ke,Ge));ct.geometry.push(Ot)}}return Ne.transformed=!0,Ne}function nt(Ne,qe,pe,be,Fe,Ve){return[Math.round(pe*(Ne*be-Fe)),Math.round(pe*(qe*be-Ve))]}function $e(Ne,qe,pe,be,Fe){for(var Ve=qe===Fe.maxZoom?0:Fe.tolerance/((1<<qe)*Fe.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:be,z:qe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ge=0;Ge<Ne.length;Ge++){Ke.numFeatures++,vt(Ke,Ne[Ge],Ve,Fe);var ct=Ne[Ge].minX,st=Ne[Ge].minY,Mt=Ne[Ge].maxX,Ot=Ne[Ge].maxY;ct<Ke.minX&&(Ke.minX=ct),st<Ke.minY&&(Ke.minY=st),Mt>Ke.maxX&&(Ke.maxX=Mt),Ot>Ke.maxY&&(Ke.maxY=Ot)}return Ke}function vt(Ne,qe,pe,be){var Fe=qe.geometry,Ve=qe.type,Ke=[];if(Ve==="Point"||Ve==="MultiPoint")for(var Ge=0;Ge<Fe.length;Ge+=3)Ke.push(Fe[Ge]),Ke.push(Fe[Ge+1]),Ne.numPoints++,Ne.numSimplified++;else if(Ve==="LineString")Nt(Ke,Fe,Ne,pe,!1,!1);else if(Ve==="MultiLineString"||Ve==="Polygon")for(Ge=0;Ge<Fe.length;Ge++)Nt(Ke,Fe[Ge],Ne,pe,Ve==="Polygon",Ge===0);else if(Ve==="MultiPolygon")for(var ct=0;ct<Fe.length;ct++){var st=Fe[ct];for(Ge=0;Ge<st.length;Ge++)Nt(Ke,st[Ge],Ne,pe,!0,Ge===0)}if(Ke.length){var Mt=qe.tags||null;if(Ve==="LineString"&&be.lineMetrics){for(var Ot in Mt={},qe.tags)Mt[Ot]=qe.tags[Ot];Mt.mapbox_clip_start=Fe.start/Fe.size,Mt.mapbox_clip_end=Fe.end/Fe.size}var it={geometry:Ke,type:Ve==="Polygon"||Ve==="MultiPolygon"?3:Ve==="LineString"||Ve==="MultiLineString"?2:1,tags:Mt};qe.id!==null&&(it.id=qe.id),Ne.features.push(it)}}function Nt(Ne,qe,pe,be,Fe,Ve){var Ke=be*be;if(be>0&&qe.size<(Fe?Ke:be))pe.numPoints+=qe.length/3;else{for(var Ge=[],ct=0;ct<qe.length;ct+=3)(be===0||qe[ct+2]>Ke)&&(pe.numSimplified++,Ge.push(qe[ct]),Ge.push(qe[ct+1])),pe.numPoints++;Fe&&function(st,Mt){for(var Ot=0,it=0,ht=st.length,jt=ht-2;it<ht;jt=it,it+=2)Ot+=(st[it]-st[jt])*(st[it+1]+st[jt+1]);if(Ot>0===Mt)for(it=0,ht=st.length;it<ht/2;it+=2){var kt=st[it],Pt=st[it+1];st[it]=st[ht-2-it],st[it+1]=st[ht-1-it],st[ht-2-it]=kt,st[ht-1-it]=Pt}}(Ge,Ve),Ne.push(Ge)}}function qt(Ne,qe){var pe=(qe=this.options=function(Fe,Ve){for(var Ke in Ve)Fe[Ke]=Ve[Ke];return Fe}(Object.create(this.options),qe)).debug;if(pe&&console.time("preprocess data"),qe.maxZoom<0||qe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(qe.promoteId&&qe.generateId)throw new Error("promoteId and generateId cannot be used together.");var be=function(Fe,Ve){var Ke=[];if(Fe.type==="FeatureCollection")for(var Ge=0;Ge<Fe.features.length;Ge++)ge(Ke,Fe.features[Ge],Ve,Ge);else Fe.type==="Feature"?ge(Ke,Fe,Ve):ge(Ke,{geometry:Fe},Ve);return Ke}(Ne,qe);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",qe.indexMaxZoom,qe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(be=function(Fe,Ve){var Ke=Ve.buffer/Ve.extent,Ge=Fe,ct=De(Fe,1,-1-Ke,Ke,0,-1,2,Ve),st=De(Fe,1,1-Ke,2+Ke,0,-1,2,Ve);return(ct||st)&&(Ge=De(Fe,1,-Ke,1+Ke,0,-1,2,Ve)||[],ct&&(Ge=xt(ct,1).concat(Ge)),st&&(Ge=Ge.concat(xt(st,-1)))),Ge}(be,qe)).length&&this.splitTile(be,0,0,0),pe&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Jt(Ne,qe,pe){return 32*((1<<Ne)*pe+qe)+Ne}function Wt(Ne,qe){var pe=Ne.tileID.canonical;if(!this._geoJSONIndex)return qe(null,null);var be=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!be)return qe(null,null);var Fe=new _(be.features),Ve=A(Fe);Ve.byteOffset===0&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),qe(null,{vectorTile:Fe,rawData:Ve.buffer})}J.prototype.load=function(Ne){var qe=this.options,pe=qe.log,be=qe.minZoom,Fe=qe.maxZoom,Ve=qe.nodeSize;pe&&console.time("total time");var Ke="prepare "+Ne.length+" points";pe&&console.time(Ke),this.points=Ne;for(var Ge=[],ct=0;ct<Ne.length;ct++)Ne[ct].geometry&&Ge.push(re(Ne[ct],ct));this.trees[Fe+1]=new B(Ge,Ae,fe,Ve,Float32Array),pe&&console.timeEnd(Ke);for(var st=Fe;st>=be;st--){var Mt=+Date.now();Ge=this._cluster(Ge,st),this.trees[st]=new B(Ge,Ae,fe,Ve,Float32Array),pe&&console.log("z%d: %d clusters in %dms",st,Ge.length,+Date.now()-Mt)}return pe&&console.timeEnd("total time"),this},J.prototype.getClusters=function(Ne,qe){var pe=((Ne[0]+180)%360+360)%360-180,be=Math.max(-90,Math.min(90,Ne[1])),Fe=Ne[2]===180?180:((Ne[2]+180)%360+360)%360-180,Ve=Math.max(-90,Math.min(90,Ne[3]));if(Ne[2]-Ne[0]>=360)pe=-180,Fe=180;else if(pe>Fe){var Ke=this.getClusters([pe,be,180,Ve],qe),Ge=this.getClusters([-180,be,Fe,Ve],qe);return Ke.concat(Ge)}for(var ct=this.trees[this._limitZoom(qe)],st=[],Mt=0,Ot=ct.range(de(pe),ce(Ve),de(Fe),ce(be));Mt<Ot.length;Mt+=1){var it=Ot[Mt],ht=ct.points[it];st.push(ht.numPoints?se(ht):this.points[ht.index])}return st},J.prototype.getChildren=function(Ne){var qe=this._getOriginId(Ne),pe=this._getOriginZoom(Ne),be="No cluster with the specified id.",Fe=this.trees[pe];if(!Fe)throw new Error(be);var Ve=Fe.points[qe];if(!Ve)throw new Error(be);for(var Ke=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Ge=[],ct=0,st=Fe.within(Ve.x,Ve.y,Ke);ct<st.length;ct+=1){var Mt=st[ct],Ot=Fe.points[Mt];Ot.parentId===Ne&&Ge.push(Ot.numPoints?se(Ot):this.points[Ot.index])}if(Ge.length===0)throw new Error(be);return Ge},J.prototype.getLeaves=function(Ne,qe,pe){qe=qe||10,pe=pe||0;var be=[];return this._appendLeaves(be,Ne,qe,pe,0),be},J.prototype.getTile=function(Ne,qe,pe){var be=this.trees[this._limitZoom(Ne)],Fe=Math.pow(2,Ne),Ve=this.options,Ke=Ve.extent,Ge=Ve.radius/Ke,ct=(pe-Ge)/Fe,st=(pe+1+Ge)/Fe,Mt={features:[]};return this._addTileFeatures(be.range((qe-Ge)/Fe,ct,(qe+1+Ge)/Fe,st),be.points,qe,pe,Fe,Mt),qe===0&&this._addTileFeatures(be.range(1-Ge/Fe,ct,1,st),be.points,Fe,pe,Fe,Mt),qe===Fe-1&&this._addTileFeatures(be.range(0,ct,Ge/Fe,st),be.points,-1,pe,Fe,Mt),Mt.features.length?Mt:null},J.prototype.getClusterExpansionZoom=function(Ne){for(var qe=this._getOriginZoom(Ne)-1;qe<=this.options.maxZoom;){var pe=this.getChildren(Ne);if(qe++,pe.length!==1)break;Ne=pe[0].properties.cluster_id}return qe},J.prototype._appendLeaves=function(Ne,qe,pe,be,Fe){for(var Ve=0,Ke=this.getChildren(qe);Ve<Ke.length;Ve+=1){var Ge=Ke[Ve],ct=Ge.properties;if(ct&&ct.cluster?Fe+ct.point_count<=be?Fe+=ct.point_count:Fe=this._appendLeaves(Ne,ct.cluster_id,pe,be,Fe):Fe<be?Fe++:Ne.push(Ge),Ne.length===pe)break}return Fe},J.prototype._addTileFeatures=function(Ne,qe,pe,be,Fe,Ve){for(var Ke=0,Ge=Ne;Ke<Ge.length;Ke+=1){var ct=qe[Ge[Ke]],st=ct.numPoints,Mt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*Fe-pe)),Math.round(this.options.extent*(ct.y*Fe-be))]],tags:st?oe(ct):this.points[ct.index].properties},Ot=void 0;st?Ot=ct.id:this.options.generateId?Ot=ct.index:this.points[ct.index].id&&(Ot=this.points[ct.index].id),Ot!==void 0&&(Mt.id=Ot),Ve.features.push(Mt)}},J.prototype._limitZoom=function(Ne){return Math.max(this.options.minZoom,Math.min(Ne,this.options.maxZoom+1))},J.prototype._cluster=function(Ne,qe){for(var pe=[],be=this.options,Fe=be.radius,Ve=be.extent,Ke=be.reduce,Ge=Fe/(Ve*Math.pow(2,qe)),ct=0;ct<Ne.length;ct++){var st=Ne[ct];if(!(st.zoom<=qe)){st.zoom=qe;for(var Mt=this.trees[qe+1],Ot=Mt.within(st.x,st.y,Ge),it=st.numPoints||1,ht=st.x*it,jt=st.y*it,kt=Ke&&it>1?this._map(st,!0):null,Pt=(ct<<5)+(qe+1)+this.points.length,Ee=0,Ze=Ot;Ee<Ze.length;Ee+=1){var at=Ze[Ee],pt=Mt.points[at];if(!(pt.zoom<=qe)){pt.zoom=qe;var St=pt.numPoints||1;ht+=pt.x*St,jt+=pt.y*St,it+=St,pt.parentId=Pt,Ke&&(kt||(kt=this._map(st,!0)),Ke(kt,this._map(pt)))}}it===1?pe.push(st):(st.parentId=Pt,pe.push(ee(ht/it,jt/it,Pt,it,kt)))}}return pe},J.prototype._getOriginId=function(Ne){return Ne-this.points.length>>5},J.prototype._getOriginZoom=function(Ne){return(Ne-this.points.length)%32},J.prototype._map=function(Ne,qe){if(Ne.numPoints)return qe?ve({},Ne.properties):Ne.properties;var pe=this.points[Ne.index].properties,be=this.options.map(pe);return qe&&be===pe?ve({},be):be},qt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qt.prototype.splitTile=function(Ne,qe,pe,be,Fe,Ve,Ke){for(var Ge=[Ne,qe,pe,be],ct=this.options,st=ct.debug;Ge.length;){be=Ge.pop(),pe=Ge.pop(),qe=Ge.pop(),Ne=Ge.pop();var Mt=1<<qe,Ot=Jt(qe,pe,be),it=this.tiles[Ot];if(!it&&(st>1&&console.time("creation"),it=this.tiles[Ot]=$e(Ne,qe,pe,be,ct),this.tileCoords.push({z:qe,x:pe,y:be}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",qe,pe,be,it.numFeatures,it.numPoints,it.numSimplified),console.timeEnd("creation"));var ht="z"+qe;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(it.source=Ne,Fe){if(qe===ct.maxZoom||qe===Fe)continue;var jt=1<<Fe-qe;if(pe!==Math.floor(Ve/jt)||be!==Math.floor(Ke/jt))continue}else if(qe===ct.indexMaxZoom||it.numPoints<=ct.indexMaxPoints)continue;if(it.source=null,Ne.length!==0){st>1&&console.time("clipping");var kt,Pt,Ee,Ze,at,pt,St=.5*ct.buffer/ct.extent,Ut=.5-St,Kt=.5+St,Ht=1+St;kt=Pt=Ee=Ze=null,at=De(Ne,Mt,pe-St,pe+Kt,0,it.minX,it.maxX,ct),pt=De(Ne,Mt,pe+Ut,pe+Ht,0,it.minX,it.maxX,ct),Ne=null,at&&(kt=De(at,Mt,be-St,be+Kt,1,it.minY,it.maxY,ct),Pt=De(at,Mt,be+Ut,be+Ht,1,it.minY,it.maxY,ct),at=null),pt&&(Ee=De(pt,Mt,be-St,be+Kt,1,it.minY,it.maxY,ct),Ze=De(pt,Mt,be+Ut,be+Ht,1,it.minY,it.maxY,ct),pt=null),st>1&&console.timeEnd("clipping"),Ge.push(kt||[],qe+1,2*pe,2*be),Ge.push(Pt||[],qe+1,2*pe,2*be+1),Ge.push(Ee||[],qe+1,2*pe+1,2*be),Ge.push(Ze||[],qe+1,2*pe+1,2*be+1)}}},qt.prototype.getTile=function(Ne,qe,pe){var be=this.options,Fe=be.extent,Ve=be.debug;if(Ne<0||Ne>24)return null;var Ke=1<<Ne,Ge=Jt(Ne,qe=(qe%Ke+Ke)%Ke,pe);if(this.tiles[Ge])return bt(this.tiles[Ge],Fe);Ve>1&&console.log("drilling down to z%d-%d-%d",Ne,qe,pe);for(var ct,st=Ne,Mt=qe,Ot=pe;!ct&&st>0;)st--,Mt=Math.floor(Mt/2),Ot=Math.floor(Ot/2),ct=this.tiles[Jt(st,Mt,Ot)];return ct&&ct.source?(Ve>1&&console.log("found parent tile z%d-%d-%d",st,Mt,Ot),Ve>1&&console.time("drilling down"),this.splitTile(ct.source,st,Mt,Ot,Ne,qe,pe),Ve>1&&console.timeEnd("drilling down"),this.tiles[Ge]?bt(this.tiles[Ge],Fe):null):null};var ar=function(Ne){function qe(pe,be,Fe,Ve){Ne.call(this,pe,be,Fe,Wt),Ve&&(this.loadGeoJSON=Ve)}return Ne&&(qe.__proto__=Ne),qe.prototype=Object.create(Ne&&Ne.prototype),qe.prototype.constructor=qe,qe.prototype.loadData=function(pe,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=be,this._pendingLoadDataParams=pe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},qe.prototype._loadData=function(){var pe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var be=this._pendingCallback,Fe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ve=!!(Fe&&Fe.request&&Fe.request.collectResourceTiming)&&new e.RequestPerformance(Fe.request);this.loadGeoJSON(Fe,function(Ke,Ge){if(Ke||!Ge)return be(Ke);if(typeof Ge!="object")return be(new Error("Input data given to '"+Fe.source+"' is not a valid GeoJSON object."));p(Ge,!0);try{pe._geoJSONIndex=Fe.cluster?new J(function(Mt){var Ot=Mt.superclusterOptions,it=Mt.clusterProperties;if(!it||!Ot)return Ot;for(var ht={},jt={},kt={accumulated:null,zoom:0},Pt={properties:null},Ee=Object.keys(it),Ze=0,at=Ee;Ze<at.length;Ze+=1){var pt=at[Ze],St=it[pt],Ut=St[0],Kt=St[1],Ht=e.createExpression(Kt),pr=e.createExpression(typeof Ut=="string"?[Ut,["accumulated"],["get",pt]]:Ut);ht[pt]=Ht.value,jt[pt]=pr.value}return Ot.map=function(Mr){Pt.properties=Mr;for(var hr={},Qt=0,tr=Ee;Qt<tr.length;Qt+=1){var rr=tr[Qt];hr[rr]=ht[rr].evaluate(kt,Pt)}return hr},Ot.reduce=function(Mr,hr){Pt.properties=hr;for(var Qt=0,tr=Ee;Qt<tr.length;Qt+=1){var rr=tr[Qt];kt.accumulated=Mr[rr],Mr[rr]=jt[rr].evaluate(kt,Pt)}},Ot}(Fe)).load(Ge.features):function(Mt,Ot){return new qt(Mt,Ot)}(Ge,Fe.geojsonVtOptions)}catch(Mt){return be(Mt)}pe.loaded={};var ct={};if(Ve){var st=Ve.finish();st&&(ct.resourceTiming={},ct.resourceTiming[Fe.source]=JSON.parse(JSON.stringify(st)))}be(null,ct)})}},qe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},qe.prototype.reloadTile=function(pe,be){var Fe=this.loaded,Ve=pe.uid;return Fe&&Fe[Ve]?Ne.prototype.reloadTile.call(this,pe,be):this.loadTile(pe,be)},qe.prototype.loadGeoJSON=function(pe,be){if(pe.request)e.getJSON(pe.request,be);else{if(typeof pe.data!="string")return be(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."));try{return be(null,JSON.parse(pe.data))}catch{return be(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."))}}},qe.prototype.removeSource=function(pe,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),be()},qe.prototype.getClusterExpansionZoom=function(pe,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Fe){be(Fe)}},qe.prototype.getClusterChildren=function(pe,be){try{be(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Fe){be(Fe)}},qe.prototype.getClusterLeaves=function(pe,be){try{be(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Fe){be(Fe)}},qe}(h),Dt=function(Ne){var qe=this;this.self=Ne,this.actor=new e.Actor(Ne,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:h,geojson:ar},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(pe,be){if(qe.workerSourceTypes[pe])throw new Error('Worker source with name "'+pe+'" already registered.');qe.workerSourceTypes[pe]=be},this.self.registerRTLTextPlugin=function(pe){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=pe.applyArabicShaping,e.plugin.processBidirectionalText=pe.processBidirectionalText,e.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}};return Dt.prototype.setReferrer=function(Ne,qe){this.referrer=qe},Dt.prototype.setImages=function(Ne,qe,pe){for(var be in this.availableImages[Ne]=qe,this.workerSources[Ne]){var Fe=this.workerSources[Ne][be];for(var Ve in Fe)Fe[Ve].availableImages=qe}pe()},Dt.prototype.setLayers=function(Ne,qe,pe){this.getLayerIndex(Ne).replace(qe),pe()},Dt.prototype.updateLayers=function(Ne,qe,pe){this.getLayerIndex(Ne).update(qe.layers,qe.removedIds),pe()},Dt.prototype.loadTile=function(Ne,qe,pe){this.getWorkerSource(Ne,qe.type,qe.source).loadTile(qe,pe)},Dt.prototype.loadDEMTile=function(Ne,qe,pe){this.getDEMWorkerSource(Ne,qe.source).loadTile(qe,pe)},Dt.prototype.reloadTile=function(Ne,qe,pe){this.getWorkerSource(Ne,qe.type,qe.source).reloadTile(qe,pe)},Dt.prototype.abortTile=function(Ne,qe,pe){this.getWorkerSource(Ne,qe.type,qe.source).abortTile(qe,pe)},Dt.prototype.removeTile=function(Ne,qe,pe){this.getWorkerSource(Ne,qe.type,qe.source).removeTile(qe,pe)},Dt.prototype.removeDEMTile=function(Ne,qe){this.getDEMWorkerSource(Ne,qe.source).removeTile(qe)},Dt.prototype.removeSource=function(Ne,qe,pe){if(this.workerSources[Ne]&&this.workerSources[Ne][qe.type]&&this.workerSources[Ne][qe.type][qe.source]){var be=this.workerSources[Ne][qe.type][qe.source];delete this.workerSources[Ne][qe.type][qe.source],be.removeSource!==void 0?be.removeSource(qe,pe):pe()}},Dt.prototype.loadWorkerSource=function(Ne,qe,pe){try{this.self.importScripts(qe.url),pe()}catch(be){pe(be.toString())}},Dt.prototype.syncRTLPluginState=function(Ne,qe,pe){try{e.plugin.setState(qe);var be=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&be!=null){this.self.importScripts(be);var Fe=e.plugin.isParsed();pe(Fe?void 0:new Error("RTL Text Plugin failed to import scripts from "+be),Fe)}}catch(Ve){pe(Ve.toString())}},Dt.prototype.getAvailableImages=function(Ne){var qe=this.availableImages[Ne];return qe||(qe=[]),qe},Dt.prototype.getLayerIndex=function(Ne){var qe=this.layerIndexes[Ne];return qe||(qe=this.layerIndexes[Ne]=new a),qe},Dt.prototype.getWorkerSource=function(Ne,qe,pe){var be=this;if(this.workerSources[Ne]||(this.workerSources[Ne]={}),this.workerSources[Ne][qe]||(this.workerSources[Ne][qe]={}),!this.workerSources[Ne][qe][pe]){var Fe={send:function(Ve,Ke,Ge){be.actor.send(Ve,Ke,Ge,Ne)}};this.workerSources[Ne][qe][pe]=new this.workerSourceTypes[qe](Fe,this.getLayerIndex(Ne),this.getAvailableImages(Ne))}return this.workerSources[Ne][qe][pe]},Dt.prototype.getDEMWorkerSource=function(Ne,qe){return this.demWorkerSources[Ne]||(this.demWorkerSources[Ne]={}),this.demWorkerSources[Ne][qe]||(this.demWorkerSources[Ne][qe]=new o),this.demWorkerSources[Ne][qe]},Dt.prototype.enforceCacheSizeLimit=function(Ne,qe){e.enforceCacheSizeLimit(qe)},typeof WorkerGlobalScope<"u"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Dt(e.window)),Dt}),y(0,function(e){var t=e.createCommonjsModule(function(C){function R(ae){return!F(ae)}function F(ae){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var he,xe,ke=new Blob([""],{type:"text/javascript"}),Le=URL.createObjectURL(ke);try{xe=new Worker(Le),he=!0}catch{he=!1}return xe&&xe.terminate(),URL.revokeObjectURL(Le),he}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var he=document.createElement("canvas");he.width=he.height=1;var xe=he.getContext("2d");if(!xe)return!1;var ke=xe.getImageData(0,0,1,1);return ke&&ke.width===he.width}()?function(he){return q[he]===void 0&&(q[he]=function(xe){var ke=function(He){var Je=document.createElement("canvas"),ot=Object.create(R.webGLContextAttributes);return ot.failIfMajorPerformanceCaveat=He,Je.probablySupportsContext?Je.probablySupportsContext("webgl",ot)||Je.probablySupportsContext("experimental-webgl",ot):Je.supportsContext?Je.supportsContext("webgl",ot)||Je.supportsContext("experimental-webgl",ot):Je.getContext("webgl",ot)||Je.getContext("experimental-webgl",ot)}(xe);if(!ke)return!1;var Le=ke.createShader(ke.VERTEX_SHADER);return!Le||ke.isContextLost()?!1:(ke.shaderSource(Le,"void main() {}"),ke.compileShader(Le),ke.getShaderParameter(Le,ke.COMPILE_STATUS)===!0)}(he)),q[he]}(ae&&ae.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}C.exports?C.exports=R:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=R,window.mapboxgl.notSupportedReason=F);var q={};R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),n={create:function(C,R,F){var q=e.window.document.createElement(C);return R!==void 0&&(q.className=R),F&&F.appendChild(q),q},createNS:function(C,R){return e.window.document.createElementNS(C,R)}},a=e.window.document.documentElement.style;function r(C){if(!a)return C[0];for(var R=0;R<C.length;R++)if(C[R]in a)return C[R];return C[0]}var g,u=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){a&&u&&(g=a[u],a[u]="none")},n.enableDrag=function(){a&&u&&(a[u]=g)};var s=r(["transform","WebkitTransform"]);n.setTransform=function(C,R){C.style[s]=R};var h=!1;try{var l=Object.defineProperty({},"passive",{get:function(){h=!0}});e.window.addEventListener("test",l,l),e.window.removeEventListener("test",l,l)}catch{h=!1}n.addEventListener=function(C,R,F,q){q===void 0&&(q={}),"passive"in q&&h?C.addEventListener(R,F,q):C.addEventListener(R,F,q.capture)},n.removeEventListener=function(C,R,F,q){q===void 0&&(q={}),"passive"in q&&h?C.removeEventListener(R,F,q):C.removeEventListener(R,F,q.capture)};var o=function(C){C.preventDefault(),C.stopPropagation(),e.window.removeEventListener("click",o,!0)};function p(C){var R=C.userImage;return R&&R.render&&R.render()?(C.data.replace(new Uint8Array(R.data.buffer)),!0):!1}n.suppressClick=function(){e.window.addEventListener("click",o,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",o,!0)},0)},n.mousePos=function(C,R){var F=C.getBoundingClientRect();return new e.Point(R.clientX-F.left-C.clientLeft,R.clientY-F.top-C.clientTop)},n.touchPos=function(C,R){for(var F=C.getBoundingClientRect(),q=[],ae=0;ae<R.length;ae++)q.push(new e.Point(R[ae].clientX-F.left-C.clientLeft,R[ae].clientY-F.top-C.clientTop));return q},n.mouseButton=function(C){return e.window.InstallTrigger!==void 0&&C.button===2&&C.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},n.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};var c=function(C){function R(){C.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.isLoaded=function(){return this.loaded},R.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var q=0,ae=this.requestors;q<ae.length;q+=1){var he=ae[q],xe=he.ids,ke=he.callback;this._notify(xe,ke)}this.requestors=[]}},R.prototype.getImage=function(F){return this.images[F]},R.prototype.addImage=function(F,q){this._validate(F,q)&&(this.images[F]=q)},R.prototype._validate=function(F,q){var ae=!0;return this._validateStretch(q.stretchX,q.data&&q.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ae=!1),this._validateStretch(q.stretchY,q.data&&q.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ae=!1),this._validateContent(q.content,q)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ae=!1),ae},R.prototype._validateStretch=function(F,q){if(!F)return!0;for(var ae=0,he=0,xe=F;he<xe.length;he+=1){var ke=xe[he];if(ke[0]<ae||ke[1]<ke[0]||q<ke[1])return!1;ae=ke[1]}return!0},R.prototype._validateContent=function(F,q){return!F||F.length===4&&!(F[0]<0||q.data.width<F[0])&&!(F[1]<0||q.data.height<F[1])&&!(F[2]<0||q.data.width<F[2])&&!(F[3]<0||q.data.height<F[3])&&!(F[2]<F[0])&&!(F[3]<F[1])},R.prototype.updateImage=function(F,q){var ae=this.images[F];q.version=ae.version+1,this.images[F]=q,this.updatedImages[F]=!0},R.prototype.removeImage=function(F){var q=this.images[F];delete this.images[F],delete this.patterns[F],q.userImage&&q.userImage.onRemove&&q.userImage.onRemove()},R.prototype.listImages=function(){return Object.keys(this.images)},R.prototype.getImages=function(F,q){var ae=!0;if(!this.isLoaded())for(var he=0,xe=F;he<xe.length;he+=1){var ke=xe[he];this.images[ke]||(ae=!1)}this.isLoaded()||ae?this._notify(F,q):this.requestors.push({ids:F,callback:q})},R.prototype._notify=function(F,q){for(var ae={},he=0,xe=F;he<xe.length;he+=1){var ke=xe[he];this.images[ke]||this.fire(new e.Event("styleimagemissing",{id:ke}));var Le=this.images[ke];Le?ae[ke]={data:Le.data.clone(),pixelRatio:Le.pixelRatio,sdf:Le.sdf,version:Le.version,stretchX:Le.stretchX,stretchY:Le.stretchY,content:Le.content,hasRenderCallback:Boolean(Le.userImage&&Le.userImage.render)}:e.warnOnce('Image "'+ke+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}q(null,ae)},R.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},R.prototype.getPattern=function(F){var q=this.patterns[F],ae=this.getImage(F);if(!ae)return null;if(q&&q.position.version===ae.version)return q.position;if(q)q.position.version=ae.version;else{var he={w:ae.data.width+2,h:ae.data.height+2,x:0,y:0},xe=new e.ImagePosition(he,ae);this.patterns[F]={bin:he,position:xe}}return this._updatePatternAtlas(),this.patterns[F].position},R.prototype.bind=function(F){var q=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,q.RGBA),this.atlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE)},R.prototype._updatePatternAtlas=function(){var F=[];for(var q in this.patterns)F.push(this.patterns[q].bin);var ae=e.potpack(F),he=ae.w,xe=ae.h,ke=this.atlasImage;for(var Le in ke.resize({width:he||1,height:xe||1}),this.patterns){var He=this.patterns[Le].bin,Je=He.x+1,ot=He.y+1,Tt=this.images[Le].data,Ct=Tt.width,At=Tt.height;e.RGBAImage.copy(Tt,ke,{x:0,y:0},{x:Je,y:ot},{width:Ct,height:At}),e.RGBAImage.copy(Tt,ke,{x:0,y:At-1},{x:Je,y:ot-1},{width:Ct,height:1}),e.RGBAImage.copy(Tt,ke,{x:0,y:0},{x:Je,y:ot+At},{width:Ct,height:1}),e.RGBAImage.copy(Tt,ke,{x:Ct-1,y:0},{x:Je-1,y:ot},{width:1,height:At}),e.RGBAImage.copy(Tt,ke,{x:0,y:0},{x:Je+Ct,y:ot},{width:1,height:At})}this.dirty=!0},R.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},R.prototype.dispatchRenderCallbacks=function(F){for(var q=0,ae=F;q<ae.length;q+=1){var he=ae[q];if(!this.callbackDispatchedThisFrame[he]){this.callbackDispatchedThisFrame[he]=!0;var xe=this.images[he];p(xe)&&this.updateImage(he,xe)}}},R}(e.Evented),i=_,x=_,f=1e20;function _(C,R,F,q,ae,he){this.fontSize=C||24,this.buffer=R===void 0?3:R,this.cutoff=q||.25,this.fontFamily=ae||"sans-serif",this.fontWeight=he||"normal",this.radius=F||8;var xe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=xe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(xe*xe),this.gridInner=new Float64Array(xe*xe),this.f=new Float64Array(xe),this.d=new Float64Array(xe),this.z=new Float64Array(xe+1),this.v=new Int16Array(xe),this.middle=Math.round(xe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function b(C,R,F,q,ae,he,xe){for(var ke=0;ke<R;ke++){for(var Le=0;Le<F;Le++)q[Le]=C[Le*R+ke];for(T(q,ae,he,xe,F),Le=0;Le<F;Le++)C[Le*R+ke]=ae[Le]}for(Le=0;Le<F;Le++){for(ke=0;ke<R;ke++)q[ke]=C[Le*R+ke];for(T(q,ae,he,xe,R),ke=0;ke<R;ke++)C[Le*R+ke]=Math.sqrt(ae[ke])}}function T(C,R,F,q,ae){F[0]=0,q[0]=-f,q[1]=+f;for(var he=1,xe=0;he<ae;he++){for(var ke=(C[he]+he*he-(C[F[xe]]+F[xe]*F[xe]))/(2*he-2*F[xe]);ke<=q[xe];)xe--,ke=(C[he]+he*he-(C[F[xe]]+F[xe]*F[xe]))/(2*he-2*F[xe]);F[++xe]=he,q[xe]=ke,q[xe+1]=+f}for(he=0,xe=0;he<ae;he++){for(;q[xe+1]<he;)xe++;R[he]=(he-F[xe])*(he-F[xe])+C[F[xe]]}}_.prototype.draw=function(C){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(C,this.buffer,this.middle);for(var R=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),q=0;q<this.size*this.size;q++){var ae=R.data[4*q+3]/255;this.gridOuter[q]=ae===1?0:ae===0?f:Math.pow(Math.max(0,.5-ae),2),this.gridInner[q]=ae===1?f:ae===0?0:Math.pow(Math.max(0,ae-.5),2)}for(b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),q=0;q<this.size*this.size;q++){var he=this.gridOuter[q]-this.gridInner[q];F[q]=Math.max(0,Math.min(255,Math.round(255-255*(he/this.radius+this.cutoff))))}return F},i.default=x;var k=function(C,R){this.requestManager=C,this.localIdeographFontFamily=R,this.entries={}};k.prototype.setURL=function(C){this.url=C},k.prototype.getGlyphs=function(C,R){var F=this,q=[];for(var ae in C)for(var he=0,xe=C[ae];he<xe.length;he+=1){var ke=xe[he];q.push({stack:ae,id:ke})}e.asyncAll(q,function(Le,He){var Je=Le.stack,ot=Le.id,Tt=F.entries[Je];Tt||(Tt=F.entries[Je]={glyphs:{},requests:{},ranges:{}});var Ct=Tt.glyphs[ot];if(Ct===void 0){if(Ct=F._tinySDF(Tt,Je,ot))return Tt.glyphs[ot]=Ct,void He(null,{stack:Je,id:ot,glyph:Ct});var At=Math.floor(ot/256);if(256*At>65535)He(new Error("glyphs > 65535 not supported"));else if(Tt.ranges[At])He(null,{stack:Je,id:ot,glyph:Ct});else{var Et=Tt.requests[At];Et||(Et=Tt.requests[At]=[],k.loadGlyphRange(Je,At,F.url,F.requestManager,function(_t,Ft){if(Ft){for(var zt in Ft)F._doesCharSupportLocalGlyph(+zt)||(Tt.glyphs[+zt]=Ft[+zt]);Tt.ranges[At]=!0}for(var Vt=0,ir=Et;Vt<ir.length;Vt+=1)(0,ir[Vt])(_t,Ft);delete Tt.requests[At]})),Et.push(function(_t,Ft){_t?He(_t):Ft&&He(null,{stack:Je,id:ot,glyph:Ft[ot]||null})})}}else He(null,{stack:Je,id:ot,glyph:Ct})},function(Le,He){if(Le)R(Le);else if(He){for(var Je={},ot=0,Tt=He;ot<Tt.length;ot+=1){var Ct=Tt[ot],At=Ct.stack,Et=Ct.id,_t=Ct.glyph;(Je[At]||(Je[At]={}))[Et]=_t&&{id:_t.id,bitmap:_t.bitmap.clone(),metrics:_t.metrics}}R(null,Je)}})},k.prototype._doesCharSupportLocalGlyph=function(C){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](C)||e.isChar["Hangul Syllables"](C)||e.isChar.Hiragana(C)||e.isChar.Katakana(C))},k.prototype._tinySDF=function(C,R,F){var q=this.localIdeographFontFamily;if(q&&this._doesCharSupportLocalGlyph(F)){var ae=C.tinySDF;if(!ae){var he="400";/bold/i.test(R)?he="900":/medium/i.test(R)?he="500":/light/i.test(R)&&(he="200"),ae=C.tinySDF=new k.TinySDF(24,3,8,.25,q,he)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ae.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},k.loadGlyphRange=function(C,R,F,q,ae){var he=256*R,xe=he+255,ke=q.transformRequest(q.normalizeGlyphsURL(F).replace("{fontstack}",C).replace("{range}",he+"-"+xe),e.ResourceType.Glyphs);e.getArrayBuffer(ke,function(Le,He){if(Le)ae(Le);else if(He){for(var Je={},ot=0,Tt=e.parseGlyphPBF(He);ot<Tt.length;ot+=1){var Ct=Tt[ot];Je[Ct.id]=Ct}ae(null,Je)}})},k.TinySDF=i;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(C,R){return e.sphericalToCartesian(C.expression.evaluate(R))},L.prototype.interpolate=function(C,R,F){return{x:e.number(C.x,R.x,F),y:e.number(C.y,R.y,F),z:e.number(C.z,R.z,F)}};var A=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),I=function(C){function R(F){C.call(this),this._transitionable=new e.Transitionable(A),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getLight=function(){return this._transitionable.serialize()},R.prototype.setLight=function(F,q){if(q===void 0&&(q={}),!this._validate(e.validateLight,F,q))for(var ae in F){var he=F[ae];e.endsWith(ae,"-transition")?this._transitionable.setTransition(ae.slice(0,-11),he):this._transitionable.setValue(ae,he)}},R.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},R.prototype.hasTransition=function(){return this._transitioning.hasTransition()},R.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},R.prototype._validate=function(F,q,ae){return(!ae||ae.validate!==!1)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:q,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},R}(e.Evented),P=function(C,R){this.width=C,this.height=R,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};P.prototype.getDash=function(C,R){var F=C.join(",")+String(R);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(C,R)),this.dashEntry[F]},P.prototype.getDashRanges=function(C,R,F){var q=[],ae=C.length%2==1?-C[C.length-1]*F:0,he=C[0]*F,xe=!0;q.push({left:ae,right:he,isDash:xe,zeroLength:C[0]===0});for(var ke=C[0],Le=1;Le<C.length;Le++){xe=!xe;var He=C[Le];ae=ke*F,he=(ke+=He)*F,q.push({left:ae,right:he,isDash:xe,zeroLength:He===0})}return q},P.prototype.addRoundDash=function(C,R,F){for(var q=R/2,ae=-F;ae<=F;ae++)for(var he=this.nextRow+F+ae,xe=this.width*he,ke=0,Le=C[ke],He=0;He<this.width;He++){He/Le.right>1&&(Le=C[++ke]);var Je=Math.abs(He-Le.left),ot=Math.abs(He-Le.right),Tt=Math.min(Je,ot),Ct=void 0,At=ae/F*(q+1);if(Le.isDash){var Et=q-Math.abs(At);Ct=Math.sqrt(Tt*Tt+Et*Et)}else Ct=q-Math.sqrt(Tt*Tt+At*At);this.data[xe+He]=Math.max(0,Math.min(255,Ct+128))}},P.prototype.addRegularDash=function(C){for(var R=C.length-1;R>=0;--R){var F=C[R],q=C[R+1];F.zeroLength?C.splice(R,1):q&&q.isDash===F.isDash&&(q.left=F.left,C.splice(R,1))}var ae=C[0],he=C[C.length-1];ae.isDash===he.isDash&&(ae.left=he.left-this.width,he.right=ae.right+this.width);for(var xe=this.width*this.nextRow,ke=0,Le=C[ke],He=0;He<this.width;He++){He/Le.right>1&&(Le=C[++ke]);var Je=Math.abs(He-Le.left),ot=Math.abs(He-Le.right),Tt=Math.min(Je,ot),Ct=Le.isDash?Tt:-Tt;this.data[xe+He]=Math.max(0,Math.min(255,Ct+128))}},P.prototype.addDash=function(C,R){var F=R?7:0,q=2*F+1;if(this.nextRow+q>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ae=0,he=0;he<C.length;he++)ae+=C[he];if(ae!==0){var xe=this.width/ae,ke=this.getDashRanges(C,this.width,xe);R?this.addRoundDash(ke,xe,F):this.addRegularDash(ke)}var Le={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ae};return this.nextRow+=q,this.dirty=!0,Le},P.prototype.bind=function(C){var R=C.gl;this.texture?(R.bindTexture(R.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,R.texSubImage2D(R.TEXTURE_2D,0,0,0,this.width,this.height,R.ALPHA,R.UNSIGNED_BYTE,this.data))):(this.texture=R.createTexture(),R.bindTexture(R.TEXTURE_2D,this.texture),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.ALPHA,this.width,this.height,0,R.ALPHA,R.UNSIGNED_BYTE,this.data))};var S=function C(R,F){this.workerPool=R,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var q=this.workerPool.acquire(this.id),ae=0;ae<q.length;ae++){var he=q[ae],xe=new C.Actor(he,F,this.id);xe.name="Worker "+ae,this.actors.push(xe)}};function E(C,R,F){var q=function(ae,he){if(ae)return F(ae);if(he){var xe=e.pick(e.extend(he,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);he.vector_layers&&(xe.vectorLayers=he.vector_layers,xe.vectorLayerIds=xe.vectorLayers.map(function(ke){return ke.id})),xe.tiles=R.canonicalizeTileset(xe,C.url),F(null,xe)}};return C.url?e.getJSON(R.transformRequest(R.normalizeSourceURL(C.url),e.ResourceType.Source),q):e.browser.frame(function(){return q(null,C)})}S.prototype.broadcast=function(C,R,F){F=F||function(){},e.asyncAll(this.actors,function(q,ae){q.send(C,R,ae)},F)},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(C){C.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var z=function(C,R,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(C)),this.minzoom=R||0,this.maxzoom=F||24};z.prototype.validateBounds=function(C){return Array.isArray(C)&&C.length===4?[Math.max(-180,C[0]),Math.max(-90,C[1]),Math.min(180,C[2]),Math.min(90,C[3])]:[-180,-90,180,90]},z.prototype.contains=function(C){var R=Math.pow(2,C.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*R),q=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*R),ae=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*R),he=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*R);return C.x>=F&&C.x<ae&&C.y>=q&&C.y<he};var D=function(C){function R(F,q,ae,he){if(C.call(this),this.id=F,this.dispatcher=ae,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(q,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},q),this._collectResourceTiming=q.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(he)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ae){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.loadTile=function(F,q){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),he={request:this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function xe(ke,Le){return delete F.request,F.aborted?q(null):ke&&ke.status!==404?q(ke):(Le&&Le.resourceTiming&&(F.resourceTiming=Le.resourceTiming),this.map._refreshExpiredTiles&&Le&&F.setExpiryData(Le),F.loadVectorData(Le,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),q(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}he.request.collectResourceTiming=this._collectResourceTiming,F.actor&&F.state!=="expired"?F.state==="loading"?F.reloadCallback=q:F.request=F.actor.send("reloadTile",he,xe.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",he,xe.bind(this)))},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.hasTransition=function(){return!1},R}(e.Evented),j=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.dispatcher=ae,this.setEventedParent(he),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},q),e.extend(this,e.pick(q,["url","scheme","tileSize"]))}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ae){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.loadTile=function(F,q){var ae=this,he=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(he,e.ResourceType.Tile),function(xe,ke){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(xe)F.state="errored",q(xe);else if(ke){ae.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Le=ae.map.painter.context,He=Le.gl;F.texture=ae.map.painter.getTileTexture(ke.width),F.texture?F.texture.update(ke,{useMipmap:!0}):(F.texture=new e.Texture(Le,ke,He.RGBA,{useMipmap:!0}),F.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE,He.LINEAR_MIPMAP_NEAREST),Le.extTextureFilterAnisotropic&&He.texParameterf(He.TEXTURE_2D,Le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Le.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ae.dispatcher),q(null)}})},R.prototype.abortTile=function(F,q){F.request&&(F.request.cancel(),delete F.request),q()},R.prototype.unloadTile=function(F,q){F.texture&&this.map.painter.saveTileTexture(F.texture),q()},R.prototype.hasTransition=function(){return!1},R}(e.Evented),V=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},q),this.encoding=q.encoding||"mapbox"}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},R.prototype.loadTile=function(F,q){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function he(xe,ke){xe&&(F.state="errored",q(xe)),ke&&(F.dem=ke,F.needsHillshadePrepare=!0,F.state="loaded",q(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),function(xe,ke){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(xe)F.state="errored",q(xe);else if(ke){this.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Le=e.window.ImageBitmap&&ke instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ke:e.browser.getImageData(ke,1),He={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Le,encoding:this.encoding};F.actor&&F.state!=="expired"||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",He,he.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},R.prototype._getNeighboringTiles=function(F){var q=F.canonical,ae=Math.pow(2,q.z),he=(q.x-1+ae)%ae,xe=q.x===0?F.wrap-1:F.wrap,ke=(q.x+1+ae)%ae,Le=q.x+1===ae?F.wrap+1:F.wrap,He={};return He[new e.OverscaledTileID(F.overscaledZ,xe,q.z,he,q.y).key]={backfilled:!1},He[new e.OverscaledTileID(F.overscaledZ,Le,q.z,ke,q.y).key]={backfilled:!1},q.y>0&&(He[new e.OverscaledTileID(F.overscaledZ,xe,q.z,he,q.y-1).key]={backfilled:!1},He[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y-1).key]={backfilled:!1},He[new e.OverscaledTileID(F.overscaledZ,Le,q.z,ke,q.y-1).key]={backfilled:!1}),q.y+1<ae&&(He[new e.OverscaledTileID(F.overscaledZ,xe,q.z,he,q.y+1).key]={backfilled:!1},He[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y+1).key]={backfilled:!1},He[new e.OverscaledTileID(F.overscaledZ,Le,q.z,ke,q.y+1).key]={backfilled:!1}),He},R.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},R}(j),Z=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ae.getActor(),this.setEventedParent(he),this._data=q.data,this._options=e.extend({},q),this._collectResourceTiming=q.collectResourceTiming,this._resourceTiming=[],q.maxzoom!==void 0&&(this.maxzoom=q.maxzoom),q.type&&(this.type=q.type),q.attribution&&(this.attribution=q.attribution),this.promoteId=q.promoteId;var xe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:q.cluster||!1,geojsonVtOptions:{buffer:(q.buffer!==void 0?q.buffer:128)*xe,tolerance:(q.tolerance!==void 0?q.tolerance:.375)*xe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:q.lineMetrics||!1,generateId:q.generateId||!1},superclusterOptions:{maxZoom:q.clusterMaxZoom!==void 0?Math.min(q.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(q.clusterRadius||50)*xe,log:!1,generateId:q.generateId||!1},clusterProperties:q.clusterProperties},q.workerOptions)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(q){if(q)F.fire(new e.ErrorEvent(q));else{var ae={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ae.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ae))}})},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setData=function(F){var q=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ae){if(ae)q.fire(new e.ErrorEvent(ae));else{var he={dataType:"source",sourceDataType:"content"};q._collectResourceTiming&&q._resourceTiming&&q._resourceTiming.length>0&&(he.resourceTiming=q._resourceTiming,q._resourceTiming=[]),q.fire(new e.Event("data",he))}}),this},R.prototype.getClusterExpansionZoom=function(F,q){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},q),this},R.prototype.getClusterChildren=function(F,q){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},q),this},R.prototype.getClusterLeaves=function(F,q,ae,he){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:q,offset:ae},he),this},R.prototype._updateWorkerData=function(F){var q=this;this._loaded=!1;var ae=e.extend({},this.workerOptions),he=this._data;typeof he=="string"?(ae.request=this.map._requestManager.transformRequest(e.browser.resolveURL(he),e.ResourceType.Source),ae.request.collectResourceTiming=this._collectResourceTiming):ae.data=JSON.stringify(he),this.actor.send(this.type+".loadData",ae,function(xe,ke){q._removed||ke&&ke.abandoned||(q._loaded=!0,ke&&ke.resourceTiming&&ke.resourceTiming[q.id]&&(q._resourceTiming=ke.resourceTiming[q.id].slice(0)),q.actor.send(q.type+".coalesce",{source:ae.source},null),F(xe))})},R.prototype.loaded=function(){return this._loaded},R.prototype.loadTile=function(F,q){var ae=this,he=F.actor?"reloadTile":"loadTile";F.actor=this.actor;var xe={type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};F.request=this.actor.send(he,xe,function(ke,Le){return delete F.request,F.unloadVectorData(),F.aborted?q(null):ke?q(ke):(F.loadVectorData(Le,ae.map.painter,he==="reloadTile"),q(null))})},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},R.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},R.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},R.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Q=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),K=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.dispatcher=ae,this.coordinates=q.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(he),this.options=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(F,q){var ae=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(he,xe){ae._loaded=!0,he?ae.fire(new e.ErrorEvent(he)):xe&&(ae.image=xe,F&&(ae.coordinates=F),q&&q(),ae._finishLoading())})},R.prototype.loaded=function(){return this._loaded},R.prototype.updateImage=function(F){var q=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){q.texture=null}),this):this},R.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setCoordinates=function(F){var q=this;this.coordinates=F;var ae=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(xe){for(var ke=1/0,Le=1/0,He=-1/0,Je=-1/0,ot=0,Tt=xe;ot<Tt.length;ot+=1){var Ct=Tt[ot];ke=Math.min(ke,Ct.x),Le=Math.min(Le,Ct.y),He=Math.max(He,Ct.x),Je=Math.max(Je,Ct.y)}var At=He-ke,Et=Je-Le,_t=Math.max(At,Et),Ft=Math.max(0,Math.floor(-Math.log(_t)/Math.LN2)),zt=Math.pow(2,Ft);return new e.CanonicalTileID(Ft,Math.floor((ke+He)/2*zt),Math.floor((Le+Je)/2*zt))}(ae),this.minzoom=this.maxzoom=this.tileID.z;var he=ae.map(function(xe){return q.tileID.getTilePoint(xe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(he[0].x,he[0].y,0,0),this._boundsArray.emplaceBack(he[1].x,he[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(he[3].x,he[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(he[2].x,he[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},R.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var F=this.map.painter.context,q=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var he=this.tiles[ae];he.state!=="loaded"&&(he.state="loaded",he.texture=this.texture)}}},R.prototype.loadTile=function(F,q){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},q(null)):(F.state="errored",q(null))},R.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return!1},R}(e.Evented),$=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),this.roundZoom=!0,this.type="video",this.options=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1;var q=this.options;this.urls=[];for(var ae=0,he=q.urls;ae<he.length;ae+=1){var xe=he[ae];this.urls.push(this.map._requestManager.transformRequest(xe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ke,Le){F._loaded=!0,ke?F.fire(new e.ErrorEvent(ke)):Le&&(F.video=Le,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},R.prototype.pause=function(){this.video&&this.video.pause()},R.prototype.play=function(){this.video&&this.video.play()},R.prototype.seek=function(F){if(this.video){var q=this.video.seekable;F<q.start(0)||F>q.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+q.start(0)+" and "+q.end(0)+"-second mark."))):this.video.currentTime=F}},R.prototype.getVideo=function(){return this.video},R.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},R.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var F=this.map.painter.context,q=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE),q.texSubImage2D(q.TEXTURE_2D,0,0,0,q.RGBA,q.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var he=this.tiles[ae];he.state!=="loaded"&&(he.state="loaded",he.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this.video&&!this.video.paused},R}(K),ne=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),q.coordinates?Array.isArray(q.coordinates)&&q.coordinates.length===4&&!q.coordinates.some(function(xe){return!Array.isArray(xe)||xe.length!==2||xe.some(function(ke){return typeof ke!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),q.animate&&typeof q.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),q.canvas?typeof q.canvas=="string"||q.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=q,this.animate=q.animate===void 0||q.animate}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},R.prototype.getCanvas=function(){return this.canvas},R.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},R.prototype.onRemove=function(){this.pause()},R.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var q=this.map.painter.context,ae=q.gl;for(var he in this.boundsBuffer||(this.boundsBuffer=q.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(q,this.canvas,ae.RGBA,{premultiply:!0}),this.tiles){var xe=this.tiles[he];xe.state!=="loaded"&&(xe.state="loaded",xe.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this._playing},R.prototype._hasInvalidDimensions=function(){for(var F=0,q=[this.canvas.width,this.canvas.height];F<q.length;F+=1){var ae=q[F];if(isNaN(ae)||ae<=0)return!0}return!1},R}(K),H={vector:D,raster:j,"raster-dem":V,geojson:Z,video:$,image:K,canvas:ne};function N(C,R){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*C.width,.5*C.height,1]),e.multiply(F,F,C.calculatePosMatrix(R.toUnwrapped()))}function U(C,R,F,q,ae,he){var xe=function(Et,_t,Ft){if(Et)for(var zt=0,Vt=Et;zt<Vt.length;zt+=1){var ir=_t[Vt[zt]];if(ir&&ir.source===Ft&&ir.type==="fill-extrusion")return!0}else for(var gr in _t){var Lr=_t[gr];if(Lr.source===Ft&&Lr.type==="fill-extrusion")return!0}return!1}(ae&&ae.layers,R,C.id),ke=he.maxPitchScaleFactor(),Le=C.tilesIn(q,ke,xe);Le.sort(te);for(var He=[],Je=0,ot=Le;Je<ot.length;Je+=1){var Tt=ot[Je];He.push({wrappedTileID:Tt.tileID.wrapped().key,queryResults:Tt.tile.queryRenderedFeatures(R,F,C._state,Tt.queryGeometry,Tt.cameraQueryGeometry,Tt.scale,ae,he,ke,N(C.transform,Tt.tileID))})}var Ct=function(Et){for(var _t={},Ft={},zt=0,Vt=Et;zt<Vt.length;zt+=1){var ir=Vt[zt],gr=ir.queryResults,Lr=ir.wrappedTileID,Ar=Ft[Lr]=Ft[Lr]||{};for(var $r in gr)for(var Jr=gr[$r],dn=Ar[$r]=Ar[$r]||{},ln=_t[$r]=_t[$r]||[],Vn=0,Xn=Jr;Vn<Xn.length;Vn+=1){var hi=Xn[Vn];dn[hi.featureIndex]||(dn[hi.featureIndex]=!0,ln.push(hi))}}return _t}(He);for(var At in Ct)Ct[At].forEach(function(Et){var _t=Et.feature,Ft=C.getFeatureState(_t.layer["source-layer"],_t.id);_t.source=_t.layer.source,_t.layer["source-layer"]&&(_t.sourceLayer=_t.layer["source-layer"]),_t.state=Ft});return Ct}function te(C,R){var F=C.tileID,q=R.tileID;return F.overscaledZ-q.overscaledZ||F.canonical.y-q.canonical.y||F.wrap-q.wrap||F.canonical.x-q.canonical.x}var B=function(C,R){this.max=C,this.onRemove=R,this.reset()};B.prototype.reset=function(){for(var C in this.data)for(var R=0,F=this.data[C];R<F.length;R+=1){var q=F[R];q.timeout&&clearTimeout(q.timeout),this.onRemove(q.value)}return this.data={},this.order=[],this},B.prototype.add=function(C,R,F){var q=this,ae=C.wrapped().key;this.data[ae]===void 0&&(this.data[ae]=[]);var he={value:R,timeout:void 0};if(F!==void 0&&(he.timeout=setTimeout(function(){q.remove(C,he)},F)),this.data[ae].push(he),this.order.push(ae),this.order.length>this.max){var xe=this._getAndRemoveByKey(this.order[0]);xe&&this.onRemove(xe)}return this},B.prototype.has=function(C){return C.wrapped().key in this.data},B.prototype.getAndRemove=function(C){return this.has(C)?this._getAndRemoveByKey(C.wrapped().key):null},B.prototype._getAndRemoveByKey=function(C){var R=this.data[C].shift();return R.timeout&&clearTimeout(R.timeout),this.data[C].length===0&&delete this.data[C],this.order.splice(this.order.indexOf(C),1),R.value},B.prototype.getByKey=function(C){var R=this.data[C];return R?R[0].value:null},B.prototype.get=function(C){return this.has(C)?this.data[C.wrapped().key][0].value:null},B.prototype.remove=function(C,R){if(!this.has(C))return this;var F=C.wrapped().key,q=R===void 0?0:this.data[F].indexOf(R),ae=this.data[F][q];return this.data[F].splice(q,1),ae.timeout&&clearTimeout(ae.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(ae.value),this.order.splice(this.order.indexOf(F),1),this},B.prototype.setMaxSize=function(C){for(this.max=C;this.order.length>this.max;){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},B.prototype.filter=function(C){var R=[];for(var F in this.data)for(var q=0,ae=this.data[F];q<ae.length;q+=1){var he=ae[q];C(he.value)||R.push(he)}for(var xe=0,ke=R;xe<ke.length;xe+=1){var Le=ke[xe];this.remove(Le.value.tileID,Le)}};var X=function(C,R,F){this.context=C;var q=C.gl;this.buffer=q.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),C.bindElementBuffer.set(this.buffer),q.bufferData(q.ELEMENT_ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?q.DYNAMIC_DRAW:q.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};X.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},X.prototype.updateData=function(C){var R=this.context.gl;this.context.unbindVAO(),this.bind(),R.bufferSubData(R.ELEMENT_ARRAY_BUFFER,0,C.arrayBuffer)},X.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ee=function(C,R,F,q){this.length=R.length,this.attributes=F,this.itemSize=R.bytesPerElement,this.dynamicDraw=q,this.context=C;var ae=C.gl;this.buffer=ae.createBuffer(),C.bindVertexBuffer.set(this.buffer),ae.bufferData(ae.ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?ae.DYNAMIC_DRAW:ae.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};ee.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ee.prototype.updateData=function(C){var R=this.context.gl;this.bind(),R.bufferSubData(R.ARRAY_BUFFER,0,C.arrayBuffer)},ee.prototype.enableAttributes=function(C,R){for(var F=0;F<this.attributes.length;F++){var q=this.attributes[F],ae=R.attributes[q.name];ae!==void 0&&C.enableVertexAttribArray(ae)}},ee.prototype.setVertexAttribPointers=function(C,R,F){for(var q=0;q<this.attributes.length;q++){var ae=this.attributes[q],he=R.attributes[ae.name];he!==void 0&&C.vertexAttribPointer(he,ae.components,C[J[ae.type]],!1,this.itemSize,ae.offset+this.itemSize*(F||0))}},ee.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var re=function(C){this.gl=C.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};re.prototype.get=function(){return this.current},re.prototype.set=function(C){},re.prototype.getDefault=function(){return this.default},re.prototype.setDefault=function(){this.set(this.default)};var se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(re),oe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 1},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},R}(re),de=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},R}(re),ce=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[!0,!0,!0,!0]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(re),ve=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},R}(re),Ae=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 255},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},R}(re),fe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},R.prototype.set=function(F){var q=this.current;(F.func!==q.func||F.ref!==q.ref||F.mask!==q.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},R}(re),me=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},R}(re),_e=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.STENCIL_TEST):q.disable(q.STENCIL_TEST),this.current=F,this.dirty=!1}},R}(re),le=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[0,1]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},R}(re),ge=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.DEPTH_TEST):q.disable(q.DEPTH_TEST),this.current=F,this.dirty=!1}},R}(re),Te=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.LESS},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},R}(re),Se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.BLEND):q.disable(q.BLEND),this.current=F,this.dirty=!1}},R}(re),Me=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},R}(re),ze=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(re),Oe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.FUNC_ADD},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},R}(re),De=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE),this.current=F,this.dirty=!1}},R}(re),Xe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.BACK},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},R}(re),Be=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.CCW},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},R}(re),Ie=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},R}(re),Re=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.TEXTURE0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},R}(re),Ye=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(re),Qe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindFramebuffer(q.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},R}(re),lt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindRenderbuffer(q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(re),xt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindTexture(q.TEXTURE_2D,F),this.current=F,this.dirty=!1}},R}(re),wt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindBuffer(q.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},R}(re),bt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){var q=this.gl;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},R}(re),nt=function(C){function R(F){C.call(this,F),this.vao=F.extVertexArrayObject}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},R}(re),$e=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 4},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},R}(re),vt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},R}(re),Nt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},R}(re),qt=function(C){function R(F,q){C.call(this,F),this.context=F,this.parent=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R}(re),Jt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.setDirty=function(){this.dirty=!0},R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},R}(qt),Wt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(qt),ar=function(C,R,F,q){this.context=C,this.width=R,this.height=F;var ae=C.gl,he=this.framebuffer=ae.createFramebuffer();this.colorAttachment=new Jt(C,he),q&&(this.depthAttachment=new Wt(C,he))};ar.prototype.destroy=function(){var C=this.context.gl,R=this.colorAttachment.get();if(R&&C.deleteTexture(R),this.depthAttachment){var F=this.depthAttachment.get();F&&C.deleteRenderbuffer(F)}C.deleteFramebuffer(this.framebuffer)};var Dt=function(C,R,F){this.func=C,this.mask=R,this.range=F};Dt.ReadOnly=!1,Dt.ReadWrite=!0,Dt.disabled=new Dt(519,Dt.ReadOnly,[0,1]);var Ne=function(C,R,F,q,ae,he){this.test=C,this.ref=R,this.mask=F,this.fail=q,this.depthFail=ae,this.pass=he};Ne.disabled=new Ne({func:519,mask:0},0,0,7680,7680,7680);var qe=function(C,R,F){this.blendFunction=C,this.blendColor=R,this.mask=F};qe.disabled=new qe(qe.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),qe.unblended=new qe(qe.Replace,e.Color.transparent,[!0,!0,!0,!0]),qe.alphaBlended=new qe([1,771],e.Color.transparent,[!0,!0,!0,!0]);var pe=function(C,R,F){this.enable=C,this.mode=R,this.frontFace=F};pe.disabled=new pe(!1,1029,2305),pe.backCCW=new pe(!0,1029,2305);var be=function(C){this.gl=C,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new se(this),this.clearDepth=new oe(this),this.clearStencil=new de(this),this.colorMask=new ce(this),this.depthMask=new ve(this),this.stencilMask=new Ae(this),this.stencilFunc=new fe(this),this.stencilOp=new me(this),this.stencilTest=new _e(this),this.depthRange=new le(this),this.depthTest=new ge(this),this.depthFunc=new Te(this),this.blend=new Se(this),this.blendFunc=new Me(this),this.blendColor=new ze(this),this.blendEquation=new Oe(this),this.cullFace=new De(this),this.cullFaceSide=new Xe(this),this.frontFace=new Be(this),this.program=new Ie(this),this.activeTexture=new Re(this),this.viewport=new Ye(this),this.bindFramebuffer=new Qe(this),this.bindRenderbuffer=new lt(this),this.bindTexture=new xt(this),this.bindVertexBuffer=new wt(this),this.bindElementBuffer=new bt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new nt(this),this.pixelStoreUnpack=new $e(this),this.pixelStoreUnpackPremultiplyAlpha=new vt(this),this.pixelStoreUnpackFlipY=new Nt(this),this.extTextureFilterAnisotropic=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=C.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=C.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(C.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=C.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=C.getExtension("EXT_disjoint_timer_query")};be.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},be.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},be.prototype.createIndexBuffer=function(C,R){return new X(this,C,R)},be.prototype.createVertexBuffer=function(C,R,F){return new ee(this,C,R,F)},be.prototype.createRenderbuffer=function(C,R,F){var q=this.gl,ae=q.createRenderbuffer();return this.bindRenderbuffer.set(ae),q.renderbufferStorage(q.RENDERBUFFER,C,R,F),this.bindRenderbuffer.set(null),ae},be.prototype.createFramebuffer=function(C,R,F){return new ar(this,C,R,F)},be.prototype.clear=function(C){var R=C.color,F=C.depth,q=this.gl,ae=0;R&&(ae|=q.COLOR_BUFFER_BIT,this.clearColor.set(R),this.colorMask.set([!0,!0,!0,!0])),F!==void 0&&(ae|=q.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),q.clear(ae)},be.prototype.setCullFace=function(C){C.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(C.mode),this.frontFace.set(C.frontFace))},be.prototype.setDepthMode=function(C){C.func!==this.gl.ALWAYS||C.mask?(this.depthTest.set(!0),this.depthFunc.set(C.func),this.depthMask.set(C.mask),this.depthRange.set(C.range)):this.depthTest.set(!1)},be.prototype.setStencilMode=function(C){C.test.func!==this.gl.ALWAYS||C.mask?(this.stencilTest.set(!0),this.stencilMask.set(C.mask),this.stencilOp.set([C.fail,C.depthFail,C.pass]),this.stencilFunc.set({func:C.test.func,ref:C.ref,mask:C.test.mask})):this.stencilTest.set(!1)},be.prototype.setColorMode=function(C){e.deepEqual(C.blendFunction,qe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(C.blendFunction),this.blendColor.set(C.blendColor)),this.colorMask.set(C.mask)},be.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Fe=function(C){function R(F,q,ae){var he=this;C.call(this),this.id=F,this.dispatcher=ae,this.on("data",function(xe){xe.dataType==="source"&&xe.sourceDataType==="metadata"&&(he._sourceLoaded=!0),he._sourceLoaded&&!he._paused&&xe.dataType==="source"&&xe.sourceDataType==="content"&&(he.reload(),he.transform&&he.update(he.transform))}),this.on("error",function(){he._sourceErrored=!0}),this._source=function(xe,ke,Le,He){var Je=new H[ke.type](xe,ke,Le,He);if(Je.id!==xe)throw new Error("Expected Source id to be "+xe+" instead of "+Je.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Je),Je}(F,q,ae,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},R.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},R.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var q=this._tiles[F];if(q.state!=="loaded"&&q.state!=="errored")return!1}return!0},R.prototype.getSource=function(){return this._source},R.prototype.pause=function(){this._paused=!0},R.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},R.prototype._loadTile=function(F,q){return this._source.loadTile(F,q)},R.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},R.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},R.prototype.serialize=function(){return this._source.serialize()},R.prototype.prepare=function(F){for(var q in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ae=this._tiles[q];ae.upload(F),ae.prepare(this.map.style.imageManager)}},R.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(Ve).map(function(F){return F.key})},R.prototype.getRenderableIds=function(F){var q=this,ae=[];for(var he in this._tiles)this._isIdRenderable(he,F)&&ae.push(this._tiles[he]);return F?ae.sort(function(xe,ke){var Le=xe.tileID,He=ke.tileID,Je=new e.Point(Le.canonical.x,Le.canonical.y)._rotate(q.transform.angle),ot=new e.Point(He.canonical.x,He.canonical.y)._rotate(q.transform.angle);return Le.overscaledZ-He.overscaledZ||ot.y-Je.y||ot.x-Je.x}).map(function(xe){return xe.tileID.key}):ae.map(function(xe){return xe.tileID}).sort(Ve).map(function(xe){return xe.key})},R.prototype.hasRenderableParent=function(F){var q=this.findLoadedParent(F,0);return!!q&&this._isIdRenderable(q.tileID.key)},R.prototype._isIdRenderable=function(F,q){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(q||!this._tiles[F].holdingForFade())},R.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)this._tiles[F].state!=="errored"&&this._reloadTile(F,"reloading")},R.prototype._reloadTile=function(F,q){var ae=this._tiles[F];ae&&(ae.state!=="loading"&&(ae.state=q),this._loadTile(ae,this._tileLoaded.bind(this,ae,F,q)))},R.prototype._tileLoaded=function(F,q,ae,he){if(he)return F.state="errored",void(he.status!==404?this._source.fire(new e.ErrorEvent(he,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),ae==="expired"&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(q,F),this.getSource().type==="raster-dem"&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},R.prototype._backfillDEM=function(F){for(var q=this.getRenderableIds(),ae=0;ae<q.length;ae++){var he=q[ae];if(F.neighboringTiles&&F.neighboringTiles[he]){var xe=this.getTileByID(he);ke(F,xe),ke(xe,F)}}function ke(Le,He){Le.needsHillshadePrepare=!0;var Je=He.tileID.canonical.x-Le.tileID.canonical.x,ot=He.tileID.canonical.y-Le.tileID.canonical.y,Tt=Math.pow(2,Le.tileID.canonical.z),Ct=He.tileID.key;Je===0&&ot===0||Math.abs(ot)>1||(Math.abs(Je)>1&&(Math.abs(Je+Tt)===1?Je+=Tt:Math.abs(Je-Tt)===1&&(Je-=Tt)),He.dem&&Le.dem&&(Le.dem.backfillBorder(He.dem,Je,ot),Le.neighboringTiles&&Le.neighboringTiles[Ct]&&(Le.neighboringTiles[Ct].backfilled=!0)))}},R.prototype.getTile=function(F){return this.getTileByID(F.key)},R.prototype.getTileByID=function(F){return this._tiles[F]},R.prototype._retainLoadedChildren=function(F,q,ae,he){for(var xe in this._tiles){var ke=this._tiles[xe];if(!(he[xe]||!ke.hasData()||ke.tileID.overscaledZ<=q||ke.tileID.overscaledZ>ae)){for(var Le=ke.tileID;ke&&ke.tileID.overscaledZ>q+1;){var He=ke.tileID.scaledTo(ke.tileID.overscaledZ-1);(ke=this._tiles[He.key])&&ke.hasData()&&(Le=He)}for(var Je=Le;Je.overscaledZ>q;)if(F[(Je=Je.scaledTo(Je.overscaledZ-1)).key]){he[Le.key]=Le;break}}}},R.prototype.findLoadedParent=function(F,q){if(F.key in this._loadedParentTiles){var ae=this._loadedParentTiles[F.key];return ae&&ae.tileID.overscaledZ>=q?ae:null}for(var he=F.overscaledZ-1;he>=q;he--){var xe=F.scaledTo(he),ke=this._getLoadedTile(xe);if(ke)return ke}},R.prototype._getLoadedTile=function(F){var q=this._tiles[F.key];return q&&q.hasData()?q:this._cache.getByKey(F.wrapped().key)},R.prototype.updateCacheSize=function(F){var q=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ae=Math.floor(5*q),he=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ae):ae;this._cache.setMaxSize(he)},R.prototype.handleWrapJump=function(F){var q=(F-(this._prevLng===void 0?F:this._prevLng))/360,ae=Math.round(q);if(this._prevLng=F,ae){var he={};for(var xe in this._tiles){var ke=this._tiles[xe];ke.tileID=ke.tileID.unwrapTo(ke.tileID.wrap+ae),he[ke.tileID.key]=ke}for(var Le in this._tiles=he,this._timers)clearTimeout(this._timers[Le]),delete this._timers[Le];for(var He in this._tiles){var Je=this._tiles[He];this._setTileReloadTimer(He,Je)}}},R.prototype.update=function(F){var q=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ae;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ae=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ar){return new e.OverscaledTileID(Ar.canonical.z,Ar.wrap,Ar.canonical.z,Ar.canonical.x,Ar.canonical.y)}):(ae=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ae=ae.filter(function(Ar){return q._source.hasTile(Ar)}))):ae=[];var he=F.coveringZoomLevel(this._source),xe=Math.max(he-R.maxOverzooming,this._source.minzoom),ke=Math.max(he+R.maxUnderzooming,this._source.minzoom),Le=this._updateRetainedTiles(ae,he);if(Ke(this._source.type)){for(var He={},Je={},ot=0,Tt=Object.keys(Le);ot<Tt.length;ot+=1){var Ct=Tt[ot],At=Le[Ct],Et=this._tiles[Ct];if(Et&&!(Et.fadeEndTime&&Et.fadeEndTime<=e.browser.now())){var _t=this.findLoadedParent(At,xe);_t&&(this._addTile(_t.tileID),He[_t.tileID.key]=_t.tileID),Je[Ct]=At}}for(var Ft in this._retainLoadedChildren(Je,he,ke,Le),He)Le[Ft]||(this._coveredTiles[Ft]=!0,Le[Ft]=He[Ft])}for(var zt in Le)this._tiles[zt].clearFadeHold();for(var Vt=0,ir=e.keysDifference(this._tiles,Le);Vt<ir.length;Vt+=1){var gr=ir[Vt],Lr=this._tiles[gr];Lr.hasSymbolBuckets&&!Lr.holdingForFade()?Lr.setHoldDuration(this.map._fadeDuration):Lr.hasSymbolBuckets&&!Lr.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},R.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},R.prototype._updateRetainedTiles=function(F,q){for(var ae={},he={},xe=Math.max(q-R.maxOverzooming,this._source.minzoom),ke=Math.max(q+R.maxUnderzooming,this._source.minzoom),Le={},He=0,Je=F;He<Je.length;He+=1){var ot=Je[He],Tt=this._addTile(ot);ae[ot.key]=ot,Tt.hasData()||q<this._source.maxzoom&&(Le[ot.key]=ot)}this._retainLoadedChildren(Le,q,ke,ae);for(var Ct=0,At=F;Ct<At.length;Ct+=1){var Et=At[Ct],_t=this._tiles[Et.key];if(!_t.hasData()){if(q+1>this._source.maxzoom){var Ft=Et.children(this._source.maxzoom)[0],zt=this.getTile(Ft);if(zt&&zt.hasData()){ae[Ft.key]=Ft;continue}}else{var Vt=Et.children(this._source.maxzoom);if(ae[Vt[0].key]&&ae[Vt[1].key]&&ae[Vt[2].key]&&ae[Vt[3].key])continue}for(var ir=_t.wasRequested(),gr=Et.overscaledZ-1;gr>=xe;--gr){var Lr=Et.scaledTo(gr);if(he[Lr.key]||(he[Lr.key]=!0,!(_t=this.getTile(Lr))&&ir&&(_t=this._addTile(Lr)),_t&&(ae[Lr.key]=Lr,ir=_t.wasRequested(),_t.hasData())))break}}}return ae},R.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var q=[],ae=void 0,he=this._tiles[F].tileID;he.overscaledZ>0;){if(he.key in this._loadedParentTiles){ae=this._loadedParentTiles[he.key];break}q.push(he.key);var xe=he.scaledTo(he.overscaledZ-1);if(ae=this._getLoadedTile(xe))break;he=xe}for(var ke=0,Le=q;ke<Le.length;ke+=1){var He=Le[ke];this._loadedParentTiles[He]=ae}}},R.prototype._addTile=function(F){var q=this._tiles[F.key];if(q)return q;(q=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,q),q.tileID=F,this._state.initializeTileState(q,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,q)));var ae=Boolean(q);return ae||(q=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(q,this._tileLoaded.bind(this,q,F.key,q.state))),q?(q.uses++,this._tiles[F.key]=q,ae||this._source.fire(new e.Event("dataloading",{tile:q,coord:q.tileID,dataType:"source"})),q):null},R.prototype._setTileReloadTimer=function(F,q){var ae=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var he=q.getExpiryTimeout();he&&(this._timers[F]=setTimeout(function(){ae._reloadTile(F,"expired"),delete ae._timers[F]},he))},R.prototype._removeTile=function(F){var q=this._tiles[F];q&&(q.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),q.uses>0||(q.hasData()&&q.state!=="reloading"?this._cache.add(q.tileID,q,q.getExpiryTimeout()):(q.aborted=!0,this._abortTile(q),this._unloadTile(q))))},R.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},R.prototype.tilesIn=function(F,q,ae){var he=this,xe=[],ke=this.transform;if(!ke)return xe;for(var Le=ae?ke.getCameraQueryGeometry(F):F,He=F.map(function(gr){return ke.pointCoordinate(gr)}),Je=Le.map(function(gr){return ke.pointCoordinate(gr)}),ot=this.getIds(),Tt=1/0,Ct=1/0,At=-1/0,Et=-1/0,_t=0,Ft=Je;_t<Ft.length;_t+=1){var zt=Ft[_t];Tt=Math.min(Tt,zt.x),Ct=Math.min(Ct,zt.y),At=Math.max(At,zt.x),Et=Math.max(Et,zt.y)}for(var Vt=function(gr){var Lr=he._tiles[ot[gr]];if(!Lr.holdingForFade()){var Ar=Lr.tileID,$r=Math.pow(2,ke.zoom-Lr.tileID.overscaledZ),Jr=q*Lr.queryPadding*e.EXTENT/Lr.tileSize/$r,dn=[Ar.getTilePoint(new e.MercatorCoordinate(Tt,Ct)),Ar.getTilePoint(new e.MercatorCoordinate(At,Et))];if(dn[0].x-Jr<e.EXTENT&&dn[0].y-Jr<e.EXTENT&&dn[1].x+Jr>=0&&dn[1].y+Jr>=0){var ln=He.map(function(Xn){return Ar.getTilePoint(Xn)}),Vn=Je.map(function(Xn){return Ar.getTilePoint(Xn)});xe.push({tile:Lr,tileID:Ar,queryGeometry:ln,cameraQueryGeometry:Vn,scale:$r})}}},ir=0;ir<ot.length;ir++)Vt(ir);return xe},R.prototype.getVisibleCoordinates=function(F){for(var q=this,ae=this.getRenderableIds(F).map(function(Le){return q._tiles[Le].tileID}),he=0,xe=ae;he<xe.length;he+=1){var ke=xe[he];ke.posMatrix=this.transform.calculatePosMatrix(ke.toUnwrapped())}return ae},R.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ke(this._source.type))for(var F in this._tiles){var q=this._tiles[F];if(q.fadeEndTime!==void 0&&q.fadeEndTime>=e.browser.now())return!0}return!1},R.prototype.setFeatureState=function(F,q,ae){F=F||"_geojsonTileLayer",this._state.updateState(F,q,ae)},R.prototype.removeFeatureState=function(F,q,ae){F=F||"_geojsonTileLayer",this._state.removeFeatureState(F,q,ae)},R.prototype.getFeatureState=function(F,q){return F=F||"_geojsonTileLayer",this._state.getState(F,q)},R.prototype.setDependencies=function(F,q,ae){var he=this._tiles[F];he&&he.setDependencies(q,ae)},R.prototype.reloadTilesForDependencies=function(F,q){for(var ae in this._tiles)this._tiles[ae].hasDependency(F,q)&&this._reloadTile(ae,"reloading");this._cache.filter(function(he){return!he.hasDependency(F,q)})},R}(e.Evented);function Ve(C,R){var F=Math.abs(2*C.wrap)-+(C.wrap<0),q=Math.abs(2*R.wrap)-+(R.wrap<0);return C.overscaledZ-R.overscaledZ||q-F||R.canonical.y-C.canonical.y||R.canonical.x-C.canonical.x}function Ke(C){return C==="raster"||C==="image"||C==="video"}function Ge(){return new e.window.Worker(ue.workerUrl)}Fe.maxOverzooming=10,Fe.maxUnderzooming=3;var ct="mapboxgl_preloaded_worker_pool",st=function(){this.active={}};st.prototype.acquire=function(C){if(!this.workers)for(this.workers=[];this.workers.length<st.workerCount;)this.workers.push(new Ge);return this.active[C]=!0,this.workers.slice()},st.prototype.release=function(C){delete this.active[C],this.numActive()===0&&(this.workers.forEach(function(R){R.terminate()}),this.workers=null)},st.prototype.isPreloaded=function(){return!!this.active[ct]},st.prototype.numActive=function(){return Object.keys(this.active).length};var Mt,Ot=Math.floor(e.browser.hardwareConcurrency/2);function it(){return Mt||(Mt=new st),Mt}function ht(C,R){var F={};for(var q in C)q!=="ref"&&(F[q]=C[q]);return e.refProperties.forEach(function(ae){ae in R&&(F[ae]=R[ae])}),F}function jt(C){C=C.slice();for(var R=Object.create(null),F=0;F<C.length;F++)R[C[F].id]=C[F];for(var q=0;q<C.length;q++)"ref"in C[q]&&(C[q]=ht(C[q],R[C[q].ref]));return C}st.workerCount=Math.max(Math.min(Ot,6),1);var kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Pt(C,R,F){F.push({command:kt.addSource,args:[C,R[C]]})}function Ee(C,R,F){R.push({command:kt.removeSource,args:[C]}),F[C]=!0}function Ze(C,R,F,q){Ee(C,F,q),Pt(C,R,F)}function at(C,R,F){var q;for(q in C[F])if(C[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],R[F][q]))return!1;for(q in R[F])if(R[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],R[F][q]))return!1;return!0}function pt(C,R,F,q,ae,he){var xe;for(xe in R=R||{},C=C||{})C.hasOwnProperty(xe)&&(e.deepEqual(C[xe],R[xe])||F.push({command:he,args:[q,xe,R[xe],ae]}));for(xe in R)R.hasOwnProperty(xe)&&!C.hasOwnProperty(xe)&&(e.deepEqual(C[xe],R[xe])||F.push({command:he,args:[q,xe,R[xe],ae]}))}function St(C){return C.id}function Ut(C,R){return C[R.id]=R,C}function Kt(C,R){if(!C)return[{command:kt.setStyle,args:[R]}];var F=[];try{if(!e.deepEqual(C.version,R.version))return[{command:kt.setStyle,args:[R]}];e.deepEqual(C.center,R.center)||F.push({command:kt.setCenter,args:[R.center]}),e.deepEqual(C.zoom,R.zoom)||F.push({command:kt.setZoom,args:[R.zoom]}),e.deepEqual(C.bearing,R.bearing)||F.push({command:kt.setBearing,args:[R.bearing]}),e.deepEqual(C.pitch,R.pitch)||F.push({command:kt.setPitch,args:[R.pitch]}),e.deepEqual(C.sprite,R.sprite)||F.push({command:kt.setSprite,args:[R.sprite]}),e.deepEqual(C.glyphs,R.glyphs)||F.push({command:kt.setGlyphs,args:[R.glyphs]}),e.deepEqual(C.transition,R.transition)||F.push({command:kt.setTransition,args:[R.transition]}),e.deepEqual(C.light,R.light)||F.push({command:kt.setLight,args:[R.light]});var q={},ae=[];(function(xe,ke,Le,He){var Je;for(Je in ke=ke||{},xe=xe||{})xe.hasOwnProperty(Je)&&(ke.hasOwnProperty(Je)||Ee(Je,Le,He));for(Je in ke)ke.hasOwnProperty(Je)&&(xe.hasOwnProperty(Je)?e.deepEqual(xe[Je],ke[Je])||(xe[Je].type==="geojson"&&ke[Je].type==="geojson"&&at(xe,ke,Je)?Le.push({command:kt.setGeoJSONSourceData,args:[Je,ke[Je].data]}):Ze(Je,ke,Le,He)):Pt(Je,ke,Le))})(C.sources,R.sources,ae,q);var he=[];C.layers&&C.layers.forEach(function(xe){q[xe.source]?F.push({command:kt.removeLayer,args:[xe.id]}):he.push(xe)}),F=F.concat(ae),function(xe,ke,Le){ke=ke||[];var He,Je,ot,Tt,Ct,At,Et,_t=(xe=xe||[]).map(St),Ft=ke.map(St),zt=xe.reduce(Ut,{}),Vt=ke.reduce(Ut,{}),ir=_t.slice(),gr=Object.create(null);for(He=0,Je=0;He<_t.length;He++)ot=_t[He],Vt.hasOwnProperty(ot)?Je++:(Le.push({command:kt.removeLayer,args:[ot]}),ir.splice(ir.indexOf(ot,Je),1));for(He=0,Je=0;He<Ft.length;He++)ot=Ft[Ft.length-1-He],ir[ir.length-1-He]!==ot&&(zt.hasOwnProperty(ot)?(Le.push({command:kt.removeLayer,args:[ot]}),ir.splice(ir.lastIndexOf(ot,ir.length-Je),1)):Je++,At=ir[ir.length-He],Le.push({command:kt.addLayer,args:[Vt[ot],At]}),ir.splice(ir.length-He,0,ot),gr[ot]=!0);for(He=0;He<Ft.length;He++)if(Tt=zt[ot=Ft[He]],Ct=Vt[ot],!gr[ot]&&!e.deepEqual(Tt,Ct))if(e.deepEqual(Tt.source,Ct.source)&&e.deepEqual(Tt["source-layer"],Ct["source-layer"])&&e.deepEqual(Tt.type,Ct.type)){for(Et in pt(Tt.layout,Ct.layout,Le,ot,null,kt.setLayoutProperty),pt(Tt.paint,Ct.paint,Le,ot,null,kt.setPaintProperty),e.deepEqual(Tt.filter,Ct.filter)||Le.push({command:kt.setFilter,args:[ot,Ct.filter]}),e.deepEqual(Tt.minzoom,Ct.minzoom)&&e.deepEqual(Tt.maxzoom,Ct.maxzoom)||Le.push({command:kt.setLayerZoomRange,args:[ot,Ct.minzoom,Ct.maxzoom]}),Tt)Tt.hasOwnProperty(Et)&&Et!=="layout"&&Et!=="paint"&&Et!=="filter"&&Et!=="metadata"&&Et!=="minzoom"&&Et!=="maxzoom"&&(Et.indexOf("paint.")===0?pt(Tt[Et],Ct[Et],Le,ot,Et.slice(6),kt.setPaintProperty):e.deepEqual(Tt[Et],Ct[Et])||Le.push({command:kt.setLayerProperty,args:[ot,Et,Ct[Et]]}));for(Et in Ct)Ct.hasOwnProperty(Et)&&!Tt.hasOwnProperty(Et)&&Et!=="layout"&&Et!=="paint"&&Et!=="filter"&&Et!=="metadata"&&Et!=="minzoom"&&Et!=="maxzoom"&&(Et.indexOf("paint.")===0?pt(Tt[Et],Ct[Et],Le,ot,Et.slice(6),kt.setPaintProperty):e.deepEqual(Tt[Et],Ct[Et])||Le.push({command:kt.setLayerProperty,args:[ot,Et,Ct[Et]]}))}else Le.push({command:kt.removeLayer,args:[ot]}),At=ir[ir.lastIndexOf(ot)+1],Le.push({command:kt.addLayer,args:[Ct,At]})}(he,R.layers,F)}catch(xe){console.warn("Unable to compute style diff:",xe),F=[{command:kt.setStyle,args:[R]}]}return F}var Ht=function(C,R){this.reset(C,R)};Ht.prototype.reset=function(C,R){this.points=C||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(R||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ht.prototype.lerp=function(C){if(this.points.length===1)return this.points[0];C=e.clamp(C,0,1);for(var R=1,F=this._distances[R],q=C*this.paddedLength+this.padding;F<q&&R<this._distances.length;)F=this._distances[++R];var ae=R-1,he=this._distances[ae],xe=F-he,ke=xe>0?(q-he)/xe:0;return this.points[ae].mult(1-ke).add(this.points[R].mult(ke))};var pr=function(C,R,F){var q=this.boxCells=[],ae=this.circleCells=[];this.xCellCount=Math.ceil(C/F),this.yCellCount=Math.ceil(R/F);for(var he=0;he<this.xCellCount*this.yCellCount;he++)q.push([]),ae.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=C,this.height=R,this.xScale=this.xCellCount/C,this.yScale=this.yCellCount/R,this.boxUid=0,this.circleUid=0};function Mr(C,R,F,q,ae){var he=e.create();return R?(e.scale(he,he,[1/ae,1/ae,1]),F||e.rotateZ(he,he,q.angle)):e.multiply(he,q.labelPlaneMatrix,C),he}function hr(C,R,F,q,ae){if(R){var he=e.clone(C);return e.scale(he,he,[ae,ae,1]),F||e.rotateZ(he,he,-q.angle),he}return q.glCoordMatrix}function Qt(C,R){var F=[C.x,C.y,0,1];Fn(F,F,R);var q=F[3];return{point:new e.Point(F[0]/q,F[1]/q),signedDistanceFromCamera:q}}function tr(C,R){return .5+C/R*.5}function rr(C,R){var F=C[0]/C[3],q=C[1]/C[3];return F>=-R[0]&&F<=R[0]&&q>=-R[1]&&q<=R[1]}function fr(C,R,F,q,ae,he,xe,ke){var Le=q?C.textSizeData:C.iconSizeData,He=e.evaluateSizeForZoom(Le,F.transform.zoom),Je=[256/F.width*2+1,256/F.height*2+1],ot=q?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;ot.clear();for(var Tt=C.lineVertexArray,Ct=q?C.text.placedSymbolArray:C.icon.placedSymbolArray,At=F.transform.width/F.transform.height,Et=!1,_t=0;_t<Ct.length;_t++){var Ft=Ct.get(_t);if(Ft.hidden||Ft.writingMode===e.WritingMode.vertical&&!Et)tn(Ft.numGlyphs,ot);else{Et=!1;var zt=[Ft.anchorX,Ft.anchorY,0,1];if(e.transformMat4(zt,zt,R),rr(zt,Je)){var Vt=zt[3],ir=tr(F.transform.cameraToCenterDistance,Vt),gr=e.evaluateSizeForFeature(Le,He,Ft),Lr=xe?gr/ir:gr*ir,Ar=new e.Point(Ft.anchorX,Ft.anchorY),$r=Qt(Ar,ae).point,Jr={},dn=Dr(Ft,Lr,!1,ke,R,ae,he,C.glyphOffsetArray,Tt,ot,$r,Ar,Jr,At);Et=dn.useVertical,(dn.notEnoughRoom||Et||dn.needsFlipping&&Dr(Ft,Lr,!0,ke,R,ae,he,C.glyphOffsetArray,Tt,ot,$r,Ar,Jr,At).notEnoughRoom)&&tn(Ft.numGlyphs,ot)}else tn(Ft.numGlyphs,ot)}}q?C.text.dynamicLayoutVertexBuffer.updateData(ot):C.icon.dynamicLayoutVertexBuffer.updateData(ot)}function yr(C,R,F,q,ae,he,xe,ke,Le,He,Je){var ot=ke.glyphStartIndex+ke.numGlyphs,Tt=ke.lineStartIndex,Ct=ke.lineStartIndex+ke.lineLength,At=R.getoffsetX(ke.glyphStartIndex),Et=R.getoffsetX(ot-1),_t=Wr(C*At,F,q,ae,he,xe,ke.segment,Tt,Ct,Le,He,Je);if(!_t)return null;var Ft=Wr(C*Et,F,q,ae,he,xe,ke.segment,Tt,Ct,Le,He,Je);return Ft?{first:_t,last:Ft}:null}function Sr(C,R,F,q){return C===e.WritingMode.horizontal&&Math.abs(F.y-R.y)>Math.abs(F.x-R.x)*q?{useVertical:!0}:(C===e.WritingMode.vertical?R.y<F.y:R.x>F.x)?{needsFlipping:!0}:null}function Dr(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot,Tt,Ct){var At,Et=R/24,_t=C.lineOffsetX*Et,Ft=C.lineOffsetY*Et;if(C.numGlyphs>1){var zt=C.glyphStartIndex+C.numGlyphs,Vt=C.lineStartIndex,ir=C.lineStartIndex+C.lineLength,gr=yr(Et,ke,_t,Ft,F,Je,ot,C,Le,he,Tt);if(!gr)return{notEnoughRoom:!0};var Lr=Qt(gr.first.point,xe).point,Ar=Qt(gr.last.point,xe).point;if(q&&!F){var $r=Sr(C.writingMode,Lr,Ar,Ct);if($r)return $r}At=[gr.first];for(var Jr=C.glyphStartIndex+1;Jr<zt-1;Jr++)At.push(Wr(Et*ke.getoffsetX(Jr),_t,Ft,F,Je,ot,C.segment,Vt,ir,Le,he,Tt));At.push(gr.last)}else{if(q&&!F){var dn=Qt(ot,ae).point,ln=C.lineStartIndex+C.segment+1,Vn=new e.Point(Le.getx(ln),Le.gety(ln)),Xn=Qt(Vn,ae),hi=Xn.signedDistanceFromCamera>0?Xn.point:Nr(ot,Vn,dn,1,ae),Yr=Sr(C.writingMode,dn,hi,Ct);if(Yr)return Yr}var Sn=Wr(Et*ke.getoffsetX(C.glyphStartIndex),_t,Ft,F,Je,ot,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,Le,he,Tt);if(!Sn)return{notEnoughRoom:!0};At=[Sn]}for(var Kn=0,Yn=At;Kn<Yn.length;Kn+=1){var ai=Yn[Kn];e.addDynamicAttributes(He,ai.point,ai.angle)}return{}}function Nr(C,R,F,q,ae){var he=Qt(C.add(C.sub(R)._unit()),ae).point,xe=F.sub(he);return F.add(xe._mult(q/xe.mag()))}function Wr(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot){var Tt=q?C-R:C+R,Ct=Tt>0?1:-1,At=0;q&&(Ct*=-1,At=Math.PI),Ct<0&&(At+=Math.PI);for(var Et=Ct>0?ke+xe:ke+xe+1,_t=ae,Ft=ae,zt=0,Vt=0,ir=Math.abs(Tt),gr=[];zt+Vt<=ir;){if((Et+=Ct)<ke||Et>=Le)return null;if(Ft=_t,gr.push(_t),(_t=ot[Et])===void 0){var Lr=new e.Point(He.getx(Et),He.gety(Et)),Ar=Qt(Lr,Je);if(Ar.signedDistanceFromCamera>0)_t=ot[Et]=Ar.point;else{var $r=Et-Ct;_t=Nr(zt===0?he:new e.Point(He.getx($r),He.gety($r)),Lr,Ft,ir-zt+1,Je)}}zt+=Vt,Vt=Ft.dist(_t)}var Jr=(ir-zt)/Vt,dn=_t.sub(Ft),ln=dn.mult(Jr)._add(Ft);ln._add(dn._unit()._perp()._mult(F*Ct));var Vn=At+Math.atan2(_t.y-Ft.y,_t.x-Ft.x);return gr.push(ln),{point:ln,angle:Vn,path:gr}}pr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pr.prototype.insert=function(C,R,F,q,ae){this._forEachCell(R,F,q,ae,this._insertBoxCell,this.boxUid++),this.boxKeys.push(C),this.bboxes.push(R),this.bboxes.push(F),this.bboxes.push(q),this.bboxes.push(ae)},pr.prototype.insertCircle=function(C,R,F,q){this._forEachCell(R-q,F-q,R+q,F+q,this._insertCircleCell,this.circleUid++),this.circleKeys.push(C),this.circles.push(R),this.circles.push(F),this.circles.push(q)},pr.prototype._insertBoxCell=function(C,R,F,q,ae,he){this.boxCells[ae].push(he)},pr.prototype._insertCircleCell=function(C,R,F,q,ae,he){this.circleCells[ae].push(he)},pr.prototype._query=function(C,R,F,q,ae,he){if(F<0||C>this.width||q<0||R>this.height)return!ae&&[];var xe=[];if(C<=0&&R<=0&&this.width<=F&&this.height<=q){if(ae)return!0;for(var ke=0;ke<this.boxKeys.length;ke++)xe.push({key:this.boxKeys[ke],x1:this.bboxes[4*ke],y1:this.bboxes[4*ke+1],x2:this.bboxes[4*ke+2],y2:this.bboxes[4*ke+3]});for(var Le=0;Le<this.circleKeys.length;Le++){var He=this.circles[3*Le],Je=this.circles[3*Le+1],ot=this.circles[3*Le+2];xe.push({key:this.circleKeys[Le],x1:He-ot,y1:Je-ot,x2:He+ot,y2:Je+ot})}return he?xe.filter(he):xe}var Tt={hitTest:ae,seenUids:{box:{},circle:{}}};return this._forEachCell(C,R,F,q,this._queryCell,xe,Tt,he),ae?xe.length>0:xe},pr.prototype._queryCircle=function(C,R,F,q,ae){var he=C-F,xe=C+F,ke=R-F,Le=R+F;if(xe<0||he>this.width||Le<0||ke>this.height)return!q&&[];var He=[],Je={hitTest:q,circle:{x:C,y:R,radius:F},seenUids:{box:{},circle:{}}};return this._forEachCell(he,ke,xe,Le,this._queryCellCircle,He,Je,ae),q?He.length>0:He},pr.prototype.query=function(C,R,F,q,ae){return this._query(C,R,F,q,!1,ae)},pr.prototype.hitTest=function(C,R,F,q,ae){return this._query(C,R,F,q,!0,ae)},pr.prototype.hitTestCircle=function(C,R,F,q){return this._queryCircle(C,R,F,!0,q)},pr.prototype._queryCell=function(C,R,F,q,ae,he,xe,ke){var Le=xe.seenUids,He=this.boxCells[ae];if(He!==null)for(var Je=this.bboxes,ot=0,Tt=He;ot<Tt.length;ot+=1){var Ct=Tt[ot];if(!Le.box[Ct]){Le.box[Ct]=!0;var At=4*Ct;if(C<=Je[At+2]&&R<=Je[At+3]&&F>=Je[At+0]&&q>=Je[At+1]&&(!ke||ke(this.boxKeys[Ct]))){if(xe.hitTest)return he.push(!0),!0;he.push({key:this.boxKeys[Ct],x1:Je[At],y1:Je[At+1],x2:Je[At+2],y2:Je[At+3]})}}}var Et=this.circleCells[ae];if(Et!==null)for(var _t=this.circles,Ft=0,zt=Et;Ft<zt.length;Ft+=1){var Vt=zt[Ft];if(!Le.circle[Vt]){Le.circle[Vt]=!0;var ir=3*Vt;if(this._circleAndRectCollide(_t[ir],_t[ir+1],_t[ir+2],C,R,F,q)&&(!ke||ke(this.circleKeys[Vt]))){if(xe.hitTest)return he.push(!0),!0;var gr=_t[ir],Lr=_t[ir+1],Ar=_t[ir+2];he.push({key:this.circleKeys[Vt],x1:gr-Ar,y1:Lr-Ar,x2:gr+Ar,y2:Lr+Ar})}}}},pr.prototype._queryCellCircle=function(C,R,F,q,ae,he,xe,ke){var Le=xe.circle,He=xe.seenUids,Je=this.boxCells[ae];if(Je!==null)for(var ot=this.bboxes,Tt=0,Ct=Je;Tt<Ct.length;Tt+=1){var At=Ct[Tt];if(!He.box[At]){He.box[At]=!0;var Et=4*At;if(this._circleAndRectCollide(Le.x,Le.y,Le.radius,ot[Et+0],ot[Et+1],ot[Et+2],ot[Et+3])&&(!ke||ke(this.boxKeys[At])))return he.push(!0),!0}}var _t=this.circleCells[ae];if(_t!==null)for(var Ft=this.circles,zt=0,Vt=_t;zt<Vt.length;zt+=1){var ir=Vt[zt];if(!He.circle[ir]){He.circle[ir]=!0;var gr=3*ir;if(this._circlesCollide(Ft[gr],Ft[gr+1],Ft[gr+2],Le.x,Le.y,Le.radius)&&(!ke||ke(this.circleKeys[ir])))return he.push(!0),!0}}},pr.prototype._forEachCell=function(C,R,F,q,ae,he,xe,ke){for(var Le=this._convertToXCellCoord(C),He=this._convertToYCellCoord(R),Je=this._convertToXCellCoord(F),ot=this._convertToYCellCoord(q),Tt=Le;Tt<=Je;Tt++)for(var Ct=He;Ct<=ot;Ct++){var At=this.xCellCount*Ct+Tt;if(ae.call(this,C,R,F,q,At,he,xe,ke))return}},pr.prototype._convertToXCellCoord=function(C){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(C*this.xScale)))},pr.prototype._convertToYCellCoord=function(C){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(C*this.yScale)))},pr.prototype._circlesCollide=function(C,R,F,q,ae,he){var xe=q-C,ke=ae-R,Le=F+he;return Le*Le>xe*xe+ke*ke},pr.prototype._circleAndRectCollide=function(C,R,F,q,ae,he,xe){var ke=(he-q)/2,Le=Math.abs(C-(q+ke));if(Le>ke+F)return!1;var He=(xe-ae)/2,Je=Math.abs(R-(ae+He));if(Je>He+F)return!1;if(Le<=ke||Je<=He)return!0;var ot=Le-ke,Tt=Je-He;return ot*ot+Tt*Tt<=F*F};var hn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function tn(C,R){for(var F=0;F<C;F++){var q=R.length;R.resize(q+4),R.float32.set(hn,3*q)}}function Fn(C,R,F){var q=R[0],ae=R[1];return C[0]=F[0]*q+F[4]*ae+F[12],C[1]=F[1]*q+F[5]*ae+F[13],C[3]=F[3]*q+F[7]*ae+F[15],C}var an=function(C,R,F){R===void 0&&(R=new pr(C.width+200,C.height+200,25)),F===void 0&&(F=new pr(C.width+200,C.height+200,25)),this.transform=C,this.grid=R,this.ignoredGrid=F,this.pitchfactor=Math.cos(C._pitch)*C.cameraToCenterDistance,this.screenRightBoundary=C.width+100,this.screenBottomBoundary=C.height+100,this.gridRightBoundary=C.width+200,this.gridBottomBoundary=C.height+200};function xn(C,R,F){return R*(e.EXTENT/(C.tileSize*Math.pow(2,F-C.tileID.overscaledZ)))}an.prototype.placeCollisionBox=function(C,R,F,q,ae){var he=this.projectAndGetPerspectiveRatio(q,C.anchorPointX,C.anchorPointY),xe=F*he.perspectiveRatio,ke=C.x1*xe+he.point.x,Le=C.y1*xe+he.point.y,He=C.x2*xe+he.point.x,Je=C.y2*xe+he.point.y;return!this.isInsideGrid(ke,Le,He,Je)||!R&&this.grid.hitTest(ke,Le,He,Je,ae)?{box:[],offscreen:!1}:{box:[ke,Le,He,Je],offscreen:this.isOffscreen(ke,Le,He,Je)}},an.prototype.placeCollisionCircles=function(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot,Tt){var Ct=[],At=new e.Point(R.anchorX,R.anchorY),Et=Qt(At,he),_t=tr(this.transform.cameraToCenterDistance,Et.signedDistanceFromCamera),Ft=(He?ae/_t:ae*_t)/e.ONE_EM,zt=Qt(At,xe).point,Vt=yr(Ft,q,R.lineOffsetX*Ft,R.lineOffsetY*Ft,!1,zt,At,R,F,xe,{}),ir=!1,gr=!1,Lr=!0;if(Vt){for(var Ar=.5*ot*_t+Tt,$r=new e.Point(-100,-100),Jr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),dn=new Ht,ln=Vt.first,Vn=Vt.last,Xn=[],hi=ln.path.length-1;hi>=1;hi--)Xn.push(ln.path[hi]);for(var Yr=1;Yr<Vn.path.length;Yr++)Xn.push(Vn.path[Yr]);var Sn=2.5*Ar;if(ke){var Kn=Xn.map(function(Mo){return Qt(Mo,ke)});Xn=Kn.some(function(Mo){return Mo.signedDistanceFromCamera<=0})?[]:Kn.map(function(Mo){return Mo.point})}var Yn=[];if(Xn.length>0){for(var ai=Xn[0].clone(),di=Xn[0].clone(),Li=1;Li<Xn.length;Li++)ai.x=Math.min(ai.x,Xn[Li].x),ai.y=Math.min(ai.y,Xn[Li].y),di.x=Math.max(di.x,Xn[Li].x),di.y=Math.max(di.y,Xn[Li].y);Yn=ai.x>=$r.x&&di.x<=Jr.x&&ai.y>=$r.y&&di.y<=Jr.y?[Xn]:di.x<$r.x||ai.x>Jr.x||di.y<$r.y||ai.y>Jr.y?[]:e.clipLine([Xn],$r.x,$r.y,Jr.x,Jr.y)}for(var ei=0,_i=Yn;ei<_i.length;ei+=1){var yi=_i[ei];dn.reset(yi,.25*Ar);var Ii=0;Ii=dn.length<=.5*Ar?1:Math.ceil(dn.paddedLength/Sn)+1;for(var wi=0;wi<Ii;wi++){var Oi=wi/Math.max(Ii-1,1),Hi=dn.lerp(Oi),da=Hi.x+100,Ra=Hi.y+100;Ct.push(da,Ra,Ar,0);var Fa=da-Ar,pa=Ra-Ar,Ea=da+Ar,ba=Ra+Ar;if(Lr=Lr&&this.isOffscreen(Fa,pa,Ea,ba),gr=gr||this.isInsideGrid(Fa,pa,Ea,ba),!C&&this.grid.hitTestCircle(da,Ra,Ar,Je)&&(ir=!0,!Le))return{circles:[],offscreen:!1,collisionDetected:ir}}}}return{circles:!Le&&ir||!gr?[]:Ct,offscreen:Lr,collisionDetected:ir}},an.prototype.queryRenderedSymbols=function(C){if(C.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var R=[],F=1/0,q=1/0,ae=-1/0,he=-1/0,xe=0,ke=C;xe<ke.length;xe+=1){var Le=ke[xe],He=new e.Point(Le.x+100,Le.y+100);F=Math.min(F,He.x),q=Math.min(q,He.y),ae=Math.max(ae,He.x),he=Math.max(he,He.y),R.push(He)}for(var Je={},ot={},Tt=0,Ct=this.grid.query(F,q,ae,he).concat(this.ignoredGrid.query(F,q,ae,he));Tt<Ct.length;Tt+=1){var At=Ct[Tt],Et=At.key;if(Je[Et.bucketInstanceId]===void 0&&(Je[Et.bucketInstanceId]={}),!Je[Et.bucketInstanceId][Et.featureIndex]){var _t=[new e.Point(At.x1,At.y1),new e.Point(At.x2,At.y1),new e.Point(At.x2,At.y2),new e.Point(At.x1,At.y2)];e.polygonIntersectsPolygon(R,_t)&&(Je[Et.bucketInstanceId][Et.featureIndex]=!0,ot[Et.bucketInstanceId]===void 0&&(ot[Et.bucketInstanceId]=[]),ot[Et.bucketInstanceId].push(Et.featureIndex))}}return ot},an.prototype.insertCollisionBox=function(C,R,F,q,ae){var he={bucketInstanceId:F,featureIndex:q,collisionGroupID:ae};(R?this.ignoredGrid:this.grid).insert(he,C[0],C[1],C[2],C[3])},an.prototype.insertCollisionCircles=function(C,R,F,q,ae){for(var he=R?this.ignoredGrid:this.grid,xe={bucketInstanceId:F,featureIndex:q,collisionGroupID:ae},ke=0;ke<C.length;ke+=4)he.insertCircle(xe,C[ke],C[ke+1],C[ke+2])},an.prototype.projectAndGetPerspectiveRatio=function(C,R,F){var q=[R,F,0,1];return Fn(q,q,C),{point:new e.Point((q[0]/q[3]+1)/2*this.transform.width+100,(-q[1]/q[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/q[3]*.5}},an.prototype.isOffscreen=function(C,R,F,q){return F<100||C>=this.screenRightBoundary||q<100||R>this.screenBottomBoundary},an.prototype.isInsideGrid=function(C,R,F,q){return F>=0&&C<this.gridRightBoundary&&q>=0&&R<this.gridBottomBoundary},an.prototype.getViewportMatrix=function(){var C=e.identity([]);return e.translate(C,C,[-100,-100,0]),C};var _n=function(C,R,F,q){this.opacity=C?Math.max(0,Math.min(1,C.opacity+(C.placed?R:-R))):q&&F?1:0,this.placed=F};_n.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ti=function(C,R,F,q,ae){this.text=new _n(C?C.text:null,R,F,ae),this.icon=new _n(C?C.icon:null,R,q,ae)};ti.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var jr=function(C,R,F){this.text=C,this.icon=R,this.skipFade=F},nn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},vn=function(C,R,F,q,ae){this.bucketInstanceId=C,this.featureIndex=R,this.sourceLayerIndex=F,this.bucketIndex=q,this.tileID=ae},en=function(C){this.crossSourceCollisions=C,this.maxGroupID=0,this.collisionGroups={}};function fn(C,R,F,q,ae){var he=e.getAnchorAlignment(C),xe=-(he.horizontalAlign-.5)*R,ke=-(he.verticalAlign-.5)*F,Le=e.evaluateVariableOffset(C,q);return new e.Point(xe+Le[0]*ae,ke+Le[1]*ae)}function Gn(C,R,F,q,ae,he){var xe=C.x1,ke=C.x2,Le=C.y1,He=C.y2,Je=C.anchorPointX,ot=C.anchorPointY,Tt=new e.Point(R,F);return q&&Tt._rotate(ae?he:-he),{x1:xe+Tt.x,y1:Le+Tt.y,x2:ke+Tt.x,y2:He+Tt.y,anchorPointX:Je,anchorPointY:ot}}en.prototype.get=function(C){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[C]){var R=++this.maxGroupID;this.collisionGroups[C]={ID:R,predicate:function(F){return F.collisionGroupID===R}}}return this.collisionGroups[C]};var Tn=function(C,R,F,q){this.transform=C.clone(),this.collisionIndex=new an(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=R,this.retainedQueryData={},this.collisionGroups=new en(F),this.collisionCircleArrays={},this.prevPlacement=q,q&&(q.prevPlacement=void 0),this.placedOrientations={}};function Cn(C,R,F,q,ae){C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0)}Tn.prototype.getBucketParts=function(C,R,F,q){var ae=F.getBucket(R),he=F.latestFeatureIndex;if(ae&&he&&R.id===ae.layerIds[0]){var xe=F.collisionBoxArray,ke=ae.layers[0].layout,Le=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),He=F.tileSize/e.EXTENT,Je=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),ot=ke.get("text-pitch-alignment")==="map",Tt=ke.get("text-rotation-alignment")==="map",Ct=xn(F,1,this.transform.zoom),At=Mr(Je,ot,Tt,this.transform,Ct),Et=null;if(ot){var _t=hr(Je,ot,Tt,this.transform,Ct);Et=e.multiply([],this.transform.labelPlaneMatrix,_t)}this.retainedQueryData[ae.bucketInstanceId]=new vn(ae.bucketInstanceId,he,ae.sourceLayerIndex,ae.index,F.tileID);var Ft={bucket:ae,layout:ke,posMatrix:Je,textLabelPlaneMatrix:At,labelToScreenMatrix:Et,scale:Le,textPixelRatio:He,holdingForFade:F.holdingForFade(),collisionBoxArray:xe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ae.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ae.sourceID)};if(q)for(var zt=0,Vt=ae.sortKeyRanges;zt<Vt.length;zt+=1){var ir=Vt[zt],gr=ir.sortKey,Lr=ir.symbolInstanceStart,Ar=ir.symbolInstanceEnd;C.push({sortKey:gr,symbolInstanceStart:Lr,symbolInstanceEnd:Ar,parameters:Ft})}else C.push({symbolInstanceStart:0,symbolInstanceEnd:ae.symbolInstances.length,parameters:Ft})}},Tn.prototype.attemptAnchorPlacement=function(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot,Tt,Ct,At){var Et,_t=[ot.textOffset0,ot.textOffset1],Ft=fn(C,F,q,_t,ae),zt=this.collisionIndex.placeCollisionBox(Gn(R,Ft.x,Ft.y,he,xe,this.transform.angle),Je,ke,Le,He.predicate);if(!(At&&this.collisionIndex.placeCollisionBox(Gn(At,Ft.x,Ft.y,he,xe,this.transform.angle),Je,ke,Le,He.predicate).box.length===0)&&zt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[ot.crossTileID]&&this.prevPlacement.placements[ot.crossTileID]&&this.prevPlacement.placements[ot.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[ot.crossTileID].anchor),this.variableOffsets[ot.crossTileID]={textOffset:_t,width:F,height:q,anchor:C,textBoxScale:ae,prevAnchor:Et},this.markUsedJustification(Tt,C,ot,Ct),Tt.allowVerticalPlacement&&(this.markUsedOrientation(Tt,Ct,ot),this.placedOrientations[ot.crossTileID]=Ct),{shift:Ft,placedGlyphBoxes:zt}},Tn.prototype.placeLayerBucketPart=function(C,R,F){var q=this,ae=C.parameters,he=ae.bucket,xe=ae.layout,ke=ae.posMatrix,Le=ae.textLabelPlaneMatrix,He=ae.labelToScreenMatrix,Je=ae.textPixelRatio,ot=ae.holdingForFade,Tt=ae.collisionBoxArray,Ct=ae.partiallyEvaluatedTextSize,At=ae.collisionGroup,Et=xe.get("text-optional"),_t=xe.get("icon-optional"),Ft=xe.get("text-allow-overlap"),zt=xe.get("icon-allow-overlap"),Vt=xe.get("text-rotation-alignment")==="map",ir=xe.get("text-pitch-alignment")==="map",gr=xe.get("icon-text-fit")!=="none",Lr=xe.get("symbol-z-order")==="viewport-y",Ar=Ft&&(zt||!he.hasIconData()||_t),$r=zt&&(Ft||!he.hasTextData()||Et);!he.collisionArrays&&Tt&&he.deserializeCollisionBoxes(Tt);var Jr=function(Yr,Sn){if(!R[Yr.crossTileID])if(ot)q.placements[Yr.crossTileID]=new jr(!1,!1,!1);else{var Kn,Yn=!1,ai=!1,di=!0,Li=null,ei={box:null,offscreen:null},_i={box:null,offscreen:null},yi=null,Ii=null,wi=0,Oi=0,Hi=0;Sn.textFeatureIndex?wi=Sn.textFeatureIndex:Yr.useRuntimeCollisionCircles&&(wi=Yr.featureIndex),Sn.verticalTextFeatureIndex&&(Oi=Sn.verticalTextFeatureIndex);var da=Sn.textBox;if(da){var Ra=function(La){var Bo=e.WritingMode.horizontal;if(he.allowVerticalPlacement&&!La&&q.prevPlacement){var No=q.prevPlacement.placedOrientations[Yr.crossTileID];No&&(q.placedOrientations[Yr.crossTileID]=No,Bo=No,q.markUsedOrientation(he,Bo,Yr))}return Bo},Fa=function(La,Bo){if(he.allowVerticalPlacement&&Yr.numVerticalGlyphVertices>0&&Sn.verticalTextBox)for(var No=0,fc=he.writingModes;No<fc.length&&(fc[No]===e.WritingMode.vertical?(ei=Bo(),_i=ei):ei=La(),!(ei&&ei.box&&ei.box.length));No+=1);else ei=La()};if(xe.get("text-variable-anchor")){var pa=xe.get("text-variable-anchor");if(q.prevPlacement&&q.prevPlacement.variableOffsets[Yr.crossTileID]){var Ea=q.prevPlacement.variableOffsets[Yr.crossTileID];pa.indexOf(Ea.anchor)>0&&(pa=pa.filter(function(La){return La!==Ea.anchor})).unshift(Ea.anchor)}var ba=function(La,Bo,No){for(var fc=La.x2-La.x1,Df=La.y2-La.y1,ts=Yr.textBoxScale,Wc=gr&&!zt?Bo:null,Xl={box:[],offscreen:!1},zf=Ft?2*pa.length:pa.length,vl=0;vl<zf;++vl){var Rf=pa[vl%pa.length],hc=vl>=pa.length,Zc=q.attemptAnchorPlacement(Rf,La,fc,Df,ts,Vt,ir,Je,ke,At,hc,Yr,he,No,Wc);if(Zc&&(Xl=Zc.placedGlyphBoxes)&&Xl.box&&Xl.box.length){Yn=!0,Li=Zc.shift;break}}return Xl};Fa(function(){return ba(da,Sn.iconBox,e.WritingMode.horizontal)},function(){var La=Sn.verticalTextBox,Bo=ei&&ei.box&&ei.box.length;return he.allowVerticalPlacement&&!Bo&&Yr.numVerticalGlyphVertices>0&&La?ba(La,Sn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),ei&&(Yn=ei.box,di=ei.offscreen);var Mo=Ra(ei&&ei.box);if(!Yn&&q.prevPlacement){var Ja=q.prevPlacement.variableOffsets[Yr.crossTileID];Ja&&(q.variableOffsets[Yr.crossTileID]=Ja,q.markUsedJustification(he,Ja.anchor,Yr,Mo))}}else{var Vo=function(La,Bo){var No=q.collisionIndex.placeCollisionBox(La,Ft,Je,ke,At.predicate);return No&&No.box&&No.box.length&&(q.markUsedOrientation(he,Bo,Yr),q.placedOrientations[Yr.crossTileID]=Bo),No};Fa(function(){return Vo(da,e.WritingMode.horizontal)},function(){var La=Sn.verticalTextBox;return he.allowVerticalPlacement&&Yr.numVerticalGlyphVertices>0&&La?Vo(La,e.WritingMode.vertical):{box:null,offscreen:null}}),Ra(ei&&ei.box&&ei.box.length)}}if(Yn=(Kn=ei)&&Kn.box&&Kn.box.length>0,di=Kn&&Kn.offscreen,Yr.useRuntimeCollisionCircles){var Os=he.text.placedSymbolArray.get(Yr.centerJustifiedTextSymbolIndex),ol=e.evaluateSizeForFeature(he.textSizeData,Ct,Os),Yl=xe.get("text-padding"),Cl=Yr.collisionCircleDiameter;yi=q.collisionIndex.placeCollisionCircles(Ft,Os,he.lineVertexArray,he.glyphOffsetArray,ol,ke,Le,He,F,ir,At.predicate,Cl,Yl),Yn=Ft||yi.circles.length>0&&!yi.collisionDetected,di=di&&yi.offscreen}if(Sn.iconFeatureIndex&&(Hi=Sn.iconFeatureIndex),Sn.iconBox){var Pl=function(La){var Bo=gr&&Li?Gn(La,Li.x,Li.y,Vt,ir,q.transform.angle):La;return q.collisionIndex.placeCollisionBox(Bo,zt,Je,ke,At.predicate)};ai=_i&&_i.box&&_i.box.length&&Sn.verticalIconBox?(Ii=Pl(Sn.verticalIconBox)).box.length>0:(Ii=Pl(Sn.iconBox)).box.length>0,di=di&&Ii.offscreen}var Ao=Et||Yr.numHorizontalGlyphVertices===0&&Yr.numVerticalGlyphVertices===0,ml=_t||Yr.numIconVertices===0;if(Ao||ml?ml?Ao||(ai=ai&&Yn):Yn=ai&&Yn:ai=Yn=ai&&Yn,Yn&&Kn&&Kn.box&&(_i&&_i.box&&Oi?q.collisionIndex.insertCollisionBox(Kn.box,xe.get("text-ignore-placement"),he.bucketInstanceId,Oi,At.ID):q.collisionIndex.insertCollisionBox(Kn.box,xe.get("text-ignore-placement"),he.bucketInstanceId,wi,At.ID)),ai&&Ii&&q.collisionIndex.insertCollisionBox(Ii.box,xe.get("icon-ignore-placement"),he.bucketInstanceId,Hi,At.ID),yi&&(Yn&&q.collisionIndex.insertCollisionCircles(yi.circles,xe.get("text-ignore-placement"),he.bucketInstanceId,wi,At.ID),F)){var Wl=he.bucketInstanceId,hs=q.collisionCircleArrays[Wl];hs===void 0&&(hs=q.collisionCircleArrays[Wl]=new nn);for(var Zl=0;Zl<yi.circles.length;Zl+=4)hs.circles.push(yi.circles[Zl+0]),hs.circles.push(yi.circles[Zl+1]),hs.circles.push(yi.circles[Zl+2]),hs.circles.push(yi.collisionDetected?1:0)}q.placements[Yr.crossTileID]=new jr(Yn||Ar,ai||$r,di||he.justReloaded),R[Yr.crossTileID]=!0}};if(Lr)for(var dn=he.getSortedSymbolIndexes(this.transform.angle),ln=dn.length-1;ln>=0;--ln){var Vn=dn[ln];Jr(he.symbolInstances.get(Vn),he.collisionArrays[Vn])}else for(var Xn=C.symbolInstanceStart;Xn<C.symbolInstanceEnd;Xn++)Jr(he.symbolInstances.get(Xn),he.collisionArrays[Xn]);if(F&&he.bucketInstanceId in this.collisionCircleArrays){var hi=this.collisionCircleArrays[he.bucketInstanceId];e.invert(hi.invProjMatrix,ke),hi.viewportMatrix=this.collisionIndex.getViewportMatrix()}he.justReloaded=!1},Tn.prototype.markUsedJustification=function(C,R,F,q){var ae,he={left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex};ae=q===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:he[e.getAnchorJustification(R)];for(var xe=0,ke=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];xe<ke.length;xe+=1){var Le=ke[xe];Le>=0&&(C.text.placedSymbolArray.get(Le).crossTileID=ae>=0&&Le!==ae?0:F.crossTileID)}},Tn.prototype.markUsedOrientation=function(C,R,F){for(var q=R===e.WritingMode.horizontal||R===e.WritingMode.horizontalOnly?R:0,ae=R===e.WritingMode.vertical?R:0,he=0,xe=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];he<xe.length;he+=1){var ke=xe[he];C.text.placedSymbolArray.get(ke).placedOrientation=q}F.verticalPlacedTextSymbolIndex&&(C.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ae)},Tn.prototype.commit=function(C){this.commitTime=C,this.zoomAtLastRecencyCheck=this.transform.zoom;var R=this.prevPlacement,F=!1;this.prevZoomAdjustment=R?R.zoomAdjustment(this.transform.zoom):0;var q=R?R.symbolFadeChange(C):1,ae=R?R.opacities:{},he=R?R.variableOffsets:{},xe=R?R.placedOrientations:{};for(var ke in this.placements){var Le=this.placements[ke],He=ae[ke];He?(this.opacities[ke]=new ti(He,q,Le.text,Le.icon),F=F||Le.text!==He.text.placed||Le.icon!==He.icon.placed):(this.opacities[ke]=new ti(null,q,Le.text,Le.icon,Le.skipFade),F=F||Le.text||Le.icon)}for(var Je in ae){var ot=ae[Je];if(!this.opacities[Je]){var Tt=new ti(ot,q,!1,!1);Tt.isHidden()||(this.opacities[Je]=Tt,F=F||ot.text.placed||ot.icon.placed)}}for(var Ct in he)this.variableOffsets[Ct]||!this.opacities[Ct]||this.opacities[Ct].isHidden()||(this.variableOffsets[Ct]=he[Ct]);for(var At in xe)this.placedOrientations[At]||!this.opacities[At]||this.opacities[At].isHidden()||(this.placedOrientations[At]=xe[At]);F?this.lastPlacementChangeTime=C:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=R?R.lastPlacementChangeTime:C)},Tn.prototype.updateLayerOpacities=function(C,R){for(var F={},q=0,ae=R;q<ae.length;q+=1){var he=ae[q],xe=he.getBucket(C);xe&&he.latestFeatureIndex&&C.id===xe.layerIds[0]&&this.updateBucketOpacities(xe,F,he.collisionBoxArray)}},Tn.prototype.updateBucketOpacities=function(C,R,F){var q=this;C.hasTextData()&&C.text.opacityVertexArray.clear(),C.hasIconData()&&C.icon.opacityVertexArray.clear(),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexArray.clear(),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexArray.clear();var ae=C.layers[0].layout,he=new ti(null,0,!1,!1,!0),xe=ae.get("text-allow-overlap"),ke=ae.get("icon-allow-overlap"),Le=ae.get("text-variable-anchor"),He=ae.get("text-rotation-alignment")==="map",Je=ae.get("text-pitch-alignment")==="map",ot=ae.get("icon-text-fit")!=="none",Tt=new ti(null,0,xe&&(ke||!C.hasIconData()||ae.get("icon-optional")),ke&&(xe||!C.hasTextData()||ae.get("text-optional")),!0);!C.collisionArrays&&F&&(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData())&&C.deserializeCollisionBoxes(F);for(var Ct=function(Ft,zt,Vt){for(var ir=0;ir<zt/4;ir++)Ft.opacityVertexArray.emplaceBack(Vt)},At=function(Ft){var zt=C.symbolInstances.get(Ft),Vt=zt.numHorizontalGlyphVertices,ir=zt.numVerticalGlyphVertices,gr=zt.crossTileID,Lr=R[gr],Ar=q.opacities[gr];Lr?Ar=he:Ar||(Ar=Tt,q.opacities[gr]=Ar),R[gr]=!0;var $r=Vt>0||ir>0,Jr=zt.numIconVertices>0,dn=q.placedOrientations[zt.crossTileID],ln=dn===e.WritingMode.vertical,Vn=dn===e.WritingMode.horizontal||dn===e.WritingMode.horizontalOnly;if($r){var Xn=Fr(Ar.text),hi=ln?zr:Xn;Ct(C.text,Vt,hi);var Yr=Vn?zr:Xn;Ct(C.text,ir,Yr);var Sn=Ar.text.isHidden();[zt.rightJustifiedTextSymbolIndex,zt.centerJustifiedTextSymbolIndex,zt.leftJustifiedTextSymbolIndex].forEach(function(Hi){Hi>=0&&(C.text.placedSymbolArray.get(Hi).hidden=Sn||ln?1:0)}),zt.verticalPlacedTextSymbolIndex>=0&&(C.text.placedSymbolArray.get(zt.verticalPlacedTextSymbolIndex).hidden=Sn||Vn?1:0);var Kn=q.variableOffsets[zt.crossTileID];Kn&&q.markUsedJustification(C,Kn.anchor,zt,dn);var Yn=q.placedOrientations[zt.crossTileID];Yn&&(q.markUsedJustification(C,"left",zt,Yn),q.markUsedOrientation(C,Yn,zt))}if(Jr){var ai=Fr(Ar.icon),di=!(ot&&zt.verticalPlacedIconSymbolIndex&&ln);if(zt.placedIconSymbolIndex>=0){var Li=di?ai:zr;Ct(C.icon,zt.numIconVertices,Li),C.icon.placedSymbolArray.get(zt.placedIconSymbolIndex).hidden=Ar.icon.isHidden()}if(zt.verticalPlacedIconSymbolIndex>=0){var ei=di?zr:ai;Ct(C.icon,zt.numVerticalIconVertices,ei),C.icon.placedSymbolArray.get(zt.verticalPlacedIconSymbolIndex).hidden=Ar.icon.isHidden()}}if(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData()){var _i=C.collisionArrays[Ft];if(_i){var yi=new e.Point(0,0);if(_i.textBox||_i.verticalTextBox){var Ii=!0;if(Le){var wi=q.variableOffsets[gr];wi?(yi=fn(wi.anchor,wi.width,wi.height,wi.textOffset,wi.textBoxScale),He&&yi._rotate(Je?q.transform.angle:-q.transform.angle)):Ii=!1}_i.textBox&&Cn(C.textCollisionBox.collisionVertexArray,Ar.text.placed,!Ii||ln,yi.x,yi.y),_i.verticalTextBox&&Cn(C.textCollisionBox.collisionVertexArray,Ar.text.placed,!Ii||Vn,yi.x,yi.y)}var Oi=Boolean(!Vn&&_i.verticalIconBox);_i.iconBox&&Cn(C.iconCollisionBox.collisionVertexArray,Ar.icon.placed,Oi,ot?yi.x:0,ot?yi.y:0),_i.verticalIconBox&&Cn(C.iconCollisionBox.collisionVertexArray,Ar.icon.placed,!Oi,ot?yi.x:0,ot?yi.y:0)}}},Et=0;Et<C.symbolInstances.length;Et++)At(Et);if(C.sortFeatures(this.transform.angle),this.retainedQueryData[C.bucketInstanceId]&&(this.retainedQueryData[C.bucketInstanceId].featureSortOrder=C.featureSortOrder),C.hasTextData()&&C.text.opacityVertexBuffer&&C.text.opacityVertexBuffer.updateData(C.text.opacityVertexArray),C.hasIconData()&&C.icon.opacityVertexBuffer&&C.icon.opacityVertexBuffer.updateData(C.icon.opacityVertexArray),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexBuffer&&C.iconCollisionBox.collisionVertexBuffer.updateData(C.iconCollisionBox.collisionVertexArray),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexBuffer&&C.textCollisionBox.collisionVertexBuffer.updateData(C.textCollisionBox.collisionVertexArray),C.bucketInstanceId in this.collisionCircleArrays){var _t=this.collisionCircleArrays[C.bucketInstanceId];C.placementInvProjMatrix=_t.invProjMatrix,C.placementViewportMatrix=_t.viewportMatrix,C.collisionCircleArray=_t.circles,delete this.collisionCircleArrays[C.bucketInstanceId]}},Tn.prototype.symbolFadeChange=function(C){return this.fadeDuration===0?1:(C-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Tn.prototype.zoomAdjustment=function(C){return Math.max(0,(this.transform.zoom-C)/1.5)},Tn.prototype.hasTransitions=function(C){return this.stale||C-this.lastPlacementChangeTime<this.fadeDuration},Tn.prototype.stillRecent=function(C,R){var F=this.zoomAtLastRecencyCheck===R?1-this.zoomAdjustment(R):1;return this.zoomAtLastRecencyCheck=R,this.commitTime+this.fadeDuration*F>C},Tn.prototype.setStale=function(){this.stale=!0};var oi=Math.pow(2,25),nr=Math.pow(2,24),vr=Math.pow(2,17),It=Math.pow(2,16),lr=Math.pow(2,9),dr=Math.pow(2,8),Br=Math.pow(2,1);function Fr(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;var R=C.placed?1:0,F=Math.floor(127*C.opacity);return F*oi+R*nr+F*vr+R*It+F*lr+R*dr+F*Br+R}var zr=0,Er=function(C){this._sortAcrossTiles=C.layout.get("symbol-z-order")!=="viewport-y"&&C.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Er.prototype.continuePlacement=function(C,R,F,q,ae){for(var he=this._bucketParts;this._currentTileIndex<C.length;){var xe=C[this._currentTileIndex];if(R.getBucketParts(he,q,xe,this._sortAcrossTiles),this._currentTileIndex++,ae())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,he.sort(function(Le,He){return Le.sortKey-He.sortKey}));this._currentPartIndex<he.length;){var ke=he[this._currentPartIndex];if(R.placeLayerBucketPart(ke,this._seenCrossTileIDs,F),this._currentPartIndex++,ae())return!0}return!1};var xr=function(C,R,F,q,ae,he,xe){this.placement=new Tn(C,ae,he,xe),this._currentPlacementIndex=R.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=q,this._done=!1};xr.prototype.isDone=function(){return this._done},xr.prototype.continuePlacement=function(C,R,F){for(var q=this,ae=e.browser.now(),he=function(){var Le=e.browser.now()-ae;return!q._forceFullPlacement&&Le>2};this._currentPlacementIndex>=0;){var xe=R[C[this._currentPlacementIndex]],ke=this.placement.collisionIndex.transform.zoom;if(xe.type==="symbol"&&(!xe.minzoom||xe.minzoom<=ke)&&(!xe.maxzoom||xe.maxzoom>ke)){if(this._inProgressLayer||(this._inProgressLayer=new Er(xe)),this._inProgressLayer.continuePlacement(F[xe.source],this.placement,this._showCollisionBoxes,xe,he))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},xr.prototype.commit=function(C){return this.placement.commit(C),this.placement};var _r=512/e.EXTENT/2,kr=function(C,R,F){this.tileID=C,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var q=0;q<R.length;q++){var ae=R.get(q),he=ae.key;this.indexedSymbolInstances[he]||(this.indexedSymbolInstances[he]=[]),this.indexedSymbolInstances[he].push({crossTileID:ae.crossTileID,coord:this.getScaledCoordinates(ae,C)})}};kr.prototype.getScaledCoordinates=function(C,R){var F=R.canonical.z-this.tileID.canonical.z,q=_r/Math.pow(2,F);return{x:Math.floor((R.canonical.x*e.EXTENT+C.anchorX)*q),y:Math.floor((R.canonical.y*e.EXTENT+C.anchorY)*q)}},kr.prototype.findMatches=function(C,R,F){for(var q=this.tileID.canonical.z<R.canonical.z?1:Math.pow(2,this.tileID.canonical.z-R.canonical.z),ae=0;ae<C.length;ae++){var he=C.get(ae);if(!he.crossTileID){var xe=this.indexedSymbolInstances[he.key];if(xe)for(var ke=this.getScaledCoordinates(he,R),Le=0,He=xe;Le<He.length;Le+=1){var Je=He[Le];if(Math.abs(Je.coord.x-ke.x)<=q&&Math.abs(Je.coord.y-ke.y)<=q&&!F[Je.crossTileID]){F[Je.crossTileID]=!0,he.crossTileID=Je.crossTileID;break}}}}};var Cr=function(){this.maxCrossTileID=0};Cr.prototype.generate=function(){return++this.maxCrossTileID};var Gr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Gr.prototype.handleWrapJump=function(C){var R=Math.round((C-this.lng)/360);if(R!==0)for(var F in this.indexes){var q=this.indexes[F],ae={};for(var he in q){var xe=q[he];xe.tileID=xe.tileID.unwrapTo(xe.tileID.wrap+R),ae[xe.tileID.key]=xe}this.indexes[F]=ae}this.lng=C},Gr.prototype.addBucket=function(C,R,F){if(this.indexes[C.overscaledZ]&&this.indexes[C.overscaledZ][C.key]){if(this.indexes[C.overscaledZ][C.key].bucketInstanceId===R.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(C.overscaledZ,this.indexes[C.overscaledZ][C.key])}for(var q=0;q<R.symbolInstances.length;q++)R.symbolInstances.get(q).crossTileID=0;this.usedCrossTileIDs[C.overscaledZ]||(this.usedCrossTileIDs[C.overscaledZ]={});var ae=this.usedCrossTileIDs[C.overscaledZ];for(var he in this.indexes){var xe=this.indexes[he];if(Number(he)>C.overscaledZ)for(var ke in xe){var Le=xe[ke];Le.tileID.isChildOf(C)&&Le.findMatches(R.symbolInstances,C,ae)}else{var He=xe[C.scaledTo(Number(he)).key];He&&He.findMatches(R.symbolInstances,C,ae)}}for(var Je=0;Je<R.symbolInstances.length;Je++){var ot=R.symbolInstances.get(Je);ot.crossTileID||(ot.crossTileID=F.generate(),ae[ot.crossTileID]=!0)}return this.indexes[C.overscaledZ]===void 0&&(this.indexes[C.overscaledZ]={}),this.indexes[C.overscaledZ][C.key]=new kr(C,R.symbolInstances,R.bucketInstanceId),!0},Gr.prototype.removeBucketCrossTileIDs=function(C,R){for(var F in R.indexedSymbolInstances)for(var q=0,ae=R.indexedSymbolInstances[F];q<ae.length;q+=1){var he=ae[q];delete this.usedCrossTileIDs[C][he.crossTileID]}},Gr.prototype.removeStaleBuckets=function(C){var R=!1;for(var F in this.indexes){var q=this.indexes[F];for(var ae in q)C[q[ae].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,q[ae]),delete q[ae],R=!0)}return R};var qr=function(){this.layerIndexes={},this.crossTileIDs=new Cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};qr.prototype.addLayer=function(C,R,F){var q=this.layerIndexes[C.id];q===void 0&&(q=this.layerIndexes[C.id]=new Gr);var ae=!1,he={};q.handleWrapJump(F);for(var xe=0,ke=R;xe<ke.length;xe+=1){var Le=ke[xe],He=Le.getBucket(C);He&&C.id===He.layerIds[0]&&(He.bucketInstanceId||(He.bucketInstanceId=++this.maxBucketInstanceId),q.addBucket(Le.tileID,He,this.crossTileIDs)&&(ae=!0),he[He.bucketInstanceId]=!0)}return q.removeStaleBuckets(he)&&(ae=!0),ae},qr.prototype.pruneUnusedLayers=function(C){var R={};for(var F in C.forEach(function(q){R[q]=!0}),this.layerIndexes)R[F]||delete this.layerIndexes[F]};var Qr=function(C,R){return e.emitValidationErrors(C,R&&R.filter(function(F){return F.identifier!=="source.canvas"}))},rn=e.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),yn=e.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),wn=function(){var C={},R=e.styleSpec.$version;for(var F in e.styleSpec.$root){var q=e.styleSpec.$root[F];if(q.required){var ae=null;(ae=F==="version"?R:q.type==="array"?[]:{})!=null&&(C[F]=ae)}}return C}(),kn=function(C){function R(F,q){var ae=this;q===void 0&&(q={}),C.call(this),this.map=F,this.dispatcher=new S(it(),this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new k(F._requestManager,q.localIdeographFontFamily),this.lineAtlas=new P(256,512),this.crossTileSymbolIndex=new qr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var he=this;this._rtlTextPluginCallback=R.registerForPluginStateChange(function(xe){var ke={pluginStatus:xe.pluginStatus,pluginURL:xe.pluginURL};he.dispatcher.broadcast("syncRTLPluginState",ke,function(Le,He){if(e.triggerPluginCompletionEvent(Le),He&&He.every(function(ot){return ot}))for(var Je in he.sourceCaches)he.sourceCaches[Je].reload()})}),this.on("data",function(xe){if(xe.dataType==="source"&&xe.sourceDataType==="metadata"){var ke=ae.sourceCaches[xe.sourceId];if(ke){var Le=ke.getSource();if(Le&&Le.vectorLayerIds)for(var He in ae._layers){var Je=ae._layers[He];Je.source===Le.id&&ae._validateLayer(Je)}}}})}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.loadURL=function(F,q){var ae=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var he=typeof q.validate=="boolean"?q.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,q.accessToken);var xe=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(xe,function(ke,Le){ae._request=null,ke?ae.fire(new e.ErrorEvent(ke)):Le&&ae._load(Le,he)})},R.prototype.loadJSON=function(F,q){var ae=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ae._request=null,ae._load(F,q.validate!==!1)})},R.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(wn,!1)},R.prototype._load=function(F,q){if(!q||!Qr(this,e.validateStyle(F))){for(var ae in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ae,F.sources[ae],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var he=jt(this.stylesheet.layers);this._order=he.map(function(He){return He.id}),this._layers={},this._serializedLayers={};for(var xe=0,ke=he;xe<ke.length;xe+=1){var Le=ke[xe];(Le=e.createStyleLayer(Le)).setEventedParent(this,{layer:{id:Le.id}}),this._layers[Le.id]=Le,this._serializedLayers[Le.id]=Le.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},R.prototype._loadSprite=function(F){var q=this;this._spriteRequest=function(ae,he,xe){var ke,Le,He,Je=e.browser.devicePixelRatio>1?"@2x":"",ot=e.getJSON(he.transformRequest(he.normalizeSpriteURL(ae,Je,".json"),e.ResourceType.SpriteJSON),function(At,Et){ot=null,He||(He=At,ke=Et,Ct())}),Tt=e.getImage(he.transformRequest(he.normalizeSpriteURL(ae,Je,".png"),e.ResourceType.SpriteImage),function(At,Et){Tt=null,He||(He=At,Le=Et,Ct())});function Ct(){if(He)xe(He);else if(ke&&Le){var At=e.browser.getImageData(Le),Et={};for(var _t in ke){var Ft=ke[_t],zt=Ft.width,Vt=Ft.height,ir=Ft.x,gr=Ft.y,Lr=Ft.sdf,Ar=Ft.pixelRatio,$r=Ft.stretchX,Jr=Ft.stretchY,dn=Ft.content,ln=new e.RGBAImage({width:zt,height:Vt});e.RGBAImage.copy(At,ln,{x:ir,y:gr},{x:0,y:0},{width:zt,height:Vt}),Et[_t]={data:ln,pixelRatio:Ar,sdf:Lr,stretchX:$r,stretchY:Jr,content:dn}}xe(null,Et)}}return{cancel:function(){ot&&(ot.cancel(),ot=null),Tt&&(Tt.cancel(),Tt=null)}}}(F,this.map._requestManager,function(ae,he){if(q._spriteRequest=null,ae)q.fire(new e.ErrorEvent(ae));else if(he)for(var xe in he)q.imageManager.addImage(xe,he[xe]);q.imageManager.setLoaded(!0),q._availableImages=q.imageManager.listImages(),q.dispatcher.broadcast("setImages",q._availableImages),q.fire(new e.Event("data",{dataType:"style"}))})},R.prototype._validateLayer=function(F){var q=this.sourceCaches[F.source];if(q){var ae=F.sourceLayer;if(ae){var he=q.getSource();(he.type==="geojson"||he.vectorLayerIds&&he.vectorLayerIds.indexOf(ae)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ae+'" does not exist on source "'+he.id+'" as specified by style layer "'+F.id+'"')))}}},R.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},R.prototype._serializeLayers=function(F){for(var q=[],ae=0,he=F;ae<he.length;ae+=1){var xe=he[ae],ke=this._layers[xe];ke.type!=="custom"&&q.push(ke.serialize())}return q},R.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var q in this._layers)if(this._layers[q].hasTransition())return!0;return!1},R.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},R.prototype.update=function(F){if(this._loaded){var q=this._changed;if(this._changed){var ae=Object.keys(this._updatedLayers),he=Object.keys(this._removedLayers);for(var xe in(ae.length||he.length)&&this._updateWorkerLayers(ae,he),this._updatedSources){var ke=this._updatedSources[xe];ke==="reload"?this._reloadSource(xe):ke==="clear"&&this._clearSource(xe)}for(var Le in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Le].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var He in this.sourceCaches)this.sourceCaches[He].used=!1;for(var Je=0,ot=this._order;Je<ot.length;Je+=1){var Tt=ot[Je],Ct=this._layers[Tt];Ct.recalculate(F,this._availableImages),!Ct.isHidden(F.zoom)&&Ct.source&&(this.sourceCaches[Ct.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,q&&this.fire(new e.Event("data",{dataType:"style"}))}},R.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var q in this.sourceCaches)this.sourceCaches[q].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},R.prototype._updateWorkerLayers=function(F,q){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:q})},R.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},R.prototype.setState=function(F){var q=this;if(this._checkLoaded(),Qr(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=jt(F.layers);var ae=Kt(this.serialize(),F).filter(function(xe){return!(xe.command in yn)});if(ae.length===0)return!1;var he=ae.filter(function(xe){return!(xe.command in rn)});if(he.length>0)throw new Error("Unimplemented: "+he.map(function(xe){return xe.command}).join(", ")+".");return ae.forEach(function(xe){xe.command!=="setTransition"&&q[xe.command].apply(q,xe.args)}),this.stylesheet=F,!0},R.prototype.addImage=function(F,q){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,q),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.updateImage=function(F,q){this.imageManager.updateImage(F,q)},R.prototype.getImage=function(F){return this.imageManager.getImage(F)},R.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},R.prototype.addSource=function(F,q,ae){var he=this;if(ae===void 0&&(ae={}),this._checkLoaded(),this.sourceCaches[F]!==void 0)throw new Error("There is already a source with this ID");if(!q.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(q).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(q.type)>=0)||!this._validate(e.validateStyle.source,"sources."+F,q,null,ae)){this.map&&this.map._collectResourceTiming&&(q.collectResourceTiming=!0);var xe=this.sourceCaches[F]=new Fe(F,q,this.dispatcher);xe.style=this,xe.setEventedParent(this,function(){return{isSourceLoaded:he.loaded(),source:xe.serialize(),sourceId:F}}),xe.onAdd(this.map),this._changed=!0}},R.prototype.removeSource=function(F){if(this._checkLoaded(),this.sourceCaches[F]===void 0)throw new Error("There is no source with this ID");for(var q in this._layers)if(this._layers[q].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+q+'" is using it.')));var ae=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ae.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ae.setEventedParent(null),ae.clearTiles(),ae.onRemove&&ae.onRemove(this.map),this._changed=!0},R.prototype.setGeoJSONSourceData=function(F,q){this._checkLoaded(),this.sourceCaches[F].getSource().setData(q),this._changed=!0},R.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},R.prototype.addLayer=function(F,q,ae){ae===void 0&&(ae={}),this._checkLoaded();var he=F.id;if(this.getLayer(he))this.fire(new e.ErrorEvent(new Error('Layer with id "'+he+'" already exists on this map')));else{var xe;if(F.type==="custom"){if(Qr(this,e.validateCustomStyleLayer(F)))return;xe=e.createStyleLayer(F)}else{if(typeof F.source=="object"&&(this.addSource(he,F.source),F=e.clone$1(F),F=e.extend(F,{source:he})),this._validate(e.validateStyle.layer,"layers."+he,F,{arrayIndex:-1},ae))return;xe=e.createStyleLayer(F),this._validateLayer(xe),xe.setEventedParent(this,{layer:{id:he}}),this._serializedLayers[xe.id]=xe.serialize()}var ke=q?this._order.indexOf(q):this._order.length;if(q&&ke===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.')));else{if(this._order.splice(ke,0,he),this._layerOrderChanged=!0,this._layers[he]=xe,this._removedLayers[he]&&xe.source&&xe.type!=="custom"){var Le=this._removedLayers[he];delete this._removedLayers[he],Le.type!==xe.type?this._updatedSources[xe.source]="clear":(this._updatedSources[xe.source]="reload",this.sourceCaches[xe.source].pause())}this._updateLayer(xe),xe.onAdd&&xe.onAdd(this.map)}}},R.prototype.moveLayer=function(F,q){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==q){var ae=this._order.indexOf(F);this._order.splice(ae,1);var he=q?this._order.indexOf(q):this._order.length;q&&he===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.'))):(this._order.splice(he,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},R.prototype.removeLayer=function(F){this._checkLoaded();var q=this._layers[F];if(q){q.setEventedParent(null);var ae=this._order.indexOf(F);this._order.splice(ae,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=q,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],q.onRemove&&q.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},R.prototype.getLayer=function(F){return this._layers[F]},R.prototype.hasLayer=function(F){return F in this._layers},R.prototype.setLayerZoomRange=function(F,q,ae){this._checkLoaded();var he=this.getLayer(F);he?he.minzoom===q&&he.maxzoom===ae||(q!=null&&(he.minzoom=q),ae!=null&&(he.maxzoom=ae),this._updateLayer(he)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},R.prototype.setFilter=function(F,q,ae){ae===void 0&&(ae={}),this._checkLoaded();var he=this.getLayer(F);if(he){if(!e.deepEqual(he.filter,q))return q==null?(he.filter=void 0,void this._updateLayer(he)):void(this._validate(e.validateStyle.filter,"layers."+he.id+".filter",q,null,ae)||(he.filter=e.clone$1(q),this._updateLayer(he)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},R.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},R.prototype.setLayoutProperty=function(F,q,ae,he){he===void 0&&(he={}),this._checkLoaded();var xe=this.getLayer(F);xe?e.deepEqual(xe.getLayoutProperty(q),ae)||(xe.setLayoutProperty(q,ae,he),this._updateLayer(xe)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getLayoutProperty=function(F,q){var ae=this.getLayer(F);if(ae)return ae.getLayoutProperty(q);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},R.prototype.setPaintProperty=function(F,q,ae,he){he===void 0&&(he={}),this._checkLoaded();var xe=this.getLayer(F);xe?e.deepEqual(xe.getPaintProperty(q),ae)||(xe.setPaintProperty(q,ae,he)&&this._updateLayer(xe),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getPaintProperty=function(F,q){return this.getLayer(F).getPaintProperty(q)},R.prototype.setFeatureState=function(F,q){this._checkLoaded();var ae=F.source,he=F.sourceLayer,xe=this.sourceCaches[ae];if(xe!==void 0){var ke=xe.getSource().type;ke==="geojson"&&he?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ke!=="vector"||he?(F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),xe.setFeatureState(he,F.id,q)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},R.prototype.removeFeatureState=function(F,q){this._checkLoaded();var ae=F.source,he=this.sourceCaches[ae];if(he!==void 0){var xe=he.getSource().type,ke=xe==="vector"?F.sourceLayer:void 0;xe!=="vector"||ke?q&&typeof F.id!="string"&&typeof F.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):he.removeFeatureState(ke,F.id,q):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},R.prototype.getFeatureState=function(F){this._checkLoaded();var q=F.source,ae=F.sourceLayer,he=this.sourceCaches[q];if(he!==void 0){if(he.getSource().type!=="vector"||ae)return F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),he.getFeatureState(ae,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+q+"' does not exist in the map's style.")))},R.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},R.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return F!==void 0})},R.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&this.sourceCaches[F.source].getSource().type!=="raster"&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},R.prototype._flattenAndSortRenderedFeatures=function(F){for(var q=this,ae=function(dn){return q._layers[dn].type==="fill-extrusion"},he={},xe=[],ke=this._order.length-1;ke>=0;ke--){var Le=this._order[ke];if(ae(Le)){he[Le]=ke;for(var He=0,Je=F;He<Je.length;He+=1){var ot=Je[He][Le];if(ot)for(var Tt=0,Ct=ot;Tt<Ct.length;Tt+=1){var At=Ct[Tt];xe.push(At)}}}}xe.sort(function(dn,ln){return ln.intersectionZ-dn.intersectionZ});for(var Et=[],_t=this._order.length-1;_t>=0;_t--){var Ft=this._order[_t];if(ae(Ft))for(var zt=xe.length-1;zt>=0;zt--){var Vt=xe[zt].feature;if(he[Vt.layer.id]<_t)break;Et.push(Vt),xe.pop()}else for(var ir=0,gr=F;ir<gr.length;ir+=1){var Lr=gr[ir][Ft];if(Lr)for(var Ar=0,$r=Lr;Ar<$r.length;Ar+=1){var Jr=$r[Ar];Et.push(Jr.feature)}}}return Et},R.prototype.queryRenderedFeatures=function(F,q,ae){q&&q.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",q.filter,null,q);var he={};if(q&&q.layers){if(!Array.isArray(q.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var xe=0,ke=q.layers;xe<ke.length;xe+=1){var Le=ke[xe],He=this._layers[Le];if(!He)return this.fire(new e.ErrorEvent(new Error("The layer '"+Le+"' does not exist in the map's style and cannot be queried for features."))),[];he[He.source]=!0}}var Je=[];for(var ot in q.availableImages=this._availableImages,this.sourceCaches)q.layers&&!he[ot]||Je.push(U(this.sourceCaches[ot],this._layers,this._serializedLayers,F,q,ae));return this.placement&&Je.push(function(Tt,Ct,At,Et,_t,Ft,zt){for(var Vt={},ir=Ft.queryRenderedSymbols(Et),gr=[],Lr=0,Ar=Object.keys(ir).map(Number);Lr<Ar.length;Lr+=1){var $r=Ar[Lr];gr.push(zt[$r])}gr.sort(te);for(var Jr=function(){var hi=ln[dn],Yr=hi.featureIndex.lookupSymbolFeatures(ir[hi.bucketInstanceId],Ct,hi.bucketIndex,hi.sourceLayerIndex,_t.filter,_t.layers,_t.availableImages,Tt);for(var Sn in Yr){var Kn=Vt[Sn]=Vt[Sn]||[],Yn=Yr[Sn];Yn.sort(function(ei,_i){var yi=hi.featureSortOrder;if(yi){var Ii=yi.indexOf(ei.featureIndex);return yi.indexOf(_i.featureIndex)-Ii}return _i.featureIndex-ei.featureIndex});for(var ai=0,di=Yn;ai<di.length;ai+=1){var Li=di[ai];Kn.push(Li)}}},dn=0,ln=gr;dn<ln.length;dn+=1)Jr();var Vn=function(hi){Vt[hi].forEach(function(Yr){var Sn=Yr.feature,Kn=Tt[hi],Yn=At[Kn.source].getFeatureState(Sn.layer["source-layer"],Sn.id);Sn.source=Sn.layer.source,Sn.layer["source-layer"]&&(Sn.sourceLayer=Sn.layer["source-layer"]),Sn.state=Yn})};for(var Xn in Vt)Vn(Xn);return Vt}(this._layers,this._serializedLayers,this.sourceCaches,F,q,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Je)},R.prototype.querySourceFeatures=function(F,q){q&&q.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",q.filter,null,q);var ae=this.sourceCaches[F];return ae?function(he,xe){for(var ke=he.getRenderableIds().map(function(Ct){return he.getTileByID(Ct)}),Le=[],He={},Je=0;Je<ke.length;Je++){var ot=ke[Je],Tt=ot.tileID.canonical.key;He[Tt]||(He[Tt]=!0,ot.querySourceFeatures(Le,xe))}return Le}(ae,q):[]},R.prototype.addSourceType=function(F,q,ae){return R.getSourceType(F)?ae(new Error('A source type called "'+F+'" already exists.')):(R.setSourceType(F,q),q.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:q.workerSourceURL},ae):ae(null,null))},R.prototype.getLight=function(){return this.light.getLight()},R.prototype.setLight=function(F,q){q===void 0&&(q={}),this._checkLoaded();var ae=this.light.getLight(),he=!1;for(var xe in F)if(!e.deepEqual(F[xe],ae[xe])){he=!0;break}if(he){var ke={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,q),this.light.updateTransitions(ke)}},R.prototype._validate=function(F,q,ae,he,xe){return xe===void 0&&(xe={}),(!xe||xe.validate!==!1)&&Qr(this,F.call(e.validateStyle,e.extend({key:q,style:this.serialize(),value:ae,styleSpec:e.styleSpec},he)))},R.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var q in this.sourceCaches)this.sourceCaches[q].clearTiles(),this.sourceCaches[q].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},R.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},R.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},R.prototype._updateSources=function(F){for(var q in this.sourceCaches)this.sourceCaches[q].update(F)},R.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},R.prototype._updatePlacement=function(F,q,ae,he,xe){xe===void 0&&(xe=!1);for(var ke=!1,Le=!1,He={},Je=0,ot=this._order;Je<ot.length;Je+=1){var Tt=ot[Je],Ct=this._layers[Tt];if(Ct.type==="symbol"){if(!He[Ct.source]){var At=this.sourceCaches[Ct.source];He[Ct.source]=At.getRenderableIds(!0).map(function(ir){return At.getTileByID(ir)}).sort(function(ir,gr){return gr.tileID.overscaledZ-ir.tileID.overscaledZ||(ir.tileID.isLessThan(gr.tileID)?-1:1)})}var Et=this.crossTileSymbolIndex.addLayer(Ct,He[Ct.source],F.center.lng);ke=ke||Et}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((xe=xe||this._layerOrderChanged||ae===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new xr(F,this._order,xe,q,ae,he,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,He),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Le=!0),ke&&this.pauseablePlacement.placement.setStale()),Le||ke)for(var _t=0,Ft=this._order;_t<Ft.length;_t+=1){var zt=Ft[_t],Vt=this._layers[zt];Vt.type==="symbol"&&this.placement.updateLayerOpacities(Vt,He[Vt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},R.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},R.prototype.getImages=function(F,q,ae){this.imageManager.getImages(q.icons,ae),this._updateTilesForChangedImages();var he=this.sourceCaches[q.source];he&&he.setDependencies(q.tileID.key,q.type,q.icons)},R.prototype.getGlyphs=function(F,q,ae){this.glyphManager.getGlyphs(q.stacks,ae)},R.prototype.getResource=function(F,q,ae){return e.makeRequest(q,ae)},R}(e.Evented);kn.getSourceType=function(C){return H[C]},kn.setSourceType=function(C,R){H[C]=R},kn.registerForPluginStateChange=e.registerForPluginStateChange;var Pn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Dn=Xi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Zn=Xi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ai=Xi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Mi=Xi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),En=Xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qn=Xi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Jn=Xi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Di=Xi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),va=Xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ba=Xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),mo=Xi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Wi=Xi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Zi=Xi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),to=Xi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ni=Xi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),go=Xi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),bo=Xi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ma=Xi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ro=Xi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_o=Xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Co=Xi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Va=Xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ya=Xi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Qa=Xi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Cs=Xi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Rs=Xi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Xi(C,R){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,q={};return{fragmentSource:C=C.replace(F,function(ae,he,xe,ke,Le){return q[Le]=!0,he==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
varying `+xe+" "+ke+" "+Le+`;
#else
uniform `+xe+" "+ke+" u_"+Le+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Le+`
    `+xe+" "+ke+" "+Le+" = u_"+Le+`;
#endif
`}),vertexSource:R=R.replace(F,function(ae,he,xe,ke,Le){var He=ke==="float"?"vec2":"vec4",Je=Le.match(/color/)?"color":He;return q[Le]?he==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
uniform lowp float u_`+Le+`_t;
attribute `+xe+" "+He+" a_"+Le+`;
varying `+xe+" "+ke+" "+Le+`;
#else
uniform `+xe+" "+ke+" u_"+Le+`;
#endif
`:Je==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+Le+" = a_"+Le+`;
#else
    `+xe+" "+ke+" "+Le+" = u_"+Le+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+Le+" = unpack_mix_"+Je+"(a_"+Le+", u_"+Le+`_t);
#else
    `+xe+" "+ke+" "+Le+" = u_"+Le+`;
#endif
`:he==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
uniform lowp float u_`+Le+`_t;
attribute `+xe+" "+He+" a_"+Le+`;
#else
uniform `+xe+" "+ke+" u_"+Le+`;
#endif
`:Je==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+xe+" "+ke+" "+Le+" = a_"+Le+`;
#else
    `+xe+" "+ke+" "+Le+" = u_"+Le+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+xe+" "+ke+" "+Le+" = unpack_mix_"+Je+"(a_"+Le+", u_"+Le+`_t);
#else
    `+xe+" "+ke+" "+Le+" = u_"+Le+`;
#endif
`})}}var Ts=Object.freeze({__proto__:null,prelude:Dn,background:Zn,backgroundPattern:Ai,circle:Mi,clippingMask:En,heatmap:Qn,heatmapTexture:Jn,collisionBox:Di,collisionCircle:va,debug:Ba,fill:mo,fillOutline:Wi,fillOutlinePattern:Zi,fillPattern:to,fillExtrusion:Ni,fillExtrusionPattern:go,hillshadePrepare:bo,hillshade:Ma,line:ro,lineGradient:_o,linePattern:Co,lineSDF:Va,raster:ya,symbolIcon:Qa,symbolSDF:Cs,symbolTextAndIcon:Rs}),ss=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ss.prototype.bind=function(C,R,F,q,ae,he,xe,ke){this.context=C;for(var Le=this.boundPaintVertexBuffers.length!==q.length,He=0;!Le&&He<q.length;He++)this.boundPaintVertexBuffers[He]!==q[He]&&(Le=!0);var Je=!this.vao||this.boundProgram!==R||this.boundLayoutVertexBuffer!==F||Le||this.boundIndexBuffer!==ae||this.boundVertexOffset!==he||this.boundDynamicVertexBuffer!==xe||this.boundDynamicVertexBuffer2!==ke;!C.extVertexArrayObject||Je?this.freshBind(R,F,q,ae,he,xe,ke):(C.bindVertexArrayOES.set(this.vao),xe&&xe.bind(),ae&&ae.dynamicDraw&&ae.bind(),ke&&ke.bind())},ss.prototype.freshBind=function(C,R,F,q,ae,he,xe){var ke,Le=C.numAttributes,He=this.context,Je=He.gl;if(He.extVertexArrayObject)this.vao&&this.destroy(),this.vao=He.extVertexArrayObject.createVertexArrayOES(),He.bindVertexArrayOES.set(this.vao),ke=0,this.boundProgram=C,this.boundLayoutVertexBuffer=R,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=q,this.boundVertexOffset=ae,this.boundDynamicVertexBuffer=he,this.boundDynamicVertexBuffer2=xe;else{ke=He.currentNumAttributes||0;for(var ot=Le;ot<ke;ot++)Je.disableVertexAttribArray(ot)}R.enableAttributes(Je,C);for(var Tt=0,Ct=F;Tt<Ct.length;Tt+=1)Ct[Tt].enableAttributes(Je,C);he&&he.enableAttributes(Je,C),xe&&xe.enableAttributes(Je,C),R.bind(),R.setVertexAttribPointers(Je,C,ae);for(var At=0,Et=F;At<Et.length;At+=1){var _t=Et[At];_t.bind(),_t.setVertexAttribPointers(Je,C,ae)}he&&(he.bind(),he.setVertexAttribPointers(Je,C,ae)),q&&q.bind(),xe&&(xe.bind(),xe.setVertexAttribPointers(Je,C,ae)),He.currentNumAttributes=Le},ss.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Fs=function(C,R,F,q,ae){var he=C.gl;this.program=he.createProgram();var xe=F?F.defines():[];ae&&xe.push("#define OVERDRAW_INSPECTOR;");var ke=xe.concat(Dn.fragmentSource,R.fragmentSource).join(`
`),Le=xe.concat(Dn.vertexSource,R.vertexSource).join(`
`),He=he.createShader(he.FRAGMENT_SHADER);if(he.isContextLost())this.failedToCreate=!0;else{he.shaderSource(He,ke),he.compileShader(He),he.attachShader(this.program,He);var Je=he.createShader(he.VERTEX_SHADER);if(he.isContextLost())this.failedToCreate=!0;else{he.shaderSource(Je,Le),he.compileShader(Je),he.attachShader(this.program,Je);for(var ot=F?F.layoutAttributes:[],Tt=0;Tt<ot.length;Tt++)he.bindAttribLocation(this.program,Tt,ot[Tt].name);he.linkProgram(this.program),he.deleteShader(Je),he.deleteShader(He),this.numAttributes=he.getProgramParameter(this.program,he.ACTIVE_ATTRIBUTES),this.attributes={};for(var Ct={},At=0;At<this.numAttributes;At++){var Et=he.getActiveAttrib(this.program,At);Et&&(this.attributes[Et.name]=he.getAttribLocation(this.program,Et.name))}for(var _t=he.getProgramParameter(this.program,he.ACTIVE_UNIFORMS),Ft=0;Ft<_t;Ft++){var zt=he.getActiveUniform(this.program,Ft);zt&&(Ct[zt.name]=he.getUniformLocation(this.program,zt.name))}this.fixedUniforms=q(C,Ct),this.binderUniforms=F?F.getUniforms(C,Ct):[]}}};function Bs(C,R,F){var q=1/xn(F,1,R.transform.tileZoom),ae=Math.pow(2,F.tileID.overscaledZ),he=F.tileSize*Math.pow(2,R.transform.tileZoom)/ae,xe=he*(F.tileID.canonical.x+F.tileID.wrap*ae),ke=he*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[q,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[xe>>16,ke>>16],u_pixel_coord_lower:[65535&xe,65535&ke]}}Fs.prototype.draw=function(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot,Tt,Ct,At,Et){var _t,Ft=C.gl;if(!this.failedToCreate){for(var zt in C.program.set(this.program),C.setDepthMode(F),C.setStencilMode(q),C.setColorMode(ae),C.setCullFace(he),this.fixedUniforms)this.fixedUniforms[zt].set(xe[zt]);Ct&&Ct.setUniforms(C,this.binderUniforms,ot,{zoom:Tt});for(var Vt=(_t={},_t[Ft.LINES]=2,_t[Ft.TRIANGLES]=3,_t[Ft.LINE_STRIP]=1,_t)[R],ir=0,gr=Je.get();ir<gr.length;ir+=1){var Lr=gr[ir],Ar=Lr.vaos||(Lr.vaos={});(Ar[ke]||(Ar[ke]=new ss)).bind(C,this,Le,Ct?Ct.getPaintVertexBuffers():[],He,Lr.vertexOffset,At,Et),Ft.drawElements(R,Lr.primitiveLength*Vt,Ft.UNSIGNED_SHORT,Lr.primitiveOffset*Vt*2)}}};var Ps=function(C,R,F,q){var ae=R.style.light,he=ae.properties.get("position"),xe=[he.x,he.y,he.z],ke=e.create$1();ae.properties.get("anchor")==="viewport"&&e.fromRotation(ke,-R.transform.angle),e.transformMat3(xe,xe,ke);var Le=ae.properties.get("color");return{u_matrix:C,u_lightpos:xe,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_vertical_gradient:+F,u_opacity:q}},Ns=function(C,R,F,q,ae,he,xe){return e.extend(Ps(C,R,F,q),Bs(he,R,xe),{u_height_factor:-Math.pow(2,ae.overscaledZ)/xe.tileSize/8})},Do=function(C){return{u_matrix:C}},zo=function(C,R,F,q){return e.extend(Do(C),Bs(F,R,q))},Yo=function(C,R){return{u_matrix:C,u_world:R}},Wo=function(C,R,F,q,ae){return e.extend(zo(C,R,F,q),{u_world:ae})},Zo=function(C,R,F,q){var ae,he,xe=C.transform;if(q.paint.get("circle-pitch-alignment")==="map"){var ke=xn(F,1,xe.zoom);ae=!0,he=[ke,ke]}else ae=!1,he=xe.pixelsToGLUnits;return{u_camera_to_center_distance:xe.cameraToCenterDistance,u_scale_with_map:+(q.paint.get("circle-pitch-scale")==="map"),u_matrix:C.translatePosMatrix(R.posMatrix,F,q.paint.get("circle-translate"),q.paint.get("circle-translate-anchor")),u_pitch_with_map:+ae,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:he}},ls=function(C,R,F){var q=xn(F,1,R.zoom),ae=Math.pow(2,R.zoom-F.tileID.overscaledZ),he=F.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:R.cameraToCenterDistance,u_pixels_to_tile_units:q,u_extrude_scale:[R.pixelsToGLUnits[0]/(q*ae),R.pixelsToGLUnits[1]/(q*ae)],u_overscale_factor:he}},wo=function(C,R,F){return{u_matrix:C,u_inv_matrix:R,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},ks=function(C,R,F){return F===void 0&&(F=1),{u_matrix:C,u_color:R,u_overlay:0,u_overlay_scale:F}},vo=function(C){return{u_matrix:C}},Xo=function(C,R,F,q){return{u_matrix:C,u_extrude_scale:xn(R,1,F),u_intensity:q}};function Ms(C,R){var F=Math.pow(2,R.canonical.z),q=R.canonical.y;return[new e.MercatorCoordinate(0,q/F).toLngLat().lat,new e.MercatorCoordinate(0,(q+1)/F).toLngLat().lat]}var Ro=function(C,R,F){var q=C.transform;return{u_matrix:ut(C,R,F),u_ratio:1/xn(R,1,q.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/q.pixelsToGLUnits[0],1/q.pixelsToGLUnits[1]]}},Gi=function(C,R,F){return e.extend(Ro(C,R,F),{u_image:0})},Ue=function(C,R,F,q){var ae=C.transform,he=rt(R,ae);return{u_matrix:ut(C,R,F),u_texsize:R.imageAtlasTexture.size,u_ratio:1/xn(R,1,ae.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[he,q.fromScale,q.toScale],u_fade:q.t,u_units_to_pixels:[1/ae.pixelsToGLUnits[0],1/ae.pixelsToGLUnits[1]]}},We=function(C,R,F,q,ae){var he=C.transform,xe=C.lineAtlas,ke=rt(R,he),Le=F.layout.get("line-cap")==="round",He=xe.getDash(q.from,Le),Je=xe.getDash(q.to,Le),ot=He.width*ae.fromScale,Tt=Je.width*ae.toScale;return e.extend(Ro(C,R,F),{u_patternscale_a:[ke/ot,-He.height/2],u_patternscale_b:[ke/Tt,-Je.height/2],u_sdfgamma:xe.width/(256*Math.min(ot,Tt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:He.y,u_tex_y_b:Je.y,u_mix:ae.t})};function rt(C,R){return 1/xn(C,1,R.tileZoom)}function ut(C,R,F){return C.translatePosMatrix(R.tileID.posMatrix,R,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var yt=function(C,R,F,q,ae){return{u_matrix:C,u_tl_parent:R,u_scale_parent:F,u_buffer_scale:1,u_fade_t:q.mix,u_opacity:q.opacity*ae.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ae.paint.get("raster-brightness-min"),u_brightness_high:ae.paint.get("raster-brightness-max"),u_saturation_factor:(xe=ae.paint.get("raster-saturation"),xe>0?1-1/(1.001-xe):-xe),u_contrast_factor:(he=ae.paint.get("raster-contrast"),he>0?1/(1-he):1+he),u_spin_weights:mt(ae.paint.get("raster-hue-rotate"))};var he,xe};function mt(C){C*=Math.PI/180;var R=Math.sin(C),F=Math.cos(C);return[(2*F+1)/3,(-Math.sqrt(3)*R-F+1)/3,(Math.sqrt(3)*R-F+1)/3]}var Lt,$t=function(C,R,F,q,ae,he,xe,ke,Le,He){var Je=ae.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:R?R.uSizeT:0,u_size:R?R.uSize:0,u_camera_to_center_distance:Je.cameraToCenterDistance,u_pitch:Je.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:Je.width/Je.height,u_fade_change:ae.options.fadeDuration?ae.symbolFadeChange:1,u_matrix:he,u_label_plane_matrix:xe,u_coord_matrix:ke,u_is_text:+Le,u_pitch_with_map:+q,u_texsize:He,u_texture:0}},er=function(C,R,F,q,ae,he,xe,ke,Le,He,Je){var ot=ae.transform;return e.extend($t(C,R,F,q,ae,he,xe,ke,Le,He),{u_gamma_scale:q?Math.cos(ot._pitch)*ot.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Je})},Zt=function(C,R,F,q,ae,he,xe,ke,Le,He){return e.extend(er(C,R,F,q,ae,he,xe,ke,!0,Le,!0),{u_texsize_icon:He,u_texture_icon:1})},or=function(C,R,F){return{u_matrix:C,u_opacity:R,u_color:F}},mr=function(C,R,F,q,ae,he){return e.extend(function(xe,ke,Le,He){var Je=Le.imageManager.getPattern(xe.from.toString()),ot=Le.imageManager.getPattern(xe.to.toString()),Tt=Le.imageManager.getPixelSize(),Ct=Tt.width,At=Tt.height,Et=Math.pow(2,He.tileID.overscaledZ),_t=He.tileSize*Math.pow(2,Le.transform.tileZoom)/Et,Ft=_t*(He.tileID.canonical.x+He.tileID.wrap*Et),zt=_t*He.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Je.tl,u_pattern_br_a:Je.br,u_pattern_tl_b:ot.tl,u_pattern_br_b:ot.br,u_texsize:[Ct,At],u_mix:ke.t,u_pattern_size_a:Je.displaySize,u_pattern_size_b:ot.displaySize,u_scale_a:ke.fromScale,u_scale_b:ke.toScale,u_tile_units_to_pixels:1/xn(He,1,Le.transform.tileZoom),u_pixel_coord_upper:[Ft>>16,zt>>16],u_pixel_coord_lower:[65535&Ft,65535&zt]}}(q,he,F,ae),{u_matrix:C,u_opacity:R})},wr={fillExtrusion:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fillExtrusionPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_height_factor:new e.Uniform1f(C,R.u_height_factor),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fill:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},fillPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},fillOutline:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world)}},fillOutlinePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},circle:function(C,R){return{u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(C,R.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},collisionBox:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(C,R.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_overscale_factor:new e.Uniform1f(C,R.u_overscale_factor)}},collisionCircle:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_inv_matrix:new e.UniformMatrix4f(C,R.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(C,R.u_viewport_size)}},debug:function(C,R){return{u_color:new e.UniformColor(C,R.u_color),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_overlay:new e.Uniform1i(C,R.u_overlay),u_overlay_scale:new e.Uniform1f(C,R.u_overlay_scale)}},clippingMask:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmap:function(C,R){return{u_extrude_scale:new e.Uniform1f(C,R.u_extrude_scale),u_intensity:new e.Uniform1f(C,R.u_intensity),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmapTexture:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_color_ramp:new e.Uniform1i(C,R.u_color_ramp),u_opacity:new e.Uniform1f(C,R.u_opacity)}},hillshade:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_latrange:new e.Uniform2f(C,R.u_latrange),u_light:new e.Uniform2f(C,R.u_light),u_shadow:new e.UniformColor(C,R.u_shadow),u_highlight:new e.UniformColor(C,R.u_highlight),u_accent:new e.UniformColor(C,R.u_accent)}},hillshadePrepare:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_dimension:new e.Uniform2f(C,R.u_dimension),u_zoom:new e.Uniform1f(C,R.u_zoom),u_maxzoom:new e.Uniform1f(C,R.u_maxzoom),u_unpack:new e.Uniform4f(C,R.u_unpack)}},line:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels)}},lineGradient:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_image:new e.Uniform1i(C,R.u_image)}},linePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_texsize:new e.Uniform2f(C,R.u_texsize),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_image:new e.Uniform1i(C,R.u_image),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},lineSDF:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(C,R.u_patternscale_a),u_patternscale_b:new e.Uniform2f(C,R.u_patternscale_b),u_sdfgamma:new e.Uniform1f(C,R.u_sdfgamma),u_image:new e.Uniform1i(C,R.u_image),u_tex_y_a:new e.Uniform1f(C,R.u_tex_y_a),u_tex_y_b:new e.Uniform1f(C,R.u_tex_y_b),u_mix:new e.Uniform1f(C,R.u_mix)}},raster:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_tl_parent:new e.Uniform2f(C,R.u_tl_parent),u_scale_parent:new e.Uniform1f(C,R.u_scale_parent),u_buffer_scale:new e.Uniform1f(C,R.u_buffer_scale),u_fade_t:new e.Uniform1f(C,R.u_fade_t),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image0:new e.Uniform1i(C,R.u_image0),u_image1:new e.Uniform1i(C,R.u_image1),u_brightness_low:new e.Uniform1f(C,R.u_brightness_low),u_brightness_high:new e.Uniform1f(C,R.u_brightness_high),u_saturation_factor:new e.Uniform1f(C,R.u_saturation_factor),u_contrast_factor:new e.Uniform1f(C,R.u_contrast_factor),u_spin_weights:new e.Uniform3f(C,R.u_spin_weights)}},symbolIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture)}},symbolSDF:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},symbolTextAndIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texsize_icon:new e.Uniform2f(C,R.u_texsize_icon),u_texture:new e.Uniform1i(C,R.u_texture),u_texture_icon:new e.Uniform1i(C,R.u_texture_icon),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},background:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_color:new e.UniformColor(C,R.u_color)}},backgroundPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image:new e.Uniform1i(C,R.u_image),u_pattern_tl_a:new e.Uniform2f(C,R.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(C,R.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(C,R.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(C,R.u_pattern_br_b),u_texsize:new e.Uniform2f(C,R.u_texsize),u_mix:new e.Uniform1f(C,R.u_mix),u_pattern_size_a:new e.Uniform2f(C,R.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(C,R.u_pattern_size_b),u_scale_a:new e.Uniform1f(C,R.u_scale_a),u_scale_b:new e.Uniform1f(C,R.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(C,R.u_tile_units_to_pixels)}}};function Tr(C,R,F,q,ae,he,xe){for(var ke=C.context,Le=ke.gl,He=C.useProgram("collisionBox"),Je=[],ot=0,Tt=0,Ct=0;Ct<q.length;Ct++){var At=q[Ct],Et=R.getTile(At),_t=Et.getBucket(F);if(_t){var Ft=At.posMatrix;ae[0]===0&&ae[1]===0||(Ft=C.translatePosMatrix(At.posMatrix,Et,ae,he));var zt=xe?_t.textCollisionBox:_t.iconCollisionBox,Vt=_t.collisionCircleArray;if(Vt.length>0){var ir=e.create(),gr=Ft;e.mul(ir,_t.placementInvProjMatrix,C.transform.glCoordMatrix),e.mul(ir,ir,_t.placementViewportMatrix),Je.push({circleArray:Vt,circleOffset:Tt,transform:gr,invTransform:ir}),Tt=ot+=Vt.length/4}zt&&He.draw(ke,Le.LINES,Dt.disabled,Ne.disabled,C.colorModeForRenderPass(),pe.disabled,ls(Ft,C.transform,Et),F.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,null,C.transform.zoom,null,null,zt.collisionVertexBuffer)}}if(xe&&Je.length){var Lr=C.useProgram("collisionCircle"),Ar=new e.StructArrayLayout2f1f2i16;Ar.resize(4*ot),Ar._trim();for(var $r=0,Jr=0,dn=Je;Jr<dn.length;Jr+=1)for(var ln=dn[Jr],Vn=0;Vn<ln.circleArray.length/4;Vn++){var Xn=4*Vn,hi=ln.circleArray[Xn+0],Yr=ln.circleArray[Xn+1],Sn=ln.circleArray[Xn+2],Kn=ln.circleArray[Xn+3];Ar.emplace($r++,hi,Yr,Sn,Kn,0),Ar.emplace($r++,hi,Yr,Sn,Kn,1),Ar.emplace($r++,hi,Yr,Sn,Kn,2),Ar.emplace($r++,hi,Yr,Sn,Kn,3)}(!Lt||Lt.length<2*ot)&&(Lt=function(yi){var Ii=2*yi,wi=new e.StructArrayLayout3ui6;wi.resize(Ii),wi._trim();for(var Oi=0;Oi<Ii;Oi++){var Hi=6*Oi;wi.uint16[Hi+0]=4*Oi+0,wi.uint16[Hi+1]=4*Oi+1,wi.uint16[Hi+2]=4*Oi+2,wi.uint16[Hi+3]=4*Oi+2,wi.uint16[Hi+4]=4*Oi+3,wi.uint16[Hi+5]=4*Oi+0}return wi}(ot));for(var Yn=ke.createIndexBuffer(Lt,!0),ai=ke.createVertexBuffer(Ar,e.collisionCircleLayout.members,!0),di=0,Li=Je;di<Li.length;di+=1){var ei=Li[di],_i=wo(ei.transform,ei.invTransform,C.transform);Lr.draw(ke,Le.TRIANGLES,Dt.disabled,Ne.disabled,C.colorModeForRenderPass(),pe.disabled,_i,F.id,ai,Yn,e.SegmentVector.simpleSegment(0,2*ei.circleOffset,ei.circleArray.length,ei.circleArray.length/2),null,C.transform.zoom,null,null,null)}ai.destroy(),Yn.destroy()}}var Rr=e.identity(new Float32Array(16));function on(C,R,F,q,ae,he){var xe=e.getAnchorAlignment(C),ke=-(xe.horizontalAlign-.5)*R,Le=-(xe.verticalAlign-.5)*F,He=e.evaluateVariableOffset(C,q);return new e.Point((ke/ae+He[0])*he,(Le/ae+He[1])*he)}function mn(C,R,F,q,ae,he,xe,ke,Le,He,Je){var ot=C.text.placedSymbolArray,Tt=C.text.dynamicLayoutVertexArray,Ct=C.icon.dynamicLayoutVertexArray,At={};Tt.clear();for(var Et=0;Et<ot.length;Et++){var _t=ot.get(Et),Ft=C.allowVerticalPlacement&&!_t.placedOrientation,zt=_t.hidden||!_t.crossTileID||Ft?null:q[_t.crossTileID];if(zt){var Vt=new e.Point(_t.anchorX,_t.anchorY),ir=Qt(Vt,F?ke:xe),gr=tr(he.cameraToCenterDistance,ir.signedDistanceFromCamera),Lr=ae.evaluateSizeForFeature(C.textSizeData,He,_t)*gr/e.ONE_EM;F&&(Lr*=C.tilePixelRatio/Le);for(var Ar=zt.width,$r=zt.height,Jr=on(zt.anchor,Ar,$r,zt.textOffset,zt.textBoxScale,Lr),dn=F?Qt(Vt.add(Jr),xe).point:ir.point.add(R?Jr.rotate(-he.angle):Jr),ln=C.allowVerticalPlacement&&_t.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Vn=0;Vn<_t.numGlyphs;Vn++)e.addDynamicAttributes(Tt,dn,ln);Je&&_t.associatedIconIndex>=0&&(At[_t.associatedIconIndex]={shiftedAnchor:dn,angle:ln})}else tn(_t.numGlyphs,Tt)}if(Je){Ct.clear();for(var Xn=C.icon.placedSymbolArray,hi=0;hi<Xn.length;hi++){var Yr=Xn.get(hi);if(Yr.hidden)tn(Yr.numGlyphs,Ct);else{var Sn=At[hi];if(Sn)for(var Kn=0;Kn<Yr.numGlyphs;Kn++)e.addDynamicAttributes(Ct,Sn.shiftedAnchor,Sn.angle);else tn(Yr.numGlyphs,Ct)}}C.icon.dynamicLayoutVertexBuffer.updateData(Ct)}C.text.dynamicLayoutVertexBuffer.updateData(Tt)}function In(C,R,F){return F.iconsInText&&R?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function zn(C,R,F,q,ae,he,xe,ke,Le,He,Je,ot){for(var Tt=C.context,Ct=Tt.gl,At=C.transform,Et=ke==="map",_t=Le==="map",Ft=Et&&F.layout.get("symbol-placement")!=="point",zt=Et&&!_t&&!Ft,Vt=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,ir=C.depthModeForSublayer(0,Dt.ReadOnly),gr=F.layout.get("text-variable-anchor"),Lr=[],Ar=0,$r=q;Ar<$r.length;Ar+=1){var Jr=$r[Ar],dn=R.getTile(Jr),ln=dn.getBucket(F);if(ln){var Vn=ae?ln.text:ln.icon;if(Vn&&Vn.segments.get().length){var Xn=Vn.programConfigurations.get(F.id),hi=ae||ln.sdfIcons,Yr=ae?ln.textSizeData:ln.iconSizeData,Sn=_t||At.pitch!==0,Kn=C.useProgram(In(hi,ae,ln),Xn),Yn=e.evaluateSizeForZoom(Yr,At.zoom),ai=void 0,di=[0,0],Li=void 0,ei=void 0,_i=null,yi=void 0;if(ae){if(Li=dn.glyphAtlasTexture,ei=Ct.LINEAR,ai=dn.glyphAtlasTexture.size,ln.iconsInText){di=dn.imageAtlasTexture.size,_i=dn.imageAtlasTexture;var Ii=Yr.kind==="composite"||Yr.kind==="camera";yi=Sn||C.options.rotating||C.options.zooming||Ii?Ct.LINEAR:Ct.NEAREST}}else{var wi=F.layout.get("icon-size").constantOr(0)!==1||ln.iconsNeedLinear;Li=dn.imageAtlasTexture,ei=hi||C.options.rotating||C.options.zooming||wi||Sn?Ct.LINEAR:Ct.NEAREST,ai=dn.imageAtlasTexture.size}var Oi=xn(dn,1,C.transform.zoom),Hi=Mr(Jr.posMatrix,_t,Et,C.transform,Oi),da=hr(Jr.posMatrix,_t,Et,C.transform,Oi),Ra=gr&&ln.hasTextData(),Fa=F.layout.get("icon-text-fit")!=="none"&&Ra&&ln.hasIconData();Ft&&fr(ln,Jr.posMatrix,C,ae,Hi,da,_t,He);var pa=C.translatePosMatrix(Jr.posMatrix,dn,he,xe),Ea=Ft||ae&&gr||Fa?Rr:Hi,ba=C.translatePosMatrix(da,dn,he,xe,!0),Mo=hi&&F.paint.get(ae?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ja={program:Kn,buffers:Vn,uniformValues:hi?ln.iconsInText?Zt(Yr.kind,Yn,zt,_t,C,pa,Ea,ba,ai,di):er(Yr.kind,Yn,zt,_t,C,pa,Ea,ba,ae,ai,!0):$t(Yr.kind,Yn,zt,_t,C,pa,Ea,ba,ae,ai),atlasTexture:Li,atlasTextureIcon:_i,atlasInterpolation:ei,atlasInterpolationIcon:yi,isSDF:hi,hasHalo:Mo};if(Vt)for(var Vo=0,Os=Vn.segments.get();Vo<Os.length;Vo+=1){var ol=Os[Vo];Lr.push({segments:new e.SegmentVector([ol]),sortKey:ol.sortKey,state:Ja})}else Lr.push({segments:Vn.segments,sortKey:0,state:Ja})}}}Vt&&Lr.sort(function(Wl,hs){return Wl.sortKey-hs.sortKey});for(var Yl=0,Cl=Lr;Yl<Cl.length;Yl+=1){var Pl=Cl[Yl],Ao=Pl.state;if(Tt.activeTexture.set(Ct.TEXTURE0),Ao.atlasTexture.bind(Ao.atlasInterpolation,Ct.CLAMP_TO_EDGE),Ao.atlasTextureIcon&&(Tt.activeTexture.set(Ct.TEXTURE1),Ao.atlasTextureIcon&&Ao.atlasTextureIcon.bind(Ao.atlasInterpolationIcon,Ct.CLAMP_TO_EDGE)),Ao.isSDF){var ml=Ao.uniformValues;Ao.hasHalo&&(ml.u_is_halo=1,qn(Ao.buffers,Pl.segments,F,C,Ao.program,ir,Je,ot,ml)),ml.u_is_halo=0}qn(Ao.buffers,Pl.segments,F,C,Ao.program,ir,Je,ot,Ao.uniformValues)}}function qn(C,R,F,q,ae,he,xe,ke,Le){var He=q.context,Je=He.gl;ae.draw(He,Je.TRIANGLES,he,xe,ke,pe.disabled,Le,F.id,C.layoutVertexBuffer,C.indexBuffer,R,F.paint,q.transform.zoom,C.programConfigurations.get(F.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Rn(C,R,F,q,ae,he,xe){var ke,Le,He,Je,ot,Tt=C.context.gl,Ct=F.paint.get("fill-pattern"),At=Ct&&Ct.constantOr(1),Et=F.getCrossfadeParameters();xe?(Le=At&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ke=Tt.LINES):(Le=At?"fillPattern":"fill",ke=Tt.TRIANGLES);for(var _t=0,Ft=q;_t<Ft.length;_t+=1){var zt=Ft[_t],Vt=R.getTile(zt);if(!At||Vt.patternsLoaded()){var ir=Vt.getBucket(F);if(ir){var gr=ir.programConfigurations.get(F.id),Lr=C.useProgram(Le,gr);At&&(C.context.activeTexture.set(Tt.TEXTURE0),Vt.imageAtlasTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE),gr.updatePaintBuffers(Et));var Ar=Ct.constantOr(null);if(Ar&&Vt.imageAtlas){var $r=Vt.imageAtlas,Jr=$r.patternPositions[Ar.to.toString()],dn=$r.patternPositions[Ar.from.toString()];Jr&&dn&&gr.setConstantPatternPositions(Jr,dn)}var ln=C.translatePosMatrix(zt.posMatrix,Vt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(xe){Je=ir.indexBuffer2,ot=ir.segments2;var Vn=[Tt.drawingBufferWidth,Tt.drawingBufferHeight];He=Le==="fillOutlinePattern"&&At?Wo(ln,C,Et,Vt,Vn):Yo(ln,Vn)}else Je=ir.indexBuffer,ot=ir.segments,He=At?zo(ln,C,Et,Vt):Do(ln);Lr.draw(C.context,ke,ae,C.stencilModeForClipping(zt),he,pe.disabled,He,F.id,ir.layoutVertexBuffer,Je,ot,F.paint,C.transform.zoom,gr)}}}}function vi(C,R,F,q,ae,he,xe){for(var ke=C.context,Le=ke.gl,He=F.paint.get("fill-extrusion-pattern"),Je=He.constantOr(1),ot=F.getCrossfadeParameters(),Tt=F.paint.get("fill-extrusion-opacity"),Ct=0,At=q;Ct<At.length;Ct+=1){var Et=At[Ct],_t=R.getTile(Et),Ft=_t.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),Vt=C.useProgram(Je?"fillExtrusionPattern":"fillExtrusion",zt);Je&&(C.context.activeTexture.set(Le.TEXTURE0),_t.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),zt.updatePaintBuffers(ot));var ir=He.constantOr(null);if(ir&&_t.imageAtlas){var gr=_t.imageAtlas,Lr=gr.patternPositions[ir.to.toString()],Ar=gr.patternPositions[ir.from.toString()];Lr&&Ar&&zt.setConstantPatternPositions(Lr,Ar)}var $r=C.translatePosMatrix(Et.posMatrix,_t,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),Jr=F.paint.get("fill-extrusion-vertical-gradient"),dn=Je?Ns($r,C,Jr,Tt,Et,ot,_t):Ps($r,C,Jr,Tt);Vt.draw(ke,ke.gl.TRIANGLES,ae,he,xe,pe.backCCW,dn,F.id,Ft.layoutVertexBuffer,Ft.indexBuffer,Ft.segments,F.paint,C.transform.zoom,zt)}}}function Si(C,R,F,q,ae,he){var xe=C.context,ke=xe.gl,Le=R.fbo;if(Le){var He=C.useProgram("hillshade");xe.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_2D,Le.colorAttachment.get());var Je=function(ot,Tt,Ct){var At=Ct.paint.get("hillshade-shadow-color"),Et=Ct.paint.get("hillshade-highlight-color"),_t=Ct.paint.get("hillshade-accent-color"),Ft=Ct.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ct.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ft-=ot.transform.angle);var zt=!ot.options.moving;return{u_matrix:ot.transform.calculatePosMatrix(Tt.tileID.toUnwrapped(),zt),u_image:0,u_latrange:Ms(ot,Tt.tileID),u_light:[Ct.paint.get("hillshade-exaggeration"),Ft],u_shadow:At,u_highlight:Et,u_accent:_t}}(C,R,F);He.draw(xe,ke.TRIANGLES,q,ae,he,pe.disabled,Je,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}}function Ui(C,R,F,q,ae,he,xe){var ke=C.context,Le=ke.gl,He=R.dem;if(He&&He.data){var Je=He.dim,ot=He.stride,Tt=He.getPixels();if(ke.activeTexture.set(Le.TEXTURE1),ke.pixelStoreUnpackPremultiplyAlpha.set(!1),R.demTexture=R.demTexture||C.getTileTexture(ot),R.demTexture){var Ct=R.demTexture;Ct.update(Tt,{premultiply:!1}),Ct.bind(Le.NEAREST,Le.CLAMP_TO_EDGE)}else R.demTexture=new e.Texture(ke,Tt,Le.RGBA,{premultiply:!1}),R.demTexture.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);ke.activeTexture.set(Le.TEXTURE0);var At=R.fbo;if(!At){var Et=new e.Texture(ke,{width:Je,height:Je,data:null},Le.RGBA);Et.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),(At=R.fbo=ke.createFramebuffer(Je,Je,!0)).colorAttachment.set(Et.texture)}ke.bindFramebuffer.set(At.framebuffer),ke.viewport.set([0,0,Je,Je]),C.useProgram("hillshadePrepare").draw(ke,Le.TRIANGLES,ae,he,xe,pe.disabled,function(_t,Ft,zt){var Vt=Ft.stride,ir=e.create();return e.ortho(ir,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(ir,ir,[0,-e.EXTENT,0]),{u_matrix:ir,u_image:1,u_dimension:[Vt,Vt],u_zoom:_t.overscaledZ,u_maxzoom:zt,u_unpack:Ft.getUnpackVector()}}(R.tileID,He,q),F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),R.needsHillshadePrepare=!1}}function ji(C,R,F,q,ae){var he=q.paint.get("raster-fade-duration");if(he>0){var xe=e.browser.now(),ke=(xe-C.timeAdded)/he,Le=R?(xe-R.timeAdded)/he:-1,He=F.getSource(),Je=ae.coveringZoomLevel({tileSize:He.tileSize,roundZoom:He.roundZoom}),ot=!R||Math.abs(R.tileID.overscaledZ-Je)>Math.abs(C.tileID.overscaledZ-Je),Tt=ot&&C.refreshedUponExpiration?1:e.clamp(ot?ke:1-Le,0,1);return C.refreshedUponExpiration&&ke>=1&&(C.refreshedUponExpiration=!1),R?{opacity:1,mix:1-Tt}:{opacity:Tt,mix:0}}return{opacity:1,mix:0}}var Vi=new e.Color(1,0,0,1),Aa=new e.Color(0,1,0,1),Ta=new e.Color(0,0,1,1),ca=new e.Color(1,0,1,1),ua=new e.Color(0,1,1,1);function ka(C){var R=C.transform.padding;Ha(C,C.transform.height-(R.top||0),3,Vi),Ha(C,R.bottom||0,3,Aa),no(C,R.left||0,3,Ta),no(C,C.transform.width-(R.right||0),3,ca);var F=C.transform.centerPoint;(function(q,ae,he,xe){io(q,ae-1,he-10,2,20,xe),io(q,ae-10,he-1,20,2,xe)})(C,F.x,C.transform.height-F.y,ua)}function Ha(C,R,F,q){io(C,0,R+F/2,C.transform.width,F,q)}function no(C,R,F,q){io(C,R-F/2,0,F,C.transform.height,q)}function io(C,R,F,q,ae,he){var xe=C.context,ke=xe.gl;ke.enable(ke.SCISSOR_TEST),ke.scissor(R*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,q*e.browser.devicePixelRatio,ae*e.browser.devicePixelRatio),xe.clear({color:he}),ke.disable(ke.SCISSOR_TEST)}function ao(C,R,F){var q=C.context,ae=q.gl,he=F.posMatrix,xe=C.useProgram("debug"),ke=Dt.disabled,Le=Ne.disabled,He=C.colorModeForRenderPass();q.activeTexture.set(ae.TEXTURE0),C.emptyTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),xe.draw(q,ae.LINE_STRIP,ke,Le,He,pe.disabled,ks(he,e.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);var Je=R.getTileByID(F.key).latestRawTileData,ot=Je&&Je.byteLength||0,Tt=Math.floor(ot/1024),Ct=R.getTile(F).tileSize,At=512/Math.min(Ct,512)*(F.overscaledZ/C.transform.zoom)*.5,Et=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(Et+=" => "+F.overscaledZ),function(_t,Ft){_t.initDebugOverlayCanvas();var zt=_t.debugOverlayCanvas,Vt=_t.context.gl,ir=_t.debugOverlayCanvas.getContext("2d");ir.clearRect(0,0,zt.width,zt.height),ir.shadowColor="white",ir.shadowBlur=2,ir.lineWidth=1.5,ir.strokeStyle="white",ir.textBaseline="top",ir.font="bold 36px Open Sans, sans-serif",ir.fillText(Ft,5,5),ir.strokeText(Ft,5,5),_t.debugOverlayTexture.update(zt),_t.debugOverlayTexture.bind(Vt.LINEAR,Vt.CLAMP_TO_EDGE)}(C,Et+" "+Tt+"kb"),xe.draw(q,ae.TRIANGLES,ke,Le,qe.alphaBlended,pe.disabled,ks(he,e.Color.transparent,At),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}var oo={symbol:function(C,R,F,q,ae){if(C.renderPass==="translucent"){var he=Ne.disabled,xe=C.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(ke,Le,He,Je,ot,Tt,Ct){for(var At=Le.transform,Et=ot==="map",_t=Tt==="map",Ft=0,zt=ke;Ft<zt.length;Ft+=1){var Vt=zt[Ft],ir=Je.getTile(Vt),gr=ir.getBucket(He);if(gr&&gr.text&&gr.text.segments.get().length){var Lr=gr.textSizeData,Ar=e.evaluateSizeForZoom(Lr,At.zoom),$r=xn(ir,1,Le.transform.zoom),Jr=Mr(Vt.posMatrix,_t,Et,Le.transform,$r),dn=He.layout.get("icon-text-fit")!=="none"&&gr.hasIconData();if(Ar){var ln=Math.pow(2,At.zoom-ir.tileID.overscaledZ);mn(gr,Et,_t,Ct,e.symbolSize,At,Jr,Vt.posMatrix,ln,Ar,dn)}}}}(q,C,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ae),F.paint.get("icon-opacity").constantOr(1)!==0&&zn(C,R,F,q,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),he,xe),F.paint.get("text-opacity").constantOr(1)!==0&&zn(C,R,F,q,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),he,xe),R.map.showCollisionBoxes&&(Tr(C,R,F,q,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),Tr(C,R,F,q,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(C,R,F,q){if(C.renderPass==="translucent"){var ae=F.paint.get("circle-opacity"),he=F.paint.get("circle-stroke-width"),xe=F.paint.get("circle-stroke-opacity"),ke=F.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ae.constantOr(1)!==0||he.constantOr(1)!==0&&xe.constantOr(1)!==0){for(var Le=C.context,He=Le.gl,Je=C.depthModeForSublayer(0,Dt.ReadOnly),ot=Ne.disabled,Tt=C.colorModeForRenderPass(),Ct=[],At=0;At<q.length;At++){var Et=q[At],_t=R.getTile(Et),Ft=_t.getBucket(F);if(Ft){var zt=Ft.programConfigurations.get(F.id),Vt={programConfiguration:zt,program:C.useProgram("circle",zt),layoutVertexBuffer:Ft.layoutVertexBuffer,indexBuffer:Ft.indexBuffer,uniformValues:Zo(C,Et,_t,F)};if(ke)for(var ir=0,gr=Ft.segments.get();ir<gr.length;ir+=1){var Lr=gr[ir];Ct.push({segments:new e.SegmentVector([Lr]),sortKey:Lr.sortKey,state:Vt})}else Ct.push({segments:Ft.segments,sortKey:0,state:Vt})}}ke&&Ct.sort(function(Kn,Yn){return Kn.sortKey-Yn.sortKey});for(var Ar=0,$r=Ct;Ar<$r.length;Ar+=1){var Jr=$r[Ar],dn=Jr.state,ln=dn.programConfiguration,Vn=dn.program,Xn=dn.layoutVertexBuffer,hi=dn.indexBuffer,Yr=dn.uniformValues,Sn=Jr.segments;Vn.draw(Le,He.TRIANGLES,Je,ot,Tt,pe.disabled,Yr,F.id,Xn,hi,Sn,F.paint,C.transform.zoom,ln)}}}},heatmap:function(C,R,F,q){if(F.paint.get("heatmap-opacity")!==0)if(C.renderPass==="offscreen"){var ae=C.context,he=ae.gl,xe=Ne.disabled,ke=new qe([he.ONE,he.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Et,_t,Ft){var zt=Et.gl;Et.activeTexture.set(zt.TEXTURE1),Et.viewport.set([0,0,_t.width/4,_t.height/4]);var Vt=Ft.heatmapFbo;if(Vt)zt.bindTexture(zt.TEXTURE_2D,Vt.colorAttachment.get()),Et.bindFramebuffer.set(Vt.framebuffer);else{var ir=zt.createTexture();zt.bindTexture(zt.TEXTURE_2D,ir),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.LINEAR),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.LINEAR),Vt=Ft.heatmapFbo=Et.createFramebuffer(_t.width/4,_t.height/4,!1),function(gr,Lr,Ar,$r){var Jr=gr.gl,dn=gr.extRenderToTextureHalfFloat?gr.extTextureHalfFloat.HALF_FLOAT_OES:Jr.UNSIGNED_BYTE;Jr.texImage2D(Jr.TEXTURE_2D,0,Jr.RGBA,Lr.width/4,Lr.height/4,0,Jr.RGBA,dn,null),$r.colorAttachment.set(Ar)}(Et,_t,ir,Vt)}})(ae,C,F),ae.clear({color:e.Color.transparent});for(var Le=0;Le<q.length;Le++){var He=q[Le];if(!R.hasRenderableParent(He)){var Je=R.getTile(He),ot=Je.getBucket(F);if(ot){var Tt=ot.programConfigurations.get(F.id),Ct=C.useProgram("heatmap",Tt),At=C.transform.zoom;Ct.draw(ae,he.TRIANGLES,Dt.disabled,xe,ke,pe.disabled,Xo(He.posMatrix,Je,At,F.paint.get("heatmap-intensity")),F.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,F.paint,C.transform.zoom,Tt)}}}ae.viewport.set([0,0,C.width,C.height])}else C.renderPass==="translucent"&&(C.context.setColorMode(C.colorModeForRenderPass()),function(Et,_t){var Ft=Et.context,zt=Ft.gl,Vt=_t.heatmapFbo;if(!!Vt){Ft.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_2D,Vt.colorAttachment.get()),Ft.activeTexture.set(zt.TEXTURE1);var ir=_t.colorRampTexture;ir||(ir=_t.colorRampTexture=new e.Texture(Ft,_t.colorRamp,zt.RGBA)),ir.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),Et.useProgram("heatmapTexture").draw(Ft,zt.TRIANGLES,Dt.disabled,Ne.disabled,Et.colorModeForRenderPass(),pe.disabled,function(gr,Lr,Ar,$r){var Jr=e.create();e.ortho(Jr,0,gr.width,gr.height,0,0,1);var dn=gr.context.gl;return{u_matrix:Jr,u_world:[dn.drawingBufferWidth,dn.drawingBufferHeight],u_image:Ar,u_color_ramp:$r,u_opacity:Lr.paint.get("heatmap-opacity")}}(Et,_t,0,1),_t.id,Et.viewportBuffer,Et.quadTriangleIndexBuffer,Et.viewportSegments,_t.paint,Et.transform.zoom)}}(C,F))},line:function(C,R,F,q){if(C.renderPass==="translucent"){var ae=F.paint.get("line-opacity"),he=F.paint.get("line-width");if(ae.constantOr(1)!==0&&he.constantOr(1)!==0){var xe=C.depthModeForSublayer(0,Dt.ReadOnly),ke=C.colorModeForRenderPass(),Le=F.paint.get("line-dasharray"),He=F.paint.get("line-pattern"),Je=He.constantOr(1),ot=F.paint.get("line-gradient"),Tt=F.getCrossfadeParameters(),Ct=Je?"linePattern":Le?"lineSDF":ot?"lineGradient":"line",At=C.context,Et=At.gl,_t=!0;if(ot){At.activeTexture.set(Et.TEXTURE0);var Ft=F.gradientTexture;if(!F.gradient)return;Ft||(Ft=F.gradientTexture=new e.Texture(At,F.gradient,Et.RGBA)),Ft.bind(Et.LINEAR,Et.CLAMP_TO_EDGE)}for(var zt=0,Vt=q;zt<Vt.length;zt+=1){var ir=Vt[zt],gr=R.getTile(ir);if(!Je||gr.patternsLoaded()){var Lr=gr.getBucket(F);if(Lr){var Ar=Lr.programConfigurations.get(F.id),$r=C.context.program.get(),Jr=C.useProgram(Ct,Ar),dn=_t||Jr.program!==$r,ln=He.constantOr(null);if(ln&&gr.imageAtlas){var Vn=gr.imageAtlas,Xn=Vn.patternPositions[ln.to.toString()],hi=Vn.patternPositions[ln.from.toString()];Xn&&hi&&Ar.setConstantPatternPositions(Xn,hi)}var Yr=Je?Ue(C,gr,F,Tt):Le?We(C,gr,F,Le,Tt):ot?Gi(C,gr,F):Ro(C,gr,F);Je?(At.activeTexture.set(Et.TEXTURE0),gr.imageAtlasTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Tt)):Le&&(dn||C.lineAtlas.dirty)&&(At.activeTexture.set(Et.TEXTURE0),C.lineAtlas.bind(At)),Jr.draw(At,Et.TRIANGLES,xe,C.stencilModeForClipping(ir),ke,pe.disabled,Yr,F.id,Lr.layoutVertexBuffer,Lr.indexBuffer,Lr.segments,F.paint,C.transform.zoom,Ar),_t=!1}}}}}},fill:function(C,R,F,q){var ae=F.paint.get("fill-color"),he=F.paint.get("fill-opacity");if(he.constantOr(1)!==0){var xe=C.colorModeForRenderPass(),ke=F.paint.get("fill-pattern"),Le=C.opaquePassEnabledForLayer()&&!ke.constantOr(1)&&ae.constantOr(e.Color.transparent).a===1&&he.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===Le){var He=C.depthModeForSublayer(1,C.renderPass==="opaque"?Dt.ReadWrite:Dt.ReadOnly);Rn(C,R,F,q,He,xe,!1)}if(C.renderPass==="translucent"&&F.paint.get("fill-antialias")){var Je=C.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Dt.ReadOnly);Rn(C,R,F,q,Je,xe,!0)}}},"fill-extrusion":function(C,R,F,q){var ae=F.paint.get("fill-extrusion-opacity");if(ae!==0&&C.renderPass==="translucent"){var he=new Dt(C.context.gl.LEQUAL,Dt.ReadWrite,C.depthRangeFor3D);if(ae!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))vi(C,R,F,q,he,Ne.disabled,qe.disabled),vi(C,R,F,q,he,C.stencilModeFor3D(),C.colorModeForRenderPass());else{var xe=C.colorModeForRenderPass();vi(C,R,F,q,he,Ne.disabled,xe)}}},hillshade:function(C,R,F,q){if(C.renderPass==="offscreen"||C.renderPass==="translucent"){for(var ae=C.context,he=R.getSource().maxzoom,xe=C.depthModeForSublayer(0,Dt.ReadOnly),ke=C.colorModeForRenderPass(),Le=C.renderPass==="translucent"?C.stencilConfigForOverlap(q):[{},q],He=Le[0],Je=0,ot=Le[1];Je<ot.length;Je+=1){var Tt=ot[Je],Ct=R.getTile(Tt);Ct.needsHillshadePrepare&&C.renderPass==="offscreen"?Ui(C,Ct,F,he,xe,Ne.disabled,ke):C.renderPass==="translucent"&&Si(C,Ct,F,xe,He[Tt.overscaledZ],ke)}ae.viewport.set([0,0,C.width,C.height])}},raster:function(C,R,F,q){if(C.renderPass==="translucent"&&F.paint.get("raster-opacity")!==0&&q.length)for(var ae=C.context,he=ae.gl,xe=R.getSource(),ke=C.useProgram("raster"),Le=C.colorModeForRenderPass(),He=xe instanceof K?[{},q]:C.stencilConfigForOverlap(q),Je=He[0],ot=He[1],Tt=ot[ot.length-1].overscaledZ,Ct=!C.options.moving,At=0,Et=ot;At<Et.length;At+=1){var _t=Et[At],Ft=C.depthModeForSublayer(_t.overscaledZ-Tt,F.paint.get("raster-opacity")===1?Dt.ReadWrite:Dt.ReadOnly,he.LESS),zt=R.getTile(_t),Vt=C.transform.calculatePosMatrix(_t.toUnwrapped(),Ct);zt.registerFadeDuration(F.paint.get("raster-fade-duration"));var ir=R.findLoadedParent(_t,0),gr=ji(zt,ir,R,F,C.transform),Lr=void 0,Ar=void 0,$r=F.paint.get("raster-resampling")==="nearest"?he.NEAREST:he.LINEAR;ae.activeTexture.set(he.TEXTURE0),zt.texture.bind($r,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),ae.activeTexture.set(he.TEXTURE1),ir?(ir.texture.bind($r,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),Lr=Math.pow(2,ir.tileID.overscaledZ-zt.tileID.overscaledZ),Ar=[zt.tileID.canonical.x*Lr%1,zt.tileID.canonical.y*Lr%1]):zt.texture.bind($r,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST);var Jr=yt(Vt,Ar||[0,0],Lr||1,gr,F);xe instanceof K?ke.draw(ae,he.TRIANGLES,Ft,Ne.disabled,Le,pe.disabled,Jr,F.id,xe.boundsBuffer,C.quadTriangleIndexBuffer,xe.boundsSegments):ke.draw(ae,he.TRIANGLES,Ft,Je[_t.overscaledZ],Le,pe.disabled,Jr,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,R,F){var q=F.paint.get("background-color"),ae=F.paint.get("background-opacity");if(ae!==0){var he=C.context,xe=he.gl,ke=C.transform,Le=ke.tileSize,He=F.paint.get("background-pattern");if(!C.isPatternMissing(He)){var Je=!He&&q.a===1&&ae===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===Je){var ot=Ne.disabled,Tt=C.depthModeForSublayer(0,Je==="opaque"?Dt.ReadWrite:Dt.ReadOnly),Ct=C.colorModeForRenderPass(),At=C.useProgram(He?"backgroundPattern":"background"),Et=ke.coveringTiles({tileSize:Le});He&&(he.activeTexture.set(xe.TEXTURE0),C.imageManager.bind(C.context));for(var _t=F.getCrossfadeParameters(),Ft=0,zt=Et;Ft<zt.length;Ft+=1){var Vt=zt[Ft],ir=C.transform.calculatePosMatrix(Vt.toUnwrapped()),gr=He?mr(ir,ae,C,He,{tileID:Vt,tileSize:Le},_t):or(ir,ae,q);At.draw(he,xe.TRIANGLES,Tt,ot,Ct,pe.disabled,gr,F.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}}}},debug:function(C,R,F){for(var q=0;q<F.length;q++)ao(C,R,F[q])},custom:function(C,R,F){var q=C.context,ae=F.implementation;if(C.renderPass==="offscreen"){var he=ae.prerender;he&&(C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),he.call(ae,q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),q.setStencilMode(Ne.disabled);var xe=ae.renderingMode==="3d"?new Dt(C.context.gl.LEQUAL,Dt.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Dt.ReadOnly);q.setDepthMode(xe),ae.render(q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState(),q.bindFramebuffer.set(null)}}},zi=function(C,R){this.context=new be(C),this.transform=R,this._tileTextures={},this.setup(),this.numSublayers=Fe.maxUnderzooming+Fe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new qr,this.gpuTimers={}};zi.prototype.resize=function(C,R){if(this.width=C*e.browser.devicePixelRatio,this.height=R*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,q=this.style._order;F<q.length;F+=1){var ae=q[F];this.style._layers[ae].resize()}},zi.prototype.setup=function(){var C=this.context,R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=C.createVertexBuffer(R,Pn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=C.createVertexBuffer(F,Pn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var q=new e.StructArrayLayout4i8;q.emplaceBack(0,0,0,0),q.emplaceBack(e.EXTENT,0,e.EXTENT,0),q.emplaceBack(0,e.EXTENT,0,e.EXTENT),q.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=C.createVertexBuffer(q,Q.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ae=new e.StructArrayLayout2i4;ae.emplaceBack(0,0),ae.emplaceBack(1,0),ae.emplaceBack(0,1),ae.emplaceBack(1,1),this.viewportBuffer=C.createVertexBuffer(ae,Pn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var he=new e.StructArrayLayout1ui2;he.emplaceBack(0),he.emplaceBack(1),he.emplaceBack(3),he.emplaceBack(2),he.emplaceBack(0),this.tileBorderIndexBuffer=C.createIndexBuffer(he);var xe=new e.StructArrayLayout3ui6;xe.emplaceBack(0,1,2),xe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=C.createIndexBuffer(xe),this.emptyTexture=new e.Texture(C,{width:1,height:1,data:new Uint8Array([0,0,0,0])},C.gl.RGBA);var ke=this.context.gl;this.stencilClearMode=new Ne({func:ke.ALWAYS,mask:0},0,255,ke.ZERO,ke.ZERO,ke.ZERO)},zi.prototype.clearStencil=function(){var C=this.context,R=C.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[R.drawingBufferWidth,R.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(C,R.TRIANGLES,Dt.disabled,this.stencilClearMode,qe.disabled,pe.disabled,vo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},zi.prototype._renderTileClippingMasks=function(C,R){if(this.currentStencilSource!==C.source&&C.isTileClipped()&&R&&R.length){this.currentStencilSource=C.source;var F=this.context,q=F.gl;this.nextStencilID+R.length>256&&this.clearStencil(),F.setColorMode(qe.disabled),F.setDepthMode(Dt.disabled);var ae=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var he=0,xe=R;he<xe.length;he+=1){var ke=xe[he],Le=this._tileClippingMaskIDs[ke.key]=this.nextStencilID++;ae.draw(F,q.TRIANGLES,Dt.disabled,new Ne({func:q.ALWAYS,mask:0},Le,255,q.KEEP,q.KEEP,q.REPLACE),qe.disabled,pe.disabled,vo(ke.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},zi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var C=this.nextStencilID++,R=this.context.gl;return new Ne({func:R.NOTEQUAL,mask:255},C,255,R.KEEP,R.KEEP,R.REPLACE)},zi.prototype.stencilModeForClipping=function(C){var R=this.context.gl;return new Ne({func:R.EQUAL,mask:255},this._tileClippingMaskIDs[C.key],0,R.KEEP,R.KEEP,R.REPLACE)},zi.prototype.stencilConfigForOverlap=function(C){var R,F=this.context.gl,q=C.sort(function(Le,He){return He.overscaledZ-Le.overscaledZ}),ae=q[q.length-1].overscaledZ,he=q[0].overscaledZ-ae+1;if(he>1){this.currentStencilSource=void 0,this.nextStencilID+he>256&&this.clearStencil();for(var xe={},ke=0;ke<he;ke++)xe[ke+ae]=new Ne({func:F.GEQUAL,mask:255},ke+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=he,[xe,q]}return[(R={},R[ae]=Ne.disabled,R),q]},zi.prototype.colorModeForRenderPass=function(){var C=this.context.gl;return this._showOverdrawInspector?new qe([C.CONSTANT_COLOR,C.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qe.unblended:qe.alphaBlended},zi.prototype.depthModeForSublayer=function(C,R,F){if(!this.opaquePassEnabledForLayer())return Dt.disabled;var q=1-((1+this.currentLayer)*this.numSublayers+C)*this.depthEpsilon;return new Dt(F||this.context.gl.LEQUAL,R,[q,q])},zi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},zi.prototype.render=function(C,R){var F=this;this.style=C,this.options=R,this.lineAtlas=C.lineAtlas,this.imageManager=C.imageManager,this.glyphManager=C.glyphManager,this.symbolFadeChange=C.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var q=this.style._order,ae=this.style.sourceCaches;for(var he in ae){var xe=ae[he];xe.used&&xe.prepare(this.context)}var ke,Le,He={},Je={},ot={};for(var Tt in ae){var Ct=ae[Tt];He[Tt]=Ct.getVisibleCoordinates(),Je[Tt]=He[Tt].slice().reverse(),ot[Tt]=Ct.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var At=0;At<q.length;At++){var Et=q[At];if(this.style._layers[Et].is3D()){this.opaquePassCutoff=At;break}}this.renderPass="offscreen";for(var _t=0,Ft=q;_t<Ft.length;_t+=1){var zt=Ft[_t],Vt=this.style._layers[zt];if(Vt.hasOffscreenPass()&&!Vt.isHidden(this.transform.zoom)){var ir=Je[Vt.source];(Vt.type==="custom"||ir.length)&&this.renderLayer(this,ae[Vt.source],Vt,ir)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:R.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=R.showOverdrawInspector,this.depthRangeFor3D=[0,1-(C._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=q.length-1;this.currentLayer>=0;this.currentLayer--){var gr=this.style._layers[q[this.currentLayer]],Lr=ae[gr.source],Ar=He[gr.source];this._renderTileClippingMasks(gr,Ar),this.renderLayer(this,Lr,gr,Ar)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){var $r=this.style._layers[q[this.currentLayer]],Jr=ae[$r.source],dn=($r.type==="symbol"?ot:Je)[$r.source];this._renderTileClippingMasks($r,He[$r.source]),this.renderLayer(this,Jr,$r,dn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(ln){ln.source&&!ln.isHidden(F.transform.zoom)&&(ln.source!==(Le&&Le.id)&&(Le=F.style.sourceCaches[ln.source]),(!ke||ke.getSource().maxzoom<Le.getSource().maxzoom)&&(ke=Le))}),ke&&oo.debug(this,ke,ke.getVisibleCoordinates())),this.options.showPadding&&ka(this),this.context.setDefault()},zi.prototype.renderLayer=function(C,R,F,q){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="custom"||q.length)&&(this.id=F.id,this.gpuTimingStart(F),oo[F.type](C,R,F,q,this.style.placement.variableOffsets),this.gpuTimingEnd())},zi.prototype.gpuTimingStart=function(C){if(this.options.gpuTiming){var R=this.context.extTimerQuery,F=this.gpuTimers[C.id];F||(F=this.gpuTimers[C.id]={calls:0,cpuTime:0,query:R.createQueryEXT()}),F.calls++,R.beginQueryEXT(R.TIME_ELAPSED_EXT,F.query)}},zi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var C=this.context.extTimerQuery;C.endQueryEXT(C.TIME_ELAPSED_EXT)}},zi.prototype.collectGpuTimers=function(){var C=this.gpuTimers;return this.gpuTimers={},C},zi.prototype.queryGpuTimers=function(C){var R={};for(var F in C){var q=C[F],ae=this.context.extTimerQuery,he=ae.getQueryObjectEXT(q.query,ae.QUERY_RESULT_EXT)/1e6;ae.deleteQueryEXT(q.query),R[F]=he}return R},zi.prototype.translatePosMatrix=function(C,R,F,q,ae){if(!F[0]&&!F[1])return C;var he=ae?q==="map"?this.transform.angle:0:q==="viewport"?-this.transform.angle:0;if(he){var xe=Math.sin(he),ke=Math.cos(he);F=[F[0]*ke-F[1]*xe,F[0]*xe+F[1]*ke]}var Le=[ae?F[0]:xn(R,F[0],this.transform.zoom),ae?F[1]:xn(R,F[1],this.transform.zoom),0],He=new Float32Array(16);return e.translate(He,C,Le),He},zi.prototype.saveTileTexture=function(C){var R=this._tileTextures[C.size[0]];R?R.push(C):this._tileTextures[C.size[0]]=[C]},zi.prototype.getTileTexture=function(C){var R=this._tileTextures[C];return R&&R.length>0?R.pop():null},zi.prototype.isPatternMissing=function(C){if(!C)return!1;if(!C.from||!C.to)return!0;var R=this.imageManager.getPattern(C.from.toString()),F=this.imageManager.getPattern(C.to.toString());return!R||!F},zi.prototype.useProgram=function(C,R){this.cache=this.cache||{};var F=""+C+(R?R.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new Fs(this.context,Ts[C],R,wr[C],this._showOverdrawInspector)),this.cache[F]},zi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},zi.prototype.setBaseState=function(){var C=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(C.FUNC_ADD)},zi.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var C=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,C.RGBA)}},zi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var dt=function(C,R){this.points=C,this.planes=R};dt.fromInvProjectionMatrix=function(C,R,F){var q=Math.pow(2,F),ae=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(xe){return e.transformMat4([],xe,C)}).map(function(xe){return e.scale$1([],xe,1/xe[3]/R*q)}),he=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(xe){var ke=e.sub([],ae[xe[0]],ae[xe[1]]),Le=e.sub([],ae[xe[2]],ae[xe[1]]),He=e.normalize([],e.cross([],ke,Le)),Je=-e.dot(He,ae[xe[1]]);return He.concat(Je)});return new dt(ae,he)};var Rt=function(C,R){this.min=C,this.max=R,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Rt.prototype.quadrant=function(C){for(var R=[C%2==0,C<2],F=e.clone$2(this.min),q=e.clone$2(this.max),ae=0;ae<R.length;ae++)F[ae]=R[ae]?this.min[ae]:this.center[ae],q[ae]=R[ae]?this.center[ae]:this.max[ae];return q[2]=this.max[2],new Rt(F,q)},Rt.prototype.distanceX=function(C){return Math.max(Math.min(this.max[0],C[0]),this.min[0])-C[0]},Rt.prototype.distanceY=function(C){return Math.max(Math.min(this.max[1],C[1]),this.min[1])-C[1]},Rt.prototype.intersects=function(C){for(var R=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,q=0;q<C.planes.length;q++){for(var ae=C.planes[q],he=0,xe=0;xe<R.length;xe++)he+=e.dot$1(ae,R[xe])>=0;if(he===0)return 0;he!==R.length&&(F=!1)}if(F)return 2;for(var ke=0;ke<3;ke++){for(var Le=Number.MAX_VALUE,He=-Number.MAX_VALUE,Je=0;Je<C.points.length;Je++){var ot=C.points[Je][ke]-this.min[ke];Le=Math.min(Le,ot),He=Math.max(He,ot)}if(He<0||Le>this.max[ke]-this.min[ke])return 0}return 1};var cr=function(C,R,F,q){if(C===void 0&&(C=0),R===void 0&&(R=0),F===void 0&&(F=0),q===void 0&&(q=0),isNaN(C)||C<0||isNaN(R)||R<0||isNaN(F)||F<0||isNaN(q)||q<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=C,this.bottom=R,this.left=F,this.right=q};cr.prototype.interpolate=function(C,R,F){return R.top!=null&&C.top!=null&&(this.top=e.number(C.top,R.top,F)),R.bottom!=null&&C.bottom!=null&&(this.bottom=e.number(C.bottom,R.bottom,F)),R.left!=null&&C.left!=null&&(this.left=e.number(C.left,R.left,F)),R.right!=null&&C.right!=null&&(this.right=e.number(C.right,R.right,F)),this},cr.prototype.getCenter=function(C,R){var F=e.clamp((this.left+C-this.right)/2,0,C),q=e.clamp((this.top+R-this.bottom)/2,0,R);return new e.Point(F,q)},cr.prototype.equals=function(C){return this.top===C.top&&this.bottom===C.bottom&&this.left===C.left&&this.right===C.right},cr.prototype.clone=function(){return new cr(this.top,this.bottom,this.left,this.right)},cr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Gt=function(C,R,F,q,ae){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ae===void 0||ae,this._minZoom=C||0,this._maxZoom=R||22,this._minPitch=F==null?0:F,this._maxPitch=q==null?60:q,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cr,this._posMatrixCache={},this._alignedPosMatrixCache={}},ur={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Gt.prototype.clone=function(){var C=new Gt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return C.tileSize=this.tileSize,C.latRange=this.latRange,C.width=this.width,C.height=this.height,C._center=this._center,C.zoom=this.zoom,C.angle=this.angle,C._fov=this._fov,C._pitch=this._pitch,C._unmodified=this._unmodified,C._edgeInsets=this._edgeInsets.clone(),C._calcMatrices(),C},ur.minZoom.get=function(){return this._minZoom},ur.minZoom.set=function(C){this._minZoom!==C&&(this._minZoom=C,this.zoom=Math.max(this.zoom,C))},ur.maxZoom.get=function(){return this._maxZoom},ur.maxZoom.set=function(C){this._maxZoom!==C&&(this._maxZoom=C,this.zoom=Math.min(this.zoom,C))},ur.minPitch.get=function(){return this._minPitch},ur.minPitch.set=function(C){this._minPitch!==C&&(this._minPitch=C,this.pitch=Math.max(this.pitch,C))},ur.maxPitch.get=function(){return this._maxPitch},ur.maxPitch.set=function(C){this._maxPitch!==C&&(this._maxPitch=C,this.pitch=Math.min(this.pitch,C))},ur.renderWorldCopies.get=function(){return this._renderWorldCopies},ur.renderWorldCopies.set=function(C){C===void 0?C=!0:C===null&&(C=!1),this._renderWorldCopies=C},ur.worldSize.get=function(){return this.tileSize*this.scale},ur.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ur.size.get=function(){return new e.Point(this.width,this.height)},ur.bearing.get=function(){return-this.angle/Math.PI*180},ur.bearing.set=function(C){var R=-e.wrap(C,-180,180)*Math.PI/180;this.angle!==R&&(this._unmodified=!1,this.angle=R,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ur.pitch.get=function(){return this._pitch/Math.PI*180},ur.pitch.set=function(C){var R=e.clamp(C,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==R&&(this._unmodified=!1,this._pitch=R,this._calcMatrices())},ur.fov.get=function(){return this._fov/Math.PI*180},ur.fov.set=function(C){C=Math.max(.01,Math.min(60,C)),this._fov!==C&&(this._unmodified=!1,this._fov=C/180*Math.PI,this._calcMatrices())},ur.zoom.get=function(){return this._zoom},ur.zoom.set=function(C){var R=Math.min(Math.max(C,this.minZoom),this.maxZoom);this._zoom!==R&&(this._unmodified=!1,this._zoom=R,this.scale=this.zoomScale(R),this.tileZoom=Math.floor(R),this.zoomFraction=R-this.tileZoom,this._constrain(),this._calcMatrices())},ur.center.get=function(){return this._center},ur.center.set=function(C){C.lat===this._center.lat&&C.lng===this._center.lng||(this._unmodified=!1,this._center=C,this._constrain(),this._calcMatrices())},ur.padding.get=function(){return this._edgeInsets.toJSON()},ur.padding.set=function(C){this._edgeInsets.equals(C)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,C,1),this._calcMatrices())},ur.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Gt.prototype.isPaddingEqual=function(C){return this._edgeInsets.equals(C)},Gt.prototype.interpolatePadding=function(C,R,F){this._unmodified=!1,this._edgeInsets.interpolate(C,R,F),this._constrain(),this._calcMatrices()},Gt.prototype.coveringZoomLevel=function(C){var R=(C.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/C.tileSize));return Math.max(0,R)},Gt.prototype.getVisibleUnwrappedCoordinates=function(C){var R=[new e.UnwrappedTileID(0,C)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),q=this.pointCoordinate(new e.Point(this.width,0)),ae=this.pointCoordinate(new e.Point(this.width,this.height)),he=this.pointCoordinate(new e.Point(0,this.height)),xe=Math.floor(Math.min(F.x,q.x,ae.x,he.x)),ke=Math.floor(Math.max(F.x,q.x,ae.x,he.x)),Le=xe-1;Le<=ke+1;Le++)Le!==0&&R.push(new e.UnwrappedTileID(Le,C));return R},Gt.prototype.coveringTiles=function(C){var R=this.coveringZoomLevel(C),F=R;if(C.minzoom!==void 0&&R<C.minzoom)return[];C.maxzoom!==void 0&&R>C.maxzoom&&(R=C.maxzoom);var q=e.MercatorCoordinate.fromLngLat(this.center),ae=Math.pow(2,R),he=[ae*q.x,ae*q.y,0],xe=dt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,R),ke=C.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ke=R);var Le=function(dn){return{aabb:new Rt([dn*ae,0,0],[(dn+1)*ae,ae,0]),zoom:0,x:0,y:0,wrap:dn,fullyVisible:!1}},He=[],Je=[],ot=R,Tt=C.reparseOverscaled?F:R;if(this._renderWorldCopies)for(var Ct=1;Ct<=3;Ct++)He.push(Le(-Ct)),He.push(Le(Ct));for(He.push(Le(0));He.length>0;){var At=He.pop(),Et=At.x,_t=At.y,Ft=At.fullyVisible;if(!Ft){var zt=At.aabb.intersects(xe);if(zt===0)continue;Ft=zt===2}var Vt=At.aabb.distanceX(he),ir=At.aabb.distanceY(he),gr=Math.max(Math.abs(Vt),Math.abs(ir)),Lr=3+(1<<ot-At.zoom)-2;if(At.zoom===ot||gr>Lr&&At.zoom>=ke)Je.push({tileID:new e.OverscaledTileID(At.zoom===ot?Tt:At.zoom,At.wrap,At.zoom,Et,_t),distanceSq:e.sqrLen([he[0]-.5-Et,he[1]-.5-_t])});else for(var Ar=0;Ar<4;Ar++){var $r=(Et<<1)+Ar%2,Jr=(_t<<1)+(Ar>>1);He.push({aabb:At.aabb.quadrant(Ar),zoom:At.zoom+1,x:$r,y:Jr,wrap:At.wrap,fullyVisible:Ft})}}return Je.sort(function(dn,ln){return dn.distanceSq-ln.distanceSq}).map(function(dn){return dn.tileID})},Gt.prototype.resize=function(C,R){this.width=C,this.height=R,this.pixelsToGLUnits=[2/C,-2/R],this._constrain(),this._calcMatrices()},ur.unmodified.get=function(){return this._unmodified},Gt.prototype.zoomScale=function(C){return Math.pow(2,C)},Gt.prototype.scaleZoom=function(C){return Math.log(C)/Math.LN2},Gt.prototype.project=function(C){var R=e.clamp(C.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(C.lng)*this.worldSize,e.mercatorYfromLat(R)*this.worldSize)},Gt.prototype.unproject=function(C){return new e.MercatorCoordinate(C.x/this.worldSize,C.y/this.worldSize).toLngLat()},ur.point.get=function(){return this.project(this.center)},Gt.prototype.setLocationAtPoint=function(C,R){var F=this.pointCoordinate(R),q=this.pointCoordinate(this.centerPoint),ae=this.locationCoordinate(C),he=new e.MercatorCoordinate(ae.x-(F.x-q.x),ae.y-(F.y-q.y));this.center=this.coordinateLocation(he),this._renderWorldCopies&&(this.center=this.center.wrap())},Gt.prototype.locationPoint=function(C){return this.coordinatePoint(this.locationCoordinate(C))},Gt.prototype.pointLocation=function(C){return this.coordinateLocation(this.pointCoordinate(C))},Gt.prototype.locationCoordinate=function(C){return e.MercatorCoordinate.fromLngLat(C)},Gt.prototype.coordinateLocation=function(C){return C.toLngLat()},Gt.prototype.pointCoordinate=function(C){var R=[C.x,C.y,0,1],F=[C.x,C.y,1,1];e.transformMat4(R,R,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var q=R[3],ae=F[3],he=R[0]/q,xe=F[0]/ae,ke=R[1]/q,Le=F[1]/ae,He=R[2]/q,Je=F[2]/ae,ot=He===Je?0:(0-He)/(Je-He);return new e.MercatorCoordinate(e.number(he,xe,ot)/this.worldSize,e.number(ke,Le,ot)/this.worldSize)},Gt.prototype.coordinatePoint=function(C){var R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix),new e.Point(R[0]/R[3],R[1]/R[3])},Gt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Gt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Gt.prototype.setMaxBounds=function(C){C?(this.lngRange=[C.getWest(),C.getEast()],this.latRange=[C.getSouth(),C.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Gt.prototype.calculatePosMatrix=function(C,R){R===void 0&&(R=!1);var F=C.key,q=R?this._alignedPosMatrixCache:this._posMatrixCache;if(q[F])return q[F];var ae=C.canonical,he=this.worldSize/this.zoomScale(ae.z),xe=ae.x+Math.pow(2,ae.z)*C.wrap,ke=e.identity(new Float64Array(16));return e.translate(ke,ke,[xe*he,ae.y*he,0]),e.scale(ke,ke,[he/e.EXTENT,he/e.EXTENT,1]),e.multiply(ke,R?this.alignedProjMatrix:this.projMatrix,ke),q[F]=new Float32Array(ke),q[F]},Gt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Gt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var C,R,F,q,ae=-90,he=90,xe=-180,ke=180,Le=this.size,He=this._unmodified;if(this.latRange){var Je=this.latRange;ae=e.mercatorYfromLat(Je[1])*this.worldSize,C=(he=e.mercatorYfromLat(Je[0])*this.worldSize)-ae<Le.y?Le.y/(he-ae):0}if(this.lngRange){var ot=this.lngRange;xe=e.mercatorXfromLng(ot[0])*this.worldSize,R=(ke=e.mercatorXfromLng(ot[1])*this.worldSize)-xe<Le.x?Le.x/(ke-xe):0}var Tt=this.point,Ct=Math.max(R||0,C||0);if(Ct)return this.center=this.unproject(new e.Point(R?(ke+xe)/2:Tt.x,C?(he+ae)/2:Tt.y)),this.zoom+=this.scaleZoom(Ct),this._unmodified=He,void(this._constraining=!1);if(this.latRange){var At=Tt.y,Et=Le.y/2;At-Et<ae&&(q=ae+Et),At+Et>he&&(q=he-Et)}if(this.lngRange){var _t=Tt.x,Ft=Le.x/2;_t-Ft<xe&&(F=xe+Ft),_t+Ft>ke&&(F=ke-Ft)}F===void 0&&q===void 0||(this.center=this.unproject(new e.Point(F!==void 0?F:Tt.x,q!==void 0?q:Tt.y))),this._unmodified=He,this._constraining=!1}},Gt.prototype._calcMatrices=function(){if(this.height){var C=this._fov/2,R=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(C)*this.height;var F=Math.PI/2+this._pitch,q=this._fov*(.5+R.y/this.height),ae=Math.sin(q)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-q,.01,Math.PI-.01)),he=this.point,xe=he.x,ke=he.y,Le=1.01*(Math.cos(Math.PI/2-this._pitch)*ae+this.cameraToCenterDistance),He=this.height/50,Je=new Float64Array(16);e.perspective(Je,this._fov,this.width/this.height,He,Le),Je[8]=2*-R.x/this.width,Je[9]=2*R.y/this.height,e.scale(Je,Je,[1,-1,1]),e.translate(Je,Je,[0,0,-this.cameraToCenterDistance]),e.rotateX(Je,Je,this._pitch),e.rotateZ(Je,Je,this.angle),e.translate(Je,Je,[-xe,-ke,0]),this.mercatorMatrix=e.scale([],Je,[this.worldSize,this.worldSize,this.worldSize]),e.scale(Je,Je,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Je,this.invProjMatrix=e.invert([],this.projMatrix);var ot=this.width%2/2,Tt=this.height%2/2,Ct=Math.cos(this.angle),At=Math.sin(this.angle),Et=xe-Math.round(xe)+Ct*ot+At*Tt,_t=ke-Math.round(ke)+Ct*Tt+At*ot,Ft=new Float64Array(Je);if(e.translate(Ft,Ft,[Et>.5?Et-1:Et,_t>.5?_t-1:_t,0]),this.alignedProjMatrix=Ft,Je=e.create(),e.scale(Je,Je,[this.width/2,-this.height/2,1]),e.translate(Je,Je,[1,-1,0]),this.labelPlaneMatrix=Je,Je=e.create(),e.scale(Je,Je,[1,-1,1]),e.translate(Je,Je,[-1,-1,0]),e.scale(Je,Je,[2/this.width,2/this.height,1]),this.glCoordMatrix=Je,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Je=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Je,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Gt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var C=this.pointCoordinate(new e.Point(0,0)),R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix)[3]/this.cameraToCenterDistance},Gt.prototype.getCameraPoint=function(){var C=this._pitch,R=Math.tan(C)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,R))},Gt.prototype.getCameraQueryGeometry=function(C){var R=this.getCameraPoint();if(C.length===1)return[C[0],R];for(var F=R.x,q=R.y,ae=R.x,he=R.y,xe=0,ke=C;xe<ke.length;xe+=1){var Le=ke[xe];F=Math.min(F,Le.x),q=Math.min(q,Le.y),ae=Math.max(ae,Le.x),he=Math.max(he,Le.y)}return[new e.Point(F,q),new e.Point(ae,q),new e.Point(ae,he),new e.Point(F,he),new e.Point(F,q)]},Object.defineProperties(Gt.prototype,ur);var Or=function(C){var R,F,q,ae,he;this._hashName=C&&encodeURIComponent(C),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(R=this._updateHashUnthrottled.bind(this),F=300,q=!1,ae=null,he=function(){ae=null,q&&(R(),ae=setTimeout(he,F),q=!1)},function(){return q=!0,ae||he(),ae})};Or.prototype.addTo=function(C){return this._map=C,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Or.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Or.prototype.getHashString=function(C){var R=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,q=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ae=Math.pow(10,q),he=Math.round(R.lng*ae)/ae,xe=Math.round(R.lat*ae)/ae,ke=this._map.getBearing(),Le=this._map.getPitch(),He="";if(He+=C?"/"+he+"/"+xe+"/"+F:F+"/"+xe+"/"+he,(ke||Le)&&(He+="/"+Math.round(10*ke)/10),Le&&(He+="/"+Math.round(Le)),this._hashName){var Je=this._hashName,ot=!1,Tt=e.window.location.hash.slice(1).split("&").map(function(Ct){var At=Ct.split("=")[0];return At===Je?(ot=!0,At+"="+He):Ct}).filter(function(Ct){return Ct});return ot||Tt.push(Je+"="+He),"#"+Tt.join("&")}return"#"+He},Or.prototype._getCurrentHash=function(){var C,R=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(q){return q.split("=")}).forEach(function(q){q[0]===R._hashName&&(C=q)}),(C&&C[1]||"").split("/")):F.split("/")},Or.prototype._onHashChange=function(){var C=this._getCurrentHash();if(C.length>=3&&!C.some(function(F){return isNaN(F)})){var R=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:R,pitch:+(C[4]||0)}),!0}return!1},Or.prototype._updateHashUnthrottled=function(){var C=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",C)}catch{}};var Ur={linearity:.3,easing:e.bezier(0,0,.3,1)},Xr=e.extend({deceleration:2500,maxSpeed:1400},Ur),cn=e.extend({deceleration:20,maxSpeed:1400},Ur),sn=e.extend({deceleration:1e3,maxSpeed:360},Ur),gn=e.extend({deceleration:1e3,maxSpeed:90},Ur),Mn=function(C){this._map=C,this.clear()};function un(C,R){(!C.duration||C.duration<R.duration)&&(C.duration=R.duration,C.easing=R.easing)}function An(C,R,F){var q=F.maxSpeed,ae=F.linearity,he=F.deceleration,xe=e.clamp(C*ae/(R/1e3),-q,q),ke=Math.abs(xe)/(he*ae);return{easing:F.easing,duration:1e3*ke,amount:xe*(ke/2)}}Mn.prototype.clear=function(){this._inertiaBuffer=[]},Mn.prototype.record=function(C){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:C})},Mn.prototype._drainInertiaBuffer=function(){for(var C=this._inertiaBuffer,R=e.browser.now();C.length>0&&R-C[0].time>160;)C.shift()},Mn.prototype._onMoveEnd=function(C){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var R={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,q=this._inertiaBuffer;F<q.length;F+=1){var ae=q[F].settings;R.zoom+=ae.zoomDelta||0,R.bearing+=ae.bearingDelta||0,R.pitch+=ae.pitchDelta||0,ae.panDelta&&R.pan._add(ae.panDelta),ae.around&&(R.around=ae.around),ae.pinchAround&&(R.pinchAround=ae.pinchAround)}var he=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,xe={};if(R.pan.mag()){var ke=An(R.pan.mag(),he,e.extend({},Xr,C||{}));xe.offset=R.pan.mult(ke.amount/R.pan.mag()),xe.center=this._map.transform.center,un(xe,ke)}if(R.zoom){var Le=An(R.zoom,he,cn);xe.zoom=this._map.transform.zoom+Le.amount,un(xe,Le)}if(R.bearing){var He=An(R.bearing,he,sn);xe.bearing=this._map.transform.bearing+e.clamp(He.amount,-179,179),un(xe,He)}if(R.pitch){var Je=An(R.pitch,he,gn);xe.pitch=this._map.transform.pitch+Je.amount,un(xe,Je)}if(xe.zoom||xe.bearing){var ot=R.pinchAround===void 0?R.around:R.pinchAround;xe.around=ot?this._map.unproject(ot):this._map.getCenter()}return this.clear(),e.extend(xe,{noMoveStart:!0})}};var Bn=function(C){function R(q,ae,he,xe){xe===void 0&&(xe={});var ke=n.mousePos(ae.getCanvasContainer(),he),Le=ae.unproject(ke);C.call(this,q,e.extend({point:ke,lngLat:Le,originalEvent:he},xe)),this._defaultPrevented=!1,this.target=ae}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Hn=function(C){function R(q,ae,he){var xe=q==="touchend"?he.changedTouches:he.touches,ke=n.touchPos(ae.getCanvasContainer(),xe),Le=ke.map(function(ot){return ae.unproject(ot)}),He=ke.reduce(function(ot,Tt,Ct,At){return ot.add(Tt.div(At.length))},new e.Point(0,0)),Je=ae.unproject(He);C.call(this,q,{points:ke,point:He,lngLats:Le,lngLat:Je,originalEvent:he}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),si=function(C){function R(q,ae,he){C.call(this,q,{originalEvent:he}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Kr=function(C,R){this._map=C,this._clickTolerance=R.clickTolerance};Kr.prototype.reset=function(){delete this._mousedownPos},Kr.prototype.wheel=function(C){return this._firePreventable(new si(C.type,this._map,C))},Kr.prototype.mousedown=function(C,R){return this._mousedownPos=R,this._firePreventable(new Bn(C.type,this._map,C))},Kr.prototype.mouseup=function(C){this._map.fire(new Bn(C.type,this._map,C))},Kr.prototype.click=function(C,R){this._mousedownPos&&this._mousedownPos.dist(R)>=this._clickTolerance||this._map.fire(new Bn(C.type,this._map,C))},Kr.prototype.dblclick=function(C){return this._firePreventable(new Bn(C.type,this._map,C))},Kr.prototype.mouseover=function(C){this._map.fire(new Bn(C.type,this._map,C))},Kr.prototype.mouseout=function(C){this._map.fire(new Bn(C.type,this._map,C))},Kr.prototype.touchstart=function(C){return this._firePreventable(new Hn(C.type,this._map,C))},Kr.prototype.touchmove=function(C){this._map.fire(new Hn(C.type,this._map,C))},Kr.prototype.touchend=function(C){this._map.fire(new Hn(C.type,this._map,C))},Kr.prototype.touchcancel=function(C){this._map.fire(new Hn(C.type,this._map,C))},Kr.prototype._firePreventable=function(C){if(this._map.fire(C),C.defaultPrevented)return{}},Kr.prototype.isEnabled=function(){return!0},Kr.prototype.isActive=function(){return!1},Kr.prototype.enable=function(){},Kr.prototype.disable=function(){};var ni=function(C){this._map=C};ni.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ni.prototype.mousemove=function(C){this._map.fire(new Bn(C.type,this._map,C))},ni.prototype.mousedown=function(){this._delayContextMenu=!0},ni.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Bn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ni.prototype.contextmenu=function(C){this._delayContextMenu?this._contextMenuEvent=C:this._map.fire(new Bn(C.type,this._map,C)),this._map.listens("contextmenu")&&C.preventDefault()},ni.prototype.isEnabled=function(){return!0},ni.prototype.isActive=function(){return!1},ni.prototype.enable=function(){},ni.prototype.disable=function(){};var On=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._container=C.getContainer(),this._clickTolerance=R.clickTolerance||1};function Un(C,R){for(var F={},q=0;q<C.length;q++)F[C[q].identifier]=R[q];return F}On.prototype.isEnabled=function(){return!!this._enabled},On.prototype.isActive=function(){return!!this._active},On.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},On.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},On.prototype.mousedown=function(C,R){this.isEnabled()&&C.shiftKey&&C.button===0&&(n.disableDrag(),this._startPos=this._lastPos=R,this._active=!0)},On.prototype.mousemoveWindow=function(C,R){if(this._active){var F=R;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var q=this._startPos;this._lastPos=F,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",C));var ae=Math.min(q.x,F.x),he=Math.max(q.x,F.x),xe=Math.min(q.y,F.y),ke=Math.max(q.y,F.y);n.setTransform(this._box,"translate("+ae+"px,"+xe+"px)"),this._box.style.width=he-ae+"px",this._box.style.height=ke-xe+"px"}}},On.prototype.mouseupWindow=function(C,R){var F=this;if(this._active&&C.button===0){var q=this._startPos,ae=R;if(this.reset(),n.suppressClick(),q.x!==ae.x||q.y!==ae.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:C})),{cameraAnimation:function(he){return he.fitScreenCoordinates(q,ae,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",C)}},On.prototype.keydown=function(C){this._active&&C.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",C))},On.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},On.prototype._fireEvent=function(C,R){return this._map.fire(new e.Event(C,{originalEvent:R}))};var ri=function(C){this.reset(),this.numTouches=C.numTouches};ri.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ri.prototype.touchstart=function(C,R,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=C.timeStamp),F.length===this.numTouches&&(this.centroid=function(q){for(var ae=new e.Point(0,0),he=0,xe=q;he<xe.length;he+=1){var ke=xe[he];ae._add(ke)}return ae.div(q.length)}(R),this.touches=Un(F,R)))},ri.prototype.touchmove=function(C,R,F){if(!this.aborted&&this.centroid){var q=Un(F,R);for(var ae in this.touches){var he=this.touches[ae],xe=q[ae];(!xe||xe.dist(he)>30)&&(this.aborted=!0)}}},ri.prototype.touchend=function(C,R,F){if((!this.centroid||C.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){var q=!this.aborted&&this.centroid;if(this.reset(),q)return q}};var ki=function(C){this.singleTap=new ri(C),this.numTaps=C.numTaps,this.reset()};ki.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ki.prototype.touchstart=function(C,R,F){this.singleTap.touchstart(C,R,F)},ki.prototype.touchmove=function(C,R,F){this.singleTap.touchmove(C,R,F)},ki.prototype.touchend=function(C,R,F){var q=this.singleTap.touchend(C,R,F);if(q){var ae=C.timeStamp-this.lastTime<500,he=!this.lastTap||this.lastTap.dist(q)<30;if(ae&&he||this.reset(),this.count++,this.lastTime=C.timeStamp,this.lastTap=q,this.count===this.numTaps)return this.reset(),q}};var Pi=function(){this._zoomIn=new ki({numTouches:1,numTaps:2}),this._zoomOut=new ki({numTouches:2,numTaps:1}),this.reset()};Pi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Pi.prototype.touchstart=function(C,R,F){this._zoomIn.touchstart(C,R,F),this._zoomOut.touchstart(C,R,F)},Pi.prototype.touchmove=function(C,R,F){this._zoomIn.touchmove(C,R,F),this._zoomOut.touchmove(C,R,F)},Pi.prototype.touchend=function(C,R,F){var q=this,ae=this._zoomIn.touchend(C,R,F),he=this._zoomOut.touchend(C,R,F);return ae?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(xe){return xe.easeTo({duration:300,zoom:xe.getZoom()+1,around:xe.unproject(ae)},{originalEvent:C})}}):he?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(xe){return xe.easeTo({duration:300,zoom:xe.getZoom()-1,around:xe.unproject(he)},{originalEvent:C})}}):void 0},Pi.prototype.touchcancel=function(){this.reset()},Pi.prototype.enable=function(){this._enabled=!0},Pi.prototype.disable=function(){this._enabled=!1,this.reset()},Pi.prototype.isEnabled=function(){return this._enabled},Pi.prototype.isActive=function(){return this._active};var Ln=function(C){this.reset(),this._clickTolerance=C.clickTolerance||1};Ln.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ln.prototype._correctButton=function(C,R){return!1},Ln.prototype._move=function(C,R){return{}},Ln.prototype.mousedown=function(C,R){if(!this._lastPoint){var F=n.mouseButton(C);this._correctButton(C,F)&&(this._lastPoint=R,this._eventButton=F)}},Ln.prototype.mousemoveWindow=function(C,R){var F=this._lastPoint;if(F&&(C.preventDefault(),this._moved||!(R.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=R,this._move(F,R)},Ln.prototype.mouseupWindow=function(C){n.mouseButton(C)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},Ln.prototype.enable=function(){this._enabled=!0},Ln.prototype.disable=function(){this._enabled=!1,this.reset()},Ln.prototype.isEnabled=function(){return this._enabled},Ln.prototype.isActive=function(){return this._active};var Ri=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.mousedown=function(F,q){C.prototype.mousedown.call(this,F,q),this._lastPoint&&(this._active=!0)},R.prototype._correctButton=function(F,q){return q===0&&!F.ctrlKey},R.prototype._move=function(F,q){return{around:q,panDelta:q.sub(F)}},R}(Ln),Ci=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},R.prototype._move=function(F,q){var ae=.8*(q.x-F.x);if(ae)return this._active=!0,{bearingDelta:ae}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Ln),gi=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},R.prototype._move=function(F,q){var ae=-.5*(q.y-F.y);if(ae)return this._active=!0,{pitchDelta:ae}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(Ln),Fi=function(C){this._minTouches=1,this._clickTolerance=C.clickTolerance||1,this.reset()};Fi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Fi.prototype.touchstart=function(C,R,F){return this._calculateTransform(C,R,F)},Fi.prototype.touchmove=function(C,R,F){if(this._active)return C.preventDefault(),this._calculateTransform(C,R,F)},Fi.prototype.touchend=function(C,R,F){this._calculateTransform(C,R,F),this._active&&F.length<this._minTouches&&this.reset()},Fi.prototype.touchcancel=function(){this.reset()},Fi.prototype._calculateTransform=function(C,R,F){F.length>0&&(this._active=!0);var q=Un(F,R),ae=new e.Point(0,0),he=new e.Point(0,0),xe=0;for(var ke in q){var Le=q[ke],He=this._touches[ke];He&&(ae._add(Le),he._add(Le.sub(He)),xe++,q[ke]=Le)}if(this._touches=q,!(xe<this._minTouches)&&he.mag()){var Je=he.div(xe);if(this._sum._add(Je),!(this._sum.mag()<this._clickTolerance))return{around:ae.div(xe),panDelta:Je}}},Fi.prototype.enable=function(){this._enabled=!0},Fi.prototype.disable=function(){this._enabled=!1,this.reset()},Fi.prototype.isEnabled=function(){return this._enabled},Fi.prototype.isActive=function(){return this._active};var Ei=function(){this.reset()};function ra(C,R,F){for(var q=0;q<C.length;q++)if(C[q].identifier===F)return R[q]}Ei.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ei.prototype._start=function(C){},Ei.prototype._move=function(C,R,F){return{}},Ei.prototype.touchstart=function(C,R,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([R[0],R[1]]))},Ei.prototype.touchmove=function(C,R,F){if(this._firstTwoTouches){C.preventDefault();var q=this._firstTwoTouches,ae=q[0],he=q[1],xe=ra(F,R,ae),ke=ra(F,R,he);if(xe&&ke){var Le=this._aroundCenter?null:xe.add(ke).div(2);return this._move([xe,ke],Le,C)}}},Ei.prototype.touchend=function(C,R,F){if(this._firstTwoTouches){var q=this._firstTwoTouches,ae=q[0],he=q[1],xe=ra(F,R,ae),ke=ra(F,R,he);xe&&ke||(this._active&&n.suppressClick(),this.reset())}},Ei.prototype.touchcancel=function(){this.reset()},Ei.prototype.enable=function(C){this._enabled=!0,this._aroundCenter=!!C&&C.around==="center"},Ei.prototype.disable=function(){this._enabled=!1,this.reset()},Ei.prototype.isEnabled=function(){return this._enabled},Ei.prototype.isActive=function(){return this._active};function ii(C,R){return Math.log(C/R)/Math.LN2}var Ki=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._distance,delete this._startDistance},R.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},R.prototype._move=function(F,q){var ae=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(ii(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ii(this._distance,ae),pinchAround:q}},R}(Ei);function qa(C,R){return 180*C.angleWith(R)/Math.PI}var es=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},R.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},R.prototype._move=function(F,q){var ae=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qa(this._vector,ae),pinchAround:q}},R.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var q=25/(Math.PI*this._minDiameter)*360,ae=qa(F,this._startVector);return Math.abs(ae)<q},R}(Ei);function Uo(C){return Math.abs(C.y)>Math.abs(C.x)}var To=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},R.prototype._start=function(F){this._lastPoints=F,Uo(F[0].sub(F[1]))&&(this._valid=!1)},R.prototype._move=function(F,q,ae){var he=F[0].sub(this._lastPoints[0]),xe=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(he,xe,ae.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:-.5*((he.y+xe.y)/2)}},R.prototype.gestureBeginsVertically=function(F,q,ae){if(this._valid!==void 0)return this._valid;var he=F.mag()>=2,xe=q.mag()>=2;if(he||xe){if(!he||!xe)return this._firstMove===void 0&&(this._firstMove=ae),ae-this._firstMove<100&&void 0;var ke=F.y>0==q.y>0;return Uo(F)&&Uo(q)&&ke}},R}(Ei),xi={panStep:100,bearingStep:15,pitchStep:10},xa=function(){var C=xi;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep};function ko(C){return C*(2-C)}xa.prototype.reset=function(){this._active=!1},xa.prototype.keydown=function(C){var R=this;if(!(C.altKey||C.ctrlKey||C.metaKey)){var F=0,q=0,ae=0,he=0,xe=0;switch(C.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:C.shiftKey?q=-1:(C.preventDefault(),he=-1);break;case 39:C.shiftKey?q=1:(C.preventDefault(),he=1);break;case 38:C.shiftKey?ae=1:(C.preventDefault(),xe=-1);break;case 40:C.shiftKey?ae=-1:(C.preventDefault(),xe=1);break;default:return}return{cameraAnimation:function(ke){var Le=ke.getZoom();ke.easeTo({duration:300,easeId:"keyboardHandler",easing:ko,zoom:F?Math.round(Le)+F*(C.shiftKey?2:1):Le,bearing:ke.getBearing()+q*R._bearingStep,pitch:ke.getPitch()+ae*R._pitchStep,offset:[-he*R._panStep,-xe*R._panStep],center:ke.getCenter()},{originalEvent:C})}}}},xa.prototype.enable=function(){this._enabled=!0},xa.prototype.disable=function(){this._enabled=!1,this.reset()},xa.prototype.isEnabled=function(){return this._enabled},xa.prototype.isActive=function(){return this._active};var Ji=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._handler=R,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ji.prototype.setZoomRate=function(C){this._defaultZoomRate=C},Ji.prototype.setWheelZoomRate=function(C){this._wheelZoomRate=C},Ji.prototype.isEnabled=function(){return!!this._enabled},Ji.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ji.prototype.isZooming=function(){return!!this._zooming},Ji.prototype.enable=function(C){this.isEnabled()||(this._enabled=!0,this._aroundCenter=C&&C.around==="center")},Ji.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ji.prototype.wheel=function(C){if(this.isEnabled()){var R=C.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*C.deltaY:C.deltaY,F=e.browser.now(),q=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,R!==0&&R%4.000244140625==0?this._type="wheel":R!==0&&Math.abs(R)<4?this._type="trackpad":q>400?(this._type=null,this._lastValue=R,this._timeout=setTimeout(this._onTimeout,40,C)):this._type||(this._type=Math.abs(q*R)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,R+=this._lastValue)),C.shiftKey&&R&&(R/=4),this._type&&(this._lastWheelEvent=C,this._delta-=R,this._active||this._start(C)),C.preventDefault()}},Ji.prototype._onTimeout=function(C){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(C)},Ji.prototype._start=function(C){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var R=n.mousePos(this._el,C);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(R)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ji.prototype.renderFrame=function(){return this._onScrollFrame()},Ji.prototype._onScrollFrame=function(){var C=this;if(this._frameId&&(this._frameId=null,this.isActive())){var R=this._map.transform;if(this._delta!==0){var F=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,q=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&q!==0&&(q=1/q);var ae=typeof this._targetZoom=="number"?R.zoomScale(this._targetZoom):R.scale;this._targetZoom=Math.min(R.maxZoom,Math.max(R.minZoom,R.scaleZoom(ae*q))),this._type==="wheel"&&(this._startZoom=R.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var he,xe=typeof this._targetZoom=="number"?this._targetZoom:R.zoom,ke=this._startZoom,Le=this._easing,He=!1;if(this._type==="wheel"&&ke&&Le){var Je=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),ot=Le(Je);he=e.number(ke,xe,ot),Je<1?this._frameId||(this._frameId=!0):He=!0}else he=xe,He=!0;return this._active=!0,He&&(this._active=!1,this._finishTimeout=setTimeout(function(){C._zooming=!1,C._handler._triggerRenderFrame(),delete C._targetZoom,delete C._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!He,zoomDelta:he-R.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ji.prototype._smoothOutEasing=function(C){var R=e.ease;if(this._prevEase){var F=this._prevEase,q=(e.browser.now()-F.start)/F.duration,ae=F.easing(q+.01)-F.easing(q),he=.27/Math.sqrt(ae*ae+1e-4)*.01,xe=Math.sqrt(.0729-he*he);R=e.bezier(he,xe,.25,1)}return this._prevEase={start:e.browser.now(),duration:C,easing:R},R},Ji.prototype.reset=function(){this._active=!1};var Sa=function(C,R){this._clickZoom=C,this._tapZoom=R};Sa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Sa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Sa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Sa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ka=function(){this.reset()};Ka.prototype.reset=function(){this._active=!1},Ka.prototype.dblclick=function(C,R){return C.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(C.shiftKey?-1:1),around:F.unproject(R)},{originalEvent:C})}}},Ka.prototype.enable=function(){this._enabled=!0},Ka.prototype.disable=function(){this._enabled=!1,this.reset()},Ka.prototype.isEnabled=function(){return this._enabled},Ka.prototype.isActive=function(){return this._active};var ia=function(){this._tap=new ki({numTouches:1,numTaps:1}),this.reset()};ia.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ia.prototype.touchstart=function(C,R,F){this._swipePoint||(this._tapTime&&C.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=R[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(C,R,F))},ia.prototype.touchmove=function(C,R,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var q=R[0],ae=q.y-this._swipePoint.y;return this._swipePoint=q,C.preventDefault(),this._active=!0,{zoomDelta:ae/128}}}else this._tap.touchmove(C,R,F)},ia.prototype.touchend=function(C,R,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(C,R,F)&&(this._tapTime=C.timeStamp)},ia.prototype.touchcancel=function(){this.reset()},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var yo=function(C,R,F){this._el=C,this._mousePan=R,this._touchPan=F};yo.prototype.enable=function(C){this._inertiaOptions=C||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},yo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},yo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},yo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var aa=function(C,R,F){this._pitchWithRotate=C.pitchWithRotate,this._mouseRotate=R,this._mousePitch=F};aa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},aa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},aa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},aa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var so=function(C,R,F,q){this._el=C,this._touchZoom=R,this._touchRotate=F,this._tapDragZoom=q,this._rotationDisabled=!1,this._enabled=!0};so.prototype.enable=function(C){this._touchZoom.enable(C),this._rotationDisabled||this._touchRotate.enable(C),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},so.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},so.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},so.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},so.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},so.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var vs=function(C){return C.zoom||C.drag||C.pitch||C.rotate},cs=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R}(e.Event);function rl(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}var Na=function(C,R){this._map=C,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Mn(C),this._bearingSnap=R.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(R),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var q=0,ae=this._listeners;q<ae.length;q+=1){var he=ae[q],xe=he[0],ke=he[1],Le=he[2];n.addEventListener(xe,ke,xe===e.window.document?this.handleWindowEvent:this.handleEvent,Le)}};Na.prototype.destroy=function(){for(var C=0,R=this._listeners;C<R.length;C+=1){var F=R[C],q=F[0],ae=F[1],he=F[2];n.removeEventListener(q,ae,q===e.window.document?this.handleWindowEvent:this.handleEvent,he)}},Na.prototype._addDefaultHandlers=function(C){var R=this._map,F=R.getCanvasContainer();this._add("mapEvent",new Kr(R,C));var q=R.boxZoom=new On(R,C);this._add("boxZoom",q);var ae=new Pi,he=new Ka;R.doubleClickZoom=new Sa(he,ae),this._add("tapZoom",ae),this._add("clickZoom",he);var xe=new ia;this._add("tapDragZoom",xe);var ke=R.touchPitch=new To;this._add("touchPitch",ke);var Le=new Ci(C),He=new gi(C);R.dragRotate=new aa(C,Le,He),this._add("mouseRotate",Le,["mousePitch"]),this._add("mousePitch",He,["mouseRotate"]);var Je=new Ri(C),ot=new Fi(C);R.dragPan=new yo(F,Je,ot),this._add("mousePan",Je),this._add("touchPan",ot,["touchZoom","touchRotate"]);var Tt=new es,Ct=new Ki;R.touchZoomRotate=new so(F,Ct,Tt,xe),this._add("touchRotate",Tt,["touchPan","touchZoom"]),this._add("touchZoom",Ct,["touchPan","touchRotate"]);var At=R.scrollZoom=new Ji(R,this);this._add("scrollZoom",At,["mousePan"]);var Et=R.keyboard=new xa;this._add("keyboard",Et),this._add("blockableMapEvent",new ni(R));for(var _t=0,Ft=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];_t<Ft.length;_t+=1){var zt=Ft[_t];C.interactive&&C[zt]&&R[zt].enable(C[zt])}},Na.prototype._add=function(C,R,F){this._handlers.push({handlerName:C,handler:R,allowed:F}),this._handlersById[C]=R},Na.prototype.stop=function(){if(!this._updatingCamera){for(var C=0,R=this._handlers;C<R.length;C+=1)R[C].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Na.prototype.isActive=function(){for(var C=0,R=this._handlers;C<R.length;C+=1)if(R[C].handler.isActive())return!0;return!1},Na.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Na.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Na.prototype.isMoving=function(){return Boolean(vs(this._eventsInProgress))||this.isZooming()},Na.prototype._blockedByActive=function(C,R,F){for(var q in C)if(q!==F&&(!R||R.indexOf(q)<0))return!0;return!1},Na.prototype.handleWindowEvent=function(C){this.handleEvent(C,C.type+"Window")},Na.prototype._getMapTouches=function(C){for(var R=[],F=0,q=C;F<q.length;F+=1){var ae=q[F],he=ae.target;this._el.contains(he)&&R.push(ae)}return R},Na.prototype.handleEvent=function(C,R){if(C.type!=="blur"){this._updatingCamera=!0;for(var F=C.type==="renderFrame"?void 0:C,q={needsRenderFrame:!1},ae={},he={},xe=C.touches?this._getMapTouches(C.touches):void 0,ke=xe?n.touchPos(this._el,xe):n.mousePos(this._el,C),Le=0,He=this._handlers;Le<He.length;Le+=1){var Je=He[Le],ot=Je.handlerName,Tt=Je.handler,Ct=Je.allowed;if(Tt.isEnabled()){var At=void 0;this._blockedByActive(he,Ct,ot)?Tt.reset():Tt[R||C.type]&&(At=Tt[R||C.type](C,ke,xe),this.mergeHandlerResult(q,ae,At,ot,F),At&&At.needsRenderFrame&&this._triggerRenderFrame()),(At||Tt.isActive())&&(he[ot]=Tt)}}var Et={};for(var _t in this._previousActiveHandlers)he[_t]||(Et[_t]=F);this._previousActiveHandlers=he,(Object.keys(Et).length||rl(q))&&(this._changes.push([q,ae,Et]),this._triggerRenderFrame()),(Object.keys(he).length||rl(q))&&this._map._stop(!0),this._updatingCamera=!1;var Ft=q.cameraAnimation;Ft&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Ft(this._map))}else this.stop()},Na.prototype.mergeHandlerResult=function(C,R,F,q,ae){if(F){e.extend(C,F);var he={handlerName:q,originalEvent:F.originalEvent||ae};F.zoomDelta!==void 0&&(R.zoom=he),F.panDelta!==void 0&&(R.drag=he),F.pitchDelta!==void 0&&(R.pitch=he),F.bearingDelta!==void 0&&(R.rotate=he)}},Na.prototype._applyChanges=function(){for(var C={},R={},F={},q=0,ae=this._changes;q<ae.length;q+=1){var he=ae[q],xe=he[0],ke=he[1],Le=he[2];xe.panDelta&&(C.panDelta=(C.panDelta||new e.Point(0,0))._add(xe.panDelta)),xe.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+xe.zoomDelta),xe.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+xe.bearingDelta),xe.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+xe.pitchDelta),xe.around!==void 0&&(C.around=xe.around),xe.pinchAround!==void 0&&(C.pinchAround=xe.pinchAround),xe.noInertia&&(C.noInertia=xe.noInertia),e.extend(R,ke),e.extend(F,Le)}this._updateMapTransform(C,R,F),this._changes=[]},Na.prototype._updateMapTransform=function(C,R,F){var q=this._map,ae=q.transform;if(!rl(C))return this._fireEvents(R,F);var he=C.panDelta,xe=C.zoomDelta,ke=C.bearingDelta,Le=C.pitchDelta,He=C.around,Je=C.pinchAround;Je!==void 0&&(He=Je),q._stop(!0),He=He||q.transform.centerPoint;var ot=ae.pointLocation(he?He.sub(he):He);ke&&(ae.bearing+=ke),Le&&(ae.pitch+=Le),xe&&(ae.zoom+=xe),ae.setLocationAtPoint(ot,He),this._map._update(),C.noInertia||this._inertia.record(C),this._fireEvents(R,F)},Na.prototype._fireEvents=function(C,R){var F=this,q=vs(this._eventsInProgress),ae=vs(C),he={};for(var xe in C){var ke=C[xe].originalEvent;this._eventsInProgress[xe]||(he[xe+"start"]=ke),this._eventsInProgress[xe]=C[xe]}for(var Le in!q&&ae&&this._fireEvent("movestart",ae.originalEvent),he)this._fireEvent(Le,he[Le]);for(var He in C.rotate&&(this._bearingChanged=!0),ae&&this._fireEvent("move",ae.originalEvent),C){var Je=C[He].originalEvent;this._fireEvent(He,Je)}var ot,Tt={};for(var Ct in this._eventsInProgress){var At=this._eventsInProgress[Ct],Et=At.handlerName,_t=At.originalEvent;this._handlersById[Et].isActive()||(delete this._eventsInProgress[Ct],ot=R[Et]||_t,Tt[Ct+"end"]=ot)}for(var Ft in Tt)this._fireEvent(Ft,Tt[Ft]);var zt=vs(this._eventsInProgress);if((q||ae)&&!zt){this._updatingCamera=!0;var Vt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ir=function(gr){return gr!==0&&-F._bearingSnap<gr&&gr<F._bearingSnap};Vt?(ir(Vt.bearing||this._map.getBearing())&&(Vt.bearing=0),this._map.easeTo(Vt,{originalEvent:ot})):(this._map.fire(new e.Event("moveend",{originalEvent:ot})),ir(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Na.prototype._fireEvent=function(C,R){this._map.fire(new e.Event(C,R?{originalEvent:R}:{}))},Na.prototype._triggerRenderFrame=function(){var C=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(R){delete C._frameId,C.handleEvent(new cs("renderFrame",{timeStamp:R})),C._applyChanges()}))};var nl=function(C){function R(F,q){C.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=q.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},R.prototype.setCenter=function(F,q){return this.jumpTo({center:F},q)},R.prototype.panBy=function(F,q,ae){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},q),ae)},R.prototype.panTo=function(F,q,ae){return this.easeTo(e.extend({center:F},q),ae)},R.prototype.getZoom=function(){return this.transform.zoom},R.prototype.setZoom=function(F,q){return this.jumpTo({zoom:F},q),this},R.prototype.zoomTo=function(F,q,ae){return this.easeTo(e.extend({zoom:F},q),ae)},R.prototype.zoomIn=function(F,q){return this.zoomTo(this.getZoom()+1,F,q),this},R.prototype.zoomOut=function(F,q){return this.zoomTo(this.getZoom()-1,F,q),this},R.prototype.getBearing=function(){return this.transform.bearing},R.prototype.setBearing=function(F,q){return this.jumpTo({bearing:F},q),this},R.prototype.getPadding=function(){return this.transform.padding},R.prototype.setPadding=function(F,q){return this.jumpTo({padding:F},q),this},R.prototype.rotateTo=function(F,q,ae){return this.easeTo(e.extend({bearing:F},q),ae)},R.prototype.resetNorth=function(F,q){return this.rotateTo(0,e.extend({duration:1e3},F),q),this},R.prototype.resetNorthPitch=function(F,q){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),q),this},R.prototype.snapToNorth=function(F,q){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,q):this},R.prototype.getPitch=function(){return this.transform.pitch},R.prototype.setPitch=function(F,q){return this.jumpTo({pitch:F},q),this},R.prototype.cameraForBounds=function(F,q){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,q)},R.prototype._cameraForBoxAndBearing=function(F,q,ae,he){var xe={top:0,bottom:0,right:0,left:0};if(typeof(he=e.extend({padding:xe,offset:[0,0],maxZoom:this.transform.maxZoom},he)).padding=="number"){var ke=he.padding;he.padding={top:ke,bottom:ke,right:ke,left:ke}}he.padding=e.extend(xe,he.padding);var Le=this.transform,He=Le.padding,Je=Le.project(e.LngLat.convert(F)),ot=Le.project(e.LngLat.convert(q)),Tt=Je.rotate(-ae*Math.PI/180),Ct=ot.rotate(-ae*Math.PI/180),At=new e.Point(Math.max(Tt.x,Ct.x),Math.max(Tt.y,Ct.y)),Et=new e.Point(Math.min(Tt.x,Ct.x),Math.min(Tt.y,Ct.y)),_t=At.sub(Et),Ft=(Le.width-(He.left+He.right+he.padding.left+he.padding.right))/_t.x,zt=(Le.height-(He.top+He.bottom+he.padding.top+he.padding.bottom))/_t.y;if(!(zt<0||Ft<0)){var Vt=Math.min(Le.scaleZoom(Le.scale*Math.min(Ft,zt)),he.maxZoom),ir=e.Point.convert(he.offset),gr=(he.padding.left-he.padding.right)/2,Lr=(he.padding.top-he.padding.bottom)/2,Ar=new e.Point(ir.x+gr,ir.y+Lr).mult(Le.scale/Le.zoomScale(Vt));return{center:Le.unproject(Je.add(ot).div(2).sub(Ar)),zoom:Vt,bearing:ae}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},R.prototype.fitBounds=function(F,q,ae){return this._fitInternal(this.cameraForBounds(F,q),q,ae)},R.prototype.fitScreenCoordinates=function(F,q,ae,he,xe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(q)),ae,he),he,xe)},R.prototype._fitInternal=function(F,q,ae){return F?(delete(q=e.extend(F,q)).padding,q.linear?this.easeTo(q,ae):this.flyTo(q,ae)):this},R.prototype.jumpTo=function(F,q){this.stop();var ae=this.transform,he=!1,xe=!1,ke=!1;return"zoom"in F&&ae.zoom!==+F.zoom&&(he=!0,ae.zoom=+F.zoom),F.center!==void 0&&(ae.center=e.LngLat.convert(F.center)),"bearing"in F&&ae.bearing!==+F.bearing&&(xe=!0,ae.bearing=+F.bearing),"pitch"in F&&ae.pitch!==+F.pitch&&(ke=!0,ae.pitch=+F.pitch),F.padding==null||ae.isPaddingEqual(F.padding)||(ae.padding=F.padding),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q)),he&&this.fire(new e.Event("zoomstart",q)).fire(new e.Event("zoom",q)).fire(new e.Event("zoomend",q)),xe&&this.fire(new e.Event("rotatestart",q)).fire(new e.Event("rotate",q)).fire(new e.Event("rotateend",q)),ke&&this.fire(new e.Event("pitchstart",q)).fire(new e.Event("pitch",q)).fire(new e.Event("pitchend",q)),this.fire(new e.Event("moveend",q))},R.prototype.easeTo=function(F,q){var ae=this;this._stop(!1,F.easeId),((F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate===!1||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var he=this.transform,xe=this.getZoom(),ke=this.getBearing(),Le=this.getPitch(),He=this.getPadding(),Je="zoom"in F?+F.zoom:xe,ot="bearing"in F?this._normalizeBearing(F.bearing,ke):ke,Tt="pitch"in F?+F.pitch:Le,Ct="padding"in F?F.padding:he.padding,At=e.Point.convert(F.offset),Et=he.centerPoint.add(At),_t=he.pointLocation(Et),Ft=e.LngLat.convert(F.center||_t);this._normalizeCenter(Ft);var zt,Vt,ir=he.project(_t),gr=he.project(Ft).sub(ir),Lr=he.zoomScale(Je-xe);F.around&&(zt=e.LngLat.convert(F.around),Vt=he.locationPoint(zt));var Ar={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Je!==xe,this._rotating=this._rotating||ke!==ot,this._pitching=this._pitching||Tt!==Le,this._padding=!he.isPaddingEqual(Ct),this._easeId=F.easeId,this._prepareEase(q,F.noMoveStart,Ar),clearTimeout(this._easeEndTimeoutID),this._ease(function($r){if(ae._zooming&&(he.zoom=e.number(xe,Je,$r)),ae._rotating&&(he.bearing=e.number(ke,ot,$r)),ae._pitching&&(he.pitch=e.number(Le,Tt,$r)),ae._padding&&(he.interpolatePadding(He,Ct,$r),Et=he.centerPoint.add(At)),zt)he.setLocationAtPoint(zt,Vt);else{var Jr=he.zoomScale(he.zoom-xe),dn=Je>xe?Math.min(2,Lr):Math.max(.5,Lr),ln=Math.pow(dn,1-$r),Vn=he.unproject(ir.add(gr.mult($r*ln)).mult(Jr));he.setLocationAtPoint(he.renderWorldCopies?Vn.wrap():Vn,Et)}ae._fireMoveEvents(q)},function($r){ae._afterEase(q,$r)},F),this},R.prototype._prepareEase=function(F,q,ae){ae===void 0&&(ae={}),this._moving=!0,q||ae.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ae.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ae.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ae.pitching&&this.fire(new e.Event("pitchstart",F))},R.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},R.prototype._afterEase=function(F,q){if(!this._easeId||!q||this._easeId!==q){delete this._easeId;var ae=this._zooming,he=this._rotating,xe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ae&&this.fire(new e.Event("zoomend",F)),he&&this.fire(new e.Event("rotateend",F)),xe&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},R.prototype.flyTo=function(F,q){var ae=this;if(!F.essential&&e.browser.prefersReducedMotion){var he=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(he,q)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var xe=this.transform,ke=this.getZoom(),Le=this.getBearing(),He=this.getPitch(),Je=this.getPadding(),ot="zoom"in F?e.clamp(+F.zoom,xe.minZoom,xe.maxZoom):ke,Tt="bearing"in F?this._normalizeBearing(F.bearing,Le):Le,Ct="pitch"in F?+F.pitch:He,At="padding"in F?F.padding:xe.padding,Et=xe.zoomScale(ot-ke),_t=e.Point.convert(F.offset),Ft=xe.centerPoint.add(_t),zt=xe.pointLocation(Ft),Vt=e.LngLat.convert(F.center||zt);this._normalizeCenter(Vt);var ir=xe.project(zt),gr=xe.project(Vt).sub(ir),Lr=F.curve,Ar=Math.max(xe.width,xe.height),$r=Ar/Et,Jr=gr.mag();if("minZoom"in F){var dn=e.clamp(Math.min(F.minZoom,ke,ot),xe.minZoom,xe.maxZoom),ln=Ar/xe.zoomScale(dn-ke);Lr=Math.sqrt(ln/Jr*2)}var Vn=Lr*Lr;function Xn(ei){var _i=($r*$r-Ar*Ar+(ei?-1:1)*Vn*Vn*Jr*Jr)/(2*(ei?$r:Ar)*Vn*Jr);return Math.log(Math.sqrt(_i*_i+1)-_i)}function hi(ei){return(Math.exp(ei)-Math.exp(-ei))/2}function Yr(ei){return(Math.exp(ei)+Math.exp(-ei))/2}var Sn=Xn(0),Kn=function(ei){return Yr(Sn)/Yr(Sn+Lr*ei)},Yn=function(ei){return Ar*((Yr(Sn)*(hi(_i=Sn+Lr*ei)/Yr(_i))-hi(Sn))/Vn)/Jr;var _i},ai=(Xn(1)-Sn)/Lr;if(Math.abs(Jr)<1e-6||!isFinite(ai)){if(Math.abs(Ar-$r)<1e-6)return this.easeTo(F,q);var di=$r<Ar?-1:1;ai=Math.abs(Math.log($r/Ar))/Lr,Yn=function(){return 0},Kn=function(ei){return Math.exp(di*Lr*ei)}}if("duration"in F)F.duration=+F.duration;else{var Li="screenSpeed"in F?+F.screenSpeed/Lr:+F.speed;F.duration=1e3*ai/Li}return F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Le!==Tt,this._pitching=Ct!==He,this._padding=!xe.isPaddingEqual(At),this._prepareEase(q,!1),this._ease(function(ei){var _i=ei*ai,yi=1/Kn(_i);xe.zoom=ei===1?ot:ke+xe.scaleZoom(yi),ae._rotating&&(xe.bearing=e.number(Le,Tt,ei)),ae._pitching&&(xe.pitch=e.number(He,Ct,ei)),ae._padding&&(xe.interpolatePadding(Je,At,ei),Ft=xe.centerPoint.add(_t));var Ii=ei===1?Vt:xe.unproject(ir.add(gr.mult(Yn(_i))).mult(yi));xe.setLocationAtPoint(xe.renderWorldCopies?Ii.wrap():Ii,Ft),ae._fireMoveEvents(q)},function(){return ae._afterEase(q)},F),this},R.prototype.isEasing=function(){return!!this._easeFrameId},R.prototype.stop=function(){return this._stop()},R.prototype._stop=function(F,q){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ae=this._onEaseEnd;delete this._onEaseEnd,ae.call(this,q)}if(!F){var he=this.handlers;he&&he.stop()}return this},R.prototype._ease=function(F,q,ae){ae.animate===!1||ae.duration===0?(F(1),q()):(this._easeStart=e.browser.now(),this._easeOptions=ae,this._onEaseFrame=F,this._onEaseEnd=q,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},R.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},R.prototype._normalizeBearing=function(F,q){F=e.wrap(F,-180,180);var ae=Math.abs(F-q);return Math.abs(F-360-q)<ae&&(F-=360),Math.abs(F+360-q)<ae&&(F+=360),F},R.prototype._normalizeCenter=function(F){var q=this.transform;if(q.renderWorldCopies&&!q.lngRange){var ae=F.lng-q.center.lng;F.lng+=ae>180?-360:ae<-180?360:0}},R}(e.Evented),ja=function(C){C===void 0&&(C={}),this.options=C,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};ja.prototype.getDefaultPosition=function(){return"bottom-right"},ja.prototype.onAdd=function(C){var R=this.options&&this.options.compact;return this._map=C,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),R&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),R===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ja.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ja.prototype._updateEditLink=function(){var C=this._editLink;C||(C=this._editLink=this._container.querySelector(".mapbox-improve-map"));var R=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(C){var F=R.reduce(function(q,ae,he){return ae.value&&(q+=ae.key+"="+ae.value+(he<R.length-1?"&":"")),q},"?");C.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),C.rel="noopener nofollow"}},ja.prototype._updateData=function(C){!C||C.sourceDataType!=="metadata"&&C.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ja.prototype._updateAttributions=function(){if(this._map.style){var C=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(function(ke){return typeof ke!="string"?"":ke})):typeof this.options.customAttribution=="string"&&C.push(this.options.customAttribution)),this._map.style.stylesheet){var R=this._map.style.stylesheet;this.styleOwner=R.owner,this.styleId=R.id}var F=this._map.style.sourceCaches;for(var q in F){var ae=F[q];if(ae.used){var he=ae.getSource();he.attribution&&C.indexOf(he.attribution)<0&&C.push(he.attribution)}}C.sort(function(ke,Le){return ke.length-Le.length});var xe=(C=C.filter(function(ke,Le){for(var He=Le+1;He<C.length;He++)if(C[He].indexOf(ke)>=0)return!1;return!0})).join(" | ");xe!==this._attribHTML&&(this._attribHTML=xe,C.length?(this._innerContainer.innerHTML=xe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ja.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var us=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};us.prototype.onAdd=function(C){this._map=C,this._container=n.create("div","mapboxgl-ctrl");var R=n.create("a","mapboxgl-ctrl-logo");return R.target="_blank",R.rel="noopener nofollow",R.href="https://www.mapbox.com/",R.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),R.setAttribute("rel","noopener nofollow"),this._container.appendChild(R),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},us.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},us.prototype.getDefaultPosition=function(){return"bottom-left"},us.prototype._updateLogo=function(C){C&&C.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},us.prototype._logoRequired=function(){if(this._map.style){var C=this._map.style.sourceCaches;for(var R in C)if(C[R].getSource().mapbox_logo)return!0;return!1}},us.prototype._updateCompact=function(){var C=this._container.children;if(C.length){var R=C[0];this._map.getCanvasContainer().offsetWidth<250?R.classList.add("mapboxgl-compact"):R.classList.remove("mapboxgl-compact")}};var fi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};fi.prototype.add=function(C){var R=++this._id;return this._queue.push({callback:C,id:R,cancelled:!1}),R},fi.prototype.remove=function(C){for(var R=this._currentlyRunning,F=0,q=R?this._queue.concat(R):this._queue;F<q.length;F+=1){var ae=q[F];if(ae.id===C)return void(ae.cancelled=!0)}},fi.prototype.run=function(C){C===void 0&&(C=0);var R=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,q=R;F<q.length;F+=1){var ae=q[F];if(!ae.cancelled&&(ae.callback(C),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},fi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bi={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},il=e.window.HTMLImageElement,al=e.window.HTMLElement,fs=e.window.ImageBitmap,Fo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ko=function(C){function R(q){var ae=this;if((q=e.extend({},Fo,q)).minZoom!=null&&q.maxZoom!=null&&q.minZoom>q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(q.minPitch!=null&&q.maxPitch!=null&&q.minPitch>q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(q.minPitch!=null&&q.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(q.maxPitch!=null&&q.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var he=new Gt(q.minZoom,q.maxZoom,q.minPitch,q.maxPitch,q.renderWorldCopies);if(C.call(this,he,q),this._interactive=q.interactive,this._maxTileCacheSize=q.maxTileCacheSize,this._failIfMajorPerformanceCaveat=q.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=q.preserveDrawingBuffer,this._antialias=q.antialias,this._trackResize=q.trackResize,this._bearingSnap=q.bearingSnap,this._refreshExpiredTiles=q.refreshExpiredTiles,this._fadeDuration=q.fadeDuration,this._crossSourceCollisions=q.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=q.collectResourceTiming,this._renderTaskQueue=new fi,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},bi,q.locale),this._requestManager=new e.RequestManager(q.transformRequest,q.accessToken),typeof q.container=="string"){if(this._container=e.window.document.getElementById(q.container),!this._container)throw new Error("Container '"+q.container+"' not found.")}else{if(!(q.container instanceof al))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=q.container}if(q.maxBounds&&this.setMaxBounds(q.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ae._update(!1)}),this.on("moveend",function(){return ae._update(!1)}),this.on("zoom",function(){return ae._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Na(this,q);var xe=typeof q.hash=="string"&&q.hash||void 0;this._hash=q.hash&&new Or(xe).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:q.center,zoom:q.zoom,bearing:q.bearing,pitch:q.pitch}),q.bounds&&(this.resize(),this.fitBounds(q.bounds,e.extend({},q.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=q.localIdeographFontFamily,q.style&&this.setStyle(q.style,{localIdeographFontFamily:q.localIdeographFontFamily}),q.attributionControl&&this.addControl(new ja({customAttribution:q.customAttribution})),this.addControl(new us,q.logoPosition),this.on("style.load",function(){ae.transform.unmodified&&ae.jumpTo(ae.style.stylesheet)}),this.on("data",function(ke){ae._update(ke.dataType==="style"),ae.fire(new e.Event(ke.dataType+"data",ke))}),this.on("dataloading",function(ke){ae.fire(new e.Event(ke.dataType+"dataloading",ke))})}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return R.prototype._getMapId=function(){return this._mapId},R.prototype.addControl=function(q,ae){if(ae===void 0&&q.getDefaultPosition&&(ae=q.getDefaultPosition()),ae===void 0&&(ae="top-right"),!q||!q.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var he=q.onAdd(this);this._controls.push(q);var xe=this._controlPositions[ae];return ae.indexOf("bottom")!==-1?xe.insertBefore(he,xe.firstChild):xe.appendChild(he),this},R.prototype.removeControl=function(q){if(!q||!q.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ae=this._controls.indexOf(q);return ae>-1&&this._controls.splice(ae,1),q.onRemove(this),this},R.prototype.resize=function(q){var ae=this._containerDimensions(),he=ae[0],xe=ae[1];this._resizeCanvas(he,xe),this.transform.resize(he,xe),this.painter.resize(he,xe);var ke=!this._moving;return ke&&(this.stop(),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q))),this.fire(new e.Event("resize",q)),ke&&this.fire(new e.Event("moveend",q)),this},R.prototype.getBounds=function(){return this.transform.getBounds()},R.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},R.prototype.setMaxBounds=function(q){return this.transform.setMaxBounds(e.LngLatBounds.convert(q)),this._update()},R.prototype.setMinZoom=function(q){if((q=q==null?-2:q)>=-2&&q<=this.transform.maxZoom)return this.transform.minZoom=q,this._update(),this.getZoom()<q&&this.setZoom(q),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},R.prototype.getMinZoom=function(){return this.transform.minZoom},R.prototype.setMaxZoom=function(q){if((q=q==null?22:q)>=this.transform.minZoom)return this.transform.maxZoom=q,this._update(),this.getZoom()>q&&this.setZoom(q),this;throw new Error("maxZoom must be greater than the current minZoom")},R.prototype.getMaxZoom=function(){return this.transform.maxZoom},R.prototype.setMinPitch=function(q){if((q=q==null?0:q)<0)throw new Error("minPitch must be greater than or equal to 0");if(q>=0&&q<=this.transform.maxPitch)return this.transform.minPitch=q,this._update(),this.getPitch()<q&&this.setPitch(q),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},R.prototype.getMinPitch=function(){return this.transform.minPitch},R.prototype.setMaxPitch=function(q){if((q=q==null?60:q)>60)throw new Error("maxPitch must be less than or equal to 60");if(q>=this.transform.minPitch)return this.transform.maxPitch=q,this._update(),this.getPitch()>q&&this.setPitch(q),this;throw new Error("maxPitch must be greater than the current minPitch")},R.prototype.getMaxPitch=function(){return this.transform.maxPitch},R.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},R.prototype.setRenderWorldCopies=function(q){return this.transform.renderWorldCopies=q,this._update()},R.prototype.project=function(q){return this.transform.locationPoint(e.LngLat.convert(q))},R.prototype.unproject=function(q){return this.transform.pointLocation(e.Point.convert(q))},R.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},R.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},R.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},R.prototype._createDelegatedListener=function(q,ae,he){var xe,ke=this;if(q==="mouseenter"||q==="mouseover"){var Le=!1;return{layer:ae,listener:he,delegates:{mousemove:function(Je){var ot=ke.getLayer(ae)?ke.queryRenderedFeatures(Je.point,{layers:[ae]}):[];ot.length?Le||(Le=!0,he.call(ke,new Bn(q,ke,Je.originalEvent,{features:ot}))):Le=!1},mouseout:function(){Le=!1}}}}if(q==="mouseleave"||q==="mouseout"){var He=!1;return{layer:ae,listener:he,delegates:{mousemove:function(Je){(ke.getLayer(ae)?ke.queryRenderedFeatures(Je.point,{layers:[ae]}):[]).length?He=!0:He&&(He=!1,he.call(ke,new Bn(q,ke,Je.originalEvent)))},mouseout:function(Je){He&&(He=!1,he.call(ke,new Bn(q,ke,Je.originalEvent)))}}}}return{layer:ae,listener:he,delegates:(xe={},xe[q]=function(Je){var ot=ke.getLayer(ae)?ke.queryRenderedFeatures(Je.point,{layers:[ae]}):[];ot.length&&(Je.features=ot,he.call(ke,Je),delete Je.features)},xe)}},R.prototype.on=function(q,ae,he){if(he===void 0)return C.prototype.on.call(this,q,ae);var xe=this._createDelegatedListener(q,ae,he);for(var ke in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[q]=this._delegatedListeners[q]||[],this._delegatedListeners[q].push(xe),xe.delegates)this.on(ke,xe.delegates[ke]);return this},R.prototype.once=function(q,ae,he){if(he===void 0)return C.prototype.once.call(this,q,ae);var xe=this._createDelegatedListener(q,ae,he);for(var ke in xe.delegates)this.once(ke,xe.delegates[ke]);return this},R.prototype.off=function(q,ae,he){var xe=this;return he===void 0?C.prototype.off.call(this,q,ae):(this._delegatedListeners&&this._delegatedListeners[q]&&function(ke){for(var Le=ke[q],He=0;He<Le.length;He++){var Je=Le[He];if(Je.layer===ae&&Je.listener===he){for(var ot in Je.delegates)xe.off(ot,Je.delegates[ot]);return Le.splice(He,1),xe}}}(this._delegatedListeners),this)},R.prototype.queryRenderedFeatures=function(q,ae){if(!this.style)return[];var he;if(ae!==void 0||q===void 0||q instanceof e.Point||Array.isArray(q)||(ae=q,q=void 0),ae=ae||{},(q=q||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof q[0]=="number")he=[e.Point.convert(q)];else{var xe=e.Point.convert(q[0]),ke=e.Point.convert(q[1]);he=[xe,new e.Point(ke.x,xe.y),ke,new e.Point(xe.x,ke.y),xe]}return this.style.queryRenderedFeatures(he,ae,this.transform)},R.prototype.querySourceFeatures=function(q,ae){return this.style.querySourceFeatures(q,ae)},R.prototype.setStyle=function(q,ae){return(ae=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ae)).diff!==!1&&ae.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&q?(this._diffStyle(q,ae),this):(this._localIdeographFontFamily=ae.localIdeographFontFamily,this._updateStyle(q,ae))},R.prototype._getUIString=function(q){var ae=this._locale[q];if(ae==null)throw new Error("Missing UI string '"+q+"'");return ae},R.prototype._updateStyle=function(q,ae){return this.style&&(this.style.setEventedParent(null),this.style._remove()),q?(this.style=new kn(this,ae||{}),this.style.setEventedParent(this,{style:this.style}),typeof q=="string"?this.style.loadURL(q):this.style.loadJSON(q),this):(delete this.style,this)},R.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new kn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},R.prototype._diffStyle=function(q,ae){var he=this;if(typeof q=="string"){var xe=this._requestManager.normalizeStyleURL(q),ke=this._requestManager.transformRequest(xe,e.ResourceType.Style);e.getJSON(ke,function(Le,He){Le?he.fire(new e.ErrorEvent(Le)):He&&he._updateDiff(He,ae)})}else typeof q=="object"&&this._updateDiff(q,ae)},R.prototype._updateDiff=function(q,ae){try{this.style.setState(q)&&this._update(!0)}catch(he){e.warnOnce("Unable to perform style diff: "+(he.message||he.error||he)+".  Rebuilding the style from scratch."),this._updateStyle(q,ae)}},R.prototype.getStyle=function(){if(this.style)return this.style.serialize()},R.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},R.prototype.addSource=function(q,ae){return this._lazyInitEmptyStyle(),this.style.addSource(q,ae),this._update(!0)},R.prototype.isSourceLoaded=function(q){var ae=this.style&&this.style.sourceCaches[q];if(ae!==void 0)return ae.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+q+"'")))},R.prototype.areTilesLoaded=function(){var q=this.style&&this.style.sourceCaches;for(var ae in q){var he=q[ae]._tiles;for(var xe in he){var ke=he[xe];if(ke.state!=="loaded"&&ke.state!=="errored")return!1}}return!0},R.prototype.addSourceType=function(q,ae,he){return this._lazyInitEmptyStyle(),this.style.addSourceType(q,ae,he)},R.prototype.removeSource=function(q){return this.style.removeSource(q),this._update(!0)},R.prototype.getSource=function(q){return this.style.getSource(q)},R.prototype.addImage=function(q,ae,he){he===void 0&&(he={});var xe=he.pixelRatio;xe===void 0&&(xe=1);var ke=he.sdf;ke===void 0&&(ke=!1);var Le=he.stretchX,He=he.stretchY,Je=he.content;if(this._lazyInitEmptyStyle(),ae instanceof il||fs&&ae instanceof fs){var ot=e.browser.getImageData(ae),Tt=ot.width,Ct=ot.height,At=ot.data;this.style.addImage(q,{data:new e.RGBAImage({width:Tt,height:Ct},At),pixelRatio:xe,stretchX:Le,stretchY:He,content:Je,sdf:ke,version:0})}else{if(ae.width===void 0||ae.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Et=ae.width,_t=ae.height,Ft=ae.data,zt=ae;this.style.addImage(q,{data:new e.RGBAImage({width:Et,height:_t},new Uint8Array(Ft)),pixelRatio:xe,stretchX:Le,stretchY:He,content:Je,sdf:ke,version:0,userImage:zt}),zt.onAdd&&zt.onAdd(this,q)}},R.prototype.updateImage=function(q,ae){var he=this.style.getImage(q);if(!he)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var xe=ae instanceof il||fs&&ae instanceof fs?e.browser.getImageData(ae):ae,ke=xe.width,Le=xe.height,He=xe.data;if(ke===void 0||Le===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ke!==he.data.width||Le!==he.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var Je=!(ae instanceof il||fs&&ae instanceof fs);he.data.replace(He,Je),this.style.updateImage(q,he)},R.prototype.hasImage=function(q){return q?!!this.style.getImage(q):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},R.prototype.removeImage=function(q){this.style.removeImage(q)},R.prototype.loadImage=function(q,ae){e.getImage(this._requestManager.transformRequest(q,e.ResourceType.Image),ae)},R.prototype.listImages=function(){return this.style.listImages()},R.prototype.addLayer=function(q,ae){return this._lazyInitEmptyStyle(),this.style.addLayer(q,ae),this._update(!0)},R.prototype.moveLayer=function(q,ae){return this.style.moveLayer(q,ae),this._update(!0)},R.prototype.removeLayer=function(q){return this.style.removeLayer(q),this._update(!0)},R.prototype.getLayer=function(q){return this.style.getLayer(q)},R.prototype.setLayerZoomRange=function(q,ae,he){return this.style.setLayerZoomRange(q,ae,he),this._update(!0)},R.prototype.setFilter=function(q,ae,he){return he===void 0&&(he={}),this.style.setFilter(q,ae,he),this._update(!0)},R.prototype.getFilter=function(q){return this.style.getFilter(q)},R.prototype.setPaintProperty=function(q,ae,he,xe){return xe===void 0&&(xe={}),this.style.setPaintProperty(q,ae,he,xe),this._update(!0)},R.prototype.getPaintProperty=function(q,ae){return this.style.getPaintProperty(q,ae)},R.prototype.setLayoutProperty=function(q,ae,he,xe){return xe===void 0&&(xe={}),this.style.setLayoutProperty(q,ae,he,xe),this._update(!0)},R.prototype.getLayoutProperty=function(q,ae){return this.style.getLayoutProperty(q,ae)},R.prototype.setLight=function(q,ae){return ae===void 0&&(ae={}),this._lazyInitEmptyStyle(),this.style.setLight(q,ae),this._update(!0)},R.prototype.getLight=function(){return this.style.getLight()},R.prototype.setFeatureState=function(q,ae){return this.style.setFeatureState(q,ae),this._update()},R.prototype.removeFeatureState=function(q,ae){return this.style.removeFeatureState(q,ae),this._update()},R.prototype.getFeatureState=function(q){return this.style.getFeatureState(q)},R.prototype.getContainer=function(){return this._container},R.prototype.getCanvasContainer=function(){return this._canvasContainer},R.prototype.getCanvas=function(){return this._canvas},R.prototype._containerDimensions=function(){var q=0,ae=0;return this._container&&(q=this._container.clientWidth||400,ae=this._container.clientHeight||300),[q,ae]},R.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},R.prototype._setupContainer=function(){var q=this._container;q.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",q)).style.visibility="hidden",this._detectMissingCSS();var ae=this._canvasContainer=n.create("div","mapboxgl-canvas-container",q);this._interactive&&ae.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",ae),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var he=this._containerDimensions();this._resizeCanvas(he[0],he[1]);var xe=this._controlContainer=n.create("div","mapboxgl-control-container",q),ke=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Le){ke[Le]=n.create("div","mapboxgl-ctrl-"+Le,xe)})},R.prototype._resizeCanvas=function(q,ae){var he=e.browser.devicePixelRatio||1;this._canvas.width=he*q,this._canvas.height=he*ae,this._canvas.style.width=q+"px",this._canvas.style.height=ae+"px"},R.prototype._setupPainter=function(){var q=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ae=this._canvas.getContext("webgl",q)||this._canvas.getContext("experimental-webgl",q);ae?(this.painter=new zi(ae,this.transform),e.webpSupported.testSupport(ae)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},R.prototype._contextLost=function(q){q.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:q}))},R.prototype._contextRestored=function(q){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:q}))},R.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},R.prototype._update=function(q){return this.style?(this._styleDirty=this._styleDirty||q,this._sourcesDirty=!0,this.triggerRepaint(),this):this},R.prototype._requestRenderFrame=function(q){return this._update(),this._renderTaskQueue.add(q)},R.prototype._cancelRenderFrame=function(q){this._renderTaskQueue.remove(q)},R.prototype._render=function(q){var ae,he=this,xe=0,ke=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ae=ke.createQueryEXT(),ke.beginQueryEXT(ke.TIME_ELAPSED_EXT,ae),xe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(q),!this._removed){var Le=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var He=this.transform.zoom,Je=e.browser.now();this.style.zoomHistory.update(He,Je);var ot=new e.EvaluationParameters(He,{now:Je,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Tt=ot.crossFadingFactor();Tt===1&&Tt===this._crossFadingFactor||(Le=!0,this._crossFadingFactor=Tt),this.style.update(ot)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Le)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ct=e.browser.now()-xe;ke.endQueryEXT(ke.TIME_ELAPSED_EXT,ae),setTimeout(function(){var Et=ke.getQueryObjectEXT(ae,ke.QUERY_RESULT_EXT)/1e6;ke.deleteQueryEXT(ae),he.fire(new e.Event("gpu-timing-frame",{cpuTime:Ct,gpuTime:Et}))},50)}if(this.listens("gpu-timing-layer")){var At=this.painter.collectGpuTimers();setTimeout(function(){var Et=he.painter.queryGpuTimers(At);he.fire(new e.Event("gpu-timing-layer",{layerTimes:Et}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},R.prototype.remove=function(){this._hash&&this._hash.remove();for(var q=0,ae=this._controls;q<ae.length;q+=1)ae[q].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var he=this.painter.context.gl.getExtension("WEBGL_lose_context");he&&he.loseContext(),Sl(this._canvasContainer),Sl(this._controlContainer),Sl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},R.prototype.triggerRepaint=function(){var q=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ae){q._frame=null,q._render(ae)}))},R.prototype._onWindowOnline=function(){this._update()},R.prototype._onWindowResize=function(q){this._trackResize&&this.resize({originalEvent:q})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(q){this._showTileBoundaries!==q&&(this._showTileBoundaries=q,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(q){this._showPadding!==q&&(this._showPadding=q,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(q){this._showCollisionBoxes!==q&&(this._showCollisionBoxes=q,q?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(q){this._showOverdrawInspector!==q&&(this._showOverdrawInspector=q,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(q){this._repaint!==q&&(this._repaint=q,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(q){this._vertices=q,this._update()},R.prototype._setCacheLimits=function(q,ae){e.setCacheLimits(q,ae)},F.version.get=function(){return e.version},Object.defineProperties(R.prototype,F),R}(nl);function Sl(C){C.parentNode&&C.parentNode.removeChild(C)}var js={showCompass:!0,showZoom:!0,visualizePitch:!1},$i=function(C){var R=this;this.options=e.extend({},js,C),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return R._map.zoomIn({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return R._map.zoomOut({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){R.options.visualizePitch?R._map.resetNorthPitch({},{originalEvent:F}):R._map.resetNorth({},{originalEvent:F})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};$i.prototype._updateZoomButtons=function(){var C=this._map.getZoom();this._zoomInButton.disabled=C===this._map.getMaxZoom(),this._zoomOutButton.disabled=C===this._map.getMinZoom()},$i.prototype._rotateCompassArrow=function(){var C=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=C},$i.prototype.onAdd=function(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oa(this._map,this._compass,this.options.visualizePitch)),this._container},$i.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},$i.prototype._createButton=function(C,R){var F=n.create("button",C,this._container);return F.type="button",F.addEventListener("click",R),F},$i.prototype._setButtonTitle=function(C,R){var F=this._map._getUIString("NavigationControl."+R);C.title=F,C.setAttribute("aria-label",F)};var oa=function(C,R,F){F===void 0&&(F=!1),this._clickTolerance=10,this.element=R,this.mouseRotate=new Ci({clickTolerance:C.dragRotate._mouseRotate._clickTolerance}),this.map=C,F&&(this.mousePitch=new gi({clickTolerance:C.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(R,"mousedown",this.mousedown),n.addEventListener(R,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(R,"touchmove",this.touchmove),n.addEventListener(R,"touchend",this.touchend),n.addEventListener(R,"touchcancel",this.reset)};function As(C,R,F){if(C=new e.LngLat(C.lng,C.lat),R){var q=new e.LngLat(C.lng-360,C.lat),ae=new e.LngLat(C.lng+360,C.lat),he=F.locationPoint(C).distSqr(R);F.locationPoint(q).distSqr(R)<he?C=q:F.locationPoint(ae).distSqr(R)<he&&(C=ae)}for(;Math.abs(C.lng-F.center.lng)>180;){var xe=F.locationPoint(C);if(xe.x>=0&&xe.y>=0&&xe.x<=F.width&&xe.y<=F.height)break;C.lng>F.center.lng?C.lng-=360:C.lng+=360}return C}oa.prototype.down=function(C,R){this.mouseRotate.mousedown(C,R),this.mousePitch&&this.mousePitch.mousedown(C,R),n.disableDrag()},oa.prototype.move=function(C,R){var F=this.map,q=this.mouseRotate.mousemoveWindow(C,R);if(q&&q.bearingDelta&&F.setBearing(F.getBearing()+q.bearingDelta),this.mousePitch){var ae=this.mousePitch.mousemoveWindow(C,R);ae&&ae.pitchDelta&&F.setPitch(F.getPitch()+ae.pitchDelta)}},oa.prototype.off=function(){var C=this.element;n.removeEventListener(C,"mousedown",this.mousedown),n.removeEventListener(C,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(C,"touchmove",this.touchmove),n.removeEventListener(C,"touchend",this.touchend),n.removeEventListener(C,"touchcancel",this.reset),this.offTemp()},oa.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},oa.prototype.mousedown=function(C){this.down(e.extend({},C,{ctrlKey:!0,preventDefault:function(){return C.preventDefault()}}),n.mousePos(this.element,C)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},oa.prototype.mousemove=function(C){this.move(C,n.mousePos(this.element,C))},oa.prototype.mouseup=function(C){this.mouseRotate.mouseupWindow(C),this.mousePitch&&this.mousePitch.mouseupWindow(C),this.offTemp()},oa.prototype.touchstart=function(C){C.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,C.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return C.preventDefault()}},this._startPos))},oa.prototype.touchmove=function(C){C.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,C.targetTouches)[0],this.move({preventDefault:function(){return C.preventDefault()}},this._lastPos))},oa.prototype.touchend=function(C){C.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},oa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ys={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function za(C,R,F){var q=C.classList;for(var ae in ys)q.remove("mapboxgl-"+F+"-anchor-"+ae);q.add("mapboxgl-"+F+"-anchor-"+R)}var Ss,Us=function(C){function R(F,q){var ae=this;if(C.call(this),(F instanceof e.window.HTMLElement||q)&&(F=e.extend({element:F},q)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&F.pitchAlignment!=="auto"?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var he=n.createNS("http://www.w3.org/2000/svg","svg");he.setAttributeNS(null,"display","block"),he.setAttributeNS(null,"height","41px"),he.setAttributeNS(null,"width","27px"),he.setAttributeNS(null,"viewBox","0 0 27 41");var xe=n.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"stroke","none"),xe.setAttributeNS(null,"stroke-width","1"),xe.setAttributeNS(null,"fill","none"),xe.setAttributeNS(null,"fill-rule","evenodd");var ke=n.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill-rule","nonzero");var Le=n.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Le.setAttributeNS(null,"fill","#000000");for(var He=0,Je=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];He<Je.length;He+=1){var ot=Je[He],Tt=n.createNS("http://www.w3.org/2000/svg","ellipse");Tt.setAttributeNS(null,"opacity","0.04"),Tt.setAttributeNS(null,"cx","10.5"),Tt.setAttributeNS(null,"cy","5.80029008"),Tt.setAttributeNS(null,"rx",ot.rx),Tt.setAttributeNS(null,"ry",ot.ry),Le.appendChild(Tt)}var Ct=n.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"fill",this._color);var At=n.createNS("http://www.w3.org/2000/svg","path");At.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ct.appendChild(At);var Et=n.createNS("http://www.w3.org/2000/svg","g");Et.setAttributeNS(null,"opacity","0.25"),Et.setAttributeNS(null,"fill","#000000");var _t=n.createNS("http://www.w3.org/2000/svg","path");_t.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Et.appendChild(_t);var Ft=n.createNS("http://www.w3.org/2000/svg","g");Ft.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ft.setAttributeNS(null,"fill","#FFFFFF");var zt=n.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Vt=n.createNS("http://www.w3.org/2000/svg","circle");Vt.setAttributeNS(null,"fill","#000000"),Vt.setAttributeNS(null,"opacity","0.25"),Vt.setAttributeNS(null,"cx","5.5"),Vt.setAttributeNS(null,"cy","5.5"),Vt.setAttributeNS(null,"r","5.4999962");var ir=n.createNS("http://www.w3.org/2000/svg","circle");ir.setAttributeNS(null,"fill","#FFFFFF"),ir.setAttributeNS(null,"cx","5.5"),ir.setAttributeNS(null,"cy","5.5"),ir.setAttributeNS(null,"r","5.4999962"),zt.appendChild(Vt),zt.appendChild(ir),ke.appendChild(Le),ke.appendChild(Ct),ke.appendChild(Et),ke.appendChild(Ft),ke.appendChild(zt),he.appendChild(ke),this._element.appendChild(he),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(gr){gr.preventDefault()}),this._element.addEventListener("mousedown",function(gr){gr.preventDefault()}),this._element.addEventListener("focus",function(){var gr=ae._map.getContainer();gr.scrollTop=0,gr.scrollLeft=0}),za(this._element,this._anchor,"marker"),this._popup=null}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},R.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},R.prototype.getElement=function(){return this._element},R.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var q=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[q,-1*(24.6+q)],"bottom-right":[-q,-1*(24.6+q)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},R.prototype._onKeyPress=function(F){var q=F.code,ae=F.charCode||F.keyCode;q!=="Space"&&q!=="Enter"&&ae!==32&&ae!==13||this.togglePopup()},R.prototype._onMapClick=function(F){var q=F.originalEvent.target,ae=this._element;this._popup&&(q===ae||ae.contains(q))&&this.togglePopup()},R.prototype.getPopup=function(){return this._popup},R.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},R.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=As(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var q="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?q="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(q="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ae="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ae="rotateX(0deg)":this._pitchAlignment==="map"&&(ae="rotateX("+this._map.getPitch()+"deg)"),F&&F.type!=="moveend"||(this._pos=this._pos.round()),n.setTransform(this._element,ys[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ae+" "+q)}},R.prototype.getOffset=function(){return this._offset},R.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},R.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},R.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},R.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},R.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},R.prototype.isDraggable=function(){return this._draggable},R.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},R.prototype.getRotation=function(){return this._rotation},R.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},R.prototype.getRotationAlignment=function(){return this._rotationAlignment},R.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&F!=="auto"?F:this._rotationAlignment,this._update(),this},R.prototype.getPitchAlignment=function(){return this._pitchAlignment},R}(e.Evented),Is={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Vs=0,xs=!1,El=function(C){function R(F){C.call(this),this.options=e.extend({},Is,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){var q;return this._map=F,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),q=this._setupUI,Ss!==void 0?q(Ss):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ae){Ss=ae.state!=="denied",q(Ss)}):(Ss=!!e.window.navigator.geolocation,q(Ss)),this._container},R.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Vs=0,xs=!1},R.prototype._isOutOfMapMaxBounds=function(F){var q=this._map.getMaxBounds(),ae=F.coords;return q&&(ae.longitude<q.getWest()||ae.longitude>q.getEast()||ae.latitude<q.getSouth()||ae.latitude>q.getNorth())},R.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},R.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(F),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},R.prototype._updateCamera=function(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude),ae=F.coords.accuracy,he=this._map.getBearing(),xe=e.extend({bearing:he},this.options.fitBoundsOptions);this._map.fitBounds(q.toBounds(ae),xe,{geolocateSource:!0})},R.prototype._updateMarker=function(F){if(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(q).addTo(this._map),this._userLocationDotMarker.setLngLat(q).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},R.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,q=this._map.unproject([0,F]),ae=this._map.unproject([1,F]),he=q.distanceTo(ae),xe=Math.ceil(2*this._accuracy/he);this._circleElement.style.width=xe+"px",this._circleElement.style.height=xe+"px"},R.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},R.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(F.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var q=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=q,this._geolocateButton.setAttribute("aria-label",q),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(F.code===3&&xs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},R.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},R.prototype._setupUI=function(F){var q=this;if(this._container.addEventListener("contextmenu",function(xe){return xe.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",F===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ae=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ae,this._geolocateButton.setAttribute("aria-label",ae)}else{var he=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=he,this._geolocateButton.setAttribute("aria-label",he)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Us(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Us({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(xe){var ke=xe.originalEvent&&xe.originalEvent.type==="resize";xe.geolocateSource||q._watchState!=="ACTIVE_LOCK"||ke||(q._watchState="BACKGROUND",q._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),q._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),q.fire(new e.Event("trackuserlocationend")))})},R.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Vs--,xs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Vs>1?(F={maximumAge:6e5,timeout:0},xs=!0):(F=this.options.positionOptions,xs=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},R.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},R}(e.Evented),Hl={maxWidth:100,unit:"metric"},Es=function(C){this.options=e.extend({},Hl,C),e.bindAll(["_onMove","setUnit"],this)};function Ll(C,R,F){var q=F&&F.maxWidth||100,ae=C._container.clientHeight/2,he=C.unproject([0,ae]),xe=C.unproject([q,ae]),ke=he.distanceTo(xe);if(F&&F.unit==="imperial"){var Le=3.2808*ke;Le>5280?Hs(R,q,Le/5280,C._getUIString("ScaleControl.Miles")):Hs(R,q,Le,C._getUIString("ScaleControl.Feet"))}else F&&F.unit==="nautical"?Hs(R,q,ke/1852,C._getUIString("ScaleControl.NauticalMiles")):ke>=1e3?Hs(R,q,ke/1e3,C._getUIString("ScaleControl.Kilometers")):Hs(R,q,ke,C._getUIString("ScaleControl.Meters"))}function Hs(C,R,F,q){var ae,he,xe,ke=(ae=F,he=Math.pow(10,(""+Math.floor(ae)).length-1),xe=(xe=ae/he)>=10?10:xe>=5?5:xe>=3?3:xe>=2?2:xe>=1?1:function(He){var Je=Math.pow(10,Math.ceil(-Math.log(He)/Math.LN10));return Math.round(He*Je)/Je}(xe),he*xe),Le=ke/F;C.style.width=R*Le+"px",C.innerHTML=ke+"&nbsp;"+q}Es.prototype.getDefaultPosition=function(){return"bottom-left"},Es.prototype._onMove=function(){Ll(this._map,this._container,this.options)},Es.prototype.onAdd=function(C){return this._map=C,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Es.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Es.prototype.setUnit=function(C){this.options.unit=C,Ll(this._map,this._container,this.options)};var lo=function(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof e.window.HTMLElement?this._container=C.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};lo.prototype.onAdd=function(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},lo.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},lo.prototype._setupUI=function(){var C=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},lo.prototype._updateTitle=function(){var C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C},lo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},lo.prototype._isFullscreen=function(){return this._fullscreen},lo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},lo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ql={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Gl=function(C){function R(F){C.call(this),this.options=e.extend(Object.create(ql),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},R.prototype.isOpen=function(){return!!this._map},R.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},R.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},R.prototype.getElement=function(){return this._container},R.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},R.prototype.setHTML=function(F){var q,ae=e.window.document.createDocumentFragment(),he=e.window.document.createElement("body");for(he.innerHTML=F;q=he.firstChild;)ae.appendChild(q);return this.setDOMContent(ae)},R.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},R.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},R.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},R.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},R.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},R.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},R.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},R.prototype._onMouseUp=function(F){this._update(F.point)},R.prototype._onMouseMove=function(F){this._update(F.point)},R.prototype._onDrag=function(F){this._update(F.point)},R.prototype._update=function(F){var q=this,ae=this._lngLat||this._trackPointer;if(this._map&&ae&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Tt){return q._container.classList.add(Tt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=As(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var he=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),xe=this.options.anchor,ke=function Tt(Ct){if(Ct){if(typeof Ct=="number"){var At=Math.round(Math.sqrt(.5*Math.pow(Ct,2)));return{center:new e.Point(0,0),top:new e.Point(0,Ct),"top-left":new e.Point(At,At),"top-right":new e.Point(-At,At),bottom:new e.Point(0,-Ct),"bottom-left":new e.Point(At,-At),"bottom-right":new e.Point(-At,-At),left:new e.Point(Ct,0),right:new e.Point(-Ct,0)}}if(Ct instanceof e.Point||Array.isArray(Ct)){var Et=e.Point.convert(Ct);return{center:Et,top:Et,"top-left":Et,"top-right":Et,bottom:Et,"bottom-left":Et,"bottom-right":Et,left:Et,right:Et}}return{center:e.Point.convert(Ct.center||[0,0]),top:e.Point.convert(Ct.top||[0,0]),"top-left":e.Point.convert(Ct["top-left"]||[0,0]),"top-right":e.Point.convert(Ct["top-right"]||[0,0]),bottom:e.Point.convert(Ct.bottom||[0,0]),"bottom-left":e.Point.convert(Ct["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Ct["bottom-right"]||[0,0]),left:e.Point.convert(Ct.left||[0,0]),right:e.Point.convert(Ct.right||[0,0])}}return Tt(new e.Point(0,0))}(this.options.offset);if(!xe){var Le,He=this._container.offsetWidth,Je=this._container.offsetHeight;Le=he.y+ke.bottom.y<Je?["top"]:he.y>this._map.transform.height-Je?["bottom"]:[],he.x<He/2?Le.push("left"):he.x>this._map.transform.width-He/2&&Le.push("right"),xe=Le.length===0?"bottom":Le.join("-")}var ot=he.add(ke[xe]).round();n.setTransform(this._container,ys[xe]+" translate("+ot.x+"px,"+ot.y+"px)"),za(this._container,xe,"popup")}},R.prototype._onClose=function(){this.remove()},R}(e.Evented),ue={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Ko,NavigationControl:$i,GeolocateControl:El,AttributionControl:ja,ScaleControl:Es,FullscreenControl:lo,Popup:Gl,Marker:Us,Style:kn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){it().acquire(ct)},clearPrewarmedResources:function(){var C=Mt;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(ct),Mt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(C){e.config.ACCESS_TOKEN=C},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(C){e.config.API_URL=C},get workerCount(){return st.workerCount},set workerCount(C){st.workerCount=C},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){e.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage:function(C){e.clearTileCache(C)},workerUrl:""};return ue}),w})},{}],240:[function(m,G,W){G.exports=Math.log2||function(d){return Math.log(d)*Math.LOG2E}},{}],241:[function(m,G,W){G.exports=function(v,w){w||(w=v,v=window);var y=0,e=0,t=0,n={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function r(x){var f=!1;return"altKey"in x&&(f=f||x.altKey!==n.alt,n.alt=!!x.altKey),"shiftKey"in x&&(f=f||x.shiftKey!==n.shift,n.shift=!!x.shiftKey),"ctrlKey"in x&&(f=f||x.ctrlKey!==n.control,n.control=!!x.ctrlKey),"metaKey"in x&&(f=f||x.metaKey!==n.meta,n.meta=!!x.metaKey),f}function g(x,f){var _=d.x(f),b=d.y(f);"buttons"in f&&(x=0|f.buttons),(x!==y||_!==e||b!==t||r(f))&&(y=0|x,e=_||0,t=b||0,w&&w(y,e,t,n))}function u(x){g(0,x)}function s(){(y||e||t||n.shift||n.alt||n.meta||n.control)&&(e=t=0,y=0,n.shift=n.alt=n.control=n.meta=!1,w&&w(0,0,0,n))}function h(x){r(x)&&w&&w(y,e,t,n)}function l(x){d.buttons(x)===0?g(0,x):g(y,x)}function o(x){g(y|d.buttons(x),x)}function p(x){g(y&~d.buttons(x),x)}function c(){a||(a=!0,v.addEventListener("mousemove",l),v.addEventListener("mousedown",o),v.addEventListener("mouseup",p),v.addEventListener("mouseleave",u),v.addEventListener("mouseenter",u),v.addEventListener("mouseout",u),v.addEventListener("mouseover",u),v.addEventListener("blur",s),v.addEventListener("keyup",h),v.addEventListener("keydown",h),v.addEventListener("keypress",h),v!==window&&(window.addEventListener("blur",s),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}c();var i={element:v};return Object.defineProperties(i,{enabled:{get:function(){return a},set:function(x){x?c():function(){!a||(a=!1,v.removeEventListener("mousemove",l),v.removeEventListener("mousedown",o),v.removeEventListener("mouseup",p),v.removeEventListener("mouseleave",u),v.removeEventListener("mouseenter",u),v.removeEventListener("mouseout",u),v.removeEventListener("mouseover",u),v.removeEventListener("blur",s),v.removeEventListener("keyup",h),v.removeEventListener("keydown",h),v.removeEventListener("keypress",h),v!==window&&(window.removeEventListener("blur",s),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))}()},enumerable:!0},buttons:{get:function(){return y},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return t},enumerable:!0},mods:{get:function(){return n},enumerable:!0}}),i};var d=m("mouse-event")},{"mouse-event":243}],242:[function(m,G,W){var d={left:0,top:0};G.exports=function(v,w,y){w=w||v.currentTarget||v.srcElement,Array.isArray(y)||(y=[0,0]);var e=v.clientX||0,t=v.clientY||0,n=(a=w,a===window||a===document||a===document.body?d:a.getBoundingClientRect()),a;return y[0]=e-n.left,y[1]=t-n.top,y}},{}],243:[function(m,G,W){function d(v){return v.target||v.srcElement||window}W.buttons=function(v){if(typeof v=="object"){if("buttons"in v)return v.buttons;if("which"in v){if((w=v.which)===2)return 4;if(w===3)return 2;if(w>0)return 1<<w-1}else if("button"in v){var w;if((w=v.button)===1)return 4;if(w===2)return 2;if(w>=0)return 1<<w}}return 0},W.element=d,W.x=function(v){if(typeof v=="object"){if("offsetX"in v)return v.offsetX;var w=d(v).getBoundingClientRect();return v.clientX-w.left}return 0},W.y=function(v){if(typeof v=="object"){if("offsetY"in v)return v.offsetY;var w=d(v).getBoundingClientRect();return v.clientY-w.top}return 0}},{}],244:[function(m,G,W){var d=m("to-px");G.exports=function(v,w,y){typeof v=="function"&&(y=!!w,w=v,v=window);var e=d("ex",v),t=function(n){y&&n.preventDefault();var a=n.deltaX||0,r=n.deltaY||0,g=n.deltaZ||0,u=1;switch(n.deltaMode){case 1:u=e;break;case 2:u=window.innerHeight}if(r*=u,g*=u,(a*=u)||r||g)return w(a,r,g,n)};return v.addEventListener("wheel",t),t}},{"to-px":315}],245:[function(m,G,W){(function(d,v){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(w,y,e){y[w]=y[w]||e(),G!==void 0&&G.exports&&(G.exports=y[w])})("Promise",d!==void 0?d:this,function(){var w,y,e,t=Object.prototype.toString,n=v!==void 0?function(x){return v(x)}:setTimeout;try{Object.defineProperty({},"x",{}),w=function(x,f,_,b){return Object.defineProperty(x,f,{value:_,writable:!0,configurable:b!==!1})}}catch{w=function(f,_,b){return f[_]=b,f}}function a(x,f){e.add(x,f),y||(y=n(e.drain))}function r(x){var f,_=typeof x;return x==null||_!="object"&&_!="function"||(f=x.then),typeof f=="function"&&f}function g(){for(var x=0;x<this.chain.length;x++)u(this,this.state===1?this.chain[x].success:this.chain[x].failure,this.chain[x]);this.chain.length=0}function u(x,f,_){var b,T;try{f===!1?_.reject(x.msg):(b=f===!0?x.msg:f.call(void 0,x.msg))===_.promise?_.reject(TypeError("Promise-chain cycle")):(T=r(b))?T.call(b,_.resolve,_.reject):_.resolve(b)}catch(k){_.reject(k)}}function s(x){var f,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(f=r(x))?a(function(){var b=new o(_);try{f.call(x,function(){s.apply(b,arguments)},function(){h.apply(b,arguments)})}catch(T){h.call(b,T)}}):(_.msg=x,_.state=1,_.chain.length>0&&a(g,_))}catch(b){h.call(new o(_),b)}}}function h(x){var f=this;f.triggered||(f.triggered=!0,f.def&&(f=f.def),f.msg=x,f.state=2,f.chain.length>0&&a(g,f))}function l(x,f,_,b){for(var T=0;T<f.length;T++)(function(k){x.resolve(f[k]).then(function(L){_(k,L)},b)})(T)}function o(x){this.def=x,this.triggered=!1}function p(x){this.promise=x,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(x){if(typeof x!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var f=new p(this);this.then=function(_,b){var T={success:typeof _!="function"||_,failure:typeof b=="function"&&b};return T.promise=new this.constructor(function(k,L){if(typeof k!="function"||typeof L!="function")throw TypeError("Not a function");T.resolve=k,T.reject=L}),f.chain.push(T),f.state!==0&&a(g,f),T.promise},this.catch=function(_){return this.then(void 0,_)};try{x.call(void 0,function(_){s.call(f,_)},function(_){h.call(f,_)})}catch(_){h.call(f,_)}}e=function(){var x,f,_;function b(T,k){this.fn=T,this.self=k,this.next=void 0}return{add:function(T,k){_=new b(T,k),f?f.next=_:x=_,f=_,_=void 0},drain:function(){var T=x;for(x=f=y=void 0;T;)T.fn.call(T.self),T=T.next}}}();var i=w({},"constructor",c,!1);return c.prototype=i,w(i,"__NPO__",0,!1),w(c,"resolve",function(x){return x&&typeof x=="object"&&x.__NPO__===1?x:new this(function(f,_){if(typeof f!="function"||typeof _!="function")throw TypeError("Not a function");f(x)})}),w(c,"reject",function(x){return new this(function(f,_){if(typeof f!="function"||typeof _!="function")throw TypeError("Not a function");_(x)})}),w(c,"all",function(x){var f=this;return t.call(x)!="[object Array]"?f.reject(TypeError("Not an array")):x.length===0?f.resolve([]):new f(function(_,b){if(typeof _!="function"||typeof b!="function")throw TypeError("Not a function");var T=x.length,k=Array(T),L=0;l(f,x,function(A,I){k[A]=I,++L===T&&_(k)},b)})}),w(c,"race",function(x){var f=this;return t.call(x)!="[object Array]"?f.reject(TypeError("Not an array")):new f(function(_,b){if(typeof _!="function"||typeof b!="function")throw TypeError("Not a function");l(f,x,function(T,k){_(k)},b)})}),c})}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{},m("timers").setImmediate)},{timers:312}],246:[function(m,G,W){var d=Math.PI,v=n(120);function w(a,r,g,u){return["C",a,r,g,u,g,u]}function y(a,r,g,u,s,h){return["C",a/3+2/3*g,r/3+2/3*u,s/3+2/3*g,h/3+2/3*u,s,h]}function e(a,r,g,u,s,h,l,o,p,c){if(c)I=c[0],P=c[1],L=c[2],A=c[3];else{var i=t(a,r,-s);a=i.x,r=i.y;var x=(a-(o=(i=t(o,p,-s)).x))/2,f=(r-(p=i.y))/2,_=x*x/(g*g)+f*f/(u*u);_>1&&(g*=_=Math.sqrt(_),u*=_);var b=g*g,T=u*u,k=(h==l?-1:1)*Math.sqrt(Math.abs((b*T-b*f*f-T*x*x)/(b*f*f+T*x*x)));k==1/0&&(k=1);var L=k*g*f/u+(a+o)/2,A=k*-u*x/g+(r+p)/2,I=Math.asin(((r-A)/u).toFixed(9)),P=Math.asin(((p-A)/u).toFixed(9));(I=a<L?d-I:I)<0&&(I=2*d+I),(P=o<L?d-P:P)<0&&(P=2*d+P),l&&I>P&&(I-=2*d),!l&&P>I&&(P-=2*d)}if(Math.abs(P-I)>v){var S=P,E=o,z=p;P=I+v*(l&&P>I?1:-1);var D=e(o=L+g*Math.cos(P),p=A+u*Math.sin(P),g,u,s,0,l,E,z,[P,S,L,A])}var j=Math.tan((P-I)/4),V=4/3*g*j,Z=4/3*u*j,Q=[2*a-(a+V*Math.sin(I)),2*r-(r-Z*Math.cos(I)),o+V*Math.sin(P),p-Z*Math.cos(P),o,p];if(c)return Q;D&&(Q=Q.concat(D));for(var K=0;K<Q.length;){var $=t(Q[K],Q[K+1],s);Q[K++]=$.x,Q[K++]=$.y}return Q}function t(a,r,g){return{x:a*Math.cos(g)-r*Math.sin(g),y:a*Math.sin(g)+r*Math.cos(g)}}function n(a){return a*(d/180)}G.exports=function(a){for(var r,g=[],u=0,s=0,h=0,l=0,o=null,p=null,c=0,i=0,x=0,f=a.length;x<f;x++){var _=a[x],b=_[0];switch(b){case"M":h=_[1],l=_[2];break;case"A":(_=e(c,i,_[1],_[2],n(_[3]),_[4],_[5],_[6],_[7])).unshift("C"),_.length>7&&(g.push(_.splice(0,7)),_.unshift("C"));break;case"S":var T=c,k=i;r!="C"&&r!="S"||(T+=T-u,k+=k-s),_=["C",T,k,_[1],_[2],_[3],_[4]];break;case"T":r=="Q"||r=="T"?(o=2*c-o,p=2*i-p):(o=c,p=i),_=y(c,i,o,p,_[1],_[2]);break;case"Q":o=_[1],p=_[2],_=y(c,i,_[1],_[2],_[3],_[4]);break;case"L":_=w(c,i,_[1],_[2]);break;case"H":_=w(c,i,_[1],i);break;case"V":_=w(c,i,c,_[1]);break;case"Z":_=w(c,i,h,l)}r=b,c=_[_.length-2],i=_[_.length-1],_.length>4?(u=_[_.length-4],s=_[_.length-3]):(u=c,s=i),g.push(_)}return g}},{}],247:[function(m,G,W){var d=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;function y(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}G.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if(Object.getOwnPropertyNames(t).map(function(r){return t[r]}).join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(r){a[r]=r}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(e,t){for(var n,a,r=y(e),g=1;g<arguments.length;g++){for(var u in n=Object(arguments[g]))v.call(n,u)&&(r[u]=n[u]);if(d){a=d(n);for(var s=0;s<a.length;s++)w.call(n,a[s])&&(r[a[s]]=n[a[s]])}}return r}},{}],248:[function(m,G,W){function d(y,e){if(typeof y!="string")return[y];var t=[y];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",r=!!e.flat;n.forEach(function(u){var s=new RegExp(["\\",u[0],"[^\\",u[0],"\\",u[1],"]*\\",u[1]].join("")),h=[];function l(o,p,c){var i=t.push(o.slice(u[0].length,-u[1].length))-1;return h.push(i),a+i+a}t.forEach(function(o,p){for(var c,i=0;o!=c;)if(c=o,o=o.replace(s,l),i++>1e4)throw Error("References have circular dependency. Please, check them.");t[p]=o}),h=h.reverse(),t=t.map(function(o){return h.forEach(function(p){o=o.replace(new RegExp("(\\"+a+p+"\\"+a+")","g"),u[0]+"$1"+u[1])}),o})});var g=new RegExp("\\"+a+"([0-9]+)\\"+a);return r?t:function u(s,h,l){for(var o,p=[],c=0;o=g.exec(s);){if(c++>1e4)throw Error("Circular references in parenthesis");p.push(s.slice(0,o.index)),p.push(u(h[o[1]],h)),s=s.slice(o.index+o[0].length)}return p.push(s),p}(t[0],t)}function v(y,e){if(e&&e.flat){var t,n=e&&e.escape||"___",a=y[0];if(!a)return"";for(var r=new RegExp("\\"+n+"([0-9]+)\\"+n),g=0;a!=t;){if(g++>1e4)throw Error("Circular references in "+y);t=a,a=a.replace(r,u)}return a}return y.reduce(function s(h,l){return Array.isArray(l)&&(l=l.reduce(s,"")),h+l},"");function u(s,h){if(y[h]==null)throw Error("Reference "+h+"is undefined");return y[h]}}function w(y,e){return Array.isArray(y)?v(y,e):d(y,e)}w.parse=d,w.stringify=v,G.exports=w},{}],249:[function(m,G,W){var d=m("pick-by-alias");G.exports=function(v){var w;return arguments.length>1&&(v=arguments),typeof v=="string"?v=v.split(/\s/).map(parseFloat):typeof v=="number"&&(v=[v]),v.length&&typeof v[0]=="number"?w=v.length===1?{width:v[0],height:v[0],x:0,y:0}:v.length===2?{width:v[0],height:v[1],x:0,y:0}:{x:v[0],y:v[1],width:v[2]-v[0]||0,height:v[3]-v[1]||0}:v&&(v=d(v,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),w={x:v.left||0,y:v.top||0},v.width==null?v.right?w.width=v.right-w.x:w.width=0:w.width=v.width,v.height==null?v.bottom?w.height=v.bottom-w.y:w.height=0:w.height=v.height),w}},{"pick-by-alias":253}],250:[function(m,G,W){G.exports=function(y){var e=[];return y.replace(v,function(t,n,a){var r=n.toLowerCase();for(a=function(g){var u=g.match(w);return u?u.map(Number):[]}(a),r=="m"&&a.length>2&&(e.push([n].concat(a.splice(0,2))),r="l",n=n=="m"?"l":"L");;){if(a.length==d[r])return a.unshift(n),e.push(a);if(a.length<d[r])throw new Error("malformed path data");e.push([n].concat(a.splice(0,d[r])))}}),e};var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},v=/([astvzqmhlc])([^astvzqmhlc]*)/gi,w=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(m,G,W){G.exports=function(d,v){v||(v=[0,""]),d=String(d);var w=parseFloat(d,10);return v[0]=w,v[1]=d.match(/[\d.\-\+]*\s*(.*)/)[1]||"",v}},{}],252:[function(m,G,W){(function(d){(function(){(function(){var v,w,y,e,t,n;typeof performance<"u"&&performance!==null&&performance.now?G.exports=function(){return performance.now()}:d!=null&&d.hrtime?(G.exports=function(){return(v()-t)/1e6},w=d.hrtime,e=(v=function(){var a;return 1e9*(a=w())[0]+a[1]})(),n=1e9*d.uptime(),t=e-n):Date.now?(G.exports=function(){return Date.now()-y},y=Date.now()):(G.exports=function(){return new Date().getTime()-y},y=new Date().getTime())}).call(this)}).call(this)}).call(this,m("_process"))},{_process:278}],253:[function(m,G,W){G.exports=function(w,y,e){var t,n,a={};if(typeof y=="string"&&(y=v(y)),Array.isArray(y)){var r={};for(n=0;n<y.length;n++)r[y[n]]=!0;y=r}for(t in y)y[t]=v(y[t]);var g={};for(t in y){var u=y[t];if(Array.isArray(u))for(n=0;n<u.length;n++){var s=u[n];if(e&&(g[s]=!0),s in w){if(a[t]=w[s],e)for(var h=n;h<u.length;h++)g[u[h]]=!0;break}}else t in w&&(y[t]&&(a[t]=w[t]),e&&(g[t]=!0))}if(e)for(t in w)g[t]||(a[t]=w[t]);return a};var d={};function v(w){return d[w]?d[w]:(typeof w=="string"&&(w=d[w]=w.split(/\s*,\s*|\s+/)),w)}},{}],254:[function(m,G,W){G.exports=function(d,v,w,y){var e=d[0],t=d[1],n=!1;w===void 0&&(w=0),y===void 0&&(y=v.length);for(var a=y-w,r=0,g=a-1;r<a;g=r++){var u=v[r+w][0],s=v[r+w][1],h=v[g+w][0],l=v[g+w][1];s>t!=l>t&&e<(h-u)*(t-s)/(l-s)+u&&(n=!n)}return n}},{}],255:[function(m,G,W){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var d,v=m("./lib/build-log"),w=m("./lib/epsilon"),y=m("./lib/intersecter"),e=m("./lib/segment-chainer"),t=m("./lib/segment-selector"),n=m("./lib/geojson"),a=!1,r=w();function g(u,s,h){var l=d.segments(u),o=d.segments(s),p=h(d.combine(l,o));return d.polygon(p)}d={buildLog:function(u){return u===!0?a=v():u===!1&&(a=!1),a!==!1&&a.list},epsilon:function(u){return r.epsilon(u)},segments:function(u){var s=y(!0,r,a);return u.regions.forEach(s.addRegion),{segments:s.calculate(u.inverted),inverted:u.inverted}},combine:function(u,s){return{combined:y(!1,r,a).calculate(u.segments,u.inverted,s.segments,s.inverted),inverted1:u.inverted,inverted2:s.inverted}},selectUnion:function(u){return{segments:t.union(u.combined,a),inverted:u.inverted1||u.inverted2}},selectIntersect:function(u){return{segments:t.intersect(u.combined,a),inverted:u.inverted1&&u.inverted2}},selectDifference:function(u){return{segments:t.difference(u.combined,a),inverted:u.inverted1&&!u.inverted2}},selectDifferenceRev:function(u){return{segments:t.differenceRev(u.combined,a),inverted:!u.inverted1&&u.inverted2}},selectXor:function(u){return{segments:t.xor(u.combined,a),inverted:u.inverted1!==u.inverted2}},polygon:function(u){return{regions:e(u.segments,r,a),inverted:u.inverted}},polygonFromGeoJSON:function(u){return n.toPolygon(d,u)},polygonToGeoJSON:function(u){return n.fromPolygon(d,r,u)},union:function(u,s){return g(u,s,d.selectUnion)},intersect:function(u,s){return g(u,s,d.selectIntersect)},difference:function(u,s){return g(u,s,d.selectDifference)},differenceRev:function(u,s){return g(u,s,d.selectDifferenceRev)},xor:function(u,s){return g(u,s,d.selectXor)}},typeof window=="object"&&(window.PolyBool=d),G.exports=d},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(m,G,W){G.exports=function(){var d,v=0,w=!1;function y(e,t){return d.list.push({type:e,data:t?JSON.parse(JSON.stringify(t)):void 0}),d}return d={list:[],segmentId:function(){return v++},checkIntersection:function(e,t){return y("check",{seg1:e,seg2:t})},segmentChop:function(e,t){return y("div_seg",{seg:e,pt:t}),y("chop",{seg:e,pt:t})},statusRemove:function(e){return y("pop_seg",{seg:e})},segmentUpdate:function(e){return y("seg_update",{seg:e})},segmentNew:function(e,t){return y("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return y("rem_seg",{seg:e})},tempStatus:function(e,t,n){return y("temp_status",{seg:e,above:t,below:n})},rewind:function(e){return y("rewind",{seg:e})},status:function(e,t,n){return y("status",{seg:e,above:t,below:n})},vert:function(e){return e===w?d:(w=e,y("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),y("log",{txt:e})},reset:function(){return y("reset")},selected:function(e){return y("selected",{segs:e})},chainStart:function(e){return y("chain_start",{seg:e})},chainRemoveHead:function(e,t){return y("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return y("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return y("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return y("chain_match",{index:e})},chainClose:function(e){return y("chain_close",{index:e})},chainAddHead:function(e,t){return y("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return y("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return y("chain_con",{index1:e,index2:t})},chainReverse:function(e){return y("chain_rev",{index:e})},chainJoin:function(e,t){return y("chain_join",{index1:e,index2:t})},done:function(){return y("done")}}}},{}],257:[function(m,G,W){G.exports=function(d){typeof d!="number"&&(d=1e-10);var v={epsilon:function(w){return typeof w=="number"&&(d=w),d},pointAboveOrOnLine:function(w,y,e){var t=y[0],n=y[1],a=e[0],r=e[1],g=w[0];return(a-t)*(w[1]-n)-(r-n)*(g-t)>=-d},pointBetween:function(w,y,e){var t=w[1]-y[1],n=e[0]-y[0],a=w[0]-y[0],r=e[1]-y[1],g=a*n+t*r;return!(g<d)&&!(g-(n*n+r*r)>-d)},pointsSameX:function(w,y){return Math.abs(w[0]-y[0])<d},pointsSameY:function(w,y){return Math.abs(w[1]-y[1])<d},pointsSame:function(w,y){return v.pointsSameX(w,y)&&v.pointsSameY(w,y)},pointsCompare:function(w,y){return v.pointsSameX(w,y)?v.pointsSameY(w,y)?0:w[1]<y[1]?-1:1:w[0]<y[0]?-1:1},pointsCollinear:function(w,y,e){var t=w[0]-y[0],n=w[1]-y[1],a=y[0]-e[0],r=y[1]-e[1];return Math.abs(t*r-a*n)<d},linesIntersect:function(w,y,e,t){var n=y[0]-w[0],a=y[1]-w[1],r=t[0]-e[0],g=t[1]-e[1],u=n*g-a*r;if(Math.abs(u)<d)return!1;var s=w[0]-e[0],h=w[1]-e[1],l=(r*h-g*s)/u,o=(n*h-a*s)/u,p={alongA:0,alongB:0,pt:[w[0]+l*n,w[1]+l*a]};return p.alongA=l<=-d?-2:l<d?-1:l-1<=-d?0:l-1<d?1:2,p.alongB=o<=-d?-2:o<d?-1:o-1<=-d?0:o-1<d?1:2,p},pointInsideRegion:function(w,y){for(var e=w[0],t=w[1],n=y[y.length-1][0],a=y[y.length-1][1],r=!1,g=0;g<y.length;g++){var u=y[g][0],s=y[g][1];s-t>d!=a-t>d&&(n-u)*(t-s)/(a-s)+u-e>d&&(r=!r),n=u,a=s}return r}};return v}},{}],258:[function(m,G,W){var d={toPolygon:function(v,w){function y(n){if(n.length<=0)return v.segments({inverted:!1,regions:[]});function a(u){var s=u.slice(0,u.length-1);return v.segments({inverted:!1,regions:[s]})}for(var r=a(n[0]),g=1;g<n.length;g++)r=v.selectDifference(v.combine(r,a(n[g])));return r}if(w.type==="Polygon")return v.polygon(y(w.coordinates));if(w.type==="MultiPolygon"){for(var e=v.segments({inverted:!1,regions:[]}),t=0;t<w.coordinates.length;t++)e=v.selectUnion(v.combine(e,y(w.coordinates[t])));return v.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(v,w,y){function e(o,p){return w.pointInsideRegion([.5*(o[0][0]+o[1][0]),.5*(o[0][1]+o[1][1])],p)}function t(o){return{region:o,children:[]}}y=v.polygon(v.segments(y));var n=t(null);function a(o,p){for(var c=0;c<o.children.length;c++)if(e(p,(x=o.children[c]).region))return void a(x,p);var i=t(p);for(c=0;c<o.children.length;c++){var x;e((x=o.children[c]).region,p)&&(i.children.push(x),o.children.splice(c,1),c--)}o.children.push(i)}for(var r=0;r<y.regions.length;r++){var g=y.regions[r];g.length<3||a(n,g)}function u(o,p){for(var c=0,i=o[o.length-1][0],x=o[o.length-1][1],f=[],_=0;_<o.length;_++){var b=o[_][0],T=o[_][1];f.push([b,T]),c+=T*i-b*x,i=b,x=T}return c<0!==p&&f.reverse(),f.push([f[0][0],f[0][1]]),f}var s=[];function h(o){var p=[u(o.region,!1)];s.push(p);for(var c=0;c<o.children.length;c++)p.push(l(o.children[c]))}function l(o){for(var p=0;p<o.children.length;p++)h(o.children[p]);return u(o.region,!0)}for(r=0;r<n.children.length;r++)h(n.children[r]);return s.length<=0?{type:"Polygon",coordinates:[]}:s.length==1?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}};G.exports=d},{}],259:[function(m,G,W){var d=m("./linked-list");G.exports=function(v,w,y){function e(u,s,h){return{id:y?y.segmentId():-1,start:u,end:s,myFill:{above:h.myFill.above,below:h.myFill.below},otherFill:null}}var t=d.create();function n(u,s){t.insertBefore(u,function(h){return function(l,o,p,c,i,x){var f=w.pointsCompare(o,i);return f!==0?f:w.pointsSame(p,x)?0:l!==c?l?1:-1:w.pointAboveOrOnLine(p,c?i:x,c?x:i)?1:-1}(u.isStart,u.pt,s,h.isStart,h.pt,h.other.pt)<0})}function a(u,s){var h=function(l,o){var p=d.node({isStart:!0,pt:l.start,seg:l,primary:o,other:null,status:null});return n(p,l.end),p}(u,s);return function(l,o,p){var c=d.node({isStart:!1,pt:o.end,seg:o,primary:p,other:l,status:null});l.other=c,n(c,l.pt)}(h,u,s),h}function r(u,s){var h=e(s,u.seg.end,u.seg);return function(l,o){y&&y.segmentChop(l.seg,o),l.other.remove(),l.seg.end=o,l.other.pt=o,n(l.other,l.pt)}(u,s),a(h,u.primary)}function g(u,s){var h=d.create();function l(I){return h.findTransition(function(P){var S,E,z,D,j,V;return S=I,E=P.ev,z=S.seg.start,D=S.seg.end,j=E.seg.start,V=E.seg.end,(w.pointsCollinear(z,j,V)?w.pointsCollinear(D,j,V)||w.pointAboveOrOnLine(D,j,V)?1:-1:w.pointAboveOrOnLine(z,j,V)?1:-1)>0})}function o(I,P){var S=I.seg,E=P.seg,z=S.start,D=S.end,j=E.start,V=E.end;y&&y.checkIntersection(S,E);var Z=w.linesIntersect(z,D,j,V);if(Z===!1){if(!w.pointsCollinear(z,D,j)||w.pointsSame(z,V)||w.pointsSame(D,j))return!1;var Q=w.pointsSame(z,j),K=w.pointsSame(D,V);if(Q&&K)return P;var $=!Q&&w.pointBetween(z,j,V),ne=!K&&w.pointBetween(D,j,V);if(Q)return ne?r(P,D):r(I,V),P;$&&(K||(ne?r(P,D):r(I,V)),r(P,z))}else Z.alongA===0&&(Z.alongB===-1?r(I,j):Z.alongB===0?r(I,Z.pt):Z.alongB===1&&r(I,V)),Z.alongB===0&&(Z.alongA===-1?r(P,z):Z.alongA===0?r(P,Z.pt):Z.alongA===1&&r(P,D));return!1}for(var p=[];!t.isEmpty();){var c=t.getHead();if(y&&y.vert(c.pt[0]),c.isStart){let I=function(){if(x){var P=o(c,x);if(P)return P}return!!f&&o(c,f)};var A=I;y&&y.segmentNew(c.seg,c.primary);var i=l(c),x=i.before?i.before.ev:null,f=i.after?i.after.ev:null;y&&y.tempStatus(c.seg,!!x&&x.seg,!!f&&f.seg);var _,b=I();if(b){var T;v?(T=c.seg.myFill.below===null||c.seg.myFill.above!==c.seg.myFill.below)&&(b.seg.myFill.above=!b.seg.myFill.above):b.seg.otherFill=c.seg.myFill,y&&y.segmentUpdate(b.seg),c.other.remove(),c.remove()}if(t.getHead()!==c){y&&y.rewind(c.seg);continue}v?(T=c.seg.myFill.below===null||c.seg.myFill.above!==c.seg.myFill.below,c.seg.myFill.below=f?f.seg.myFill.above:u,c.seg.myFill.above=T?!c.seg.myFill.below:c.seg.myFill.below):c.seg.otherFill===null&&(_=f?c.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:c.primary?s:u,c.seg.otherFill={above:_,below:_}),y&&y.status(c.seg,!!x&&x.seg,!!f&&f.seg),c.other.status=i.insert(d.node({ev:c}))}else{var k=c.status;if(k===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(h.exists(k.prev)&&h.exists(k.next)&&o(k.prev.ev,k.next.ev),y&&y.statusRemove(k.ev.seg),k.remove(),!c.primary){var L=c.seg.myFill;c.seg.myFill=c.seg.otherFill,c.seg.otherFill=L}p.push(c.seg)}t.getHead().remove()}return y&&y.done(),p}return v?{addRegion:function(u){for(var s,h,l,o=u[u.length-1],p=0;p<u.length;p++){s=o,o=u[p];var c=w.pointsCompare(s,o);c!==0&&a((h=c<0?s:o,l=c<0?o:s,{id:y?y.segmentId():-1,start:h,end:l,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(u){return g(u,!1)}}:{calculate:function(u,s,h,l){return u.forEach(function(o){a(e(o.start,o.end,o),!0)}),h.forEach(function(o){a(e(o.start,o.end,o),!1)}),g(s,l)}}}},{"./linked-list":260}],260:[function(m,G,W){G.exports={create:function(){var d={root:{root:!0,next:null},exists:function(v){return v!==null&&v!==d.root},isEmpty:function(){return d.root.next===null},getHead:function(){return d.root.next},insertBefore:function(v,w){for(var y=d.root,e=d.root.next;e!==null;){if(w(e))return v.prev=e.prev,v.next=e,e.prev.next=v,void(e.prev=v);y=e,e=e.next}y.next=v,v.prev=y,v.next=null},findTransition:function(v){for(var w=d.root,y=d.root.next;y!==null&&!v(y);)w=y,y=y.next;return{before:w===d.root?null:w,after:y,insert:function(e){return e.prev=w,e.next=y,w.next=e,y!==null&&(y.prev=e),e}}}};return d},node:function(d){return d.prev=null,d.next=null,d.remove=function(){d.prev.next=d.next,d.next&&(d.next.prev=d.prev),d.prev=null,d.next=null},d}}},{}],261:[function(m,G,W){G.exports=function(d,v,w){var y=[],e=[];return d.forEach(function(t){var n=t.start,a=t.end;if(v.pointsSame(n,a))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{w&&w.chainStart(t);for(var r={index:0,matches_head:!1,matches_pt1:!1},g={index:0,matches_head:!1,matches_pt1:!1},u=r,s=0;s<y.length;s++){var h=(i=y[s])[0],l=(i[1],i[i.length-1]);if(i[i.length-2],v.pointsSame(h,n)){if(A(s,!0,!0))break}else if(v.pointsSame(h,a)){if(A(s,!0,!1))break}else if(v.pointsSame(l,n)){if(A(s,!1,!0))break}else if(v.pointsSame(l,a)&&A(s,!1,!1))break}if(u===r)return y.push([n,a]),void(w&&w.chainNew(n,a));if(u===g){w&&w.chainMatch(r.index);var o=r.index,p=r.matches_pt1?a:n,c=r.matches_head,i=y[o],x=c?i[0]:i[i.length-1],f=c?i[1]:i[i.length-2],_=c?i[i.length-1]:i[0],b=c?i[i.length-2]:i[1];return v.pointsCollinear(f,x,p)&&(c?(w&&w.chainRemoveHead(r.index,p),i.shift()):(w&&w.chainRemoveTail(r.index,p),i.pop()),x=f),v.pointsSame(_,p)?(y.splice(o,1),v.pointsCollinear(b,_,x)&&(c?(w&&w.chainRemoveTail(r.index,x),i.pop()):(w&&w.chainRemoveHead(r.index,x),i.shift())),w&&w.chainClose(r.index),void e.push(i)):void(c?(w&&w.chainAddHead(r.index,p),i.unshift(p)):(w&&w.chainAddTail(r.index,p),i.push(p)))}var T=r.index,k=g.index;w&&w.chainConnect(T,k);var L=y[T].length<y[k].length;r.matches_head?g.matches_head?L?(I(T),P(T,k)):(I(k),P(k,T)):P(k,T):g.matches_head?P(T,k):L?(I(T),P(k,T)):(I(k),P(T,k))}function A(S,E,z){return u.index=S,u.matches_head=E,u.matches_pt1=z,u===r?(u=g,!1):(u=null,!0)}function I(S){w&&w.chainReverse(S),y[S].reverse()}function P(S,E){var z=y[S],D=y[E],j=z[z.length-1],V=z[z.length-2],Z=D[0],Q=D[1];v.pointsCollinear(V,j,Z)&&(w&&w.chainRemoveTail(S,j),z.pop(),j=V),v.pointsCollinear(j,Z,Q)&&(w&&w.chainRemoveHead(E,Z),D.shift()),w&&w.chainJoin(S,E),y[S]=z.concat(D),y.splice(E,1)}}),e}},{}],262:[function(m,G,W){function d(w,y,e){var t=[];return w.forEach(function(n){var a=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);y[a]!==0&&t.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:y[a]===1,below:y[a]===2},otherFill:null})}),e&&e.selected(t),t}var v={union:function(w,y){return d(w,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],y)},intersect:function(w,y){return d(w,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],y)},difference:function(w,y){return d(w,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],y)},differenceRev:function(w,y){return d(w,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],y)},xor:function(w,y){return d(w,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],y)}};G.exports=v},{}],263:[function(m,G,W){var d=m("stream").Transform,v=m("stream-parser");function w(){d.call(this,{readableObjectMode:!0})}function y(e,t,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,t&&(this.code=t),n&&(this.statusCode=n)}w.prototype=Object.create(d.prototype),w.prototype.constructor=w,v(w.prototype),W.ParserStream=w,W.sliceEq=function(e,t,n){for(var a=t,r=0;r<n.length;)if(e[a++]!==n[r++])return!1;return!0},W.str2arr=function(e,t){var n=[],a=0;if(t&&t==="hex")for(;a<e.length;)n.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)n.push(255&e.charCodeAt(a));return n},W.readUInt16LE=function(e,t){return e[t]|e[t+1]<<8},W.readUInt16BE=function(e,t){return e[t+1]|e[t]<<8},W.readUInt32LE=function(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|16777216*e[t+3]},W.readUInt32BE=function(e,t){return e[t+3]|e[t+2]<<8|e[t+1]<<16|16777216*e[t]},y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,W.ProbeError=y},{stream:286,"stream-parser":302}],264:[function(m,G,W){function d(y,e){var t=new Error(y);return t.code=e,t}function v(y){try{return decodeURIComponent(escape(y))}catch{return y}}function w(y,e,t){this.input=y.subarray(e,t),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw d("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}w.prototype.each=function(y){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var t=this.ifds_to_read.shift();t.offset&&this.scan_ifd(t.id,t.offset,y)}},w.prototype.read_uint16=function(y){var e=this.input;if(y+2>e.length)throw d("unexpected EOF","EBADDATA");return this.big_endian?256*e[y]+e[y+1]:e[y]+256*e[y+1]},w.prototype.read_uint32=function(y){var e=this.input;if(y+4>e.length)throw d("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[y]+65536*e[y+1]+256*e[y+2]+e[y+3]:e[y]+256*e[y+1]+65536*e[y+2]+16777216*e[y+3]},w.prototype.is_subifd_link=function(y,e){return y===0&&e===34665||y===0&&e===34853||y===34665&&e===40965},w.prototype.exif_format_length=function(y){switch(y){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},w.prototype.exif_format_read=function(y,e){var t;switch(y){case 1:case 2:return t=this.input[e];case 6:return(t=this.input[e])|33554430*(128&t);case 3:return t=this.read_uint16(e);case 8:return(t=this.read_uint16(e))|131070*(32768&t);case 4:return t=this.read_uint32(e);case 9:return 0|(t=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},w.prototype.scan_ifd=function(y,e,t){var n=this.read_uint16(e);e+=2;for(var a=0;a<n;a++){var r=this.read_uint16(e),g=this.read_uint16(e+2),u=this.read_uint32(e+4),s=this.exif_format_length(g),h=u*s,l=h<=4?e+8:this.read_uint32(e+8),o=!1;if(l+h>this.input.length)throw d("unexpected EOF","EBADDATA");for(var p=[],c=l,i=0;i<u;i++,c+=s){var x=this.exif_format_read(g,c);if(x===null){p=null;break}p.push(x)}if(Array.isArray(p)&&g===2&&(p=v(String.fromCharCode.apply(null,p)))&&p[p.length-1]==="\0"&&(p=p.slice(0,-1)),this.is_subifd_link(y,r)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:r,offset:p[0]}),o=!0),t({is_big_endian:this.big_endian,ifd:y,tag:r,format:g,count:u,entry_offset:e+this.start,data_length:h,data_offset:l+this.start,value:p,is_subifd_link:o})===!1)return void(this.aborted=!0);e+=12}y===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},G.exports.ExifParser=w,G.exports.get_orientation=function(y){var e=0;try{return new w(y,0,y.length).each(function(t){if(t.ifd===0&&t.tag===274&&Array.isArray(t.value))return e=t.value[0],!1}),e}catch{return-1}}},{}],265:[function(m,G,W){var d=m("./common").readUInt16BE,v=m("./common").readUInt32BE;function w(r,g){if(r.length<4+g)return null;var u=v(r,g);return r.length<u+g||u<8?null:{boxtype:String.fromCharCode.apply(null,r.slice(g+4,g+8)),data:r.slice(g+8,g+u),end:g+u}}function y(r,g){for(var u=0;;){var s=w(r,u);if(!s)break;switch(s.boxtype){case"ispe":g.sizes.push({width:v(s.data,4),height:v(s.data,8)});break;case"irot":g.transforms.push({type:"irot",value:3&s.data[0]});break;case"imir":g.transforms.push({type:"imir",value:1&s.data[0]})}u=s.end}}function e(r,g,u){for(var s=0,h=0;h<u;h++)s=256*s+(r[g+h]||0);return s}function t(r,g){for(var u=r[4]>>4&15,s=15&r[4],h=r[5]>>4&15,l=d(r,6),o=8,p=0;p<l;p++){var c=d(r,o),i=d(r,o+=2),x=e(r,o+=2,h),f=d(r,o+=h);if(o+=2,i===0&&f===1){var _=e(r,o,u),b=e(r,o+u,s);g.item_loc[c]={length:b,offset:_+x}}o+=f*(u+s)}}function n(r,g){for(var u=d(r,4),s=6,h=0;h<u;h++){var l=w(r,s);if(!l)break;if(l.boxtype==="infe"){for(var o=d(l.data,4),p="",c=8;c<l.data.length&&l.data[c];c++)p+=String.fromCharCode(l.data[c]);g.item_inf[p]=o}s=l.end}}function a(r,g){for(var u=0;;){var s=w(r,u);if(!s)break;s.boxtype==="ipco"&&y(s.data,g),u=s.end}}G.exports.unbox=w,G.exports.readSizeFromMeta=function(r){var g={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(c,i){for(var x=4;;){var f=w(c,x);if(!f)break;f.boxtype==="iprp"&&a(f.data,i),f.boxtype==="iloc"&&t(f.data,i),f.boxtype==="iinf"&&n(f.data,i),x=f.end}}(r,g),g.sizes.length){var u,s,h,l=(u=g.sizes,s=u.reduce(function(c,i){return c.width>i.width||c.width===i.width&&c.height>i.height?c:i}),h=u.reduce(function(c,i){return c.height>i.height||c.height===i.height&&c.width>i.width?c:i}),s.width>h.height||s.width===h.height&&s.height>h.width?s:h),o=1;g.transforms.forEach(function(c){var i={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},x={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(c.type==="imir"&&(o=c.value===0?x[o]:i[o=i[o=x[o]]]),c.type==="irot")for(var f=0;f<c.value;f++)o=i[o]});var p=null;return g.item_inf.Exif&&(p=g.item_loc[g.item_inf.Exif]),{width:l.width,height:l.height,orientation:g.transforms.length?o:null,variants:g.sizes,exif_location:p}}},G.exports.getMimeType=function(r){var g=String.fromCharCode.apply(null,r.slice(0,4)),u={};u[g]=!0;for(var s=8;s<r.length;s+=4)u[String.fromCharCode.apply(null,r.slice(s,s+4))]=!0;if(u.mif1||u.msf1||u.miaf)return g==="avif"||g==="avis"||g==="avio"?{type:"avif",mime:"image/avif"}:g==="heic"||g==="heix"?{type:"heic",mime:"image/heic"}:g==="hevc"||g==="hevx"?{type:"heic",mime:"image/heic-sequence"}:u.avif||u.avis?{type:"avif",mime:"image/avif"}:u.heic||u.heix||u.hevc||u.hevx||u.heis?u.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=m("../miaf_utils"),e=m("../exif_utils"),t=d("ftyp");G.exports=function(n){if(v(n,4,t)){var a=y.unbox(n,0);if(a){var r=y.getMimeType(a.data);if(r){for(var g,u=a.end;;){var s=y.unbox(n,u);if(!s)break;if(u=s.end,s.boxtype==="mdat")return;if(s.boxtype==="meta"){g=s.data;break}}if(g){var h=y.readSizeFromMeta(g);if(h){var l={width:h.width,height:h.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(h.variants.length>1&&(l.variants=h.variants),h.orientation&&(l.orientation=h.orientation),h.exif_location&&h.exif_location.offset+h.exif_location.length<=n.length){var o=w(n,h.exif_location.offset),p=n.slice(h.exif_location.offset+o+4,h.exif_location.offset+h.exif_location.length),c=e.get_orientation(p);c>0&&(l.orientation=c)}return l}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=d("BM");G.exports=function(e){if(!(e.length<26)&&v(e,0,y))return{width:w(e,18),height:w(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=d("GIF87a"),e=d("GIF89a");G.exports=function(t){if(!(t.length<10)&&(v(t,0,y)||v(t,0,e)))return{width:w(t,6),height:w(t,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(m,G,W){var d=m("../common").readUInt16LE;G.exports=function(v){var w=d(v,0),y=d(v,2),e=d(v,4);if(w===0&&y===1&&e){for(var t=[],n={width:0,height:0},a=0;a<e;a++){var r=v[6+16*a]||256,g=v[6+16*a+1]||256,u={width:r,height:g};t.push(u),(r>n.width||g>n.height)&&(n=u)}return{width:n.width,height:n.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(m,G,W){var d=m("../common").readUInt16BE,v=m("../common").str2arr,w=m("../common").sliceEq,y=m("../exif_utils"),e=v("Exif\0\0");G.exports=function(t){if(!(t.length<2)&&t[0]===255&&t[1]===216&&t[2]===255)for(var n=2;;){for(;;){if(t.length-n<2)return;if(t[n++]===255)break}for(var a,r,g=t[n++];g===255;)g=t[n++];if(208<=g&&g<=217||g===1)a=0;else{if(!(192<=g&&g<=254)||t.length-n<2)return;a=d(t,n)-2,n+=2}if(g===217||g===218)return;if(g===225&&a>=10&&w(t,n,e)&&(r=y.get_orientation(t.slice(n+6,n+a))),a>=5&&192<=g&&g<=207&&g!==196&&g!==200&&g!==204){if(t.length-n<a)return;var u={width:d(t,n+3),height:d(t,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return r>0&&(u.orientation=r),u}n+=a}}},{"../common":263,"../exif_utils":264}],271:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=d(`\x89PNG\r

`),e=d("IHDR");G.exports=function(t){if(!(t.length<24)&&v(t,0,y)&&v(t,12,e))return{width:w(t,16),height:w(t,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=d("8BPS\0");G.exports=function(e){if(!(e.length<22)&&v(e,0,y))return{width:w(e,18),height:w(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(m,G,W){function d(r){return typeof r=="number"&&isFinite(r)&&r>0}var v=/<[-_.:a-zA-Z0-9][^>]*>/,w=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,y=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,t=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,n=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function a(r){return n.test(r)?r.match(n)[0]:"px"}G.exports=function(r){if(function(_){var b,T=0,k=_.length;for(_[0]===239&&_[1]===187&&_[2]===191&&(T=3);T<k&&((b=_[T])===32||b===9||b===13||b===10);)T++;return T!==k&&_[T]===60}(r)){for(var g="",u=0;u<r.length;u++)g+=String.fromCharCode(r[u]);var s=(g.match(v)||[""])[0];if(w.test(s)){var h=function(_){var b=_.match(y),T=_.match(e),k=_.match(t);return{width:b&&(b[1]||b[2]),height:T&&(T[1]||T[2]),viewbox:k&&(k[1]||k[2])}}(s),l=parseFloat(h.width),o=parseFloat(h.height);if(h.width&&h.height)return!d(l)||!d(o)?void 0:{width:l,height:o,type:"svg",mime:"image/svg+xml",wUnits:a(h.width),hUnits:a(h.height)};var p=(h.viewbox||"").split(" "),c={width:p[2],height:p[3]},i=parseFloat(c.width),x=parseFloat(c.height);if(d(i)&&d(x)&&a(c.width)===a(c.height)){var f=i/x;return h.width?d(l)?{width:l,height:l/f,type:"svg",mime:"image/svg+xml",wUnits:a(h.width),hUnits:a(h.width)}:void 0:h.height?d(o)?{width:o*f,height:o,type:"svg",mime:"image/svg+xml",wUnits:a(h.height),hUnits:a(h.height)}:void 0:{width:i,height:x,type:"svg",mime:"image/svg+xml",wUnits:a(c.width),hUnits:a(c.height)}}}}}},{}],274:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=m("../common").readUInt16BE,e=m("../common").readUInt32LE,t=m("../common").readUInt32BE,n=d("II*\0"),a=d("MM\0*");function r(s,h,l){return l?y(s,h):w(s,h)}function g(s,h,l){return l?t(s,h):e(s,h)}function u(s,h,l){var o=r(s,h+2,l);return g(s,h+4,l)!==1||o!==3&&o!==4?null:o===3?r(s,h+8,l):g(s,h+8,l)}G.exports=function(s){if(!(s.length<8)&&(v(s,0,n)||v(s,0,a))){var h=s[0]===77,l=g(s,4,h)-8;if(!(l<0)){var o=l+8;if(!(s.length-o<2)){var p=12*r(s,o+0,h);if(!(p<=0||(o+=2,s.length-o<p))){var c,i,x,f;for(c=0;c<p;c+=12)(f=r(s,o+c,h))===256?i=u(s,o+c,h):f===257&&(x=u(s,o+c,h));return i&&x?{width:i,height:x,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(m,G,W){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=m("../common").readUInt32LE,e=m("../exif_utils"),t=d("RIFF"),n=d("WEBP");function a(u,s){if(u[s+3]===157&&u[s+4]===1&&u[s+5]===42)return{width:16383&w(u,s+6),height:16383&w(u,s+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function r(u,s){if(u[s]===47){var h=y(u,s+1);return{width:1+(16383&h),height:1+(h>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function g(u,s){return{width:1+(u[s+6]<<16|u[s+5]<<8|u[s+4]),height:1+(u[s+9]<<s|u[s+8]<<8|u[s+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}G.exports=function(u){if(!(u.length<16)&&(v(u,0,t)||v(u,8,n))){var s=12,h=null,l=0,o=y(u,4)+8;if(!(o>u.length)){for(;s+8<o;)if(u[s]!==0){var p=String.fromCharCode.apply(null,u.slice(s,s+4)),c=y(u,s+4);p==="VP8 "&&c>=10?h=h||a(u,s+8):p==="VP8L"&&c>=9?h=h||r(u,s+8):p==="VP8X"&&c>=10?h=h||g(u,s+8):p==="EXIF"&&(l=e.get_orientation(u.slice(s+8,s+8+c)),s=1/0),s+=8+c}else s++;if(h)return l>0&&(h.orientation=l),h}}}},{"../common":263,"../exif_utils":264}],276:[function(m,G,W){G.exports={avif:m("./parse_sync/avif"),bmp:m("./parse_sync/bmp"),gif:m("./parse_sync/gif"),ico:m("./parse_sync/ico"),jpeg:m("./parse_sync/jpeg"),png:m("./parse_sync/png"),psd:m("./parse_sync/psd"),svg:m("./parse_sync/svg"),tiff:m("./parse_sync/tiff"),webp:m("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(m,G,W){var d=m("./lib/parsers_sync");G.exports=function(v){return function(w){for(var y=Object.keys(d),e=0;e<y.length;e++){var t=d[y[e]](w);if(t)return t}return null}(v)},G.exports.parsers=d},{"./lib/parsers_sync":276}],278:[function(m,G,W){var d,v,w=G.exports={};function y(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function t(o){if(d===setTimeout)return setTimeout(o,0);if((d===y||!d)&&setTimeout)return d=setTimeout,setTimeout(o,0);try{return d(o,0)}catch{try{return d.call(null,o,0)}catch{return d.call(this,o,0)}}}(function(){try{d=typeof setTimeout=="function"?setTimeout:y}catch{d=y}try{v=typeof clearTimeout=="function"?clearTimeout:e}catch{v=e}})();var n,a=[],r=!1,g=-1;function u(){r&&n&&(r=!1,n.length?a=n.concat(a):g=-1,a.length&&s())}function s(){if(!r){var o=t(u);r=!0;for(var p=a.length;p;){for(n=a,a=[];++g<p;)n&&n[g].run();g=-1,p=a.length}n=null,r=!1,function(c){if(v===clearTimeout)return clearTimeout(c);if((v===e||!v)&&clearTimeout)return v=clearTimeout,clearTimeout(c);try{v(c)}catch{try{return v.call(null,c)}catch{return v.call(this,c)}}}(o)}}function h(o,p){this.fun=o,this.array=p}function l(){}w.nextTick=function(o){var p=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)p[c-1]=arguments[c];a.push(new h(o,p)),a.length!==1||r||t(s)},h.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=l,w.addListener=l,w.once=l,w.off=l,w.removeListener=l,w.removeAllListeners=l,w.emit=l,w.prependListener=l,w.prependOnceListener=l,w.listeners=function(o){return[]},w.binding=function(o){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(o){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],279:[function(m,G,W){(function(d){(function(){for(var v=m("performance-now"),w=typeof window>"u"?d:window,y=["moz","webkit"],e="AnimationFrame",t=w["request"+e],n=w["cancel"+e]||w["cancelRequest"+e],a=0;!t&&a<y.length;a++)t=w[y[a]+"Request"+e],n=w[y[a]+"Cancel"+e]||w[y[a]+"CancelRequest"+e];if(!t||!n){var r=0,g=0,u=[];t=function(s){if(u.length===0){var h=v(),l=Math.max(0,1e3/60-(h-r));r=l+h,setTimeout(function(){var o=u.slice(0);u.length=0;for(var p=0;p<o.length;p++)if(!o[p].cancelled)try{o[p].callback(r)}catch(c){setTimeout(function(){throw c},0)}},Math.round(l))}return u.push({handle:++g,callback:s,cancelled:!1}),g},n=function(s){for(var h=0;h<u.length;h++)u[h].handle===s&&(u[h].cancelled=!0)}}G.exports=function(s){return t.call(w,s)},G.exports.cancel=function(){n.apply(w,arguments)},G.exports.polyfill=function(s){s||(s=w),s.requestAnimationFrame=t,s.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(m,G,W){var d=m("array-bounds"),v=m("color-normalize"),w=m("update-diff"),y=m("pick-by-alias"),e=m("object-assign"),t=m("flatten-vertex-data"),n=m("to-float32"),a=n.float32,r=n.fract32;G.exports=function(u,s){if(typeof u=="function"?(s||(s={}),s.regl=u):s=u,s.length&&(s.positions=s),!(u=s.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var h,l,o,p,c,i,x=u._gl,f={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return p=u.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),l=u.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),o=u.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),c=u.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),i=u.buffer({usage:"static",type:"float",data:g}),L(s),h=u({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:u.prop("range"),lineWidth:u.prop("lineWidth"),capSize:u.prop("capSize"),opacity:u.prop("opacity"),scale:u.prop("scale"),translate:u.prop("translate"),scaleFract:u.prop("scaleFract"),translateFract:u.prop("translateFract"),viewport:function(I,P){return[P.viewport.x,P.viewport.y,I.viewportWidth,I.viewportHeight]}},attributes:{color:{buffer:p,offset:function(I,P){return 4*P.offset},divisor:1},position:{buffer:l,offset:function(I,P){return 8*P.offset},divisor:1},positionFract:{buffer:o,offset:function(I,P){return 8*P.offset},divisor:1},error:{buffer:c,offset:function(I,P){return 16*P.offset},divisor:1},direction:{buffer:i,stride:24,offset:0},lineOffset:{buffer:i,stride:24,offset:8},capOffset:{buffer:i,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:u.prop("viewport")},viewport:u.prop("viewport"),stencil:!1,instances:u.prop("count"),count:g.length}),e(b,{update:L,draw:T,destroy:A,regl:u,gl:x,canvas:x.canvas,groups:_}),b;function b(I){I?L(I):I===null&&A(),T()}function T(I){if(typeof I=="number")return k(I);I&&!Array.isArray(I)&&(I=[I]),u._refresh(),_.forEach(function(P,S){P&&(I&&(I[S]?P.draw=!0:P.draw=!1),P.draw?k(S):P.draw=!0)})}function k(I){typeof I=="number"&&(I=_[I]),I!=null&&I&&I.count&&I.color&&I.opacity&&I.positions&&I.positions.length>1&&(I.scaleRatio=[I.scale[0]*I.viewport.width,I.scale[1]*I.viewport.height],h(I),I.after&&I.after(I))}function L(I){if(I){I.length!=null?typeof I[0]=="number"&&(I=[{positions:I}]):Array.isArray(I)||(I=[I]);var P=0,S=0;if(b.groups=_=I.map(function(Q,K){var $=_[K];return Q&&(typeof Q=="function"?Q={after:Q}:typeof Q[0]=="number"&&(Q={positions:Q}),Q=y(Q,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),$||(_[K]=$={id:K,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Q=e({},f,Q)),w($,Q,[{lineWidth:function(ne){return .5*+ne},capSize:function(ne){return .5*+ne},opacity:parseFloat,errors:function(ne){return ne=t(ne),S+=ne.length,ne},positions:function(ne,H){return ne=t(ne,"float64"),H.count=Math.floor(ne.length/2),H.bounds=d(ne,2),H.offset=P,P+=H.count,ne}},{color:function(ne,H){var N=H.count;if(ne||(ne="transparent"),!Array.isArray(ne)||typeof ne[0]=="number"){var U=ne;ne=Array(N);for(var te=0;te<N;te++)ne[te]=U}if(ne.length<N)throw Error("Not enough colors");for(var B=new Uint8Array(4*N),X=0;X<N;X++){var J=v(ne[X],"uint8");B.set(J,4*X)}return B},range:function(ne,H,N){var U=H.bounds;return ne||(ne=U),H.scale=[1/(ne[2]-ne[0]),1/(ne[3]-ne[1])],H.translate=[-ne[0],-ne[1]],H.scaleFract=r(H.scale),H.translateFract=r(H.translate),ne},viewport:function(ne){var H;return Array.isArray(ne)?H={x:ne[0],y:ne[1],width:ne[2]-ne[0],height:ne[3]-ne[1]}:ne?(H={x:ne.x||ne.left||0,y:ne.y||ne.top||0},ne.right?H.width=ne.right-H.x:H.width=ne.w||ne.width||0,ne.bottom?H.height=ne.bottom-H.y:H.height=ne.h||ne.height||0):H={x:0,y:0,width:x.drawingBufferWidth,height:x.drawingBufferHeight},H}}])),$}),P||S){var E=_.reduce(function(Q,K,$){return Q+(K?K.count:0)},0),z=new Float64Array(2*E),D=new Uint8Array(4*E),j=new Float32Array(4*E);_.forEach(function(Q,K){if(Q){var $=Q.positions,ne=Q.count,H=Q.offset,N=Q.color,U=Q.errors;ne&&(D.set(N,4*H),j.set(U,4*H),z.set($,2*H))}});var V=a(z);l(V);var Z=r(z,V);o(Z),p(D),c(j)}}}function A(){l.destroy(),o.destroy(),p.destroy(),c.destroy(),i.destroy()}};var g=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(m,G,W){var d=m("color-normalize"),v=m("array-bounds"),w=m("object-assign"),y=m("glslify"),e=m("pick-by-alias"),t=m("flatten-vertex-data"),n=m("earcut"),a=m("array-normalize"),r=m("to-float32"),g=r.float32,u=r.fract32,s=m("es6-weak-map"),h=m("parse-rect"),l=m("array-find-index");function o(p,c){if(!(this instanceof o))return new o(p,c);if(typeof p=="function"?(c||(c={}),c.regl=p):c=p,c.length&&(c.positions=c),!(p=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=p._gl,this.regl=p,this.passes=[],this.shaders=o.shaders.has(p)?o.shaders.get(p):o.shaders.set(p,o.createShaders(p)).get(p),this.update(c)}G.exports=o,o.dashMult=2,o.maxPatternLength=256,o.precisionThreshold=3e6,o.maxPoints=1e4,o.maxLines=2048,o.shaders=new s,o.createShaders=function(p){var c,i=p.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),x={primitive:"triangle strip",instances:p.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,b){return b.join==="round"?2:1},miterLimit:p.prop("miterLimit"),scale:p.prop("scale"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),thickness:p.prop("thickness"),dashTexture:p.prop("dashTexture"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),dashLength:p.prop("dashLength"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]},depth:p.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,b){return!b.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:p.prop("viewport")},viewport:p.prop("viewport")},f=p(w({vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},x));try{c=p(w({cull:{enable:!0,face:"back"},vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aColor:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:p.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},x))}catch{c=f}return{fill:p({primitive:"triangle",elements:function(_,b){return b.triangles},offset:0,vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:p.prop("scale"),color:p.prop("fill"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:p.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8}},blend:x.blend,depth:{enable:!1},scissor:x.scissor,stencil:x.stencil,viewport:x.viewport}),rect:f,miter:c}},o.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},o.prototype.render=function(){for(var p,c=[],i=arguments.length;i--;)c[i]=arguments[i];c.length&&(p=this).update.apply(p,c),this.draw()},o.prototype.draw=function(){for(var p=this,c=[],i=arguments.length;i--;)c[i]=arguments[i];return(c.length?c:this.passes).forEach(function(x,f){var _;if(x&&Array.isArray(x))return(_=p).draw.apply(_,x);typeof x=="number"&&(x=p.passes[x]),x&&x.count>1&&x.opacity&&(p.regl._refresh(),x.fill&&x.triangles&&x.triangles.length>2&&p.shaders.fill(x),x.thickness&&(x.scale[0]*x.viewport.width>o.precisionThreshold||x.scale[1]*x.viewport.height>o.precisionThreshold||x.join==="rect"||!x.join&&(x.thickness<=2||x.count>=o.maxPoints)?p.shaders.rect(x):p.shaders.miter(x)))}),this},o.prototype.update=function(p){var c=this;if(p){p.length!=null?typeof p[0]=="number"&&(p=[{positions:p}]):Array.isArray(p)||(p=[p]);var i=this.regl,x=this.gl;if(p.forEach(function(k,L){var A=c.passes[L];if(k!==void 0)if(k!==null){if(typeof k[0]=="number"&&(k={positions:k}),k=e(k,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),A||(c.passes[L]=A={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:i.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},k=w({},o.defaults,k)),k.thickness!=null&&(A.thickness=parseFloat(k.thickness)),k.opacity!=null&&(A.opacity=parseFloat(k.opacity)),k.miterLimit!=null&&(A.miterLimit=parseFloat(k.miterLimit)),k.overlay!=null&&(A.overlay=!!k.overlay,L<o.maxLines&&(A.depth=2*(o.maxLines-1-L%o.maxLines)/o.maxLines-1)),k.join!=null&&(A.join=k.join),k.hole!=null&&(A.hole=k.hole),k.fill!=null&&(A.fill=k.fill?d(k.fill,"uint8"):null),k.viewport!=null&&(A.viewport=h(k.viewport)),A.viewport||(A.viewport=h([x.drawingBufferWidth,x.drawingBufferHeight])),k.close!=null&&(A.close=k.close),k.positions===null&&(k.positions=[]),k.positions){var I,P;if(k.positions.x&&k.positions.y){var S=k.positions.x,E=k.positions.y;P=A.count=Math.max(S.length,E.length),I=new Float64Array(2*P);for(var z=0;z<P;z++)I[2*z]=S[z],I[2*z+1]=E[z]}else I=t(k.positions,"float64"),P=A.count=Math.floor(I.length/2);var D=A.bounds=v(I,2);if(A.fill){for(var j=[],V={},Z=0,Q=0,K=0,$=A.count;Q<$;Q++){var ne=I[2*Q],H=I[2*Q+1];isNaN(ne)||isNaN(H)||ne==null||H==null?(ne=I[2*Z],H=I[2*Z+1],V[Q]=Z):Z=Q,j[K++]=ne,j[K++]=H}if(k.splitNull){A.count-1 in V||(V[A.count]=A.count-1);var N=Object.keys(V).map(Number).sort(function(vt,Nt){return vt-Nt}),U=[],te=0,B=A.hole!=null?A.hole[0]:null;if(B!=null){var X=l(N,function(vt){return vt>=B});(N=N.slice(0,X)).push(B)}for(var J=function(vt){var Nt=j.slice(2*te,2*N[vt]).concat(B?j.slice(2*B):[]),qt=(A.hole||[]).map(function(Wt){return Wt-B+(N[vt]-te)}),Jt=n(Nt,qt);Jt=Jt.map(function(Wt){return Wt+te+(Wt+te<N[vt]?0:B-N[vt])}),U.push.apply(U,Jt),te=N[vt]+1},ee=0;ee<N.length;ee++)J(ee);for(var re=0,se=U.length;re<se;re++)V[U[re]]!=null&&(U[re]=V[U[re]]);A.triangles=U}else{for(var oe=n(j,A.hole||[]),de=0,ce=oe.length;de<ce;de++)V[oe[de]]!=null&&(oe[de]=V[oe[de]]);A.triangles=oe}}var ve=new Float64Array(I);a(ve,2,D);var Ae=new Float64Array(2*P+6);A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Ae[0]=ve[2*P-4],Ae[1]=ve[2*P-3]):(Ae[0]=ve[2*P-2],Ae[1]=ve[2*P-1]):(Ae[0]=ve[0],Ae[1]=ve[1]),Ae.set(ve,2),A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Ae[2*P+2]=ve[2],Ae[2*P+3]=ve[3],A.count-=1):(Ae[2*P+2]=ve[0],Ae[2*P+3]=ve[1],Ae[2*P+4]=ve[2],Ae[2*P+5]=ve[3]):(Ae[2*P+2]=ve[2*P-2],Ae[2*P+3]=ve[2*P-1],Ae[2*P+4]=ve[2*P-2],Ae[2*P+5]=ve[2*P-1]);var fe=g(Ae);A.positionBuffer(fe);var me=u(Ae,fe);A.positionFractBuffer(me)}if(k.range?A.range=k.range:A.range||(A.range=A.bounds),(k.range||k.positions)&&A.count){var _e=A.bounds,le=_e[2]-_e[0],ge=_e[3]-_e[1],Te=A.range[2]-A.range[0],Se=A.range[3]-A.range[1];A.scale=[le/Te,ge/Se],A.translate=[-A.range[0]/Te+_e[0]/Te||0,-A.range[1]/Se+_e[1]/Se||0],A.scaleFract=u(A.scale),A.translateFract=u(A.translate)}if(k.dashes){var Me,ze=0;if(!k.dashes||k.dashes.length<2)ze=1,Me=new Uint8Array([255,255,255,255,255,255,255,255]);else{ze=0;for(var Oe=0;Oe<k.dashes.length;++Oe)ze+=k.dashes[Oe];Me=new Uint8Array(ze*o.dashMult);for(var De=0,Xe=255,Be=0;Be<2;Be++)for(var Ie=0;Ie<k.dashes.length;++Ie){for(var Re=0,Ye=k.dashes[Ie]*o.dashMult*.5;Re<Ye;++Re)Me[De++]=Xe;Xe^=255}}A.dashLength=ze,A.dashTexture({channels:1,data:Me,width:Me.length,height:1,mag:"linear",min:"linear"},0,0)}if(k.color){var Qe=A.count,lt=k.color;lt||(lt="transparent");var xt=new Uint8Array(4*Qe+4);if(Array.isArray(lt)&&typeof lt[0]!="number"){for(var wt=0;wt<Qe;wt++){var bt=d(lt[wt],"uint8");xt.set(bt,4*wt)}xt.set(d(lt[0],"uint8"),4*Qe)}else for(var nt=d(lt,"uint8"),$e=0;$e<Qe+1;$e++)xt.set(nt,4*$e);A.colorBuffer({usage:"dynamic",type:"uint8",data:xt})}}else c.passes[L]=null}),p.length<this.passes.length){for(var f=p.length;f<this.passes.length;f++){var _=this.passes[f];_&&(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=p.length}for(var b=[],T=0;T<this.passes.length;T++)this.passes[T]!==null&&b.push(this.passes[T]);return this.passes=b,this}},o.prototype.destroy=function(){return this.passes.forEach(function(p){p.colorBuffer.destroy(),p.positionBuffer.destroy(),p.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(m,G,W){function d(f,_){return function(b){if(Array.isArray(b))return b}(f)||function(b,T){var k=b==null?null:typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(k!=null){var L,A,I=[],P=!0,S=!1;try{for(k=k.call(b);!(P=(L=k.next()).done)&&(I.push(L.value),!T||I.length!==T);P=!0);}catch(E){S=!0,A=E}finally{try{P||k.return==null||k.return()}finally{if(S)throw A}}return I}}(f,_)||w(f,_)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function v(f){return function(_){if(Array.isArray(_))return y(_)}(f)||function(_){if(typeof Symbol<"u"&&_[Symbol.iterator]!=null||_["@@iterator"]!=null)return Array.from(_)}(f)||w(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function w(f,_){if(f){if(typeof f=="string")return y(f,_);var b=Object.prototype.toString.call(f).slice(8,-1);return b==="Object"&&f.constructor&&(b=f.constructor.name),b==="Map"||b==="Set"?Array.from(f):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?y(f,_):void 0}}function y(f,_){(_==null||_>f.length)&&(_=f.length);for(var b=0,T=new Array(_);b<_;b++)T[b]=f[b];return T}var e=m("color-normalize"),t=m("array-bounds"),n=m("color-id"),a=m("@plotly/point-cluster"),r=m("object-assign"),g=m("glslify"),u=m("pick-by-alias"),s=m("update-diff"),h=m("flatten-vertex-data"),l=m("is-iexplorer"),o=m("to-float32"),p=m("parse-rect"),c=i;function i(f,_){var b=this;if(!(this instanceof i))return new i(f,_);typeof f=="function"?(_||(_={}),_.regl=f):(_=f,f=null),_&&_.length&&(_.positions=_);var T,k=(f=_.regl)._gl,L=[];this.tooManyColors=l,T=f.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),r(this,{regl:f,gl:k,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:T,maxColors:255,maxSize:100,canvas:k.canvas}),this.update(_);var A={uniforms:{constPointSize:!!_.constPointSize,opacity:f.prop("opacity"),paletteSize:function(S,E){return[b.tooManyColors?0:255,T.height]},pixelRatio:f.context("pixelRatio"),scale:f.prop("scale"),scaleFract:f.prop("scaleFract"),translate:f.prop("translate"),translateFract:f.prop("translateFract"),markerTexture:f.prop("markerTexture"),paletteTexture:T},attributes:{x:function(S,E){return E.xAttr||{buffer:E.positionBuffer,stride:8,offset:0}},y:function(S,E){return E.yAttr||{buffer:E.positionBuffer,stride:8,offset:4}},xFract:function(S,E){return E.xAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:0}},yFract:function(S,E){return E.yAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:4}},size:function(S,E){return E.size.length?{buffer:E.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*E.size/b.maxSize)]}},borderSize:function(S,E){return E.borderSize.length?{buffer:E.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*E.borderSize/b.maxSize)]}},colorId:function(S,E){return E.color.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:0}:{constant:b.tooManyColors?L.slice(4*E.color,4*E.color+4):[E.color]}},borderColorId:function(S,E){return E.borderColor.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:b.tooManyColors?4:2}:{constant:b.tooManyColors?L.slice(4*E.borderColor,4*E.borderColor+4):[E.borderColor]}},isActive:function(S,E){return E.activation===!0?{constant:[1]}:E.activation?E.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:f.prop("viewport")},viewport:f.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:f.prop("elements"),count:f.prop("count"),offset:f.prop("offset"),primitive:"points"},I=r({},A);I.frag=g([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),I.vert=g([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=f(I);var P=r({},A);P.frag=g([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),P.vert=g([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),l&&(P.frag=P.frag.replace("smoothstep","smoothStep"),I.frag=I.frag.replace("smoothstep","smoothStep")),this.drawCircle=f(P)}i.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},i.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},i.prototype.draw=function(){for(var f=this,_=arguments.length,b=new Array(_),T=0;T<_;T++)b[T]=arguments[T];var k=this.groups;if(b.length===1&&Array.isArray(b[0])&&(b[0][0]===null||Array.isArray(b[0][0]))&&(b=b[0]),this.regl._refresh(),b.length)for(var L=0;L<b.length;L++)this.drawItem(L,b[L]);else k.forEach(function(A,I){f.drawItem(I)});return this},i.prototype.drawItem=function(f,_){var b=this.groups,T=b[f];if(typeof _=="number"&&(f=_,T=b[_],_=null),T&&T.count&&T.opacity){T.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,T,_));for(var k=[],L=1;L<T.activation.length;L++)T.activation[L]&&(T.activation[L]===!0||T.activation[L].data.length)&&k.push.apply(k,v(this.getMarkerDrawOptions(L,T,_)));k.length&&this.drawMarker(k)}},i.prototype.getMarkerDrawOptions=function(f,_,b){var T=_.range,k=_.tree,L=_.viewport,A=_.activation,I=_.selectionBuffer,P=_.count;if(this.regl,!k)return b?[r({},_,{markerTexture:this.markerTextures[f],activation:A[f],count:b.length,elements:b,offset:0})]:[r({},_,{markerTexture:this.markerTextures[f],activation:A[f],offset:0})];var S=[],E=k.range(T,{lod:!0,px:[(T[2]-T[0])/L.width,(T[3]-T[1])/L.height]});if(b){for(var z=A[f].data,D=new Uint8Array(P),j=0;j<b.length;j++){var V=b[j];D[V]=z?z[V]:1}I.subdata(D)}for(var Z=E.length;Z--;){var Q=d(E[Z],2),K=Q[0],$=Q[1];S.push(r({},_,{markerTexture:this.markerTextures[f],activation:b?I:A[f],offset:K,count:$-K}))}return S},i.prototype.update=function(){for(var f=this,_=arguments.length,b=new Array(_),T=0;T<_;T++)b[T]=arguments[T];if(b.length){b.length===1&&Array.isArray(b[0])&&(b=b[0]);var k=this.groups,L=this.gl,A=this.regl,I=this.maxSize,P=this.maxColors,S=this.palette;this.groups=k=b.map(function(E,z){var D=k[z];if(E===void 0)return D;E===null?E={positions:null}:typeof E=="function"?E={ondraw:E}:typeof E[0]=="number"&&(E={positions:E}),(E=u(E,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(E.positions=[]),E.tooManyColors!=null&&(f.tooManyColors=E.tooManyColors),D||(k[z]=D={id:z,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:A.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},E=r({},i.defaults,E)),E.positions&&!("marker"in E)&&(E.marker=D.marker,delete D.marker),E.marker&&!("positions"in E)&&(E.positions=D.positions,delete D.positions);var j=0,V=0;if(s(D,E,[{snap:!0,size:function(ce,ve){return ce==null&&(ce=i.defaults.size),j+=ce&&ce.length?1:0,ce},borderSize:function(ce,ve){return ce==null&&(ce=i.defaults.borderSize),j+=ce&&ce.length?1:0,ce},opacity:parseFloat,color:function(ce,ve){return ce==null&&(ce=i.defaults.color),ce=f.updateColor(ce),V++,ce},borderColor:function(ce,ve){return ce==null&&(ce=i.defaults.borderColor),ce=f.updateColor(ce),V++,ce},bounds:function(ce,ve,Ae){return"range"in Ae||(Ae.range=null),ce},positions:function(ce,ve,Ae){var fe=ve.snap,me=ve.positionBuffer,_e=ve.positionFractBuffer,le=ve.selectionBuffer;if(ce.x||ce.y)return ce.x.length?ve.xAttr={buffer:A.buffer(ce.x),offset:0,stride:4,count:ce.x.length}:ve.xAttr={buffer:ce.x.buffer,offset:4*ce.x.offset||0,stride:4*(ce.x.stride||1),count:ce.x.count},ce.y.length?ve.yAttr={buffer:A.buffer(ce.y),offset:0,stride:4,count:ce.y.length}:ve.yAttr={buffer:ce.y.buffer,offset:4*ce.y.offset||0,stride:4*(ce.y.stride||1),count:ce.y.count},ve.count=Math.max(ve.xAttr.count,ve.yAttr.count),ce;ce=h(ce,"float64");var ge=ve.count=Math.floor(ce.length/2),Te=ve.bounds=ge?t(ce,2):null;if(Ae.range||ve.range||(delete ve.range,Ae.range=Te),Ae.marker||ve.marker||(delete ve.marker,Ae.marker=null),fe&&(fe===!0||ge>fe)?ve.tree=a(ce,{bounds:Te}):fe&&fe.length&&(ve.tree=fe),ve.tree){var Se={primitive:"points",usage:"static",data:ve.tree,type:"uint32"};ve.elements?ve.elements(Se):ve.elements=A.elements(Se)}var Me=o.float32(ce);return me({data:Me,usage:"dynamic"}),_e({data:o.fract32(ce,Me),usage:"dynamic"}),le({data:new Uint8Array(ge),type:"uint8",usage:"stream"}),ce}},{marker:function(ce,ve,Ae){var fe=ve.activation;if(fe.forEach(function(Me){return Me&&Me.destroy&&Me.destroy()}),fe.length=0,ce&&typeof ce[0]!="number"){for(var me=[],_e=0,le=Math.min(ce.length,ve.count);_e<le;_e++){var ge=f.addMarker(ce[_e]);me[ge]||(me[ge]=new Uint8Array(ve.count)),me[ge][_e]=1}for(var Te=0;Te<me.length;Te++)if(me[Te]){var Se={data:me[Te],type:"uint8",usage:"static"};fe[Te]?fe[Te](Se):fe[Te]=A.buffer(Se),fe[Te].data=me[Te]}}else fe[f.addMarker(ce)]=!0;return ce},range:function(ce,ve,Ae){var fe=ve.bounds;if(fe)return ce||(ce=fe),ve.scale=[1/(ce[2]-ce[0]),1/(ce[3]-ce[1])],ve.translate=[-ce[0],-ce[1]],ve.scaleFract=o.fract(ve.scale),ve.translateFract=o.fract(ve.translate),ce},viewport:function(ce){return p(ce||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),j){var Z=D,Q=Z.count,K=Z.size,$=Z.borderSize,ne=Z.sizeBuffer,H=new Uint8Array(2*Q);if(K.length||$.length)for(var N=0;N<Q;N++)H[2*N]=Math.round(255*(K[N]==null?K:K[N])/I),H[2*N+1]=Math.round(255*($[N]==null?$:$[N])/I);ne({data:H,usage:"dynamic"})}if(V){var U,te=D,B=te.count,X=te.color,J=te.borderColor,ee=te.colorBuffer;if(f.tooManyColors){if(X.length||J.length){U=new Uint8Array(8*B);for(var re=0;re<B;re++){var se=X[re];U[8*re]=S[4*se],U[8*re+1]=S[4*se+1],U[8*re+2]=S[4*se+2],U[8*re+3]=S[4*se+3];var oe=J[re];U[8*re+4]=S[4*oe],U[8*re+5]=S[4*oe+1],U[8*re+6]=S[4*oe+2],U[8*re+7]=S[4*oe+3]}}}else if(X.length||J.length){U=new Uint8Array(4*B+2);for(var de=0;de<B;de++)X[de]!=null&&(U[4*de]=X[de]%P,U[4*de+1]=Math.floor(X[de]/P)),J[de]!=null&&(U[4*de+2]=J[de]%P,U[4*de+3]=Math.floor(J[de]/P))}ee({data:U||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return D})}},i.prototype.addMarker=function(f){var _,b=this.markerTextures,T=this.regl,k=this.markerCache,L=f==null?0:k.indexOf(f);if(L>=0)return L;if(f instanceof Uint8Array||f instanceof Uint8ClampedArray)_=f;else{_=new Uint8Array(f.length);for(var A=0,I=f.length;A<I;A++)_[A]=255*f[A]}var P=Math.floor(Math.sqrt(_.length));return L=b.length,k.push(f),b.push(T.texture({channels:1,data:_,radius:P,mag:"linear",min:"linear"})),L},i.prototype.updateColor=function(f){var _=this.paletteIds,b=this.palette,T=this.maxColors;Array.isArray(f)||(f=[f]);var k=[];if(typeof f[0]=="number"){var L=[];if(Array.isArray(f))for(var A=0;A<f.length;A+=4)L.push(f.slice(A,A+4));else for(var I=0;I<f.length;I+=4)L.push(f.subarray(I,I+4));f=L}for(var P=0;P<f.length;P++){var S=f[P];S=e(S,"uint8");var E=n(S,!1);if(_[E]==null){var z=b.length;_[E]=Math.floor(z/4),b[z]=S[0],b[z+1]=S[1],b[z+2]=S[2],b[z+3]=S[3]}k[P]=_[E]}return!this.tooManyColors&&b.length>4*T&&(this.tooManyColors=!0),this.updatePalette(b),k.length===1?k[0]:k},i.prototype.updatePalette=function(f){if(!this.tooManyColors){var _=this.maxColors,b=this.paletteTexture,T=Math.ceil(.25*f.length/_);if(T>1)for(var k=.25*(f=f.slice()).length%_;k<T*_;k++)f.push(0,0,0,0);b.height<T&&b.resize(_,T),b.subimage({width:Math.min(.25*f.length,_),height:T,data:f},0,0)}},i.prototype.destroy=function(){return this.groups.forEach(function(f){f.sizeBuffer.destroy(),f.positionBuffer.destroy(),f.positionFractBuffer.destroy(),f.colorBuffer.destroy(),f.activation.forEach(function(_){return _&&_.destroy&&_.destroy()}),f.selectionBuffer.destroy(),f.elements&&f.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(f){return f&&f.destroy&&f.destroy()}),this};var x=m("object-assign");G.exports=function(f,_){var b=new c(f,_),T=b.render.bind(b);return x(T,{render:T,update:b.update.bind(b),draw:b.draw.bind(b),destroy:b.destroy.bind(b),regl:b.regl,gl:b.gl,canvas:b.gl.canvas,groups:b.groups,markers:b.markerCache,palette:b.palette}),T}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(m,G,W){var d=m("regl-scatter2d"),v=m("pick-by-alias"),w=m("array-bounds"),y=m("raf"),e=m("array-range"),t=m("parse-rect"),n=m("flatten-vertex-data");function a(s,h){if(!(this instanceof a))return new a(s);this.traces=[],this.passes={},this.regl=s,this.scatter=d(s),this.canvas=this.scatter.canvas}function r(s,h,l){return(s.id!=null?s.id:s)<<16|(255&h)<<8|255&l}function g(s,h,l){var o,p,c,i,x=s[h],f=s[l];return x.length>2?(x[0],x[2],o=x[1],p=x[3]):x.length?(o=x[0],p=x[1]):(x.x,o=x.y,x.x+x.width,p=x.y+x.height),f.length>2?(c=f[0],i=f[2],f[1],f[3]):f.length?(c=f[0],i=f[1]):(c=f.x,f.y,i=f.x+f.width,f.y+f.height),[c,o,i,p]}function u(s){if(typeof s=="number")return[s,s,s,s];if(s.length===2)return[s[0],s[1],s[0],s[1]];var h=t(s);return[h.x,h.y,h.x+h.width,h.y+h.height]}G.exports=a,a.prototype.render=function(){for(var s,h=this,l=[],o=arguments.length;o--;)l[o]=arguments[o];return l.length&&(s=this).update.apply(s,l),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=y(function(){h.draw(),h.dirty=!0,h.planned=null})):(this.draw(),this.dirty=!0,y(function(){h.dirty=!1})),this)},a.prototype.update=function(){for(var s,h=[],l=arguments.length;l--;)h[l]=arguments[l];if(h.length){for(var o=0;o<h.length;o++)this.updateItem(o,h[o]);this.traces=this.traces.filter(Boolean);for(var p=[],c=0,i=0;i<this.traces.length;i++){for(var x=this.traces[i],f=this.traces[i].passes,_=0;_<f.length;_++)p.push(this.passes[f[_]]);x.passOffset=c,c+=x.passes.length}return(s=this.scatter).update.apply(s,p),this}},a.prototype.updateItem=function(s,h){var l=this.regl;if(h===null)return this.traces[s]=null,this;if(!h)return this;var o,p=v(h,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),c=this.traces[s]||(this.traces[s]={id:s,buffer:l.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:t([l._gl.drawingBufferWidth,l._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(p.color!=null&&(c.color=p.color),p.size!=null&&(c.size=p.size),p.marker!=null&&(c.marker=p.marker),p.borderColor!=null&&(c.borderColor=p.borderColor),p.borderSize!=null&&(c.borderSize=p.borderSize),p.opacity!=null&&(c.opacity=p.opacity),p.viewport&&(c.viewport=t(p.viewport)),p.diagonal!=null&&(c.diagonal=p.diagonal),p.upper!=null&&(c.upper=p.upper),p.lower!=null&&(c.lower=p.lower),p.data){c.buffer(n(p.data)),c.columns=p.data.length,c.count=p.data[0].length,c.bounds=[];for(var i=0;i<c.columns;i++)c.bounds[i]=w(p.data[i],1)}p.range&&(c.range=p.range,o=c.range&&typeof c.range[0]!="number"),p.domain&&(c.domain=p.domain);var x=!1;p.padding!=null&&(Array.isArray(p.padding)&&p.padding.length===c.columns&&typeof p.padding[p.padding.length-1]=="number"?(c.padding=p.padding.map(u),x=!0):c.padding=u(p.padding));var f=c.columns,_=c.count,b=c.viewport.width,T=c.viewport.height,k=c.viewport.x,L=c.viewport.y,A=b/f,I=T/f;c.passes=[];for(var P=0;P<f;P++)for(var S=0;S<f;S++)if((c.diagonal||S!==P)&&(c.upper||!(P>S))&&(c.lower||!(P<S))){var E=r(c.id,P,S),z=this.passes[E]||(this.passes[E]={});if(p.data&&(p.transpose?z.positions={x:{buffer:c.buffer,offset:S,count:_,stride:f},y:{buffer:c.buffer,offset:P,count:_,stride:f}}:z.positions={x:{buffer:c.buffer,offset:S*_,count:_},y:{buffer:c.buffer,offset:P*_,count:_}},z.bounds=g(c.bounds,P,S)),p.domain||p.viewport||p.data){var D=x?g(c.padding,P,S):c.padding;if(c.domain){var j=g(c.domain,P,S),V=j[0],Z=j[1],Q=j[2],K=j[3];z.viewport=[k+V*b+D[0],L+Z*T+D[1],k+Q*b-D[2],L+K*T-D[3]]}else z.viewport=[k+S*A+A*D[0],L+P*I+I*D[1],k+(S+1)*A-A*D[2],L+(P+1)*I-I*D[3]]}p.color&&(z.color=c.color),p.size&&(z.size=c.size),p.marker&&(z.marker=c.marker),p.borderSize&&(z.borderSize=c.borderSize),p.borderColor&&(z.borderColor=c.borderColor),p.opacity&&(z.opacity=c.opacity),p.range&&(z.range=o?g(c.range,P,S):c.range||z.bounds),c.passes.push(E)}return this},a.prototype.draw=function(){for(var s,h=[],l=arguments.length;l--;)h[l]=arguments[l];if(h.length){for(var o=[],p=0;p<h.length;p++)if(typeof h[p]=="number"){var c=this.traces[h[p]],i=c.passes,x=c.passOffset;o.push.apply(o,e(x,x+i.length))}else if(h[p].length){var f=h[p],_=this.traces[p],b=_.passes,T=_.passOffset;b=b.map(function(k,L){o[T+L]=f})}(s=this.scatter).draw.apply(s,o)}else this.scatter.draw();return this},a.prototype.destroy=function(){return this.traces.forEach(function(s){s.buffer&&s.buffer.destroy&&s.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(m,G,W){(function(d,v){typeof W=="object"&&G!==void 0?G.exports=v():d.createREGL=v()})(this,function(){function d(pe,be){this.id=X++,this.type=pe,this.data=be}function v(pe){return"["+function be(Fe){if(Fe.length===0)return[];var Ve=Fe.charAt(0),Ke=Fe.charAt(Fe.length-1);if(1<Fe.length&&Ve===Ke&&(Ve==='"'||Ve==="'"))return['"'+Fe.substr(1,Fe.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ve=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Fe))return be(Fe.substr(0,Ve.index)).concat(be(Ve[1])).concat(be(Fe.substr(Ve.index+Ve[0].length)));if((Ve=Fe.split(".")).length===1)return['"'+Fe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Fe=[],Ke=0;Ke<Ve.length;++Ke)Fe=Fe.concat(be(Ve[Ke]));return Fe}(pe).join("][")+"]"}function w(pe){return typeof pe=="string"?pe.split():pe}function y(pe){return typeof pe=="string"?document.querySelector(pe):pe}function e(pe){var be,Fe,Ve,Ke,Ge=pe||{};pe={};var ct=[],st=[],Mt=typeof window>"u"?1:window.devicePixelRatio,Ot=!1,it={},ht=function(kt){},jt=function(){};if(typeof Ge=="string"?be=document.querySelector(Ge):typeof Ge=="object"&&(typeof Ge.nodeName=="string"&&typeof Ge.appendChild=="function"&&typeof Ge.getBoundingClientRect=="function"?be=Ge:typeof Ge.drawArrays=="function"||typeof Ge.drawElements=="function"?Ve=(Ke=Ge).canvas:("gl"in Ge?Ke=Ge.gl:"canvas"in Ge?Ve=y(Ge.canvas):"container"in Ge&&(Fe=y(Ge.container)),"attributes"in Ge&&(pe=Ge.attributes),"extensions"in Ge&&(ct=w(Ge.extensions)),"optionalExtensions"in Ge&&(st=w(Ge.optionalExtensions)),"onDone"in Ge&&(ht=Ge.onDone),"profile"in Ge&&(Ot=!!Ge.profile),"pixelRatio"in Ge&&(Mt=+Ge.pixelRatio),"cachedCode"in Ge&&(it=Ge.cachedCode))),be&&(be.nodeName.toLowerCase()==="canvas"?Ve=be:Fe=be),!Ke){if(!Ve){if(!(be=function(kt,Pt,Ee){function Ze(){var St=window.innerWidth,Ut=window.innerHeight;kt!==document.body&&(St=(Ut=pt.getBoundingClientRect()).right-Ut.left,Ut=Ut.bottom-Ut.top),pt.width=Ee*St,pt.height=Ee*Ut}var at,pt=document.createElement("canvas");return B(pt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),kt.appendChild(pt),kt===document.body&&(pt.style.position="absolute",B(kt.style,{margin:0,padding:0})),kt!==document.body&&typeof ResizeObserver=="function"?(at=new ResizeObserver(function(){setTimeout(Ze)})).observe(kt):window.addEventListener("resize",Ze,!1),Ze(),{canvas:pt,onDestroy:function(){at?at.disconnect():window.removeEventListener("resize",Ze),kt.removeChild(pt)}}}(Fe||document.body,0,Mt)))return null;Ve=be.canvas,jt=be.onDestroy}pe.premultipliedAlpha===void 0&&(pe.premultipliedAlpha=!0),Ke=function(kt,Pt){function Ee(Ze){try{return kt.getContext(Ze,Pt)}catch{return null}}return Ee("webgl")||Ee("experimental-webgl")||Ee("webgl-experimental")}(Ve,pe)}return Ke?{gl:Ke,canvas:Ve,container:Fe,extensions:ct,optionalExtensions:st,pixelRatio:Mt,profile:Ot,cachedCode:it,onDone:ht,onDestroy:jt}:(jt(),ht("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function t(pe,be){for(var Fe=Array(pe),Ve=0;Ve<pe;++Ve)Fe[Ve]=be(Ve);return Fe}function n(pe){var be,Fe;return be=(65535<pe)<<4,be|=Fe=(255<(pe>>>=be))<<3,(be|=Fe=(15<(pe>>>=Fe))<<2)|(Fe=(3<(pe>>>=Fe))<<1)|pe>>>Fe>>1}function a(){function pe(Ve){e:{for(var Ke=16;268435456>=Ke;Ke*=16)if(Ve<=Ke){Ve=Ke;break e}Ve=0}return 0<(Ke=Fe[n(Ve)>>2]).length?Ke.pop():new ArrayBuffer(Ve)}function be(Ve){Fe[n(Ve.byteLength)>>2].push(Ve)}var Fe=t(8,function(){return[]});return{alloc:pe,free:be,allocType:function(Ve,Ke){var Ge=null;switch(Ve){case 5120:Ge=new Int8Array(pe(Ke),0,Ke);break;case 5121:Ge=new Uint8Array(pe(Ke),0,Ke);break;case 5122:Ge=new Int16Array(pe(2*Ke),0,Ke);break;case 5123:Ge=new Uint16Array(pe(2*Ke),0,Ke);break;case 5124:Ge=new Int32Array(pe(4*Ke),0,Ke);break;case 5125:Ge=new Uint32Array(pe(4*Ke),0,Ke);break;case 5126:Ge=new Float32Array(pe(4*Ke),0,Ke);break;default:return null}return Ge.length!==Ke?Ge.subarray(0,Ke):Ge},freeType:function(Ve){be(Ve.buffer)}}}function r(pe){return!!pe&&typeof pe=="object"&&Array.isArray(pe.shape)&&Array.isArray(pe.stride)&&typeof pe.offset=="number"&&pe.shape.length===pe.stride.length&&(Array.isArray(pe.data)||de(pe.data))}function g(pe,be,Fe,Ve,Ke,Ge){for(var ct=0;ct<be;++ct)for(var st=pe[ct],Mt=0;Mt<Fe;++Mt)for(var Ot=st[Mt],it=0;it<Ve;++it)Ke[Ge++]=Ot[it]}function u(pe){return 0|Ae[Object.prototype.toString.call(pe)]}function s(pe,be){for(var Fe=0;Fe<be.length;++Fe)pe[Fe]=be[Fe]}function h(pe,be,Fe,Ve,Ke,Ge,ct){for(var st=0,Mt=0;Mt<Fe;++Mt)for(var Ot=0;Ot<Ve;++Ot)pe[st++]=be[Ke*Mt+Ge*Ot+ct]}function l(pe,be,Fe,Ve){function Ke(ht){this.id=Mt++,this.buffer=pe.createBuffer(),this.type=ht,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Fe.profile&&(this.stats={size:0})}function Ge(ht,jt,kt){ht.byteLength=jt.byteLength,pe.bufferData(ht.type,jt,kt)}function ct(ht,jt,kt,Pt,Ee,Ze){if(ht.usage=kt,Array.isArray(jt)){if(ht.dtype=Pt||5126,0<jt.length)if(Array.isArray(jt[0])){Ee=le(jt);for(var at=Pt=1;at<Ee.length;++at)Pt*=Ee[at];ht.dimension=Pt,Ge(ht,jt=_e(jt,Ee,ht.dtype),kt),Ze?ht.persistentData=jt:se.freeType(jt)}else typeof jt[0]=="number"?(ht.dimension=Ee,s(Ee=se.allocType(ht.dtype,jt.length),jt),Ge(ht,Ee,kt),Ze?ht.persistentData=Ee:se.freeType(Ee)):de(jt[0])&&(ht.dimension=jt[0].length,ht.dtype=Pt||u(jt[0])||5126,Ge(ht,jt=_e(jt,[jt.length,jt[0].length],ht.dtype),kt),Ze?ht.persistentData=jt:se.freeType(jt))}else if(de(jt))ht.dtype=Pt||u(jt),ht.dimension=Ee,Ge(ht,jt,kt),Ze&&(ht.persistentData=new Uint8Array(new Uint8Array(jt.buffer)));else if(r(jt)){Ee=jt.shape;var pt=jt.stride,St=(at=jt.offset,0),Ut=0,Kt=0,Ht=0;Ee.length===1?(St=Ee[0],Ut=1,Kt=pt[0],Ht=0):Ee.length===2&&(St=Ee[0],Ut=Ee[1],Kt=pt[0],Ht=pt[1]),ht.dtype=Pt||u(jt.data)||5126,ht.dimension=Ut,h(Ee=se.allocType(ht.dtype,St*Ut),jt.data,St,Ut,Kt,Ht,at),Ge(ht,Ee,kt),Ze?ht.persistentData=Ee:se.freeType(Ee)}else jt instanceof ArrayBuffer&&(ht.dtype=5121,ht.dimension=Ee,Ge(ht,jt,kt),Ze&&(ht.persistentData=new Uint8Array(new Uint8Array(jt))))}function st(ht){be.bufferCount--,Ve(ht),pe.deleteBuffer(ht.buffer),ht.buffer=null,delete Ot[ht.id]}var Mt=0,Ot={};Ke.prototype.bind=function(){pe.bindBuffer(this.type,this.buffer)},Ke.prototype.destroy=function(){st(this)};var it=[];return Fe.profile&&(be.getTotalBufferSize=function(){var ht=0;return Object.keys(Ot).forEach(function(jt){ht+=Ot[jt].stats.size}),ht}),{create:function(ht,jt,kt,Pt){function Ee(at){var pt=35044,St=null,Ut=0,Kt=0,Ht=1;return Array.isArray(at)||de(at)||r(at)||at instanceof ArrayBuffer?St=at:typeof at=="number"?Ut=0|at:at&&("data"in at&&(St=at.data),"usage"in at&&(pt=me[at.usage]),"type"in at&&(Kt=fe[at.type]),"dimension"in at&&(Ht=0|at.dimension),"length"in at&&(Ut=0|at.length)),Ze.bind(),St?ct(Ze,St,pt,Kt,Ht,Pt):(Ut&&pe.bufferData(Ze.type,Ut,pt),Ze.dtype=Kt||5121,Ze.usage=pt,Ze.dimension=Ht,Ze.byteLength=Ut),Fe.profile&&(Ze.stats.size=Ze.byteLength*ge[Ze.dtype]),Ee}be.bufferCount++;var Ze=new Ke(jt);return Ot[Ze.id]=Ze,kt||Ee(ht),Ee._reglType="buffer",Ee._buffer=Ze,Ee.subdata=function(at,pt){var St,Ut=0|(pt||0);if(Ze.bind(),de(at)||at instanceof ArrayBuffer)pe.bufferSubData(Ze.type,Ut,at);else if(Array.isArray(at)){if(0<at.length)if(typeof at[0]=="number"){var Kt=se.allocType(Ze.dtype,at.length);s(Kt,at),pe.bufferSubData(Ze.type,Ut,Kt),se.freeType(Kt)}else(Array.isArray(at[0])||de(at[0]))&&(St=le(at),Kt=_e(at,St,Ze.dtype),pe.bufferSubData(Ze.type,Ut,Kt),se.freeType(Kt))}else if(r(at)){St=at.shape;var Ht=at.stride,pr=Kt=0,Mr=0,hr=0;St.length===1?(Kt=St[0],pr=1,Mr=Ht[0],hr=0):St.length===2&&(Kt=St[0],pr=St[1],Mr=Ht[0],hr=Ht[1]),St=Array.isArray(at.data)?Ze.dtype:u(at.data),h(St=se.allocType(St,Kt*pr),at.data,Kt,pr,Mr,hr,at.offset),pe.bufferSubData(Ze.type,Ut,St),se.freeType(St)}return Ee},Fe.profile&&(Ee.stats=Ze.stats),Ee.destroy=function(){st(Ze)},Ee},createStream:function(ht,jt){var kt=it.pop();return kt||(kt=new Ke(ht)),kt.bind(),ct(kt,jt,35040,0,1,!1),kt},destroyStream:function(ht){it.push(ht)},clear:function(){ce(Ot).forEach(st),it.forEach(st)},getBuffer:function(ht){return ht&&ht._buffer instanceof Ke?ht._buffer:null},restore:function(){ce(Ot).forEach(function(ht){ht.buffer=pe.createBuffer(),pe.bindBuffer(ht.type,ht.buffer),pe.bufferData(ht.type,ht.persistentData||ht.byteLength,ht.usage)})},_initBuffer:ct}}function o(pe,be,Fe,Ve){function Ke(ht){this.id=Mt++,st[this.id]=this,this.buffer=ht,this.primType=4,this.type=this.vertCount=0}function Ge(ht,jt,kt,Pt,Ee,Ze,at){var pt;if(ht.buffer.bind(),jt?((pt=at)||de(jt)&&(!r(jt)||de(jt.data))||(pt=be.oes_element_index_uint?5125:5123),Fe._initBuffer(ht.buffer,jt,kt,pt,3)):(pe.bufferData(34963,Ze,kt),ht.buffer.dtype=pt||5121,ht.buffer.usage=kt,ht.buffer.dimension=3,ht.buffer.byteLength=Ze),pt=at,!at){switch(ht.buffer.dtype){case 5121:case 5120:pt=5121;break;case 5123:case 5122:pt=5123;break;case 5125:case 5124:pt=5125}ht.buffer.dtype=pt}ht.type=pt,0>(jt=Ee)&&(jt=ht.buffer.byteLength,pt===5123?jt>>=1:pt===5125&&(jt>>=2)),ht.vertCount=jt,jt=Pt,0>Pt&&(jt=4,(Pt=ht.buffer.dimension)===1&&(jt=0),Pt===2&&(jt=1),Pt===3&&(jt=4)),ht.primType=jt}function ct(ht){Ve.elementsCount--,delete st[ht.id],ht.buffer.destroy(),ht.buffer=null}var st={},Mt=0,Ot={uint8:5121,uint16:5123};be.oes_element_index_uint&&(Ot.uint32=5125),Ke.prototype.bind=function(){this.buffer.bind()};var it=[];return{create:function(ht,jt){function kt(Ze){if(Ze)if(typeof Ze=="number")Pt(Ze),Ee.primType=4,Ee.vertCount=0|Ze,Ee.type=5121;else{var at=null,pt=35044,St=-1,Ut=-1,Kt=0,Ht=0;Array.isArray(Ze)||de(Ze)||r(Ze)?at=Ze:("data"in Ze&&(at=Ze.data),"usage"in Ze&&(pt=me[Ze.usage]),"primitive"in Ze&&(St=Te[Ze.primitive]),"count"in Ze&&(Ut=0|Ze.count),"type"in Ze&&(Ht=Ot[Ze.type]),"length"in Ze?Kt=0|Ze.length:(Kt=Ut,Ht===5123||Ht===5122?Kt*=2:Ht!==5125&&Ht!==5124||(Kt*=4))),Ge(Ee,at,pt,St,Ut,Kt,Ht)}else Pt(),Ee.primType=4,Ee.vertCount=0,Ee.type=5121;return kt}var Pt=Fe.create(null,34963,!0),Ee=new Ke(Pt._buffer);return Ve.elementsCount++,kt(ht),kt._reglType="elements",kt._elements=Ee,kt.subdata=function(Ze,at){return Pt.subdata(Ze,at),kt},kt.destroy=function(){ct(Ee)},kt},createStream:function(ht){var jt=it.pop();return jt||(jt=new Ke(Fe.create(null,34963,!0,!1)._buffer)),Ge(jt,ht,35040,-1,-1,0,0),jt},destroyStream:function(ht){it.push(ht)},getElements:function(ht){return typeof ht=="function"&&ht._elements instanceof Ke?ht._elements:null},clear:function(){ce(st).forEach(ct)}}}function p(pe){for(var be=se.allocType(5123,pe.length),Fe=0;Fe<pe.length;++Fe)if(isNaN(pe[Fe]))be[Fe]=65535;else if(1/0===pe[Fe])be[Fe]=31744;else if(-1/0===pe[Fe])be[Fe]=64512;else{Se[0]=pe[Fe];var Ve=(Ge=Me[0])>>>31<<15,Ke=(Ge<<1>>>24)-127,Ge=Ge>>13&1023;be[Fe]=-24>Ke?Ve:-14>Ke?Ve+(Ge+1024>>-14-Ke):15<Ke?Ve+31744:Ve+(Ke+15<<10)+Ge}return be}function c(pe){return Array.isArray(pe)||de(pe)}function i(pe){return"[object "+pe+"]"}function x(pe){return Array.isArray(pe)&&(pe.length===0||typeof pe[0]=="number")}function f(pe){return!(!Array.isArray(pe)||pe.length===0||!c(pe[0]))}function _(pe){return Object.prototype.toString.call(pe)}function b(pe){if(!pe)return!1;var be=_(pe);return 0<=lt.indexOf(be)||x(pe)||f(pe)||r(pe)}function T(pe,be){pe.type===36193?(pe.data=p(be),se.freeType(be)):pe.data=be}function k(pe,be,Fe,Ve,Ke,Ge){if(pe=wt[pe]!==void 0?wt[pe]:De[pe]*xt[be],Ge&&(pe*=6),Ke){for(Ve=0;1<=Fe;)Ve+=pe*Fe*Fe,Fe/=2;return Ve}return pe*Fe*Ve}function L(pe,be,Fe,Ve,Ke,Ge,ct){function st(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Mt(nr,vr){nr.internalformat=vr.internalformat,nr.format=vr.format,nr.type=vr.type,nr.compressed=vr.compressed,nr.premultiplyAlpha=vr.premultiplyAlpha,nr.flipY=vr.flipY,nr.unpackAlignment=vr.unpackAlignment,nr.colorSpace=vr.colorSpace,nr.width=vr.width,nr.height=vr.height,nr.channels=vr.channels}function Ot(nr,vr){if(typeof vr=="object"&&vr){"premultiplyAlpha"in vr&&(nr.premultiplyAlpha=vr.premultiplyAlpha),"flipY"in vr&&(nr.flipY=vr.flipY),"alignment"in vr&&(nr.unpackAlignment=vr.alignment),"colorSpace"in vr&&(nr.colorSpace=Nr[vr.colorSpace]),"type"in vr&&(nr.type=Wr[vr.type]);var It=nr.width,lr=nr.height,dr=nr.channels,Br=!1;"shape"in vr?(It=vr.shape[0],lr=vr.shape[1],vr.shape.length===3&&(dr=vr.shape[2],Br=!0)):("radius"in vr&&(It=lr=vr.radius),"width"in vr&&(It=vr.width),"height"in vr&&(lr=vr.height),"channels"in vr&&(dr=vr.channels,Br=!0)),nr.width=0|It,nr.height=0|lr,nr.channels=0|dr,It=!1,"format"in vr&&(It=vr.format,lr=nr.internalformat=hn[It],nr.format=vn[lr],It in Wr&&!("type"in vr)&&(nr.type=Wr[It]),It in tn&&(nr.compressed=!0),It=!0),!Br&&It?nr.channels=De[nr.format]:Br&&!It&&nr.channels!==Oe[nr.format]&&(nr.format=nr.internalformat=Oe[nr.channels])}}function it(nr){pe.pixelStorei(37440,nr.flipY),pe.pixelStorei(37441,nr.premultiplyAlpha),pe.pixelStorei(37443,nr.colorSpace),pe.pixelStorei(3317,nr.unpackAlignment)}function ht(){st.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function jt(nr,vr){var It=null;if(b(vr)?It=vr:vr&&(Ot(nr,vr),"x"in vr&&(nr.xOffset=0|vr.x),"y"in vr&&(nr.yOffset=0|vr.y),b(vr.data)&&(It=vr.data)),vr.copy){var lr=Ke.viewportWidth,dr=Ke.viewportHeight;nr.width=nr.width||lr-nr.xOffset,nr.height=nr.height||dr-nr.yOffset,nr.needsCopy=!0}else if(It){if(de(It))nr.channels=nr.channels||4,nr.data=It,"type"in vr||nr.type!==5121||(nr.type=0|Ae[Object.prototype.toString.call(It)]);else if(x(It)){switch(nr.channels=nr.channels||4,dr=(lr=It).length,nr.type){case 5121:case 5123:case 5125:case 5126:(dr=se.allocType(nr.type,dr)).set(lr),nr.data=dr;break;case 36193:nr.data=p(lr)}nr.alignment=1,nr.needsFree=!0}else if(r(It)){lr=It.data,Array.isArray(lr)||nr.type!==5121||(nr.type=0|Ae[Object.prototype.toString.call(lr)]),dr=It.shape;var Br,Fr,zr,Er,xr=It.stride;dr.length===3?(zr=dr[2],Er=xr[2]):Er=zr=1,Br=dr[0],Fr=dr[1],dr=xr[0],xr=xr[1],nr.alignment=1,nr.width=Br,nr.height=Fr,nr.channels=zr,nr.format=nr.internalformat=Oe[zr],nr.needsFree=!0,Br=Er,It=It.offset,zr=nr.width,Er=nr.height,Fr=nr.channels;for(var _r=se.allocType(nr.type===36193?5126:nr.type,zr*Er*Fr),kr=0,Cr=0;Cr<Er;++Cr)for(var Gr=0;Gr<zr;++Gr)for(var qr=0;qr<Fr;++qr)_r[kr++]=lr[dr*Gr+xr*Cr+Br*qr+It];T(nr,_r)}else if(_(It)===Xe||_(It)===Be||_(It)===Ie)_(It)===Xe||_(It)===Be?nr.element=It:nr.element=It.canvas,nr.width=nr.element.width,nr.height=nr.element.height,nr.channels=4;else if(_(It)===Re)nr.element=It,nr.width=It.width,nr.height=It.height,nr.channels=4;else if(_(It)===Ye)nr.element=It,nr.width=It.naturalWidth,nr.height=It.naturalHeight,nr.channels=4;else if(_(It)===Qe)nr.element=It,nr.width=It.videoWidth,nr.height=It.videoHeight,nr.channels=4;else if(f(It)){for(lr=nr.width||It[0].length,dr=nr.height||It.length,xr=nr.channels,xr=c(It[0][0])?xr||It[0][0].length:xr||1,Br=ve.shape(It),zr=1,Er=0;Er<Br.length;++Er)zr*=Br[Er];zr=se.allocType(nr.type===36193?5126:nr.type,zr),ve.flatten(It,Br,"",zr),T(nr,zr),nr.alignment=1,nr.width=lr,nr.height=dr,nr.channels=xr,nr.format=nr.internalformat=Oe[xr],nr.needsFree=!0}}else nr.width=nr.width||1,nr.height=nr.height||1,nr.channels=nr.channels||4}function kt(nr,vr,It,lr,dr){var Br=nr.element,Fr=nr.data,zr=nr.internalformat,Er=nr.format,xr=nr.type,_r=nr.width,kr=nr.height;it(nr),Br?pe.texSubImage2D(vr,dr,It,lr,Er,xr,Br):nr.compressed?pe.compressedTexSubImage2D(vr,dr,It,lr,zr,_r,kr,Fr):nr.needsCopy?(Ve(),pe.copyTexSubImage2D(vr,dr,It,lr,nr.xOffset,nr.yOffset,_r,kr)):pe.texSubImage2D(vr,dr,It,lr,_r,kr,Er,xr,Fr)}function Pt(){return en.pop()||new ht}function Ee(nr){nr.needsFree&&se.freeType(nr.data),ht.call(nr),en.push(nr)}function Ze(){st.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function at(nr,vr,It){var lr=nr.images[0]=Pt();nr.mipmask=1,lr.width=nr.width=vr,lr.height=nr.height=It,lr.channels=nr.channels=4}function pt(nr,vr){var It=null;if(b(vr))Mt(It=nr.images[0]=Pt(),nr),jt(It,vr),nr.mipmask=1;else if(Ot(nr,vr),Array.isArray(vr.mipmap))for(var lr=vr.mipmap,dr=0;dr<lr.length;++dr)Mt(It=nr.images[dr]=Pt(),nr),It.width>>=dr,It.height>>=dr,jt(It,lr[dr]),nr.mipmask|=1<<dr;else Mt(It=nr.images[0]=Pt(),nr),jt(It,vr),nr.mipmask=1;Mt(nr,nr.images[0])}function St(nr,vr){for(var It=nr.images,lr=0;lr<It.length&&It[lr];++lr){var dr=It[lr],Br=vr,Fr=lr,zr=dr.element,Er=dr.data,xr=dr.internalformat,_r=dr.format,kr=dr.type,Cr=dr.width,Gr=dr.height;it(dr),zr?pe.texImage2D(Br,Fr,_r,_r,kr,zr):dr.compressed?pe.compressedTexImage2D(Br,Fr,xr,Cr,Gr,0,Er):dr.needsCopy?(Ve(),pe.copyTexImage2D(Br,Fr,_r,dr.xOffset,dr.yOffset,Cr,Gr,0)):pe.texImage2D(Br,Fr,_r,Cr,Gr,0,_r,kr,Er||null)}}function Ut(){var nr=fn.pop()||new Ze;st.call(nr);for(var vr=nr.mipmask=0;16>vr;++vr)nr.images[vr]=null;return nr}function Kt(nr){for(var vr=nr.images,It=0;It<vr.length;++It)vr[It]&&Ee(vr[It]),vr[It]=null;fn.push(nr)}function Ht(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function pr(nr,vr){"min"in vr&&(nr.minFilter=Dr[vr.min],0<=ze.indexOf(nr.minFilter)&&!("faces"in vr)&&(nr.genMipmaps=!0)),"mag"in vr&&(nr.magFilter=Sr[vr.mag]);var It=nr.wrapS,lr=nr.wrapT;if("wrap"in vr){var dr=vr.wrap;typeof dr=="string"?It=lr=yr[dr]:Array.isArray(dr)&&(It=yr[dr[0]],lr=yr[dr[1]])}else"wrapS"in vr&&(It=yr[vr.wrapS]),"wrapT"in vr&&(lr=yr[vr.wrapT]);if(nr.wrapS=It,nr.wrapT=lr,"anisotropic"in vr&&(nr.anisotropic=vr.anisotropic),"mipmap"in vr){switch(It=!1,typeof vr.mipmap){case"string":nr.mipmapHint=fr[vr.mipmap],It=nr.genMipmaps=!0;break;case"boolean":It=nr.genMipmaps=vr.mipmap;break;case"object":nr.genMipmaps=!1,It=!0}!It||"min"in vr||(nr.minFilter=9984)}}function Mr(nr,vr){pe.texParameteri(vr,10241,nr.minFilter),pe.texParameteri(vr,10240,nr.magFilter),pe.texParameteri(vr,10242,nr.wrapS),pe.texParameteri(vr,10243,nr.wrapT),be.ext_texture_filter_anisotropic&&pe.texParameteri(vr,34046,nr.anisotropic),nr.genMipmaps&&(pe.hint(33170,nr.mipmapHint),pe.generateMipmap(vr))}function hr(nr){st.call(this),this.mipmask=0,this.internalformat=6408,this.id=Gn++,this.refCount=1,this.target=nr,this.texture=pe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ht,ct.profile&&(this.stats={size:0})}function Qt(nr){pe.activeTexture(33984),pe.bindTexture(nr.target,nr.texture)}function tr(){var nr=oi[0];nr?pe.bindTexture(nr.target,nr.texture):pe.bindTexture(3553,null)}function rr(nr){var vr=nr.texture,It=nr.unit,lr=nr.target;0<=It&&(pe.activeTexture(33984+It),pe.bindTexture(lr,null),oi[It]=null),pe.deleteTexture(vr),nr.texture=null,nr.params=null,nr.pixels=null,nr.refCount=0,delete Tn[nr.id],Ge.textureCount--}var fr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},yr={repeat:10497,clamp:33071,mirror:33648},Sr={nearest:9728,linear:9729},Dr=B({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Sr),Nr={none:0,browser:37444},Wr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},hn={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},tn={};be.ext_srgb&&(hn.srgb=35904,hn.srgba=35906),be.oes_texture_float&&(Wr.float32=Wr.float=5126),be.oes_texture_half_float&&(Wr.float16=Wr["half float"]=36193),be.webgl_depth_texture&&(B(hn,{depth:6402,"depth stencil":34041}),B(Wr,{uint16:5123,uint32:5125,"depth stencil":34042})),be.webgl_compressed_texture_s3tc&&B(tn,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),be.webgl_compressed_texture_atc&&B(tn,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),be.webgl_compressed_texture_pvrtc&&B(tn,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),be.webgl_compressed_texture_etc1&&(tn["rgb etc1"]=36196);var Fn=Array.prototype.slice.call(pe.getParameter(34467));Object.keys(tn).forEach(function(nr){var vr=tn[nr];0<=Fn.indexOf(vr)&&(hn[nr]=vr)});var an=Object.keys(hn);Fe.textureFormats=an;var xn=[];Object.keys(hn).forEach(function(nr){xn[hn[nr]]=nr});var _n=[];Object.keys(Wr).forEach(function(nr){_n[Wr[nr]]=nr});var ti=[];Object.keys(Sr).forEach(function(nr){ti[Sr[nr]]=nr});var jr=[];Object.keys(Dr).forEach(function(nr){jr[Dr[nr]]=nr});var nn=[];Object.keys(yr).forEach(function(nr){nn[yr[nr]]=nr});var vn=an.reduce(function(nr,vr){var It=hn[vr];return It===6409||It===6406||It===6409||It===6410||It===6402||It===34041||be.ext_srgb&&(It===35904||It===35906)?nr[It]=It:It===32855||0<=vr.indexOf("rgba")?nr[It]=6408:nr[It]=6407,nr},{}),en=[],fn=[],Gn=0,Tn={},Cn=Fe.maxTextureUnits,oi=Array(Cn).map(function(){return null});return B(hr.prototype,{bind:function(){this.bindCount+=1;var nr=this.unit;if(0>nr){for(var vr=0;vr<Cn;++vr){var It=oi[vr];if(It){if(0<It.bindCount)continue;It.unit=-1}oi[vr]=this,nr=vr;break}ct.profile&&Ge.maxTextureUnits<nr+1&&(Ge.maxTextureUnits=nr+1),this.unit=nr,pe.activeTexture(33984+nr),pe.bindTexture(this.target,this.texture)}return nr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&rr(this)}}),ct.profile&&(Ge.getTotalTextureSize=function(){var nr=0;return Object.keys(Tn).forEach(function(vr){nr+=Tn[vr].stats.size}),nr}),{create2D:function(nr,vr){function It(dr,Br){var Fr=lr.texInfo;Ht.call(Fr);var zr=Ut();return typeof dr=="number"?at(zr,0|dr,typeof Br=="number"?0|Br:0|dr):dr?(pr(Fr,dr),pt(zr,dr)):at(zr,1,1),Fr.genMipmaps&&(zr.mipmask=(zr.width<<1)-1),lr.mipmask=zr.mipmask,Mt(lr,zr),lr.internalformat=zr.internalformat,It.width=zr.width,It.height=zr.height,Qt(lr),St(zr,3553),Mr(Fr,3553),tr(),Kt(zr),ct.profile&&(lr.stats.size=k(lr.internalformat,lr.type,zr.width,zr.height,Fr.genMipmaps,!1)),It.format=xn[lr.internalformat],It.type=_n[lr.type],It.mag=ti[Fr.magFilter],It.min=jr[Fr.minFilter],It.wrapS=nn[Fr.wrapS],It.wrapT=nn[Fr.wrapT],It}var lr=new hr(3553);return Tn[lr.id]=lr,Ge.textureCount++,It(nr,vr),It.subimage=function(dr,Br,Fr,zr){Br|=0,Fr|=0,zr|=0;var Er=Pt();return Mt(Er,lr),Er.width=0,Er.height=0,jt(Er,dr),Er.width=Er.width||(lr.width>>zr)-Br,Er.height=Er.height||(lr.height>>zr)-Fr,Qt(lr),kt(Er,3553,Br,Fr,zr),tr(),Ee(Er),It},It.resize=function(dr,Br){var Fr=0|dr,zr=0|Br||Fr;if(Fr===lr.width&&zr===lr.height)return It;It.width=lr.width=Fr,It.height=lr.height=zr,Qt(lr);for(var Er=0;lr.mipmask>>Er;++Er){var xr=Fr>>Er,_r=zr>>Er;if(!xr||!_r)break;pe.texImage2D(3553,Er,lr.format,xr,_r,0,lr.format,lr.type,null)}return tr(),ct.profile&&(lr.stats.size=k(lr.internalformat,lr.type,Fr,zr,!1,!1)),It},It._reglType="texture2d",It._texture=lr,ct.profile&&(It.stats=lr.stats),It.destroy=function(){lr.decRef()},It},createCube:function(nr,vr,It,lr,dr,Br){function Fr(xr,_r,kr,Cr,Gr,qr){var Qr,rn=zr.texInfo;for(Ht.call(rn),Qr=0;6>Qr;++Qr)Er[Qr]=Ut();if(typeof xr!="number"&&xr){if(typeof xr=="object")if(_r)pt(Er[0],xr),pt(Er[1],_r),pt(Er[2],kr),pt(Er[3],Cr),pt(Er[4],Gr),pt(Er[5],qr);else if(pr(rn,xr),Ot(zr,xr),"faces"in xr)for(xr=xr.faces,Qr=0;6>Qr;++Qr)Mt(Er[Qr],zr),pt(Er[Qr],xr[Qr]);else for(Qr=0;6>Qr;++Qr)pt(Er[Qr],xr)}else for(xr=0|xr||1,Qr=0;6>Qr;++Qr)at(Er[Qr],xr,xr);for(Mt(zr,Er[0]),zr.mipmask=rn.genMipmaps?(Er[0].width<<1)-1:Er[0].mipmask,zr.internalformat=Er[0].internalformat,Fr.width=Er[0].width,Fr.height=Er[0].height,Qt(zr),Qr=0;6>Qr;++Qr)St(Er[Qr],34069+Qr);for(Mr(rn,34067),tr(),ct.profile&&(zr.stats.size=k(zr.internalformat,zr.type,Fr.width,Fr.height,rn.genMipmaps,!0)),Fr.format=xn[zr.internalformat],Fr.type=_n[zr.type],Fr.mag=ti[rn.magFilter],Fr.min=jr[rn.minFilter],Fr.wrapS=nn[rn.wrapS],Fr.wrapT=nn[rn.wrapT],Qr=0;6>Qr;++Qr)Kt(Er[Qr]);return Fr}var zr=new hr(34067);Tn[zr.id]=zr,Ge.cubeCount++;var Er=Array(6);return Fr(nr,vr,It,lr,dr,Br),Fr.subimage=function(xr,_r,kr,Cr,Gr){kr|=0,Cr|=0,Gr|=0;var qr=Pt();return Mt(qr,zr),qr.width=0,qr.height=0,jt(qr,_r),qr.width=qr.width||(zr.width>>Gr)-kr,qr.height=qr.height||(zr.height>>Gr)-Cr,Qt(zr),kt(qr,34069+xr,kr,Cr,Gr),tr(),Ee(qr),Fr},Fr.resize=function(xr){if((xr|=0)!==zr.width){Fr.width=zr.width=xr,Fr.height=zr.height=xr,Qt(zr);for(var _r=0;6>_r;++_r)for(var kr=0;zr.mipmask>>kr;++kr)pe.texImage2D(34069+_r,kr,zr.format,xr>>kr,xr>>kr,0,zr.format,zr.type,null);return tr(),ct.profile&&(zr.stats.size=k(zr.internalformat,zr.type,Fr.width,Fr.height,!1,!0)),Fr}},Fr._reglType="textureCube",Fr._texture=zr,ct.profile&&(Fr.stats=zr.stats),Fr.destroy=function(){zr.decRef()},Fr},clear:function(){for(var nr=0;nr<Cn;++nr)pe.activeTexture(33984+nr),pe.bindTexture(3553,null),oi[nr]=null;ce(Tn).forEach(rr),Ge.cubeCount=0,Ge.textureCount=0},getTexture:function(nr){return null},restore:function(){for(var nr=0;nr<Cn;++nr){var vr=oi[nr];vr&&(vr.bindCount=0,vr.unit=-1,oi[nr]=null)}ce(Tn).forEach(function(It){It.texture=pe.createTexture(),pe.bindTexture(It.target,It.texture);for(var lr=0;32>lr;++lr)if((It.mipmask&1<<lr)!=0)if(It.target===3553)pe.texImage2D(3553,lr,It.internalformat,It.width>>lr,It.height>>lr,0,It.internalformat,It.type,null);else for(var dr=0;6>dr;++dr)pe.texImage2D(34069+dr,lr,It.internalformat,It.width>>lr,It.height>>lr,0,It.internalformat,It.type,null);Mr(It.texInfo,It.target)})},refresh:function(){for(var nr=0;nr<Cn;++nr){var vr=oi[nr];vr&&(vr.bindCount=0,vr.unit=-1,oi[nr]=null),pe.activeTexture(33984+nr),pe.bindTexture(3553,null),pe.bindTexture(34067,null)}}}}function A(pe,be,Fe,Ve,Ke,Ge){function ct(hr,Qt,tr){this.target=hr,this.texture=Qt,this.renderbuffer=tr;var rr=hr=0;Qt?(hr=Qt.width,rr=Qt.height):tr&&(hr=tr.width,rr=tr.height),this.width=hr,this.height=rr}function st(hr){hr&&(hr.texture&&hr.texture._texture.decRef(),hr.renderbuffer&&hr.renderbuffer._renderbuffer.decRef())}function Mt(hr,Qt,tr){hr&&(hr.texture?hr.texture._texture.refCount+=1:hr.renderbuffer._renderbuffer.refCount+=1)}function Ot(hr,Qt){Qt&&(Qt.texture?pe.framebufferTexture2D(36160,hr,Qt.target,Qt.texture._texture.texture,0):pe.framebufferRenderbuffer(36160,hr,36161,Qt.renderbuffer._renderbuffer.renderbuffer))}function it(hr){var Qt=3553,tr=null,rr=null,fr=hr;return typeof hr=="object"&&(fr=hr.data,"target"in hr&&(Qt=0|hr.target)),(hr=fr._reglType)==="texture2d"||hr==="textureCube"?tr=fr:hr==="renderbuffer"&&(rr=fr,Qt=36161),new ct(Qt,tr,rr)}function ht(hr,Qt,tr,rr,fr){return tr?((hr=Ve.create2D({width:hr,height:Qt,format:rr,type:fr}))._texture.refCount=0,new ct(3553,hr,null)):((hr=Ke.create({width:hr,height:Qt,format:rr}))._renderbuffer.refCount=0,new ct(36161,null,hr))}function jt(hr){return hr&&(hr.texture||hr.renderbuffer)}function kt(hr,Qt,tr){hr&&(hr.texture?hr.texture.resize(Qt,tr):hr.renderbuffer&&hr.renderbuffer.resize(Qt,tr),hr.width=Qt,hr.height=tr)}function Pt(){this.id=pr++,Mr[this.id]=this,this.framebuffer=pe.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Ee(hr){hr.colorAttachments.forEach(st),st(hr.depthAttachment),st(hr.stencilAttachment),st(hr.depthStencilAttachment)}function Ze(hr){pe.deleteFramebuffer(hr.framebuffer),hr.framebuffer=null,Ge.framebufferCount--,delete Mr[hr.id]}function at(hr){var Qt;pe.bindFramebuffer(36160,hr.framebuffer);var tr=hr.colorAttachments;for(Qt=0;Qt<tr.length;++Qt)Ot(36064+Qt,tr[Qt]);for(Qt=tr.length;Qt<Fe.maxColorAttachments;++Qt)pe.framebufferTexture2D(36160,36064+Qt,3553,null,0);pe.framebufferTexture2D(36160,33306,3553,null,0),pe.framebufferTexture2D(36160,36096,3553,null,0),pe.framebufferTexture2D(36160,36128,3553,null,0),Ot(36096,hr.depthAttachment),Ot(36128,hr.stencilAttachment),Ot(33306,hr.depthStencilAttachment),pe.checkFramebufferStatus(36160),pe.isContextLost(),pe.bindFramebuffer(36160,St.next?St.next.framebuffer:null),St.cur=St.next,pe.getError()}function pt(hr,Qt){function tr(fr,yr){var Sr,Dr=0,Nr=0,Wr=!0,hn=!0;Sr=null;var tn=!0,Fn="rgba",an="uint8",xn=1,_n=null,ti=null,jr=null,nn=!1;typeof fr=="number"?(Dr=0|fr,Nr=0|yr||Dr):fr?("shape"in fr?(Dr=(Nr=fr.shape)[0],Nr=Nr[1]):("radius"in fr&&(Dr=Nr=fr.radius),"width"in fr&&(Dr=fr.width),"height"in fr&&(Nr=fr.height)),("color"in fr||"colors"in fr)&&(Sr=fr.color||fr.colors,Array.isArray(Sr)),Sr||("colorCount"in fr&&(xn=0|fr.colorCount),"colorTexture"in fr&&(tn=!!fr.colorTexture,Fn="rgba4"),"colorType"in fr&&(an=fr.colorType,!tn)&&(an==="half float"||an==="float16"?Fn="rgba16f":an!=="float"&&an!=="float32"||(Fn="rgba32f")),"colorFormat"in fr&&(Fn=fr.colorFormat,0<=Ut.indexOf(Fn)?tn=!0:0<=Kt.indexOf(Fn)&&(tn=!1))),("depthTexture"in fr||"depthStencilTexture"in fr)&&(nn=!(!fr.depthTexture&&!fr.depthStencilTexture)),"depth"in fr&&(typeof fr.depth=="boolean"?Wr=fr.depth:(_n=fr.depth,hn=!1)),"stencil"in fr&&(typeof fr.stencil=="boolean"?hn=fr.stencil:(ti=fr.stencil,Wr=!1)),"depthStencil"in fr&&(typeof fr.depthStencil=="boolean"?Wr=hn=fr.depthStencil:(jr=fr.depthStencil,hn=Wr=!1))):Dr=Nr=1;var vn=null,en=null,fn=null,Gn=null;if(Array.isArray(Sr))vn=Sr.map(it);else if(Sr)vn=[it(Sr)];else for(vn=Array(xn),Sr=0;Sr<xn;++Sr)vn[Sr]=ht(Dr,Nr,tn,Fn,an);for(Dr=Dr||vn[0].width,Nr=Nr||vn[0].height,_n?en=it(_n):Wr&&!hn&&(en=ht(Dr,Nr,nn,"depth","uint32")),ti?fn=it(ti):hn&&!Wr&&(fn=ht(Dr,Nr,!1,"stencil","uint8")),jr?Gn=it(jr):!_n&&!ti&&hn&&Wr&&(Gn=ht(Dr,Nr,nn,"depth stencil","depth stencil")),Wr=null,Sr=0;Sr<vn.length;++Sr)Mt(vn[Sr]),vn[Sr]&&vn[Sr].texture&&(hn=$e[vn[Sr].texture._texture.format]*vt[vn[Sr].texture._texture.type],Wr===null&&(Wr=hn));return Mt(en),Mt(fn),Mt(Gn),Ee(rr),rr.width=Dr,rr.height=Nr,rr.colorAttachments=vn,rr.depthAttachment=en,rr.stencilAttachment=fn,rr.depthStencilAttachment=Gn,tr.color=vn.map(jt),tr.depth=jt(en),tr.stencil=jt(fn),tr.depthStencil=jt(Gn),tr.width=rr.width,tr.height=rr.height,at(rr),tr}var rr=new Pt;return Ge.framebufferCount++,tr(hr,Qt),B(tr,{resize:function(fr,yr){var Sr=Math.max(0|fr,1),Dr=Math.max(0|yr||Sr,1);if(Sr===rr.width&&Dr===rr.height)return tr;for(var Nr=rr.colorAttachments,Wr=0;Wr<Nr.length;++Wr)kt(Nr[Wr],Sr,Dr);return kt(rr.depthAttachment,Sr,Dr),kt(rr.stencilAttachment,Sr,Dr),kt(rr.depthStencilAttachment,Sr,Dr),rr.width=tr.width=Sr,rr.height=tr.height=Dr,at(rr),tr},_reglType:"framebuffer",_framebuffer:rr,destroy:function(){Ze(rr),Ee(rr)},use:function(fr){St.setFBO({framebuffer:tr},fr)}})}var St={cur:null,next:null,dirty:!1,setFBO:null},Ut=["rgba"],Kt=["rgba4","rgb565","rgb5 a1"];be.ext_srgb&&Kt.push("srgba"),be.ext_color_buffer_half_float&&Kt.push("rgba16f","rgb16f"),be.webgl_color_buffer_float&&Kt.push("rgba32f");var Ht=["uint8"];be.oes_texture_half_float&&Ht.push("half float","float16"),be.oes_texture_float&&Ht.push("float","float32");var pr=0,Mr={};return B(St,{getFramebuffer:function(hr){return typeof hr=="function"&&hr._reglType==="framebuffer"&&(hr=hr._framebuffer)instanceof Pt?hr:null},create:pt,createCube:function(hr){function Qt(rr){var fr,yr={color:null},Sr=0,Dr=null;fr="rgba";var Nr="uint8",Wr=1;if(typeof rr=="number"?Sr=0|rr:rr?("shape"in rr?Sr=rr.shape[0]:("radius"in rr&&(Sr=0|rr.radius),"width"in rr?Sr=0|rr.width:"height"in rr&&(Sr=0|rr.height)),("color"in rr||"colors"in rr)&&(Dr=rr.color||rr.colors,Array.isArray(Dr)),Dr||("colorCount"in rr&&(Wr=0|rr.colorCount),"colorType"in rr&&(Nr=rr.colorType),"colorFormat"in rr&&(fr=rr.colorFormat)),"depth"in rr&&(yr.depth=rr.depth),"stencil"in rr&&(yr.stencil=rr.stencil),"depthStencil"in rr&&(yr.depthStencil=rr.depthStencil)):Sr=1,Dr)if(Array.isArray(Dr))for(rr=[],fr=0;fr<Dr.length;++fr)rr[fr]=Dr[fr];else rr=[Dr];else for(rr=Array(Wr),Dr={radius:Sr,format:fr,type:Nr},fr=0;fr<Wr;++fr)rr[fr]=Ve.createCube(Dr);for(yr.color=Array(rr.length),fr=0;fr<rr.length;++fr)Wr=rr[fr],Sr=Sr||Wr.width,yr.color[fr]={target:34069,data:rr[fr]};for(fr=0;6>fr;++fr){for(Wr=0;Wr<rr.length;++Wr)yr.color[Wr].target=34069+fr;0<fr&&(yr.depth=tr[0].depth,yr.stencil=tr[0].stencil,yr.depthStencil=tr[0].depthStencil),tr[fr]?tr[fr](yr):tr[fr]=pt(yr)}return B(Qt,{width:Sr,height:Sr,color:rr})}var tr=Array(6);return Qt(hr),B(Qt,{faces:tr,resize:function(rr){var fr=0|rr;if(fr===Qt.width)return Qt;var yr=Qt.color;for(rr=0;rr<yr.length;++rr)yr[rr].resize(fr);for(rr=0;6>rr;++rr)tr[rr].resize(fr);return Qt.width=Qt.height=fr,Qt},_reglType:"framebufferCube",destroy:function(){tr.forEach(function(rr){rr.destroy()})}})},clear:function(){ce(Mr).forEach(Ze)},restore:function(){St.cur=null,St.next=null,St.dirty=!0,ce(Mr).forEach(function(hr){hr.framebuffer=pe.createFramebuffer(),at(hr)})}})}function I(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function P(pe,be,Fe,Ve,Ke,Ge,ct){function st(){this.id=++it,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var kt=be.oes_vertex_array_object;this.vao=kt?kt.createVertexArrayOES():null,ht[this.id]=this,this.buffers=[]}var Mt=Fe.maxAttributes,Ot=Array(Mt);for(Fe=0;Fe<Mt;++Fe)Ot[Fe]=new I;var it=0,ht={},jt={Record:I,scope:{},state:Ot,currentVAO:null,targetVAO:null,restore:be.oes_vertex_array_object?function(){be.oes_vertex_array_object&&ce(ht).forEach(function(kt){kt.refresh()})}:function(){},createVAO:function(kt){function Pt(Ze){var at;Array.isArray(Ze)?(at=Ze,Ee.elements&&Ee.ownsElements&&Ee.elements.destroy(),Ee.elements=null,Ee.ownsElements=!1,Ee.offset=0,Ee.count=0,Ee.instances=-1,Ee.primitive=4):(Ze.elements?(at=Ze.elements,Ee.ownsElements?(typeof at=="function"&&at._reglType==="elements"?Ee.elements.destroy():Ee.elements(at),Ee.ownsElements=!1):Ge.getElements(Ze.elements)?(Ee.elements=Ze.elements,Ee.ownsElements=!1):(Ee.elements=Ge.create(Ze.elements),Ee.ownsElements=!0)):(Ee.elements=null,Ee.ownsElements=!1),at=Ze.attributes,Ee.offset=0,Ee.count=-1,Ee.instances=-1,Ee.primitive=4,Ee.elements&&(Ee.count=Ee.elements._elements.vertCount,Ee.primitive=Ee.elements._elements.primType),"offset"in Ze&&(Ee.offset=0|Ze.offset),"count"in Ze&&(Ee.count=0|Ze.count),"instances"in Ze&&(Ee.instances=0|Ze.instances),"primitive"in Ze&&(Ee.primitive=Te[Ze.primitive])),Ze={};var pt=Ee.attributes;pt.length=at.length;for(var St=0;St<at.length;++St){var Ut,Kt=at[St],Ht=pt[St]=new I,pr=Kt.data||Kt;Array.isArray(pr)||de(pr)||r(pr)?(Ee.buffers[St]&&(Ut=Ee.buffers[St],de(pr)&&Ut._buffer.byteLength>=pr.byteLength?Ut.subdata(pr):(Ut.destroy(),Ee.buffers[St]=null)),Ee.buffers[St]||(Ut=Ee.buffers[St]=Ke.create(Kt,34962,!1,!0)),Ht.buffer=Ke.getBuffer(Ut),Ht.size=0|Ht.buffer.dimension,Ht.normalized=!1,Ht.type=Ht.buffer.dtype,Ht.offset=0,Ht.stride=0,Ht.divisor=0,Ht.state=1,Ze[St]=1):Ke.getBuffer(Kt)?(Ht.buffer=Ke.getBuffer(Kt),Ht.size=0|Ht.buffer.dimension,Ht.normalized=!1,Ht.type=Ht.buffer.dtype,Ht.offset=0,Ht.stride=0,Ht.divisor=0,Ht.state=1):Ke.getBuffer(Kt.buffer)?(Ht.buffer=Ke.getBuffer(Kt.buffer),Ht.size=0|(+Kt.size||Ht.buffer.dimension),Ht.normalized=!!Kt.normalized||!1,Ht.type="type"in Kt?fe[Kt.type]:Ht.buffer.dtype,Ht.offset=0|(Kt.offset||0),Ht.stride=0|(Kt.stride||0),Ht.divisor=0|(Kt.divisor||0),Ht.state=1):"x"in Kt&&(Ht.x=+Kt.x||0,Ht.y=+Kt.y||0,Ht.z=+Kt.z||0,Ht.w=+Kt.w||0,Ht.state=2)}for(Ut=0;Ut<Ee.buffers.length;++Ut)!Ze[Ut]&&Ee.buffers[Ut]&&(Ee.buffers[Ut].destroy(),Ee.buffers[Ut]=null);return Ee.refresh(),Pt}var Ee=new st;return Ve.vaoCount+=1,Pt.destroy=function(){for(var Ze=0;Ze<Ee.buffers.length;++Ze)Ee.buffers[Ze]&&Ee.buffers[Ze].destroy();Ee.buffers.length=0,Ee.ownsElements&&(Ee.elements.destroy(),Ee.elements=null,Ee.ownsElements=!1),Ee.destroy()},Pt._vao=Ee,Pt._reglType="vao",Pt(kt)},getVAO:function(kt){return typeof kt=="function"&&kt._vao?kt._vao:null},destroyBuffer:function(kt){for(var Pt=0;Pt<Ot.length;++Pt){var Ee=Ot[Pt];Ee.buffer===kt&&(pe.disableVertexAttribArray(Pt),Ee.buffer=null)}},setVAO:be.oes_vertex_array_object?function(kt){if(kt!==jt.currentVAO){var Pt=be.oes_vertex_array_object;kt?Pt.bindVertexArrayOES(kt.vao):Pt.bindVertexArrayOES(null),jt.currentVAO=kt}}:function(kt){if(kt!==jt.currentVAO){if(kt)kt.bindAttrs();else{for(var Pt=be.angle_instanced_arrays,Ee=0;Ee<Ot.length;++Ee){var Ze=Ot[Ee];Ze.buffer?(pe.enableVertexAttribArray(Ee),Ze.buffer.bind(),pe.vertexAttribPointer(Ee,Ze.size,Ze.type,Ze.normalized,Ze.stride,Ze.offfset),Pt&&Ze.divisor&&Pt.vertexAttribDivisorANGLE(Ee,Ze.divisor)):(pe.disableVertexAttribArray(Ee),pe.vertexAttrib4f(Ee,Ze.x,Ze.y,Ze.z,Ze.w))}ct.elements?pe.bindBuffer(34963,ct.elements.buffer.buffer):pe.bindBuffer(34963,null)}jt.currentVAO=kt}},clear:be.oes_vertex_array_object?function(){ce(ht).forEach(function(kt){kt.destroy()})}:function(){}};return st.prototype.bindAttrs=function(){for(var kt=be.angle_instanced_arrays,Pt=this.attributes,Ee=0;Ee<Pt.length;++Ee){var Ze=Pt[Ee];Ze.buffer?(pe.enableVertexAttribArray(Ee),pe.bindBuffer(34962,Ze.buffer.buffer),pe.vertexAttribPointer(Ee,Ze.size,Ze.type,Ze.normalized,Ze.stride,Ze.offset),kt&&Ze.divisor&&kt.vertexAttribDivisorANGLE(Ee,Ze.divisor)):(pe.disableVertexAttribArray(Ee),pe.vertexAttrib4f(Ee,Ze.x,Ze.y,Ze.z,Ze.w))}for(kt=Pt.length;kt<Mt;++kt)pe.disableVertexAttribArray(kt);(kt=Ge.getElements(this.elements))?pe.bindBuffer(34963,kt.buffer.buffer):pe.bindBuffer(34963,null)},st.prototype.refresh=function(){var kt=be.oes_vertex_array_object;kt&&(kt.bindVertexArrayOES(this.vao),this.bindAttrs(),jt.currentVAO=null,kt.bindVertexArrayOES(null))},st.prototype.destroy=function(){if(this.vao){var kt=be.oes_vertex_array_object;this===jt.currentVAO&&(jt.currentVAO=null,kt.bindVertexArrayOES(null)),kt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ht[this.id]&&(delete ht[this.id],--Ve.vaoCount)},jt}function S(pe,be,Fe,Ve){function Ke(Pt,Ee,Ze,at){this.name=Pt,this.id=Ee,this.location=Ze,this.info=at}function Ge(Pt,Ee){for(var Ze=0;Ze<Pt.length;++Ze)if(Pt[Ze].id===Ee.id)return void(Pt[Ze].location=Ee.location);Pt.push(Ee)}function ct(Pt,Ee,Ze){if(!(pt=(Ze=Pt===35632?Ot:it)[Ee])){var at=be.str(Ee),pt=pe.createShader(Pt);pe.shaderSource(pt,at),pe.compileShader(pt),Ze[Ee]=pt}return pt}function st(Pt,Ee){this.id=kt++,this.fragId=Pt,this.vertId=Ee,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ve.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Mt(Pt,Ee,Ze){var at;at=ct(35632,Pt.fragId);var pt=ct(35633,Pt.vertId);if(Ee=Pt.program=pe.createProgram(),pe.attachShader(Ee,at),pe.attachShader(Ee,pt),Ze)for(at=0;at<Ze.length;++at)pt=Ze[at],pe.bindAttribLocation(Ee,pt[0],pt[1]);pe.linkProgram(Ee),pt=pe.getProgramParameter(Ee,35718),Ve.profile&&(Pt.stats.uniformsCount=pt);var St=Pt.uniforms;for(at=0;at<pt;++at)if(Ze=pe.getActiveUniform(Ee,at))if(1<Ze.size)for(var Ut=0;Ut<Ze.size;++Ut){var Kt=Ze.name.replace("[0]","["+Ut+"]");Ge(St,new Ke(Kt,be.id(Kt),pe.getUniformLocation(Ee,Kt),Ze))}else Ge(St,new Ke(Ze.name,be.id(Ze.name),pe.getUniformLocation(Ee,Ze.name),Ze));for(pt=pe.getProgramParameter(Ee,35721),Ve.profile&&(Pt.stats.attributesCount=pt),Pt=Pt.attributes,at=0;at<pt;++at)(Ze=pe.getActiveAttrib(Ee,at))&&Ge(Pt,new Ke(Ze.name,be.id(Ze.name),pe.getAttribLocation(Ee,Ze.name),Ze))}var Ot={},it={},ht={},jt=[],kt=0;return Ve.profile&&(Fe.getMaxUniformsCount=function(){var Pt=0;return jt.forEach(function(Ee){Ee.stats.uniformsCount>Pt&&(Pt=Ee.stats.uniformsCount)}),Pt},Fe.getMaxAttributesCount=function(){var Pt=0;return jt.forEach(function(Ee){Ee.stats.attributesCount>Pt&&(Pt=Ee.stats.attributesCount)}),Pt}),{clear:function(){var Pt=pe.deleteShader.bind(pe);ce(Ot).forEach(Pt),Ot={},ce(it).forEach(Pt),it={},jt.forEach(function(Ee){pe.deleteProgram(Ee.program)}),jt.length=0,ht={},Fe.shaderCount=0},program:function(Pt,Ee,Ze,at){var pt=ht[Ee];pt||(pt=ht[Ee]={});var St=pt[Pt];if(St&&(St.refCount++,!at))return St;var Ut=new st(Ee,Pt);return Fe.shaderCount++,Mt(Ut,Ze,at),St||(pt[Pt]=Ut),jt.push(Ut),B(Ut,{destroy:function(){if(Ut.refCount--,0>=Ut.refCount){pe.deleteProgram(Ut.program);var Kt=jt.indexOf(Ut);jt.splice(Kt,1),Fe.shaderCount--}0>=pt[Ut.vertId].refCount&&(pe.deleteShader(it[Ut.vertId]),delete it[Ut.vertId],delete ht[Ut.fragId][Ut.vertId]),Object.keys(ht[Ut.fragId]).length||(pe.deleteShader(Ot[Ut.fragId]),delete Ot[Ut.fragId],delete ht[Ut.fragId])}})},restore:function(){Ot={},it={};for(var Pt=0;Pt<jt.length;++Pt)Mt(jt[Pt],null,jt[Pt].attributes.map(function(Ee){return[Ee.location,Ee.name]}))},shader:ct,frag:-1,vert:-1}}function E(pe,be,Fe,Ve,Ke,Ge,ct){function st(Mt){var Ot;Ot=be.next===null?5121:be.next.colorAttachments[0].texture._texture.type;var it=0,ht=0,jt=Ve.framebufferWidth,kt=Ve.framebufferHeight,Pt=null;return de(Mt)?Pt=Mt:Mt&&(it=0|Mt.x,ht=0|Mt.y,jt=0|(Mt.width||Ve.framebufferWidth-it),kt=0|(Mt.height||Ve.framebufferHeight-ht),Pt=Mt.data||null),Fe(),Mt=jt*kt*4,Pt||(Ot===5121?Pt=new Uint8Array(Mt):Ot===5126&&(Pt=Pt||new Float32Array(Mt))),pe.pixelStorei(3333,4),pe.readPixels(it,ht,jt,kt,6408,Ot,Pt),Pt}return function(Mt){return Mt&&"framebuffer"in Mt?function(Ot){var it;return be.setFBO({framebuffer:Ot.framebuffer},function(){it=st(Ot)}),it}(Mt):st(Mt)}}function z(pe,be){return pe>>>be|pe<<32-be}function D(pe,be){var Fe=(65535&pe)+(65535&be);return(pe>>16)+(be>>16)+(Fe>>16)<<16|65535&Fe}function j(pe){return Array.prototype.slice.call(pe)}function V(pe){return j(pe).join("")}function Z(pe){function be(){var it=[],ht=[];return B(function(){it.push.apply(it,j(arguments))},{def:function(){var jt="v"+Ke++;return ht.push(jt),0<arguments.length&&(it.push(jt,"="),it.push.apply(it,j(arguments)),it.push(";")),jt},toString:function(){return V([0<ht.length?"var "+ht.join(",")+";":"",V(it)])}})}function Fe(){function it(Ee,Ze){jt(Ee,Ze,"=",ht.def(Ee,Ze),";")}var ht=be(),jt=be(),kt=ht.toString,Pt=jt.toString;return B(function(){ht.apply(ht,j(arguments))},{def:ht.def,entry:ht,exit:jt,save:it,set:function(Ee,Ze,at){it(Ee,Ze),ht(Ee,Ze,"=",at,";")},toString:function(){return kt()+Pt()}})}var Ve=pe&&pe.cache,Ke=0,Ge=[],ct=[],st=[],Mt=be(),Ot={};return{global:Mt,link:function(it,ht){var jt=ht&&ht.stable;if(!jt){for(var kt=0;kt<ct.length;++kt)if(ct[kt]===it&&!st[kt])return Ge[kt]}return kt="g"+Ke++,Ge.push(kt),ct.push(it),st.push(jt),kt},block:be,proc:function(it,ht){function jt(){var Ze="a"+kt.length;return kt.push(Ze),Ze}var kt=[];ht=ht||0;for(var Pt=0;Pt<ht;++Pt)jt();var Ee=(Pt=Fe()).toString;return Ot[it]=B(Pt,{arg:jt,toString:function(){return V(["function(",kt.join(),"){",Ee(),"}"])}})},scope:Fe,cond:function(){var it=V(arguments),ht=Fe(),jt=Fe(),kt=ht.toString,Pt=jt.toString;return B(ht,{then:function(){return ht.apply(ht,j(arguments)),this},else:function(){return jt.apply(jt,j(arguments)),this},toString:function(){var Ee=Pt();return Ee&&(Ee="else{"+Ee+"}"),V(["if(",it,"){",kt(),"}",Ee])}})},compile:function(){var it=['"use strict";',Mt,"return {"];Object.keys(Ot).forEach(function(kt){it.push('"',kt,'":',Ot[kt].toString(),",")}),it.push("}");var ht,jt=V(it).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Ve&&(ht=function(kt){for(var Pt,Ee="",Ze=0;Ze<kt.length;Ze++)Pt=kt.charCodeAt(Ze),Ee+="0123456789abcdef".charAt(Pt>>>4&15)+"0123456789abcdef".charAt(15&Pt);return Ee}(function(kt){for(var Pt=Array(kt.length>>2),Ee=0;Ee<Pt.length;Ee++)Pt[Ee]=0;for(Ee=0;Ee<8*kt.length;Ee+=8)Pt[Ee>>5]|=(255&kt.charCodeAt(Ee/8))<<24-Ee%32;var Ze,at,pt,St,Ut,Kt,Ht,pr,Mr,hr,Qt,tr=8*kt.length;for(kt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ee=Array(64),Pt[tr>>5]|=128<<24-tr%32,Pt[15+(tr+64>>9<<4)]=tr,pr=0;pr<Pt.length;pr+=16){for(tr=kt[0],Ze=kt[1],at=kt[2],pt=kt[3],St=kt[4],Ut=kt[5],Kt=kt[6],Ht=kt[7],Mr=0;64>Mr;Mr++){var rr;16>Mr?Ee[Mr]=Pt[Mr+pr]:(hr=Mr,Qt=D(Qt=z(Qt=Ee[Mr-2],17)^z(Qt,19)^Qt>>>10,Ee[Mr-7]),rr=z(rr=Ee[Mr-15],7)^z(rr,18)^rr>>>3,Ee[hr]=D(D(Qt,rr),Ee[Mr-16])),hr=D(D(D(D(Ht,hr=z(hr=St,6)^z(hr,11)^z(hr,25)),St&Ut^~St&Kt),Nt[Mr]),Ee[Mr]),Qt=D(Ht=z(Ht=tr,2)^z(Ht,13)^z(Ht,22),tr&Ze^tr&at^Ze&at),Ht=Kt,Kt=Ut,Ut=St,St=D(pt,hr),pt=at,at=Ze,Ze=tr,tr=D(hr,Qt)}kt[0]=D(tr,kt[0]),kt[1]=D(Ze,kt[1]),kt[2]=D(at,kt[2]),kt[3]=D(pt,kt[3]),kt[4]=D(St,kt[4]),kt[5]=D(Ut,kt[5]),kt[6]=D(Kt,kt[6]),kt[7]=D(Ht,kt[7])}for(Pt="",Ee=0;Ee<32*kt.length;Ee+=8)Pt+=String.fromCharCode(kt[Ee>>5]>>>24-Ee%32&255);return Pt}(function(kt){for(var Pt,Ee,Ze="",at=-1;++at<kt.length;)Pt=kt.charCodeAt(at),Ee=at+1<kt.length?kt.charCodeAt(at+1):0,55296<=Pt&&56319>=Pt&&56320<=Ee&&57343>=Ee&&(Pt=65536+((1023&Pt)<<10)+(1023&Ee),at++),127>=Pt?Ze+=String.fromCharCode(Pt):2047>=Pt?Ze+=String.fromCharCode(192|Pt>>>6&31,128|63&Pt):65535>=Pt?Ze+=String.fromCharCode(224|Pt>>>12&15,128|Pt>>>6&63,128|63&Pt):2097151>=Pt&&(Ze+=String.fromCharCode(240|Pt>>>18&7,128|Pt>>>12&63,128|Pt>>>6&63,128|63&Pt));return Ze}(jt))),Ve[ht])?Ve[ht].apply(null,ct):(jt=Function.apply(null,Ge.concat(jt)),Ve&&(Ve[ht]=jt),jt.apply(null,ct))}}}function Q(pe){return Array.isArray(pe)||de(pe)||r(pe)}function K(pe){return pe.sort(function(be,Fe){return be==="viewport"?-1:Fe==="viewport"?1:be<Fe?-1:1})}function $(pe,be,Fe,Ve){this.thisDep=pe,this.contextDep=be,this.propDep=Fe,this.append=Ve}function ne(pe){return pe&&!(pe.thisDep||pe.contextDep||pe.propDep)}function H(pe){return new $(!1,!1,!1,pe)}function N(pe,be){var Fe=pe.type;if(Fe===0)return new $(!0,1<=(Fe=pe.data.length),2<=Fe,be);if(Fe===4)return new $((Fe=pe.data).thisDep,Fe.contextDep,Fe.propDep,be);if(Fe===5)return new $(!1,!1,!1,be);if(Fe===6){for(var Ve=Fe=!1,Ke=!1,Ge=0;Ge<pe.data.length;++Ge){var ct=pe.data[Ge];ct.type===1?Ke=!0:ct.type===2?Ve=!0:ct.type===3?Fe=!0:ct.type===0?(Fe=!0,1<=(ct=ct.data)&&(Ve=!0),2<=ct&&(Ke=!0)):ct.type===4&&(Fe=Fe||ct.data.thisDep,Ve=Ve||ct.data.contextDep,Ke=Ke||ct.data.propDep)}return new $(Fe,Ve,Ke,be)}return new $(Fe===3,Fe===2,Fe===1,be)}function U(pe,be,Fe,Ve,Ke,Ge,ct,st,Mt,Ot,it,ht,jt,kt,Pt,Ee){function Ze(It){return It.replace(".","_")}function at(It,lr,dr){var Br=Ze(It);Gn.push(It),fn[Br]=en[Br]=!!dr,Tn[Br]=lr}function pt(It,lr,dr){var Br=Ze(It);Gn.push(It),Array.isArray(dr)?(en[Br]=dr.slice(),fn[Br]=dr.slice()):en[Br]=fn[Br]=dr,Cn[Br]=lr}function St(){var It=Z({cache:Pt}),lr=It.link,dr=It.global;It.id=vr++,It.batchId="0";var Br=lr(oi),Fr=It.shared={props:"a0"};Object.keys(oi).forEach(function(kr){Fr[kr]=dr.def(Br,".",kr)});var zr=It.next={},Er=It.current={};Object.keys(Cn).forEach(function(kr){Array.isArray(en[kr])&&(zr[kr]=dr.def(Fr.next,".",kr),Er[kr]=dr.def(Fr.current,".",kr))});var xr=It.constants={};Object.keys(nr).forEach(function(kr){xr[kr]=dr.def(JSON.stringify(nr[kr]))}),It.invoke=function(kr,Cr){switch(Cr.type){case 0:var Gr=["this",Fr.context,Fr.props,It.batchId];return kr.def(lr(Cr.data),".call(",Gr.slice(0,Math.max(Cr.data.length+1,4)),")");case 1:return kr.def(Fr.props,Cr.data);case 2:return kr.def(Fr.context,Cr.data);case 3:return kr.def("this",Cr.data);case 4:return Cr.data.append(It,kr),Cr.data.ref;case 5:return Cr.data.toString();case 6:return Cr.data.map(function(qr){return It.invoke(kr,qr)})}},It.attribCache={};var _r={};return It.scopeAttrib=function(kr){if((kr=be.id(kr))in _r)return _r[kr];var Cr=Ot.scope[kr];return Cr||(Cr=Ot.scope[kr]=new _n),_r[kr]=lr(Cr)},It}function Ut(It,lr){var dr=It.static,Br=It.dynamic;if("framebuffer"in dr){var Fr=dr.framebuffer;return Fr?(Fr=st.getFramebuffer(Fr),H(function(Er,xr){var _r=Er.link(Fr),kr=Er.shared;return xr.set(kr.framebuffer,".next",_r),kr=kr.context,xr.set(kr,".framebufferWidth",_r+".width"),xr.set(kr,".framebufferHeight",_r+".height"),_r})):H(function(Er,xr){var _r=Er.shared;return xr.set(_r.framebuffer,".next","null"),_r=_r.context,xr.set(_r,".framebufferWidth",_r+".drawingBufferWidth"),xr.set(_r,".framebufferHeight",_r+".drawingBufferHeight"),"null"})}if("framebuffer"in Br){var zr=Br.framebuffer;return N(zr,function(Er,xr){var _r=Er.invoke(xr,zr),kr=Er.shared,Cr=kr.framebuffer;return _r=xr.def(Cr,".getFramebuffer(",_r,")"),xr.set(Cr,".next",_r),kr=kr.context,xr.set(kr,".framebufferWidth",_r+"?"+_r+".width:"+kr+".drawingBufferWidth"),xr.set(kr,".framebufferHeight",_r+"?"+_r+".height:"+kr+".drawingBufferHeight"),_r})}return null}function Kt(It,lr,dr){function Br(kr){if(kr in Fr){var Cr=be.id(Fr[kr]);return(kr=H(function(){return Cr})).id=Cr,kr}if(kr in zr){var Gr=zr[kr];return N(Gr,function(qr,Qr){var rn=qr.invoke(Qr,Gr);return Qr.def(qr.shared.strings,".id(",rn,")")})}return null}var Fr=It.static,zr=It.dynamic,Er=Br("frag"),xr=Br("vert"),_r=null;return ne(Er)&&ne(xr)?(_r=it.program(xr.id,Er.id,null,dr),It=H(function(kr,Cr){return kr.link(_r)})):It=new $(Er&&Er.thisDep||xr&&xr.thisDep,Er&&Er.contextDep||xr&&xr.contextDep,Er&&Er.propDep||xr&&xr.propDep,function(kr,Cr){var Gr,qr,Qr=kr.shared.shader;return Gr=Er?Er.append(kr,Cr):Cr.def(Qr,".","frag"),qr=xr?xr.append(kr,Cr):Cr.def(Qr,".","vert"),Cr.def(Qr+".program("+qr+","+Gr+")")}),{frag:Er,vert:xr,progVar:It,program:_r}}function Ht(It,lr){function dr(rn,yn){if(rn in Br){var wn=0|Br[rn];return yn?zr.offset=wn:zr.instances=wn,H(function(Pn,Dn){return yn&&(Pn.OFFSET=wn),wn})}if(rn in Fr){var kn=Fr[rn];return N(kn,function(Pn,Dn){var Zn=Pn.invoke(Dn,kn);return yn&&(Pn.OFFSET=Zn),Zn})}if(yn){if(_r)return H(function(Pn,Dn){return Pn.OFFSET=0});if(Er)return new $(xr.thisDep,xr.contextDep,xr.propDep,function(Pn,Dn){return Dn.def(Pn.shared.vao+".currentVAO?"+Pn.shared.vao+".currentVAO.offset:0")})}else if(Er)return new $(xr.thisDep,xr.contextDep,xr.propDep,function(Pn,Dn){return Dn.def(Pn.shared.vao+".currentVAO?"+Pn.shared.vao+".currentVAO.instances:-1")});return null}var Br=It.static,Fr=It.dynamic,zr={},Er=!1,xr=function(){if("vao"in Br){var rn=Br.vao;return rn!==null&&Ot.getVAO(rn)===null&&(rn=Ot.createVAO(rn)),Er=!0,zr.vao=rn,H(function(wn){var kn=Ot.getVAO(rn);return kn?wn.link(kn):"null"})}if("vao"in Fr){Er=!0;var yn=Fr.vao;return N(yn,function(wn,kn){var Pn=wn.invoke(kn,yn);return kn.def(wn.shared.vao+".getVAO("+Pn+")")})}return null}(),_r=!1,kr=function(){if("elements"in Br){var rn=Br.elements;if(zr.elements=rn,Q(rn)){var yn=zr.elements=Ge.create(rn,!0);rn=Ge.getElements(yn),_r=!0}else rn&&(rn=Ge.getElements(rn),_r=!0);return(yn=H(function(kn,Pn){if(rn){var Dn=kn.link(rn);return kn.ELEMENTS=Dn}return kn.ELEMENTS=null})).value=rn,yn}if("elements"in Fr){_r=!0;var wn=Fr.elements;return N(wn,function(kn,Pn){var Dn=(Zn=kn.shared).isBufferArgs,Zn=Zn.elements,Ai=kn.invoke(Pn,wn),Mi=Pn.def("null");return Dn=Pn.def(Dn,"(",Ai,")"),Ai=kn.cond(Dn).then(Mi,"=",Zn,".createStream(",Ai,");").else(Mi,"=",Zn,".getElements(",Ai,");"),Pn.entry(Ai),Pn.exit(kn.cond(Dn).then(Zn,".destroyStream(",Mi,");")),kn.ELEMENTS=Mi})}return Er?new $(xr.thisDep,xr.contextDep,xr.propDep,function(kn,Pn){return Pn.def(kn.shared.vao+".currentVAO?"+kn.shared.elements+".getElements("+kn.shared.vao+".currentVAO.elements):null")}):null}(),Cr=dr("offset",!0),Gr=function(){if("primitive"in Br){var rn=Br.primitive;return zr.primitive=rn,H(function(wn,kn){return Te[rn]})}if("primitive"in Fr){var yn=Fr.primitive;return N(yn,function(wn,kn){var Pn=wn.constants.primTypes,Dn=wn.invoke(kn,yn);return kn.def(Pn,"[",Dn,"]")})}return _r?ne(kr)?kr.value?H(function(wn,kn){return kn.def(wn.ELEMENTS,".primType")}):H(function(){return 4}):new $(kr.thisDep,kr.contextDep,kr.propDep,function(wn,kn){var Pn=wn.ELEMENTS;return kn.def(Pn,"?",Pn,".primType:",4)}):Er?new $(xr.thisDep,xr.contextDep,xr.propDep,function(wn,kn){return kn.def(wn.shared.vao+".currentVAO?"+wn.shared.vao+".currentVAO.primitive:4")}):null}(),qr=function(){if("count"in Br){var rn=0|Br.count;return zr.count=rn,H(function(){return rn})}if("count"in Fr){var yn=Fr.count;return N(yn,function(wn,kn){return wn.invoke(kn,yn)})}return _r?ne(kr)?kr?Cr?new $(Cr.thisDep,Cr.contextDep,Cr.propDep,function(wn,kn){return kn.def(wn.ELEMENTS,".vertCount-",wn.OFFSET)}):H(function(wn,kn){return kn.def(wn.ELEMENTS,".vertCount")}):H(function(){return-1}):new $(kr.thisDep||Cr.thisDep,kr.contextDep||Cr.contextDep,kr.propDep||Cr.propDep,function(wn,kn){var Pn=wn.ELEMENTS;return wn.OFFSET?kn.def(Pn,"?",Pn,".vertCount-",wn.OFFSET,":-1"):kn.def(Pn,"?",Pn,".vertCount:-1")}):Er?new $(xr.thisDep,xr.contextDep,xr.propDep,function(wn,kn){return kn.def(wn.shared.vao,".currentVAO?",wn.shared.vao,".currentVAO.count:-1")}):null}(),Qr=dr("instances",!1);return{elements:kr,primitive:Gr,count:qr,instances:Qr,offset:Cr,vao:xr,vaoActive:Er,elementsActive:_r,static:zr}}function pr(It,lr){var dr=It.static,Br=It.dynamic,Fr={};return Object.keys(dr).forEach(function(zr){var Er=dr[zr],xr=be.id(zr),_r=new _n;if(Q(Er))_r.state=1,_r.buffer=Ke.getBuffer(Ke.create(Er,34962,!1,!0)),_r.type=0;else if(Cr=Ke.getBuffer(Er))_r.state=1,_r.buffer=Cr,_r.type=0;else if("constant"in Er){var kr=Er.constant;_r.buffer="null",_r.state=2,typeof kr=="number"?_r.x=kr:qt.forEach(function(wn,kn){kn<kr.length&&(_r[wn]=kr[kn])})}else{var Cr=Q(Er.buffer)?Ke.getBuffer(Ke.create(Er.buffer,34962,!1,!0)):Ke.getBuffer(Er.buffer),Gr=0|Er.offset,qr=0|Er.stride,Qr=0|Er.size,rn=!!Er.normalized,yn=0;"type"in Er&&(yn=fe[Er.type]),Er=0|Er.divisor,_r.buffer=Cr,_r.state=1,_r.size=Qr,_r.normalized=rn,_r.type=yn||Cr.dtype,_r.offset=Gr,_r.stride=qr,_r.divisor=Er}Fr[zr]=H(function(wn,kn){var Pn=wn.attribCache;if(xr in Pn)return Pn[xr];var Dn={isStream:!1};return Object.keys(_r).forEach(function(Zn){Dn[Zn]=_r[Zn]}),_r.buffer&&(Dn.buffer=wn.link(_r.buffer),Dn.type=Dn.type||Dn.buffer+".dtype"),Pn[xr]=Dn})}),Object.keys(Br).forEach(function(zr){var Er=Br[zr];Fr[zr]=N(Er,function(xr,_r){function kr(Pn){_r(rn[Pn],"=",Cr,".",Pn,"|0;")}var Cr=xr.invoke(_r,Er),Gr=xr.shared,qr=xr.constants,Qr=Gr.isBufferArgs,rn=(Gr=Gr.buffer,{isStream:_r.def(!1)}),yn=new _n;yn.state=1,Object.keys(yn).forEach(function(Pn){rn[Pn]=_r.def(""+yn[Pn])});var wn=rn.buffer,kn=rn.type;return _r("if(",Qr,"(",Cr,")){",rn.isStream,"=true;",wn,"=",Gr,".createStream(",34962,",",Cr,");",kn,"=",wn,".dtype;","}else{",wn,"=",Gr,".getBuffer(",Cr,");","if(",wn,"){",kn,"=",wn,".dtype;",'}else if("constant" in ',Cr,"){",rn.state,"=",2,";","if(typeof "+Cr+'.constant === "number"){',rn[qt[0]],"=",Cr,".constant;",qt.slice(1).map(function(Pn){return rn[Pn]}).join("="),"=0;","}else{",qt.map(function(Pn,Dn){return rn[Pn]+"="+Cr+".constant.length>"+Dn+"?"+Cr+".constant["+Dn+"]:0;"}).join(""),"}}else{","if(",Qr,"(",Cr,".buffer)){",wn,"=",Gr,".createStream(",34962,",",Cr,".buffer);","}else{",wn,"=",Gr,".getBuffer(",Cr,".buffer);","}",kn,'="type" in ',Cr,"?",qr.glTypes,"[",Cr,".type]:",wn,".dtype;",rn.normalized,"=!!",Cr,".normalized;"),kr("size"),kr("offset"),kr("stride"),kr("divisor"),_r("}}"),_r.exit("if(",rn.isStream,"){",Gr,".destroyStream(",wn,");","}"),rn})}),Fr}function Mr(It,lr,dr,Br,Fr){function zr(yn){var wn=xr[yn];wn&&(kr[yn]=wn)}var Er=function(yn,wn){if(typeof(kn=yn.static).frag=="string"&&typeof kn.vert=="string"){if(0<Object.keys(wn.dynamic).length)return null;var kn=wn.static,Pn=Object.keys(kn);if(0<Pn.length&&typeof kn[Pn[0]]=="number"){for(var Dn=[],Zn=0;Zn<Pn.length;++Zn)Dn.push([0|kn[Pn[Zn]],Pn[Zn]]);return Dn}}return null}(It,lr),xr=function(yn,wn,kn){function Pn(Mi){if(Mi in Dn){var En=Dn[Mi];Mi=!0;var Qn,Jn,Di=0|En.x,va=0|En.y;return"width"in En?Qn=0|En.width:Mi=!1,"height"in En?Jn=0|En.height:Mi=!1,new $(!Mi&&wn&&wn.thisDep,!Mi&&wn&&wn.contextDep,!Mi&&wn&&wn.propDep,function(mo,Wi){var Zi=mo.shared.context,to=Qn;"width"in En||(to=Wi.def(Zi,".","framebufferWidth","-",Di));var Ni=Jn;return"height"in En||(Ni=Wi.def(Zi,".","framebufferHeight","-",va)),[Di,va,to,Ni]})}if(Mi in Zn){var Ba=Zn[Mi];return Mi=N(Ba,function(mo,Wi){var Zi=mo.invoke(Wi,Ba),to=mo.shared.context,Ni=Wi.def(Zi,".x|0"),go=Wi.def(Zi,".y|0");return[Ni,go,Wi.def('"width" in ',Zi,"?",Zi,".width|0:","(",to,".","framebufferWidth","-",Ni,")"),Zi=Wi.def('"height" in ',Zi,"?",Zi,".height|0:","(",to,".","framebufferHeight","-",go,")")]}),wn&&(Mi.thisDep=Mi.thisDep||wn.thisDep,Mi.contextDep=Mi.contextDep||wn.contextDep,Mi.propDep=Mi.propDep||wn.propDep),Mi}return wn?new $(wn.thisDep,wn.contextDep,wn.propDep,function(mo,Wi){var Zi=mo.shared.context;return[0,0,Wi.def(Zi,".","framebufferWidth"),Wi.def(Zi,".","framebufferHeight")]}):null}var Dn=yn.static,Zn=yn.dynamic;if(yn=Pn("viewport")){var Ai=yn;yn=new $(yn.thisDep,yn.contextDep,yn.propDep,function(Mi,En){var Qn=Ai.append(Mi,En),Jn=Mi.shared.context;return En.set(Jn,".viewportWidth",Qn[2]),En.set(Jn,".viewportHeight",Qn[3]),Qn})}return{viewport:yn,scissor_box:Pn("scissor.box")}}(It,Gr=Ut(It)),_r=Ht(It),kr=function(yn,wn){var kn=yn.static,Pn=yn.dynamic,Dn={};return Gn.forEach(function(Zn){function Ai(En,Qn){if(Zn in kn){var Jn=En(kn[Zn]);Dn[Mi]=H(function(){return Jn})}else if(Zn in Pn){var Di=Pn[Zn];Dn[Mi]=N(Di,function(va,Ba){return Qn(va,Ba,va.invoke(Ba,Di))})}}var Mi=Ze(Zn);switch(Zn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return Ai(function(En){return En},function(En,Qn,Jn){return Jn});case"depth.func":return Ai(function(En){return ar[En]},function(En,Qn,Jn){return Qn.def(En.constants.compareFuncs,"[",Jn,"]")});case"depth.range":return Ai(function(En){return En},function(En,Qn,Jn){return[Qn.def("+",Jn,"[0]"),Qn=Qn.def("+",Jn,"[1]")]});case"blend.func":return Ai(function(En){return[Wt["srcRGB"in En?En.srcRGB:En.src],Wt["dstRGB"in En?En.dstRGB:En.dst],Wt["srcAlpha"in En?En.srcAlpha:En.src],Wt["dstAlpha"in En?En.dstAlpha:En.dst]]},function(En,Qn,Jn){function Di(Wi,Zi){return Qn.def('"',Wi,Zi,'" in ',Jn,"?",Jn,".",Wi,Zi,":",Jn,".",Wi)}En=En.constants.blendFuncs;var va=Di("src","RGB"),Ba=Di("dst","RGB"),mo=(va=Qn.def(En,"[",va,"]"),Qn.def(En,"[",Di("src","Alpha"),"]"));return[va,Ba=Qn.def(En,"[",Ba,"]"),mo,En=Qn.def(En,"[",Di("dst","Alpha"),"]")]});case"blend.equation":return Ai(function(En){return typeof En=="string"?[ti[En],ti[En]]:typeof En=="object"?[ti[En.rgb],ti[En.alpha]]:void 0},function(En,Qn,Jn){var Di=En.constants.blendEquations,va=Qn.def(),Ba=Qn.def();return(En=En.cond("typeof ",Jn,'==="string"')).then(va,"=",Ba,"=",Di,"[",Jn,"];"),En.else(va,"=",Di,"[",Jn,".rgb];",Ba,"=",Di,"[",Jn,".alpha];"),Qn(En),[va,Ba]});case"blend.color":return Ai(function(En){return t(4,function(Qn){return+En[Qn]})},function(En,Qn,Jn){return t(4,function(Di){return Qn.def("+",Jn,"[",Di,"]")})});case"stencil.mask":return Ai(function(En){return 0|En},function(En,Qn,Jn){return Qn.def(Jn,"|0")});case"stencil.func":return Ai(function(En){return[ar[En.cmp||"keep"],En.ref||0,"mask"in En?En.mask:-1]},function(En,Qn,Jn){return[En=Qn.def('"cmp" in ',Jn,"?",En.constants.compareFuncs,"[",Jn,".cmp]",":",7680),Qn.def(Jn,".ref|0"),Qn=Qn.def('"mask" in ',Jn,"?",Jn,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return Ai(function(En){return[Zn==="stencil.opBack"?1029:1028,Dt[En.fail||"keep"],Dt[En.zfail||"keep"],Dt[En.zpass||"keep"]]},function(En,Qn,Jn){function Di(Ba){return Qn.def('"',Ba,'" in ',Jn,"?",va,"[",Jn,".",Ba,"]:",7680)}var va=En.constants.stencilOps;return[Zn==="stencil.opBack"?1029:1028,Di("fail"),Di("zfail"),Di("zpass")]});case"polygonOffset.offset":return Ai(function(En){return[0|En.factor,0|En.units]},function(En,Qn,Jn){return[Qn.def(Jn,".factor|0"),Qn=Qn.def(Jn,".units|0")]});case"cull.face":return Ai(function(En){var Qn=0;return En==="front"?Qn=1028:En==="back"&&(Qn=1029),Qn},function(En,Qn,Jn){return Qn.def(Jn,'==="front"?',1028,":",1029)});case"lineWidth":return Ai(function(En){return En},function(En,Qn,Jn){return Jn});case"frontFace":return Ai(function(En){return Ne[En]},function(En,Qn,Jn){return Qn.def(Jn+'==="cw"?2304:2305')});case"colorMask":return Ai(function(En){return En.map(function(Qn){return!!Qn})},function(En,Qn,Jn){return t(4,function(Di){return"!!"+Jn+"["+Di+"]"})});case"sample.coverage":return Ai(function(En){return["value"in En?En.value:1,!!En.invert]},function(En,Qn,Jn){return[Qn.def('"value" in ',Jn,"?+",Jn,".value:1"),Qn=Qn.def("!!",Jn,".invert")]})}}),Dn}(It),Cr=Kt(It,0,Er);zr("viewport"),zr(Ze("scissor.box"));var Gr,qr=0<Object.keys(kr).length;if((Gr={framebuffer:Gr,draw:_r,shader:Cr,state:kr,dirty:qr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(yn){var wn,kn=yn.static;if(yn=yn.dynamic,"profile"in kn){var Pn=!!kn.profile;(wn=H(function(Zn,Ai){return Pn})).enable=Pn}else if("profile"in yn){var Dn=yn.profile;wn=N(Dn,function(Zn,Ai){return Zn.invoke(Ai,Dn)})}return wn}(It),Gr.uniforms=function(yn,wn){var kn=yn.static,Pn=yn.dynamic,Dn={};return Object.keys(kn).forEach(function(Zn){var Ai,Mi=kn[Zn];if(typeof Mi=="number"||typeof Mi=="boolean")Ai=H(function(){return Mi});else if(typeof Mi=="function"){var En=Mi._reglType;En==="texture2d"||En==="textureCube"?Ai=H(function(Qn){return Qn.link(Mi)}):En!=="framebuffer"&&En!=="framebufferCube"||(Ai=H(function(Qn){return Qn.link(Mi.color[0])}))}else c(Mi)&&(Ai=H(function(Qn){return Qn.global.def("[",t(Mi.length,function(Jn){return Mi[Jn]}),"]")}));Ai.value=Mi,Dn[Zn]=Ai}),Object.keys(Pn).forEach(function(Zn){var Ai=Pn[Zn];Dn[Zn]=N(Ai,function(Mi,En){return Mi.invoke(En,Ai)})}),Dn}(dr),Gr.drawVAO=Gr.scopeVAO=_r.vao,!Gr.drawVAO&&Cr.program&&!Er&&Fe.angle_instanced_arrays&&_r.static.elements){var Qr=!0;if(It=Cr.program.attributes.map(function(yn){return yn=lr.static[yn],Qr=Qr&&!!yn,yn}),Qr&&0<It.length){var rn=Ot.getVAO(Ot.createVAO({attributes:It,elements:_r.static.elements}));Gr.drawVAO=new $(null,null,null,function(yn,wn){return yn.link(rn)}),Gr.useVAO=!0}}return Er?Gr.useVAO=!0:Gr.attributes=pr(lr),Gr.context=function(yn){var wn=yn.static,kn=yn.dynamic,Pn={};return Object.keys(wn).forEach(function(Dn){var Zn=wn[Dn];Pn[Dn]=H(function(Ai,Mi){return typeof Zn=="number"||typeof Zn=="boolean"?""+Zn:Ai.link(Zn)})}),Object.keys(kn).forEach(function(Dn){var Zn=kn[Dn];Pn[Dn]=N(Zn,function(Ai,Mi){return Ai.invoke(Mi,Zn)})}),Pn}(Br),Gr}function hr(It,lr,dr){var Br=It.shared.context,Fr=It.scope();Object.keys(dr).forEach(function(zr){lr.save(Br,"."+zr);var Er=dr[zr].append(It,lr);Array.isArray(Er)?Fr(Br,".",zr,"=[",Er.join(),"];"):Fr(Br,".",zr,"=",Er,";")}),lr(Fr)}function Qt(It,lr,dr,Br){var Fr,zr=(xr=It.shared).gl,Er=xr.framebuffer;nn&&(Fr=lr.def(xr.extensions,".webgl_draw_buffers"));var xr=(_r=It.constants).drawBuffer,_r=_r.backBuffer;It=dr?dr.append(It,lr):lr.def(Er,".next"),Br||lr("if(",It,"!==",Er,".cur){"),lr("if(",It,"){",zr,".bindFramebuffer(",36160,",",It,".framebuffer);"),nn&&lr(Fr,".drawBuffersWEBGL(",xr,"[",It,".colorAttachments.length]);"),lr("}else{",zr,".bindFramebuffer(",36160,",null);"),nn&&lr(Fr,".drawBuffersWEBGL(",_r,");"),lr("}",Er,".cur=",It,";"),Br||lr("}")}function tr(It,lr,dr){var Br=It.shared,Fr=Br.gl,zr=It.current,Er=It.next,xr=Br.current,_r=Br.next,kr=It.cond(xr,".dirty");Gn.forEach(function(Cr){var Gr,qr;if(!((Cr=Ze(Cr))in dr.state))if(Cr in Er){Gr=Er[Cr],qr=zr[Cr];var Qr=t(en[Cr].length,function(rn){return kr.def(Gr,"[",rn,"]")});kr(It.cond(Qr.map(function(rn,yn){return rn+"!=="+qr+"["+yn+"]"}).join("||")).then(Fr,".",Cn[Cr],"(",Qr,");",Qr.map(function(rn,yn){return qr+"["+yn+"]="+rn}).join(";"),";"))}else Gr=kr.def(_r,".",Cr),Qr=It.cond(Gr,"!==",xr,".",Cr),kr(Qr),Cr in Tn?Qr(It.cond(Gr).then(Fr,".enable(",Tn[Cr],");").else(Fr,".disable(",Tn[Cr],");"),xr,".",Cr,"=",Gr,";"):Qr(Fr,".",Cn[Cr],"(",Gr,");",xr,".",Cr,"=",Gr,";")}),Object.keys(dr.state).length===0&&kr(xr,".dirty=false;"),lr(kr)}function rr(It,lr,dr,Br){var Fr,zr=It.shared,Er=It.current,xr=zr.current,_r=zr.gl;K(Object.keys(dr)).forEach(function(kr){var Cr=dr[kr];if(!Br||Br(Cr)){var Gr=Cr.append(It,lr);if(Tn[kr]){var qr=Tn[kr];ne(Cr)?(Fr=It.link(Gr,{stable:!0}),lr(It.cond(Fr).then(_r,".enable(",qr,");").else(_r,".disable(",qr,");")),lr(xr,".",kr,"=",Fr,";")):(lr(It.cond(Gr).then(_r,".enable(",qr,");").else(_r,".disable(",qr,");")),lr(xr,".",kr,"=",Gr,";"))}else if(c(Gr)){var Qr=Er[kr];lr(_r,".",Cn[kr],"(",Gr,");",Gr.map(function(rn,yn){return Qr+"["+yn+"]="+rn}).join(";"),";")}else ne(Cr)?(Fr=It.link(Gr,{stable:!0}),lr(_r,".",Cn[kr],"(",Fr,");",xr,".",kr,"=",Fr,";")):lr(_r,".",Cn[kr],"(",Gr,");",xr,".",kr,"=",Gr,";")}})}function fr(It,lr){jr&&(It.instancing=lr.def(It.shared.extensions,".angle_instanced_arrays"))}function yr(It,lr,dr,Br,Fr){function zr(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Er(yn){yn(kr=lr.def(),"=",zr(),";"),typeof Fr=="string"?yn(qr,".count+=",Fr,";"):yn(qr,".count++;"),kt&&(Br?yn(Cr=lr.def(),"=",rn,".getNumPendingQueries();"):yn(rn,".beginQuery(",qr,");"))}function xr(yn){yn(qr,".cpuTime+=",zr(),"-",kr,";"),kt&&(Br?yn(rn,".pushScopeStats(",Cr,",",rn,".getNumPendingQueries(),",qr,");"):yn(rn,".endQuery();"))}function _r(yn){var wn=lr.def(Qr,".profile");lr(Qr,".profile=",yn,";"),lr.exit(Qr,".profile=",wn,";")}var kr,Cr,Gr=It.shared,qr=It.stats,Qr=Gr.current,rn=Gr.timer;if(dr=dr.profile){if(ne(dr))return void(dr.enable?(Er(lr),xr(lr.exit),_r("true")):_r("false"));_r(dr=dr.append(It,lr))}else dr=lr.def(Qr,".profile");Er(Gr=It.block()),lr("if(",dr,"){",Gr,"}"),xr(It=It.block()),lr.exit("if(",dr,"){",It,"}")}function Sr(It,lr,dr,Br,Fr){function zr(xr,_r,kr){function Cr(){lr("if(!",rn,".buffer){",qr,".enableVertexAttribArray(",Qr,");}");var Pn,Dn=kr.type;Pn=kr.size?lr.def(kr.size,"||",_r):_r,lr("if(",rn,".type!==",Dn,"||",rn,".size!==",Pn,"||",kn.map(function(Zn){return rn+"."+Zn+"!=="+kr[Zn]}).join("||"),"){",qr,".bindBuffer(",34962,",",yn,".buffer);",qr,".vertexAttribPointer(",[Qr,Pn,Dn,kr.normalized,kr.stride,kr.offset],");",rn,".type=",Dn,";",rn,".size=",Pn,";",kn.map(function(Zn){return rn+"."+Zn+"="+kr[Zn]+";"}).join(""),"}"),jr&&(Dn=kr.divisor,lr("if(",rn,".divisor!==",Dn,"){",It.instancing,".vertexAttribDivisorANGLE(",[Qr,Dn],");",rn,".divisor=",Dn,";}"))}function Gr(){lr("if(",rn,".buffer){",qr,".disableVertexAttribArray(",Qr,");",rn,".buffer=null;","}if(",qt.map(function(Pn,Dn){return rn+"."+Pn+"!=="+wn[Dn]}).join("||"),"){",qr,".vertexAttrib4f(",Qr,",",wn,");",qt.map(function(Pn,Dn){return rn+"."+Pn+"="+wn[Dn]+";"}).join(""),"}")}var qr=Er.gl,Qr=lr.def(xr,".location"),rn=lr.def(Er.attributes,"[",Qr,"]");xr=kr.state;var yn=kr.buffer,wn=[kr.x,kr.y,kr.z,kr.w],kn=["buffer","normalized","offset","stride"];xr===1?Cr():xr===2?Gr():(lr("if(",xr,"===",1,"){"),Cr(),lr("}else{"),Gr(),lr("}"))}var Er=It.shared;Br.forEach(function(xr){var _r,kr=xr.name,Cr=dr.attributes[kr];if(Cr){if(!Fr(Cr))return;_r=Cr.append(It,lr)}else{if(!Fr(qe))return;var Gr=It.scopeAttrib(kr);_r={},Object.keys(new _n).forEach(function(qr){_r[qr]=lr.def(Gr,".",qr)})}zr(It.link(xr),function(qr){switch(qr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(xr.info.type),_r)})}function Dr(It,lr,dr,Br,Fr,zr){for(var Er,xr=It.shared,_r=xr.gl,kr=0;kr<Br.length;++kr){var Cr,Gr=(rn=Br[kr]).name,qr=rn.info.type,Qr=dr.uniforms[Gr],rn=It.link(rn)+".location";if(Qr){if(!Fr(Qr))continue;if(ne(Qr)){if(Gr=Qr.value,qr===35678||qr===35680)lr(_r,".uniform1i(",rn,",",(qr=It.link(Gr._texture||Gr.color[0]._texture))+".bind());"),lr.exit(qr,".unbind();");else if(qr===35674||qr===35675||qr===35676)Qr=2,qr===35675?Qr=3:qr===35676&&(Qr=4),lr(_r,".uniformMatrix",Qr,"fv(",rn,",false,",Gr=It.global.def("new Float32Array(["+Array.prototype.slice.call(Gr)+"])"),");");else{switch(qr){case 5126:Er="1f";break;case 35664:Er="2f";break;case 35665:Er="3f";break;case 35666:Er="4f";break;case 35670:case 5124:Er="1i";break;case 35671:case 35667:Er="2i";break;case 35672:case 35668:Er="3i";break;case 35673:Er="4i";break;case 35669:Er="4i"}lr(_r,".uniform",Er,"(",rn,",",c(Gr)?Array.prototype.slice.call(Gr):Gr,");")}continue}Cr=Qr.append(It,lr)}else{if(!Fr(qe))continue;Cr=lr.def(xr.uniforms,"[",be.id(Gr),"]")}switch(qr===35678?lr("if(",Cr,"&&",Cr,'._reglType==="framebuffer"){',Cr,"=",Cr,".color[0];","}"):qr===35680&&lr("if(",Cr,"&&",Cr,'._reglType==="framebufferCube"){',Cr,"=",Cr,".color[0];","}"),Gr=1,qr){case 35678:case 35680:qr=lr.def(Cr,"._texture"),lr(_r,".uniform1i(",rn,",",qr,".bind());"),lr.exit(qr,".unbind();");continue;case 5124:case 35670:Er="1i";break;case 35667:case 35671:Er="2i",Gr=2;break;case 35668:case 35672:Er="3i",Gr=3;break;case 35669:case 35673:Er="4i",Gr=4;break;case 5126:Er="1f";break;case 35664:Er="2f",Gr=2;break;case 35665:Er="3f",Gr=3;break;case 35666:Er="4f",Gr=4;break;case 35674:Er="Matrix2fv";break;case 35675:Er="Matrix3fv";break;case 35676:Er="Matrix4fv"}if(Er.charAt(0)==="M"){lr(_r,".uniform",Er,"(",rn,","),rn=Math.pow(qr-35674+2,2);var yn=It.global.def("new Float32Array(",rn,")");Array.isArray(Cr)?lr("false,(",t(rn,function(kn){return yn+"["+kn+"]="+Cr[kn]}),",",yn,")"):lr("false,(Array.isArray(",Cr,")||",Cr," instanceof Float32Array)?",Cr,":(",t(rn,function(kn){return yn+"["+kn+"]="+Cr+"["+kn+"]"}),",",yn,")"),lr(");")}else{if(1<Gr){qr=[];var wn=[];for(Qr=0;Qr<Gr;++Qr)Array.isArray(Cr)?wn.push(Cr[Qr]):wn.push(lr.def(Cr+"["+Qr+"]")),zr&&qr.push(lr.def());zr&&lr("if(!",It.batchId,"||",qr.map(function(kn,Pn){return kn+"!=="+wn[Pn]}).join("||"),"){",qr.map(function(kn,Pn){return kn+"="+wn[Pn]+";"}).join("")),lr(_r,".uniform",Er,"(",rn,",",wn.join(","),");")}else zr&&(qr=lr.def(),lr("if(!",It.batchId,"||",qr,"!==",Cr,"){",qr,"=",Cr,";")),lr(_r,".uniform",Er,"(",rn,",",Cr,");");zr&&lr("}")}}}function Nr(It,lr,dr,Br){function Fr(Dn){var Zn=qr[Dn];return Zn?Zn.contextDep&&Br.contextDynamic||Zn.propDep?Zn.append(It,dr):Zn.append(It,lr):lr.def(Gr,".",Dn)}function zr(){function Dn(){dr(_r,".drawElementsInstancedANGLE(",[rn,wn,kn,yn+"<<(("+kn+"-5121)>>1)",xr],");")}function Zn(){dr(_r,".drawArraysInstancedANGLE(",[rn,yn,wn,xr],");")}Qr&&Qr!=="null"?Pn?Dn():(dr("if(",Qr,"){"),Dn(),dr("}else{"),Zn(),dr("}")):Zn()}function Er(){function Dn(){dr(Cr+".drawElements("+[rn,wn,kn,yn+"<<(("+kn+"-5121)>>1)"]+");")}function Zn(){dr(Cr+".drawArrays("+[rn,yn,wn]+");")}Qr&&Qr!=="null"?Pn?Dn():(dr("if(",Qr,"){"),Dn(),dr("}else{"),Zn(),dr("}")):Zn()}var xr,_r,kr=It.shared,Cr=kr.gl,Gr=kr.draw,qr=Br.draw,Qr=function(){var Dn=qr.elements,Zn=lr;return Dn?((Dn.contextDep&&Br.contextDynamic||Dn.propDep)&&(Zn=dr),Dn=Dn.append(It,Zn),qr.elementsActive&&Zn("if("+Dn+")"+Cr+".bindBuffer(34963,"+Dn+".buffer.buffer);")):(Dn=Zn.def(),Zn(Dn,"=",Gr,".","elements",";","if(",Dn,"){",Cr,".bindBuffer(",34963,",",Dn,".buffer.buffer);}","else if(",kr.vao,".currentVAO){",Dn,"=",It.shared.elements+".getElements("+kr.vao,".currentVAO.elements);",vn?"":"if("+Dn+")"+Cr+".bindBuffer(34963,"+Dn+".buffer.buffer);","}")),Dn}(),rn=Fr("primitive"),yn=Fr("offset"),wn=function(){var Dn=qr.count,Zn=lr;return Dn?((Dn.contextDep&&Br.contextDynamic||Dn.propDep)&&(Zn=dr),Dn=Dn.append(It,Zn)):Dn=Zn.def(Gr,".","count"),Dn}();if(typeof wn=="number"){if(wn===0)return}else dr("if(",wn,"){"),dr.exit("}");jr&&(xr=Fr("instances"),_r=It.instancing);var kn=Qr+".type",Pn=qr.elements&&ne(qr.elements)&&!qr.vaoActive;jr&&(typeof xr!="number"||0<=xr)?typeof xr=="string"?(dr("if(",xr,">0){"),zr(),dr("}else if(",xr,"<0){"),Er(),dr("}")):zr():Er()}function Wr(It,lr,dr,Br,Fr){return Fr=(lr=St()).proc("body",Fr),jr&&(lr.instancing=Fr.def(lr.shared.extensions,".angle_instanced_arrays")),It(lr,Fr,dr,Br),lr.compile().body}function hn(It,lr,dr,Br){fr(It,lr),dr.useVAO?dr.drawVAO?lr(It.shared.vao,".setVAO(",dr.drawVAO.append(It,lr),");"):lr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(lr(It.shared.vao,".setVAO(null);"),Sr(It,lr,dr,Br.attributes,function(){return!0})),Dr(It,lr,dr,Br.uniforms,function(){return!0},!1),Nr(It,lr,lr,dr)}function tn(It,lr,dr,Br){function Fr(){return!0}It.batchId="a1",fr(It,lr),Sr(It,lr,dr,Br.attributes,Fr),Dr(It,lr,dr,Br.uniforms,Fr,!1),Nr(It,lr,lr,dr)}function Fn(It,lr,dr,Br){function Fr(Gr){return Gr.contextDep&&Er||Gr.propDep}function zr(Gr){return!Fr(Gr)}fr(It,lr);var Er=dr.contextDep,xr=lr.def(),_r=lr.def();It.shared.props=_r,It.batchId=xr;var kr=It.scope(),Cr=It.scope();lr(kr.entry,"for(",xr,"=0;",xr,"<","a1",";++",xr,"){",_r,"=","a0","[",xr,"];",Cr,"}",kr.exit),dr.needsContext&&hr(It,Cr,dr.context),dr.needsFramebuffer&&Qt(It,Cr,dr.framebuffer),rr(It,Cr,dr.state,Fr),dr.profile&&Fr(dr.profile)&&yr(It,Cr,dr,!1,!0),Br?(dr.useVAO?dr.drawVAO?Fr(dr.drawVAO)?Cr(It.shared.vao,".setVAO(",dr.drawVAO.append(It,Cr),");"):kr(It.shared.vao,".setVAO(",dr.drawVAO.append(It,kr),");"):kr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(kr(It.shared.vao,".setVAO(null);"),Sr(It,kr,dr,Br.attributes,zr),Sr(It,Cr,dr,Br.attributes,Fr)),Dr(It,kr,dr,Br.uniforms,zr,!1),Dr(It,Cr,dr,Br.uniforms,Fr,!0),Nr(It,kr,Cr,dr)):(lr=It.global.def("{}"),Br=dr.shader.progVar.append(It,Cr),_r=Cr.def(Br,".id"),kr=Cr.def(lr,"[",_r,"]"),Cr(It.shared.gl,".useProgram(",Br,".program);","if(!",kr,"){",kr,"=",lr,"[",_r,"]=",It.link(function(Gr){return Wr(tn,It,dr,Gr,2)}),"(",Br,");}",kr,".call(this,a0[",xr,"],",xr,");"))}function an(It,lr){function dr(xr){var _r=lr.shader[xr];_r&&(_r=_r.append(It,Br),isNaN(_r)?Br.set(Fr.shader,"."+xr,_r):Br.set(Fr.shader,"."+xr,It.link(_r,{stable:!0})))}var Br=It.proc("scope",3);It.batchId="a2";var Fr=It.shared,zr=Fr.current;if(hr(It,Br,lr.context),lr.framebuffer&&lr.framebuffer.append(It,Br),K(Object.keys(lr.state)).forEach(function(xr){var _r=lr.state[xr],kr=_r.append(It,Br);c(kr)?kr.forEach(function(Cr,Gr){isNaN(Cr)?Br.set(It.next[xr],"["+Gr+"]",Cr):Br.set(It.next[xr],"["+Gr+"]",It.link(Cr,{stable:!0}))}):ne(_r)?Br.set(Fr.next,"."+xr,It.link(kr,{stable:!0})):Br.set(Fr.next,"."+xr,kr)}),yr(It,Br,lr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(xr){var _r=lr.draw[xr];_r&&(_r=_r.append(It,Br),isNaN(_r)?Br.set(Fr.draw,"."+xr,_r):Br.set(Fr.draw,"."+xr,It.link(_r),{stable:!0}))}),Object.keys(lr.uniforms).forEach(function(xr){var _r=lr.uniforms[xr].append(It,Br);Array.isArray(_r)&&(_r="["+_r.map(function(kr){return isNaN(kr)?kr:It.link(kr,{stable:!0})})+"]"),Br.set(Fr.uniforms,"["+It.link(be.id(xr),{stable:!0})+"]",_r)}),Object.keys(lr.attributes).forEach(function(xr){var _r=lr.attributes[xr].append(It,Br),kr=It.scopeAttrib(xr);Object.keys(new _n).forEach(function(Cr){Br.set(kr,"."+Cr,_r[Cr])})}),lr.scopeVAO){var Er=lr.scopeVAO.append(It,Br);isNaN(Er)?Br.set(Fr.vao,".targetVAO",Er):Br.set(Fr.vao,".targetVAO",It.link(Er,{stable:!0}))}dr("vert"),dr("frag"),0<Object.keys(lr.state).length&&(Br(zr,".dirty=true;"),Br.exit(zr,".dirty=true;")),Br("a1(",It.shared.context,",a0,",It.batchId,");")}function xn(It,lr,dr){var Br=lr.static[dr];if(Br&&function(Cr){if(typeof Cr=="object"&&!c(Cr)){for(var Gr=Object.keys(Cr),qr=0;qr<Gr.length;++qr)if(J.isDynamic(Cr[Gr[qr]]))return!0;return!1}}(Br)){var Fr=It.global,zr=Object.keys(Br),Er=!1,xr=!1,_r=!1,kr=It.global.def("{}");zr.forEach(function(Cr){var Gr=Br[Cr];if(J.isDynamic(Gr))typeof Gr=="function"&&(Gr=Br[Cr]=J.unbox(Gr)),Cr=N(Gr,null),Er=Er||Cr.thisDep,_r=_r||Cr.propDep,xr=xr||Cr.contextDep;else{switch(Fr(kr,".",Cr,"="),typeof Gr){case"number":Fr(Gr);break;case"string":Fr('"',Gr,'"');break;case"object":Array.isArray(Gr)&&Fr("[",Gr.join(),"]");break;default:Fr(It.link(Gr))}Fr(";")}}),lr.dynamic[dr]=new J.DynamicVariable(4,{thisDep:Er,contextDep:xr,propDep:_r,ref:kr,append:function(Cr,Gr){zr.forEach(function(qr){var Qr=Br[qr];J.isDynamic(Qr)&&(Qr=Cr.invoke(Gr,Qr),Gr(kr,".",qr,"=",Qr,";"))})}}),delete lr.static[dr]}}var _n=Ot.Record,ti={add:32774,subtract:32778,"reverse subtract":32779};Fe.ext_blend_minmax&&(ti.min=32775,ti.max=32776);var jr=Fe.angle_instanced_arrays,nn=Fe.webgl_draw_buffers,vn=Fe.oes_vertex_array_object,en={dirty:!0,profile:Ee.profile},fn={},Gn=[],Tn={},Cn={};at("dither",3024),at("blend.enable",3042),pt("blend.color","blendColor",[0,0,0,0]),pt("blend.equation","blendEquationSeparate",[32774,32774]),pt("blend.func","blendFuncSeparate",[1,0,1,0]),at("depth.enable",2929,!0),pt("depth.func","depthFunc",513),pt("depth.range","depthRange",[0,1]),pt("depth.mask","depthMask",!0),pt("colorMask","colorMask",[!0,!0,!0,!0]),at("cull.enable",2884),pt("cull.face","cullFace",1029),pt("frontFace","frontFace",2305),pt("lineWidth","lineWidth",1),at("polygonOffset.enable",32823),pt("polygonOffset.offset","polygonOffset",[0,0]),at("sample.alpha",32926),at("sample.enable",32928),pt("sample.coverage","sampleCoverage",[1,!1]),at("stencil.enable",2960),pt("stencil.mask","stencilMask",-1),pt("stencil.func","stencilFunc",[519,0,-1]),pt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),pt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),at("scissor.enable",3089),pt("scissor.box","scissor",[0,0,pe.drawingBufferWidth,pe.drawingBufferHeight]),pt("viewport","viewport",[0,0,pe.drawingBufferWidth,pe.drawingBufferHeight]);var oi={gl:pe,context:jt,strings:be,next:fn,current:en,draw:ht,elements:Ge,buffer:Ke,shader:it,attributes:Ot.state,vao:Ot,uniforms:Mt,framebuffer:st,extensions:Fe,timer:kt,isBufferArgs:Q},nr={primTypes:Te,compareFuncs:ar,blendFuncs:Wt,blendEquations:ti,stencilOps:Dt,glTypes:fe,orientationType:Ne};nn&&(nr.backBuffer=[1029],nr.drawBuffer=t(Ve.maxDrawbuffers,function(It){return It===0?[0]:t(It,function(lr){return 36064+lr})}));var vr=0;return{next:fn,current:en,procs:function(){var It=St(),lr=It.proc("poll"),dr=It.proc("refresh"),Br=It.block();lr(Br),dr(Br);var Fr,zr=(_r=It.shared).gl,Er=_r.next,xr=_r.current;Br(xr,".dirty=false;"),Qt(It,lr),Qt(It,dr,null,!0),jr&&(Fr=It.link(jr)),Fe.oes_vertex_array_object&&dr(It.link(Fe.oes_vertex_array_object),".bindVertexArrayOES(null);");var _r=dr.def(_r.attributes),kr=dr.def(0),Cr=It.cond(kr,".buffer");Cr.then(zr,".enableVertexAttribArray(i);",zr,".bindBuffer(",34962,",",kr,".buffer.buffer);",zr,".vertexAttribPointer(i,",kr,".size,",kr,".type,",kr,".normalized,",kr,".stride,",kr,".offset);").else(zr,".disableVertexAttribArray(i);",zr,".vertexAttrib4f(i,",kr,".x,",kr,".y,",kr,".z,",kr,".w);",kr,".buffer=null;");var Gr=It.link(Ve.maxAttributes,{stable:!0});return dr("for(var i=0;i<",Gr,";++i){",kr,"=",_r,"[i];",Cr,"}"),jr&&dr("for(var i=0;i<",Gr,";++i){",Fr,".vertexAttribDivisorANGLE(i,",_r,"[i].divisor);","}"),dr(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(Tn).forEach(function(qr){var Qr=Tn[qr],rn=Br.def(Er,".",qr),yn=It.block();yn("if(",rn,"){",zr,".enable(",Qr,")}else{",zr,".disable(",Qr,")}",xr,".",qr,"=",rn,";"),dr(yn),lr("if(",rn,"!==",xr,".",qr,"){",yn,"}")}),Object.keys(Cn).forEach(function(qr){var Qr,rn,yn=Cn[qr],wn=en[qr],kn=It.block();kn(zr,".",yn,"("),c(wn)?(yn=wn.length,Qr=It.global.def(Er,".",qr),rn=It.global.def(xr,".",qr),kn(t(yn,function(Pn){return Qr+"["+Pn+"]"}),");",t(yn,function(Pn){return rn+"["+Pn+"]="+Qr+"["+Pn+"];"}).join("")),lr("if(",t(yn,function(Pn){return Qr+"["+Pn+"]!=="+rn+"["+Pn+"]"}).join("||"),"){",kn,"}")):(Qr=Br.def(Er,".",qr),rn=Br.def(xr,".",qr),kn(Qr,");",xr,".",qr,"=",Qr,";"),lr("if(",Qr,"!==",rn,"){",kn,"}")),dr(kn)}),It.compile()}(),compile:function(It,lr,dr,Br,Fr){var zr=St();zr.stats=zr.link(Fr),Object.keys(lr.static).forEach(function(xr){xn(zr,lr,xr)}),Jt.forEach(function(xr){xn(zr,It,xr)});var Er=Mr(It,lr,dr,Br);return Er.shader.program&&(Er.shader.program.attributes.sort(function(xr,_r){return xr.name<_r.name?-1:1}),Er.shader.program.uniforms.sort(function(xr,_r){return xr.name<_r.name?-1:1})),function(xr,_r){var kr=xr.proc("draw",1);fr(xr,kr),hr(xr,kr,_r.context),Qt(xr,kr,_r.framebuffer),tr(xr,kr,_r),rr(xr,kr,_r.state),yr(xr,kr,_r,!1,!0);var Cr=_r.shader.progVar.append(xr,kr);if(kr(xr.shared.gl,".useProgram(",Cr,".program);"),_r.shader.program)hn(xr,kr,_r,_r.shader.program);else{kr(xr.shared.vao,".setVAO(null);");var Gr=xr.global.def("{}"),qr=kr.def(Cr,".id"),Qr=kr.def(Gr,"[",qr,"]");kr(xr.cond(Qr).then(Qr,".call(this,a0);").else(Qr,"=",Gr,"[",qr,"]=",xr.link(function(rn){return Wr(hn,xr,_r,rn,1)}),"(",Cr,");",Qr,".call(this,a0);"))}0<Object.keys(_r.state).length&&kr(xr.shared.current,".dirty=true;"),xr.shared.vao&&kr(xr.shared.vao,".setVAO(null);")}(zr,Er),an(zr,Er),function(xr,_r){function kr(wn){return wn.contextDep&&Gr||wn.propDep}var Cr=xr.proc("batch",2);xr.batchId="0",fr(xr,Cr);var Gr=!1,qr=!0;Object.keys(_r.context).forEach(function(wn){Gr=Gr||_r.context[wn].propDep}),Gr||(hr(xr,Cr,_r.context),qr=!1);var Qr=!1;if((rn=_r.framebuffer)?(rn.propDep?Gr=Qr=!0:rn.contextDep&&Gr&&(Qr=!0),Qr||Qt(xr,Cr,rn)):Qt(xr,Cr,null),_r.state.viewport&&_r.state.viewport.propDep&&(Gr=!0),tr(xr,Cr,_r),rr(xr,Cr,_r.state,function(wn){return!kr(wn)}),_r.profile&&kr(_r.profile)||yr(xr,Cr,_r,!1,"a1"),_r.contextDep=Gr,_r.needsContext=qr,_r.needsFramebuffer=Qr,(qr=_r.shader.progVar).contextDep&&Gr||qr.propDep)Fn(xr,Cr,_r,null);else if(qr=qr.append(xr,Cr),Cr(xr.shared.gl,".useProgram(",qr,".program);"),_r.shader.program)Fn(xr,Cr,_r,_r.shader.program);else{Cr(xr.shared.vao,".setVAO(null);");var rn=xr.global.def("{}"),yn=(Qr=Cr.def(qr,".id"),Cr.def(rn,"[",Qr,"]"));Cr(xr.cond(yn).then(yn,".call(this,a0,a1);").else(yn,"=",rn,"[",Qr,"]=",xr.link(function(wn){return Wr(Fn,xr,_r,wn,2)}),"(",qr,");",yn,".call(this,a0,a1);"))}0<Object.keys(_r.state).length&&Cr(xr.shared.current,".dirty=true;"),xr.shared.vao&&Cr(xr.shared.vao,".setVAO(null);")}(zr,Er),B(zr.compile(),{destroy:function(){Er.shader.program.destroy()}})}}}function te(pe,be){for(var Fe=0;Fe<pe.length;++Fe)if(pe[Fe]===be)return Fe;return-1}var B=function(pe,be){for(var Fe=Object.keys(be),Ve=0;Ve<Fe.length;++Ve)pe[Fe[Ve]]=be[Fe[Ve]];return pe},X=0,J={DynamicVariable:d,define:function(pe,be){return new d(pe,v(be+""))},isDynamic:function(pe){return typeof pe=="function"&&!pe._reglType||pe instanceof d},unbox:function pe(be,Fe){return typeof be=="function"?new d(0,be):typeof be=="number"||typeof be=="boolean"?new d(5,be):Array.isArray(be)?new d(6,be.map(function(Ve,Ke){return pe(Ve)})):be instanceof d?be:void 0},accessor:v},ee={next:typeof requestAnimationFrame=="function"?function(pe){return requestAnimationFrame(pe)}:function(pe){return setTimeout(pe,16)},cancel:typeof cancelAnimationFrame=="function"?function(pe){return cancelAnimationFrame(pe)}:clearTimeout},re=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},se=a();se.zero=a();var oe=function(pe,be){var Fe=1;be.ext_texture_filter_anisotropic&&(Fe=pe.getParameter(34047));var Ve=1,Ke=1;be.webgl_draw_buffers&&(Ve=pe.getParameter(34852),Ke=pe.getParameter(36063));var Ge=!!be.oes_texture_float;if(Ge){Ge=pe.createTexture(),pe.bindTexture(3553,Ge),pe.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var ct=pe.createFramebuffer();if(pe.bindFramebuffer(36160,ct),pe.framebufferTexture2D(36160,36064,3553,Ge,0),pe.bindTexture(3553,null),pe.checkFramebufferStatus(36160)!==36053)Ge=!1;else{pe.viewport(0,0,1,1),pe.clearColor(1,0,0,1),pe.clear(16384);var st=se.allocType(5126,4);pe.readPixels(0,0,1,1,6408,5126,st),pe.getError()?Ge=!1:(pe.deleteFramebuffer(ct),pe.deleteTexture(Ge),Ge=st[0]===1),se.freeType(st)}}return st=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(st=pe.createTexture(),ct=se.allocType(5121,36),pe.activeTexture(33984),pe.bindTexture(34067,st),pe.texImage2D(34069,0,6408,3,3,0,6408,5121,ct),se.freeType(ct),pe.bindTexture(34067,null),pe.deleteTexture(st),st=!pe.getError()),{colorBits:[pe.getParameter(3410),pe.getParameter(3411),pe.getParameter(3412),pe.getParameter(3413)],depthBits:pe.getParameter(3414),stencilBits:pe.getParameter(3415),subpixelBits:pe.getParameter(3408),extensions:Object.keys(be).filter(function(Mt){return!!be[Mt]}),maxAnisotropic:Fe,maxDrawbuffers:Ve,maxColorAttachments:Ke,pointSizeDims:pe.getParameter(33901),lineWidthDims:pe.getParameter(33902),maxViewportDims:pe.getParameter(3386),maxCombinedTextureUnits:pe.getParameter(35661),maxCubeMapSize:pe.getParameter(34076),maxRenderbufferSize:pe.getParameter(34024),maxTextureUnits:pe.getParameter(34930),maxTextureSize:pe.getParameter(3379),maxAttributes:pe.getParameter(34921),maxVertexUniforms:pe.getParameter(36347),maxVertexTextureUnits:pe.getParameter(35660),maxVaryingVectors:pe.getParameter(36348),maxFragmentUniforms:pe.getParameter(36349),glsl:pe.getParameter(35724),renderer:pe.getParameter(7937),vendor:pe.getParameter(7936),version:pe.getParameter(7938),readFloat:Ge,npotTextureCube:st}},de=function(pe){return pe instanceof Uint8Array||pe instanceof Uint16Array||pe instanceof Uint32Array||pe instanceof Int8Array||pe instanceof Int16Array||pe instanceof Int32Array||pe instanceof Float32Array||pe instanceof Float64Array||pe instanceof Uint8ClampedArray},ce=function(pe){return Object.keys(pe).map(function(be){return pe[be]})},ve={shape:function(pe){for(var be=[];pe.length;pe=pe[0])be.push(pe.length);return be},flatten:function(pe,be,Fe,Ve){var Ke=1;if(be.length)for(var Ge=0;Ge<be.length;++Ge)Ke*=be[Ge];else Ke=0;switch(Fe=Ve||se.allocType(Fe,Ke),be.length){case 0:break;case 1:for(Ve=be[0],be=0;be<Ve;++be)Fe[be]=pe[be];break;case 2:for(Ve=be[0],be=be[1],Ge=Ke=0;Ge<Ve;++Ge)for(var ct=pe[Ge],st=0;st<be;++st)Fe[Ke++]=ct[st];break;case 3:g(pe,be[0],be[1],be[2],Fe,0);break;default:(function Mt(Ot,it,ht,jt,kt){for(var Pt=1,Ee=ht+1;Ee<it.length;++Ee)Pt*=it[Ee];var Ze=it[ht];if(it.length-ht==4){var at=it[ht+1],pt=it[ht+2];for(it=it[ht+3],Ee=0;Ee<Ze;++Ee)g(Ot[Ee],at,pt,it,jt,kt),kt+=Pt}else for(Ee=0;Ee<Ze;++Ee)Mt(Ot[Ee],it,ht+1,jt,kt),kt+=Pt})(pe,be,0,Fe,0)}return Fe}},Ae={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},fe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},me={dynamic:35048,stream:35040,static:35044},_e=ve.flatten,le=ve.shape,ge=[];ge[5120]=1,ge[5122]=2,ge[5124]=4,ge[5121]=1,ge[5123]=2,ge[5125]=4,ge[5126]=4;var Te={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Se=new Float32Array(1),Me=new Uint32Array(Se.buffer),ze=[9984,9986,9985,9987],Oe=[0,6409,6410,6407,6408],De={};De[6409]=De[6406]=De[6402]=1,De[34041]=De[6410]=2,De[6407]=De[35904]=3,De[6408]=De[35906]=4;var Xe=i("HTMLCanvasElement"),Be=i("OffscreenCanvas"),Ie=i("CanvasRenderingContext2D"),Re=i("ImageBitmap"),Ye=i("HTMLImageElement"),Qe=i("HTMLVideoElement"),lt=Object.keys(Ae).concat([Xe,Be,Ie,Re,Ye,Qe]),xt=[];xt[5121]=1,xt[5126]=4,xt[36193]=2,xt[5123]=2,xt[5125]=4;var wt=[];wt[32854]=2,wt[32855]=2,wt[36194]=2,wt[34041]=4,wt[33776]=.5,wt[33777]=.5,wt[33778]=1,wt[33779]=1,wt[35986]=.5,wt[35987]=1,wt[34798]=1,wt[35840]=.5,wt[35841]=.25,wt[35842]=.5,wt[35843]=.25,wt[36196]=.5;var bt=[];bt[32854]=2,bt[32855]=2,bt[36194]=2,bt[33189]=2,bt[36168]=1,bt[34041]=4,bt[35907]=4,bt[34836]=16,bt[34842]=8,bt[34843]=6;var nt=function(pe,be,Fe,Ve,Ke){function Ge(ht){this.id=Ot++,this.refCount=1,this.renderbuffer=ht,this.format=32854,this.height=this.width=0,Ke.profile&&(this.stats={size:0})}function ct(ht){var jt=ht.renderbuffer;pe.bindRenderbuffer(36161,null),pe.deleteRenderbuffer(jt),ht.renderbuffer=null,ht.refCount=0,delete it[ht.id],Ve.renderbufferCount--}var st={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};be.ext_srgb&&(st.srgba=35907),be.ext_color_buffer_half_float&&(st.rgba16f=34842,st.rgb16f=34843),be.webgl_color_buffer_float&&(st.rgba32f=34836);var Mt=[];Object.keys(st).forEach(function(ht){Mt[st[ht]]=ht});var Ot=0,it={};return Ge.prototype.decRef=function(){0>=--this.refCount&&ct(this)},Ke.profile&&(Ve.getTotalRenderbufferSize=function(){var ht=0;return Object.keys(it).forEach(function(jt){ht+=it[jt].stats.size}),ht}),{create:function(ht,jt){function kt(Ee,Ze){var at=0,pt=0,St=32854;if(typeof Ee=="object"&&Ee?("shape"in Ee?(at=0|(pt=Ee.shape)[0],pt=0|pt[1]):("radius"in Ee&&(at=pt=0|Ee.radius),"width"in Ee&&(at=0|Ee.width),"height"in Ee&&(pt=0|Ee.height)),"format"in Ee&&(St=st[Ee.format])):typeof Ee=="number"?(at=0|Ee,pt=typeof Ze=="number"?0|Ze:at):Ee||(at=pt=1),at!==Pt.width||pt!==Pt.height||St!==Pt.format)return kt.width=Pt.width=at,kt.height=Pt.height=pt,Pt.format=St,pe.bindRenderbuffer(36161,Pt.renderbuffer),pe.renderbufferStorage(36161,St,at,pt),Ke.profile&&(Pt.stats.size=bt[Pt.format]*Pt.width*Pt.height),kt.format=Mt[Pt.format],kt}var Pt=new Ge(pe.createRenderbuffer());return it[Pt.id]=Pt,Ve.renderbufferCount++,kt(ht,jt),kt.resize=function(Ee,Ze){var at=0|Ee,pt=0|Ze||at;return at===Pt.width&&pt===Pt.height||(kt.width=Pt.width=at,kt.height=Pt.height=pt,pe.bindRenderbuffer(36161,Pt.renderbuffer),pe.renderbufferStorage(36161,Pt.format,at,pt),Ke.profile&&(Pt.stats.size=bt[Pt.format]*Pt.width*Pt.height)),kt},kt._reglType="renderbuffer",kt._renderbuffer=Pt,Ke.profile&&(kt.stats=Pt.stats),kt.destroy=function(){Pt.decRef()},kt},clear:function(){ce(it).forEach(ct)},restore:function(){ce(it).forEach(function(ht){ht.renderbuffer=pe.createRenderbuffer(),pe.bindRenderbuffer(36161,ht.renderbuffer),pe.renderbufferStorage(36161,ht.format,ht.width,ht.height)}),pe.bindRenderbuffer(36161,null)}}},$e=[];$e[6408]=4,$e[6407]=3;var vt=[];vt[5121]=1,vt[5126]=4,vt[36193]=2;var Nt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],qt=["x","y","z","w"],Jt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Wt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ar={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Dt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ne={cw:2304,ccw:2305},qe=new $(!1,!1,!1,function(){});return function(pe){function be(){if(tn.length===0)Ut&&Ut.update(),_n=null;else{_n=ee.next(be),it();for(var jr=tn.length-1;0<=jr;--jr){var nn=tn[jr];nn&&nn(Mr,null,0)}kt.flush(),Ut&&Ut.update()}}function Fe(){!_n&&0<tn.length&&(_n=ee.next(be))}function Ve(){_n&&(ee.cancel(be),_n=null)}function Ke(jr){jr.preventDefault(),Ve(),Fn.forEach(function(nn){nn()})}function Ge(jr){kt.getError(),Ee.restore(),fr.restore(),Qt.restore(),yr.restore(),Sr.restore(),Dr.restore(),rr.restore(),Ut&&Ut.restore(),Nr.procs.refresh(),Fe(),an.forEach(function(nn){nn()})}function ct(jr){function nn(It,lr){var dr={},Br={};return Object.keys(It).forEach(function(Fr){var zr=It[Fr];if(J.isDynamic(zr))Br[Fr]=J.unbox(zr,Fr);else{if(lr&&Array.isArray(zr)){for(var Er=0;Er<zr.length;++Er)if(J.isDynamic(zr[Er]))return void(Br[Fr]=J.unbox(zr,Fr))}dr[Fr]=zr}}),{dynamic:Br,static:dr}}var vn=nn(jr.context||{},!0),en=nn(jr.uniforms||{},!0),fn=nn(jr.attributes||{},!1);jr=nn(function(It){function lr(Br){if(Br in dr){var Fr=dr[Br];delete dr[Br],Object.keys(Fr).forEach(function(zr){dr[Br+"."+zr]=Fr[zr]})}}var dr=B({},It);return delete dr.uniforms,delete dr.attributes,delete dr.context,delete dr.vao,"stencil"in dr&&dr.stencil.op&&(dr.stencil.opBack=dr.stencil.opFront=dr.stencil.op,delete dr.stencil.op),lr("blend"),lr("depth"),lr("cull"),lr("stencil"),lr("polygonOffset"),lr("scissor"),lr("sample"),"vao"in It&&(dr.vao=It.vao),dr}(jr),!1);var Gn={gpuTime:0,cpuTime:0,count:0},Tn=Nr.compile(jr,fn,en,vn,Gn),Cn=Tn.draw,oi=Tn.batch,nr=Tn.scope,vr=[];return B(function(It,lr){var dr;if(typeof It=="function")return nr.call(this,null,It,0);if(typeof lr=="function")if(typeof It=="number")for(dr=0;dr<It;++dr)nr.call(this,null,lr,dr);else{if(!Array.isArray(It))return nr.call(this,It,lr,0);for(dr=0;dr<It.length;++dr)nr.call(this,It[dr],lr,dr)}else if(typeof It=="number"){if(0<It)return oi.call(this,function(Br){for(;vr.length<Br;)vr.push(null);return vr}(0|It),0|It)}else{if(!Array.isArray(It))return Cn.call(this,It);if(It.length)return oi.call(this,It,It.length)}},{stats:Gn,destroy:function(){Tn.destroy()}})}function st(jr,nn){var vn=0;Nr.procs.poll();var en=nn.color;en&&(kt.clearColor(+en[0]||0,+en[1]||0,+en[2]||0,+en[3]||0),vn|=16384),"depth"in nn&&(kt.clearDepth(+nn.depth),vn|=256),"stencil"in nn&&(kt.clearStencil(0|nn.stencil),vn|=1024),kt.clear(vn)}function Mt(jr){return tn.push(jr),Fe(),{cancel:function(){var nn=te(tn,jr);tn[nn]=function vn(){var en=te(tn,vn);tn[en]=tn[tn.length-1],--tn.length,0>=tn.length&&Ve()}}}}function Ot(){var jr=Wr.viewport,nn=Wr.scissor_box;jr[0]=jr[1]=nn[0]=nn[1]=0,Mr.viewportWidth=Mr.framebufferWidth=Mr.drawingBufferWidth=jr[2]=nn[2]=kt.drawingBufferWidth,Mr.viewportHeight=Mr.framebufferHeight=Mr.drawingBufferHeight=jr[3]=nn[3]=kt.drawingBufferHeight}function it(){Mr.tick+=1,Mr.time=jt(),Ot(),Nr.procs.poll()}function ht(){yr.refresh(),Ot(),Nr.procs.refresh(),Ut&&Ut.update()}function jt(){return(re()-Kt)/1e3}if(!(pe=e(pe)))return null;var kt=pe.gl,Pt=kt.getContextAttributes();kt.isContextLost();var Ee=function(jr,nn){function vn(Tn){var Cn;Tn=Tn.toLowerCase();try{Cn=en[Tn]=jr.getExtension(Tn)}catch{}return!!Cn}for(var en={},fn=0;fn<nn.extensions.length;++fn){var Gn=nn.extensions[fn];if(!vn(Gn))return nn.onDestroy(),nn.onDone('"'+Gn+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return nn.optionalExtensions.forEach(vn),{extensions:en,restore:function(){Object.keys(en).forEach(function(Tn){if(en[Tn]&&!vn(Tn))throw Error("(regl): error restoring extension "+Tn)})}}}(kt,pe);if(!Ee)return null;var Ze=function(){var jr={"":0},nn=[""];return{id:function(vn){var en=jr[vn];return en||(en=jr[vn]=nn.length,nn.push(vn),en)},str:function(vn){return nn[vn]}}}(),at={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},pt=pe.cachedCode||{},St=Ee.extensions,Ut=function(jr,nn){function vn(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function en(vr,It,lr){var dr=Tn.pop()||new vn;dr.startQueryIndex=vr,dr.endQueryIndex=It,dr.sum=0,dr.stats=lr,Cn.push(dr)}if(!nn.ext_disjoint_timer_query)return null;var fn=[],Gn=[],Tn=[],Cn=[],oi=[],nr=[];return{beginQuery:function(vr){var It=fn.pop()||nn.ext_disjoint_timer_query.createQueryEXT();nn.ext_disjoint_timer_query.beginQueryEXT(35007,It),Gn.push(It),en(Gn.length-1,Gn.length,vr)},endQuery:function(){nn.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:en,update:function(){var vr,It;if((vr=Gn.length)!==0){nr.length=Math.max(nr.length,vr+1),oi.length=Math.max(oi.length,vr+1),oi[0]=0;var lr=nr[0]=0;for(It=vr=0;It<Gn.length;++It){var dr=Gn[It];nn.ext_disjoint_timer_query.getQueryObjectEXT(dr,34919)?(lr+=nn.ext_disjoint_timer_query.getQueryObjectEXT(dr,34918),fn.push(dr)):Gn[vr++]=dr,oi[It+1]=lr,nr[It+1]=vr}for(Gn.length=vr,It=vr=0;It<Cn.length;++It){var Br=(lr=Cn[It]).startQueryIndex;dr=lr.endQueryIndex,lr.sum+=oi[dr]-oi[Br],Br=nr[Br],(dr=nr[dr])===Br?(lr.stats.gpuTime+=lr.sum/1e6,Tn.push(lr)):(lr.startQueryIndex=Br,lr.endQueryIndex=dr,Cn[vr++]=lr)}Cn.length=vr}},getNumPendingQueries:function(){return Gn.length},clear:function(){fn.push.apply(fn,Gn);for(var vr=0;vr<fn.length;vr++)nn.ext_disjoint_timer_query.deleteQueryEXT(fn[vr]);Gn.length=0,fn.length=0},restore:function(){Gn.length=0,fn.length=0}}}(0,St),Kt=re(),Ht=kt.drawingBufferWidth,pr=kt.drawingBufferHeight,Mr={tick:0,time:0,viewportWidth:Ht,viewportHeight:pr,framebufferWidth:Ht,framebufferHeight:pr,drawingBufferWidth:Ht,drawingBufferHeight:pr,pixelRatio:pe.pixelRatio},hr=(Ht={elements:null,primitive:4,count:-1,offset:0,instances:-1},oe(kt,St)),Qt=l(kt,at,pe,function(jr){return rr.destroyBuffer(jr)}),tr=o(kt,St,Qt,at),rr=P(kt,St,hr,at,Qt,tr,Ht),fr=S(kt,Ze,at,pe),yr=L(kt,St,hr,function(){Nr.procs.poll()},Mr,at,pe),Sr=nt(kt,St,0,at,pe),Dr=A(kt,St,hr,yr,Sr,at),Nr=U(kt,Ze,St,hr,Qt,tr,0,Dr,{},rr,fr,Ht,Mr,Ut,pt,pe),Wr=(Ze=E(kt,Dr,Nr.procs.poll,Mr),Nr.next),hn=kt.canvas,tn=[],Fn=[],an=[],xn=[pe.onDestroy],_n=null;hn&&(hn.addEventListener("webglcontextlost",Ke,!1),hn.addEventListener("webglcontextrestored",Ge,!1));var ti=Dr.setFBO=ct({framebuffer:J.define.call(null,1,"framebuffer")});return ht(),Pt=B(ct,{clear:function(jr){if("framebuffer"in jr)if(jr.framebuffer&&jr.framebuffer_reglType==="framebufferCube")for(var nn=0;6>nn;++nn)ti(B({framebuffer:jr.framebuffer.faces[nn]},jr),st);else ti(jr,st);else st(0,jr)},prop:J.define.bind(null,1),context:J.define.bind(null,2),this:J.define.bind(null,3),draw:ct({}),buffer:function(jr){return Qt.create(jr,34962,!1,!1)},elements:function(jr){return tr.create(jr,!1)},texture:yr.create2D,cube:yr.createCube,renderbuffer:Sr.create,framebuffer:Dr.create,framebufferCube:Dr.createCube,vao:rr.createVAO,attributes:Pt,frame:Mt,on:function(jr,nn){var vn;switch(jr){case"frame":return Mt(nn);case"lost":vn=Fn;break;case"restore":vn=an;break;case"destroy":vn=xn}return vn.push(nn),{cancel:function(){for(var en=0;en<vn.length;++en)if(vn[en]===nn){vn[en]=vn[vn.length-1],vn.pop();break}}}},limits:hr,hasExtension:function(jr){return 0<=hr.extensions.indexOf(jr.toLowerCase())},read:Ze,destroy:function(){tn.length=0,Ve(),hn&&(hn.removeEventListener("webglcontextlost",Ke),hn.removeEventListener("webglcontextrestored",Ge)),fr.clear(),Dr.clear(),Sr.clear(),rr.clear(),yr.clear(),tr.clear(),Qt.clear(),Ut&&Ut.clear(),xn.forEach(function(jr){jr()})},_gl:kt,_refresh:ht,poll:function(){it(),Ut&&Ut.update()},now:jt,stats:at,getCachedCode:function(){return pt},preloadCachedCode:function(jr){Object.entries(jr).forEach(function(nn){pt[nn[0]]=nn[1]})}}),pe.onDone(null,Pt),Pt}})},{}],285:[function(m,G,W){var d=m("buffer"),v=d.Buffer;function w(e,t){for(var n in e)t[n]=e[n]}function y(e,t,n){return v(e,t,n)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?G.exports=d:(w(d,W),W.Buffer=y),y.prototype=Object.create(v.prototype),w(v,y),y.from=function(e,t,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return v(e,t,n)},y.alloc=function(e,t,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var a=v(e);return t!==void 0?typeof n=="string"?a.fill(t,n):a.fill(t):a.fill(0),a},y.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return v(e)},y.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return d.SlowBuffer(e)}},{buffer:85}],286:[function(m,G,W){G.exports=v;var d=m("events").EventEmitter;function v(){d.call(this)}m("inherits")(v,d),v.Readable=m("readable-stream/lib/_stream_readable.js"),v.Writable=m("readable-stream/lib/_stream_writable.js"),v.Duplex=m("readable-stream/lib/_stream_duplex.js"),v.Transform=m("readable-stream/lib/_stream_transform.js"),v.PassThrough=m("readable-stream/lib/_stream_passthrough.js"),v.finished=m("readable-stream/lib/internal/streams/end-of-stream.js"),v.pipeline=m("readable-stream/lib/internal/streams/pipeline.js"),v.Stream=v,v.prototype.pipe=function(w,y){var e=this;function t(h){w.writable&&w.write(h)===!1&&e.pause&&e.pause()}function n(){e.readable&&e.resume&&e.resume()}e.on("data",t),w.on("drain",n),w._isStdio||y&&y.end===!1||(e.on("end",r),e.on("close",g));var a=!1;function r(){a||(a=!0,w.end())}function g(){a||(a=!0,typeof w.destroy=="function"&&w.destroy())}function u(h){if(s(),d.listenerCount(this,"error")===0)throw h}function s(){e.removeListener("data",t),w.removeListener("drain",n),e.removeListener("end",r),e.removeListener("close",g),e.removeListener("error",u),w.removeListener("error",u),e.removeListener("end",s),e.removeListener("close",s),w.removeListener("close",s)}return e.on("error",u),w.on("error",u),e.on("end",s),e.on("close",s),w.on("close",s),w.emit("pipe",e),w}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(m,G,W){var d={};function v(y,e,t){t||(t=Error);var n=function(a){var r,g;function u(s,h,l){return a.call(this,function(o,p,c){return typeof e=="string"?e:e(o,p,c)}(s,h,l))||this}return g=a,(r=u).prototype=Object.create(g.prototype),r.prototype.constructor=r,r.__proto__=g,u}(t);n.prototype.name=t.name,n.prototype.code=y,d[y]=n}function w(y,e){if(Array.isArray(y)){var t=y.length;return y=y.map(function(n){return String(n)}),t>2?"one of ".concat(e," ").concat(y.slice(0,t-1).join(", "),", or ")+y[t-1]:t===2?"one of ".concat(e," ").concat(y[0]," or ").concat(y[1]):"of ".concat(e," ").concat(y[0])}return"of ".concat(e," ").concat(String(y))}v("ERR_INVALID_OPT_VALUE",function(y,e){return'The value "'+e+'" is invalid for option "'+y+'"'},TypeError),v("ERR_INVALID_ARG_TYPE",function(y,e,t){var n,a,r;if(typeof e=="string"&&(a="not ",e.substr(0,a.length)===a)?(n="must not be",e=e.replace(/^not /,"")):n="must be",function(u,s,h){return(h===void 0||h>u.length)&&(h=u.length),u.substring(h-s.length,h)===s}(y," argument"))r="The ".concat(y," ").concat(n," ").concat(w(e,"type"));else{var g=function(u,s,h){return typeof h!="number"&&(h=0),!(h+s.length>u.length)&&u.indexOf(s,h)!==-1}(y,".")?"property":"argument";r='The "'.concat(y,'" ').concat(g," ").concat(n," ").concat(w(e,"type"))}return r+=". Received type ".concat(typeof t)},TypeError),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),v("ERR_METHOD_NOT_IMPLEMENTED",function(y){return"The "+y+" method is not implemented"}),v("ERR_STREAM_PREMATURE_CLOSE","Premature close"),v("ERR_STREAM_DESTROYED",function(y){return"Cannot call "+y+" after a stream was destroyed"}),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),v("ERR_STREAM_WRITE_AFTER_END","write after end"),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_UNKNOWN_ENCODING",function(y){return"Unknown encoding: "+y},TypeError),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),G.exports.codes=d},{}],288:[function(m,G,W){(function(d){(function(){var v=Object.keys||function(u){var s=[];for(var h in u)s.push(h);return s};G.exports=a;var w=m("./_stream_readable"),y=m("./_stream_writable");m("inherits")(a,w);for(var e=v(y.prototype),t=0;t<e.length;t++){var n=e[t];a.prototype[n]||(a.prototype[n]=y.prototype[n])}function a(u){if(!(this instanceof a))return new a(u);w.call(this,u),y.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",r)))}function r(){this._writableState.ended||d.nextTick(g,this)}function g(u){u.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}})}).call(this)}).call(this,m("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(m,G,W){G.exports=v;var d=m("./_stream_transform");function v(w){if(!(this instanceof v))return new v(w);d.call(this,w)}m("inherits")(v,d),v.prototype._transform=function(w,y,e){e(null,w)}},{"./_stream_transform":291,inherits:231}],290:[function(m,G,W){(function(d,v){(function(){var w;G.exports=k,k.ReadableState=T,m("events").EventEmitter;var y=function(H,N){return H.listeners(N).length},e=m("./internal/streams/stream"),t=m("buffer").Buffer,n=v.Uint8Array||function(){},a,r=m("util");a=r&&r.debuglog?r.debuglog("stream"):function(){};var g,u,s,h=m("./internal/streams/buffer_list"),l=m("./internal/streams/destroy"),o=m("./internal/streams/state").getHighWaterMark,p=m("../errors").codes,c=p.ERR_INVALID_ARG_TYPE,i=p.ERR_STREAM_PUSH_AFTER_EOF,x=p.ERR_METHOD_NOT_IMPLEMENTED,f=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;m("inherits")(k,e);var _=l.errorOrDestroy,b=["error","close","destroy","pause","resume"];function T(H,N,U){w=w||m("./_stream_duplex"),H=H||{},typeof U!="boolean"&&(U=N instanceof w),this.objectMode=!!H.objectMode,U&&(this.objectMode=this.objectMode||!!H.readableObjectMode),this.highWaterMark=o(this,H,"readableHighWaterMark",U),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.destroyed=!1,this.defaultEncoding=H.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,H.encoding&&(g||(g=m("string_decoder/").StringDecoder),this.decoder=new g(H.encoding),this.encoding=H.encoding)}function k(H){if(w=w||m("./_stream_duplex"),!(this instanceof k))return new k(H);var N=this instanceof w;this._readableState=new T(H,this,N),this.readable=!0,H&&(typeof H.read=="function"&&(this._read=H.read),typeof H.destroy=="function"&&(this._destroy=H.destroy)),e.call(this)}function L(H,N,U,te,B){a("readableAddChunk",N);var X,J=H._readableState;if(N===null)J.reading=!1,function(ee,re){if(a("onEofChunk"),!re.ended){if(re.decoder){var se=re.decoder.end();se&&se.length&&(re.buffer.push(se),re.length+=re.objectMode?1:se.length)}re.ended=!0,re.sync?P(ee):(re.needReadable=!1,re.emittedReadable||(re.emittedReadable=!0,S(ee)))}}(H,J);else if(B||(X=function(ee,re){var se;oe=re,t.isBuffer(oe)||oe instanceof n||typeof re=="string"||re===void 0||ee.objectMode||(se=new c("chunk",["string","Buffer","Uint8Array"],re));var oe;return se}(J,N)),X)_(H,X);else if(J.objectMode||N&&N.length>0)if(typeof N=="string"||J.objectMode||Object.getPrototypeOf(N)===t.prototype||(N=function(ee){return t.from(ee)}(N)),te)J.endEmitted?_(H,new f):A(H,J,N,!0);else if(J.ended)_(H,new i);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!U?(N=J.decoder.write(N),J.objectMode||N.length!==0?A(H,J,N,!1):E(H,J)):A(H,J,N,!1)}else te||(J.reading=!1,E(H,J));return!J.ended&&(J.length<J.highWaterMark||J.length===0)}function A(H,N,U,te){N.flowing&&N.length===0&&!N.sync?(N.awaitDrain=0,H.emit("data",U)):(N.length+=N.objectMode?1:U.length,te?N.buffer.unshift(U):N.buffer.push(U),N.needReadable&&P(H)),E(H,N)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(H){this._readableState&&(this._readableState.destroyed=H)}}),k.prototype.destroy=l.destroy,k.prototype._undestroy=l.undestroy,k.prototype._destroy=function(H,N){N(H)},k.prototype.push=function(H,N){var U,te=this._readableState;return te.objectMode?U=!0:typeof H=="string"&&((N=N||te.defaultEncoding)!==te.encoding&&(H=t.from(H,N),N=""),U=!0),L(this,H,N,!1,U)},k.prototype.unshift=function(H){return L(this,H,null,!0,!1)},k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(H){g||(g=m("string_decoder/").StringDecoder);var N=new g(H);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var U=this._readableState.buffer.head,te="";U!==null;)te+=N.write(U.data),U=U.next;return this._readableState.buffer.clear(),te!==""&&this._readableState.buffer.push(te),this._readableState.length=te.length,this};function I(H,N){return H<=0||N.length===0&&N.ended?0:N.objectMode?1:H!=H?N.flowing&&N.length?N.buffer.head.data.length:N.length:(H>N.highWaterMark&&(N.highWaterMark=function(U){return U>=1073741824?U=1073741824:(U--,U|=U>>>1,U|=U>>>2,U|=U>>>4,U|=U>>>8,U|=U>>>16,U++),U}(H)),H<=N.length?H:N.ended?N.length:(N.needReadable=!0,0))}function P(H){var N=H._readableState;a("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(a("emitReadable",N.flowing),N.emittedReadable=!0,d.nextTick(S,H))}function S(H){var N=H._readableState;a("emitReadable_",N.destroyed,N.length,N.ended),N.destroyed||!N.length&&!N.ended||(H.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,Z(H)}function E(H,N){N.readingMore||(N.readingMore=!0,d.nextTick(z,H,N))}function z(H,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&N.length===0);){var U=N.length;if(a("maybeReadMore read 0"),H.read(0),U===N.length)break}N.readingMore=!1}function D(H){var N=H._readableState;N.readableListening=H.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:H.listenerCount("data")>0&&H.resume()}function j(H){a("readable nexttick read 0"),H.read(0)}function V(H,N){a("resume",N.reading),N.reading||H.read(0),N.resumeScheduled=!1,H.emit("resume"),Z(H),N.flowing&&!N.reading&&H.read(0)}function Z(H){var N=H._readableState;for(a("flow",N.flowing);N.flowing&&H.read()!==null;);}function Q(H,N){return N.length===0?null:(N.objectMode?U=N.buffer.shift():!H||H>=N.length?(U=N.decoder?N.buffer.join(""):N.buffer.length===1?N.buffer.first():N.buffer.concat(N.length),N.buffer.clear()):U=N.buffer.consume(H,N.decoder),U);var U}function K(H){var N=H._readableState;a("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,d.nextTick($,N,H))}function $(H,N){if(a("endReadableNT",H.endEmitted,H.length),!H.endEmitted&&H.length===0&&(H.endEmitted=!0,N.readable=!1,N.emit("end"),H.autoDestroy)){var U=N._writableState;(!U||U.autoDestroy&&U.finished)&&N.destroy()}}function ne(H,N){for(var U=0,te=H.length;U<te;U++)if(H[U]===N)return U;return-1}k.prototype.read=function(H){a("read",H),H=parseInt(H,10);var N=this._readableState,U=H;if(H!==0&&(N.emittedReadable=!1),H===0&&N.needReadable&&((N.highWaterMark!==0?N.length>=N.highWaterMark:N.length>0)||N.ended))return a("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?K(this):P(this),null;if((H=I(H,N))===0&&N.ended)return N.length===0&&K(this),null;var te,B=N.needReadable;return a("need readable",B),(N.length===0||N.length-H<N.highWaterMark)&&a("length less than watermark",B=!0),N.ended||N.reading?a("reading or ended",B=!1):B&&(a("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(H=I(U,N))),(te=H>0?Q(H,N):null)===null?(N.needReadable=N.length<=N.highWaterMark,H=0):(N.length-=H,N.awaitDrain=0),N.length===0&&(N.ended||(N.needReadable=!0),U!==H&&N.ended&&K(this)),te!==null&&this.emit("data",te),te},k.prototype._read=function(H){_(this,new x("_read()"))},k.prototype.pipe=function(H,N){var U=this,te=this._readableState;switch(te.pipesCount){case 0:te.pipes=H;break;case 1:te.pipes=[te.pipes,H];break;default:te.pipes.push(H)}te.pipesCount+=1,a("pipe count=%d opts=%j",te.pipesCount,N);var B=(!N||N.end!==!1)&&H!==d.stdout&&H!==d.stderr?J:ve;function X(Ae,fe){a("onunpipe"),Ae===U&&fe&&fe.hasUnpiped===!1&&(fe.hasUnpiped=!0,a("cleanup"),H.removeListener("close",de),H.removeListener("finish",ce),H.removeListener("drain",ee),H.removeListener("error",oe),H.removeListener("unpipe",X),U.removeListener("end",J),U.removeListener("end",ve),U.removeListener("data",se),re=!0,!te.awaitDrain||H._writableState&&!H._writableState.needDrain||ee())}function J(){a("onend"),H.end()}te.endEmitted?d.nextTick(B):U.once("end",B),H.on("unpipe",X);var ee=function(Ae){return function(){var fe=Ae._readableState;a("pipeOnDrain",fe.awaitDrain),fe.awaitDrain&&fe.awaitDrain--,fe.awaitDrain===0&&y(Ae,"data")&&(fe.flowing=!0,Z(Ae))}}(U);H.on("drain",ee);var re=!1;function se(Ae){a("ondata");var fe=H.write(Ae);a("dest.write",fe),fe===!1&&((te.pipesCount===1&&te.pipes===H||te.pipesCount>1&&ne(te.pipes,H)!==-1)&&!re&&(a("false write response, pause",te.awaitDrain),te.awaitDrain++),U.pause())}function oe(Ae){a("onerror",Ae),ve(),H.removeListener("error",oe),y(H,"error")===0&&_(H,Ae)}function de(){H.removeListener("finish",ce),ve()}function ce(){a("onfinish"),H.removeListener("close",de),ve()}function ve(){a("unpipe"),U.unpipe(H)}return U.on("data",se),function(Ae,fe,me){if(typeof Ae.prependListener=="function")return Ae.prependListener(fe,me);Ae._events&&Ae._events[fe]?Array.isArray(Ae._events[fe])?Ae._events[fe].unshift(me):Ae._events[fe]=[me,Ae._events[fe]]:Ae.on(fe,me)}(H,"error",oe),H.once("close",de),H.once("finish",ce),H.emit("pipe",U),te.flowing||(a("pipe resume"),U.resume()),H},k.prototype.unpipe=function(H){var N=this._readableState,U={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return H&&H!==N.pipes||(H||(H=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,H&&H.emit("unpipe",this,U)),this;if(!H){var te=N.pipes,B=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var X=0;X<B;X++)te[X].emit("unpipe",this,{hasUnpiped:!1});return this}var J=ne(N.pipes,H);return J===-1||(N.pipes.splice(J,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),H.emit("unpipe",this,U)),this},k.prototype.on=function(H,N){var U=e.prototype.on.call(this,H,N),te=this._readableState;return H==="data"?(te.readableListening=this.listenerCount("readable")>0,te.flowing!==!1&&this.resume()):H==="readable"&&(te.endEmitted||te.readableListening||(te.readableListening=te.needReadable=!0,te.flowing=!1,te.emittedReadable=!1,a("on readable",te.length,te.reading),te.length?P(this):te.reading||d.nextTick(j,this))),U},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(H,N){var U=e.prototype.removeListener.call(this,H,N);return H==="readable"&&d.nextTick(D,this),U},k.prototype.removeAllListeners=function(H){var N=e.prototype.removeAllListeners.apply(this,arguments);return H!=="readable"&&H!==void 0||d.nextTick(D,this),N},k.prototype.resume=function(){var H=this._readableState;return H.flowing||(a("resume"),H.flowing=!H.readableListening,function(N,U){U.resumeScheduled||(U.resumeScheduled=!0,d.nextTick(V,N,U))}(this,H)),H.paused=!1,this},k.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(H){var N=this,U=this._readableState,te=!1;for(var B in H.on("end",function(){if(a("wrapped end"),U.decoder&&!U.ended){var J=U.decoder.end();J&&J.length&&N.push(J)}N.push(null)}),H.on("data",function(J){a("wrapped data"),U.decoder&&(J=U.decoder.write(J)),U.objectMode&&J==null||(U.objectMode||J&&J.length)&&(N.push(J)||(te=!0,H.pause()))}),H)this[B]===void 0&&typeof H[B]=="function"&&(this[B]=function(J){return function(){return H[J].apply(H,arguments)}}(B));for(var X=0;X<b.length;X++)H.on(b[X],this.emit.bind(this,b[X]));return this._read=function(J){a("wrapped _read",J),te&&(te=!1,H.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return u===void 0&&(u=m("./internal/streams/async_iterator")),u(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(H){this._readableState&&(this._readableState.flowing=H)}}),k._fromList=Q,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(k.from=function(H,N){return s===void 0&&(s=m("./internal/streams/from")),s(k,H,N)})}).call(this)}).call(this,m("_process"),typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(m,G,W){G.exports=a;var d=m("../errors").codes,v=d.ERR_METHOD_NOT_IMPLEMENTED,w=d.ERR_MULTIPLE_CALLBACK,y=d.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=d.ERR_TRANSFORM_WITH_LENGTH_0,t=m("./_stream_duplex");function n(u,s){var h=this._transformState;h.transforming=!1;var l=h.writecb;if(l===null)return this.emit("error",new w);h.writechunk=null,h.writecb=null,s!=null&&this.push(s),l(u);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function a(u){if(!(this instanceof a))return new a(u);t.call(this,u),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.on("prefinish",r)}function r(){var u=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush(function(s,h){g(u,s,h)})}function g(u,s,h){if(s)return u.emit("error",s);if(h!=null&&u.push(h),u._writableState.length)throw new e;if(u._transformState.transforming)throw new y;return u.push(null)}m("inherits")(a,t),a.prototype.push=function(u,s){return this._transformState.needTransform=!1,t.prototype.push.call(this,u,s)},a.prototype._transform=function(u,s,h){h(new v("_transform()"))},a.prototype._write=function(u,s,h){var l=this._transformState;if(l.writecb=h,l.writechunk=u,l.writeencoding=s,!l.transforming){var o=this._readableState;(l.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},a.prototype._read=function(u){var s=this._transformState;s.writechunk===null||s.transforming?s.needTransform=!0:(s.transforming=!0,this._transform(s.writechunk,s.writeencoding,s.afterTransform))},a.prototype._destroy=function(u,s){t.prototype._destroy.call(this,u,function(h){s(h)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(m,G,W){(function(d,v){(function(){function w(z){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(j,V,Z){var Q=j.entry;for(j.entry=null;Q;){var K=Q.callback;V.pendingcb--,K(Z),Q=Q.next}V.corkedRequestsFree.next=j})(D,z)}}var y;G.exports=k,k.WritableState=T;var e={deprecate:m("util-deprecate")},t=m("./internal/streams/stream"),n=m("buffer").Buffer,a=v.Uint8Array||function(){},r,g=m("./internal/streams/destroy"),u=m("./internal/streams/state").getHighWaterMark,s=m("../errors").codes,h=s.ERR_INVALID_ARG_TYPE,l=s.ERR_METHOD_NOT_IMPLEMENTED,o=s.ERR_MULTIPLE_CALLBACK,p=s.ERR_STREAM_CANNOT_PIPE,c=s.ERR_STREAM_DESTROYED,i=s.ERR_STREAM_NULL_VALUES,x=s.ERR_STREAM_WRITE_AFTER_END,f=s.ERR_UNKNOWN_ENCODING,_=g.errorOrDestroy;function b(){}function T(z,D,j){y=y||m("./_stream_duplex"),z=z||{},typeof j!="boolean"&&(j=D instanceof y),this.objectMode=!!z.objectMode,j&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=u(this,z,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=z.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Z){(function(Q,K){var $=Q._writableState,ne=$.sync,H=$.writecb;if(typeof H!="function")throw new o;if(function(U){U.writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0}($),K)(function(U,te,B,X,J){--te.pendingcb,B?(d.nextTick(J,X),d.nextTick(E,U,te),U._writableState.errorEmitted=!0,_(U,X)):(J(X),U._writableState.errorEmitted=!0,_(U,X),E(U,te))})(Q,$,ne,K,H);else{var N=P($)||Q.destroyed;N||$.corked||$.bufferProcessing||!$.bufferedRequest||I(Q,$),ne?d.nextTick(A,Q,$,N,H):A(Q,$,N,H)}})(D,Z)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this)}function k(z){var D=this instanceof(y=y||m("./_stream_duplex"));if(!D&&!r.call(k,this))return new k(z);this._writableState=new T(z,this,D),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),t.call(this)}function L(z,D,j,V,Z,Q,K){D.writelen=V,D.writecb=K,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new c("write")):j?z._writev(Z,D.onwrite):z._write(Z,Q,D.onwrite),D.sync=!1}function A(z,D,j,V){j||function(Z,Q){Q.length===0&&Q.needDrain&&(Q.needDrain=!1,Z.emit("drain"))}(z,D),D.pendingcb--,V(),E(z,D)}function I(z,D){D.bufferProcessing=!0;var j=D.bufferedRequest;if(z._writev&&j&&j.next){var V=D.bufferedRequestCount,Z=new Array(V),Q=D.corkedRequestsFree;Q.entry=j;for(var K=0,$=!0;j;)Z[K]=j,j.isBuf||($=!1),j=j.next,K+=1;Z.allBuffers=$,L(z,D,!0,D.length,Z,"",Q.finish),D.pendingcb++,D.lastBufferedRequest=null,Q.next?(D.corkedRequestsFree=Q.next,Q.next=null):D.corkedRequestsFree=new w(D),D.bufferedRequestCount=0}else{for(;j;){var ne=j.chunk,H=j.encoding,N=j.callback;if(L(z,D,!1,D.objectMode?1:ne.length,ne,H,N),j=j.next,D.bufferedRequestCount--,D.writing)break}j===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=j,D.bufferProcessing=!1}function P(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function S(z,D){z._final(function(j){D.pendingcb--,j&&_(z,j),D.prefinished=!0,z.emit("prefinish"),E(z,D)})}function E(z,D){var j=P(D);if(j&&(function(Z,Q){Q.prefinished||Q.finalCalled||(typeof Z._final!="function"||Q.destroyed?(Q.prefinished=!0,Z.emit("prefinish")):(Q.pendingcb++,Q.finalCalled=!0,d.nextTick(S,Z,Q)))}(z,D),D.pendingcb===0&&(D.finished=!0,z.emit("finish"),D.autoDestroy))){var V=z._readableState;(!V||V.autoDestroy&&V.endEmitted)&&z.destroy()}return j}m("inherits")(k,t),T.prototype.getBuffer=function(){for(var z=this.bufferedRequest,D=[];z;)D.push(z),z=z.next;return D},function(){try{Object.defineProperty(T.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(z){return!!r.call(this,z)||this===k&&z&&z._writableState instanceof T}})):r=function(z){return z instanceof this},k.prototype.pipe=function(){_(this,new p)},k.prototype.write=function(z,D,j){var V,Z=this._writableState,Q=!1,K=!Z.objectMode&&(V=z,n.isBuffer(V)||V instanceof a);return K&&!n.isBuffer(z)&&(z=function($){return n.from($)}(z)),typeof D=="function"&&(j=D,D=null),K?D="buffer":D||(D=Z.defaultEncoding),typeof j!="function"&&(j=b),Z.ending?function($,ne){var H=new x;_($,H),d.nextTick(ne,H)}(this,j):(K||function($,ne,H,N){var U;return H===null?U=new i:typeof H=="string"||ne.objectMode||(U=new h("chunk",["string","Buffer"],H)),!U||(_($,U),d.nextTick(N,U),!1)}(this,Z,z,j))&&(Z.pendingcb++,Q=function($,ne,H,N,U,te){if(!H){var B=function(re,se,oe){return re.objectMode||re.decodeStrings===!1||typeof se!="string"||(se=n.from(se,oe)),se}(ne,N,U);N!==B&&(H=!0,U="buffer",N=B)}var X=ne.objectMode?1:N.length;ne.length+=X;var J=ne.length<ne.highWaterMark;if(J||(ne.needDrain=!0),ne.writing||ne.corked){var ee=ne.lastBufferedRequest;ne.lastBufferedRequest={chunk:N,encoding:U,isBuf:H,callback:te,next:null},ee?ee.next=ne.lastBufferedRequest:ne.bufferedRequest=ne.lastBufferedRequest,ne.bufferedRequestCount+=1}else L($,ne,!1,X,N,U,te);return J}(this,Z,K,z,D,j)),Q},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,z.writing||z.corked||z.bufferProcessing||!z.bufferedRequest||I(this,z))},k.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new f(z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(z,D,j){j(new l("_write()"))},k.prototype._writev=null,k.prototype.end=function(z,D,j){var V=this._writableState;return typeof z=="function"?(j=z,z=null,D=null):typeof D=="function"&&(j=D,D=null),z!=null&&this.write(z,D),V.corked&&(V.corked=1,this.uncork()),V.ending||function(Z,Q,K){Q.ending=!0,E(Z,Q),K&&(Q.finished?d.nextTick(K):Z.once("finish",K)),Q.ended=!0,Z.writable=!1}(this,V,j),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),k.prototype.destroy=g.destroy,k.prototype._undestroy=g.undestroy,k.prototype._destroy=function(z,D){D(z)}}).call(this)}).call(this,m("_process"),typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(m,G,W){(function(d){(function(){var v;function w(c,i,x){return i in c?Object.defineProperty(c,i,{value:x,enumerable:!0,configurable:!0,writable:!0}):c[i]=x,c}var y=m("./end-of-stream"),e=Symbol("lastResolve"),t=Symbol("lastReject"),n=Symbol("error"),a=Symbol("ended"),r=Symbol("lastPromise"),g=Symbol("handlePromise"),u=Symbol("stream");function s(c,i){return{value:c,done:i}}function h(c){var i=c[e];if(i!==null){var x=c[u].read();x!==null&&(c[r]=null,c[e]=null,c[t]=null,i(s(x,!1)))}}function l(c){d.nextTick(h,c)}var o=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((w(v={get stream(){return this[u]},next:function(){var c=this,i=this[n];if(i!==null)return Promise.reject(i);if(this[a])return Promise.resolve(s(void 0,!0));if(this[u].destroyed)return new Promise(function(b,T){d.nextTick(function(){c[n]?T(c[n]):b(s(void 0,!0))})});var x,f=this[r];if(f)x=new Promise(function(b,T){return function(k,L){b.then(function(){T[a]?k(s(void 0,!0)):T[g](k,L)},L)}}(f,this));else{var _=this[u].read();if(_!==null)return Promise.resolve(s(_,!1));x=new Promise(this[g])}return this[r]=x,x}},Symbol.asyncIterator,function(){return this}),w(v,"return",function(){var c=this;return new Promise(function(i,x){c[u].destroy(null,function(f){f?x(f):i(s(void 0,!0))})})}),v),o);G.exports=function(c){var i,x=Object.create(p,(w(i={},u,{value:c,writable:!0}),w(i,e,{value:null,writable:!0}),w(i,t,{value:null,writable:!0}),w(i,n,{value:null,writable:!0}),w(i,a,{value:c._readableState.endEmitted,writable:!0}),w(i,g,{value:function(f,_){var b=x[u].read();b?(x[r]=null,x[e]=null,x[t]=null,f(s(b,!1))):(x[e]=f,x[t]=_)},writable:!0}),i));return x[r]=null,y(c,function(f){if(f&&f.code!=="ERR_STREAM_PREMATURE_CLOSE"){var _=x[t];return _!==null&&(x[r]=null,x[e]=null,x[t]=null,_(f)),void(x[n]=f)}var b=x[e];b!==null&&(x[r]=null,x[e]=null,x[t]=null,b(s(void 0,!0))),x[a]=!0}),c.on("readable",l.bind(null,x)),x}}).call(this)}).call(this,m("_process"))},{"./end-of-stream":296,_process:278}],294:[function(m,G,W){function d(n,a){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(n);a&&(g=g.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),r.push.apply(r,g)}return r}function v(n,a,r){return a in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n}function w(n,a){for(var r=0;r<a.length;r++){var g=a[r];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(n,g.key,g)}}var y=m("buffer").Buffer,e=m("util").inspect,t=e&&e.custom||"inspect";G.exports=function(){function n(){(function(g,u){if(!(g instanceof u))throw new TypeError("Cannot call a class as a function")})(this,n),this.head=null,this.tail=null,this.length=0}var a,r;return a=n,(r=[{key:"push",value:function(g){var u={data:g,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length}},{key:"unshift",value:function(g){var u={data:g,next:this.head};this.length===0&&(this.tail=u),this.head=u,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var u=this.head,s=""+u.data;u=u.next;)s+=g+u.data;return s}},{key:"concat",value:function(g){if(this.length===0)return y.alloc(0);for(var u,s,h,l=y.allocUnsafe(g>>>0),o=this.head,p=0;o;)u=o.data,s=l,h=p,y.prototype.copy.call(u,s,h),p+=o.data.length,o=o.next;return l}},{key:"consume",value:function(g,u){var s;return g<this.head.data.length?(s=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):s=g===this.head.data.length?this.shift():u?this._getString(g):this._getBuffer(g),s}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var u=this.head,s=1,h=u.data;for(g-=h.length;u=u.next;){var l=u.data,o=g>l.length?l.length:g;if(o===l.length?h+=l:h+=l.slice(0,g),(g-=o)==0){o===l.length?(++s,u.next?this.head=u.next:this.head=this.tail=null):(this.head=u,u.data=l.slice(o));break}++s}return this.length-=s,h}},{key:"_getBuffer",value:function(g){var u=y.allocUnsafe(g),s=this.head,h=1;for(s.data.copy(u),g-=s.data.length;s=s.next;){var l=s.data,o=g>l.length?l.length:g;if(l.copy(u,u.length-g,0,o),(g-=o)==0){o===l.length?(++h,s.next?this.head=s.next:this.head=this.tail=null):(this.head=s,s.data=l.slice(o));break}++h}return this.length-=h,u}},{key:t,value:function(g,u){return e(this,function(s){for(var h=1;h<arguments.length;h++){var l=arguments[h]!=null?arguments[h]:{};h%2?d(Object(l),!0).forEach(function(o){v(s,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):d(Object(l)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(l,o))})}return s}({},u,{depth:0,customInspect:!1}))}}])&&w(a.prototype,r),n}()},{buffer:85,util:83}],295:[function(m,G,W){(function(d){(function(){function v(e,t){y(e,t),w(e)}function w(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function y(e,t){e.emit("error",t)}G.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return a||r?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,d.nextTick(y,this,e)):d.nextTick(y,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(g){!t&&g?n._writableState?n._writableState.errorEmitted?d.nextTick(w,n):(n._writableState.errorEmitted=!0,d.nextTick(v,n,g)):d.nextTick(v,n,g):t?(d.nextTick(w,n),t(g)):d.nextTick(w,n)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,a=e._writableState;n&&n.autoDestroy||a&&a.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,m("_process"))},{_process:278}],296:[function(m,G,W){var d=m("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(){}G.exports=function w(y,e,t){if(typeof e=="function")return w(y,null,e);e||(e={}),t=function(c){var i=!1;return function(){if(!i){i=!0;for(var x=arguments.length,f=new Array(x),_=0;_<x;_++)f[_]=arguments[_];c.apply(this,f)}}}(t||v);var n=e.readable||e.readable!==!1&&y.readable,a=e.writable||e.writable!==!1&&y.writable,r=function(){y.writable||u()},g=y._writableState&&y._writableState.finished,u=function(){a=!1,g=!0,n||t.call(y)},s=y._readableState&&y._readableState.endEmitted,h=function(){n=!1,s=!0,a||t.call(y)},l=function(c){t.call(y,c)},o=function(){var c;return n&&!s?(y._readableState&&y._readableState.ended||(c=new d),t.call(y,c)):a&&!g?(y._writableState&&y._writableState.ended||(c=new d),t.call(y,c)):void 0},p=function(){y.req.on("finish",u)};return function(c){return c.setHeader&&typeof c.abort=="function"}(y)?(y.on("complete",u),y.on("abort",o),y.req?p():y.on("request",p)):a&&!y._writableState&&(y.on("end",r),y.on("close",r)),y.on("end",h),y.on("finish",u),e.error!==!1&&y.on("error",l),y.on("close",o),function(){y.removeListener("complete",u),y.removeListener("abort",o),y.removeListener("request",p),y.req&&y.req.removeListener("finish",u),y.removeListener("end",r),y.removeListener("close",r),y.removeListener("finish",u),y.removeListener("end",h),y.removeListener("error",l),y.removeListener("close",o)}}},{"../../../errors":287}],297:[function(m,G,W){G.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(m,G,W){var d,v=m("../../../errors").codes,w=v.ERR_MISSING_ARGS,y=v.ERR_STREAM_DESTROYED;function e(g){if(g)throw g}function t(g,u,s,h){h=function(p){var c=!1;return function(){c||(c=!0,p.apply(void 0,arguments))}}(h);var l=!1;g.on("close",function(){l=!0}),d===void 0&&(d=m("./end-of-stream")),d(g,{readable:u,writable:s},function(p){if(p)return h(p);l=!0,h()});var o=!1;return function(p){if(!l&&!o)return o=!0,function(c){return c.setHeader&&typeof c.abort=="function"}(g)?g.abort():typeof g.destroy=="function"?g.destroy():void h(p||new y("pipe"))}}function n(g){g()}function a(g,u){return g.pipe(u)}function r(g){return g.length?typeof g[g.length-1]!="function"?e:g.pop():e}G.exports=function(){for(var g=arguments.length,u=new Array(g),s=0;s<g;s++)u[s]=arguments[s];var h,l=r(u);if(Array.isArray(u[0])&&(u=u[0]),u.length<2)throw new w("streams");var o=u.map(function(p,c){var i=c<u.length-1;return t(p,i,c>0,function(x){h||(h=x),x&&o.forEach(n),i||(o.forEach(n),l(h))})});return u.reduce(a)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(m,G,W){var d=m("../../../errors").codes.ERR_INVALID_OPT_VALUE;G.exports={getHighWaterMark:function(v,w,y,e){var t=function(n,a,r){return n.highWaterMark!=null?n.highWaterMark:a?n[r]:null}(w,e,y);if(t!=null){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new d(e?y:"highWaterMark",t);return Math.floor(t)}return v.objectMode?16:16384}}},{"../../../errors":287}],300:[function(m,G,W){G.exports=m("events").EventEmitter},{events:84}],301:[function(m,G,W){var d=m("safe-buffer").Buffer,v=d.isEncoding||function(s){switch((s=""+s)&&s.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function w(s){var h;switch(this.encoding=function(l){var o=function(p){if(!p)return"utf8";for(var c;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(c)return;p=(""+p).toLowerCase(),c=!0}}(l);if(typeof o!="string"&&(d.isEncoding===v||!v(l)))throw new Error("Unknown encoding: "+l);return o||l}(s),this.encoding){case"utf16le":this.text=t,this.end=n,h=4;break;case"utf8":this.fillLast=e,h=4;break;case"base64":this.text=a,this.end=r,h=3;break;default:return this.write=g,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(h)}function y(s){return s<=127?0:s>>5==6?2:s>>4==14?3:s>>3==30?4:s>>6==2?-1:-2}function e(s){var h=this.lastTotal-this.lastNeed,l=function(o,p,c){if((192&p[0])!=128)return o.lastNeed=0,"\uFFFD";if(o.lastNeed>1&&p.length>1){if((192&p[1])!=128)return o.lastNeed=1,"\uFFFD";if(o.lastNeed>2&&p.length>2&&(192&p[2])!=128)return o.lastNeed=2,"\uFFFD"}}(this,s);return l!==void 0?l:this.lastNeed<=s.length?(s.copy(this.lastChar,h,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(s.copy(this.lastChar,h,0,s.length),void(this.lastNeed-=s.length))}function t(s,h){if((s.length-h)%2==0){var l=s.toString("utf16le",h);if(l){var o=l.charCodeAt(l.length-1);if(o>=55296&&o<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=s[s.length-1],s.toString("utf16le",h,s.length-1)}function n(s){var h=s&&s.length?this.write(s):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return h+this.lastChar.toString("utf16le",0,l)}return h}function a(s,h){var l=(s.length-h)%3;return l===0?s.toString("base64",h):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=s[s.length-1]:(this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1]),s.toString("base64",h,s.length-l))}function r(s){var h=s&&s.length?this.write(s):"";return this.lastNeed?h+this.lastChar.toString("base64",0,3-this.lastNeed):h}function g(s){return s.toString(this.encoding)}function u(s){return s&&s.length?this.write(s):""}W.StringDecoder=w,w.prototype.write=function(s){if(s.length===0)return"";var h,l;if(this.lastNeed){if((h=this.fillLast(s))===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<s.length?h?h+this.text(s,l):this.text(s,l):h||""},w.prototype.end=function(s){var h=s&&s.length?this.write(s):"";return this.lastNeed?h+"\uFFFD":h},w.prototype.text=function(s,h){var l=function(p,c,i){var x=c.length-1;if(x<i)return 0;var f=y(c[x]);return f>=0?(f>0&&(p.lastNeed=f-1),f):--x<i||f===-2?0:(f=y(c[x]))>=0?(f>0&&(p.lastNeed=f-2),f):--x<i||f===-2?0:(f=y(c[x]))>=0?(f>0&&(f===2?f=0:p.lastNeed=f-3),f):0}(this,s,h);if(!this.lastNeed)return s.toString("utf8",h);this.lastTotal=l;var o=s.length-(l-this.lastNeed);return s.copy(this.lastChar,0,o),s.toString("utf8",h,o)},w.prototype.fillLast=function(s){if(this.lastNeed<=s.length)return s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,s.length),this.lastNeed-=s.length}},{"safe-buffer":285}],302:[function(m,G,W){(function(d,v){(function(){var w=m("assert"),y=m("debug")("stream-parser");G.exports=function(l){var o=l&&typeof l._transform=="function",p=l&&typeof l._write=="function";if(!o&&!p)throw new Error("must pass a Writable or Transform stream in");y("extending Parser into stream"),l._bytes=t,l._skipBytes=n,o&&(l._passthrough=a),o?l._transform=g:l._write=r};function e(l){y("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=-1,l._parserCallback=null,typeof l.push=="function"&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function t(l,o){w(!this._parserCallback,'there is already a "callback" set!'),w(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||e(this),y("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=0}function n(l,o){w(!this._parserCallback,'there is already a "callback" set!'),w(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||e(this),y("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=1}function a(l,o){w(!this._parserCallback,'There is already a "callback" set!'),w(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||e(this),y("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=o,this._parserState=2}function r(l,o,p){this._parserInit||e(this),y("write(%o bytes)",l.length),typeof o=="function"&&(p=o),s(this,l,null,p)}function g(l,o,p){this._parserInit||e(this),y("transform(%o bytes)",l.length),typeof o!="function"&&(o=this._parserOutput),s(this,l,o,p)}function u(l,o,p,c){if(l._parserBytesLeft-=o.length,y("%o bytes left for stream piece",l._parserBytesLeft),l._parserState===0?(l._parserBuffers.push(o),l._parserBuffered+=o.length):l._parserState===2&&p(o),l._parserBytesLeft!==0)return c;var i=l._parserCallback;if(i&&l._parserState===0&&l._parserBuffers.length>1&&(o=v.concat(l._parserBuffers,l._parserBuffered)),l._parserState!==0&&(o=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=-1,l._parserBuffers.splice(0),i){var x=[];o&&x.push(o),p&&x.push(p);var f=i.length>x.length;f&&x.push(h(c));var _=i.apply(l,x);if(!f||c===_)return c}}var s=h(function l(o,p,c,i){return o._parserBytesLeft<=0?i(new Error("got data but not currently parsing anything")):p.length<=o._parserBytesLeft?function(){return u(o,p,c,i)}:function(){var x=p.slice(0,o._parserBytesLeft);return u(o,x,c,function(f){return f?i(f):p.length>x.length?function(){return l(o,p.slice(x.length),c,i)}:void 0})}});function h(l){return function(){for(var o=l.apply(this,arguments);typeof o=="function";)o=o();return o}}}).call(this)}).call(this,m("_process"),m("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(m,G,W){(function(d){(function(){function v(){var w;try{w=W.storage.debug}catch{}return!w&&d!==void 0&&"env"in d&&(w=d.env.DEBUG),w}(W=G.exports=m("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},W.formatArgs=function(w){var y=this.useColors;if(w[0]=(y?"%c":"")+this.namespace+(y?" %c":" ")+w[0]+(y?"%c ":" ")+"+"+W.humanize(this.diff),!!y){var e="color: "+this.color;w.splice(1,0,e,"color: inherit");var t=0,n=0;w[0].replace(/%[a-zA-Z%]/g,function(a){a!=="%%"&&(t++,a==="%c"&&(n=t))}),w.splice(n,0,e)}},W.save=function(w){try{w==null?W.storage.removeItem("debug"):W.storage.debug=w}catch{}},W.load=v,W.useColors=function(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},W.storage=typeof chrome<"u"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),W.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],W.formatters.j=function(w){try{return JSON.stringify(w)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}},W.enable(v())}).call(this)}).call(this,m("_process"))},{"./debug":304,_process:278}],304:[function(m,G,W){var d;function v(w){function y(){if(y.enabled){var e=y,t=+new Date,n=t-(d||t);e.diff=n,e.prev=d,e.curr=t,d=t;for(var a=new Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];a[0]=W.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");var g=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(s,h){if(s==="%%")return s;g++;var l=W.formatters[h];if(typeof l=="function"){var o=a[g];s=l.call(e,o),a.splice(g,1),g--}return s}),W.formatArgs.call(e,a);var u=y.log||W.log||console.log.bind(console);u.apply(e,a)}}return y.namespace=w,y.enabled=W.enabled(w),y.useColors=W.useColors(),y.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return W.colors[Math.abs(n)%W.colors.length]}(w),typeof W.init=="function"&&W.init(y),y}(W=G.exports=v.debug=v.default=v).coerce=function(w){return w instanceof Error?w.stack||w.message:w},W.disable=function(){W.enable("")},W.enable=function(w){W.save(w),W.names=[],W.skips=[];for(var y=(typeof w=="string"?w:"").split(/[\s,]+/),e=y.length,t=0;t<e;t++)y[t]&&((w=y[t].replace(/\*/g,".*?"))[0]==="-"?W.skips.push(new RegExp("^"+w.substr(1)+"$")):W.names.push(new RegExp("^"+w+"$")))},W.enabled=function(w){var y,e;for(y=0,e=W.skips.length;y<e;y++)if(W.skips[y].test(w))return!1;for(y=0,e=W.names.length;y<e;y++)if(W.names[y].test(w))return!0;return!1},W.humanize=m("ms"),W.names=[],W.skips=[],W.formatters={}},{ms:305}],305:[function(m,G,W){var d=1e3,v=6e4,w=60*v,y=24*w;function e(t,n,a){if(!(t<n))return t<1.5*n?Math.floor(t/n)+" "+a:Math.ceil(t/n)+" "+a+"s"}G.exports=function(t,n){n=n||{};var a,r=typeof t;if(r==="string"&&t.length>0)return function(g){if(!((g=String(g)).length>100)){var u=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(g);if(!!u){var s=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*y;case"hours":case"hour":case"hrs":case"hr":case"h":return s*w;case"minutes":case"minute":case"mins":case"min":case"m":return s*v;case"seconds":case"second":case"secs":case"sec":case"s":return s*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(t);if(r==="number"&&isNaN(t)===!1)return n.long?e(a=t,y,"day")||e(a,w,"hour")||e(a,v,"minute")||e(a,d,"second")||a+" ms":function(g){return g>=y?Math.round(g/y)+"d":g>=w?Math.round(g/w)+"h":g>=v?Math.round(g/v)+"m":g>=d?Math.round(g/d)+"s":g+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],306:[function(m,G,W){var d=m("parenthesis");G.exports=function(v,w,y){if(v==null)throw Error("First argument should be a string");if(w==null)throw Error("Separator should be a string or a RegExp");y?(typeof y=="string"||Array.isArray(y))&&(y={ignore:y}):y={},y.escape==null&&(y.escape=!0),y.ignore==null?y.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof y.ignore=="string"&&(y.ignore=[y.ignore]),y.ignore=y.ignore.map(function(u){return u.length===1&&(u+=u),u}));var e=d.parse(v,{flat:!0,brackets:y.ignore}),t=e[0].split(w);if(y.escape){for(var n=[],a=0;a<t.length;a++){var r=t[a],g=t[a+1];r[r.length-1]==="\\"&&r[r.length-2]!=="\\"?(n.push(r+w+g),a++):n.push(r)}t=n}for(a=0;a<t.length;a++)e[0]=t[a],t[a]=d.stringify(e,{flat:!0});return t}},{parenthesis:248}],307:[function(m,G,W){G.exports=function(d){for(var v=d.length,w=new Array(v),y=new Array(v),e=new Array(v),t=new Array(v),n=new Array(v),a=new Array(v),r=0;r<v;++r)w[r]=-1,y[r]=0,e[r]=!1,t[r]=0,n[r]=-1,a[r]=[];var g,u=0,s=[],h=[];function l(c){var i=[c],x=[c];for(w[c]=y[c]=u,e[c]=!0,u+=1;x.length>0;){c=x[x.length-1];var f=d[c];if(t[c]<f.length){for(var _=t[c];_<f.length;++_){var b=f[_];if(w[b]<0){w[b]=y[b]=u,e[b]=!0,u+=1,i.push(b),x.push(b);break}e[b]&&(y[c]=0|Math.min(y[c],y[b])),n[b]>=0&&a[c].push(n[b])}t[c]=_}else{if(y[c]===w[c]){var T=[],k=[],L=0;for(_=i.length-1;_>=0;--_){var A=i[_];if(e[A]=!1,T.push(A),k.push(a[A]),L+=a[A].length,n[A]=s.length,A===c){i.length=_;break}}s.push(T);var I=new Array(L);for(_=0;_<k.length;_++)for(var P=0;P<k[_].length;P++)I[--L]=k[_][P];h.push(I)}x.pop()}}}for(r=0;r<v;++r)w[r]<0&&l(r);for(r=0;r<h.length;r++){var o=h[r];if(o.length!==0){o.sort(function(c,i){return c-i}),g=[o[0]];for(var p=1;p<o.length;p++)o[p]!==o[p-1]&&g.push(o[p]);h[r]=g}}return{components:s,adjacencyList:h}}},{}],308:[function(m,G,W){Object.defineProperty(W,"__esModule",{value:!0});var d=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(a,r){var g=[],u=!0,s=!1,h=void 0;try{for(var l,o=a[Symbol.iterator]();!(u=(l=o.next()).done)&&(g.push(l.value),!r||g.length!==r);u=!0);}catch(p){s=!0,h=p}finally{try{!u&&o.return&&o.return()}finally{if(s)throw h}}return g}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=2*Math.PI,w=function(t,n,a,r,g,u,s){var h=t.x,l=t.y;return{x:r*(h*=n)-g*(l*=a)+u,y:g*h+r*l+s}},y=function(t,n){var a=n===1.5707963267948966?.551915024494:n===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(n/4),r=Math.cos(t),g=Math.sin(t),u=Math.cos(t+n),s=Math.sin(t+n);return[{x:r-g*a,y:g+r*a},{x:u+s*a,y:s-u*a},{x:u,y:s}]},e=function(t,n,a,r){var g=t*a+n*r;return g>1&&(g=1),g<-1&&(g=-1),(t*r-n*a<0?-1:1)*Math.acos(g)};W.default=function(t){var n=t.px,a=t.py,r=t.cx,g=t.cy,u=t.rx,s=t.ry,h=t.xAxisRotation,l=h===void 0?0:h,o=t.largeArcFlag,p=o===void 0?0:o,c=t.sweepFlag,i=c===void 0?0:c,x=[];if(u===0||s===0)return[];var f=Math.sin(l*v/360),_=Math.cos(l*v/360),b=_*(n-r)/2+f*(a-g)/2,T=-f*(n-r)/2+_*(a-g)/2;if(b===0&&T===0)return[];u=Math.abs(u),s=Math.abs(s);var k=Math.pow(b,2)/Math.pow(u,2)+Math.pow(T,2)/Math.pow(s,2);k>1&&(u*=Math.sqrt(k),s*=Math.sqrt(k));var L=function(V,Z,Q,K,$,ne,H,N,U,te,B,X){var J=Math.pow($,2),ee=Math.pow(ne,2),re=Math.pow(B,2),se=Math.pow(X,2),oe=J*ee-J*se-ee*re;oe<0&&(oe=0),oe/=J*se+ee*re;var de=(oe=Math.sqrt(oe)*(H===N?-1:1))*$/ne*X,ce=oe*-ne/$*B,ve=te*de-U*ce+(V+Q)/2,Ae=U*de+te*ce+(Z+K)/2,fe=(B-de)/$,me=(X-ce)/ne,_e=(-B-de)/$,le=(-X-ce)/ne,ge=e(1,0,fe,me),Te=e(fe,me,_e,le);return N===0&&Te>0&&(Te-=v),N===1&&Te<0&&(Te+=v),[ve,Ae,ge,Te]}(n,a,r,g,u,s,p,i,f,_,b,T),A=d(L,4),I=A[0],P=A[1],S=A[2],E=A[3],z=Math.abs(E)/(v/4);Math.abs(1-z)<1e-7&&(z=1);var D=Math.max(Math.ceil(z),1);E/=D;for(var j=0;j<D;j++)x.push(y(S,E)),S+=E;return x.map(function(V){var Z=w(V[0],u,s,_,f,I,P),Q=Z.x,K=Z.y,$=w(V[1],u,s,_,f,I,P),ne=$.x,H=$.y,N=w(V[2],u,s,_,f,I,P);return{x1:Q,y1:K,x2:ne,y2:H,x:N.x,y:N.y}})},G.exports=W.default},{}],309:[function(m,G,W){var d=m("parse-svg-path"),v=m("abs-svg-path"),w=m("normalize-svg-path"),y=m("is-svg-path"),e=m("assert");G.exports=function(t){if(Array.isArray(t)&&t.length===1&&typeof t[0]=="string"&&(t=t[0]),typeof t=="string"&&(e(y(t),"String is not an SVG path."),t=d(t)),e(Array.isArray(t),"Argument should be a string or an array of path segments."),t=v(t),!(t=w(t)).length)return[0,0,0,0];for(var n=[1/0,1/0,-1/0,-1/0],a=0,r=t.length;a<r;a++)for(var g=t[a].slice(1),u=0;u<g.length;u+=2)g[u+0]<n[0]&&(n[0]=g[u+0]),g[u+1]<n[1]&&(n[1]=g[u+1]),g[u+0]>n[2]&&(n[2]=g[u+0]),g[u+1]>n[3]&&(n[3]=g[u+1]);return n}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(m,G,W){G.exports=function(y){for(var e,t=[],n=0,a=0,r=0,g=0,u=null,s=null,h=0,l=0,o=0,p=y.length;o<p;o++){var c=y[o],i=c[0];switch(i){case"M":r=c[1],g=c[2];break;case"A":var x=d({px:h,py:l,cx:c[6],cy:c[7],rx:c[1],ry:c[2],xAxisRotation:c[3],largeArcFlag:c[4],sweepFlag:c[5]});if(!x.length)continue;for(var f,_=0;_<x.length;_++)f=x[_],c=["C",f.x1,f.y1,f.x2,f.y2,f.x,f.y],_<x.length-1&&t.push(c);break;case"S":var b=h,T=l;e!="C"&&e!="S"||(b+=b-n,T+=T-a),c=["C",b,T,c[1],c[2],c[3],c[4]];break;case"T":e=="Q"||e=="T"?(u=2*h-u,s=2*l-s):(u=h,s=l),c=w(h,l,u,s,c[1],c[2]);break;case"Q":u=c[1],s=c[2],c=w(h,l,c[1],c[2],c[3],c[4]);break;case"L":c=v(h,l,c[1],c[2]);break;case"H":c=v(h,l,c[1],l);break;case"V":c=v(h,l,h,c[1]);break;case"Z":c=v(h,l,r,g)}e=i,h=c[c.length-2],l=c[c.length-1],c.length>4?(n=c[c.length-4],a=c[c.length-3]):(n=h,a=l),t.push(c)}return t};var d=m("svg-arc-to-cubic-bezier");function v(y,e,t,n){return["C",y,e,t,n,t,n]}function w(y,e,t,n,a,r){return["C",y/3+2/3*t,e/3+2/3*n,a/3+2/3*t,r/3+2/3*n,a,r]}},{"svg-arc-to-cubic-bezier":308}],311:[function(m,G,W){var d,v=m("svg-path-bounds"),w=m("parse-svg-path"),y=m("draw-svg-path"),e=m("is-svg-path"),t=m("bitmap-sdf"),n=document.createElement("canvas"),a=n.getContext("2d");G.exports=function(r,g){if(!e(r))throw Error("Argument should be valid svg path string");g||(g={});var u,s;g.shape?(u=g.shape[0],s=g.shape[1]):(u=n.width=g.w||g.width||200,s=n.height=g.h||g.height||200);var h=Math.min(u,s),l=g.stroke||0,o=g.viewbox||g.viewBox||v(r),p=[u/(o[2]-o[0]),s/(o[3]-o[1])],c=Math.min(p[0]||0,p[1]||0)/2;if(a.fillStyle="black",a.fillRect(0,0,u,s),a.fillStyle="white",l&&(typeof l!="number"&&(l=1),a.strokeStyle=l>0?"white":"black",a.lineWidth=Math.abs(l)),a.translate(.5*u,.5*s),a.scale(c,c),function(){if(d!=null)return d;var f=document.createElement("canvas").getContext("2d");if(f.canvas.width=f.canvas.height=1,!window.Path2D)return d=!1;var _=new Path2D("M0,0h1v1h-1v-1Z");f.fillStyle="black",f.fill(_);var b=f.getImageData(0,0,1,1);return d=b&&b.data&&b.data[3]===255}()){var i=new Path2D(r);a.fill(i),l&&a.stroke(i)}else{var x=w(r);y(a,x),a.fill(),l&&a.stroke()}return a.setTransform(1,0,0,1,0,0),t(a,{cutoff:g.cutoff!=null?g.cutoff:.5,radius:g.radius!=null?g.radius:.5*h})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(m,G,W){(function(d,v){(function(){var w=m("process/browser.js").nextTick,y=Function.prototype.apply,e=Array.prototype.slice,t={},n=0;function a(r,g){this._id=r,this._clearFn=g}W.setTimeout=function(){return new a(y.call(setTimeout,window,arguments),clearTimeout)},W.setInterval=function(){return new a(y.call(setInterval,window,arguments),clearInterval)},W.clearTimeout=W.clearInterval=function(r){r.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},W.enroll=function(r,g){clearTimeout(r._idleTimeoutId),r._idleTimeout=g},W.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},W._unrefActive=W.active=function(r){clearTimeout(r._idleTimeoutId);var g=r._idleTimeout;g>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},g))},W.setImmediate=typeof d=="function"?d:function(r){var g=n++,u=!(arguments.length<2)&&e.call(arguments,1);return t[g]=!0,w(function(){t[g]&&(u?r.apply(null,u):r.call(null),W.clearImmediate(g))}),g},W.clearImmediate=typeof v=="function"?v:function(r){delete t[r]}}).call(this)}).call(this,m("timers").setImmediate,m("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(m,G,W){(function(d){var v=/^\s+/,w=/\s+$/,y=0,e=d.round,t=d.min,n=d.max,a=d.random;function r(U,te){if(te=te||{},(U=U||"")instanceof r)return U;if(!(this instanceof r))return new r(U,te);var B=function(X){var J={r:0,g:0,b:0},ee=1,re=null,se=null,oe=null,de=!1,ce=!1;typeof X=="string"&&(X=function(me){me=me.replace(v,"").replace(w,"").toLowerCase();var _e,le=!1;if(I[me])me=I[me],le=!0;else if(me=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(_e=H.rgb.exec(me))?{r:_e[1],g:_e[2],b:_e[3]}:(_e=H.rgba.exec(me))?{r:_e[1],g:_e[2],b:_e[3],a:_e[4]}:(_e=H.hsl.exec(me))?{h:_e[1],s:_e[2],l:_e[3]}:(_e=H.hsla.exec(me))?{h:_e[1],s:_e[2],l:_e[3],a:_e[4]}:(_e=H.hsv.exec(me))?{h:_e[1],s:_e[2],v:_e[3]}:(_e=H.hsva.exec(me))?{h:_e[1],s:_e[2],v:_e[3],a:_e[4]}:(_e=H.hex8.exec(me))?{r:D(_e[1]),g:D(_e[2]),b:D(_e[3]),a:Q(_e[4]),format:le?"name":"hex8"}:(_e=H.hex6.exec(me))?{r:D(_e[1]),g:D(_e[2]),b:D(_e[3]),format:le?"name":"hex"}:(_e=H.hex4.exec(me))?{r:D(_e[1]+""+_e[1]),g:D(_e[2]+""+_e[2]),b:D(_e[3]+""+_e[3]),a:Q(_e[4]+""+_e[4]),format:le?"name":"hex8"}:(_e=H.hex3.exec(me))?{r:D(_e[1]+""+_e[1]),g:D(_e[2]+""+_e[2]),b:D(_e[3]+""+_e[3]),format:le?"name":"hex"}:!1}(X)),typeof X=="object"&&(N(X.r)&&N(X.g)&&N(X.b)?(ve=X.r,Ae=X.g,fe=X.b,J={r:255*E(ve,255),g:255*E(Ae,255),b:255*E(fe,255)},de=!0,ce=String(X.r).substr(-1)==="%"?"prgb":"rgb"):N(X.h)&&N(X.s)&&N(X.v)?(re=V(X.s),se=V(X.v),J=function(me,_e,le){me=6*E(me,360),_e=E(_e,100),le=E(le,100);var ge=d.floor(me),Te=me-ge,Se=le*(1-_e),Me=le*(1-Te*_e),ze=le*(1-(1-Te)*_e),Oe=ge%6;return{r:255*[le,Me,Se,Se,ze,le][Oe],g:255*[ze,le,le,Me,Se,Se][Oe],b:255*[Se,Se,ze,le,le,Me][Oe]}}(X.h,re,se),de=!0,ce="hsv"):N(X.h)&&N(X.s)&&N(X.l)&&(re=V(X.s),oe=V(X.l),J=function(me,_e,le){var ge,Te,Se;function Me(De,Xe,Be){return Be<0&&(Be+=1),Be>1&&(Be-=1),Be<1/6?De+6*(Xe-De)*Be:Be<.5?Xe:Be<2/3?De+(Xe-De)*(2/3-Be)*6:De}if(me=E(me,360),_e=E(_e,100),le=E(le,100),_e===0)ge=Te=Se=le;else{var ze=le<.5?le*(1+_e):le+_e-le*_e,Oe=2*le-ze;ge=Me(Oe,ze,me+1/3),Te=Me(Oe,ze,me),Se=Me(Oe,ze,me-1/3)}return{r:255*ge,g:255*Te,b:255*Se}}(X.h,re,oe),de=!0,ce="hsl"),X.hasOwnProperty("a")&&(ee=X.a));var ve,Ae,fe;return ee=S(ee),{ok:de,format:X.format||ce,r:t(255,n(J.r,0)),g:t(255,n(J.g,0)),b:t(255,n(J.b,0)),a:ee}}(U);this._originalInput=U,this._r=B.r,this._g=B.g,this._b=B.b,this._a=B.a,this._roundA=e(100*this._a)/100,this._format=te.format||B.format,this._gradientType=te.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=B.ok,this._tc_id=y++}function g(U,te,B){U=E(U,255),te=E(te,255),B=E(B,255);var X,J,ee=n(U,te,B),re=t(U,te,B),se=(ee+re)/2;if(ee==re)X=J=0;else{var oe=ee-re;switch(J=se>.5?oe/(2-ee-re):oe/(ee+re),ee){case U:X=(te-B)/oe+(te<B?6:0);break;case te:X=(B-U)/oe+2;break;case B:X=(U-te)/oe+4}X/=6}return{h:X,s:J,l:se}}function u(U,te,B){U=E(U,255),te=E(te,255),B=E(B,255);var X,J,ee=n(U,te,B),re=t(U,te,B),se=ee,oe=ee-re;if(J=ee===0?0:oe/ee,ee==re)X=0;else{switch(ee){case U:X=(te-B)/oe+(te<B?6:0);break;case te:X=(B-U)/oe+2;break;case B:X=(U-te)/oe+4}X/=6}return{h:X,s:J,v:se}}function s(U,te,B,X){var J=[j(e(U).toString(16)),j(e(te).toString(16)),j(e(B).toString(16))];return X&&J[0].charAt(0)==J[0].charAt(1)&&J[1].charAt(0)==J[1].charAt(1)&&J[2].charAt(0)==J[2].charAt(1)?J[0].charAt(0)+J[1].charAt(0)+J[2].charAt(0):J.join("")}function h(U,te,B,X){return[j(Z(X)),j(e(U).toString(16)),j(e(te).toString(16)),j(e(B).toString(16))].join("")}function l(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.s-=te/100,B.s=z(B.s),r(B)}function o(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.s+=te/100,B.s=z(B.s),r(B)}function p(U){return r(U).desaturate(100)}function c(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.l+=te/100,B.l=z(B.l),r(B)}function i(U,te){te=te===0?0:te||10;var B=r(U).toRgb();return B.r=n(0,t(255,B.r-e(-te/100*255))),B.g=n(0,t(255,B.g-e(-te/100*255))),B.b=n(0,t(255,B.b-e(-te/100*255))),r(B)}function x(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.l-=te/100,B.l=z(B.l),r(B)}function f(U,te){var B=r(U).toHsl(),X=(B.h+te)%360;return B.h=X<0?360+X:X,r(B)}function _(U){var te=r(U).toHsl();return te.h=(te.h+180)%360,r(te)}function b(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+120)%360,s:te.s,l:te.l}),r({h:(B+240)%360,s:te.s,l:te.l})]}function T(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+90)%360,s:te.s,l:te.l}),r({h:(B+180)%360,s:te.s,l:te.l}),r({h:(B+270)%360,s:te.s,l:te.l})]}function k(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+72)%360,s:te.s,l:te.l}),r({h:(B+216)%360,s:te.s,l:te.l})]}function L(U,te,B){te=te||6,B=B||30;var X=r(U).toHsl(),J=360/B,ee=[r(U)];for(X.h=(X.h-(J*te>>1)+720)%360;--te;)X.h=(X.h+J)%360,ee.push(r(X));return ee}function A(U,te){te=te||6;for(var B=r(U).toHsv(),X=B.h,J=B.s,ee=B.v,re=[],se=1/te;te--;)re.push(r({h:X,s:J,v:ee})),ee=(ee+se)%1;return re}r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var U=this.toRgb();return(299*U.r+587*U.g+114*U.b)/1e3},getLuminance:function(){var U,te,B,X=this.toRgb();return U=X.r/255,te=X.g/255,B=X.b/255,.2126*(U<=.03928?U/12.92:d.pow((U+.055)/1.055,2.4))+.7152*(te<=.03928?te/12.92:d.pow((te+.055)/1.055,2.4))+.0722*(B<=.03928?B/12.92:d.pow((B+.055)/1.055,2.4))},setAlpha:function(U){return this._a=S(U),this._roundA=e(100*this._a)/100,this},toHsv:function(){var U=u(this._r,this._g,this._b);return{h:360*U.h,s:U.s,v:U.v,a:this._a}},toHsvString:function(){var U=u(this._r,this._g,this._b),te=e(360*U.h),B=e(100*U.s),X=e(100*U.v);return this._a==1?"hsv("+te+", "+B+"%, "+X+"%)":"hsva("+te+", "+B+"%, "+X+"%, "+this._roundA+")"},toHsl:function(){var U=g(this._r,this._g,this._b);return{h:360*U.h,s:U.s,l:U.l,a:this._a}},toHslString:function(){var U=g(this._r,this._g,this._b),te=e(360*U.h),B=e(100*U.s),X=e(100*U.l);return this._a==1?"hsl("+te+", "+B+"%, "+X+"%)":"hsla("+te+", "+B+"%, "+X+"%, "+this._roundA+")"},toHex:function(U){return s(this._r,this._g,this._b,U)},toHexString:function(U){return"#"+this.toHex(U)},toHex8:function(U){return function(te,B,X,J,ee){var re=[j(e(te).toString(16)),j(e(B).toString(16)),j(e(X).toString(16)),j(Z(J))];return ee&&re[0].charAt(0)==re[0].charAt(1)&&re[1].charAt(0)==re[1].charAt(1)&&re[2].charAt(0)==re[2].charAt(1)&&re[3].charAt(0)==re[3].charAt(1)?re[0].charAt(0)+re[1].charAt(0)+re[2].charAt(0)+re[3].charAt(0):re.join("")}(this._r,this._g,this._b,this._a,U)},toHex8String:function(U){return"#"+this.toHex8(U)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*E(this._r,255))+"%",g:e(100*E(this._g,255))+"%",b:e(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%)":"rgba("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(P[s(this._r,this._g,this._b,!0)]||!1)},toFilter:function(U){var te="#"+h(this._r,this._g,this._b,this._a),B=te,X=this._gradientType?"GradientType = 1, ":"";if(U){var J=r(U);B="#"+h(J._r,J._g,J._b,J._a)}return"progid:DXImageTransform.Microsoft.gradient("+X+"startColorstr="+te+",endColorstr="+B+")"},toString:function(U){var te=!!U;U=U||this._format;var B=!1,X=this._a<1&&this._a>=0;return te||!X||U!=="hex"&&U!=="hex6"&&U!=="hex3"&&U!=="hex4"&&U!=="hex8"&&U!=="name"?(U==="rgb"&&(B=this.toRgbString()),U==="prgb"&&(B=this.toPercentageRgbString()),U!=="hex"&&U!=="hex6"||(B=this.toHexString()),U==="hex3"&&(B=this.toHexString(!0)),U==="hex4"&&(B=this.toHex8String(!0)),U==="hex8"&&(B=this.toHex8String()),U==="name"&&(B=this.toName()),U==="hsl"&&(B=this.toHslString()),U==="hsv"&&(B=this.toHsvString()),B||this.toHexString()):U==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return r(this.toString())},_applyModification:function(U,te){var B=U.apply(null,[this].concat([].slice.call(te)));return this._r=B._r,this._g=B._g,this._b=B._b,this.setAlpha(B._a),this},lighten:function(){return this._applyModification(c,arguments)},brighten:function(){return this._applyModification(i,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(o,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(f,arguments)},_applyCombination:function(U,te){return U.apply(null,[this].concat([].slice.call(te)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},r.fromRatio=function(U,te){if(typeof U=="object"){var B={};for(var X in U)U.hasOwnProperty(X)&&(B[X]=X==="a"?U[X]:V(U[X]));U=B}return r(U,te)},r.equals=function(U,te){return!(!U||!te)&&r(U).toRgbString()==r(te).toRgbString()},r.random=function(){return r.fromRatio({r:a(),g:a(),b:a()})},r.mix=function(U,te,B){B=B===0?0:B||50;var X=r(U).toRgb(),J=r(te).toRgb(),ee=B/100;return r({r:(J.r-X.r)*ee+X.r,g:(J.g-X.g)*ee+X.g,b:(J.b-X.b)*ee+X.b,a:(J.a-X.a)*ee+X.a})},r.readability=function(U,te){var B=r(U),X=r(te);return(d.max(B.getLuminance(),X.getLuminance())+.05)/(d.min(B.getLuminance(),X.getLuminance())+.05)},r.isReadable=function(U,te,B){var X,J,ee=r.readability(U,te);switch(J=!1,(X=function(re){var se,oe;return se=((re=re||{level:"AA",size:"small"}).level||"AA").toUpperCase(),oe=(re.size||"small").toLowerCase(),se!=="AA"&&se!=="AAA"&&(se="AA"),oe!=="small"&&oe!=="large"&&(oe="small"),{level:se,size:oe}}(B)).level+X.size){case"AAsmall":case"AAAlarge":J=ee>=4.5;break;case"AAlarge":J=ee>=3;break;case"AAAsmall":J=ee>=7}return J},r.mostReadable=function(U,te,B){var X,J,ee,re,se=null,oe=0;J=(B=B||{}).includeFallbackColors,ee=B.level,re=B.size;for(var de=0;de<te.length;de++)(X=r.readability(U,te[de]))>oe&&(oe=X,se=r(te[de]));return r.isReadable(U,se,{level:ee,size:re})||!J?se:(B.includeFallbackColors=!1,r.mostReadable(U,["#fff","#000"],B))};var I=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=r.hexNames=function(U){var te={};for(var B in U)U.hasOwnProperty(B)&&(te[U[B]]=B);return te}(I);function S(U){return U=parseFloat(U),(isNaN(U)||U<0||U>1)&&(U=1),U}function E(U,te){(function(X){return typeof X=="string"&&X.indexOf(".")!=-1&&parseFloat(X)===1})(U)&&(U="100%");var B=function(X){return typeof X=="string"&&X.indexOf("%")!=-1}(U);return U=t(te,n(0,parseFloat(U))),B&&(U=parseInt(U*te,10)/100),d.abs(U-te)<1e-6?1:U%te/parseFloat(te)}function z(U){return t(1,n(0,U))}function D(U){return parseInt(U,16)}function j(U){return U.length==1?"0"+U:""+U}function V(U){return U<=1&&(U=100*U+"%"),U}function Z(U){return d.round(255*parseFloat(U)).toString(16)}function Q(U){return D(U)/255}var K,$,ne,H=($="[\\s|\\(]+("+(K="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+K+")[,|\\s]+("+K+")\\s*\\)?",ne="[\\s|\\(]+("+K+")[,|\\s]+("+K+")[,|\\s]+("+K+")[,|\\s]+("+K+")\\s*\\)?",{CSS_UNIT:new RegExp(K),rgb:new RegExp("rgb"+$),rgba:new RegExp("rgba"+ne),hsl:new RegExp("hsl"+$),hsla:new RegExp("hsla"+ne),hsv:new RegExp("hsv"+$),hsva:new RegExp("hsva"+ne),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function N(U){return!!H.CSS_UNIT.exec(U)}G!==void 0&&G.exports?G.exports=r:window.tinycolor=r})(Math)},{}],314:[function(m,G,W){G.exports=v,G.exports.float32=G.exports.float=v,G.exports.fract32=G.exports.fract=function(w,y){if(w.length){if(w instanceof Float32Array)return new Float32Array(w.length);y instanceof Float32Array||(y=v(w));for(var e=0,t=y.length;e<t;e++)y[e]=w[e]-y[e];return y}return v(w-v(w))};var d=new Float32Array(1);function v(w){return w.length?w instanceof Float32Array?w:new Float32Array(w):(d[0]=w,d[0])}},{}],315:[function(m,G,W){var d=m("parse-unit");G.exports=w;function v(y,e){var t=d(getComputedStyle(y).getPropertyValue(e));return t[0]*w(t[1],y)}function w(y,e){switch(e=e||document.body,y=(y||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),y){case"%":return e.clientHeight/100;case"ch":case"ex":return function(t,n){var a=document.createElement("div");a.style["font-size"]="128"+t,n.appendChild(a);var r=v(a,"font-size")/128;return n.removeChild(a),r}(y,e);case"em":return v(e,"font-size");case"rem":return v(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":251}],316:[function(m,G,W){(function(d,v){v(typeof W=="object"&&G!==void 0?W:(d=d||self).topojson=d.topojson||{})})(this,function(d){function v(h){return h}function w(h){if(h==null)return v;var l,o,p=h.scale[0],c=h.scale[1],i=h.translate[0],x=h.translate[1];return function(f,_){_||(l=o=0);var b=2,T=f.length,k=new Array(T);for(k[0]=(l+=f[0])*p+i,k[1]=(o+=f[1])*c+x;b<T;)k[b]=f[b],++b;return k}}function y(h){var l,o=w(h.transform),p=1/0,c=p,i=-p,x=-p;function f(b){(b=o(b))[0]<p&&(p=b[0]),b[0]>i&&(i=b[0]),b[1]<c&&(c=b[1]),b[1]>x&&(x=b[1])}function _(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(_);break;case"Point":f(b.coordinates);break;case"MultiPoint":b.coordinates.forEach(f)}}for(l in h.arcs.forEach(function(b){for(var T,k=-1,L=b.length;++k<L;)(T=o(b[k],k))[0]<p&&(p=T[0]),T[0]>i&&(i=T[0]),T[1]<c&&(c=T[1]),T[1]>x&&(x=T[1])}),h.objects)_(h.objects[l]);return[p,c,i,x]}function e(h,l){var o=l.id,p=l.bbox,c=l.properties==null?{}:l.properties,i=t(h,l);return o==null&&p==null?{type:"Feature",properties:c,geometry:i}:p==null?{type:"Feature",id:o,properties:c,geometry:i}:{type:"Feature",id:o,bbox:p,properties:c,geometry:i}}function t(h,l){var o=w(h.transform),p=h.arcs;function c(b,T){T.length&&T.pop();for(var k=p[b<0?~b:b],L=0,A=k.length;L<A;++L)T.push(o(k[L],L));b<0&&function(I,P){for(var S,E=I.length,z=E-P;z<--E;)S=I[z],I[z++]=I[E],I[E]=S}(T,A)}function i(b){return o(b)}function x(b){for(var T=[],k=0,L=b.length;k<L;++k)c(b[k],T);return T.length<2&&T.push(T[0]),T}function f(b){for(var T=x(b);T.length<4;)T.push(T[0]);return T}function _(b){return b.map(f)}return function b(T){var k,L=T.type;switch(L){case"GeometryCollection":return{type:L,geometries:T.geometries.map(b)};case"Point":k=i(T.coordinates);break;case"MultiPoint":k=T.coordinates.map(i);break;case"LineString":k=x(T.arcs);break;case"MultiLineString":k=T.arcs.map(x);break;case"Polygon":k=_(T.arcs);break;case"MultiPolygon":k=T.arcs.map(_);break;default:return null}return{type:L,coordinates:k}}(l)}function n(h,l){var o={},p={},c={},i=[],x=-1;function f(_,b){for(var T in _){var k=_[T];delete b[k.start],delete k.start,delete k.end,k.forEach(function(L){o[L<0?~L:L]=1}),i.push(k)}}return l.forEach(function(_,b){var T,k=h.arcs[_<0?~_:_];k.length<3&&!k[1][0]&&!k[1][1]&&(T=l[++x],l[x]=_,l[b]=T)}),l.forEach(function(_){var b,T,k=function(S){var E,z=h.arcs[S<0?~S:S],D=z[0];return h.transform?(E=[0,0],z.forEach(function(j){E[0]+=j[0],E[1]+=j[1]})):E=z[z.length-1],S<0?[E,D]:[D,E]}(_),L=k[0],A=k[1];if(b=c[L])if(delete c[b.end],b.push(_),b.end=A,T=p[A]){delete p[T.start];var I=T===b?b:b.concat(T);p[I.start=b.start]=c[I.end=T.end]=I}else p[b.start]=c[b.end]=b;else if(b=p[A])if(delete p[b.start],b.unshift(_),b.start=L,T=c[L]){delete c[T.end];var P=T===b?b:T.concat(b);p[P.start=T.start]=c[P.end=b.end]=P}else p[b.start]=c[b.end]=b;else p[(b=[_]).start=L]=c[b.end=A]=b}),f(c,p),f(p,c),l.forEach(function(_){o[_<0?~_:_]||i.push([_])}),i}function a(h,l,o){var p,c,i;if(arguments.length>1)p=r(h,l,o);else for(c=0,p=new Array(i=h.arcs.length);c<i;++c)p[c]=c;return{type:"MultiLineString",arcs:n(h,p)}}function r(h,l,o){var p,c=[],i=[];function x(b){var T=b<0?~b:b;(i[T]||(i[T]=[])).push({i:b,g:p})}function f(b){b.forEach(x)}function _(b){b.forEach(f)}return function b(T){switch(p=T,T.type){case"GeometryCollection":T.geometries.forEach(b);break;case"LineString":f(T.arcs);break;case"MultiLineString":case"Polygon":_(T.arcs);break;case"MultiPolygon":(function(k){k.forEach(_)})(T.arcs)}}(l),i.forEach(o==null?function(b){c.push(b[0].i)}:function(b){o(b[0].g,b[b.length-1].g)&&c.push(b[0].i)}),c}function g(h,l){var o={},p=[],c=[];function i(f){f.forEach(function(_){_.forEach(function(b){(o[b=b<0?~b:b]||(o[b]=[])).push(f)})}),p.push(f)}function x(f){return function(_){for(var b,T=-1,k=_.length,L=_[k-1],A=0;++T<k;)b=L,L=_[T],A+=b[0]*L[1]-b[1]*L[0];return Math.abs(A)}(t(h,{type:"Polygon",arcs:[f]}).coordinates[0])}return l.forEach(function f(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(f);break;case"Polygon":i(_.arcs);break;case"MultiPolygon":_.arcs.forEach(i)}}),p.forEach(function(f){if(!f._){var _=[],b=[f];for(f._=1,c.push(_);f=b.pop();)_.push(f),f.forEach(function(T){T.forEach(function(k){o[k<0?~k:k].forEach(function(L){L._||(L._=1,b.push(L))})})})}}),p.forEach(function(f){delete f._}),{type:"MultiPolygon",arcs:c.map(function(f){var _,b=[];if(f.forEach(function(I){I.forEach(function(P){P.forEach(function(S){o[S<0?~S:S].length<2&&b.push(S)})})}),(_=(b=n(h,b)).length)>1)for(var T,k,L=1,A=x(b[0]);L<_;++L)(T=x(b[L]))>A&&(k=b[0],b[0]=b[L],b[L]=k,A=T);return b}).filter(function(f){return f.length>0})}}function u(h,l){for(var o=0,p=h.length;o<p;){var c=o+p>>>1;h[c]<l?o=c+1:p=c}return o}function s(h){if(h==null)return v;var l,o,p=h.scale[0],c=h.scale[1],i=h.translate[0],x=h.translate[1];return function(f,_){_||(l=o=0);var b=2,T=f.length,k=new Array(T),L=Math.round((f[0]-i)/p),A=Math.round((f[1]-x)/c);for(k[0]=L-l,l=L,k[1]=A-o,o=A;b<T;)k[b]=f[b],++b;return k}}d.bbox=y,d.feature=function(h,l){return typeof l=="string"&&(l=h.objects[l]),l.type==="GeometryCollection"?{type:"FeatureCollection",features:l.geometries.map(function(o){return e(h,o)})}:e(h,l)},d.merge=function(h){return t(h,g.apply(this,arguments))},d.mergeArcs=g,d.mesh=function(h){return t(h,a.apply(this,arguments))},d.meshArcs=a,d.neighbors=function(h){var l={},o=h.map(function(){return[]});function p(I,P){I.forEach(function(S){S<0&&(S=~S);var E=l[S];E?E.push(P):l[S]=[P]})}function c(I,P){I.forEach(function(S){p(S,P)})}var i={LineString:p,MultiLineString:c,Polygon:c,MultiPolygon:function(I,P){I.forEach(function(S){c(S,P)})}};for(var x in h.forEach(function I(P,S){P.type==="GeometryCollection"?P.geometries.forEach(function(E){I(E,S)}):P.type in i&&i[P.type](P.arcs,S)}),l)for(var f=l[x],_=f.length,b=0;b<_;++b)for(var T=b+1;T<_;++T){var k,L=f[b],A=f[T];(k=o[L])[x=u(k,A)]!==A&&k.splice(x,0,A),(k=o[A])[x=u(k,L)]!==L&&k.splice(x,0,L)}return o},d.quantize=function(h,l){if(h.transform)throw new Error("already quantized");if(l&&l.scale)f=h.bbox;else{if(!((o=Math.floor(l))>=2))throw new Error("n must be \u22652");var o,p=(f=h.bbox||y(h))[0],c=f[1],i=f[2],x=f[3];l={scale:[i-p?(i-p)/(o-1):1,x-c?(x-c)/(o-1):1],translate:[p,c]}}var f,_,b=s(l),T=h.objects,k={};function L(I){return b(I)}function A(I){var P;switch(I.type){case"GeometryCollection":P={type:"GeometryCollection",geometries:I.geometries.map(A)};break;case"Point":P={type:"Point",coordinates:L(I.coordinates)};break;case"MultiPoint":P={type:"MultiPoint",coordinates:I.coordinates.map(L)};break;default:return I}return I.id!=null&&(P.id=I.id),I.bbox!=null&&(P.bbox=I.bbox),I.properties!=null&&(P.properties=I.properties),P}for(_ in T)k[_]=A(T[_]);return{type:"Topology",bbox:f,transform:l,objects:k,arcs:h.arcs.map(function(I){var P,S=0,E=1,z=I.length,D=new Array(z);for(D[0]=b(I[0],0);++S<z;)((P=b(I[S],S))[0]||P[1])&&(D[E++]=P);return E===1&&(D[E++]=[0,0]),D.length=E,D})}},d.transform=w,d.untransform=s,Object.defineProperty(d,"__esModule",{value:!0})})},{}],317:[function(m,G,W){var d=m("../prototype/is");G.exports=function(v){if(typeof v!="function"||!hasOwnProperty.call(v,"length"))return!1;try{if(typeof v.length!="number"||typeof v.call!="function"||typeof v.apply!="function")return!1}catch{return!1}return!d(v)}},{"../prototype/is":324}],318:[function(m,G,W){var d=m("../value/is"),v=m("../object/is"),w=m("../string/coerce"),y=m("./to-short-string"),e=function(t,n){return t.replace("%v",y(n))};G.exports=function(t,n,a){if(!v(a))throw new TypeError(e(n,t));if(!d(t)){if("default"in a)return a.default;if(a.isOptional)return null}var r=w(a.errorMessage);throw d(r)||(r=n),new TypeError(e(r,t))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(m,G,W){G.exports=function(d){try{return d.toString()}catch{try{return String(d)}catch{return null}}}},{}],320:[function(m,G,W){var d=m("./safe-to-string"),v=/[\n\r\u2028\u2029]/g;G.exports=function(w){var y=d(w);return y===null?"<Non-coercible to string value>":(y.length>100&&(y=y.slice(0,99)+"\u2026"),y=y.replace(v,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(m,G,W){var d=m("../value/is"),v={object:!0,function:!0,undefined:!0};G.exports=function(w){return!!d(w)&&hasOwnProperty.call(v,typeof w)}},{"../value/is":327}],322:[function(m,G,W){var d=m("../lib/resolve-exception"),v=m("./is");G.exports=function(w){return v(w)?w:d(w,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(m,G,W){var d=m("../function/is"),v=/^\s*class[\s{/}]/,w=Function.prototype.toString;G.exports=function(y){return!!d(y)&&!v.test(w.call(y))}},{"../function/is":317}],324:[function(m,G,W){var d=m("../object/is");G.exports=function(v){if(!d(v))return!1;try{return!!v.constructor&&v.constructor.prototype===v}catch{return!1}}},{"../object/is":321}],325:[function(m,G,W){var d=m("../value/is"),v=m("../object/is"),w=Object.prototype.toString;G.exports=function(y){if(!d(y))return null;if(v(y)){var e=y.toString;if(typeof e!="function"||e===w)return null}try{return""+y}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(m,G,W){var d=m("../lib/resolve-exception"),v=m("./is");G.exports=function(w){return v(w)?w:d(w,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(m,G,W){G.exports=function(d){return d!=null}},{}],328:[function(m,G,W){(function(d){(function(){var v=m("bit-twiddle"),w=m("dup"),y=m("buffer").Buffer;d.__TYPEDARRAY_POOL||(d.__TYPEDARRAY_POOL={UINT8:w([32,0]),UINT16:w([32,0]),UINT32:w([32,0]),BIGUINT64:w([32,0]),INT8:w([32,0]),INT16:w([32,0]),INT32:w([32,0]),BIGINT64:w([32,0]),FLOAT:w([32,0]),DOUBLE:w([32,0]),DATA:w([32,0]),UINT8C:w([32,0]),BUFFER:w([32,0])});var e=typeof Uint8ClampedArray<"u",t=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",a=d.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=w([32,0])),a.BIGUINT64||(a.BIGUINT64=w([32,0])),a.BIGINT64||(a.BIGINT64=w([32,0])),a.BUFFER||(a.BUFFER=w([32,0]));var r=a.DATA,g=a.BUFFER;function u(A){if(A){var I=A.length||A.byteLength,P=v.log2(I);r[P].push(A)}}function s(A){A=v.nextPow2(A);var I=v.log2(A),P=r[I];return P.length>0?P.pop():new ArrayBuffer(A)}function h(A){return new Uint8Array(s(A),0,A)}function l(A){return new Uint16Array(s(2*A),0,A)}function o(A){return new Uint32Array(s(4*A),0,A)}function p(A){return new Int8Array(s(A),0,A)}function c(A){return new Int16Array(s(2*A),0,A)}function i(A){return new Int32Array(s(4*A),0,A)}function x(A){return new Float32Array(s(4*A),0,A)}function f(A){return new Float64Array(s(8*A),0,A)}function _(A){return e?new Uint8ClampedArray(s(A),0,A):h(A)}function b(A){return t?new BigUint64Array(s(8*A),0,A):null}function T(A){return n?new BigInt64Array(s(8*A),0,A):null}function k(A){return new DataView(s(A),0,A)}function L(A){A=v.nextPow2(A);var I=v.log2(A),P=g[I];return P.length>0?P.pop():new y(A)}W.free=function(A){if(y.isBuffer(A))g[v.log2(A.length)].push(A);else{if(Object.prototype.toString.call(A)!=="[object ArrayBuffer]"&&(A=A.buffer),!A)return;var I=A.length||A.byteLength,P=0|v.log2(I);r[P].push(A)}},W.freeUint8=W.freeUint16=W.freeUint32=W.freeBigUint64=W.freeInt8=W.freeInt16=W.freeInt32=W.freeBigInt64=W.freeFloat32=W.freeFloat=W.freeFloat64=W.freeDouble=W.freeUint8Clamped=W.freeDataView=function(A){u(A.buffer)},W.freeArrayBuffer=u,W.freeBuffer=function(A){g[v.log2(A.length)].push(A)},W.malloc=function(A,I){if(I===void 0||I==="arraybuffer")return s(A);switch(I){case"uint8":return h(A);case"uint16":return l(A);case"uint32":return o(A);case"int8":return p(A);case"int16":return c(A);case"int32":return i(A);case"float":case"float32":return x(A);case"double":case"float64":return f(A);case"uint8_clamped":return _(A);case"bigint64":return T(A);case"biguint64":return b(A);case"buffer":return L(A);case"data":case"dataview":return k(A);default:return null}return null},W.mallocArrayBuffer=s,W.mallocUint8=h,W.mallocUint16=l,W.mallocUint32=o,W.mallocInt8=p,W.mallocInt16=c,W.mallocInt32=i,W.mallocFloat32=W.mallocFloat=x,W.mallocFloat64=W.mallocDouble=f,W.mallocUint8Clamped=_,W.mallocBigUint64=b,W.mallocBigInt64=T,W.mallocDataView=k,W.mallocBuffer=L,W.clearCache=function(){for(var A=0;A<32;++A)a.UINT8[A].length=0,a.UINT16[A].length=0,a.UINT32[A].length=0,a.INT8[A].length=0,a.INT16[A].length=0,a.INT32[A].length=0,a.FLOAT[A].length=0,a.DOUBLE[A].length=0,a.BIGUINT64[A].length=0,a.BIGINT64[A].length=0,a.UINT8C[A].length=0,r[A].length=0,g[A].length=0}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(m,G,W){var d=/[\'\"]/;G.exports=function(v){return v?(d.test(v.charAt(0))&&(v=v.substr(1)),d.test(v.charAt(v.length-1))&&(v=v.substr(0,v.length-1)),v):""}},{}],330:[function(m,G,W){G.exports=function(d,v,w){Array.isArray(w)||(w=[].slice.call(arguments,2));for(var y=0,e=w.length;y<e;y++){var t=w[y];for(var n in t)if((v[n]===void 0||Array.isArray(v[n])||d[n]!==v[n])&&n in v){var a;if(t[n]===!0)a=v[n];else if(t[n]===!1||typeof t[n]=="function"&&(a=t[n](v[n],d,v))===void 0)continue;d[n]=a}}return d}},{}],331:[function(m,G,W){(function(d){(function(){function v(w){try{if(!d.localStorage)return!1}catch{return!1}var y=d.localStorage[w];return y!=null&&String(y).toLowerCase()==="true"}G.exports=function(w,y){if(v("noDeprecation"))return w;var e=!1;return function(){if(!e){if(v("throwDeprecation"))throw new Error(y);v("traceDeprecation")?console.trace(y):console.warn(y),e=!0}return w.apply(this,arguments)}}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(m,G,W){var d=m("get-canvas-context");G.exports=function(v){return d("webgl",v)}},{"get-canvas-context":194}],333:[function(m,G,W){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(u){this.local=this.regionalOptions[u||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(u,s){if(typeof u=="string"){var h=u.match(t);return h?h[0]:""}var l=this._validateYear(u),o=u.month(),p=""+this.toChineseMonth(l,o);return s&&p.length<2&&(p="0"+p),this.isIntercalaryMonth(l,o)&&(p+="i"),p},monthNames:function(u){if(typeof u=="string"){var s=u.match(n);return s?s[0]:""}var h=this._validateYear(u),l=u.month(),o=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(h,l)-1];return this.isIntercalaryMonth(h,l)&&(o="\u95F0"+o),o},monthNamesShort:function(u){if(typeof u=="string"){var s=u.match(a);return s?s[0]:""}var h=this._validateYear(u),l=u.month(),o=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(h,l)-1];return this.isIntercalaryMonth(h,l)&&(o="\u95F0"+o),o},parseMonth:function(u,s){u=this._validateYear(u);var h,l=parseInt(s);if(isNaN(l))s[0]==="\u95F0"&&(h=!0,s=s.substring(1)),s[s.length-1]==="\u6708"&&(s=s.substring(0,s.length-1)),l=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(s);else{var o=s[s.length-1];h=o==="i"||o==="I"}return this.toMonthIndex(u,l,h)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(u,s){if(u.year&&(u=u.year()),typeof u!="number"||u<1888||u>2111)throw s.replace(/\{0\}/,this.local.name);return u},toMonthIndex:function(u,s,h){var l=this.intercalaryMonth(u);if(h&&s!==l||s<1||s>12)throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return l?!h&&s<=l?s-1:s:s-1},toChineseMonth:function(u,s){u.year&&(s=(u=u.year()).month());var h=this.intercalaryMonth(u);if(s<0||s>(h?12:11))throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return h?s<h?s+1:s:s+1},intercalaryMonth:function(u){return u=this._validateYear(u),r[u-r[0]]>>13},isIntercalaryMonth:function(u,s){u.year&&(s=(u=u.year()).month());var h=this.intercalaryMonth(u);return!!h&&h===s},leapYear:function(u){return this.intercalaryMonth(u)!==0},weekOfYear:function(u,s,h){var l,o=this._validateYear(u,d.local.invalidyear),p=g[o-g[0]],c=p>>9&4095,i=p>>5&15,x=31&p;(l=w.newDate(c,i,x)).add(4-(l.dayOfWeek()||7),"d");var f=this.toJD(u,s,h)-l.toJD();return 1+Math.floor(f/7)},monthsInYear:function(u){return this.leapYear(u)?13:12},daysInMonth:function(u,s){u.year&&(s=u.month(),u=u.year()),u=this._validateYear(u);var h=r[u-r[0]];if(s>(h>>13?12:11))throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return h&1<<12-s?30:29},weekDay:function(u,s,h){return(this.dayOfWeek(u,s,h)||7)<6},toJD:function(u,s,h){var l=this._validate(u,p,h,d.local.invalidDate);u=this._validateYear(l.year()),s=l.month(),h=l.day();var o=this.isIntercalaryMonth(u,s),p=this.toChineseMonth(u,s),c=function(i,x,f,_,b){var T,k,L;if(typeof i=="object")k=i,T=x||{};else{var A;if(!(typeof i=="number"&&i>=1888&&i<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof x=="number"&&x>=1&&x<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof f=="number"&&f>=1&&f<=30))throw new Error("Lunar day outside range 1 - 30");typeof _=="object"?(A=!1,T=_):(A=!!_,T=b||{}),k={year:i,month:x,day:f,isIntercalary:A}}L=k.day-1;var I,P=r[k.year-r[0]],S=P>>13;I=S&&(k.month>S||k.isIntercalary)?k.month:k.month-1;for(var E=0;E<I;E++)L+=P&1<<12-E?30:29;var z=g[k.year-g[0]],D=new Date(z>>9&4095,(z>>5&15)-1,(31&z)+L);return T.year=D.getFullYear(),T.month=1+D.getMonth(),T.day=D.getDate(),T}(u,p,h,o);return w.toJD(c.year,c.month,c.day)},fromJD:function(u){var s=w.fromJD(u),h=function(o,p,c,i){var x,f;if(typeof o=="object")x=o,f=p||{};else{if(!(typeof o=="number"&&o>=1888&&o<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof p=="number"&&p>=1&&p<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof c=="number"&&c>=1&&c<=31))throw new Error("Solar day outside range 1 - 31");x={year:o,month:p,day:c},f=i||{}}var _=g[x.year-g[0]],b=x.year<<9|x.month<<5|x.day;f.year=b>=_?x.year:x.year-1,_=g[f.year-g[0]];var T,k=new Date(_>>9&4095,(_>>5&15)-1,31&_),L=new Date(x.year,x.month-1,x.day);T=Math.round((L-k)/864e5);var A,I=r[f.year-r[0]];for(A=0;A<13;A++){var P=I&1<<12-A?30:29;if(T<P)break;T-=P}var S=I>>13;return!S||A<S?(f.isIntercalary=!1,f.month=1+A):A===S?(f.isIntercalary=!0,f.month=A):(f.isIntercalary=!1,f.month=A),f.day=1+T,f}(s.year(),s.month(),s.day()),l=this.toMonthIndex(h.year,h.month,h.isIntercalary);return this.newDate(h.year,l,h.day)},fromString:function(u){var s=u.match(e),h=this._validateYear(+s[1]),l=+s[2],o=!!s[3],p=this.toMonthIndex(h,l,o),c=+s[4];return this.newDate(h,p,c)},add:function(u,s,h){var l=u.year(),o=u.month(),p=this.isIntercalaryMonth(l,o),c=this.toChineseMonth(l,o),i=Object.getPrototypeOf(y.prototype).add.call(this,u,s,h);if(h==="y"){var x=i.year(),f=i.month(),_=this.isIntercalaryMonth(x,c),b=p&&_?this.toMonthIndex(x,c,!0):this.toMonthIndex(x,c,!1);b!==f&&i.month(b)}return i}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,t=/^\d?\d[iI]?/m,n=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,a=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;d.calendars.chinese=y;var r=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],g=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===13&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return(y=n.year())<0&&y++,n.day()+30*(n.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,t=Math.floor((e-Math.floor((e+366)/1461))/365)+1;t<=0&&t--,e=Math.floor(y)+.5-this.newDate(t,1,1).toJD();var n=Math.floor(e/30)+1,a=e-30*(n-1)+1;return this.newDate(t,n,a)}}),d.calendars.coptic=w},{"../main":347,"object-assign":247}],335:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),400},weekOfYear:function(e,t,n){var a=this.newDate(e,t,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,n){return(this._validate(e,t,n,d.local.invalidDate).day()+1)%8},weekDay:function(e,t,n){var a=this.dayOfWeek(e,t,n);return a>=2&&a<=6},extraInfo:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);return{century:y[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);return e=a.year()+(a.year()<0?1:0),t=a.month(),(n=a.day())+(t>1?16:0)+(t>2?32*(t-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var t=Math.floor(e/400)+1;e-=400*(t-1),e+=e>15?16:0;var n=Math.floor(e/32)+1,a=e-32*(n-1)+1;return this.newDate(t<=0?t-1:t,n,a)}});var y={20:"Fruitbat",21:"Anchovy"};d.calendars.discworld=w},{"../main":347,"object-assign":247}],336:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===13&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return(y=n.year())<0&&y++,n.day()+30*(n.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,t=Math.floor((e-Math.floor((e+366)/1461))/365)+1;t<=0&&t--,e=Math.floor(y)+.5-this.newDate(t,1,1).toJD();var n=Math.floor(e/30)+1,a=e-30*(n-1)+1;return this.newDate(t,n,a)}}),d.calendars.ethiopian=w},{"../main":347,"object-assign":247}],337:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,t){return e-t*Math.floor(e/t)}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){return y(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,n){var a=this.newDate(e,t,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,d.local.invalidMonth),t===12&&this.leapYear(e)||t===8&&y(this.daysInYear(e),10)===5?30:t===9&&y(this.daysInYear(e),10)===3?29:this.daysPerMonth[t-1]},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==6},extraInfo:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);e=a.year(),t=a.month(),n=a.day();var r=e<=0?e+1:e,g=this.jdEpoch+this._delay1(r)+this._delay2(r)+n+1;if(t<7){for(var u=7;u<=this.monthsInYear(e);u++)g+=this.daysInMonth(e,u);for(u=1;u<t;u++)g+=this.daysInMonth(e,u)}else for(u=7;u<t;u++)g+=this.daysInMonth(e,u);return g},_delay1:function(e){var t=Math.floor((235*e-234)/19),n=12084+13753*t,a=29*t+Math.floor(n/25920);return y(3*(a+1),7)<3&&a++,a},_delay2:function(e){var t=this._delay1(e-1),n=this._delay1(e);return this._delay1(e+1)-n==356?2:n-t==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var t=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(t===-1?1:t+1,7,1);)t++;for(var n=e<this.toJD(t,1,1)?7:1;e>this.toJD(t,n,this.daysInMonth(t,n));)n++;var a=e-this.toJD(t,n,1)+1;return this.newDate(t,n,a)}}),d.calendars.hebrew=w},{"../main":347,"object-assign":247}],338:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(y){return(11*this._validate(y,this.minMonth,this.minDay,d.local.invalidYear).year()+14)%30<11},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(y){return this.leapYear(y)?355:354},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===12&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return this.dayOfWeek(y,e,t)!==5},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return y=n.year(),e=n.month(),y=y<=0?y+1:y,(t=n.day())+Math.ceil(29.5*(e-1))+354*(y-1)+Math.floor((3+11*y)/30)+this.jdEpoch-1},fromJD:function(y){y=Math.floor(y)+.5;var e=Math.floor((30*(y-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var t=Math.min(12,Math.ceil((y-29-this.toJD(e,1,1))/29.5)+1),n=y-this.toJD(e,t,1)+1;return this.newDate(e,t,n)}}),d.calendars.islamic=w},{"../main":347,"object-assign":247}],339:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===2&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return y=n.year(),e=n.month(),t=n.day(),y<0&&y++,e<=2&&(y--,e+=12),Math.floor(365.25*(y+4716))+Math.floor(30.6001*(e+1))+t-1524.5},fromJD:function(y){var e=Math.floor(y+.5)+1524,t=Math.floor((e-122.1)/365.25),n=Math.floor(365.25*t),a=Math.floor((e-n)/30.6001),r=a-Math.floor(a<14?1:13),g=t-Math.floor(r>2?4716:4715),u=e-n-Math.floor(30.6001*a);return g<=0&&g--,this.newDate(g,r,u)}}),d.calendars.julian=w},{"../main":347,"object-assign":247}],340:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}function y(t,n){return t-n*Math.floor(t/n)}function e(t,n){return y(t-1,n)+1}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),!1},formatYear:function(t){t=this._validate(t,this.minMonth,this.minDay,d.local.invalidYear).year();var n=Math.floor(t/400);return t%=400,t+=t<0?400:0,n+"."+Math.floor(t/20)+"."+t%20},forYear:function(t){if((t=t.split(".")).length<3)throw"Invalid Mayan year";for(var n=0,a=0;a<t.length;a++){var r=parseInt(t[a],10);if(Math.abs(r)>19||a>0&&r<0)throw"Invalid Mayan year";n=20*n+r}return n},monthsInYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),18},weekOfYear:function(t,n,a){return this._validate(t,n,a,d.local.invalidDate),0},daysInYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),360},daysInMonth:function(t,n){return this._validate(t,n,this.minDay,d.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(t,n,a){return this._validate(t,n,a,d.local.invalidDate).day()},weekDay:function(t,n,a){return this._validate(t,n,a,d.local.invalidDate),!0},extraInfo:function(t,n,a){var r=this._validate(t,n,a,d.local.invalidDate).toJD(),g=this._toHaab(r),u=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[g[0]-1],haabMonth:g[0],haabDay:g[1],tzolkinDayName:this.local.tzolkinMonths[u[0]-1],tzolkinDay:u[0],tzolkinTrecena:u[1]}},_toHaab:function(t){var n=y((t-=this.jdEpoch)+8+340,365);return[Math.floor(n/20)+1,y(n,20)]},_toTzolkin:function(t){return[e((t-=this.jdEpoch)+20,20),e(t+4,13)]},toJD:function(t,n,a){var r=this._validate(t,n,a,d.local.invalidDate);return r.day()+20*r.month()+360*r.year()+this.jdEpoch},fromJD:function(t){t=Math.floor(t)+.5-this.jdEpoch;var n=Math.floor(t/360);t%=360,t+=t<0?360:0;var a=Math.floor(t/20),r=t%20;return this.newDate(n,a,r)}}),d.calendars.mayan=w},{"../main":347,"object-assign":247}],341:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar;var y=d.instance("gregorian");v(w.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear);return y.leapYear(t.year()+(t.year()<1?1:0)+1469)},weekOfYear:function(e,t,n){var a=this.newDate(e,t,n);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidMonth);(e=a.year())<0&&e++;for(var r=a.day(),g=1;g<a.month();g++)r+=this.daysPerMonth[g-1];return r+y.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var t=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(t+1,1,1);)t++;for(var n=e-Math.floor(this.toJD(t,1,1)+.5)+1,a=1;n>this.daysInMonth(t,a);)n-=this.daysInMonth(t,a),a++;return this.newDate(t,a,n)}}),d.calendars.nanakshahi=w},{"../main":347,"object-assign":247}],342:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(y){return this.daysInYear(y)!==this.daysPerYear},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(y){if(y=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[y]===void 0)return this.daysPerYear;for(var e=0,t=this.minMonth;t<=12;t++)e+=this.NEPALI_CALENDAR_DATA[y][t];return e},daysInMonth:function(y,e){return y.year&&(e=y.month(),y=y.year()),this._validate(y,e,this.minDay,d.local.invalidMonth),this.NEPALI_CALENDAR_DATA[y]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[y][e]},weekDay:function(y,e,t){return this.dayOfWeek(y,e,t)!==6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);y=n.year(),e=n.month(),t=n.day();var a=d.instance(),r=0,g=e,u=y;this._createMissingCalendarData(y);var s=y-(g>9||g===9&&t>=this.NEPALI_CALENDAR_DATA[u][0]?56:57);for(e!==9&&(r=t,g--);g!==9;)g<=0&&(g=12,u--),r+=this.NEPALI_CALENDAR_DATA[u][g],g--;return e===9?(r+=t-this.NEPALI_CALENDAR_DATA[u][0])<0&&(r+=a.daysInYear(s)):r+=this.NEPALI_CALENDAR_DATA[u][9]-this.NEPALI_CALENDAR_DATA[u][0],a.newDate(s,1,1).add(r,"d").toJD()},fromJD:function(y){var e=d.instance().fromJD(y),t=e.year(),n=e.dayOfYear(),a=t+56;this._createMissingCalendarData(a);for(var r=9,g=this.NEPALI_CALENDAR_DATA[a][0],u=this.NEPALI_CALENDAR_DATA[a][r]-g+1;n>u;)++r>12&&(r=1,a++),u+=this.NEPALI_CALENDAR_DATA[a][r];var s=this.NEPALI_CALENDAR_DATA[a][r]-(u-n);return this.newDate(a,r,s)},_createMissingCalendarData:function(y){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var t=y-1;t<y+2;t++)this.NEPALI_CALENDAR_DATA[t]===void 0&&(this.NEPALI_CALENDAR_DATA[t]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),d.calendars.nepali=w},{"../main":347,"object-assign":247}],343:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,t){return e-t*Math.floor(e/t)}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return 682*((t.year()-(t.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,t,n){var a=this.newDate(e,t,n);return a.add(-(a.dayOfWeek()+1)%7,"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==5},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);e=a.year(),t=a.month(),n=a.day();var r=e-(e>=0?474:473),g=474+y(r,2820);return n+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*g-110)/2816)+365*(g-1)+1029983*Math.floor(r/2820)+this.jdEpoch-1},fromJD:function(e){var t=(e=Math.floor(e)+.5)-this.toJD(475,1,1),n=Math.floor(t/1029983),a=y(t,1029983),r=2820;if(a!==1029982){var g=Math.floor(a/366),u=y(a,366);r=Math.floor((2134*g+2816*u+2815)/1028522)+g+1}var s=r+2820*n+474;s=s<=0?s-1:s;var h=e-this.toJD(s,1,1)+1,l=h<=186?Math.ceil(h/31):Math.ceil((h-6)/30),o=e-this.toJD(s,l,1)+1;return this.newDate(s,l,o)}}),d.calendars.persian=w,d.calendars.jalali=w},{"../main":347,"object-assign":247}],344:[function(m,G,W){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(t.year()),w.leapYear(e)},weekOfYear:function(e,t,n){var a=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(a.year()),w.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);return e=this._t2gYear(a.year()),w.toJD(e,a.month(),a.day())},fromJD:function(e){var t=w.fromJD(e),n=this._g2tYear(t.year());return this.newDate(n,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),d.calendars.taiwan=y},{"../main":347,"object-assign":247}],345:[function(m,G,W){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(t.year()),w.leapYear(e)},weekOfYear:function(e,t,n){var a=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(a.year()),w.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate);return e=this._t2gYear(a.year()),w.toJD(e,a.month(),a.day())},fromJD:function(e){var t=w.fromJD(e),n=this._g2tYear(t.year());return this.newDate(n,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),d.calendars.thai=y},{"../main":347,"object-assign":247}],346:[function(m,G,W){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return this.daysInYear(t.year())===355},weekOfYear:function(e,t,n){var a=this.newDate(e,t,n);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var t=0,n=1;n<=12;n++)t+=this.daysInMonth(e,n);return t},daysInMonth:function(e,t){for(var n=this._validate(e,t,this.minDay,d.local.invalidMonth).toJD()-24e5+.5,a=0,r=0;r<y.length;r++){if(y[r]>n)return y[a]-y[a-1];a++}return 30},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==5},toJD:function(e,t,n){var a=this._validate(e,t,n,d.local.invalidDate),r=12*(a.year()-1)+a.month()-15292;return a.day()+y[r-1]-1+24e5-.5},fromJD:function(e){for(var t=e-24e5+.5,n=0,a=0;a<y.length&&!(y[a]>t);a++)n++;var r=n+15292,g=Math.floor((r-1)/12),u=g+1,s=r-12*g,h=t-y[n-1]+1;return this.newDate(u,s,h)},isValid:function(e,t,n){var a=d.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(a=(e=e.year!=null?e.year:e)>=1276&&e<=1500),a},_validate:function(e,t,n,a){var r=d.baseCalendar.prototype._validate.apply(this,arguments);if(r.year<1276||r.year>1500)throw a.replace(/\{0\}/,this.local.name);return r}}),d.calendars.ummalqura=w;var y=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(m,G,W){var d=m("object-assign");function v(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function w(a,r,g,u){if(this._calendar=a,this._year=r,this._month=g,this._day=u,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function y(a,r){return"000000".substring(0,r-(a=""+a).length)+a}function e(){this.shortYearCutoff="+10"}function t(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}d(v.prototype,{instance:function(a,r){a=(a||"gregorian").toLowerCase(),r=r||"";var g=this._localCals[a+"-"+r];if(!g&&this.calendars[a]&&(g=new this.calendars[a](r),this._localCals[a+"-"+r]=g),!g)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return g},newDate:function(a,r,g,u,s){return(u=(a!=null&&a.year?a.calendar():typeof u=="string"?this.instance(u,s):u)||this.instance()).newDate(a,r,g)},substituteDigits:function(a){return function(r){return(r+"").replace(/[0-9]/g,function(g){return a[g]})}},substituteChineseDigits:function(a,r){return function(g){for(var u="",s=0;g>0;){var h=g%10;u=(h===0?"":a[h]+r[s])+u,s++,g=Math.floor(g/10)}return u.indexOf(a[1]+r[1])===0&&(u=u.substr(1)),u||a[0]}}}),d(w.prototype,{newDate:function(a,r,g){return this._calendar.newDate(a==null?this:a,r,g)},year:function(a){return arguments.length===0?this._year:this.set(a,"y")},month:function(a){return arguments.length===0?this._month:this.set(a,"m")},day:function(a){return arguments.length===0?this._day:this.set(a,"d")},date:function(a,r,g){if(!this._calendar.isValid(a,r,g))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=r,this._day=g,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,r){return this._calendar.add(this,a,r)},set:function(a,r){return this._calendar.set(this,a,r)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var r=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return r===0?0:r<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+y(Math.abs(this.year()),4)+"-"+y(this.month(),2)+"-"+y(this.day(),2)}}),d(e.prototype,{_validateLevel:0,newDate:function(a,r,g){return a==null?this.today():(a.year&&(this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),g=a.day(),r=a.month(),a=a.year()),new w(this,a,r,g))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(r.year()<0?"-":"")+y(Math.abs(r.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(a,r){var g=this._validate(a,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(g.month()+this.monthsInYear(g)-this.firstMonth)%this.monthsInYear(g)+this.minMonth},fromMonthOfYear:function(a,r){var g=(r+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,g,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),g},daysInYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(r)?366:365},dayOfYear:function(a,r,g){var u=this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return u.toJD()-this.newDate(u.year(),this.fromMonthOfYear(u.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,r,g){var u=this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(u))+2)%this.daysInWeek()},extraInfo:function(a,r,g){return this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(a,r,g){return this._validate(a,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,r,g),r,g)},_add:function(a,r,g){if(this._validateLevel++,g==="d"||g==="w"){var u=a.toJD()+r*(g==="w"?this.daysInWeek():1),s=a.calendar().fromJD(u);return this._validateLevel--,[s.year(),s.month(),s.day()]}try{var h=a.year()+(g==="y"?r:0),l=a.monthOfYear()+(g==="m"?r:0);s=a.day(),g==="y"?(a.month()!==this.fromMonthOfYear(h,l)&&(l=this.newDate(h,a.month(),this.minDay).monthOfYear()),l=Math.min(l,this.monthsInYear(h)),s=Math.min(s,this.daysInMonth(h,this.fromMonthOfYear(h,l)))):g==="m"&&(function(p){for(;l<p.minMonth;)h--,l+=p.monthsInYear(h);for(var c=p.monthsInYear(h);l>c-1+p.minMonth;)h++,l-=c,c=p.monthsInYear(h)}(this),s=Math.min(s,this.daysInMonth(h,this.fromMonthOfYear(h,l))));var o=[h,this.fromMonthOfYear(h,l),s];return this._validateLevel--,o}catch(p){throw this._validateLevel--,p}},_correctAdd:function(a,r,g,u){if(!(this.hasYearZero||u!=="y"&&u!=="m"||r[0]!==0&&a.year()>0==r[0]>0)){var s={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[u],h=g<0?-1:1;r=this._add(a,g*s[0]+h*s[1],s[2])}return a.date(r[0],r[1],r[2])},set:function(a,r,g){this._validate(a,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var u=g==="y"?r:a.year(),s=g==="m"?r:a.month(),h=g==="d"?r:a.day();return g!=="y"&&g!=="m"||(h=Math.min(h,this.daysInMonth(u,s))),a.date(u,s,h)},isValid:function(a,r,g){this._validateLevel++;var u=this.hasYearZero||a!==0;if(u){var s=this.newDate(a,r,this.minDay);u=r>=this.minMonth&&r-this.minMonth<this.monthsInYear(s)&&g>=this.minDay&&g-this.minDay<this.daysInMonth(s)}return this._validateLevel--,u},toJSDate:function(a,r,g){var u=this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(u)).toJSDate()},fromJSDate:function(a){return this.fromJD(n.instance().fromJSDate(a).toJD())},_validate:function(a,r,g,u){if(a.year){if(this._validateLevel===0&&this.name!==a.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(a,r,g))throw u.replace(/\{0\}/,this.local.name);var s=this.newDate(a,r,g);return this._validateLevel--,s}catch(h){throw this._validateLevel--,h}}}),t.prototype=new e,d(t.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(a=r.year()+(r.year()<0?1:0))%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(a,r,g){var u=this.newDate(a,r,g);return u.add(4-(u.dayOfWeek()||7),"d"),Math.floor((u.dayOfYear()-1)/7)+1},daysInMonth:function(a,r){var g=this._validate(a,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===2&&this.leapYear(g.year())?1:0)},weekDay:function(a,r,g){return(this.dayOfWeek(a,r,g)||7)<6},toJD:function(a,r,g){var u=this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);a=u.year(),r=u.month(),g=u.day(),a<0&&a++,r<3&&(r+=12,a--);var s=Math.floor(a/100),h=2-s+Math.floor(s/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(r+1))+g+h-1524.5},fromJD:function(a){var r=Math.floor(a+.5),g=Math.floor((r-186721625e-2)/36524.25),u=(g=r+1+g-Math.floor(g/4))+1524,s=Math.floor((u-122.1)/365.25),h=Math.floor(365.25*s),l=Math.floor((u-h)/30.6001),o=u-h-Math.floor(30.6001*l),p=l-(l>13.5?13:1),c=s-(p>2.5?4716:4715);return c<=0&&c--,this.newDate(c,p,o)},toJSDate:function(a,r,g){var u=this._validate(a,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),s=new Date(u.year(),u.month()-1,u.day());return s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),s.setHours(s.getHours()>12?s.getHours()+2:0),s},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var n=G.exports=new v;n.cdate=w,n.baseCalendar=e,n.calendars.gregorian=t},{"object-assign":247}],348:[function(m,G,W){var d=m("object-assign"),v=m("./main");d(v.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),v.local=v.regionalOptions[""],d(v.cdate.prototype,{formatDate:function(w,y){return typeof w!="string"&&(y=w,w=""),this._calendar.formatDate(w||"",this,y)}}),d(v.baseCalendar.prototype,{UNIX_EPOCH:v.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:v.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(w,y,e){if(typeof w!="string"&&(e=y,y=w,w=""),!y)return"";if(y.calendar()!==this)throw v.local.invalidFormat||v.regionalOptions[""].invalidFormat;w=w||this.local.dateFormat;for(var t,n,a,r,g=(e=e||{}).dayNamesShort||this.local.dayNamesShort,u=e.dayNames||this.local.dayNames,s=e.monthNumbers||this.local.monthNumbers,h=e.monthNamesShort||this.local.monthNamesShort,l=e.monthNames||this.local.monthNames,o=(e.calculateWeek||this.local.calculateWeek,function(L,A){for(var I=1;k+I<w.length&&w.charAt(k+I)===L;)I++;return k+=I-1,Math.floor(I/(A||1))>1}),p=function(L,A,I,P){var S=""+A;if(o(L,P))for(;S.length<I;)S="0"+S;return S},c=this,i=function(L){return typeof s=="function"?s.call(c,L,o("m")):_(p("m",L.month(),2))},x=function(L,A){return A?typeof l=="function"?l.call(c,L):l[L.month()-c.minMonth]:typeof h=="function"?h.call(c,L):h[L.month()-c.minMonth]},f=this.local.digits,_=function(L){return e.localNumbers&&f?f(L):L},b="",T=!1,k=0;k<w.length;k++)if(T)w.charAt(k)!=="'"||o("'")?b+=w.charAt(k):T=!1;else switch(w.charAt(k)){case"d":b+=_(p("d",y.day(),2));break;case"D":b+=(t="D",n=y.dayOfWeek(),a=g,r=u,o(t)?r[n]:a[n]);break;case"o":b+=p("o",y.dayOfYear(),3);break;case"w":b+=p("w",y.weekOfYear(),2);break;case"m":b+=i(y);break;case"M":b+=x(y,o("M"));break;case"y":b+=o("y",2)?y.year():(y.year()%100<10?"0":"")+y.year()%100;break;case"Y":o("Y",2),b+=y.formatYear();break;case"J":b+=y.toJD();break;case"@":b+=(y.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":b+=(y.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":o("'")?b+="'":T=!0;break;default:b+=w.charAt(k)}return b},parseDate:function(w,y,e){if(y==null)throw v.local.invalidArguments||v.regionalOptions[""].invalidArguments;if((y=typeof y=="object"?y.toString():y+"")==="")return null;w=w||this.local.dateFormat;var t=(e=e||{}).shortYearCutoff||this.shortYearCutoff;t=typeof t!="string"?t:this.today().year()%100+parseInt(t,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,r=e.parseMonth||this.local.parseMonth,g=e.monthNumbers||this.local.monthNumbers,u=e.monthNamesShort||this.local.monthNamesShort,s=e.monthNames||this.local.monthNames,h=-1,l=-1,o=-1,p=-1,c=-1,i=!1,x=!1,f=function(z,D){for(var j=1;P+j<w.length&&w.charAt(P+j)===z;)j++;return P+=j-1,Math.floor(j/(D||1))>1},_=function(z,D){var j=f(z,D),V=[2,3,j?4:2,j?4:2,10,11,20]["oyYJ@!".indexOf(z)+1],Z=new RegExp("^-?\\d{1,"+V+"}"),Q=y.substring(I).match(Z);if(!Q)throw(v.local.missingNumberAt||v.regionalOptions[""].missingNumberAt).replace(/\{0\}/,I);return I+=Q[0].length,parseInt(Q[0],10)},b=this,T=function(){if(typeof g=="function"){f("m");var z=g.call(b,y.substring(I));return I+=z.length,z}return _("m")},k=function(z,D,j,V){for(var Z=f(z,V)?j:D,Q=0;Q<Z.length;Q++)if(y.substr(I,Z[Q].length).toLowerCase()===Z[Q].toLowerCase())return I+=Z[Q].length,Q+b.minMonth;throw(v.local.unknownNameAt||v.regionalOptions[""].unknownNameAt).replace(/\{0\}/,I)},L=function(){if(typeof s=="function"){var z=f("M")?s.call(b,y.substring(I)):u.call(b,y.substring(I));return I+=z.length,z}return k("M",u,s)},A=function(){if(y.charAt(I)!==w.charAt(P))throw(v.local.unexpectedLiteralAt||v.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,I);I++},I=0,P=0;P<w.length;P++)if(x)w.charAt(P)!=="'"||f("'")?A():x=!1;else switch(w.charAt(P)){case"d":p=_("d");break;case"D":k("D",n,a);break;case"o":c=_("o");break;case"w":_("w");break;case"m":o=T();break;case"M":o=L();break;case"y":var S=P;i=!f("y",2),P=S,l=_("y",2);break;case"Y":l=_("Y",2);break;case"J":h=_("J")+.5,y.charAt(I)==="."&&(I++,_("J"));break;case"@":h=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":h=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":I=y.length;break;case"'":f("'")?A():x=!0;break;default:A()}if(I<y.length)throw v.local.unexpectedText||v.regionalOptions[""].unexpectedText;if(l===-1?l=this.today().year():l<100&&i&&(l+=t===-1?1900:this.today().year()-this.today().year()%100-(l<=t?0:100)),typeof o=="string"&&(o=r.call(this,l,o)),c>-1){o=1,p=c;for(var E=this.daysInMonth(l,o);p>E;E=this.daysInMonth(l,o))o++,p-=E}return h>-1?this.fromJD(h):this.newDate(l,o,p)},determineDate:function(w,y,e,t,n){e&&typeof e!="object"&&(n=t,t=e,e=null),typeof t!="string"&&(n=t,t="");var a=this;return y=y?y.newDate():null,w=w==null?y:typeof w=="string"?function(r){try{return a.parseDate(t,r,n)}catch{}for(var g=((r=r.toLowerCase()).match(/^c/)&&e?e.newDate():null)||a.today(),u=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,s=u.exec(r);s;)g.add(parseInt(s[1],10),s[2]||"d"),s=u.exec(r);return g}(w):typeof w=="number"?isNaN(w)||w===1/0||w===-1/0?y:a.today().add(w,"d"):a.newDate(w)}})},{"./main":347,"object-assign":247}],349:[function(m,G,W){G.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(m,G,W){var d=m("./arrow_paths"),v=m("../../plots/font_attributes"),w=m("../../plots/cartesian/constants"),y=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=y("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:v({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",w.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",w.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",w.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",w.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:v({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("./draw").draw;function y(t){var n=t._fullLayout;d.filterVisible(n.annotations).forEach(function(a){var r=v.getFromId(t,a.xref),g=v.getFromId(t,a.yref),u=v.getRefType(a.xref),s=v.getRefType(a.yref);a._extremes={},u==="range"&&e(a,r),s==="range"&&e(a,g)})}function e(t,n){var a,r=n._id,g=r.charAt(0),u=t[g],s=t["a"+g],h=t[g+"ref"],l=t["a"+g+"ref"],o=t["_"+g+"padplus"],p=t["_"+g+"padminus"],c={x:1,y:-1}[g]*t[g+"shift"],i=3*t.arrowsize*t.arrowwidth||0,x=i+c,f=i-c,_=3*t.startarrowsize*t.arrowwidth||0,b=_+c,T=_-c;if(l===h){var k=v.findExtremes(n,[n.r2c(u)],{ppadplus:x,ppadminus:f}),L=v.findExtremes(n,[n.r2c(s)],{ppadplus:Math.max(o,b),ppadminus:Math.max(p,T)});a={min:[k.min[0],L.min[0]],max:[k.max[0],L.max[0]]}}else b=s?b+s:b,T=s?T-s:T,a=v.findExtremes(n,[n.r2c(u)],{ppadplus:Math.max(o,x,b),ppadminus:Math.max(p,f,T)});t._extremes[r]=a}G.exports=function(t){var n=t._fullLayout;if(d.filterVisible(n.annotations).length&&t._fullData.length)return d.syncOrAsync([w,y],t)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=m("../../plot_api/plot_template").arrayEditor;function y(t,n){var a,r,g,u,s,h,l,o=t._fullLayout.annotations,p=[],c=[],i=[],x=(n||[]).length;for(a=0;a<o.length;a++)if(u=(g=o[a]).clicktoshow){for(r=0;r<x;r++)if(h=(s=n[r]).xaxis,l=s.yaxis,h._id===g.xref&&l._id===g.yref&&h.d2r(s.x)===e(g._xclick,h)&&l.d2r(s.y)===e(g._yclick,l)){(g.visible?u==="onout"?c:i:p).push(a);break}r===x&&g.visible&&u==="onout"&&c.push(a)}return{on:p,off:c,explicitOff:i}}function e(t,n){return n.type==="log"?n.l2r(t):n.d2r(t)}G.exports={hasClickToShow:function(t,n){var a=y(t,n);return a.on.length>0||a.explicitOff.length>0},onClick:function(t,n){var a,r,g=y(t,n),u=g.on,s=g.off.concat(g.explicitOff),h={},l=t._fullLayout.annotations;if(!(!u.length&&!s.length)){for(a=0;a<u.length;a++)(r=w(t.layout,"annotations",l[u[a]])).modifyItem("visible",!0),d.extendFlat(h,r.getUpdateObj());for(a=0;a<s.length;a++)(r=w(t.layout,"annotations",l[s[a]])).modifyItem("visible",!1),d.extendFlat(h,r.getUpdateObj());return v.call("update",t,{},h)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(m,G,W){var d=m("../../lib"),v=m("../color");G.exports=function(w,y,e,t){t("opacity");var n=t("bgcolor"),a=t("bordercolor"),r=v.opacity(a);t("borderpad");var g=t("borderwidth"),u=t("showarrow");if(t("text",u?" ":e._dfltTitle.annotation),t("textangle"),d.coerceFont(t,"font",e.font),t("width"),t("align"),t("height")&&t("valign"),u){var s,h,l=t("arrowside");l.indexOf("end")!==-1&&(s=t("arrowhead"),h=t("arrowsize")),l.indexOf("start")!==-1&&(t("startarrowhead",s),t("startarrowsize",h)),t("arrowcolor",r?y.bordercolor:v.defaultLine),t("arrowwidth",2*(r&&g||1)),t("standoff"),t("startstandoff")}var o=t("hovertext"),p=e.hoverlabel||{};if(o){var c=t("hoverlabel.bgcolor",p.bgcolor||(v.opacity(n)?v.rgb(n):v.defaultLine)),i=t("hoverlabel.bordercolor",p.bordercolor||v.contrast(c));d.coerceFont(t,"hoverlabel.font",{family:p.font.family,size:p.font.size,color:p.font.color||i})}t("captureevents",!!o)}},{"../../lib":515,"../color":367}],354:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib/to_log_range");G.exports=function(w,y,e,t){y=y||{};var n=e==="log"&&y.type==="linear",a=e==="linear"&&y.type==="log";if(n||a)for(var r,g,u=w._fullLayout.annotations,s=y._id.charAt(0),h=0;h<u.length;h++)r=u[h],g="annotations["+h+"].",r[s+"ref"]===y._id&&l(s),r["a"+s+"ref"]===y._id&&l("a"+s);function l(o){var p=r[o],c=null;c=n?v(p,y.range):Math.pow(10,p),d(c)||(c=null),t(g+o,c)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./common_defaults"),e=m("./attributes");function t(n,a,r){function g(L,A){return d.coerce(n,a,e,L,A)}var u=g("visible"),s=g("clicktoshow");if(u||s){y(n,a,r,g);for(var h=a.showarrow,l=["x","y"],o=[-10,-30],p={_fullLayout:r},c=0;c<2;c++){var i=l[c],x=v.coerceRef(n,a,p,i,"","paper");if(x!=="paper"&&v.getFromId(p,x)._annIndices.push(a._index),v.coercePosition(a,p,g,x,i,.5),h){var f="a"+i,_=v.coerceRef(n,a,p,f,"pixel",["pixel","paper"]);_!=="pixel"&&_!==x&&(_=a[f]="pixel");var b=_==="pixel"?o[c]:.4;v.coercePosition(a,p,g,_,f,b)}g(i+"anchor"),g(i+"shift")}if(d.noneOrAll(n,a,["x","y"]),h&&d.noneOrAll(n,a,["ax","ay"]),s){var T=g("xclick"),k=g("yclick");a._xclick=T===void 0?a.x:v.cleanPosition(T,p,a.xref),a._yclick=k===void 0?a.y:v.cleanPosition(k,p,a.yref)}}}G.exports=function(n,a){w(n,a,{name:"annotations",handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../../lib"),e=y.strTranslate,t=m("../../plots/cartesian/axes"),n=m("../color"),a=m("../drawing"),r=m("../fx"),g=m("../../lib/svg_text_utils"),u=m("../../lib/setcursor"),s=m("../dragelement"),h=m("../../plot_api/plot_template").arrayEditor,l=m("./draw_arrow_head");function o(i,x){var f=i._fullLayout.annotations[x]||{},_=t.getFromId(i,f.xref),b=t.getFromId(i,f.yref);_&&_.setScale(),b&&b.setScale(),c(i,f,x,!1,_,b)}function p(i,x,f,_,b){var T=b[f],k=b[f+"ref"],L=f.indexOf("y")!==-1,A=t.getRefType(k)==="domain",I=L?_.h:_.w;return i?A?T+(L?-x:x)/i._length:i.p2r(i.r2p(T)+x):T+(L?-x:x)/I}function c(i,x,f,_,b,T){var k,L,A=i._fullLayout,I=i._fullLayout._size,P=i._context.edits;_?(k="annotation-"+_,L=_+".annotations"):(k="annotation",L="annotations");var S=h(i.layout,L,x),E=S.modifyBase,z=S.modifyItem,D=S.getUpdateObj;A._infolayer.selectAll("."+k+'[data-index="'+f+'"]').remove();var j="clip"+A._uid+"_ann"+f;if(x._input&&x.visible!==!1){var V={x:{},y:{}},Z=+x.textangle||0,Q=A._infolayer.append("g").classed(k,!0).attr("data-index",String(f)).style("opacity",x.opacity),K=Q.append("g").classed("annotation-text-g",!0),$=P[x.showarrow?"annotationTail":"annotationPosition"],ne=x.captureevents||P.annotationText||$,H=K.append("g").style("pointer-events",ne?"all":null).call(u,"pointer").on("click",function(){i._dragging=!1,i.emit("plotly_clickannotation",oe(d.event))});x.hovertext&&H.on("mouseover",function(){var ve=x.hoverlabel,Ae=ve.font,fe=this.getBoundingClientRect(),me=i.getBoundingClientRect();r.loneHover({x0:fe.left-me.left,x1:fe.right-me.left,y:(fe.top+fe.bottom)/2-me.top,text:x.hovertext,color:ve.bgcolor,borderColor:ve.bordercolor,fontFamily:Ae.family,fontSize:Ae.size,fontColor:Ae.color},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:i})}).on("mouseout",function(){r.loneUnhover(A._hoverlayer.node())});var N=x.borderwidth,U=x.borderpad,te=N+U,B=H.append("rect").attr("class","bg").style("stroke-width",N+"px").call(n.stroke,x.bordercolor).call(n.fill,x.bgcolor),X=x.width||x.height,J=A._topclips.selectAll("#"+j).data(X?[0]:[]);J.enter().append("clipPath").classed("annclip",!0).attr("id",j).append("rect"),J.exit().remove();var ee=x.font,re=A._meta?y.templateString(x.text,A._meta):x.text,se=H.append("text").classed("annotation-text",!0).text(re);P.annotationText?se.call(g.makeEditable,{delegate:H,gd:i}).call(de).on("edit",function(ve){x.text=ve,this.call(de),z("text",ve),b&&b.autorange&&E(b._name+".autorange",!0),T&&T.autorange&&E(T._name+".autorange",!0),v.call("_guiRelayout",i,D())}):se.call(de)}else d.selectAll("#"+j).remove();function oe(ve){var Ae={index:f,annotation:x._input,fullAnnotation:x,event:ve};return _&&(Ae.subplotId=_),Ae}function de(ve){return ve.call(a.font,ee).attr({"text-anchor":{left:"start",right:"end"}[x.align]||"middle"}),g.convertToTspans(ve,i,ce),ve}function ce(){var ve=se.selectAll("a");ve.size()===1&&ve.text()===se.text()&&H.insert("a",":first-child").attr({"xlink:xlink:href":ve.attr("xlink:href"),"xlink:xlink:show":ve.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(B.node());var Ae=H.select(".annotation-text-math-group"),fe=!Ae.empty(),me=a.bBox((fe?Ae:se).node()),_e=me.width,le=me.height,ge=x.width||_e,Te=x.height||le,Se=Math.round(ge+2*te),Me=Math.round(Te+2*te);function ze(it,ht){return ht==="auto"&&(ht=it<1/3?"left":it>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[ht]}for(var Oe=!1,De=["x","y"],Xe=0;Xe<De.length;Xe++){var Be,Ie,Re,Ye,Qe,lt=De[Xe],xt=x[lt+"ref"]||lt,wt=x["a"+lt+"ref"],bt={x:b,y:T}[lt],nt=(Z+(lt==="x"?0:-90))*Math.PI/180,$e=Se*Math.cos(nt),vt=Me*Math.sin(nt),Nt=Math.abs($e)+Math.abs(vt),qt=x[lt+"anchor"],Jt=x[lt+"shift"]*(lt==="x"?1:-1),Wt=V[lt],ar=t.getRefType(xt);if(bt&&ar!=="domain"){var Dt=bt.r2fraction(x[lt]);(Dt<0||Dt>1)&&(wt===xt?((Dt=bt.r2fraction(x["a"+lt]))<0||Dt>1)&&(Oe=!0):Oe=!0),Be=bt._offset+bt.r2p(x[lt]),Ye=.5}else{var Ne=ar==="domain";lt==="x"?(Re=x[lt],Be=Ne?bt._offset+bt._length*Re:Be=I.l+I.w*Re):(Re=1-x[lt],Be=Ne?bt._offset+bt._length*Re:Be=I.t+I.h*Re),Ye=x.showarrow?.5:Re}if(x.showarrow){Wt.head=Be;var qe=x["a"+lt];if(Qe=$e*ze(.5,x.xanchor)-vt*ze(.5,x.yanchor),wt===xt){var pe=t.getRefType(wt);pe==="domain"?(lt==="y"&&(qe=1-qe),Wt.tail=bt._offset+bt._length*qe):pe==="paper"?lt==="y"?(qe=1-qe,Wt.tail=I.t+I.h*qe):Wt.tail=I.l+I.w*qe:Wt.tail=bt._offset+bt.r2p(qe),Ie=Qe}else Wt.tail=Be+qe,Ie=Qe+qe;Wt.text=Wt.tail+Qe;var be=A[lt==="x"?"width":"height"];if(xt==="paper"&&(Wt.head=y.constrain(Wt.head,1,be-1)),wt==="pixel"){var Fe=-Math.max(Wt.tail-3,Wt.text),Ve=Math.min(Wt.tail+3,Wt.text)-be;Fe>0?(Wt.tail+=Fe,Wt.text+=Fe):Ve>0&&(Wt.tail-=Ve,Wt.text-=Ve)}Wt.tail+=Jt,Wt.head+=Jt}else Ie=Qe=Nt*ze(Ye,qt),Wt.text=Be+Qe;Wt.text+=Jt,Qe+=Jt,Ie+=Jt,x["_"+lt+"padplus"]=Nt/2+Ie,x["_"+lt+"padminus"]=Nt/2-Ie,x["_"+lt+"size"]=Nt,x["_"+lt+"shift"]=Qe}if(Oe)H.remove();else{var Ke=0,Ge=0;if(x.align!=="left"&&(Ke=(ge-_e)*(x.align==="center"?.5:1)),x.valign!=="top"&&(Ge=(Te-le)*(x.valign==="middle"?.5:1)),fe)Ae.select("svg").attr({x:te+Ke-1,y:te+Ge}).call(a.setClipUrl,X?j:null,i);else{var ct=te+Ge-me.top,st=te+Ke-me.left;se.call(g.positionText,st,ct).call(a.setClipUrl,X?j:null,i)}J.select("rect").call(a.setRect,te,te,ge,Te),B.call(a.setRect,N/2,N/2,Se-N,Me-N),H.call(a.setTranslate,Math.round(V.x.text-Se/2),Math.round(V.y.text-Me/2)),K.attr({transform:"rotate("+Z+","+V.x.text+","+V.y.text+")"});var Mt,Ot=function(it,ht){Q.selectAll(".annotation-arrow-g").remove();var jt=V.x.head,kt=V.y.head,Pt=V.x.tail+it,Ee=V.y.tail+ht,Ze=V.x.text+it,at=V.y.text+ht,pt=y.rotationXYMatrix(Z,Ze,at),St=y.apply2DTransform(pt),Ut=y.apply2DTransform2(pt),Kt=+B.attr("width"),Ht=+B.attr("height"),pr=Ze-.5*Kt,Mr=pr+Kt,hr=at-.5*Ht,Qt=hr+Ht,tr=[[pr,hr,pr,Qt],[pr,Qt,Mr,Qt],[Mr,Qt,Mr,hr],[Mr,hr,pr,hr]].map(Ut);if(!tr.reduce(function(xn,_n){return xn^!!y.segmentsIntersect(jt,kt,jt+1e6,kt+1e6,_n[0],_n[1],_n[2],_n[3])},!1)){tr.forEach(function(xn){var _n=y.segmentsIntersect(Pt,Ee,jt,kt,xn[0],xn[1],xn[2],xn[3]);_n&&(Pt=_n.x,Ee=_n.y)});var rr=x.arrowwidth,fr=x.arrowcolor,yr=x.arrowside,Sr=Q.append("g").style({opacity:n.opacity(fr)}).classed("annotation-arrow-g",!0),Dr=Sr.append("path").attr("d","M"+Pt+","+Ee+"L"+jt+","+kt).style("stroke-width",rr+"px").call(n.stroke,n.rgb(fr));if(l(Dr,yr,x),P.annotationPosition&&Dr.node().parentNode&&!_){var Nr=jt,Wr=kt;if(x.standoff){var hn=Math.sqrt(Math.pow(jt-Pt,2)+Math.pow(kt-Ee,2));Nr+=x.standoff*(Pt-jt)/hn,Wr+=x.standoff*(Ee-kt)/hn}var tn,Fn,an=Sr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Pt-Nr)+","+(Ee-Wr),transform:e(Nr,Wr)}).style("stroke-width",rr+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)");s.init({element:an.node(),gd:i,prepFn:function(){var xn=a.getTranslate(H);tn=xn.x,Fn=xn.y,b&&b.autorange&&E(b._name+".autorange",!0),T&&T.autorange&&E(T._name+".autorange",!0)},moveFn:function(xn,_n){var ti=St(tn,Fn),jr=ti[0]+xn,nn=ti[1]+_n;H.call(a.setTranslate,jr,nn),z("x",p(b,xn,"x",I,x)),z("y",p(T,_n,"y",I,x)),x.axref===x.xref&&z("ax",p(b,xn,"ax",I,x)),x.ayref===x.yref&&z("ay",p(T,_n,"ay",I,x)),Sr.attr("transform",e(xn,_n)),K.attr({transform:"rotate("+Z+","+jr+","+nn+")"})},doneFn:function(){v.call("_guiRelayout",i,D());var xn=document.querySelector(".js-notes-box-panel");xn&&xn.redraw(xn.selectedObj)}})}}};x.showarrow&&Ot(0,0),$&&s.init({element:H.node(),gd:i,prepFn:function(){Mt=K.attr("transform")},moveFn:function(it,ht){var jt="pointer";if(x.showarrow)x.axref===x.xref?z("ax",p(b,it,"ax",I,x)):z("ax",x.ax+it),x.ayref===x.yref?z("ay",p(T,ht,"ay",I.w,x)):z("ay",x.ay+ht),Ot(it,ht);else{if(_)return;var kt,Pt;if(b)kt=p(b,it,"x",I,x);else{var Ee=x._xsize/I.w,Ze=x.x+(x._xshift-x.xshift)/I.w-Ee/2;kt=s.align(Ze+it/I.w,Ee,0,1,x.xanchor)}if(T)Pt=p(T,ht,"y",I,x);else{var at=x._ysize/I.h,pt=x.y-(x._yshift+x.yshift)/I.h-at/2;Pt=s.align(pt-ht/I.h,at,0,1,x.yanchor)}z("x",kt),z("y",Pt),b&&T||(jt=s.getCursor(b?.5:kt,T?.5:Pt,x.xanchor,x.yanchor))}K.attr({transform:e(it,ht)+Mt}),u(H,jt)},clickFn:function(it,ht){x.captureevents&&i.emit("plotly_clickannotation",oe(ht))},doneFn:function(){u(H),v.call("_guiRelayout",i,D());var it=document.querySelector(".js-notes-box-panel");it&&it.redraw(it.selectedObj)}})}}}G.exports={draw:function(i){var x=i._fullLayout;x._infolayer.selectAll(".annotation").remove();for(var f=0;f<x.annotations.length;f++)x.annotations[f].visible&&o(i,f);return w.previousPromises(i)},drawOne:o,drawRaw:c}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(m,G,W){var d=m("@plotly/d3"),v=m("../color"),w=m("./arrow_paths"),y=m("../../lib"),e=y.strScale,t=y.strRotate,n=y.strTranslate;G.exports=function(a,r,g){var u,s,h,l,o=a.node(),p=w[g.arrowhead||0],c=w[g.startarrowhead||0],i=(g.arrowwidth||1)*(g.arrowsize||1),x=(g.arrowwidth||1)*(g.startarrowsize||1),f=r.indexOf("start")>=0,_=r.indexOf("end")>=0,b=p.backoff*i+g.standoff,T=c.backoff*x+g.startstandoff;if(o.nodeName==="line"){u={x:+a.attr("x1"),y:+a.attr("y1")},s={x:+a.attr("x2"),y:+a.attr("y2")};var k=u.x-s.x,L=u.y-s.y;if(l=(h=Math.atan2(L,k))+Math.PI,b&&T&&b+T>Math.sqrt(k*k+L*L))return void Q();if(b){if(b*b>k*k+L*L)return void Q();var A=b*Math.cos(h),I=b*Math.sin(h);s.x+=A,s.y+=I,a.attr({x2:s.x,y2:s.y})}if(T){if(T*T>k*k+L*L)return void Q();var P=T*Math.cos(h),S=T*Math.sin(h);u.x-=P,u.y-=S,a.attr({x1:u.x,y1:u.y})}}else if(o.nodeName==="path"){var E=o.getTotalLength(),z="";if(E<b+T)return void Q();var D=o.getPointAtLength(0),j=o.getPointAtLength(.1);h=Math.atan2(D.y-j.y,D.x-j.x),u=o.getPointAtLength(Math.min(T,E)),z="0px,"+T+"px,";var V=o.getPointAtLength(E),Z=o.getPointAtLength(E-.1);l=Math.atan2(V.y-Z.y,V.x-Z.x),s=o.getPointAtLength(Math.max(0,E-b)),z+=E-(z?T+b:b)+"px,"+E+"px",a.style("stroke-dasharray",z)}function Q(){a.style("stroke-dasharray","0px,100px")}function K($,ne,H,N){$.path&&($.noRotate&&(H=0),d.select(o.parentNode).append("path").attr({class:a.attr("class"),d:$.path,transform:n(ne.x,ne.y)+t(180*H/Math.PI)+e(N)}).style({fill:v.rgb(g.arrowcolor),"stroke-width":0}))}f&&K(c,u,h,x),_&&K(p,s,l,i)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(m,G,W){var d=m("./draw"),v=m("./click");G.exports={moduleType:"component",name:"annotations",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("annotations"),calcAutorange:m("./calc_autorange"),draw:d.draw,drawOne:d.drawOne,drawRaw:d.drawRaw,hasClickToShow:v.hasClickToShow,onClick:v.onClick,convertCoords:m("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(m,G,W){var d=m("../annotations/attributes"),v=m("../../plot_api/edit_types").overrideAll,w=m("../../plot_api/plot_template").templatedArray;G.exports=v(w("annotation",{visible:d.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:d.xanchor,xshift:d.xshift,yanchor:d.yanchor,yshift:d.yshift,text:d.text,textangle:d.textangle,font:d.font,width:d.width,height:d.height,opacity:d.opacity,align:d.align,valign:d.valign,bgcolor:d.bgcolor,bordercolor:d.bordercolor,borderpad:d.borderpad,borderwidth:d.borderwidth,showarrow:d.showarrow,arrowcolor:d.arrowcolor,arrowhead:d.arrowhead,startarrowhead:d.startarrowhead,arrowside:d.arrowside,arrowsize:d.arrowsize,startarrowsize:d.startarrowsize,arrowwidth:d.arrowwidth,standoff:d.standoff,startstandoff:d.startstandoff,hovertext:d.hovertext,hoverlabel:d.hoverlabel,captureevents:d.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes");function w(y,e){var t=e.fullSceneLayout.domain,n=e.fullLayout._size,a={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};y._xa={},d.extendFlat(y._xa,a),v.setConvert(y._xa),y._xa._offset=n.l+t.x[0]*n.w,y._xa.l2p=function(){return .5*(1+y._pdata[0]/y._pdata[3])*n.w*(t.x[1]-t.x[0])},y._ya={},d.extendFlat(y._ya,a),v.setConvert(y._ya),y._ya._offset=n.t+(1-t.y[1])*n.h,y._ya.l2p=function(){return .5*(1-y._pdata[1]/y._pdata[3])*n.h*(t.y[1]-t.y[0])}}G.exports=function(y){for(var e=y.fullSceneLayout.annotations,t=0;t<e.length;t++)w(e[t],y);y.fullLayout._infolayer.selectAll(".annotation-"+y.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("../annotations/common_defaults"),e=m("./attributes");function t(n,a,r,g){function u(h,l){return d.coerce(n,a,e,h,l)}function s(h){var l=h+"axis",o={_fullLayout:{}};return o._fullLayout[l]=r[l],v.coercePosition(a,o,u,h,h,.5)}u("visible")&&(y(n,a,g.fullLayout,u),s("x"),s("y"),s("z"),d.noneOrAll(n,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",u("xanchor"),u("yanchor"),u("xshift"),u("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",u("ax",-10),u("ay",-30),d.noneOrAll(n,a,["ax","ay"])))}G.exports=function(n,a,r){w(n,a,{name:"annotations",handleItemDefaults:t,fullLayout:r.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(m,G,W){var d=m("../annotations/draw").drawRaw,v=m("../../plots/gl3d/project"),w=["x","y","z"];G.exports=function(y){for(var e=y.fullSceneLayout,t=y.dataScale,n=e.annotations,a=0;a<n.length;a++){for(var r=n[a],g=!1,u=0;u<3;u++){var s=w[u],h=r[s],l=e[s+"axis"].r2fraction(h);if(l<0||l>1){g=!0;break}}g?y.fullLayout._infolayer.select(".annotation-"+y.id+'[data-index="'+a+'"]').remove():(r._pdata=v(y.glplot.cameraParams,[e.xaxis.r2l(r.x)*t[0],e.yaxis.r2l(r.y)*t[1],e.zaxis.r2l(r.z)*t[2]]),d(y.graphDiv,r,a,y.id,r._xa,r._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(m,G,W){var d=m("../../registry"),v=m("../../lib");G.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:m("./attributes")}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),includeBasePlot:function(w,y){var e=d.subplotsRegistry.gl3d;if(!!e)for(var t=e.attrRegex,n=Object.keys(w),a=0;a<n.length;a++){var r=n[a];t.test(r)&&(w[r].annotations||[]).length&&(v.pushUnique(y._basePlotModules,e),v.pushUnique(y._subplots.gl3d,r))}},convert:m("./convert"),draw:m("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(m,G,W){G.exports=m("world-calendars/dist/main"),m("world-calendars/dist/plus"),m("world-calendars/dist/calendars/chinese"),m("world-calendars/dist/calendars/coptic"),m("world-calendars/dist/calendars/discworld"),m("world-calendars/dist/calendars/ethiopian"),m("world-calendars/dist/calendars/hebrew"),m("world-calendars/dist/calendars/islamic"),m("world-calendars/dist/calendars/julian"),m("world-calendars/dist/calendars/mayan"),m("world-calendars/dist/calendars/nanakshahi"),m("world-calendars/dist/calendars/nepali"),m("world-calendars/dist/calendars/persian"),m("world-calendars/dist/calendars/taiwan"),m("world-calendars/dist/calendars/thai"),m("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(m,G,W){var d=m("./calendars"),v=m("../../lib"),w=m("../../constants/numerical"),y=w.EPOCHJD,e=w.ONEDAY,t={valType:"enumerated",values:v.sortObjectKeys(d.calendars),editType:"calc",dflt:"gregorian"},n=function(c,i,x,f){var _={};return _[x]=t,v.coerce(c,i,_,x,f)},a={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},r={};function g(c){var i=r[c];return i||(i=r[c]=d.instance(c))}function u(c){return v.extendFlat({},t,{description:c})}function s(c){return"Sets the calendar system to use with `"+c+"` date data."}var h={xcalendar:u(s("x"))},l=v.extendFlat({},h,{ycalendar:u(s("y"))}),o=v.extendFlat({},l,{zcalendar:u(s("z"))}),p=u(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));G.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:o,surface:o,mesh3d:o,scattergl:l,ohlc:h,candlestick:h},layout:{calendar:u(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:p},yaxis:{calendar:p},scene:{xaxis:{calendar:p},yaxis:{calendar:p},zaxis:{calendar:p}},polar:{radialaxis:{calendar:p}}},transforms:{filter:{valuecalendar:u(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:u(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:t,handleDefaults:n,handleTraceDefaults:function(c,i,x,f){for(var _=0;_<x.length;_++)n(c,i,x[_]+"calendar",f.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:g,worldCalFmt:function(c,i,x){for(var f,_,b,T,k,L=Math.floor((i+.05)/e)+y,A=g(x).fromJD(L),I=0;(I=c.indexOf("%",I))!==-1;)(f=c.charAt(I+1))==="0"||f==="-"||f==="_"?(b=3,_=c.charAt(I+2),f==="_"&&(f="-")):(_=f,f="0",b=2),(T=a[_])?(k=T==="##"?"##":A.formatDate(T[f]),c=c.substr(0,I)+k+c.substr(I+b),I+=k.length):I+=b;return c}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(m,G,W){W.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],W.defaultLine="#444",W.lightLine="#eee",W.background="#fff",W.borderLine="#BEC8D9",W.lightFraction=1e3/11},{}],367:[function(m,G,W){var d=m("tinycolor2"),v=m("fast-isnumeric"),w=m("../../lib/array").isTypedArray,y=G.exports={},e=m("./attributes");y.defaults=e.defaults;var t=y.defaultLine=e.defaultLine;y.lightLine=e.lightLine;var n=y.background=e.background;function a(r){if(v(r)||typeof r!="string")return r;var g=r.trim();if(g.substr(0,3)!=="rgb")return r;var u=g.match(/^rgba?\s*\(([^()]*)\)$/);if(!u)return r;var s=u[1].trim().split(/\s*[\s,]\s*/),h=g.charAt(3)==="a"&&s.length===4;if(!h&&s.length!==3)return r;for(var l=0;l<s.length;l++){if(!s[l].length||(s[l]=Number(s[l]),!(s[l]>=0)))return r;if(l===3)s[l]>1&&(s[l]=1);else if(s[l]>=1)return r}var o=Math.round(255*s[0])+", "+Math.round(255*s[1])+", "+Math.round(255*s[2]);return h?"rgba("+o+", "+s[3]+")":"rgb("+o+")"}y.tinyRGB=function(r){var g=r.toRgb();return"rgb("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+")"},y.rgb=function(r){return y.tinyRGB(d(r))},y.opacity=function(r){return r?d(r).getAlpha():0},y.addOpacity=function(r,g){var u=d(r).toRgb();return"rgba("+Math.round(u.r)+", "+Math.round(u.g)+", "+Math.round(u.b)+", "+g+")"},y.combine=function(r,g){var u=d(r).toRgb();if(u.a===1)return d(r).toRgbString();var s=d(g||n).toRgb(),h=s.a===1?s:{r:255*(1-s.a)+s.r*s.a,g:255*(1-s.a)+s.g*s.a,b:255*(1-s.a)+s.b*s.a},l={r:h.r*(1-u.a)+u.r*u.a,g:h.g*(1-u.a)+u.g*u.a,b:h.b*(1-u.a)+u.b*u.a};return d(l).toRgbString()},y.contrast=function(r,g,u){var s=d(r);return s.getAlpha()!==1&&(s=d(y.combine(r,n))),(s.isDark()?g?s.lighten(g):n:u?s.darken(u):t).toString()},y.stroke=function(r,g){var u=d(g);r.style({stroke:y.tinyRGB(u),"stroke-opacity":u.getAlpha()})},y.fill=function(r,g){var u=d(g);r.style({fill:y.tinyRGB(u),"fill-opacity":u.getAlpha()})},y.clean=function(r){if(r&&typeof r=="object"){var g,u,s,h,l=Object.keys(r);for(g=0;g<l.length;g++)if(h=r[s=l[g]],s.substr(s.length-5)==="color")if(Array.isArray(h))for(u=0;u<h.length;u++)h[u]=a(h[u]);else r[s]=a(h);else if(s.substr(s.length-10)==="colorscale"&&Array.isArray(h))for(u=0;u<h.length;u++)Array.isArray(h[u])&&(h[u][1]=a(h[u][1]));else if(Array.isArray(h)){var o=h[0];if(!Array.isArray(o)&&o&&typeof o=="object")for(u=0;u<h.length;u++)y.clean(h[u])}else h&&typeof h=="object"&&!w(h)&&y.clean(h)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(m,G,W){var d=m("../../plots/cartesian/layout_attributes"),v=m("../../plots/font_attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll;G.exports=y({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:d.linecolor,outlinewidth:d.linewidth,bordercolor:d.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:w({},d.ticks,{dflt:""}),ticklabeloverflow:w({},d.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,ticklabelstep:d.ticklabelstep,showticklabels:d.showticklabels,tickfont:v({}),tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,separatethousands:d.separatethousands,exponentformat:d.exponentformat,minexponent:d.minexponent,showexponent:d.showexponent,title:{text:{valType:"string"},font:v({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:v({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(m,G,W){G.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(m,G,W){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("../../plots/cartesian/tick_value_defaults"),y=m("../../plots/cartesian/tick_mark_defaults"),e=m("../../plots/cartesian/tick_label_defaults"),t=m("../../plots/cartesian/prefix_suffix_defaults"),n=m("./attributes");G.exports=function(a,r,g){var u=v.newContainer(r,"colorbar"),s=a.colorbar||{};function h(L,A){return d.coerce(s,u,n,L,A)}var l=g.margin||{t:0,b:0,l:0,r:0},o=g.width-l.l-l.r,p=g.height-l.t-l.b,c=h("orientation")==="v",i=h("thicknessmode");h("thickness",i==="fraction"?30/(c?o:p):30);var x=h("lenmode");h("len",x==="fraction"?1:c?p:o),h("x",c?1.02:.5),h("xanchor",c?"left":"center"),h("xpad"),h("y",c?.5:1.02),h("yanchor",c?"middle":"bottom"),h("ypad"),d.noneOrAll(s,u,["x","y"]),h("outlinecolor"),h("outlinewidth"),h("bordercolor"),h("borderwidth"),h("bgcolor");var f=d.coerce(s,u,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:c?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");h("ticklabeloverflow",f.indexOf("inside")!==-1?"hide past domain":"hide past div"),w(s,u,h,"linear");var _=g.font,b={outerTicks:!1,font:_};f.indexOf("inside")!==-1&&(b.bgColor="black"),t(s,u,h,"linear",b),e(s,u,h,"linear",b),y(s,u,h,"linear",b),h("title.text",g._dfltTitle.colorbar);var T=u.tickfont,k=d.extendFlat({},T,{color:_.color,size:d.bigFont(T.size)});d.coerceFont(h,"title.font",k),h("title.side",c?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(m,G,W){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../plots/cartesian/axes"),t=m("../dragelement"),n=m("../../lib"),a=n.strTranslate,r=m("../../lib/extend").extendFlat,g=m("../../lib/setcursor"),u=m("../drawing"),s=m("../color"),h=m("../titles"),l=m("../../lib/svg_text_utils"),o=m("../colorscale/helpers").flipScale,p=m("../../plots/cartesian/axis_defaults"),c=m("../../plots/cartesian/position_defaults"),i=m("../../plots/cartesian/layout_attributes"),x=m("../../constants/alignment"),f=x.LINE_SPACING,_=x.FROM_TL,b=x.FROM_BR,T=m("./constants").cn;G.exports={draw:function(k){var L=k._fullLayout._infolayer.selectAll("g."+T.colorbar).data(function(A){var I,P,S,E,z=A._fullLayout,D=A.calcdata,j=[];function V(X){return r(X,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Z(){typeof E.calc=="function"?E.calc(A,S,I):(I._fillgradient=P.reversescale?o(P.colorscale):P.colorscale,I._zrange=[P[E.min],P[E.max]])}for(var Q=0;Q<D.length;Q++){var K=D[Q],$=(S=K[0].trace)._module.colorbar;if(S.visible===!0&&$)for(var ne=Array.isArray($),H=ne?$:[$],N=0;N<H.length;N++){var U=(E=H[N]).container;(P=U?S[U]:S)&&P.showscale&&((I=V(P.colorbar))._id="cb"+S.uid+(ne&&U?"-"+U:""),I._traceIndex=S.index,I._propPrefix=(U?U+".":"")+"colorbar.",I._meta=S._meta,Z(),j.push(I))}}for(var te in z._colorAxes)if((P=z[te]).showscale){var B=z._colorAxes[te];(I=V(P.colorbar))._id="cb"+te,I._propPrefix=te+".colorbar.",I._meta=z._meta,E={min:"cmin",max:"cmax"},B[0]!=="heatmap"&&(S=B[1],E.calc=S._module.colorbar.calc),Z(),j.push(I)}return j}(k),function(A){return A._id});L.enter().append("g").attr("class",function(A){return A._id}).classed(T.colorbar,!0),L.each(function(A){var I=d.select(this);n.ensureSingle(I,"rect",T.cbbg),n.ensureSingle(I,"g",T.cbfills),n.ensureSingle(I,"g",T.cblines),n.ensureSingle(I,"g",T.cbaxis,function(S){S.classed(T.crisp,!0)}),n.ensureSingle(I,"g",T.cbtitleunshift,function(S){S.append("g").classed(T.cbtitle,!0)}),n.ensureSingle(I,"rect",T.cboutline);var P=function(S,E,z){var D=E.orientation==="v",j=E.len,V=E.lenmode,Z=E.thickness,Q=E.thicknessmode,K=E.outlinewidth,$=E.borderwidth,ne=E.bgcolor,H=E.xanchor,N=E.yanchor,U=E.xpad,te=E.ypad,B=E.x,X=D?E.y:1-E.y,J=z._fullLayout,ee=J._size,re=E._fillcolor,se=E._line,oe=E.title,de=oe.side,ce=E._zrange||d.extent((typeof re=="function"?re:se.color).domain()),ve=typeof se.color=="function"?se.color:function(){return se.color},Ae=typeof re=="function"?re:function(){return re},fe=E._levels,me=function(ar,Dt,Ne){var qe,pe,be=Dt._levels,Fe=[],Ve=[],Ke=be.end+be.size/100,Ge=be.size,ct=1.001*Ne[0]-.001*Ne[1],st=1.001*Ne[1]-.001*Ne[0];for(pe=0;pe<1e5&&(qe=be.start+pe*Ge,!(Ge>0?qe>=Ke:qe<=Ke));pe++)qe>ct&&qe<st&&Fe.push(qe);if(Dt._fillgradient)Ve=[0];else if(typeof Dt._fillcolor=="function"){var Mt=Dt._filllevels;if(Mt)for(Ke=Mt.end+Mt.size/100,Ge=Mt.size,pe=0;pe<1e5&&(qe=Mt.start+pe*Ge,!(Ge>0?qe>=Ke:qe<=Ke));pe++)qe>Ne[0]&&qe<Ne[1]&&Ve.push(qe);else(Ve=Fe.map(function(Ot){return Ot-be.size/2})).push(Ve[Ve.length-1]+be.size)}else Dt._fillcolor&&typeof Dt._fillcolor=="string"&&(Ve=[0]);return be.size<0&&(Fe.reverse(),Ve.reverse()),{line:Fe,fill:Ve}}(0,E,ce),_e=me.fill,le=me.line,ge=Math.round(Z*(Q==="fraction"?D?ee.w:ee.h:1)),Te=ge/(D?ee.w:ee.h),Se=Math.round(j*(V==="fraction"?D?ee.h:ee.w:1)),Me=Se/(D?ee.h:ee.w),ze=Math.round(D?B*ee.w+U:X*ee.h+te),Oe={center:.5,right:1}[H]||0,De={top:1,middle:.5}[N]||0,Xe=D?B-Oe*Te:X-De*Te,Be=D?X-De*Me:B-Oe*Me,Ie=Math.round(D?ee.h*(1-Be):ee.w*Be);E._lenFrac=Me,E._thickFrac=Te,E._uFrac=Xe,E._vFrac=Be;var Re=E._axis=function(ar,Dt,Ne){var qe=ar._fullLayout,pe=Dt.orientation==="v",be={type:"linear",range:Ne,tickmode:Dt.tickmode,nticks:Dt.nticks,tick0:Dt.tick0,dtick:Dt.dtick,tickvals:Dt.tickvals,ticktext:Dt.ticktext,ticks:Dt.ticks,ticklen:Dt.ticklen,tickwidth:Dt.tickwidth,tickcolor:Dt.tickcolor,showticklabels:Dt.showticklabels,ticklabelposition:Dt.ticklabelposition,ticklabeloverflow:Dt.ticklabeloverflow,ticklabelstep:Dt.ticklabelstep,tickfont:Dt.tickfont,tickangle:Dt.tickangle,tickformat:Dt.tickformat,exponentformat:Dt.exponentformat,minexponent:Dt.minexponent,separatethousands:Dt.separatethousands,showexponent:Dt.showexponent,showtickprefix:Dt.showtickprefix,tickprefix:Dt.tickprefix,showticksuffix:Dt.showticksuffix,ticksuffix:Dt.ticksuffix,title:Dt.title,showline:!0,anchor:"free",side:pe?"right":"bottom",position:1},Fe=pe?"y":"x",Ve={type:"linear",_id:Fe+Dt._id},Ke={letter:Fe,font:qe.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:qe.calendar};function Ge(ct,st){return n.coerce(be,Ve,i,ct,st)}return p(be,Ve,Ge,Ke,qe),c(be,Ve,Ge,Ke),Ve}(z,E,ce);Re.position=Te+(D?B+U/ee.w:X+te/ee.h);var Ye=["top","bottom"].indexOf(de)!==-1;if(D&&Ye&&(Re.title.side=de,Re.titlex=B+U/ee.w,Re.titley=Be+(oe.side==="top"?Me-te/ee.h:te/ee.h)),D||Ye||(Re.title.side=de,Re.titley=X+te/ee.h,Re.titlex=Be+U/ee.w),se.color&&E.tickmode==="auto"){Re.tickmode="linear",Re.tick0=fe.start;var Qe=fe.size,lt=n.constrain(Se/50,4,15)+1,xt=(ce[1]-ce[0])/((E.nticks||lt)*Qe);if(xt>1){var wt=Math.pow(10,Math.floor(Math.log(xt)/Math.LN10));Qe*=wt*n.roundUp(xt/wt,[2,5,10]),(Math.abs(fe.start)/fe.size+1e-6)%1<2e-6&&(Re.tick0=0)}Re.dtick=Qe}Re.domain=D?[Be+te/ee.h,Be+Me-te/ee.h]:[Be+U/ee.w,Be+Me-U/ee.w],Re.setScale(),S.attr("transform",a(Math.round(ee.l),Math.round(ee.t)));var bt,nt=S.select("."+T.cbtitleunshift).attr("transform",a(-Math.round(ee.l),-Math.round(ee.t))),$e=Re.ticklabelposition,vt=Re.title.font.size,Nt=S.select("."+T.cbaxis),qt=0,Jt=0;function Wt(ar,Dt){var Ne={propContainer:Re,propName:E._propPrefix+"title",traceIndex:E._traceIndex,_meta:E._meta,placeholder:J._dfltTitle.colorbar,containerGroup:S.select("."+T.cbtitle)},qe=ar.charAt(0)==="h"?ar.substr(1):"h"+ar;S.selectAll("."+qe+",."+qe+"-math-group").remove(),h.draw(z,ar,r(Ne,Dt||{}))}return n.syncOrAsync([w.previousPromises,function(){var ar,Dt;(D&&Ye||!D&&!Ye)&&(de==="top"&&(ar=U+ee.l+ee.w*B,Dt=te+ee.t+ee.h*(1-Be-Me)+3+.75*vt),de==="bottom"&&(ar=U+ee.l+ee.w*B,Dt=te+ee.t+ee.h*(1-Be)-3-.25*vt),de==="right"&&(Dt=te+ee.t+ee.h*X+3+.75*vt,ar=U+ee.l+ee.w*Be),Wt(Re._id+"title",{attributes:{x:ar,y:Dt,"text-anchor":D?"start":"middle"}}))},function(){if(!D&&!Ye||D&&Ye){var ar,Dt=S.select("."+T.cbtitle),Ne=Dt.select("text"),qe=[-K/2,K/2],pe=Dt.select(".h"+Re._id+"title-math-group").node(),be=15.6;if(Ne.node()&&(be=parseInt(Ne.node().style.fontSize,10)*f),pe?(ar=u.bBox(pe),Jt=ar.width,(qt=ar.height)>be&&(qe[1]-=(qt-be)/2)):Ne.node()&&!Ne.classed(T.jsPlaceholder)&&(ar=u.bBox(Ne.node()),Jt=ar.width,qt=ar.height),D){if(qt){if(qt+=5,de==="top")Re.domain[1]-=qt/ee.h,qe[1]*=-1;else{Re.domain[0]+=qt/ee.h;var Fe=l.lineCount(Ne);qe[1]+=(1-Fe)*be}Dt.attr("transform",a(qe[0],qe[1])),Re.setScale()}}else Jt&&(de==="right"&&(Re.domain[0]+=(Jt+vt/2)/ee.w),Dt.attr("transform",a(qe[0],qe[1])),Re.setScale())}S.selectAll("."+T.cbfills+",."+T.cblines).attr("transform",D?a(0,Math.round(ee.h*(1-Re.domain[1]))):a(Math.round(ee.w*Re.domain[0]),0)),Nt.attr("transform",D?a(0,Math.round(-ee.t)):a(Math.round(-ee.l),0));var Ve=S.select("."+T.cbfills).selectAll("rect."+T.cbfill).attr("style","").data(_e);Ve.enter().append("rect").classed(T.cbfill,!0).style("stroke","none"),Ve.exit().remove();var Ke=ce.map(Re.c2p).map(Math.round).sort(function(Ot,it){return Ot-it});Ve.each(function(Ot,it){var ht=[it===0?ce[0]:(_e[it]+_e[it-1])/2,it===_e.length-1?ce[1]:(_e[it]+_e[it+1])/2].map(Re.c2p).map(Math.round);D&&(ht[1]=n.constrain(ht[1]+(ht[1]>ht[0])?1:-1,Ke[0],Ke[1]));var jt=d.select(this).attr(D?"x":"y",ze).attr(D?"y":"x",d.min(ht)).attr(D?"width":"height",Math.max(ge,2)).attr(D?"height":"width",Math.max(d.max(ht)-d.min(ht),2));if(E._fillgradient)u.gradient(jt,z,E._id,D?"vertical":"horizontalreversed",E._fillgradient,"fill");else{var kt=Ae(Ot).replace("e-","");jt.attr("fill",v(kt).toHexString())}});var Ge=S.select("."+T.cblines).selectAll("path."+T.cbline).data(se.color&&se.width?le:[]);Ge.enter().append("path").classed(T.cbline,!0),Ge.exit().remove(),Ge.each(function(Ot){var it=ze,ht=Math.round(Re.c2p(Ot))+se.width/2%1;d.select(this).attr("d","M"+(D?it+","+ht:ht+","+it)+(D?"h":"v")+ge).call(u.lineGroupStyle,se.width,ve(Ot),se.dash)}),Nt.selectAll("g."+Re._id+"tick,path").remove();var ct=ze+ge+(K||0)/2-(E.ticks==="outside"?1:0),st=e.calcTicks(Re),Mt=e.getTickSigns(Re)[2];return e.drawTicks(z,Re,{vals:Re.ticks==="inside"?e.clipEnds(Re,st):st,layer:Nt,path:e.makeTickPath(Re,ct,Mt),transFn:e.makeTransTickFn(Re)}),e.drawLabels(z,Re,{vals:st,layer:Nt,transFn:e.makeTransTickLabelFn(Re),labelFns:e.makeLabelFns(Re,ct)})},function(){if(D&&!Ye||!D&&Ye){var ar,Dt,Ne=Re.position||0,qe=Re._offset+Re._length/2;if(de==="right")Dt=qe,ar=ee.l+ee.w*Ne+10+vt*(Re.showticklabels?1:.5);else if(ar=qe,de==="bottom"&&(Dt=ee.t+ee.h*Ne+10+($e.indexOf("inside")===-1?Re.tickfont.size:0)+(Re.ticks!=="intside"&&E.ticklen||0)),de==="top"){var pe=oe.text.split("<br>").length;Dt=ee.t+ee.h*Ne+10-ge-f*vt*pe}Wt((D?"h":"v")+Re._id+"title",{avoid:{selection:d.select(z).selectAll("g."+Re._id+"tick"),side:de,offsetTop:D?0:ee.t,offsetLeft:D?ee.l:0,maxShift:D?J.width:J.height},attributes:{x:ar,y:Dt,"text-anchor":"middle"},transform:{rotate:D?-90:0,offset:0}})}},w.previousPromises,function(){var ar,Dt=ge+K/2;$e.indexOf("inside")===-1&&(ar=u.bBox(Nt.node()),Dt+=D?ar.width:ar.height),bt=nt.select("text");var Ne=0,qe=D&&de==="top",pe=!D&&de==="right",be=0;if(bt.node()&&!bt.classed(T.jsPlaceholder)){var Fe,Ve=nt.select(".h"+Re._id+"title-math-group").node();Ve&&(D&&Ye||!D&&!Ye)?(Ne=(ar=u.bBox(Ve)).width,Fe=ar.height):(Ne=(ar=u.bBox(nt.node())).right-ee.l-(D?ze:Ie),Fe=ar.bottom-ee.t-(D?Ie:ze),D||de!=="top"||(Dt+=ar.height,be=ar.height)),pe&&(bt.attr("transform",a(Ne/2+vt/2,0)),Ne*=2),Dt=Math.max(Dt,D?Ne:Fe)}var Ke=2*(D?U:te)+Dt+$+K/2,Ge=0;!D&&oe.text&&N==="bottom"&&X<=0&&(Ke+=Ge=Ke/2,be+=Ge),J._hColorbarMoveTitle=Ge,J._hColorbarMoveCBTitle=be;var ct=$+K;S.select("."+T.cbbg).attr("x",(D?ze:Ie)-ct/2-(D?U:0)).attr("y",(D?Ie:ze)-(D?Se:te+be-Ge)).attr(D?"width":"height",Math.max(Ke-Ge,2)).attr(D?"height":"width",Math.max(Se+ct,2)).call(s.fill,ne).call(s.stroke,E.bordercolor).style("stroke-width",$);var st=pe?Math.max(Ne-10,0):0;if(S.selectAll("."+T.cboutline).attr("x",(D?ze:Ie+U)+st).attr("y",(D?Ie+te-Se:ze)+(qe?qt:0)).attr(D?"width":"height",Math.max(ge,2)).attr(D?"height":"width",Math.max(Se-(D?2*te+qt:2*U+st),2)).call(s.stroke,E.outlinecolor).style({fill:"none","stroke-width":K}),S.attr("transform",a(ee.l-(D?Oe*Ke:0),ee.t-(D?0:(1-De)*Ke-be))),!D&&($||v(ne).getAlpha()&&!v.equals(J.paper_bgcolor,ne))){var Mt=Nt.selectAll("text"),Ot=Mt[0].length,it=S.select("."+T.cbbg).node(),ht=u.bBox(it),jt=u.getTranslate(S);Mt.each(function(St,Ut){var Kt=Ot-1;if(Ut===0||Ut===Kt){var Ht,pr=u.bBox(this),Mr=u.getTranslate(this);if(Ut===Kt){var hr=pr.right+Mr.x;(Ht=ht.right+jt.x+Ie-$-2+B-hr)>0&&(Ht=0)}else if(Ut===0){var Qt=pr.left+Mr.x;(Ht=ht.left+jt.x+Ie+$+2-Qt)<0&&(Ht=0)}Ht&&(Ot<3?this.setAttribute("transform","translate("+Ht+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var kt={},Pt=_[H],Ee=b[H],Ze=_[N],at=b[N],pt=Ke-ge;D?(V==="pixels"?(kt.y=X,kt.t=Se*Ze,kt.b=Se*at):(kt.t=kt.b=0,kt.yt=X+j*Ze,kt.yb=X-j*at),Q==="pixels"?(kt.x=B,kt.l=Ke*Pt,kt.r=Ke*Ee):(kt.l=pt*Pt,kt.r=pt*Ee,kt.xl=B-Z*Pt,kt.xr=B+Z*Ee)):(V==="pixels"?(kt.x=B,kt.l=Se*Pt,kt.r=Se*Ee):(kt.l=kt.r=0,kt.xl=B+j*Pt,kt.xr=B-j*Ee),Q==="pixels"?(kt.y=1-X,kt.t=Ke*Ze,kt.b=Ke*at):(kt.t=pt*Ze,kt.b=pt*at,kt.yt=X-Z*Ze,kt.yb=X+Z*at)),w.autoMargin(z,E._id,kt)}],z)}(I,A,k);P&&P.then&&(k._promises||[]).push(P),k._context.edits.colorbarPosition&&function(S,E,z){var D,j,V,Z=E.orientation==="v",Q=z._fullLayout._size;t.init({element:S.node(),gd:z,prepFn:function(){D=S.attr("transform"),g(S)},moveFn:function(K,$){S.attr("transform",D+a(K,$)),j=t.align((Z?E._uFrac:E._vFrac)+K/Q.w,Z?E._thickFrac:E._lenFrac,0,1,E.xanchor),V=t.align((Z?E._vFrac:1-E._uFrac)-$/Q.h,Z?E._lenFrac:E._thickFrac,0,1,E.yanchor);var ne=t.getCursor(j,V,E.xanchor,E.yanchor);g(S,ne)},doneFn:function(){if(g(S),j!==void 0&&V!==void 0){var K={};K[E._propPrefix+"x"]=j,K[E._propPrefix+"y"]=V,E._traceIndex!==void 0?y.call("_guiRestyle",z,K,E._traceIndex):y.call("_guiRelayout",z,K)}}})}(I,A,k)}),L.exit().each(function(A){w.autoMargin(k,A._id)}).remove(),L.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(m,G,W){var d=m("../../lib");G.exports=function(v){return d.isPlainObject(v.colorbar)}},{"../../lib":515}],373:[function(m,G,W){G.exports={moduleType:"component",name:"colorbar",attributes:m("./attributes"),supplyDefaults:m("./defaults"),draw:m("./draw").draw,hasColorbar:m("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(m,G,W){var d=m("../colorbar/attributes"),v=m("../../lib/regex").counter,w=m("../../lib/sort_object_keys"),y=m("./scales.js").scales;w(y);function e(t){return"`"+t+"`"}G.exports=function(t,n){t=t||"";var a,r=(n=n||{}).cLetter||"c",g=("onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(t),"noScale"in n?n.noScale:t==="marker.line"),u="showScaleDflt"in n?n.showScaleDflt:r==="z",s=typeof n.colorscaleDflt=="string"?y[n.colorscaleDflt]:null,h=n.editTypeOverride||"",l=t?t+".":"";"colorAttr"in n?(a=n.colorAttr,n.colorAttr):e(l+(a={z:"z",c:"color"}[r]));var o=r+"auto",p=r+"min",c=r+"max",i=r+"mid",x={};x[p]=x[c]=void 0;var f={};f[o]=!1;var _={};return a==="color"&&(_.color={valType:"color",arrayOk:!0,editType:h||"style"},n.anim&&(_.color.anim=!0)),_[o]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:x},_[p]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:f},_[c]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:f},_[i]={valType:"number",dflt:null,editType:"calc",impliedEdits:x},_.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},_.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},_.reversescale={valType:"boolean",dflt:!1,editType:"plot"},g||(_.showscale={valType:"boolean",dflt:u,editType:"calc"},_.colorbar=d),n.noColorAxis||(_.coloraxis={valType:"subplotid",regex:v("coloraxis"),dflt:null,editType:"calc"}),_}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("./helpers").extractOpts;G.exports=function(y,e,t){var n,a=y._fullLayout,r=t.vals,g=t.containerStr,u=g?v.nestedProperty(e,g).get():e,s=w(u),h=s.auto!==!1,l=s.min,o=s.max,p=s.mid,c=function(){return v.aggNums(Math.min,null,r)},i=function(){return v.aggNums(Math.max,null,r)};l===void 0?l=c():h&&(l=u._colorAx&&d(l)?Math.min(l,c()):c()),o===void 0?o=i():h&&(o=u._colorAx&&d(o)?Math.max(o,i()):i()),h&&p!==void 0&&(o-p>p-l?l=p-(o-p):o-p<p-l&&(o=p+(p-l))),l===o&&(l-=.5,o+=.5),s._sync("min",l),s._sync("max",o),s.autocolorscale&&(n=l*o<0?a.colorscale.diverging:l>=0?a.colorscale.sequential:a.colorscale.sequentialminus,s._sync("colorscale",n))}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(m,G,W){var d=m("../../lib"),v=m("./helpers").hasColorscale,w=m("./helpers").extractOpts;G.exports=function(y,e){function t(h,l){var o=h["_"+l];o!==void 0&&(h[l]=o)}function n(h,l){var o=l.container?d.nestedProperty(h,l.container).get():h;if(o)if(o.coloraxis)o._colorAx=e[o.coloraxis];else{var p=w(o),c=p.auto;(c||p.min===void 0)&&t(o,l.min),(c||p.max===void 0)&&t(o,l.max),p.autocolorscale&&t(o,"colorscale")}}for(var a=0;a<y.length;a++){var r=y[a],g=r._module.colorbar;if(g)if(Array.isArray(g))for(var u=0;u<g.length;u++)n(r,g[u]);else n(r,g);v(r,"marker.line")&&n(r,{container:"marker.line",min:"cmin",max:"cmax"})}for(var s in e._colorAxes)n(e[s],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../colorbar/has_colorbar"),y=m("../colorbar/defaults"),e=m("./scales").isValid,t=m("../../registry").traceIs;function n(a,r){var g=r.slice(0,r.length-1);return r?v.nestedProperty(a,g).get()||{}:a}G.exports=function a(r,g,u,s,h){var l=h.prefix,o=h.cLetter,p="_module"in g,c=n(r,l),i=n(g,l),x=n(g._template||{},l)||{},f=function(){return delete r.coloraxis,delete g.coloraxis,a(r,g,u,s,h)};if(p){var _=u._colorAxes||{},b=s(l+"coloraxis");if(b){var T=t(g,"contour")&&v.nestedProperty(g,"contours.coloring").get()||"heatmap",k=_[b];return void(k?(k[2].push(f),k[0]!==T&&(k[0]=!1,v.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" ")))):_[b]=[T,g,[f]])}}var L=c[o+"min"],A=c[o+"max"],I=d(L)&&d(A)&&L<A;s(l+o+"auto",!I)?s(l+o+"mid"):(s(l+o+"min"),s(l+o+"max"));var P,S,E=c.colorscale,z=x.colorscale;E!==void 0&&(P=!e(E)),z!==void 0&&(P=!e(z)),s(l+"autocolorscale",P),s(l+"colorscale"),s(l+"reversescale"),l!=="marker.line."&&(l&&p&&(S=w(c)),s(l+"showscale",S)&&(l&&x&&(i._template=x),y(c,i,u)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(m,G,W){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("fast-isnumeric"),y=m("../../lib"),e=m("../color"),t=m("./scales").isValid,n=["showscale","autocolorscale","colorscale","reversescale","colorbar"],a=["min","max","mid","auto"];function r(l){var o,p,c,i=l._colorAx,x=i||l,f={};for(p=0;p<n.length;p++)f[c=n[p]]=x[c];if(i)for(o="c",p=0;p<a.length;p++)f[c=a[p]]=x["c"+c];else{var _;for(p=0;p<a.length;p++)((_="c"+(c=a[p]))in x||(_="z"+c)in x)&&(f[c]=x[_]);o=_.charAt(0)}return f._sync=function(b,T){var k=a.indexOf(b)!==-1?o+b:b;x[k]=x["_"+k]=T},f}function g(l){for(var o=r(l),p=o.min,c=o.max,i=o.reversescale?u(o.colorscale):o.colorscale,x=i.length,f=new Array(x),_=new Array(x),b=0;b<x;b++){var T=i[b];f[b]=p+T[0]*(c-p),_[b]=T[1]}return{domain:f,range:_}}function u(l){for(var o=l.length,p=new Array(o),c=o-1,i=0;c>=0;c--,i++){var x=l[c];p[i]=[1-x[0],x[1]]}return p}function s(l,o){o=o||{};for(var p=l.domain,c=l.range,i=c.length,x=new Array(i),f=0;f<i;f++){var _=v(c[f]).toRgb();x[f]=[_.r,_.g,_.b,_.a]}var b,T=d.scale.linear().domain(p).range(x).clamp(!0),k=o.noNumericCheck,L=o.returnArray;return(b=k&&L?T:k?function(A){return h(T(A))}:L?function(A){return w(A)?T(A):v(A).isValid()?A:e.defaultLine}:function(A){return w(A)?h(T(A)):v(A).isValid()?A:e.defaultLine}).domain=T.domain,b.range=function(){return c},b}function h(l){var o={r:l[0],g:l[1],b:l[2],a:l[3]};return v(o).toRgbString()}G.exports={hasColorscale:function(l,o,p){var c=o?y.nestedProperty(l,o).get()||{}:l,i=c[p||"color"],x=!1;if(y.isArrayOrTypedArray(i)){for(var f=0;f<i.length;f++)if(w(i[f])){x=!0;break}}return y.isPlainObject(c)&&(x||c.showscale===!0||w(c.cmin)&&w(c.cmax)||t(c.colorscale)||y.isPlainObject(c.colorbar))},extractOpts:r,extractScale:g,flipScale:u,makeColorScaleFunc:s,makeColorScaleFuncFromTrace:function(l,o){return s(g(l),o)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(m,G,W){var d=m("./scales"),v=m("./helpers");G.exports={moduleType:"component",name:"colorscale",attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),handleDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),calc:m("./calc"),scales:d.scales,defaultScale:d.defaultScale,getScale:d.get,isValidScale:d.isValid,hasColorscale:v.hasColorscale,extractOpts:v.extractOpts,extractScale:v.extractScale,flipScale:v.flipScale,makeColorScaleFunc:v.makeColorScaleFunc,makeColorScaleFuncFromTrace:v.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(m,G,W){var d=m("../../lib/extend").extendFlat,v=m("./attributes"),w=m("./scales").scales;G.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:w.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:w.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:w.RdBu,editType:"calc"}},coloraxis:d({_isSubplotObj:!0,editType:"calc"},v("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(m,G,W){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("./layout_attributes"),y=m("./defaults");G.exports=function(e,t){function n(o,p){return d.coerce(e,t,w,o,p)}n("colorscale.sequential"),n("colorscale.sequentialminus"),n("colorscale.diverging");var a,r,g=t._colorAxes;function u(o,p){return d.coerce(a,r,w.coloraxis,o,p)}for(var s in g){var h=g[s];if(h[0])a=e[s]||{},(r=v.newContainer(t,s,"coloraxis"))._name=s,y(a,r,t,u,{prefix:"",cLetter:"c"});else{for(var l=0;l<h[2].length;l++)h[2][l]();delete t._colorAxes[s]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(m,G,W){var d=m("tinycolor2"),v={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},w=v.RdBu;function y(e){var t=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var n=0;n<e.length;n++){var a=e[n];if(a.length!==2||+a[0]<t||!d(a[1]).isValid())return!1;t=+a[0]}return!0}G.exports={scales:v,defaultScale:w,get:function(e,t){if(t||(t=w),!e)return t;function n(){try{e=v[e]||JSON.parse(e)}catch{e=t}}return typeof e=="string"&&(n(),typeof e=="string"&&n()),y(e)?e:t},isValid:function(e){return v[e]!==void 0||y(e)}}},{tinycolor2:313}],383:[function(m,G,W){G.exports=function(d,v,w,y,e){var t=(d-w)/(y-w),n=t+v/(y-w),a=(t+n)/2;return e==="left"||e==="bottom"?t:e==="center"||e==="middle"?a:e==="right"||e==="top"?n:t<2/3-a?t:n>4/3-a?n:a}},{}],384:[function(m,G,W){var d=m("../../lib"),v=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];G.exports=function(w,y,e,t){return w=e==="left"?0:e==="center"?1:e==="right"?2:d.constrain(Math.floor(3*w),0,2),y=t==="bottom"?0:t==="middle"?1:t==="top"?2:d.constrain(Math.floor(3*y),0,2),v[y][w]}},{"../../lib":515}],385:[function(m,G,W){W.selectMode=function(d){return d==="lasso"||d==="select"},W.drawMode=function(d){return d==="drawclosedpath"||d==="drawopenpath"||d==="drawline"||d==="drawrect"||d==="drawcircle"},W.openMode=function(d){return d==="drawline"||d==="drawopenpath"},W.rectMode=function(d){return d==="select"||d==="drawline"||d==="drawrect"||d==="drawcircle"},W.freeMode=function(d){return d==="lasso"||d==="drawclosedpath"||d==="drawopenpath"},W.selectingOrDrawing=function(d){return W.freeMode(d)||W.rectMode(d)}},{}],386:[function(m,G,W){var d=m("mouse-event-offset"),v=m("has-hover"),w=m("has-passive-events"),y=m("../../lib").removeElement,e=m("../../plots/cartesian/constants"),t=G.exports={};t.align=m("./align"),t.getCursor=m("./cursor");var n=m("./unhover");function a(){var g=document.createElement("div");g.className="dragcover";var u=g.style;return u.position="fixed",u.left=0,u.right=0,u.top=0,u.bottom=0,u.zIndex=999999999,u.background="none",document.body.appendChild(g),g}function r(g){return d(g.changedTouches?g.changedTouches[0]:g,document.body)}t.unhover=n.wrapped,t.unhoverRaw=n.raw,t.init=function(g){var u,s,h,l,o,p,c,i,x=g.gd,f=1,_=x._context.doubleClickDelay,b=g.element;x._mouseDownTime||(x._mouseDownTime=0),b.style.pointerEvents="all",b.onmousedown=k,w?(b._ontouchstart&&b.removeEventListener("touchstart",b._ontouchstart),b._ontouchstart=k,b.addEventListener("touchstart",k,{passive:!1})):b.ontouchstart=k;var T=g.clampFn||function(I,P,S){return Math.abs(I)<S&&(I=0),Math.abs(P)<S&&(P=0),[I,P]};function k(I){x._dragged=!1,x._dragging=!0;var P=r(I);u=P[0],s=P[1],c=I.target,p=I,i=I.buttons===2||I.ctrlKey,I.clientX===void 0&&I.clientY===void 0&&(I.clientX=u,I.clientY=s),(h=new Date().getTime())-x._mouseDownTime<_?f+=1:(f=1,x._mouseDownTime=h),g.prepFn&&g.prepFn(I,u,s),v&&!i?(o=a()).style.cursor=window.getComputedStyle(b).cursor:v||(o=document,l=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(b).cursor),document.addEventListener("mouseup",A),document.addEventListener("touchend",A),g.dragmode!==!1&&(I.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(I){I.preventDefault();var P=r(I),S=g.minDrag||e.MINDRAG,E=T(P[0]-u,P[1]-s,S),z=E[0],D=E[1];(z||D)&&(x._dragged=!0,t.unhover(x,I)),x._dragged&&g.moveFn&&!i&&(x._dragdata={element:b,dx:z,dy:D},g.moveFn(z,D))}function A(I){if(delete x._dragdata,g.dragmode!==!1&&(I.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A),v?y(o):l&&(o.documentElement.style.cursor=l,l=null),x._dragging){if(x._dragging=!1,new Date().getTime()-x._mouseDownTime>_&&(f=Math.max(f-1,1)),x._dragged)g.doneFn&&g.doneFn();else if(g.clickFn&&g.clickFn(f,p),!i){var P;try{P=new MouseEvent("click",I)}catch{var S=r(I);(P=document.createEvent("MouseEvents")).initMouseEvent("click",I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,S[0],S[1],I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget)}c.dispatchEvent(P)}x._dragging=!1,x._dragged=!1}else x._dragged=!1}},t.coverSlip=a},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(m,G,W){var d=m("../../lib/events"),v=m("../../lib/throttle"),w=m("../../lib/dom").getGraphDiv,y=m("../fx/constants"),e=G.exports={};e.wrapped=function(t,n,a){(t=w(t))._fullLayout&&v.clear(t._fullLayout._uid+y.HOVERID),e.raw(t,n,a)},e.raw=function(t,n){var a=t._fullLayout,r=t._hoverdata;n||(n={}),n.target&&!t._dragged&&d.triggerHandler(t,"plotly_beforehover",n)===!1||(a._hoverlayer.selectAll("g").remove(),a._hoverlayer.selectAll("line").remove(),a._hoverlayer.selectAll("circle").remove(),t._hoverdata=void 0,n.target&&r&&t.emit("plotly_unhover",{event:n,points:r}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(m,G,W){W.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},W.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("fast-isnumeric"),e=m("tinycolor2"),t=m("../../registry"),n=m("../color"),a=m("../colorscale"),r=v.strTranslate,g=m("../../lib/svg_text_utils"),u=m("../../constants/xmlns_namespaces"),s=m("../../constants/alignment").LINE_SPACING,h=m("../../constants/interactions").DESELECTDIM,l=m("../../traces/scatter/subtypes"),o=m("../../traces/scatter/make_bubble_size_func"),p=m("../../components/fx/helpers").appendArrayPointValue,c=G.exports={};function i(fe,me,_e){var le=me.fillpattern,ge=le&&c.getPatternAttr(le.shape,0,"");if(ge){var Te=c.getPatternAttr(le.bgcolor,0,null),Se=c.getPatternAttr(le.fgcolor,0,null),Me=le.fgopacity,ze=c.getPatternAttr(le.size,0,8),Oe=c.getPatternAttr(le.solidity,0,.3),De=me.uid;c.pattern(fe,"point",_e,De,ge,ze,Oe,void 0,le.fillmode,Te,Se,Me)}else me.fillcolor&&fe.call(n.fill,me.fillcolor)}c.font=function(fe,me,_e,le){v.isPlainObject(me)&&(le=me.color,_e=me.size,me=me.family),me&&fe.style("font-family",me),_e+1&&fe.style("font-size",_e+"px"),le&&fe.call(n.fill,le)},c.setPosition=function(fe,me,_e){fe.attr("x",me).attr("y",_e)},c.setSize=function(fe,me,_e){fe.attr("width",me).attr("height",_e)},c.setRect=function(fe,me,_e,le,ge){fe.call(c.setPosition,me,_e).call(c.setSize,le,ge)},c.translatePoint=function(fe,me,_e,le){var ge=_e.c2p(fe.x),Te=le.c2p(fe.y);return!!(y(ge)&&y(Te)&&me.node())&&(me.node().nodeName==="text"?me.attr("x",ge).attr("y",Te):me.attr("transform",r(ge,Te)),!0)},c.translatePoints=function(fe,me,_e){fe.each(function(le){var ge=d.select(this);c.translatePoint(le,ge,me,_e)})},c.hideOutsideRangePoint=function(fe,me,_e,le,ge,Te){me.attr("display",_e.isPtWithinRange(fe,ge)&&le.isPtWithinRange(fe,Te)?null:"none")},c.hideOutsideRangePoints=function(fe,me){if(me._hasClipOnAxisFalse){var _e=me.xaxis,le=me.yaxis;fe.each(function(ge){var Te=ge[0].trace,Se=Te.xcalendar,Me=Te.ycalendar,ze=t.traceIs(Te,"bar-like")?".bartext":".point,.textpoint";fe.selectAll(ze).each(function(Oe){c.hideOutsideRangePoint(Oe,d.select(this),_e,le,Se,Me)})})}},c.crispRound=function(fe,me,_e){return me&&y(me)?fe._context.staticPlot?me:me<1?1:Math.round(me):_e||0},c.singleLineStyle=function(fe,me,_e,le,ge){me.style("fill","none");var Te=(((fe||[])[0]||{}).trace||{}).line||{},Se=_e||Te.width||0,Me=ge||Te.dash||"";n.stroke(me,le||Te.color),c.dashLine(me,Me,Se)},c.lineGroupStyle=function(fe,me,_e,le){fe.style("fill","none").each(function(ge){var Te=(((ge||[])[0]||{}).trace||{}).line||{},Se=me||Te.width||0,Me=le||Te.dash||"";d.select(this).call(n.stroke,_e||Te.color).call(c.dashLine,Me,Se)})},c.dashLine=function(fe,me,_e){_e=+_e||0,me=c.dashStyle(me,_e),fe.style({"stroke-dasharray":me,"stroke-width":_e+"px"})},c.dashStyle=function(fe,me){me=+me||1;var _e=Math.max(me,3);return fe==="solid"?fe="":fe==="dot"?fe=_e+"px,"+_e+"px":fe==="dash"?fe=3*_e+"px,"+3*_e+"px":fe==="longdash"?fe=5*_e+"px,"+5*_e+"px":fe==="dashdot"?fe=3*_e+"px,"+_e+"px,"+_e+"px,"+_e+"px":fe==="longdashdot"&&(fe=5*_e+"px,"+2*_e+"px,"+_e+"px,"+2*_e+"px"),fe},c.singleFillStyle=function(fe,me){var _e=d.select(fe.node());i(fe,((_e.data()[0]||[])[0]||{}).trace||{},me)},c.fillGroupStyle=function(fe,me){fe.style("stroke-width",0).each(function(_e){var le=d.select(this);_e[0].trace&&i(le,_e[0].trace,me)})};var x=m("./symbol_defs");c.symbolNames=[],c.symbolFuncs=[],c.symbolBackOffs=[],c.symbolNeedLines={},c.symbolNoDot={},c.symbolNoFill={},c.symbolList=[],Object.keys(x).forEach(function(fe){var me=x[fe],_e=me.n;c.symbolList.push(_e,String(_e),fe,_e+100,String(_e+100),fe+"-open"),c.symbolNames[_e]=fe,c.symbolFuncs[_e]=me.f,c.symbolBackOffs[_e]=me.backoff||0,me.needLine&&(c.symbolNeedLines[_e]=!0),me.noDot?c.symbolNoDot[_e]=!0:c.symbolList.push(_e+200,String(_e+200),fe+"-dot",_e+300,String(_e+300),fe+"-open-dot"),me.noFill&&(c.symbolNoFill[_e]=!0)});var f=c.symbolNames.length;function _(fe,me,_e,le){var ge=fe%100;return c.symbolFuncs[ge](me,_e,le)+(fe>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}c.symbolNumber=function(fe){if(y(fe))fe=+fe;else if(typeof fe=="string"){var me=0;fe.indexOf("-open")>0&&(me=100,fe=fe.replace("-open","")),fe.indexOf("-dot")>0&&(me+=200,fe=fe.replace("-dot","")),(fe=c.symbolNames.indexOf(fe))>=0&&(fe+=me)}return fe%100>=f||fe>=400?0:Math.floor(Math.max(fe,0))};var b={x1:1,x2:0,y1:0,y2:0},T={x1:0,x2:0,y1:1,y2:0},k=w("~f"),L={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:T},verticalreversed:{node:"linearGradient",attrs:T,reversed:!0}};c.gradient=function(fe,me,_e,le,ge,Te){for(var Se=ge.length,Me=L[le],ze=new Array(Se),Oe=0;Oe<Se;Oe++)Me.reversed?ze[Se-1-Oe]=[k(100*(1-ge[Oe][0])),ge[Oe][1]]:ze[Oe]=[k(100*ge[Oe][0]),ge[Oe][1]];var De=me._fullLayout,Xe="g"+De._uid+"-"+_e,Be=De._defs.select(".gradients").selectAll("#"+Xe).data([le+ze.join(";")],v.identity);Be.exit().remove(),Be.enter().append(Me.node).each(function(){var Ie=d.select(this);Me.attrs&&Ie.attr(Me.attrs),Ie.attr("id",Xe);var Re=Ie.selectAll("stop").data(ze);Re.exit().remove(),Re.enter().append("stop"),Re.each(function(Ye){var Qe=e(Ye[1]);d.select(this).attr({offset:Ye[0]+"%","stop-color":n.tinyRGB(Qe),"stop-opacity":Qe.getAlpha()})})}),fe.style(Te,H(Xe,me)).style(Te+"-opacity",null),fe.classed("gradient_filled",!0)},c.pattern=function(fe,me,_e,le,ge,Te,Se,Me,ze,Oe,De,Xe){var Be=me==="legend";Me&&(ze==="overlay"?(Oe=Me,De=n.contrast(Oe)):(Oe=void 0,De=Me));var Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e,vt,Nt=_e._fullLayout,qt="p"+Nt._uid+"-"+le,Jt={},Wt=e(De),ar=n.tinyRGB(Wt),Dt=Xe*Wt.getAlpha();switch(ge){case"/":Ie=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),xt="path",Jt={d:Ye="M-"+Ie/4+","+Re/4+"l"+Ie/2+",-"+Re/2+"M0,"+Re+"L"+Ie+",0M"+Ie/4*3+","+Re/4*5+"l"+Ie/2+",-"+Re/2,opacity:Dt,stroke:ar,"stroke-width":(Qe=Se*Te)+"px"};break;case"\\":Ie=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),xt="path",Jt={d:Ye="M"+Ie/4*3+",-"+Re/4+"l"+Ie/2+","+Re/2+"M0,0L"+Ie+","+Re+"M-"+Ie/4+","+Re/4*3+"l"+Ie/2+","+Re/2,opacity:Dt,stroke:ar,"stroke-width":(Qe=Se*Te)+"px"};break;case"x":Ie=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),Ye="M-"+Ie/4+","+Re/4+"l"+Ie/2+",-"+Re/2+"M0,"+Re+"L"+Ie+",0M"+Ie/4*3+","+Re/4*5+"l"+Ie/2+",-"+Re/2+"M"+Ie/4*3+",-"+Re/4+"l"+Ie/2+","+Re/2+"M0,0L"+Ie+","+Re+"M-"+Ie/4+","+Re/4*3+"l"+Ie/2+","+Re/2,Qe=Te-Te*Math.sqrt(1-Se),xt="path",Jt={d:Ye,opacity:Dt,stroke:ar,"stroke-width":Qe+"px"};break;case"|":xt="path",xt="path",Jt={d:Ye="M"+(Ie=Te)/2+",0L"+Ie/2+","+(Re=Te),opacity:Dt,stroke:ar,"stroke-width":(Qe=Se*Te)+"px"};break;case"-":xt="path",xt="path",Jt={d:Ye="M0,"+(Re=Te)/2+"L"+(Ie=Te)+","+Re/2,opacity:Dt,stroke:ar,"stroke-width":(Qe=Se*Te)+"px"};break;case"+":xt="path",Ye="M"+(Ie=Te)/2+",0L"+Ie/2+","+(Re=Te)+"M0,"+Re/2+"L"+Ie+","+Re/2,Qe=Te-Te*Math.sqrt(1-Se),xt="path",Jt={d:Ye,opacity:Dt,stroke:ar,"stroke-width":Qe+"px"};break;case".":Ie=Te,Re=Te,Se<Math.PI/4?lt=Math.sqrt(Se*Te*Te/Math.PI):(wt=Se,bt=Math.PI/4,nt=1,$e=Te/2,vt=Te/Math.sqrt(2),lt=$e+(vt-$e)*(wt-bt)/(nt-bt)),xt="circle",Jt={cx:Ie/2,cy:Re/2,r:lt,opacity:Dt,fill:ar}}var Ne=[ge||"noSh",Oe||"noBg",De||"noFg",Te,Se].join(";"),qe=Nt._defs.select(".patterns").selectAll("#"+qt).data([Ne],v.identity);qe.exit().remove(),qe.enter().append("pattern").each(function(){var pe=d.select(this);if(pe.attr({id:qt,width:Ie+"px",height:Re+"px",patternUnits:"userSpaceOnUse",patternTransform:Be?"scale(0.8)":""}),Oe){var be=e(Oe),Fe=n.tinyRGB(be),Ve=be.getAlpha(),Ke=pe.selectAll("rect").data([0]);Ke.exit().remove(),Ke.enter().append("rect").attr({width:Ie+"px",height:Re+"px",fill:Fe,"fill-opacity":Ve})}var Ge=pe.selectAll(xt).data([0]);Ge.exit().remove(),Ge.enter().append(xt).attr(Jt)}),fe.style("fill",H(qt,_e)).style("fill-opacity",null),fe.classed("pattern_filled",!0)},c.initGradients=function(fe){var me=fe._fullLayout;v.ensureSingle(me._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),d.select(fe).selectAll(".gradient_filled").classed("gradient_filled",!1)},c.initPatterns=function(fe){var me=fe._fullLayout;v.ensureSingle(me._defs,"g","patterns").selectAll("pattern").remove(),d.select(fe).selectAll(".pattern_filled").classed("pattern_filled",!1)},c.getPatternAttr=function(fe,me,_e){return fe&&v.isArrayOrTypedArray(fe)?me<fe.length?fe[me]:_e:fe},c.pointStyle=function(fe,me,_e){if(fe.size()){var le=c.makePointStyleFns(me);fe.each(function(ge){c.singlePointStyle(ge,d.select(this),me,le,_e)})}},c.singlePointStyle=function(fe,me,_e,le,ge){var Te=_e.marker,Se=Te.line;if(me.style("opacity",le.selectedOpacityFn?le.selectedOpacityFn(fe):fe.mo===void 0?Te.opacity:fe.mo),le.ms2mrc){var Me;Me=fe.ms==="various"||Te.size==="various"?3:le.ms2mrc(fe.ms),fe.mrc=Me,le.selectedSizeFn&&(Me=fe.mrc=le.selectedSizeFn(fe));var ze=c.symbolNumber(fe.mx||Te.symbol)||0;fe.om=ze%200>=100;var Oe=Ae(fe,_e),De=te(fe,_e);me.attr("d",_(ze,Me,Oe,De))}var Xe,Be,Ie,Re=!1;if(fe.so)Ie=Se.outlierwidth,Be=Se.outliercolor,Xe=Te.outliercolor;else{var Ye=(Se||{}).width;Ie=(fe.mlw+1||Ye+1||(fe.trace?(fe.trace.marker.line||{}).width:0)+1)-1||0,Be="mlc"in fe?fe.mlcc=le.lineScale(fe.mlc):v.isArrayOrTypedArray(Se.color)?n.defaultLine:Se.color,v.isArrayOrTypedArray(Te.color)&&(Xe=n.defaultLine,Re=!0),Xe="mc"in fe?fe.mcc=le.markerScale(fe.mc):Te.color||"rgba(0,0,0,0)",le.selectedColorFn&&(Xe=le.selectedColorFn(fe))}if(fe.om)me.call(n.stroke,Xe).style({"stroke-width":(Ie||1)+"px",fill:"none"});else{me.style("stroke-width",(fe.isBlank?0:Ie)+"px");var Qe=Te.gradient,lt=fe.mgt;lt?Re=!0:lt=Qe&&Qe.type,v.isArrayOrTypedArray(lt)&&(lt=lt[0],L[lt]||(lt=0));var xt=Te.pattern,wt=xt&&c.getPatternAttr(xt.shape,fe.i,"");if(lt&&lt!=="none"){var bt=fe.mgc;bt?Re=!0:bt=Qe.color;var nt=_e.uid;Re&&(nt+="-"+fe.i),c.gradient(me,ge,nt,lt,[[0,bt],[1,Xe]],"fill")}else if(wt){var $e=c.getPatternAttr(xt.bgcolor,fe.i,null),vt=c.getPatternAttr(xt.fgcolor,fe.i,null),Nt=xt.fgopacity,qt=c.getPatternAttr(xt.size,fe.i,8),Jt=c.getPatternAttr(xt.solidity,fe.i,.3),Wt=fe.mcc||v.isArrayOrTypedArray(xt.shape)||v.isArrayOrTypedArray(xt.bgcolor)||v.isArrayOrTypedArray(xt.size)||v.isArrayOrTypedArray(xt.solidity),ar=_e.uid;Wt&&(ar+="-"+fe.i),c.pattern(me,"point",ge,ar,wt,qt,Jt,fe.mcc,xt.fillmode,$e,vt,Nt)}else n.fill(me,Xe);Ie&&n.stroke(me,Be)}},c.makePointStyleFns=function(fe){var me={},_e=fe.marker;return me.markerScale=c.tryColorscale(_e,""),me.lineScale=c.tryColorscale(_e,"line"),t.traceIs(fe,"symbols")&&(me.ms2mrc=l.isBubble(fe)?o(fe):function(){return(_e.size||6)/2}),fe.selectedpoints&&v.extendFlat(me,c.makeSelectedPointStyleFns(fe)),me},c.makeSelectedPointStyleFns=function(fe){var me={},_e=fe.selected||{},le=fe.unselected||{},ge=fe.marker||{},Te=_e.marker||{},Se=le.marker||{},Me=ge.opacity,ze=Te.opacity,Oe=Se.opacity,De=ze!==void 0,Xe=Oe!==void 0;(v.isArrayOrTypedArray(Me)||De||Xe)&&(me.selectedOpacityFn=function(bt){var nt=bt.mo===void 0?ge.opacity:bt.mo;return bt.selected?De?ze:nt:Xe?Oe:h*nt});var Be=ge.color,Ie=Te.color,Re=Se.color;(Ie||Re)&&(me.selectedColorFn=function(bt){var nt=bt.mcc||Be;return bt.selected?Ie||nt:Re||nt});var Ye=ge.size,Qe=Te.size,lt=Se.size,xt=Qe!==void 0,wt=lt!==void 0;return t.traceIs(fe,"symbols")&&(xt||wt)&&(me.selectedSizeFn=function(bt){var nt=bt.mrc||Ye/2;return bt.selected?xt?Qe/2:nt:wt?lt/2:nt}),me},c.makeSelectedTextStyleFns=function(fe){var me={},_e=fe.selected||{},le=fe.unselected||{},ge=fe.textfont||{},Te=_e.textfont||{},Se=le.textfont||{},Me=ge.color,ze=Te.color,Oe=Se.color;return me.selectedTextColorFn=function(De){var Xe=De.tc||Me;return De.selected?ze||Xe:Oe||(ze?Xe:n.addOpacity(Xe,h))},me},c.selectedPointStyle=function(fe,me){if(fe.size()&&me.selectedpoints){var _e=c.makeSelectedPointStyleFns(me),le=me.marker||{},ge=[];_e.selectedOpacityFn&&ge.push(function(Te,Se){Te.style("opacity",_e.selectedOpacityFn(Se))}),_e.selectedColorFn&&ge.push(function(Te,Se){n.fill(Te,_e.selectedColorFn(Se))}),_e.selectedSizeFn&&ge.push(function(Te,Se){var Me=Se.mx||le.symbol||0,ze=_e.selectedSizeFn(Se);Te.attr("d",_(c.symbolNumber(Me),ze,Ae(Se,me),te(Se,me))),Se.mrc2=ze}),ge.length&&fe.each(function(Te){for(var Se=d.select(this),Me=0;Me<ge.length;Me++)ge[Me](Se,Te)})}},c.tryColorscale=function(fe,me){var _e=me?v.nestedProperty(fe,me).get():fe;if(_e){var le=_e.color;if((_e.colorscale||_e._colorAx)&&v.isArrayOrTypedArray(le))return a.makeColorScaleFuncFromTrace(_e)}return v.identity};var A={start:1,end:-1,middle:0,bottom:1,top:-1};function I(fe,me,_e,le,ge){var Te=d.select(fe.node().parentNode),Se=me.indexOf("top")!==-1?"top":me.indexOf("bottom")!==-1?"bottom":"middle",Me=me.indexOf("left")!==-1?"end":me.indexOf("right")!==-1?"start":"middle",ze=le?le/.8+1:0,Oe=(g.lineCount(fe)-1)*s+1,De=A[Me]*ze,Xe=.75*_e+A[Se]*ze+(A[Se]-1)*Oe*_e/2;fe.attr("text-anchor",Me),ge||Te.attr("transform",r(De,Xe))}function P(fe,me){var _e=fe.ts||me.textfont.size;return y(_e)&&_e>0?_e:0}c.textPointStyle=function(fe,me,_e){if(fe.size()){var le;if(me.selectedpoints){var ge=c.makeSelectedTextStyleFns(me);le=ge.selectedTextColorFn}var Te=me.texttemplate,Se=_e._fullLayout;fe.each(function(Me){var ze=d.select(this),Oe=Te?v.extractOption(Me,me,"txt","texttemplate"):v.extractOption(Me,me,"tx","text");if(Oe||Oe===0){if(Te){var De=me._module.formatLabels,Xe=De?De(Me,me,Se):{},Be={};p(Be,me,Me.i);var Ie=me._meta||{};Oe=v.texttemplateString(Oe,Xe,Se._d3locale,Be,Me,Ie)}var Re=Me.tp||me.textposition,Ye=P(Me,me),Qe=le?le(Me):Me.tc||me.textfont.color;ze.call(c.font,Me.tf||me.textfont.family,Ye,Qe).text(Oe).call(g.convertToTspans,_e).call(I,Re,Ye,Me.mrc)}else ze.remove()})}},c.selectedTextStyle=function(fe,me){if(fe.size()&&me.selectedpoints){var _e=c.makeSelectedTextStyleFns(me);fe.each(function(le){var ge=d.select(this),Te=_e.selectedTextColorFn(le),Se=le.tp||me.textposition,Me=P(le,me);n.fill(ge,Te);var ze=t.traceIs(me,"bar-like");I(ge,Se,Me,le.mrc2||le.mrc,ze)})}};var S,E;function z(fe,me,_e){return _e&&(fe=K(fe)),me?j(fe[1]):D(fe[0])}function D(fe){var me=d.round(fe,2);return S=me,me}function j(fe){var me=d.round(fe,2);return E=me,me}function V(fe,me,_e,le){var ge=fe[0]-me[0],Te=fe[1]-me[1],Se=_e[0]-me[0],Me=_e[1]-me[1],ze=Math.pow(ge*ge+Te*Te,.25),Oe=Math.pow(Se*Se+Me*Me,.25),De=(Oe*Oe*ge-ze*ze*Se)*le,Xe=(Oe*Oe*Te-ze*ze*Me)*le,Be=3*Oe*(ze+Oe),Ie=3*ze*(ze+Oe);return[[D(me[0]+(Be&&De/Be)),j(me[1]+(Be&&Xe/Be))],[D(me[0]-(Ie&&De/Ie)),j(me[1]-(Ie&&Xe/Ie))]]}c.smoothopen=function(fe,me){if(fe.length<3)return"M"+fe.join("L");var _e,le="M"+fe[0],ge=[];for(_e=1;_e<fe.length-1;_e++)ge.push(V(fe[_e-1],fe[_e],fe[_e+1],me));for(le+="Q"+ge[0][0]+" "+fe[1],_e=2;_e<fe.length-1;_e++)le+="C"+ge[_e-2][1]+" "+ge[_e-1][0]+" "+fe[_e];return le+="Q"+ge[fe.length-3][1]+" "+fe[fe.length-1]},c.smoothclosed=function(fe,me){if(fe.length<3)return"M"+fe.join("L")+"Z";var _e,le="M"+fe[0],ge=fe.length-1,Te=[V(fe[ge],fe[0],fe[1],me)];for(_e=1;_e<ge;_e++)Te.push(V(fe[_e-1],fe[_e],fe[_e+1],me));for(Te.push(V(fe[ge-1],fe[ge],fe[0],me)),_e=1;_e<=ge;_e++)le+="C"+Te[_e-1][1]+" "+Te[_e][0]+" "+fe[_e];return le+="C"+Te[ge][1]+" "+Te[0][0]+" "+fe[0]+"Z"};var Z={hv:function(fe,me,_e){return"H"+D(me[0])+"V"+z(me,1,_e)},vh:function(fe,me,_e){return"V"+j(me[1])+"H"+z(me,0,_e)},hvh:function(fe,me,_e){return"H"+D((fe[0]+me[0])/2)+"V"+j(me[1])+"H"+z(me,0,_e)},vhv:function(fe,me,_e){return"V"+j((fe[1]+me[1])/2)+"H"+D(me[0])+"V"+z(me,1,_e)}},Q=function(fe,me,_e){return"L"+z(me,0,_e)+","+z(me,1,_e)};function K(fe,me){var _e=fe.backoff,le=fe.trace,ge=fe.d,Te=fe.i;if(_e&&le&&le.marker&&le.marker.angle%360==0&&le.line&&le.line.shape!=="spline"){var Se=v.isArrayOrTypedArray(_e),Me=fe,ze=me?me[0]:S||0,Oe=me?me[1]:E||0,De=Me[0],Xe=Me[1],Be=De-ze,Ie=Xe-Oe,Re=Math.atan2(Ie,Be),Ye=Se?_e[Te]:_e;if(Ye==="auto"){var Qe=Me.i;le.type==="scatter"&&Qe--;var lt=Me.marker;Ye=lt?c.symbolBackOffs[c.symbolNumber(lt.symbol)]*lt.size:0,Ye+=c.getMarkerStandoff(ge[Qe],le)||0}var xt=De-Ye*Math.cos(Re),wt=Xe-Ye*Math.sin(Re);(xt<=De&&xt>=ze||xt>=De&&xt<=ze)&&(wt<=Xe&&wt>=Oe||wt>=Xe&&wt<=Oe)&&(fe=[xt,wt])}return fe}c.steps=function(fe){var me=Z[fe]||Q;return function(_e){for(var le="M"+D(_e[0][0])+","+j(_e[0][1]),ge=_e.length,Te=1;Te<ge;Te++)le+=me(_e[Te-1],_e[Te],Te===ge-1);return le}},c.applyBackoff=K,c.makeTester=function(){var fe=v.ensureSingleById(d.select("body"),"svg","js-plotly-tester",function(_e){_e.attr(u.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),me=v.ensureSingle(fe,"path","js-reference-point",function(_e){_e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});c.tester=fe,c.testref=me},c.savedBBoxes={};var $=0;function ne(fe){var me=fe.getAttribute("data-unformatted");if(me!==null)return me+fe.getAttribute("data-math")+fe.getAttribute("text-anchor")+fe.getAttribute("style")}function H(fe,me){if(!fe)return null;var _e=me._context,le=_e._exportedPlot?"":_e._baseUrl||"";return le?"url('"+le+"#"+fe+"')":"url(#"+fe+")"}c.bBox=function(fe,me,_e){var le,ge,Te;if(_e||(_e=ne(fe)),_e){if(le=c.savedBBoxes[_e])return v.extendFlat({},le)}else if(fe.childNodes.length===1){var Se=fe.childNodes[0];if(_e=ne(Se)){var Me=+Se.getAttribute("x")||0,ze=+Se.getAttribute("y")||0,Oe=Se.getAttribute("transform");if(!Oe){var De=c.bBox(Se,!1,_e);return Me&&(De.left+=Me,De.right+=Me),ze&&(De.top+=ze,De.bottom+=ze),De}if(_e+="~"+Me+"~"+ze+"~"+Oe,le=c.savedBBoxes[_e])return v.extendFlat({},le)}}me?ge=fe:(Te=c.tester.node(),ge=fe.cloneNode(!0),Te.appendChild(ge)),d.select(ge).attr("transform",null).call(g.positionText,0,0);var Xe=ge.getBoundingClientRect(),Be=c.testref.node().getBoundingClientRect();me||Te.removeChild(ge);var Ie={height:Xe.height,width:Xe.width,left:Xe.left-Be.left,top:Xe.top-Be.top,right:Xe.right-Be.left,bottom:Xe.bottom-Be.top};return $>=1e4&&(c.savedBBoxes={},$=0),_e&&(c.savedBBoxes[_e]=Ie),$++,v.extendFlat({},Ie)},c.setClipUrl=function(fe,me,_e){fe.attr("clip-path",H(me,_e))},c.getTranslate=function(fe){var me=(fe[fe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(_e,le,ge){return[le,ge].join(" ")}).split(" ");return{x:+me[0]||0,y:+me[1]||0}},c.setTranslate=function(fe,me,_e){var le=fe.attr?"attr":"getAttribute",ge=fe.attr?"attr":"setAttribute",Te=fe[le]("transform")||"";return me=me||0,_e=_e||0,Te=Te.replace(/(\btranslate\(.*?\);?)/,"").trim(),Te=(Te+=r(me,_e)).trim(),fe[ge]("transform",Te),Te},c.getScale=function(fe){var me=(fe[fe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(_e,le,ge){return[le,ge].join(" ")}).split(" ");return{x:+me[0]||1,y:+me[1]||1}},c.setScale=function(fe,me,_e){var le=fe.attr?"attr":"getAttribute",ge=fe.attr?"attr":"setAttribute",Te=fe[le]("transform")||"";return me=me||1,_e=_e||1,Te=Te.replace(/(\bscale\(.*?\);?)/,"").trim(),Te=(Te+="scale("+me+","+_e+")").trim(),fe[ge]("transform",Te),Te};var N=/\s*sc.*/;c.setPointGroupScale=function(fe,me,_e){if(me=me||1,_e=_e||1,fe){var le=me===1&&_e===1?"":"scale("+me+","+_e+")";fe.each(function(){var ge=(this.getAttribute("transform")||"").replace(N,"");ge=(ge+=le).trim(),this.setAttribute("transform",ge)})}};var U=/translate\([^)]*\)\s*$/;function te(fe,me){var _e;return fe&&(_e=fe.mf),_e===void 0&&(_e=me.marker&&me.marker.standoff||0),me._geo||me._xA?_e:-_e}c.setTextPointsScale=function(fe,me,_e){fe&&fe.each(function(){var le,ge=d.select(this),Te=ge.select("text");if(Te.node()){var Se=parseFloat(Te.attr("x")||0),Me=parseFloat(Te.attr("y")||0),ze=(ge.attr("transform")||"").match(U);le=me===1&&_e===1?[]:[r(Se,Me),"scale("+me+","+_e+")",r(-Se,-Me)],ze&&le.push(ze),ge.attr("transform",le.join(""))}})},c.getMarkerStandoff=te;var B,X,J,ee,re,se,oe=Math.atan2,de=Math.cos,ce=Math.sin;function ve(fe,me){var _e=me[0],le=me[1];return[_e*de(fe)-le*ce(fe),_e*ce(fe)+le*de(fe)]}function Ae(fe,me){var _e,le,ge=fe.ma;ge===void 0&&(ge=me.marker.angle||0);var Te=me.marker.angleref;if(Te==="previous"||Te==="north"){if(me._geo){var Se=me._geo.project(fe.lonlat);_e=Se[0],le=Se[1]}else{var Me=me._xA,ze=me._yA;if(!Me||!ze)return 90;_e=Me.c2p(fe.x),le=ze.c2p(fe.y)}if(me._geo){var Oe,De=fe.lonlat[0],Xe=fe.lonlat[1],Be=me._geo.project([De,Xe+1e-5]),Ie=me._geo.project([De+1e-5,Xe]),Re=oe(Ie[1]-le,Ie[0]-_e),Ye=oe(Be[1]-le,Be[0]-_e);if(Te==="north")Oe=ge/180*Math.PI;else if(Te==="previous"){var Qe=De/180*Math.PI,lt=Xe/180*Math.PI,xt=B/180*Math.PI,wt=X/180*Math.PI,bt=xt-Qe,nt=de(wt)*ce(bt),$e=ce(wt)*de(lt)-de(wt)*ce(lt)*de(bt);Oe=-oe(nt,$e)-Math.PI,B=De,X=Xe}var vt=ve(Re,[de(Oe),0]),Nt=ve(Ye,[ce(Oe),0]);ge=oe(vt[1]+Nt[1],vt[0]+Nt[0])/Math.PI*180,Te!=="previous"||se===me.uid&&fe.i===re+1||(ge=null)}if(Te==="previous"&&!me._geo)if(se===me.uid&&fe.i===re+1&&y(_e)&&y(le)){var qt=_e-J,Jt=le-ee,Wt=me.line&&me.line.shape||"",ar=Wt.slice(Wt.length-1);ar==="h"&&(Jt=0),ar==="v"&&(qt=0),ge+=oe(Jt,qt)/Math.PI*180+90}else ge=null}return J=_e,ee=le,re=fe.i,se=me.uid,ge}c.getMarkerAngle=Ae},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(m,G,W){var d,v,w,y,e=m("parse-svg-path"),t=m("@plotly/d3").round,n=Math.sqrt(2),a=Math.sqrt(3),r=Math.PI,g=Math.cos,u=Math.sin;function s(l){return l===null}function h(l,o,p){if(!(l&&l%360!=0||o))return p;if(w===l&&y===o&&d===p)return v;function c(E,z){var D=g(E),j=u(E),V=z[0],Z=z[1]+(o||0);return[V*D-Z*j,V*j+Z*D]}w=l,y=o,d=p;for(var i=l/180*r,x=0,f=0,_=e(p),b="",T=0;T<_.length;T++){var k=_[T],L=k[0],A=x,I=f;if(L==="M"||L==="L")x=+k[1],f=+k[2];else if(L==="m"||L==="l")x+=+k[1],f+=+k[2];else if(L==="H")x=+k[1];else if(L==="h")x+=+k[1];else if(L==="V")f=+k[1];else if(L==="v")f+=+k[1];else if(L==="A"){x=+k[1],f=+k[2];var P=c(i,[+k[6],+k[7]]);k[6]=P[0],k[7]=P[1],k[3]=+k[3]+l}L!=="H"&&L!=="V"||(L="L"),L!=="h"&&L!=="v"||(L="l"),L!=="m"&&L!=="l"||(x-=A,f-=I);var S=c(i,[x,f]);L!=="H"&&L!=="V"||(L="L"),L!=="M"&&L!=="L"&&L!=="m"&&L!=="l"||(k[1]=S[0],k[2]=S[1]),k[0]=L,b+=k[0]+k.slice(1).join(",")}return v=b,b}G.exports={circle:{n:0,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2),i="M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z";return p?h(o,p,i):i}},square:{n:1,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")}},diamond:{n:2,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.3*l,2);return h(o,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"Z")}},cross:{n:3,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.4*l,2),i=t(1.2*l,2);return h(o,p,"M"+i+","+c+"H"+c+"V"+i+"H-"+c+"V"+c+"H-"+i+"V-"+c+"H-"+c+"V-"+i+"H"+c+"V-"+c+"H"+i+"Z")}},x:{n:4,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.8*l/n,2),i="l"+c+","+c,x="l"+c+",-"+c,f="l-"+c+",-"+c,_="l-"+c+","+c;return h(o,p,"M0,"+c+i+x+f+x+f+_+f+_+i+_+i+"Z")}},"triangle-up":{n:5,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l/a,2);return h(o,p,"M-"+c+","+t(l/2,2)+"H"+c+"L0,-"+t(l,2)+"Z")}},"triangle-down":{n:6,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l/a,2);return h(o,p,"M-"+c+",-"+t(l/2,2)+"H"+c+"L0,"+t(l,2)+"Z")}},"triangle-left":{n:7,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l/a,2);return h(o,p,"M"+t(l/2,2)+",-"+c+"V"+c+"L-"+t(l,2)+",0Z")}},"triangle-right":{n:8,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l/a,2);return h(o,p,"M-"+t(l/2,2)+",-"+c+"V"+c+"L"+t(l,2)+",0Z")}},"triangle-ne":{n:9,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.6*l,2),i=t(1.2*l,2);return h(o,p,"M-"+i+",-"+c+"H"+c+"V"+i+"Z")}},"triangle-se":{n:10,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.6*l,2),i=t(1.2*l,2);return h(o,p,"M"+c+",-"+i+"V"+c+"H-"+i+"Z")}},"triangle-sw":{n:11,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.6*l,2),i=t(1.2*l,2);return h(o,p,"M"+i+","+c+"H-"+c+"V-"+i+"Z")}},"triangle-nw":{n:12,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.6*l,2),i=t(1.2*l,2);return h(o,p,"M-"+c+","+i+"V-"+c+"H"+i+"Z")}},pentagon:{n:13,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.951*l,2),i=t(.588*l,2),x=t(-l,2),f=t(-.309*l,2);return h(o,p,"M"+c+","+f+"L"+i+","+t(.809*l,2)+"H-"+i+"L-"+c+","+f+"L0,"+x+"Z")}},hexagon:{n:14,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2),i=t(l/2,2),x=t(l*a/2,2);return h(o,p,"M"+x+",-"+i+"V"+i+"L0,"+c+"L-"+x+","+i+"V-"+i+"L0,-"+c+"Z")}},hexagon2:{n:15,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2),i=t(l/2,2),x=t(l*a/2,2);return h(o,p,"M-"+i+","+x+"H"+i+"L"+c+",0L"+i+",-"+x+"H-"+i+"L-"+c+",0Z")}},octagon:{n:16,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.924*l,2),i=t(.383*l,2);return h(o,p,"M-"+i+",-"+c+"H"+i+"L"+c+",-"+i+"V"+i+"L"+i+","+c+"H-"+i+"L-"+c+","+i+"V-"+i+"Z")}},star:{n:17,f:function(l,o,p){if(s(o))return"M0,0Z";var c=1.4*l,i=t(.225*c,2),x=t(.951*c,2),f=t(.363*c,2),_=t(.588*c,2),b=t(-c,2),T=t(-.309*c,2),k=t(.118*c,2),L=t(.809*c,2);return h(o,p,"M"+i+","+T+"H"+x+"L"+f+","+k+"L"+_+","+L+"L0,"+t(.382*c,2)+"L-"+_+","+L+"L-"+f+","+k+"L-"+x+","+T+"H-"+i+"L0,"+b+"Z")}},hexagram:{n:18,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.66*l,2),i=t(.38*l,2),x=t(.76*l,2);return h(o,p,"M-"+x+",0l-"+i+",-"+c+"h"+x+"l"+i+",-"+c+"l"+i+","+c+"h"+x+"l-"+i+","+c+"l"+i+","+c+"h-"+x+"l-"+i+","+c+"l-"+i+",-"+c+"h-"+x+"Z")}},"star-triangle-up":{n:19,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l*a*.8,2),i=t(.8*l,2),x=t(1.6*l,2),f=t(4*l,2),_="A "+f+","+f+" 0 0 1 ";return h(o,p,"M-"+c+","+i+_+c+","+i+_+"0,-"+x+_+"-"+c+","+i+"Z")}},"star-triangle-down":{n:20,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l*a*.8,2),i=t(.8*l,2),x=t(1.6*l,2),f=t(4*l,2),_="A "+f+","+f+" 0 0 1 ";return h(o,p,"M"+c+",-"+i+_+"-"+c+",-"+i+_+"0,"+x+_+c+",-"+i+"Z")}},"star-square":{n:21,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.1*l,2),i=t(2*l,2),x="A "+i+","+i+" 0 0 1 ";return h(o,p,"M-"+c+",-"+c+x+"-"+c+","+c+x+c+","+c+x+c+",-"+c+x+"-"+c+",-"+c+"Z")}},"star-diamond":{n:22,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.4*l,2),i=t(1.9*l,2),x="A "+i+","+i+" 0 0 1 ";return h(o,p,"M-"+c+",0"+x+"0,"+c+x+c+",0"+x+"0,-"+c+x+"-"+c+",0Z")}},"diamond-tall":{n:23,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(.7*l,2),i=t(1.4*l,2);return h(o,p,"M0,"+i+"L"+c+",0L0,-"+i+"L-"+c+",0Z")}},"diamond-wide":{n:24,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.4*l,2),i=t(.7*l,2);return h(o,p,"M0,"+i+"L"+c+",0L0,-"+i+"L-"+c+",0Z")}},hourglass:{n:25,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"H-"+c+"L"+c+",-"+c+"H-"+c+"Z")},noDot:!0},bowtie:{n:26,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"V-"+c+"L-"+c+","+c+"V-"+c+"Z")},noDot:!0},"circle-cross":{n:27,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2),i=t(l/n,2);return h(o,p,"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i+"M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c+"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.3*l,2);return h(o,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"ZM0,-"+c+"V"+c+"M-"+c+",0H"+c)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.3*l,2),i=t(.65*l,2);return h(o,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"ZM-"+i+",-"+i+"L"+i+","+i+"M-"+i+","+i+"L"+i+",-"+i)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.4*l,2);return h(o,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.2*l,2),i=t(.85*l,2);return h(o,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l/2,2),i=t(l,2);return h(o,p,"M"+c+","+i+"V-"+i+"M"+(c-i)+",-"+i+"V"+i+"M"+i+","+c+"H-"+i+"M-"+i+","+(c-i)+"H"+i)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(o,p,"M-"+c+","+x+"L0,0M"+c+","+x+"L0,0M0,-"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(o,p,"M-"+c+",-"+x+"L0,0M"+c+",-"+x+"L0,0M0,"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(o,p,"M"+x+","+c+"L0,0M"+x+",-"+c+"L0,0M-"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(o,p,"M-"+x+","+c+"L0,0M-"+x+",-"+c+"L0,0M"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.4*l,2);return h(o,p,"M"+c+",0H-"+c)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(1.4*l,2);return h(o,p,"M0,"+c+"V-"+c)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+",-"+c+"L-"+c+","+c)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M"+c+","+c+"L-"+c+",-"+c)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M0,0L-"+c+","+t(2*l,2)+"H"+c+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M0,0L-"+c+",-"+t(2*l,2)+"H"+c+"Z")},noDot:!0},"arrow-left":{n:47,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l,2),i=t(l,2);return h(o,p,"M0,0L"+c+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-right":{n:48,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l,2),i=t(l,2);return h(o,p,"M0,0L-"+c+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M-"+c+",0H"+c+"M0,0L-"+c+","+t(2*l,2)+"H"+c+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(l,2);return h(o,p,"M-"+c+",0H"+c+"M0,0L-"+c+",-"+t(2*l,2)+"H"+c+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l,2),i=t(l,2);return h(o,p,"M0,-"+i+"V"+i+"M0,0L"+c+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(l,o,p){if(s(o))return"M0,0Z";var c=t(2*l,2),i=t(l,2);return h(o,p,"M0,-"+i+"V"+i+"M0,0L-"+c+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(l,o,p){if(s(o))return"M0,0Z";var c=r/2.5,i=2*l*g(c),x=2*l*u(c);return h(o,p,"M0,0L"+-i+","+x+"L"+i+","+x+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(l,o,p){if(s(o))return"M0,0Z";var c=r/4,i=2*l*g(c),x=2*l*u(c);return h(o,p,"M0,0L"+-i+","+x+"A "+2*l+","+2*l+" 0 0 1 "+i+","+x+"Z")},backoff:.4,noDot:!0}}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(m,G,W){G.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../plots/cartesian/axes"),y=m("../../lib"),e=m("./compute_error");function t(n,a,r,g){var u=a["error_"+g]||{},s=[];if(u.visible&&["linear","log"].indexOf(r.type)!==-1){for(var h=e(u),l=0;l<n.length;l++){var o=n[l],p=o.i;if(p===void 0)p=l;else if(p===null)continue;var c=o[g];if(d(r.c2l(c))){var i=h(c,p);if(d(i[0])&&d(i[1])){var x=o[g+"s"]=c-i[0],f=o[g+"h"]=c+i[1];s.push(x,f)}}}var _=r._id,b=a._extremes[_],T=w.findExtremes(r,s,y.extendFlat({tozero:b.opts.tozero},{padded:!0}));b.min=b.min.concat(T.min),b.max=b.max.concat(T.max)}}G.exports=function(n){for(var a=n.calcdata,r=0;r<a.length;r++){var g=a[r],u=g[0].trace;if(u.visible===!0&&v.traceIs(u,"errorBarsOK")){var s=w.getFromId(n,u.xaxis),h=w.getFromId(n,u.yaxis);t(g,u,s,"x"),t(g,u,h,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(m,G,W){function d(v,w){return v==="percent"?function(y){return Math.abs(y*w/100)}:v==="constant"?function(){return Math.abs(w)}:v==="sqrt"?function(y){return Math.sqrt(Math.abs(y))}:void 0}G.exports=function(v){var w=v.type,y=v.symmetric;if(w==="data"){var e=v.array||[];if(y)return function(r,g){var u=+e[g];return[u,u]};var t=v.arrayminus||[];return function(r,g){var u=+e[g],s=+t[g];return isNaN(u)&&isNaN(s)?[NaN,NaN]:[s||0,u||0]}}var n=d(w,v.value),a=d(w,v.valueminus);return y||v.valueminus===void 0?function(r){var g=n(r);return[g,g]}:function(r){return[a(r),n(r)]}}},{}],394:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../lib"),y=m("../../plot_api/plot_template"),e=m("./attributes");G.exports=function(t,n,a,r){var g="error_"+r.axis,u=y.newContainer(n,g),s=t[g]||{};function h(c,i){return w.coerce(s,u,e,c,i)}if(h("visible",s.array!==void 0||s.value!==void 0||s.type==="sqrt")!==!1){var l=h("type","array"in s?"data":"percent"),o=!0;l!=="sqrt"&&(o=h("symmetric",!((l==="data"?"arrayminus":"valueminus")in s))),l==="data"?(h("array"),h("traceref"),o||(h("arrayminus"),h("tracerefminus"))):l!=="percent"&&l!=="constant"||(h("value"),o||h("valueminus"));var p="copy_"+r.inherit+"style";r.inherit&&(n["error_"+r.inherit]||{}).visible&&h(p,!(s.color||d(s.thickness)||d(s.width))),r.inherit&&u[p]||(h("color",a),h("thickness"),h("width",v.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(m,G,W){var d=m("../../lib"),v=m("../../plot_api/edit_types").overrideAll,w=m("./attributes"),y={error_x:d.extendFlat({},w),error_y:d.extendFlat({},w)};delete y.error_x.copy_zstyle,delete y.error_y.copy_zstyle,delete y.error_y.copy_ystyle;var e={error_x:d.extendFlat({},w),error_y:d.extendFlat({},w),error_z:d.extendFlat({},w)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,G.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:y,bar:y,histogram:y,scatter3d:v(e,"calc","nested"),scattergl:v(y,"calc","nested")}},supplyDefaults:m("./defaults"),calc:m("./calc"),makeComputeError:m("./compute_error"),plot:m("./plot"),style:m("./style"),hoverInfo:function(t,n,a){(n.error_y||{}).visible&&(a.yerr=t.yh-t.y,n.error_y.symmetric||(a.yerrneg=t.y-t.ys)),(n.error_x||{}).visible&&(a.xerr=t.xh-t.x,n.error_x.symmetric||(a.xerrneg=t.x-t.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../drawing"),y=m("../../traces/scatter/subtypes");G.exports=function(e,t,n,a){var r=n.xaxis,g=n.yaxis,u=a&&a.duration>0;t.each(function(s){var h,l=s[0].trace,o=l.error_x||{},p=l.error_y||{};l.ids&&(h=function(f){return f.id});var c=y.hasMarkers(l)&&l.marker.maxdisplayed>0;p.visible||o.visible||(s=[]);var i=d.select(this).selectAll("g.errorbar").data(s,h);if(i.exit().remove(),s.length){o.visible||i.selectAll("path.xerror").remove(),p.visible||i.selectAll("path.yerror").remove(),i.style("opacity",1);var x=i.enter().append("g").classed("errorbar",!0);u&&x.style("opacity",0).transition().duration(a.duration).style("opacity",1),w.setClipUrl(i,n.layerClipId,e),i.each(function(f){var _=d.select(this),b=function(P,S,E){var z={x:S.c2p(P.x),y:E.c2p(P.y)};return P.yh!==void 0&&(z.yh=E.c2p(P.yh),z.ys=E.c2p(P.ys),v(z.ys)||(z.noYS=!0,z.ys=E.c2p(P.ys,!0))),P.xh!==void 0&&(z.xh=S.c2p(P.xh),z.xs=S.c2p(P.xs),v(z.xs)||(z.noXS=!0,z.xs=S.c2p(P.xs,!0))),z}(f,r,g);if(!c||f.vis){var T,k=_.select("path.yerror");if(p.visible&&v(b.x)&&v(b.yh)&&v(b.ys)){var L=p.width;T="M"+(b.x-L)+","+b.yh+"h"+2*L+"m-"+L+",0V"+b.ys,b.noYS||(T+="m-"+L+",0h"+2*L),k.size()?u&&(k=k.transition().duration(a.duration).ease(a.easing)):k=_.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),k.attr("d",T)}else k.remove();var A=_.select("path.xerror");if(o.visible&&v(b.y)&&v(b.xh)&&v(b.xs)){var I=(o.copy_ystyle?p:o).width;T="M"+b.xh+","+(b.y-I)+"v"+2*I+"m0,-"+I+"H"+b.xs,b.noXS||(T+="m0,-"+I+"v"+2*I),A.size()?u&&(A=A.transition().duration(a.duration).ease(a.easing)):A=_.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),A.attr("d",T)}else A.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(m,G,W){var d=m("@plotly/d3"),v=m("../color");G.exports=function(w){w.each(function(y){var e=y[0].trace,t=e.error_y||{},n=e.error_x||{},a=d.select(this);a.selectAll("path.yerror").style("stroke-width",t.thickness+"px").call(v.stroke,t.color),n.copy_ystyle&&(n=t),a.selectAll("path.xerror").style("stroke-width",n.thickness+"px").call(v.stroke,n.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("./layout_attributes").hoverlabel,w=m("../../lib/extend").extendFlat;G.exports={hoverlabel:{bgcolor:w({},v.bgcolor,{arrayOk:!0}),bordercolor:w({},v.bordercolor,{arrayOk:!0}),font:d({arrayOk:!0,editType:"none"}),align:w({},v.align,{arrayOk:!0}),namelength:w({},v.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(m,G,W){var d=m("../../lib"),v=m("../../registry");function w(y,e,t,n){n=n||d.identity,Array.isArray(y)&&(e[0][t]=n(y))}G.exports=function(y){var e=y.calcdata,t=y._fullLayout;function n(s){return function(h){return d.coerceHoverinfo({hoverinfo:h},{_module:s._module},t)}}for(var a=0;a<e.length;a++){var r=e[a],g=r[0].trace;if(!v.traceIs(g,"pie-like")){var u=v.traceIs(g,"2dMap")?w:d.fillArray;u(g.hoverinfo,r,"hi",n(g)),g.hovertemplate&&u(g.hovertemplate,r,"ht"),g.hoverlabel&&(u(g.hoverlabel.bgcolor,r,"hbg"),u(g.hoverlabel.bordercolor,r,"hbc"),u(g.hoverlabel.font.size,r,"hts"),u(g.hoverlabel.font.color,r,"htc"),u(g.hoverlabel.font.family,r,"htf"),u(g.hoverlabel.namelength,r,"hnl"),u(g.hoverlabel.align,r,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(m,G,W){var d=m("../../registry"),v=m("./hover").hover;G.exports=function(w,y,e){var t=d.getComponentMethod("annotations","onClick")(w,w._hoverdata);function n(){w.emit("plotly_click",{points:w._hoverdata,event:y})}e!==void 0&&v(w,y,e,!0),w._hoverdata&&y&&y.target&&(t&&t.then?t.then(n):n(),y.stopImmediatePropagation&&y.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(m,G,W){G.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("./hoverlabel_defaults");G.exports=function(y,e,t,n){var a=d.extendFlat({},n.hoverlabel);e.hovertemplate&&(a.namelength=-1),w(y,e,function(r,g){return d.coerce(y,e,v,r,g)},a)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(m,G,W){var d=m("../../lib");W.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},W.isTraceInSubplots=function(n,a){if(n.type==="splom"){for(var r=n.xaxes||[],g=n.yaxes||[],u=0;u<r.length;u++)for(var s=0;s<g.length;s++)if(a.indexOf(r[u]+g[s])!==-1)return!0;return!1}return a.indexOf(W.getSubplot(n))!==-1},W.flat=function(n,a){for(var r=new Array(n.length),g=0;g<n.length;g++)r[g]=a;return r},W.p2c=function(n,a){for(var r=new Array(n.length),g=0;g<n.length;g++)r[g]=n[g].p2c(a);return r},W.getDistanceFunction=function(n,a,r,g){return n==="closest"?g||W.quadrature(a,r):n.charAt(0)==="x"?a:r},W.getClosest=function(n,a,r){if(r.index!==!1)r.index>=0&&r.index<n.length?r.distance=0:r.index=!1;else for(var g=0;g<n.length;g++){var u=a(n[g]);u<=r.distance&&(r.index=g,r.distance=u)}return r},W.inbox=function(n,a,r){return n*a<0||n===0?r:1/0},W.quadrature=function(n,a){return function(r){var g=n(r),u=a(r);return Math.sqrt(g*g+u*u)}},W.makeEventData=function(n,a,r){var g="index"in n?n.index:n.pointNumber,u={data:a._input,fullData:a,curveNumber:a.index,pointNumber:g};if(a._indexToPoints){var s=a._indexToPoints[g];s.length===1?u.pointIndex=s[0]:u.pointIndices=s}else u.pointIndex=g;return a._module.eventData?u=a._module.eventData(u,n,a,r,g):("xVal"in n?u.x=n.xVal:"x"in n&&(u.x=n.x),"yVal"in n?u.y=n.yVal:"y"in n&&(u.y=n.y),n.xa&&(u.xaxis=n.xa),n.ya&&(u.yaxis=n.ya),n.zLabelVal!==void 0&&(u.z=n.zLabelVal)),W.appendArrayPointValue(u,a,g),u},W.appendArrayPointValue=function(n,a,r){var g=a._arrayAttrs;if(g)for(var u=0;u<g.length;u++){var s=g[u],h=w(s);if(n[h]===void 0){var l=y(d.nestedProperty(a,s).get(),r);l!==void 0&&(n[h]=l)}}},W.appendArrayMultiPointValues=function(n,a,r){var g=a._arrayAttrs;if(g)for(var u=0;u<g.length;u++){var s=g[u],h=w(s);if(n[h]===void 0){for(var l=d.nestedProperty(a,s).get(),o=new Array(r.length),p=0;p<r.length;p++)o[p]=y(l,r[p]);n[h]=o}}};var v={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function w(n){return v[n]||n}function y(n,a){return Array.isArray(a)?Array.isArray(n)&&Array.isArray(n[a[0]])?n[a[0]][a[1]]:void 0:n[a]}var e={x:!0,y:!0},t={"x unified":!0,"y unified":!0};W.isUnifiedHover=function(n){return typeof n=="string"&&!!t[n]},W.isXYhover=function(n){return typeof n=="string"&&!!e[n]}},{"../../lib":515}],404:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("tinycolor2"),y=m("../../lib"),e=y.strTranslate,t=y.strRotate,n=m("../../lib/events"),a=m("../../lib/svg_text_utils"),r=m("../../lib/override_cursor"),g=m("../drawing"),u=m("../color"),s=m("../dragelement"),h=m("../../plots/cartesian/axes"),l=m("../../registry"),o=m("./helpers"),p=m("./constants"),c=m("../legend/defaults"),i=m("../legend/draw"),x=p.YANGLE,f=Math.PI*x/180,_=1/Math.sin(f),b=Math.cos(f),T=Math.sin(f),k=p.HOVERARROWSIZE,L=p.HOVERTEXTPAD,A={box:!0,ohlc:!0,violin:!0,candlestick:!0},I={scatter:!0,scattergl:!0,splom:!0};function P(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}W.hover=function(N,U,te,B){N=y.getGraphDiv(N);var X=U.target;y.throttle(N._fullLayout._uid+p.HOVERID,p.HOVERMINTIME,function(){(function(J,ee,re,se,oe){re||(re="xy");var de=Array.isArray(re)?re:[re],ce=J._fullLayout,ve=ce._plots||[],Ae=ve[re],fe=ce._has("cartesian");if(Ae){var me=Ae.overlays.map(function(jr){return jr.id});de=de.concat(me)}for(var _e=de.length,le=new Array(_e),ge=new Array(_e),Te=!1,Se=0;Se<_e;Se++){var Me=de[Se];if(ve[Me])Te=!0,le[Se]=ve[Me].xaxis,ge[Se]=ve[Me].yaxis;else{if(!ce[Me]||!ce[Me]._subplot)return void y.warn("Unrecognized subplot: "+Me);var ze=ce[Me]._subplot;le[Se]=ze.xaxis,ge[Se]=ze.yaxis}}var Oe=ee.hovermode||ce.hovermode;if(Oe&&!Te&&(Oe="closest"),["x","y","closest","x unified","y unified"].indexOf(Oe)===-1||!J.calcdata||J.querySelector(".zoombox")||J._dragging)return s.unhoverRaw(J,ee);var De=ce.hoverdistance;De===-1&&(De=1/0);var Xe=ce.spikedistance;Xe===-1&&(Xe=1/0);var Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e,vt,Nt,qt=[],Jt=[],Wt={hLinePoint:null,vLinePoint:null},ar=!1;if(Array.isArray(ee))for(Oe="array",Re=0;Re<ee.length;Re++)(Qe=J.calcdata[ee[Re].curveNumber||0])&&(lt=Qe[0].trace,Qe[0].trace.hoverinfo!=="skip"&&(Jt.push(Qe),lt.orientation==="h"&&(ar=!0)));else{for(Ye=0;Ye<J.calcdata.length;Ye++)Qe=J.calcdata[Ye],(lt=Qe[0].trace).hoverinfo!=="skip"&&o.isTraceInSubplots(lt,de)&&(Jt.push(Qe),lt.orientation==="h"&&(ar=!0));var Dt,Ne;if(!oe)Dt="xpx"in ee?ee.xpx:le[0]._length/2,Ne="ypx"in ee?ee.ypx:ge[0]._length/2;else{if(n.triggerHandler(J,"plotly_beforehover",ee)===!1)return;var qe=oe.getBoundingClientRect();Dt=ee.clientX-qe.left,Ne=ee.clientY-qe.top,ce._calcInverseTransform(J);var pe=y.apply3DTransform(ce._invTransform)(Dt,Ne);if(Dt=pe[0],Ne=pe[1],Dt<0||Dt>le[0]._length||Ne<0||Ne>ge[0]._length)return s.unhoverRaw(J,ee)}if(ee.pointerX=Dt+le[0]._offset,ee.pointerY=Ne+ge[0]._offset,Be="xval"in ee?o.flat(de,ee.xval):o.p2c(le,Dt),Ie="yval"in ee?o.flat(de,ee.yval):o.p2c(ge,Ne),!v(Be[0])||!v(Ie[0]))return y.warn("Fx.hover failed",ee,J),s.unhoverRaw(J,ee)}var be=1/0;function Fe(jr,nn){for(Ye=0;Ye<Jt.length;Ye++)if((Qe=Jt[Ye])&&Qe[0]&&Qe[0].trace&&(lt=Qe[0].trace).visible===!0&&lt._length!==0&&["carpet","contourcarpet"].indexOf(lt._module.name)===-1){if(lt.type==="splom"?xt=de[wt=0]:(xt=o.getSubplot(lt),wt=de.indexOf(xt)),bt=Oe,o.isUnifiedHover(bt)&&(bt=bt.charAt(0)),vt={cd:Qe,trace:lt,xa:le[wt],ya:ge[wt],maxHoverDistance:De,maxSpikeDistance:Xe,index:!1,distance:Math.min(be,De),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:u.defaultLine,name:lt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ce[xt]&&(vt.subplot=ce[xt]._subplot),ce._splomScenes&&ce._splomScenes[lt.uid]&&(vt.scene=ce._splomScenes[lt.uid]),Nt=qt.length,bt==="array"){var vn=ee[Ye];"pointNumber"in vn?(vt.index=vn.pointNumber,bt="closest"):(bt="","xval"in vn&&(nt=vn.xval,bt="x"),"yval"in vn&&($e=vn.yval,bt=bt?"closest":"y"))}else jr!==void 0&&nn!==void 0?(nt=jr,$e=nn):(nt=Be[wt],$e=Ie[wt]);if(De!==0)if(lt._module&&lt._module.hoverPoints){var en=lt._module.hoverPoints(vt,nt,$e,bt,{finiteRange:!0,hoverLayer:ce._hoverlayer});if(en)for(var fn,Gn=0;Gn<en.length;Gn++)fn=en[Gn],v(fn.x0)&&v(fn.y0)&&qt.push(j(fn,Oe))}else y.log("Unrecognized trace type in hover:",lt);if(Oe==="closest"&&qt.length>Nt&&(qt.splice(0,Nt),be=qt[0].distance),fe&&Xe!==0&&qt.length===0){vt.distance=Xe,vt.index=!1;var Tn=lt._module.hoverPoints(vt,nt,$e,"closest",{hoverLayer:ce._hoverlayer});if(Tn&&(Tn=Tn.filter(function(lr){return lr.spikeDistance<=Xe})),Tn&&Tn.length){var Cn,oi=Tn.filter(function(lr){return lr.xa.showspikes&&lr.xa.spikesnap!=="hovered data"});if(oi.length){var nr=oi[0];v(nr.x0)&&v(nr.y0)&&(Cn=Ke(nr),(!Wt.vLinePoint||Wt.vLinePoint.spikeDistance>Cn.spikeDistance)&&(Wt.vLinePoint=Cn))}var vr=Tn.filter(function(lr){return lr.ya.showspikes&&lr.ya.spikesnap!=="hovered data"});if(vr.length){var It=vr[0];v(It.x0)&&v(It.y0)&&(Cn=Ke(It),(!Wt.hLinePoint||Wt.hLinePoint.spikeDistance>Cn.spikeDistance)&&(Wt.hLinePoint=Cn))}}}}}function Ve(jr,nn,vn){for(var en,fn=null,Gn=1/0,Tn=0;Tn<jr.length;Tn++)en=jr[Tn].spikeDistance,vn&&Tn===0&&(en=-1/0),en<=Gn&&en<=nn&&(fn=jr[Tn],Gn=en);return fn}function Ke(jr){return jr?{xa:jr.xa,ya:jr.ya,x:jr.xSpike!==void 0?jr.xSpike:(jr.x0+jr.x1)/2,y:jr.ySpike!==void 0?jr.ySpike:(jr.y0+jr.y1)/2,distance:jr.distance,spikeDistance:jr.spikeDistance,curveNumber:jr.trace.index,color:jr.color,pointNumber:jr.index}:null}Fe();var Ge={fullLayout:ce,container:ce._hoverlayer,event:ee},ct=J._spikepoints,st={vLinePoint:Wt.vLinePoint,hLinePoint:Wt.hLinePoint};J._spikepoints=st;var Mt=function(){qt.sort(function(jr,nn){return jr.distance-nn.distance}),qt=function(jr,nn){for(var vn=nn.charAt(0),en=[],fn=[],Gn=[],Tn=0;Tn<jr.length;Tn++){var Cn=jr[Tn];l.traceIs(Cn.trace,"bar-like")||l.traceIs(Cn.trace,"box-violin")?Gn.push(Cn):Cn.trace[vn+"period"]?fn.push(Cn):en.push(Cn)}return en.concat(fn).concat(Gn)}(qt,Oe)};Mt();var Ot=Oe.charAt(0),it=(Ot==="x"||Ot==="y")&&qt[0]&&I[qt[0].trace.type];if(fe&&Xe!==0&&qt.length!==0){var ht=Ve(qt.filter(function(jr){return jr.ya.showspikes}),Xe,it);Wt.hLinePoint=Ke(ht);var jt=Ve(qt.filter(function(jr){return jr.xa.showspikes}),Xe,it);Wt.vLinePoint=Ke(jt)}if(qt.length===0){var kt=s.unhoverRaw(J,ee);return!fe||Wt.hLinePoint===null&&Wt.vLinePoint===null||Z(ct)&&V(J,Wt,Ge),kt}if(fe&&Z(ct)&&V(J,Wt,Ge),o.isXYhover(bt)&&qt[0].length!==0&&qt[0].trace.type!=="splom"){var Pt=qt[0],Ee=(qt=A[Pt.trace.type]?qt.filter(function(jr){return jr.trace.index===Pt.trace.index}):[Pt]).length,Ze=K("x",Pt,ce),at=K("y",Pt,ce);Fe(Ze,at);var pt,St=[],Ut={},Kt=0,Ht=function(jr){var nn=A[jr.trace.type]?P(jr):jr.trace.index;if(Ut[nn]){var vn=Ut[nn]-1,en=St[vn];vn>0&&Math.abs(jr.distance)<Math.abs(en.distance)&&(St[vn]=jr)}else Kt++,Ut[nn]=Kt,St.push(jr)};for(pt=0;pt<Ee;pt++)Ht(qt[pt]);for(pt=qt.length-1;pt>Ee-1;pt--)Ht(qt[pt]);qt=St,Mt()}var pr=J._hoverdata,Mr=[],hr=$(J),Qt=ne(J);for(Re=0;Re<qt.length;Re++){var tr=qt[Re],rr=o.makeEventData(tr,tr.trace,tr.cd);if(tr.hovertemplate!==!1){var fr=!1;tr.cd[tr.index]&&tr.cd[tr.index].ht&&(fr=tr.cd[tr.index].ht),tr.hovertemplate=fr||tr.trace.hovertemplate||!1}if(tr.xa&&tr.ya){var yr=tr.x0+tr.xa._offset,Sr=tr.x1+tr.xa._offset,Dr=tr.y0+tr.ya._offset,Nr=tr.y1+tr.ya._offset,Wr=Math.min(yr,Sr),hn=Math.max(yr,Sr),tn=Math.min(Dr,Nr),Fn=Math.max(Dr,Nr);rr.bbox={x0:Wr+Qt,x1:hn+Qt,y0:tn+hr,y1:Fn+hr}}tr.eventData=[rr],Mr.push(rr)}J._hoverdata=Mr;var an=Oe==="y"&&(Jt.length>1||qt.length>1)||Oe==="closest"&&ar&&qt.length>1,xn=u.combine(ce.plot_bgcolor||u.background,ce.paper_bgcolor),_n=E(qt,{gd:J,hovermode:Oe,rotateLabels:an,bgColor:xn,container:ce._hoverlayer,outerContainer:ce._paper.node(),commonLabelOpts:ce.hoverlabel,hoverdistance:ce.hoverdistance});if(o.isUnifiedHover(Oe)||(function(jr,nn,vn){var en,fn,Gn,Tn,Cn,oi,nr,vr=0,It=1,lr=jr.size(),dr=new Array(lr),Br=0;function Fr(qr){var Qr=qr[0],rn=qr[qr.length-1];if(fn=Qr.pmin-Qr.pos-Qr.dp+Qr.size,Gn=rn.pos+rn.dp+rn.size-Qr.pmax,fn>.01){for(Cn=qr.length-1;Cn>=0;Cn--)qr[Cn].dp+=fn;en=!1}if(!(Gn<.01)){if(fn<-.01){for(Cn=qr.length-1;Cn>=0;Cn--)qr[Cn].dp-=Gn;en=!1}if(en){var yn=0;for(Tn=0;Tn<qr.length;Tn++)(oi=qr[Tn]).pos+oi.dp+oi.size>Qr.pmax&&yn++;for(Tn=qr.length-1;Tn>=0&&!(yn<=0);Tn--)(oi=qr[Tn]).pos>Qr.pmax-1&&(oi.del=!0,yn--);for(Tn=0;Tn<qr.length&&!(yn<=0);Tn++)if((oi=qr[Tn]).pos<Qr.pmin+1)for(oi.del=!0,yn--,Gn=2*oi.size,Cn=qr.length-1;Cn>=0;Cn--)qr[Cn].dp-=Gn;for(Tn=qr.length-1;Tn>=0&&!(yn<=0);Tn--)(oi=qr[Tn]).pos+oi.dp+oi.size>Qr.pmax&&(oi.del=!0,yn--)}}}for(jr.each(function(qr){var Qr=qr[nn],rn=Qr._id.charAt(0)==="x",yn=Qr.range;Br===0&&yn&&yn[0]>yn[1]!==rn&&(It=-1),dr[Br++]=[{datum:qr,traceIndex:qr.trace.index,dp:0,pos:qr.pos,posref:qr.posref,size:qr.by*(rn?_:1)/2,pmin:0,pmax:rn?vn.width:vn.height}]}),dr.sort(function(qr,Qr){return qr[0].posref-Qr[0].posref||It*(Qr[0].traceIndex-qr[0].traceIndex)});!en&&vr<=lr;){for(vr++,en=!0,Tn=0;Tn<dr.length-1;){var zr=dr[Tn],Er=dr[Tn+1],xr=zr[zr.length-1],_r=Er[0];if((fn=xr.pos+xr.dp+xr.size-_r.pos-_r.dp+_r.size)>.01&&xr.pmin===_r.pmin&&xr.pmax===_r.pmax){for(Cn=Er.length-1;Cn>=0;Cn--)Er[Cn].dp+=fn;for(zr.push.apply(zr,Er),dr.splice(Tn+1,1),nr=0,Cn=zr.length-1;Cn>=0;Cn--)nr+=zr[Cn].dp;for(Gn=nr/zr.length,Cn=zr.length-1;Cn>=0;Cn--)zr[Cn].dp-=Gn;en=!1}else Tn++}dr.forEach(Fr)}for(Tn=dr.length-1;Tn>=0;Tn--){var kr=dr[Tn];for(Cn=kr.length-1;Cn>=0;Cn--){var Cr=kr[Cn],Gr=Cr.datum;Gr.offset=Cr.dp,Gr.del=Cr.del}}}(_n,an?"xa":"ya",ce),D(_n,an,ce._invScaleX,ce._invScaleY)),oe&&oe.tagName){var ti=l.getComponentMethod("annotations","hasClickToShow")(J,Mr);r(d.select(oe),ti?"pointer":"")}!oe||se||!function(jr,nn,vn){if(!vn||vn.length!==jr._hoverdata.length)return!0;for(var en=vn.length-1;en>=0;en--){var fn=vn[en],Gn=jr._hoverdata[en];if(fn.curveNumber!==Gn.curveNumber||String(fn.pointNumber)!==String(Gn.pointNumber)||String(fn.pointNumbers)!==String(Gn.pointNumbers))return!0}return!1}(J,0,pr)||(pr&&J.emit("plotly_unhover",{event:ee,points:pr}),J.emit("plotly_hover",{event:ee,points:J._hoverdata,xaxes:le,yaxes:ge,xvals:Be,yvals:Ie}))})(N,U,te,B,X)})},W.loneHover=function(N,U){var te=!0;Array.isArray(N)||(te=!1,N=[N]);var B=U.gd,X=$(B),J=ne(B),ee=E(N.map(function(oe){var de=oe._x0||oe.x0||oe.x||0,ce=oe._x1||oe.x1||oe.x||0,ve=oe._y0||oe.y0||oe.y||0,Ae=oe._y1||oe.y1||oe.y||0,fe=oe.eventData;if(fe){var me=Math.min(de,ce),_e=Math.max(de,ce),le=Math.min(ve,Ae),ge=Math.max(ve,Ae),Te=oe.trace;if(l.traceIs(Te,"gl3d")){var Se=B._fullLayout[Te.scene]._scene.container,Me=Se.offsetLeft,ze=Se.offsetTop;me+=Me,_e+=Me,le+=ze,ge+=ze}fe.bbox={x0:me+J,x1:_e+J,y0:le+X,y1:ge+X},U.inOut_bbox&&U.inOut_bbox.push(fe.bbox)}else fe=!1;return{color:oe.color||u.defaultLine,x0:oe.x0||oe.x||0,x1:oe.x1||oe.x||0,y0:oe.y0||oe.y||0,y1:oe.y1||oe.y||0,xLabel:oe.xLabel,yLabel:oe.yLabel,zLabel:oe.zLabel,text:oe.text,name:oe.name,idealAlign:oe.idealAlign,borderColor:oe.borderColor,fontFamily:oe.fontFamily,fontSize:oe.fontSize,fontColor:oe.fontColor,nameLength:oe.nameLength,textAlign:oe.textAlign,trace:oe.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:oe.hovertemplate||!1,hovertemplateLabels:oe.hovertemplateLabels||!1,eventData:fe}}),{gd:B,hovermode:"closest",rotateLabels:!1,bgColor:U.bgColor||u.background,container:d.select(U.container),outerContainer:U.outerContainer||U.container}),re=0,se=0;return ee.sort(function(oe,de){return oe.y0-de.y0}).each(function(oe,de){var ce=oe.y0-oe.by/2;oe.offset=ce-5<re?re-ce+5:0,re=ce+oe.by+oe.offset,de===U.anchorIndex&&(se=oe.offset)}).each(function(oe){oe.offset-=se}),D(ee,!1,B._fullLayout._invScaleX,B._fullLayout._invScaleY),te?ee:ee.node()};var S=/<extra>([\s\S]*)<\/extra>/;function E(N,U){var te=U.gd,B=te._fullLayout,X=U.hovermode,J=U.rotateLabels,ee=U.bgColor,re=U.container,se=U.outerContainer,oe=U.commonLabelOpts||{};if(N.length===0)return[[]];var de=U.fontFamily||p.HOVERFONT,ce=U.fontSize||p.HOVERFONTSIZE,ve=N[0],Ae=ve.xa,fe=ve.ya,me=X.charAt(0),_e=ve[me+"Label"],le=H(te,se),ge=le.top,Te=le.width,Se=le.height,Me=_e!==void 0&&ve.distance<=U.hoverdistance&&(X==="x"||X==="y");if(Me){var ze,Oe,De=!0;for(ze=0;ze<N.length;ze++)if(De&&N[ze].zLabel===void 0&&(De=!1),Oe=N[ze].hoverinfo||N[ze].trace.hoverinfo){var Xe=Array.isArray(Oe)?Oe:Oe.split("+");if(Xe.indexOf("all")===-1&&Xe.indexOf(X)===-1){Me=!1;break}}De&&(Me=!1)}var Be=re.selectAll("g.axistext").data(Me?[0]:[]);if(Be.enter().append("g").classed("axistext",!0),Be.exit().remove(),Be.each(function(){var it=d.select(this),ht=y.ensureSingle(it,"path","",function(Sr){Sr.style({"stroke-width":"1px"})}),jt=y.ensureSingle(it,"text","",function(Sr){Sr.attr("data-notex",1)}),kt=oe.bgcolor||u.defaultLine,Pt=oe.bordercolor||u.contrast(kt),Ee=u.contrast(kt),Ze={family:oe.font.family||de,size:oe.font.size||ce,color:oe.font.color||Ee};ht.style({fill:kt,stroke:Pt}),jt.text(_e).call(g.font,Ze).call(a.positionText,0,0).call(a.convertToTspans,te),it.attr("transform","");var at,pt,St=H(te,jt.node());if(X==="x"){var Ut=Ae.side==="top"?"-":"";jt.attr("text-anchor","middle").call(a.positionText,0,Ae.side==="top"?ge-St.bottom-k-L:ge-St.top+k+L),at=Ae._offset+(ve.x0+ve.x1)/2,pt=fe._offset+(Ae.side==="top"?0:fe._length);var Kt=St.width/2+L;at<Kt?(at=Kt,ht.attr("d","M-"+(Kt-k)+",0L-"+(Kt-2*k)+","+Ut+k+"H"+(L+St.width/2)+"v"+Ut+(2*L+St.height)+"H-"+Kt+"V"+Ut+k+"Z")):at>B.width-Kt?(at=B.width-Kt,ht.attr("d","M"+(Kt-k)+",0L"+Kt+","+Ut+k+"v"+Ut+(2*L+St.height)+"H-"+Kt+"V"+Ut+k+"H"+(Kt-2*k)+"Z")):ht.attr("d","M0,0L"+k+","+Ut+k+"H"+(L+St.width/2)+"v"+Ut+(2*L+St.height)+"H-"+(L+St.width/2)+"V"+Ut+k+"H-"+k+"Z")}else{var Ht,pr,Mr;fe.side==="right"?(Ht="start",pr=1,Mr="",at=Ae._offset+Ae._length):(Ht="end",pr=-1,Mr="-",at=Ae._offset),pt=fe._offset+(ve.y0+ve.y1)/2,jt.attr("text-anchor",Ht),ht.attr("d","M0,0L"+Mr+k+","+k+"V"+(L+St.height/2)+"h"+Mr+(2*L+St.width)+"V-"+(L+St.height/2)+"H"+Mr+k+"V-"+k+"Z");var hr,Qt=St.height/2,tr=ge-St.top-Qt,rr="clip"+B._uid+"commonlabel"+fe._id;if(at<St.width+2*L+k){hr="M-"+(k+L)+"-"+Qt+"h-"+(St.width-L)+"V"+Qt+"h"+(St.width-L)+"Z";var fr=St.width-at+L;a.positionText(jt,fr,tr),Ht==="end"&&jt.selectAll("tspan").each(function(){var Sr=d.select(this),Dr=g.tester.append("text").text(Sr.text()).call(g.font,Ze),Nr=H(te,Dr.node());Math.round(Nr.width)<Math.round(St.width)&&Sr.attr("x",fr-Nr.width),Dr.remove()})}else a.positionText(jt,pr*(L+k),tr),hr=null;var yr=B._topclips.selectAll("#"+rr).data(hr?[0]:[]);yr.enter().append("clipPath").attr("id",rr).append("path"),yr.exit().remove(),yr.select("path").attr("d",hr),g.setClipUrl(jt,hr?rr:null,te)}it.attr("transform",e(at,pt))}),o.isUnifiedHover(X)){re.selectAll("g.hovertext").remove();var Ie=N.filter(function(it){return it.hoverinfo!=="none"});if(Ie.length===0)return;var Re=B.hoverlabel,Ye=Re.font,Qe={showlegend:!0,legend:{title:{text:_e,font:Ye},font:Ye,bgcolor:Re.bgcolor,bordercolor:Re.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:B.legend?B.legend.traceorder:void 0,orientation:"v"}},lt={font:Ye};c(Qe,lt,te._fullData);var xt=lt.legend;xt.entries=[];for(var wt=0;wt<Ie.length;wt++){var bt=Ie[wt];if(bt.hoverinfo!=="none"){var nt=z(bt,!0,X,B,_e),$e=nt[0],vt=nt[1];bt.name=vt,bt.text=vt!==""?vt+" : "+$e:$e;var Nt=bt.cd[bt.index];Nt&&(Nt.mc&&(bt.mc=Nt.mc),Nt.mcc&&(bt.mc=Nt.mcc),Nt.mlc&&(bt.mlc=Nt.mlc),Nt.mlcc&&(bt.mlc=Nt.mlcc),Nt.mlw&&(bt.mlw=Nt.mlw),Nt.mrc&&(bt.mrc=Nt.mrc),Nt.dir&&(bt.dir=Nt.dir)),bt._distinct=!0,xt.entries.push([bt])}}xt.entries.sort(function(it,ht){return it[0].trace.index-ht[0].trace.index}),xt.layer=re,xt._inHover=!0,xt._groupTitleFont=Re.grouptitlefont,i(te,xt);var qt,Jt,Wt,ar,Dt=re.select("g.legend"),Ne=H(te,Dt.node()),qe=Ne.width+2*L,pe=Ne.height+2*L,be=Ie[0],Fe=(be.x0+be.x1)/2,Ve=(be.y0+be.y1)/2,Ke=!(l.traceIs(be.trace,"bar-like")||l.traceIs(be.trace,"box-violin"));me==="y"?Ke?(Jt=Ve-L,qt=Ve+L):(Jt=Math.min.apply(null,Ie.map(function(it){return Math.min(it.y0,it.y1)})),qt=Math.max.apply(null,Ie.map(function(it){return Math.max(it.y0,it.y1)}))):Jt=qt=y.mean(Ie.map(function(it){return(it.y0+it.y1)/2}))-pe/2,me==="x"?Ke?(Wt=Fe+L,ar=Fe-L):(Wt=Math.max.apply(null,Ie.map(function(it){return Math.max(it.x0,it.x1)})),ar=Math.min.apply(null,Ie.map(function(it){return Math.min(it.x0,it.x1)}))):Wt=ar=y.mean(Ie.map(function(it){return(it.x0+it.x1)/2}))-qe/2;var Ge,ct,st=Ae._offset,Mt=fe._offset;return ar+=st-qe,Jt+=Mt-pe,Ge=(Wt+=st)+qe<Te&&Wt>=0?Wt:ar+qe<Te&&ar>=0?ar:st+qe<Te?st:Wt-Fe<Fe-ar+qe?Te-qe:0,Ge+=L,ct=(qt+=Mt)+pe<Se&&qt>=0?qt:Jt+pe<Se&&Jt>=0?Jt:Mt+pe<Se?Mt:qt-Ve<Ve-Jt+pe?Se-pe:0,ct+=L,Dt.attr("transform",e(Ge-1,ct-1)),Dt}var Ot=re.selectAll("g.hovertext").data(N,function(it){return P(it)});return Ot.enter().append("g").classed("hovertext",!0).each(function(){var it=d.select(this);it.append("rect").call(u.fill,u.addOpacity(ee,.8)),it.append("text").classed("name",!0),it.append("path").style("stroke-width","1px"),it.append("text").classed("nums",!0).call(g.font,de,ce)}),Ot.exit().remove(),Ot.each(function(it){var ht=d.select(this).attr("transform",""),jt=it.color;Array.isArray(jt)&&(jt=jt[it.eventData[0].pointNumber]);var kt=it.bgcolor||jt,Pt=u.combine(u.opacity(kt)?kt:u.defaultLine,ee),Ee=u.combine(u.opacity(jt)?jt:u.defaultLine,ee),Ze=it.borderColor||u.contrast(Pt),at=z(it,Me,X,B,_e,ht),pt=at[0],St=at[1],Ut=ht.select("text.nums").call(g.font,it.fontFamily||de,it.fontSize||ce,it.fontColor||Ze).text(pt).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,te),Kt=ht.select("text.name"),Ht=0,pr=0;if(St&&St!==pt){Kt.call(g.font,it.fontFamily||de,it.fontSize||ce,Ee).text(St).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,te);var Mr=H(te,Kt.node());Ht=Mr.width+2*L,pr=Mr.height+2*L}else Kt.remove(),ht.select("rect").remove();ht.select("path").style({fill:Pt,stroke:Ze});var hr=it.xa._offset+(it.x0+it.x1)/2,Qt=it.ya._offset+(it.y0+it.y1)/2,tr=Math.abs(it.x1-it.x0),rr=Math.abs(it.y1-it.y0),fr=H(te,Ut.node()),yr=fr.width/B._invScaleX,Sr=fr.height/B._invScaleY;it.ty0=(ge-fr.top)/B._invScaleY,it.bx=yr+2*L,it.by=Math.max(Sr+2*L,pr),it.anchor="start",it.txwidth=yr,it.tx2width=Ht,it.offset=0;var Dr,Nr,Wr=(yr+k+L+Ht)*B._invScaleX;if(J)it.pos=hr,Dr=Qt+rr/2+Wr<=Se,Nr=Qt-rr/2-Wr>=0,it.idealAlign!=="top"&&Dr||!Nr?Dr?(Qt+=rr/2,it.anchor="start"):it.anchor="middle":(Qt-=rr/2,it.anchor="end");else if(it.pos=Qt,Dr=hr+tr/2+Wr<=Te,Nr=hr-tr/2-Wr>=0,it.idealAlign!=="left"&&Dr||!Nr)if(Dr)hr+=tr/2,it.anchor="start";else{it.anchor="middle";var hn=Wr/2,tn=hr+hn-Te,Fn=hr-hn;tn>0&&(hr-=tn),Fn<0&&(hr+=-Fn)}else hr-=tr/2,it.anchor="end";Ut.attr("text-anchor",it.anchor),Ht&&Kt.attr("text-anchor",it.anchor),ht.attr("transform",e(hr,Qt)+(J?t(x):""))}),Ot}function z(N,U,te,B,X,J){var ee="",re="";N.nameOverride!==void 0&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=y.templateString(N.name,N.trace._meta)),ee=Q(N.name,N.nameLength));var se=te.charAt(0),oe=se==="x"?"y":"x";N.zLabel!==void 0?(N.xLabel!==void 0&&(re+="x: "+N.xLabel+"<br>"),N.yLabel!==void 0&&(re+="y: "+N.yLabel+"<br>"),N.trace.type!=="choropleth"&&N.trace.type!=="choroplethmapbox"&&(re+=(re?"z: ":"")+N.zLabel)):U&&N[se+"Label"]===X?re=N[oe+"Label"]||"":N.xLabel===void 0?N.yLabel!==void 0&&N.trace.type!=="scattercarpet"&&(re=N.yLabel):re=N.yLabel===void 0?N.xLabel:"("+N.xLabel+", "+N.yLabel+")",!N.text&&N.text!==0||Array.isArray(N.text)||(re+=(re?"<br>":"")+N.text),N.extraText!==void 0&&(re+=(re?"<br>":"")+N.extraText),J&&re===""&&!N.hovertemplate&&(ee===""&&J.remove(),re=ee);var de=N.hovertemplate||!1;if(de){var ce=N.hovertemplateLabels||N;N[se+"Label"]!==X&&(ce[se+"other"]=ce[se+"Val"],ce[se+"otherLabel"]=ce[se+"Label"]),re=(re=y.hovertemplateString(de,ce,B._d3locale,N.eventData[0]||{},N.trace._meta)).replace(S,function(ve,Ae){return ee=Q(Ae,N.nameLength),""})}return[re,ee]}function D(N,U,te,B){var X=function(ee){return ee*te},J=function(ee){return ee*B};N.each(function(ee){var re=d.select(this);if(ee.del)return re.remove();var se=re.select("text.nums"),oe=ee.anchor,de=oe==="end"?-1:1,ce={start:1,end:-1,middle:0}[oe],ve=ce*(k+L),Ae=ve+ce*(ee.txwidth+L),fe=0,me=ee.offset,_e=oe==="middle";_e&&(ve-=ee.tx2width/2,Ae+=ee.txwidth/2+L),U&&(me*=-T,fe=ee.offset*b),re.select("path").attr("d",_e?"M-"+X(ee.bx/2+ee.tx2width/2)+","+J(me-ee.by/2)+"h"+X(ee.bx)+"v"+J(ee.by)+"h-"+X(ee.bx)+"Z":"M0,0L"+X(de*k+fe)+","+J(k+me)+"v"+J(ee.by/2-k)+"h"+X(de*ee.bx)+"v-"+J(ee.by)+"H"+X(de*k+fe)+"V"+J(me-k)+"Z");var le=fe+ve,ge=me+ee.ty0-ee.by/2+L,Te=ee.textAlign||"auto";Te!=="auto"&&(Te==="left"&&oe!=="start"?(se.attr("text-anchor","start"),le=_e?-ee.bx/2-ee.tx2width/2+L:-ee.bx-L):Te==="right"&&oe!=="end"&&(se.attr("text-anchor","end"),le=_e?ee.bx/2-ee.tx2width/2-L:ee.bx+L)),se.call(a.positionText,X(le),J(ge)),ee.tx2width&&(re.select("text.name").call(a.positionText,X(Ae+ce*L+fe),J(me+ee.ty0-ee.by/2+L)),re.select("rect").call(g.setRect,X(Ae+(ce-1)*ee.tx2width/2+fe),J(me-ee.by/2-1),X(ee.tx2width),J(ee.by+2)))})}function j(N,U){var te=N.index,B=N.trace||{},X=N.cd[0],J=N.cd[te]||{};function ee(ve){return ve||v(ve)&&ve===0}var re=Array.isArray(te)?function(ve,Ae){var fe=y.castOption(X,te,ve);return ee(fe)?fe:y.extractOption({},B,"",Ae)}:function(ve,Ae){return y.extractOption(J,B,ve,Ae)};function se(ve,Ae,fe){var me=re(Ae,fe);ee(me)&&(N[ve]=me)}if(se("hoverinfo","hi","hoverinfo"),se("bgcolor","hbg","hoverlabel.bgcolor"),se("borderColor","hbc","hoverlabel.bordercolor"),se("fontFamily","htf","hoverlabel.font.family"),se("fontSize","hts","hoverlabel.font.size"),se("fontColor","htc","hoverlabel.font.color"),se("nameLength","hnl","hoverlabel.namelength"),se("textAlign","hta","hoverlabel.align"),N.posref=U==="y"||U==="closest"&&B.orientation==="h"?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=y.constrain(N.x0,0,N.xa._length),N.x1=y.constrain(N.x1,0,N.xa._length),N.y0=y.constrain(N.y0,0,N.ya._length),N.y1=y.constrain(N.y1,0,N.ya._length),N.xLabelVal!==void 0&&(N.xLabel="xLabel"in N?N.xLabel:h.hoverLabelText(N.xa,N.xLabelVal,B.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),N.yLabelVal!==void 0&&(N.yLabel="yLabel"in N?N.yLabel:h.hoverLabelText(N.ya,N.yLabelVal,B.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),N.zLabelVal!==void 0&&N.zLabel===void 0&&(N.zLabel=String(N.zLabelVal)),!(isNaN(N.xerr)||N.xa.type==="log"&&N.xerr<=0)){var oe=h.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xerrneg!==void 0?N.xLabel+=" +"+oe+" / -"+h.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:N.xLabel+=" \xB1 "+oe,U==="x"&&(N.distance+=1)}if(!(isNaN(N.yerr)||N.ya.type==="log"&&N.yerr<=0)){var de=h.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yerrneg!==void 0?N.yLabel+=" +"+de+" / -"+h.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:N.yLabel+=" \xB1 "+de,U==="y"&&(N.distance+=1)}var ce=N.hoverinfo||N.trace.hoverinfo;return ce&&ce!=="all"&&((ce=Array.isArray(ce)?ce:ce.split("+")).indexOf("x")===-1&&(N.xLabel=void 0),ce.indexOf("y")===-1&&(N.yLabel=void 0),ce.indexOf("z")===-1&&(N.zLabel=void 0),ce.indexOf("text")===-1&&(N.text=void 0),ce.indexOf("name")===-1&&(N.name=void 0)),N}function V(N,U,te){var B,X,J=te.container,ee=te.fullLayout,re=ee._size,se=te.event,oe=!!U.hLinePoint,de=!!U.vLinePoint;if(J.selectAll(".spikeline").remove(),de||oe){var ce=u.combine(ee.plot_bgcolor,ee.paper_bgcolor);if(oe){var ve,Ae,fe=U.hLinePoint;B=fe&&fe.xa,(X=fe&&fe.ya).spikesnap==="cursor"?(ve=se.pointerX,Ae=se.pointerY):(ve=B._offset+fe.x,Ae=X._offset+fe.y);var me,_e,le=w.readability(fe.color,ce)<1.5?u.contrast(ce):fe.color,ge=X.spikemode,Te=X.spikethickness,Se=X.spikecolor||le,Me=h.getPxPosition(N,X);if(ge.indexOf("toaxis")!==-1||ge.indexOf("across")!==-1){if(ge.indexOf("toaxis")!==-1&&(me=Me,_e=ve),ge.indexOf("across")!==-1){var ze=X._counterDomainMin,Oe=X._counterDomainMax;X.anchor==="free"&&(ze=Math.min(ze,X.position),Oe=Math.max(Oe,X.position)),me=re.l+ze*re.w,_e=re.l+Oe*re.w}J.insert("line",":first-child").attr({x1:me,x2:_e,y1:Ae,y2:Ae,"stroke-width":Te,stroke:Se,"stroke-dasharray":g.dashStyle(X.spikedash,Te)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:me,x2:_e,y1:Ae,y2:Ae,"stroke-width":Te+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}ge.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:Me+(X.side!=="right"?Te:-Te),cy:Ae,r:Te,fill:Se}).classed("spikeline",!0)}if(de){var De,Xe,Be=U.vLinePoint;B=Be&&Be.xa,X=Be&&Be.ya,B.spikesnap==="cursor"?(De=se.pointerX,Xe=se.pointerY):(De=B._offset+Be.x,Xe=X._offset+Be.y);var Ie,Re,Ye=w.readability(Be.color,ce)<1.5?u.contrast(ce):Be.color,Qe=B.spikemode,lt=B.spikethickness,xt=B.spikecolor||Ye,wt=h.getPxPosition(N,B);if(Qe.indexOf("toaxis")!==-1||Qe.indexOf("across")!==-1){if(Qe.indexOf("toaxis")!==-1&&(Ie=wt,Re=Xe),Qe.indexOf("across")!==-1){var bt=B._counterDomainMin,nt=B._counterDomainMax;B.anchor==="free"&&(bt=Math.min(bt,B.position),nt=Math.max(nt,B.position)),Ie=re.t+(1-nt)*re.h,Re=re.t+(1-bt)*re.h}J.insert("line",":first-child").attr({x1:De,x2:De,y1:Ie,y2:Re,"stroke-width":lt,stroke:xt,"stroke-dasharray":g.dashStyle(B.spikedash,lt)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:De,x2:De,y1:Ie,y2:Re,"stroke-width":lt+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Qe.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:De,cy:wt-(B.side!=="top"?lt:-lt),r:lt,fill:xt}).classed("spikeline",!0)}}}function Z(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function Q(N,U){return a.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function K(N,U,te){var B=U[N+"a"],X=U[N+"Val"],J=U.cd[0];if(B.type==="category")X=B._categoriesMap[X];else if(B.type==="date"){var ee=U.trace[N+"periodalignment"];if(ee){var re=U.cd[U.index],se=re[N+"Start"];se===void 0&&(se=re[N]);var oe=re[N+"End"];oe===void 0&&(oe=re[N]);var de=oe-se;ee==="end"?X+=de:ee==="middle"&&(X+=de/2)}X=B.d2c(X)}return J&&J.t&&J.t.posLetter===B._id&&(te.boxmode!=="group"&&te.violinmode!=="group"||(X+=J.t.dPos)),X}function $(N){return N.offsetTop+N.clientTop}function ne(N){return N.offsetLeft+N.clientLeft}function H(N,U){var te=N._fullLayout,B=U.getBoundingClientRect(),X=B.x,J=B.y,ee=X+B.width,re=J+B.height,se=y.apply3DTransform(te._invTransform)(X,J),oe=y.apply3DTransform(te._invTransform)(ee,re),de=se[0],ce=se[1],ve=oe[0],Ae=oe[1];return{x:de,y:ce,width:ve-de,height:Ae-ce,top:Math.min(ce,Ae),left:Math.min(de,ve),right:Math.max(de,ve),bottom:Math.max(ce,Ae)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(m,G,W){var d=m("../../lib"),v=m("../color"),w=m("./helpers").isUnifiedHover;G.exports=function(y,e,t,n){n=n||{};var a=e.legend;function r(g){n.font[g]||(n.font[g]=a?e.legend.font[g]:e.font[g])}e&&w(e.hovermode)&&(n.font||(n.font={}),r("size"),r("family"),r("color"),a?(n.bgcolor||(n.bgcolor=v.combine(e.legend.bgcolor,e.paper_bgcolor)),n.bordercolor||(n.bordercolor=e.legend.bordercolor)):n.bgcolor||(n.bgcolor=e.paper_bgcolor)),t("hoverlabel.bgcolor",n.bgcolor),t("hoverlabel.bordercolor",n.bordercolor),t("hoverlabel.namelength",n.namelength),d.coerceFont(t,"hoverlabel.font",n.font),t("hoverlabel.align",n.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return y[t]!==void 0?y[t]:d.coerce(w,y,v,t,n)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../dragelement"),y=m("./helpers"),e=m("./layout_attributes"),t=m("./hover");G.exports={moduleType:"component",name:"fx",constants:m("./constants"),schema:{layout:e},attributes:m("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:m("./layout_global_defaults"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),getDistanceFunction:y.getDistanceFunction,getClosest:y.getClosest,inbox:y.inbox,quadrature:y.quadrature,appendArrayPointValue:y.appendArrayPointValue,castHoverOption:function(n,a,r){return v.castOption(n,a,"hoverlabel."+r)},castHoverinfo:function(n,a,r){return v.castOption(n,r,"hoverinfo",function(g){return v.coerceHoverinfo({hoverinfo:g},{_module:n._module},a)})},hover:t.hover,unhover:w.unhover,loneHover:t.loneHover,loneUnhover:function(n){var a=v.isD3Selection(n)?n:d.select(n);a.selectAll("g.hovertext").remove(),a.selectAll(".spikeline").remove()},click:m("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(m,G,W){var d=m("./constants"),v=m("../../plots/font_attributes"),w=v({editType:"none"});w.family.dflt=d.HOVERFONT,w.size.dflt=d.HOVERFONTSIZE,G.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:w,grouptitlefont:v({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes"),w=m("./hovermode_defaults"),y=m("./hoverlabel_defaults");G.exports=function(e,t){function n(u,s){return d.coerce(e,t,v,u,s)}w(e,t)&&(n("hoverdistance"),n("spikedistance")),n("dragmode")==="select"&&n("selectdirection");var a=t._has("mapbox"),r=t._has("geo"),g=t._basePlotModules.length;t.dragmode==="zoom"&&((a||r)&&g===1||a&&r&&g===2)&&(t.dragmode="pan"),y(e,t,n),d.coerceFont(n,"hoverlabel.grouptitlefont",t.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(m,G,W){var d=m("../../lib"),v=m("./hoverlabel_defaults"),w=m("./layout_attributes");G.exports=function(y,e){v(y,e,function(t,n){return d.coerce(y,e,w,t,n)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(m,G,W){var d=m("../../lib"),v=m("../../lib/regex").counter,w=m("../../plots/domain").attributes,y=m("../../plots/cartesian/constants").idRegex,e=m("../../plot_api/plot_template"),t={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[v("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:w({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(g,u,s){var h=u[s+"axes"],l=Object.keys((g._splomAxes||{})[s]||{});return Array.isArray(h)?h:l.length?l:void 0}function a(g,u,s,h,l,o){var p=u(g+"gap",s),c=u("domain."+g);u(g+"side",h);for(var i=new Array(l),x=c[0],f=(c[1]-x)/(l-p),_=f*(1-p),b=0;b<l;b++){var T=x+f*b;i[o?l-1-b:b]=[T,T+_]}return i}function r(g,u,s,h,l){var o,p=new Array(s);function c(i,x){u.indexOf(x)!==-1&&h[x]===void 0?(p[i]=x,h[x]=i):p[i]=""}if(Array.isArray(g))for(o=0;o<s;o++)c(o,g[o]);else for(c(0,l),o=1;o<s;o++)c(o,l+(o+1));return p}G.exports={moduleType:"component",name:"grid",schema:{layout:{grid:t}},layoutAttributes:t,sizeDefaults:function(g,u){var s=g.grid||{},h=n(u,s,"x"),l=n(u,s,"y");if(g.grid||h||l){var o,p,c=Array.isArray(s.subplots)&&Array.isArray(s.subplots[0]),i=Array.isArray(h),x=Array.isArray(l),f=i&&h!==s.xaxes&&x&&l!==s.yaxes;c?(o=s.subplots.length,p=s.subplots[0].length):(x&&(o=l.length),i&&(p=h.length));var _=e.newContainer(u,"grid"),b=S("rows",o),T=S("columns",p);if(b*T>1){!c&&!i&&!x&&S("pattern")==="independent"&&(c=!0),_._hasSubplotGrid=c;var k,L,A=S("roworder")==="top to bottom",I=c?.2:.1,P=c?.3:.1;f&&u._splomGridDflt&&(k=u._splomGridDflt.xside,L=u._splomGridDflt.yside),_._domains={x:a("x",S,I,k,T),y:a("y",S,P,L,b,A)}}else delete u.grid}function S(E,z){return d.coerce(s,_,t,E,z)}},contentDefaults:function(g,u){var s=u.grid;if(s&&s._domains){var h,l,o,p,c,i,x,f=g.grid||{},_=u._subplots,b=s._hasSubplotGrid,T=s.rows,k=s.columns,L=s.pattern==="independent",A=s._axisMap={};if(b){var I=f.subplots||[];i=s.subplots=new Array(T);var P=1;for(h=0;h<T;h++){var S=i[h]=new Array(k),E=I[h]||[];for(l=0;l<k;l++)if(L?(c=P===1?"xy":"x"+P+"y"+P,P++):c=E[l],S[l]="",_.cartesian.indexOf(c)!==-1){if(x=c.indexOf("y"),o=c.slice(0,x),p=c.slice(x),A[o]!==void 0&&A[o]!==l||A[p]!==void 0&&A[p]!==h)continue;S[l]=c,A[o]=l,A[p]=h}}}else{var z=n(u,f,"x"),D=n(u,f,"y");s.xaxes=r(z,_.xaxis,k,A,"x"),s.yaxes=r(D,_.yaxis,T,A,"y")}var j=s._anchors={},V=s.roworder==="top to bottom";for(var Z in A){var Q,K,$,ne=Z.charAt(0),H=s[ne+"side"];if(H.length<8)j[Z]="free";else if(ne==="x"){if(H.charAt(0)==="t"===V?(Q=0,K=1,$=T):(Q=T-1,K=-1,$=-1),b){var N=A[Z];for(h=Q;h!==$;h+=K)if((c=i[h][N])&&(x=c.indexOf("y"),c.slice(0,x)===Z)){j[Z]=c.slice(x);break}}else for(h=Q;h!==$;h+=K)if(p=s.yaxes[h],_.cartesian.indexOf(Z+p)!==-1){j[Z]=p;break}}else if(H.charAt(0)==="l"?(Q=0,K=1,$=k):(Q=k-1,K=-1,$=-1),b){var U=A[Z];for(h=Q;h!==$;h+=K)if((c=i[U][h])&&(x=c.indexOf("y"),c.slice(x)===Z)){j[Z]=c.slice(0,x);break}}else for(h=Q;h!==$;h+=K)if(o=s.xaxes[h],_.cartesian.indexOf(o+Z)!==-1){j[Z]=o;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(m,G,W){var d=m("../../plots/cartesian/constants"),v=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=v("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",d.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",d.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib/to_log_range");G.exports=function(w,y,e,t){y=y||{};var n=e==="log"&&y.type==="linear",a=e==="linear"&&y.type==="log";if(n||a){for(var r,g,u=w._fullLayout.images,s=y._id.charAt(0),h=0;h<u.length;h++)if(g="images["+h+"].",(r=u[h])[s+"ref"]===y._id){var l=r[s],o=r["size"+s],p=null,c=null;if(n){p=v(l,y.range);var i=o/Math.pow(10,p)/2;c=2*Math.log(i+Math.sqrt(1+i*i))/Math.LN10}else c=(p=Math.pow(10,l))*(Math.pow(10,o/2)-Math.pow(10,-o/2));d(p)?d(c)||(c=null):(p=null,c=null),t(g+s,p),t(g+"size"+s,c)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes");function e(t,n,a){function r(p,c){return d.coerce(t,n,y,p,c)}var g=r("source");if(!r("visible",!!g))return n;r("layer"),r("xanchor"),r("yanchor"),r("sizex"),r("sizey"),r("sizing"),r("opacity");for(var u={_fullLayout:a},s=["x","y"],h=0;h<2;h++){var l=s[h],o=v.coerceRef(t,n,u,l,"paper",void 0);o!=="paper"&&v.getFromId(u,o)._imgIndices.push(n._index),v.coercePosition(n,u,r,o,l,0)}return n}G.exports=function(t,n){w(t,n,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(m,G,W){var d=m("@plotly/d3"),v=m("../drawing"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/axis_ids"),e=m("../../constants/xmlns_namespaces");G.exports=function(t){var n,a,r=t._fullLayout,g=[],u={},s=[];for(a=0;a<r.images.length;a++){var h=r.images[a];if(h.visible)if(h.layer==="below"&&h.xref!=="paper"&&h.yref!=="paper"){n=y.ref2id(h.xref)+y.ref2id(h.yref);var l=r._plots[n];if(!l){s.push(h);continue}l.mainplot&&(n=l.mainplot.id),u[n]||(u[n]=[]),u[n].push(h)}else h.layer==="above"?g.push(h):s.push(h)}var o={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},p={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function c(k){var L=d.select(this);if(this._imgSrc!==k.source)if(L.attr("xmlns",e.svg),k.source&&k.source.slice(0,5)==="data:")L.attr("xlink:href",k.source),this._imgSrc=k.source;else{var A=new Promise(function(I){var P=new Image;function S(){L.remove(),I()}this.img=P,P.setAttribute("crossOrigin","anonymous"),P.onerror=S,P.onload=function(){var E=document.createElement("canvas");E.width=this.width,E.height=this.height,E.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var z=E.toDataURL("image/png");L.attr("xlink:href",z),I()},L.on("error",S),P.src=k.source,this._imgSrc=k.source}.bind(this));t._promises.push(A)}}function i(k){var L,A,I=d.select(this),P=w.getFromId(t,k.xref),S=w.getFromId(t,k.yref),E=w.getRefType(k.xref)==="domain",z=w.getRefType(k.yref)==="domain",D=r._size;L=P!==void 0?typeof k.xref=="string"&&E?P._length*k.sizex:Math.abs(P.l2p(k.sizex)-P.l2p(0)):k.sizex*D.w,A=S!==void 0?typeof k.yref=="string"&&z?S._length*k.sizey:Math.abs(S.l2p(k.sizey)-S.l2p(0)):k.sizey*D.h;var j,V,Z=L*o[k.xanchor].offset,Q=A*p[k.yanchor].offset,K=o[k.xanchor].sizing+p[k.yanchor].sizing;switch(j=P!==void 0?typeof k.xref=="string"&&E?P._length*k.x+P._offset:P.r2p(k.x)+P._offset:k.x*D.w+D.l,j+=Z,V=S!==void 0?typeof k.yref=="string"&&z?S._length*(1-k.y)+S._offset:S.r2p(k.y)+S._offset:D.h-k.y*D.h+D.t,V+=Q,k.sizing){case"fill":K+=" slice";break;case"stretch":K="none"}I.attr({x:j,y:V,width:L,height:A,preserveAspectRatio:K,opacity:k.opacity});var $=(P&&w.getRefType(k.xref)!=="domain"?P._id:"")+(S&&w.getRefType(k.yref)!=="domain"?S._id:"");v.setClipUrl(I,$?"clip"+r._uid+$:null,t)}var x=r._imageLowerLayer.selectAll("image").data(s),f=r._imageUpperLayer.selectAll("image").data(g);x.enter().append("image"),f.enter().append("image"),x.exit().remove(),f.exit().remove(),x.each(function(k){c.bind(this)(k),i.bind(this)(k)}),f.each(function(k){c.bind(this)(k),i.bind(this)(k)});var _=Object.keys(r._plots);for(a=0;a<_.length;a++){n=_[a];var b=r._plots[n];if(b.imagelayer){var T=b.imagelayer.selectAll("image").data(u[n]||[]);T.enter().append("image"),T.exit().remove(),T.each(function(k){c.bind(this)(k),i.bind(this)(k)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(m,G,W){G.exports={moduleType:"component",name:"images",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("images"),draw:m("./draw"),convertCoords:m("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../color/attributes");G.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:d({editType:"legend"}),grouptitlefont:d({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:d({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(m,G,W){G.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../plot_api/plot_template"),y=m("../../plots/attributes"),e=m("./attributes"),t=m("../../plots/layout_attributes"),n=m("./helpers");G.exports=function(a,r,g){var u,s=a.legend||{},h=w.newContainer(r,"legend");function l(S,E){return v.coerce(s,h,e,S,E)}for(var o=function(S,E){var z=u._input,D=u;return v.coerce(z,D,y,S,E)},p=r.font||{},c=v.coerceFont(l,"grouptitlefont",v.extendFlat({},p,{size:Math.round(1.1*p.size)})),i=0,x=!1,f="normal",_=0;_<g.length;_++)(u=g[_]).visible&&((u.showlegend||u._dfltShowLegend&&!(u._module&&u._module.attributes&&u._module.attributes.showlegend&&u._module.attributes.showlegend.dflt===!1))&&(i++,u.showlegend&&(x=!0,(d.traceIs(u,"pie-like")||u._input.showlegend===!0)&&i++),v.coerceFont(o,"legendgrouptitle.font",c)),(d.traceIs(u,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(u.fill)!==-1)&&(f=n.isGrouped({traceorder:f})?"grouped+reversed":"reversed"),u.legendgroup!==void 0&&u.legendgroup!==""&&(f=n.isReversed({traceorder:f})?"reversed+grouped":"grouped"));var b=v.coerce(a,r,t,"showlegend",x&&i>1);if(b===!1&&(r.legend=void 0),(b!==!1||s.uirevision)&&(l("uirevision",r.uirevision),b!==!1)){l("bgcolor",r.paper_bgcolor),l("bordercolor"),l("borderwidth");var T,k,L,A=v.coerceFont(l,"font",r.font),I=l("orientation")==="h";if(I?(T=0,d.getComponentMethod("rangeslider","isVisible")(a.xaxis)?(k=1.1,L="bottom"):(k=-.1,L="top")):(T=1.02,k=1,L="auto"),l("traceorder",f),n.isGrouped(r.legend)&&l("tracegroupgap"),l("entrywidth"),l("entrywidthmode"),l("itemsizing"),l("itemwidth"),l("itemclick"),l("itemdoubleclick"),l("groupclick"),l("x",T),l("xanchor"),l("y",k),l("yanchor",L),l("valign"),v.noneOrAll(s,h,["x","y"]),l("title.text")){l("title.side",I?"left":"top");var P=v.extendFlat({},A,{size:v.bigFont(A.size)});v.coerceFont(l,"title.font",P)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib/events"),t=m("../dragelement"),n=m("../drawing"),a=m("../color"),r=m("../../lib/svg_text_utils"),g=m("./handle_click"),u=m("./constants"),s=m("../../constants/alignment"),h=s.LINE_SPACING,l=s.FROM_TL,o=s.FROM_BR,p=m("./get_legend_data"),c=m("./style"),i=m("./helpers");function x(I,P,S){var E=I[0],z=E.width,D=P.entrywidthmode,j=E.trace.legendwidth||P.entrywidth;return D==="fraction"?P._maxWidth*j:S+(j||z)}function f(I,P,S,E,z){var D=S.data()[0][0].trace,j={event:z,node:S.node(),curveNumber:D.index,expandedIndex:D._expandedIndex,data:I.data,layout:I.layout,frames:I._transitionData._frames,config:I._context,fullData:I._fullData,fullLayout:I._fullLayout};D._group&&(j.group=D._group),y.traceIs(D,"pie-like")&&(j.label=S.datum()[0].label),e.triggerHandler(I,"plotly_legendclick",j)!==!1&&(E===1?P._clickTimeout=setTimeout(function(){I._fullLayout&&g(S,I,E)},I._context.doubleClickDelay):E===2&&(P._clickTimeout&&clearTimeout(P._clickTimeout),I._legendMouseDownTime=0,e.triggerHandler(I,"plotly_legenddoubleclick",j)!==!1&&g(S,I,E)))}function _(I,P,S){var E,z,D=I.data()[0][0],j=D.trace,V=y.traceIs(j,"pie-like"),Z=!S._inHover&&P._context.edits.legendText&&!V,Q=S._maxNameLength;D.groupTitle?(E=D.groupTitle.text,z=D.groupTitle.font):(z=S.font,S.entries?E=D.text:(E=V?D.label:j.name,j._meta&&(E=v.templateString(E,j._meta))));var K=v.ensureSingle(I,"text","legendtext");K.attr("text-anchor","start").call(n.font,z).text(Z?b(E,Q):E);var $=S.itemwidth+2*u.itemGap;r.positionText(K,$,0),Z?K.call(r.makeEditable,{gd:P,text:E}).call(k,I,P,S).on("edit",function(ne){this.text(b(ne,Q)).call(k,I,P,S);var H=D.trace._fullInput||{},N={};if(y.hasTransform(H,"groupby")){var U=y.getTransformIndices(H,"groupby"),te=U[U.length-1],B=v.keyedContainer(H,"transforms["+te+"].styles","target","value.name");B.set(D.trace._group,ne),N=B.constructUpdate()}else N.name=ne;return y.call("_guiRestyle",P,N,j.index)}):k(K,I,P,S)}function b(I,P){var S=Math.max(4,P);if(I&&I.trim().length>=S/2)return I;for(var E=S-(I=I||"").length;E>0;E--)I+=" ";return I}function T(I,P){var S,E=P._context.doubleClickDelay,z=1,D=v.ensureSingle(I,"rect","legendtoggle",function(j){P._context.staticPlot||j.style("cursor","pointer").attr("pointer-events","all"),j.call(a.fill,"rgba(0,0,0,0)")});P._context.staticPlot||(D.on("mousedown",function(){(S=new Date().getTime())-P._legendMouseDownTime<E?z+=1:(z=1,P._legendMouseDownTime=S)}),D.on("mouseup",function(){if(!P._dragged&&!P._editing){var j=P._fullLayout.legend;new Date().getTime()-P._legendMouseDownTime>E&&(z=Math.max(z-1,1)),f(P,j,I,z,d.event)}}))}function k(I,P,S,E,z){E._inHover&&I.attr("data-notex",!0),r.convertToTspans(I,S,function(){(function(D,j,V,Z){var Q=D.data()[0][0];if(!V._inHover&&Q&&!Q.trace.showlegend)return void D.remove();var K=D.select("g[class*=math-group]"),$=K.node();V||(V=j._fullLayout.legend);var ne,H=V.borderwidth;ne=Z===1?V.title.font:Q.groupTitle?Q.groupTitle.font:V.font;var N,U,te=ne.size*h;if($){var B=n.bBox($);N=B.height,U=B.width,Z===1?n.setTranslate(K,H,H+.75*N):n.setTranslate(K,0,.25*N)}else{var X=D.select(Z===1?".legendtitletext":".legendtext"),J=r.lineCount(X),ee=X.node();if(N=te*J,U=ee?n.bBox(ee).width:0,Z===1)V.title.side==="left"&&(U+=2*u.itemGap),r.positionText(X,H+u.titlePad,H+te);else{var re=2*u.itemGap+V.itemwidth;Q.groupTitle&&(re=u.itemGap,U-=V.itemwidth),r.positionText(X,re,-te*((J-1)/2-.3))}}Z===1?(V._titleWidth=U,V._titleHeight=N):(Q.lineHeight=te,Q.height=Math.max(N,16)+3,Q.width=U)})(P,S,E,z)})}function L(I){return v.isRightAnchor(I)?"right":v.isCenterAnchor(I)?"center":"left"}function A(I){return v.isBottomAnchor(I)?"bottom":v.isMiddleAnchor(I)?"middle":"top"}G.exports=function(I,P){return P||(P=I._fullLayout.legend||{}),function(S,E){var z,D,j=S._fullLayout,V="legend"+j._uid,Z=E._inHover;if(Z?(z=E.layer,V+="-hover"):z=j._infolayer,!!z){if(S._legendMouseDownTime||(S._legendMouseDownTime=0),Z){if(!E.entries)return;D=p(E.entries,E)}else{if(!S.calcdata)return;D=j.showlegend&&p(S.calcdata,E)}var Q=j.hiddenlabels||[];if(!(Z||j.showlegend&&D.length))return z.selectAll(".legend").remove(),j._topdefs.select("#"+V).remove(),w.autoMargin(S,"legend");var K=v.ensureSingle(z,"g","legend",function(J){Z||J.attr("pointer-events","all")}),$=v.ensureSingleById(j._topdefs,"clipPath",V,function(J){J.append("rect")}),ne=v.ensureSingle(K,"rect","bg",function(J){J.attr("shape-rendering","crispEdges")});ne.call(a.stroke,E.bordercolor).call(a.fill,E.bgcolor).style("stroke-width",E.borderwidth+"px");var H=v.ensureSingle(K,"g","scrollbox"),N=E.title;if(E._titleWidth=0,E._titleHeight=0,N.text){var U=v.ensureSingle(H,"text","legendtitletext");U.attr("text-anchor","start").call(n.font,N.font).text(N.text),k(U,H,S,E,1)}else H.selectAll(".legendtitletext").remove();var te=v.ensureSingle(K,"rect","scrollbar",function(J){J.attr(u.scrollBarEnterAttrs).call(a.fill,u.scrollBarColor)}),B=H.selectAll("g.groups").data(D);B.enter().append("g").attr("class","groups"),B.exit().remove();var X=B.selectAll("g.traces").data(v.identity);X.enter().append("g").attr("class","traces"),X.exit().remove(),X.style("opacity",function(J){var ee=J[0].trace;return y.traceIs(ee,"pie-like")?Q.indexOf(J[0].label)!==-1?.5:1:ee.visible==="legendonly"?.5:1}).each(function(){d.select(this).call(_,S,E)}).call(c,S,E).each(function(){Z||d.select(this).call(T,S)}),v.syncOrAsync([w.previousPromises,function(){return function(J,ee,re,se){var oe=J._fullLayout;se||(se=oe.legend);var de=oe._size,ce=i.isVertical(se),ve=i.isGrouped(se),Ae=se.entrywidthmode==="fraction",fe=se.borderwidth,me=2*fe,_e=u.itemGap,le=se.itemwidth+2*_e,ge=2*(fe+_e),Te=A(se),Se=se.y<0||se.y===0&&Te==="top",Me=se.y>1||se.y===1&&Te==="bottom",ze=se.tracegroupgap,Oe={};se._maxHeight=Math.max(Se||Me?oe.height/2:de.h,30);var De=0;se._width=0,se._height=0;var Xe=function(qe){var pe=0,be=0,Fe=qe.title.side;return Fe&&(Fe.indexOf("left")!==-1&&(pe=qe._titleWidth),Fe.indexOf("top")!==-1&&(be=qe._titleHeight)),[pe,be]}(se);if(ce)re.each(function(qe){var pe=qe[0].height;n.setTranslate(this,fe+Xe[0],fe+Xe[1]+se._height+pe/2+_e),se._height+=pe,se._width=Math.max(se._width,qe[0].width)}),De=le+se._width,se._width+=_e+le+me,se._height+=ge,ve&&(ee.each(function(qe,pe){n.setTranslate(this,0,pe*se.tracegroupgap)}),se._height+=(se._lgroupsLength-1)*se.tracegroupgap);else{var Be=L(se),Ie=se.x<0||se.x===0&&Be==="right",Re=se.x>1||se.x===1&&Be==="left",Ye=Me||Se,Qe=oe.width/2;se._maxWidth=Math.max(Ie?Ye&&Be==="left"?de.l+de.w:Qe:Re?Ye&&Be==="right"?de.r+de.w:Qe:de.w,2*le);var lt=0,xt=0;re.each(function(qe){var pe=x(qe,se,le);lt=Math.max(lt,pe),xt+=pe}),De=null;var wt=0;if(ve){var bt=0,nt=0,$e=0;ee.each(function(){var qe=0,pe=0;d.select(this).selectAll("g.traces").each(function(Fe){var Ve=x(Fe,se,le),Ke=Fe[0].height;n.setTranslate(this,Xe[0],Xe[1]+fe+_e+Ke/2+pe),pe+=Ke,qe=Math.max(qe,Ve),Oe[Fe[0].trace.legendgroup]=qe});var be=qe+_e;nt>0&&be+fe+nt>se._maxWidth?(wt=Math.max(wt,nt),nt=0,$e+=bt+ze,bt=pe):bt=Math.max(bt,pe),n.setTranslate(this,nt,$e),nt+=be}),se._width=Math.max(wt,nt)+fe,se._height=$e+bt+ge}else{var vt=re.size(),Nt=xt+me+(vt-1)*_e<se._maxWidth,qt=0,Jt=0,Wt=0,ar=0;re.each(function(qe){var pe=qe[0].height,be=x(qe,se,le),Fe=Nt?be:lt;Ae||(Fe+=_e),Fe+fe+Jt-_e>=se._maxWidth&&(wt=Math.max(wt,ar),Jt=0,Wt+=qt,se._height+=qt,qt=0),n.setTranslate(this,Xe[0]+fe+Jt,Xe[1]+fe+Wt+pe/2+_e),ar=Jt+be+_e,Jt+=Fe,qt=Math.max(qt,pe)}),Nt?(se._width=Jt+me,se._height=qt+ge):(se._width=Math.max(wt,ar)+me,se._height+=qt+ge)}}se._width=Math.ceil(Math.max(se._width+Xe[0],se._titleWidth+2*(fe+u.titlePad))),se._height=Math.ceil(Math.max(se._height+Xe[1],se._titleHeight+2*(fe+u.itemGap))),se._effHeight=Math.min(se._height,se._maxHeight);var Dt=J._context.edits,Ne=Dt.legendText||Dt.legendPosition;re.each(function(qe){var pe=d.select(this).select(".legendtoggle"),be=qe[0].height,Fe=qe[0].trace.legendgroup,Ve=x(qe,se,le);ve&&Fe!==""&&(Ve=Oe[Fe]);var Ke=Ne?le:De||Ve;ce||Ae||(Ke+=_e/2),n.setRect(pe,0,-be/2,Ke,be)})}(S,B,X,E)},function(){var J,ee,re,se,oe=j._size,de=E.borderwidth;if(!Z){if(function(Ie){var Re=Ie._fullLayout.legend,Ye=L(Re),Qe=A(Re);return w.autoMargin(Ie,"legend",{x:Re.x,y:Re.y,l:Re._width*l[Ye],r:Re._width*o[Ye],b:Re._effHeight*o[Qe],t:Re._effHeight*l[Qe]})}(S))return;var ce=oe.l+oe.w*E.x-l[L(E)]*E._width,ve=oe.t+oe.h*(1-E.y)-l[A(E)]*E._effHeight;if(j.margin.autoexpand){var Ae=ce,fe=ve;ce=v.constrain(ce,0,j.width-E._width),ve=v.constrain(ve,0,j.height-E._effHeight),ce!==Ae&&v.log("Constrain legend.x to make legend fit inside graph"),ve!==fe&&v.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(K,ce,ve)}if(te.on(".drag",null),K.on("wheel",null),Z||E._height<=E._maxHeight||S._context.staticPlot){var me=E._effHeight;Z&&(me=E._height),ne.attr({width:E._width-de,height:me-de,x:de/2,y:de/2}),n.setTranslate(H,0,0),$.select("rect").attr({width:E._width-2*de,height:me-2*de,x:de,y:de}),n.setClipUrl(H,V,S),n.setRect(te,0,0,0,0),delete E._scrollY}else{var _e,le,ge,Te=Math.max(u.scrollBarMinHeight,E._effHeight*E._effHeight/E._height),Se=E._effHeight-Te-2*u.scrollBarMargin,Me=E._height-E._effHeight,ze=Se/Me,Oe=Math.min(E._scrollY||0,Me);ne.attr({width:E._width-2*de+u.scrollBarWidth+u.scrollBarMargin,height:E._effHeight-de,x:de/2,y:de/2}),$.select("rect").attr({width:E._width-2*de+u.scrollBarWidth+u.scrollBarMargin,height:E._effHeight-2*de,x:de,y:de+Oe}),n.setClipUrl(H,V,S),Be(Oe,Te,ze),K.on("wheel",function(){Be(Oe=v.constrain(E._scrollY+d.event.deltaY/Se*Me,0,Me),Te,ze),Oe!==0&&Oe!==Me&&d.event.preventDefault()});var De=d.behavior.drag().on("dragstart",function(){var Ie=d.event.sourceEvent;_e=Ie.type==="touchstart"?Ie.changedTouches[0].clientY:Ie.clientY,ge=Oe}).on("drag",function(){var Ie=d.event.sourceEvent;Ie.buttons===2||Ie.ctrlKey||(le=Ie.type==="touchmove"?Ie.changedTouches[0].clientY:Ie.clientY,Be(Oe=function(Re,Ye,Qe){var lt=(Qe-Ye)/ze+Re;return v.constrain(lt,0,Me)}(ge,_e,le),Te,ze))});te.call(De);var Xe=d.behavior.drag().on("dragstart",function(){var Ie=d.event.sourceEvent;Ie.type==="touchstart"&&(_e=Ie.changedTouches[0].clientY,ge=Oe)}).on("drag",function(){var Ie=d.event.sourceEvent;Ie.type==="touchmove"&&(le=Ie.changedTouches[0].clientY,Be(Oe=function(Re,Ye,Qe){var lt=(Ye-Qe)/ze+Re;return v.constrain(lt,0,Me)}(ge,_e,le),Te,ze))});H.call(Xe)}function Be(Ie,Re,Ye){E._scrollY=S._fullLayout.legend._scrollY=Ie,n.setTranslate(H,0,-Ie),n.setRect(te,E._width,u.scrollBarMargin+Ie*Ye,u.scrollBarWidth,Re),$.select("rect").attr("y",de+Ie)}S._context.edits.legendPosition&&(K.classed("cursor-move",!0),t.init({element:K.node(),gd:S,prepFn:function(){var Ie=n.getTranslate(K);re=Ie.x,se=Ie.y},moveFn:function(Ie,Re){var Ye=re+Ie,Qe=se+Re;n.setTranslate(K,Ye,Qe),J=t.align(Ye,0,oe.l,oe.l+oe.w,E.xanchor),ee=t.align(Qe,0,oe.t+oe.h,oe.t,E.yanchor)},doneFn:function(){J!==void 0&&ee!==void 0&&y.call("_guiRelayout",S,{"legend.x":J,"legend.y":ee})},clickFn:function(Ie,Re){var Ye=z.selectAll("g.traces").filter(function(){var Qe=this.getBoundingClientRect();return Re.clientX>=Qe.left&&Re.clientX<=Qe.right&&Re.clientY>=Qe.top&&Re.clientY<=Qe.bottom});Ye.size()>0&&f(S,K,Ye,Ie,Re)}}))}],S)}}(I,P)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(m,G,W){var d=m("../../registry"),v=m("./helpers");G.exports=function(w,y){var e,t,n=y._inHover,a=v.isGrouped(y),r=v.isReversed(y),g={},u=[],s=!1,h={},l=0,o=0;function p(D,j){if(D!==""&&v.isGrouped(y))u.indexOf(D)===-1?(u.push(D),s=!0,g[D]=[j]):g[D].push(j);else{var V="~~i"+l;u.push(V),g[V]=[j],l++}}for(e=0;e<w.length;e++){var c=w[e],i=c[0],x=i.trace,f=x.legendgroup;if(n||x.visible&&x.showlegend)if(d.traceIs(x,"pie-like"))for(h[f]||(h[f]={}),t=0;t<c.length;t++){var _=c[t].label;h[f][_]||(p(f,{label:_,color:c[t].color,i:c[t].i,trace:x,pts:c[t].pts}),h[f][_]=!0,o=Math.max(o,(_||"").length))}else p(f,i),o=Math.max(o,(x.name||"").length)}if(!u.length)return[];var b=!s||!a,T=[];for(e=0;e<u.length;e++){var k=g[u[e]];b?T.push(k[0]):T.push(k)}for(b&&(T=[T]),e=0;e<T.length;e++){var L=1/0;for(t=0;t<T[e].length;t++){var A=T[e][t].trace.legendrank;L>A&&(L=A)}T[e][0]._groupMinRank=L,T[e][0]._preGroupSort=e}var I=function(D,j){return D.trace.legendrank-j.trace.legendrank||D._preSort-j._preSort};for(T.forEach(function(D,j){D[0]._preGroupSort=j}),T.sort(function(D,j){return D[0]._groupMinRank-j[0]._groupMinRank||D[0]._preGroupSort-j[0]._preGroupSort}),e=0;e<T.length;e++){T[e].forEach(function(D,j){D._preSort=j}),T[e].sort(I);var P=T[e][0].trace,S=null;for(t=0;t<T[e].length;t++){var E=T[e][t].trace.legendgrouptitle;if(E&&E.text){S=E,n&&(E.font=y._groupTitleFont);break}}if(r&&T[e].reverse(),S){var z=!1;for(t=0;t<T[e].length;t++)if(d.traceIs(T[e][t].trace,"pie-like")){z=!0;break}T[e].unshift({i:-1,groupTitle:S,noClick:z,trace:{showlegend:P.showlegend,legendgroup:P.legendgroup,visible:y.groupclick==="toggleitem"||P.visible}})}for(t=0;t<T[e].length;t++)T[e][t]=[T[e][t]]}return y._lgroupsLength=T.length,y._maxNameLength=o,T}},{"../../registry":647,"./helpers":423}],422:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=!0;G.exports=function(y,e,t){var n=e._fullLayout;if(!e._dragged&&!e._editing){var a,r=n.legend.itemclick,g=n.legend.itemdoubleclick,u=n.legend.groupclick;if(t===1&&r==="toggle"&&g==="toggleothers"&&w&&e.data&&e._context.showTips&&d.notifier(d._(e,"Double-click on legend to isolate one trace"),"long"),w=!1,t===1?a=r:t===2&&(a=g),a){var s=u==="togglegroup",h=n.hiddenlabels?n.hiddenlabels.slice():[],l=y.data()[0][0];if(!l.groupTitle||!l.noClick){var o,p,c,i,x,f=e._fullData,_=l.trace,b=_.legendgroup,T={},k=[],L=[],A=[];if(v.traceIs(_,"pie-like")){var I=l.label,P=h.indexOf(I);a==="toggle"?P===-1?h.push(I):h.splice(P,1):a==="toggleothers"&&(h=[],e.calcdata[0].forEach(function(U){I!==U.label&&h.push(U.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===h.length&&P===-1&&(h=[])),v.call("_guiRelayout",e,"hiddenlabels",h)}else{var S,E=b&&b.length,z=[];if(E)for(o=0;o<f.length;o++)(S=f[o]).visible&&S.legendgroup===b&&z.push(o);if(a==="toggle"){var D;switch(_.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0}if(E)if(s)for(o=0;o<f.length;o++)f[o].visible!==!1&&f[o].legendgroup===b&&N(f[o],D);else N(_,D);else N(_,D)}else if(a==="toggleothers"){var j,V,Z,Q,K=!0;for(o=0;o<f.length;o++)if(j=f[o]===_,Z=f[o].showlegend!==!0,!(j||Z||(V=E&&f[o].legendgroup===b)||f[o].visible!==!0||v.traceIs(f[o],"notLegendIsolatable"))){K=!1;break}for(o=0;o<f.length;o++)if(f[o].visible!==!1&&!v.traceIs(f[o],"notLegendIsolatable"))switch(_.visible){case"legendonly":N(f[o],!0);break;case!0:Q=!!K||"legendonly",j=f[o]===_,Z=f[o].showlegend!==!0&&!f[o].legendgroup,V=j||E&&f[o].legendgroup===b,N(f[o],!(!V&&!Z)||Q)}}for(o=0;o<L.length;o++)if(c=L[o]){var $=c.constructUpdate(),ne=Object.keys($);for(p=0;p<ne.length;p++)i=ne[p],(T[i]=T[i]||[])[A[o]]=$[i]}for(x=Object.keys(T),o=0;o<x.length;o++)for(i=x[o],p=0;p<k.length;p++)T[i].hasOwnProperty(p)||(T[i][p]=void 0);v.call("_guiRestyle",e,T,k)}}}}function H(U,te,B){var X=k.indexOf(U),J=T[te];return J||(J=T[te]=[]),k.indexOf(U)===-1&&(k.push(U),X=k.length-1),J[X]=B,X}function N(U,te){if(!l.groupTitle||s){var B=U._fullInput;if(v.hasTransform(B,"groupby")){var X=L[B.index];if(!X){var J=v.getTransformIndices(B,"groupby"),ee=J[J.length-1];X=d.keyedContainer(B,"transforms["+ee+"].styles","target","value.visible"),L[B.index]=X}var re=X.get(U._group);re===void 0&&(re=!0),re!==!1&&X.set(U._group,te),A[B.index]=H(B.index,"visible",B.visible!==!1)}else{var se=B.visible!==!1&&te;H(B.index,"visible",se)}}}}},{"../../lib":515,"../../registry":647}],423:[function(m,G,W){W.isGrouped=function(d){return(d.traceorder||"").indexOf("grouped")!==-1},W.isVertical=function(d){return d.orientation!=="h"},W.isReversed=function(d){return(d.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(m,G,W){G.exports={moduleType:"component",name:"legend",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),draw:m("./draw"),style:m("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=w.strTranslate,e=m("../drawing"),t=m("../color"),n=m("../colorscale/helpers").extractOpts,a=m("../../traces/scatter/subtypes"),r=m("../../traces/pie/style_one"),g=m("../../traces/pie/helpers").castOption,u=m("./constants");function s(o,p){return(p?"radial":"horizontal")+(o?"":"reversed")}function h(o){var p=o[0].trace,c=p.contours,i=a.hasLines(p),x=a.hasMarkers(p),f=p.visible&&p.fill&&p.fill!=="none",_=!1,b=!1;if(c){var T=c.coloring;T==="lines"?_=!0:i=T==="none"||T==="heatmap"||c.showlines,c.type==="constraint"?f=c._operation!=="=":T!=="fill"&&T!=="heatmap"||(b=!0)}return{showMarker:x,showLine:i,showFill:f,showGradientLine:_,showGradientFill:b,anyLine:i||_,anyFill:f||b}}function l(o,p,c){return o&&w.isArrayOrTypedArray(o)?p:o>c?c:o}G.exports=function(o,p,c){var i=p._fullLayout;c||(c=i.legend);var x=c.itemsizing==="constant",f=c.itemwidth,_=(f+2*u.itemGap)/2,b=y(_,0),T=function(A,I,P,S){var E;if(A+1)E=A;else{if(!(I&&I.width>0))return 0;E=I.width}return x?S:Math.min(E,P)};function k(A,I,P){var S=A[0].trace,E=S.marker||{},z=E.line||{},D=P?S.visible&&S.type===P:v.traceIs(S,"bar"),j=d.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(D?[A]:[]);j.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),j.exit().remove(),j.each(function(V){var Z=d.select(this),Q=V[0],K=T(Q.mlw,E.line,5,2);Z.style("stroke-width",K+"px");var $=Q.mcc;if(!c._inHover&&"mc"in Q){var ne=n(E),H=ne.mid;H===void 0&&(H=(ne.max+ne.min)/2),$=e.tryColorscale(E,"")(H)}var N=$||Q.mc||E.color,U=E.pattern,te=U&&e.getPatternAttr(U.shape,0,"");if(te){var B=e.getPatternAttr(U.bgcolor,0,null),X=e.getPatternAttr(U.fgcolor,0,null),J=U.fgopacity,ee=l(U.size,8,10),re=l(U.solidity,.5,1),se="legend-"+S.uid;Z.call(e.pattern,"legend",p,se,te,ee,re,$,U.fillmode,B,X,J)}else Z.call(t.fill,N);K&&t.stroke(Z,Q.mlc||z.color)})}function L(A,I,P){var S=A[0],E=S.trace,z=P?E.visible&&E.type===P:v.traceIs(E,P),D=d.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(z?[A]:[]);if(D.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),D.exit().remove(),D.size()){var j=(E.marker||{}).line,V=T(g(j.width,S.pts),j,5,2),Z=w.minExtend(E,{marker:{line:{width:V}}});Z.marker.line.color=j.color;var Q=w.minExtend(S,{trace:Z});r(D,Q,Z)}}o.each(function(A){var I=d.select(this),P=w.ensureSingle(I,"g","layers");P.style("opacity",A[0].trace.opacity);var S=c.valign,E=A[0].lineHeight,z=A[0].height;if(S!=="middle"&&E&&z){var D={top:1,bottom:-1}[S]*(.5*(E-z+3));P.attr("transform",y(0,D))}else P.attr("transform",null);P.selectAll("g.legendfill").data([A]).enter().append("g").classed("legendfill",!0),P.selectAll("g.legendlines").data([A]).enter().append("g").classed("legendlines",!0);var j=P.selectAll("g.legendsymbols").data([A]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([A]).enter().append("g").classed("legendpoints",!0)}).each(function(A){var I,P=A[0].trace,S=[];if(P.visible)switch(P.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],I=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],I=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],I="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],I=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],I=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],I=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],I=!1}var E=d.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);E.enter().append("path").classed("legend3dandfriends",!0).attr("transform",b).style("stroke-miterlimit",1),E.exit().remove(),E.each(function(z,D){var j,V=d.select(this),Z=n(P),Q=Z.colorscale,K=Z.reversescale;if(Q){if(!I){var $=Q.length;j=D===0?Q[K?$-1:0][1]:D===1?Q[K?0:$-1][1]:Q[Math.floor(($-1)/2)][1]}}else{var ne=P.vertexcolor||P.facecolor||P.color;j=w.isArrayOrTypedArray(ne)?ne[D]||ne[0]:ne}V.attr("d",z[0]),j?V.call(t.fill,j):V.call(function(H){if(H.size()){var N="legendfill-"+P.uid;e.gradient(H,p,N,s(K,I==="radial"),Q,"fill")}})})}).each(function(A){var I=A[0].trace,P=I.type==="waterfall";if(A[0]._distinct&&P){var S=A[0].trace[A[0].dir].marker;return A[0].mc=S.color,A[0].mlw=S.line.width,A[0].mlc=S.line.color,k(A,this,"waterfall")}var E=[];I.visible&&P&&(E=A[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var z=d.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(E);z.enter().append("path").classed("legendwaterfall",!0).attr("transform",b).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(D){var j=d.select(this),V=I[D[0]].marker,Z=T(void 0,V.line,5,2);j.attr("d",D[1]).style("stroke-width",Z+"px").call(t.fill,V.color),Z&&j.call(t.stroke,V.line.color)})}).each(function(A){k(A,this,"funnel")}).each(function(A){k(A,this)}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendbox").data(I.visible&&v.traceIs(I,"box-violin")?[A]:[]);P.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),P.exit().remove(),P.each(function(){var S=d.select(this);if(I.boxpoints!=="all"&&I.points!=="all"||t.opacity(I.fillcolor)!==0||t.opacity((I.line||{}).color)!==0){var E=T(void 0,I.line,5,2);S.style("stroke-width",E+"px").call(t.fill,I.fillcolor),E&&t.stroke(S,I.line.color)}else{var z=w.minExtend(I,{marker:{size:x?12:w.constrain(I.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});P.call(e.pointStyle,z,p)}})}).each(function(A){L(A,this,"funnelarea")}).each(function(A){L(A,this,"pie")}).each(function(A){var I,P,S=h(A),E=S.showFill,z=S.showLine,D=S.showGradientLine,j=S.showGradientFill,V=S.anyFill,Z=S.anyLine,Q=A[0],K=Q.trace,$=n(K),ne=$.colorscale,H=$.reversescale,N=a.hasMarkers(K)||!V?"M5,0":Z?"M5,-2":"M5,-3",U=d.select(this),te=U.select(".legendfill").selectAll("path").data(E||j?[A]:[]);if(te.enter().append("path").classed("js-fill",!0),te.exit().remove(),te.attr("d",N+"h"+f+"v6h-"+f+"z").call(function(J){if(J.size())if(E)e.fillGroupStyle(J,p);else{var ee="legendfill-"+K.uid;e.gradient(J,p,ee,s(H),ne,"fill")}}),z||D){var B=T(void 0,K.line,10,5);P=w.minExtend(K,{line:{width:B}}),I=[w.minExtend(Q,{trace:P})]}var X=U.select(".legendlines").selectAll("path").data(z||D?[I]:[]);X.enter().append("path").classed("js-line",!0),X.exit().remove(),X.attr("d",N+(D?"l"+f+",0.0001":"h"+f)).call(z?e.lineGroupStyle:function(J){if(J.size()){var ee="legendline-"+K.uid;e.lineGroupStyle(J),e.gradient(J,p,ee,s(H),ne,"stroke")}})}).each(function(A){var I,P,S=h(A),E=S.anyFill,z=S.anyLine,D=S.showLine,j=S.showMarker,V=A[0],Z=V.trace,Q=!j&&!z&&!E&&a.hasText(Z);function K(X,J,ee,re){var se=w.nestedProperty(Z,X).get(),oe=w.isArrayOrTypedArray(se)&&J?J(se):se;if(x&&oe&&re!==void 0&&(oe=re),ee){if(oe<ee[0])return ee[0];if(oe>ee[1])return ee[1]}return oe}function $(X){return V._distinct&&V.index&&X[V.index]?X[V.index]:X[0]}if(j||Q||D){var ne={},H={};if(j){ne.mc=K("marker.color",$),ne.mx=K("marker.symbol",$),ne.mo=K("marker.opacity",w.mean,[.2,1]),ne.mlc=K("marker.line.color",$),ne.mlw=K("marker.line.width",w.mean,[0,5],2),H.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var N=K("marker.size",w.mean,[2,16],12);ne.ms=N,H.marker.size=N}D&&(H.line={width:K("line.width",$,[0,10],5)}),Q&&(ne.tx="Aa",ne.tp=K("textposition",$),ne.ts=10,ne.tc=K("textfont.color",$),ne.tf=K("textfont.family",$)),I=[w.minExtend(V,ne)],(P=w.minExtend(Z,H)).selectedpoints=null,P.texttemplate=null}var U=d.select(this).select("g.legendpoints"),te=U.selectAll("path.scatterpts").data(j?I:[]);te.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",b),te.exit().remove(),te.call(e.pointStyle,P,p),j&&(I[0].mrc=3);var B=U.selectAll("g.pointtext").data(Q?I:[]);B.enter().append("g").classed("pointtext",!0).append("text").attr("transform",b),B.exit().remove(),B.selectAll("text").call(e.textPointStyle,P,p)}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(I.visible&&I.type==="candlestick"?[A,A]:[]);P.enter().append("path").classed("legendcandle",!0).attr("d",function(S,E){return E?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=d.select(this),D=I[E?"increasing":"decreasing"],j=T(void 0,D.line,5,2);z.style("stroke-width",j+"px").call(t.fill,D.fillcolor),j&&t.stroke(z,D.line.color)})}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(I.visible&&I.type==="ohlc"?[A,A]:[]);P.enter().append("path").classed("legendohlc",!0).attr("d",function(S,E){return E?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=d.select(this),D=I[E?"increasing":"decreasing"],j=T(void 0,D.line,5,2);z.style("fill","none").call(e.dashLine,D.line.dash,j),j&&t.stroke(z,D.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(m,G,W){m("./constants"),G.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(m,G,W){var d=m("../../registry"),v=m("../../plots/plots"),w=m("../../plots/cartesian/axis_ids"),y=m("../../fonts/ploticon"),e=m("../shapes/draw").eraseActiveShape,t=m("../../lib"),n=t._,a=G.exports={};function r(i,x){var f,_,b=x.currentTarget,T=b.getAttribute("data-attr"),k=b.getAttribute("data-val")||!0,L=i._fullLayout,A={},I=w.list(i,null,!0),P=L._cartesianSpikesEnabled;if(T==="zoom"){var S,E=k==="in"?.5:2,z=(1+E)/2,D=(1-E)/2;for(_=0;_<I.length;_++)if(!(f=I[_]).fixedrange)if(S=f._name,k==="auto")A[S+".autorange"]=!0;else if(k==="reset"){if(f._rangeInitial===void 0)A[S+".autorange"]=!0;else{var j=f._rangeInitial.slice();A[S+".range[0]"]=j[0],A[S+".range[1]"]=j[1]}f._showSpikeInitial!==void 0&&(A[S+".showspikes"]=f._showSpikeInitial,P!=="on"||f._showSpikeInitial||(P="off"))}else{var V=[f.r2l(f.range[0]),f.r2l(f.range[1])],Z=[z*V[0]+D*V[1],z*V[1]+D*V[0]];A[S+".range[0]"]=f.l2r(Z[0]),A[S+".range[1]"]=f.l2r(Z[1])}}else T!=="hovermode"||k!=="x"&&k!=="y"||(k=L._isHoriz?"y":"x",b.setAttribute("data-val",k)),A[T]=k;L._cartesianSpikesEnabled=P,d.call("_guiRelayout",i,A)}function g(i,x){for(var f=x.currentTarget,_=f.getAttribute("data-attr"),b=f.getAttribute("data-val")||!0,T=i._fullLayout._subplots.gl3d||[],k={},L=_.split("."),A=0;A<T.length;A++)k[T[A]+"."+L[1]]=b;var I=b==="pan"?b:"zoom";k.dragmode=I,d.call("_guiRelayout",i,k)}function u(i,x){for(var f=x.currentTarget.getAttribute("data-attr"),_=f==="resetLastSave",b=f==="resetDefault",T=i._fullLayout,k=T._subplots.gl3d||[],L={},A=0;A<k.length;A++){var I,P=k[A],S=P+".camera",E=P+".aspectratio",z=P+".aspectmode",D=T[P]._scene;_?(L[S+".up"]=D.viewInitial.up,L[S+".eye"]=D.viewInitial.eye,L[S+".center"]=D.viewInitial.center,I=!0):b&&(L[S+".up"]=null,L[S+".eye"]=null,L[S+".center"]=null,I=!0),I&&(L[E+".x"]=D.viewInitial.aspectratio.x,L[E+".y"]=D.viewInitial.aspectratio.y,L[E+".z"]=D.viewInitial.aspectratio.z,L[z]=D.viewInitial.aspectmode)}d.call("_guiRelayout",i,L)}function s(i,x){var f=x.currentTarget,_=f._previousVal,b=i._fullLayout,T=b._subplots.gl3d||[],k=["xaxis","yaxis","zaxis"],L={},A={};if(_)A=_,f._previousVal=null;else{for(var I=0;I<T.length;I++){var P=T[I],S=b[P],E=P+".hovermode";L[E]=S.hovermode,A[E]=!1;for(var z=0;z<3;z++){var D=k[z],j=P+"."+D+".showspikes";A[j]=!1,L[j]=S[D].showspikes}}f._previousVal=L}return A}function h(i,x){for(var f=x.currentTarget,_=f.getAttribute("data-attr"),b=f.getAttribute("data-val")||!0,T=i._fullLayout,k=T._subplots.geo||[],L=0;L<k.length;L++){var A=k[L],I=T[A];if(_==="zoom"){var P=I.projection.scale,S=b==="in"?2*P:.5*P;d.call("_guiRelayout",i,A+".projection.scale",S)}}_==="reset"&&c(i,"geo")}function l(i){var x=i._fullLayout;return!x.hovermode&&(x._has("cartesian")?x._isHoriz?"y":"x":"closest")}function o(i){var x=l(i);d.call("_guiRelayout",i,"hovermode",x)}function p(i,x){for(var f=x.currentTarget.getAttribute("data-val"),_=i._fullLayout,b=_._subplots.mapbox||[],T={},k=0;k<b.length;k++){var L=b[k],A=_[L].zoom,I=f==="in"?1.05*A:A/1.05;T[L+".zoom"]=I}d.call("_guiRelayout",i,T)}function c(i,x){for(var f=i._fullLayout,_=f._subplots[x]||[],b={},T=0;T<_.length;T++)for(var k=_[T],L=f[k]._subplot.viewInitial,A=Object.keys(L),I=0;I<A.length;I++){var P=A[I];b[k+"."+P]=L[P]}d.call("_guiRelayout",i,b)}a.toImage={name:"toImage",title:function(i){var x=(i._context.toImageButtonOptions||{}).format||"png";return n(i,x==="png"?"Download plot as a png":"Download plot")},icon:y.camera,click:function(i){var x=i._context.toImageButtonOptions,f={format:x.format||"png"};t.notifier(n(i,"Taking snapshot - this may take a few seconds"),"long"),f.format!=="svg"&&t.isIE()&&(t.notifier(n(i,"IE only supports svg.  Changing format to svg."),"long"),f.format="svg"),["filename","width","height","scale"].forEach(function(_){_ in x&&(f[_]=x[_])}),d.call("downloadImage",i,f).then(function(_){t.notifier(n(i,"Snapshot succeeded")+" - "+_,"long")}).catch(function(){t.notifier(n(i,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(i){return n(i,"Edit in Chart Studio")},icon:y.disk,click:function(i){v.sendDataToCloud(i)}},a.editInChartStudio={name:"editInChartStudio",title:function(i){return n(i,"Edit in Chart Studio")},icon:y.pencil,click:function(i){v.sendDataToCloud(i)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"dragmode",val:"zoom",icon:y.zoombox,click:r},a.pan2d={name:"pan2d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"dragmode",val:"pan",icon:y.pan,click:r},a.select2d={name:"select2d",_cat:"select",title:function(i){return n(i,"Box Select")},attr:"dragmode",val:"select",icon:y.selectbox,click:r},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(i){return n(i,"Lasso Select")},attr:"dragmode",val:"lasso",icon:y.lasso,click:r},a.drawclosedpath={name:"drawclosedpath",title:function(i){return n(i,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:y.drawclosedpath,click:r},a.drawopenpath={name:"drawopenpath",title:function(i){return n(i,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:y.drawopenpath,click:r},a.drawline={name:"drawline",title:function(i){return n(i,"Draw line")},attr:"dragmode",val:"drawline",icon:y.drawline,click:r},a.drawrect={name:"drawrect",title:function(i){return n(i,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:y.drawrect,click:r},a.drawcircle={name:"drawcircle",title:function(i){return n(i,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:y.drawcircle,click:r},a.eraseshape={name:"eraseshape",title:function(i){return n(i,"Erase active shape")},icon:y.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:r},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:r},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(i){return n(i,"Autoscale")},attr:"zoom",val:"auto",icon:y.autoscale,click:r},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(i){return n(i,"Reset axes")},attr:"zoom",val:"reset",icon:y.home,click:r},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(i){return n(i,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:r},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(i){return n(i,"Compare data on hover")},attr:"hovermode",val:function(i){return i._fullLayout._isHoriz?"y":"x"},icon:y.tooltip_compare,gravity:"ne",click:r},a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:y.zoombox,click:g},a.pan3d={name:"pan3d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"scene.dragmode",val:"pan",icon:y.pan,click:g},a.orbitRotation={name:"orbitRotation",title:function(i){return n(i,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:y["3d_rotate"],click:g},a.tableRotation={name:"tableRotation",title:function(i){return n(i,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:y["z-axis"],click:g},a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(i){return n(i,"Reset camera to default")},attr:"resetDefault",icon:y.home,click:u},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(i){return n(i,"Reset camera to last save")},attr:"resetLastSave",icon:y.movie,click:u},a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(i,x){var f=s(i,x);d.call("_guiRelayout",i,f)}},a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:h},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:h},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(i){return n(i,"Reset")},attr:"reset",val:null,icon:y.autoscale,click:h},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:o},a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:o},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:o},a.resetViewSankey={name:"resetSankeyGroup",title:function(i){return n(i,"Reset view")},icon:y.home,click:function(i){for(var x={"node.groups":[],"node.x":[],"node.y":[]},f=0;f<i._fullData.length;f++){var _=i._fullData[f]._viewInitial;x["node.groups"].push(_.node.groups.slice()),x["node.x"].push(_.node.x.slice()),x["node.y"].push(_.node.y.slice())}d.call("restyle",i,x)}},a.toggleHover={name:"toggleHover",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(i,x){var f=s(i,x);f.hovermode=l(i),d.call("_guiRelayout",i,f)}},a.resetViews={name:"resetViews",title:function(i){return n(i,"Reset views")},icon:y.home,click:function(i,x){var f=x.currentTarget;f.setAttribute("data-attr","zoom"),f.setAttribute("data-val","reset"),r(i,x),f.setAttribute("data-attr","resetLastSave"),u(i,x),c(i,"geo"),c(i,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(i){return n(i,"Toggle Spike Lines")},icon:y.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(i){var x=i._fullLayout,f=x._cartesianSpikesEnabled;x._cartesianSpikesEnabled=f==="on"?"off":"on",d.call("_guiRelayout",i,function(_){for(var b=_._fullLayout._cartesianSpikesEnabled==="on",T=w.list(_,null,!0),k={},L=0;L<T.length;L++){var A=T[L];k[A._name+".showspikes"]=!!b||A._showSpikeInitial}return k}(i))}},a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(i){return n(i,"Reset view")},attr:"reset",icon:y.home,click:function(i){c(i,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:p},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:p}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(m,G,W){var d=m("./buttons"),v=Object.keys(d),w=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],y=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(w),e=[];v.forEach(function(t){(function(n){if(y.indexOf(n._cat||n.name)===-1){var a=n.name,r=(n._cat||n.name).toLowerCase();e.indexOf(a)===-1&&e.push(a),e.indexOf(r)===-1&&e.push(r)}})(d[t])}),e.sort(),G.exports={DRAW_MODES:w,backButtons:y,foreButtons:e}},{"./buttons":427}],429:[function(m,G,W){var d=m("../../lib"),v=m("../color"),w=m("../../plot_api/plot_template"),y=m("./attributes");G.exports=function(e,t){var n=e.modebar||{},a=w.newContainer(t,"modebar");function r(u,s){return d.coerce(n,a,y,u,s)}r("orientation"),r("bgcolor",v.addOpacity(t.paper_bgcolor,.5));var g=v.contrast(v.rgb(t.modebar.bgcolor));r("color",v.addOpacity(g,.3)),r("activecolor",v.addOpacity(g,.7)),r("uirevision",t.uirevision),r("add"),r("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(m,G,W){G.exports={moduleType:"component",name:"modebar",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),manage:m("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(m,G,W){var d=m("../../plots/cartesian/axis_ids"),v=m("../../traces/scatter/subtypes"),w=m("../../registry"),y=m("../fx/helpers").isUnifiedHover,e=m("./modebar"),t=m("./buttons"),n=m("./constants").DRAW_MODES,a=m("../../lib").extendDeep;G.exports=function(r){var g=r._fullLayout,u=r._context,s=g._modeBar;if(u.displayModeBar||u.watermark){if(!Array.isArray(u.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(u.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var h,l=u.modeBarButtons;h=Array.isArray(l)&&l.length?function(o){for(var p=a([],o),c=0;c<p.length;c++)for(var i=p[c],x=0;x<i.length;x++){var f=i[x];if(typeof f=="string"){if(t[f]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));p[c][x]=t[f]}}return p}(l):!u.displayModeBar&&u.watermark?[]:function(o){var p=o._fullLayout,c=o._fullData,i=o._context;function x(se,oe){if(typeof oe=="string"){if(oe.toLowerCase()===se.toLowerCase())return!0}else{var de=oe.name,ce=oe._cat||oe.name;if(de===se||ce===se.toLowerCase())return!0}return!1}var f=p.modebar.add;typeof f=="string"&&(f=[f]);var _=p.modebar.remove;typeof _=="string"&&(_=[_]);var b=i.modeBarButtonsToAdd.concat(f.filter(function(se){for(var oe=0;oe<i.modeBarButtonsToRemove.length;oe++)if(x(se,i.modeBarButtonsToRemove[oe]))return!1;return!0})),T=i.modeBarButtonsToRemove.concat(_.filter(function(se){for(var oe=0;oe<i.modeBarButtonsToAdd.length;oe++)if(x(se,i.modeBarButtonsToAdd[oe]))return!1;return!0})),k=p._has("cartesian"),L=p._has("gl3d"),A=p._has("geo"),I=p._has("pie"),P=p._has("funnelarea"),S=p._has("gl2d"),E=p._has("ternary"),z=p._has("mapbox"),D=p._has("polar"),j=p._has("smith"),V=p._has("sankey"),Z=function(se){for(var oe=d.list({_fullLayout:se},null,!0),de=0;de<oe.length;de++)if(!oe[de].fixedrange)return!1;return!0}(p),Q=y(p.hovermode),K=[];function $(se){if(se.length){for(var oe=[],de=0;de<se.length;de++){for(var ce=se[de],ve=t[ce],Ae=ve.name.toLowerCase(),fe=(ve._cat||ve.name).toLowerCase(),me=!1,_e=0;_e<T.length;_e++){var le=T[_e].toLowerCase();if(le===Ae||le===fe){me=!0;break}}me||oe.push(t[ce])}K.push(oe)}}var ne=["toImage"];i.showEditInChartStudio?ne.push("editInChartStudio"):i.showSendToCloud&&ne.push("sendDataToCloud"),$(ne);var H=[],N=[],U=[],te=[];(k||S||I||P||E)+A+L+z+D+j>1?(N=["toggleHover"],U=["resetViews"]):A?(H=["zoomInGeo","zoomOutGeo"],N=["hoverClosestGeo"],U=["resetGeo"]):L?(N=["hoverClosest3d"],U=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(H=["zoomInMapbox","zoomOutMapbox"],N=["toggleHover"],U=["resetViewMapbox"]):S?N=["hoverClosestGl2d"]:I?N=["hoverClosestPie"]:V?(N=["hoverClosestCartesian","hoverCompareCartesian"],U=["resetViewSankey"]):N=["toggleHover"],k&&(N=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(se){for(var oe=0;oe<se.length;oe++)if(!w.traceIs(se[oe],"noHover"))return!1;return!0}(c)||Q)&&(N=[]),!k&&!S||Z||(H=["zoomIn2d","zoomOut2d","autoScale2d"],U[0]!=="resetViews"&&(U=["resetScale2d"])),L?te=["zoom3d","pan3d","orbitRotation","tableRotation"]:(k||S)&&!Z||E?te=["zoom2d","pan2d"]:z||A?te=["pan2d"]:D&&(te=["zoom2d"]),function(se){for(var oe=!1,de=0;de<se.length&&!oe;de++){var ce=se[de];ce._module&&ce._module.selectPoints&&(w.traceIs(ce,"scatter-like")?(v.hasMarkers(ce)||v.hasText(ce))&&(oe=!0):w.traceIs(ce,"box-violin")&&ce.boxpoints!=="all"&&ce.points!=="all"||(oe=!0))}return oe}(c)&&te.push("select2d","lasso2d");var B=[],X=function(se){B.indexOf(se)===-1&&N.indexOf(se)!==-1&&B.push(se)};if(Array.isArray(b)){for(var J=[],ee=0;ee<b.length;ee++){var re=b[ee];typeof re=="string"?(re=re.toLowerCase(),n.indexOf(re)!==-1?(p._has("mapbox")||p._has("cartesian"))&&te.push(re):re==="togglespikelines"?X("toggleSpikelines"):re==="togglehover"?X("toggleHover"):re==="hovercompare"?X("hoverCompareCartesian"):re==="hoverclosest"?(X("hoverClosestCartesian"),X("hoverClosestGeo"),X("hoverClosest3d"),X("hoverClosestGl2d"),X("hoverClosestPie")):re==="v1hovermode"&&(X("toggleHover"),X("hoverClosestCartesian"),X("hoverCompareCartesian"),X("hoverClosestGeo"),X("hoverClosest3d"),X("hoverClosestGl2d"),X("hoverClosestPie"))):J.push(re)}b=J}return $(te),$(H.concat(U)),$(B),function(se,oe){if(oe.length)if(Array.isArray(oe[0]))for(var de=0;de<oe.length;de++)se.push(oe[de]);else se.push(oe);return se}(K,b)}(r),s?s.update(r,h):g._modeBar=e(r,h)}else s&&(s.destroy(),delete g._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../fonts/ploticon"),e=m("../../version").version,t=new DOMParser;function n(r){this.container=r.container,this.element=document.createElement("div"),this.update(r.graphInfo,r.buttons),this.container.appendChild(this.element)}var a=n.prototype;a.update=function(r,g){this.graphInfo=r;var u=this.graphInfo._context,s=this.graphInfo._fullLayout,h="modebar-"+s._uid;this.element.setAttribute("id",h),this._uid=h,this.element.className="modebar",u.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),s.modebar.orientation==="v"&&(this.element.className+=" vertical",g=g.reverse());var l=s.modebar,o=u.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";w.deleteRelatedStyleRule(h),w.addRelatedStyleRule(h,o+"#"+h+" .modebar-group","background-color: "+l.bgcolor),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn .icon path","fill: "+l.color),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn:hover .icon path","fill: "+l.activecolor),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn.active .icon path","fill: "+l.activecolor);var p=!this.hasButtons(g),c=this.hasLogo!==u.displaylogo,i=this.locale!==u.locale;if(this.locale=u.locale,(p||c||i)&&(this.removeAllButtons(),this.updateButtons(g),u.watermark||u.displaylogo)){var x=this.getLogo();u.watermark&&(x.className=x.className+" watermark"),s.modebar.orientation==="v"?this.element.insertBefore(x,this.element.childNodes[0]):this.element.appendChild(x),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(r){var g=this;this.buttons=r,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(u){var s=g.createGroup();u.forEach(function(h){var l=h.name;if(!l)throw new Error("must provide button 'name' in button config");if(g.buttonsNames.indexOf(l)!==-1)throw new Error("button name '"+l+"' is taken");g.buttonsNames.push(l);var o=g.createButton(h);g.buttonElements.push(o),s.appendChild(o)}),g.element.appendChild(s)})},a.createGroup=function(){var r=document.createElement("div");return r.className="modebar-group",r},a.createButton=function(r){var g=this,u=document.createElement("a");u.setAttribute("rel","tooltip"),u.className="modebar-btn";var s=r.title;s===void 0?s=r.name:typeof s=="function"&&(s=s(this.graphInfo)),(s||s===0)&&u.setAttribute("data-title",s),r.attr!==void 0&&u.setAttribute("data-attr",r.attr);var h=r.val;if(h!==void 0&&(typeof h=="function"&&(h=h(this.graphInfo)),u.setAttribute("data-val",h)),typeof r.click!="function")throw new Error("must provide button 'click' function in button config");u.addEventListener("click",function(o){r.click(g.graphInfo,o),g.updateActiveButton(o.currentTarget)}),u.setAttribute("data-toggle",r.toggle||!1),r.toggle&&d.select(u).classed("active",!0);var l=r.icon;return typeof l=="function"?u.appendChild(l()):u.appendChild(this.createIcon(l||y.question)),u.setAttribute("data-gravity",r.gravity||"n"),u},a.createIcon=function(r){var g,u=v(r.height)?Number(r.height):r.ascent-r.descent,s="http://www.w3.org/2000/svg";if(r.path){(g=document.createElementNS(s,"svg")).setAttribute("viewBox",[0,0,r.width,u].join(" ")),g.setAttribute("class","icon");var h=document.createElementNS(s,"path");h.setAttribute("d",r.path),r.transform?h.setAttribute("transform",r.transform):r.ascent!==void 0&&h.setAttribute("transform","matrix(1 0 0 -1 0 "+r.ascent+")"),g.appendChild(h)}return r.svg&&(g=t.parseFromString(r.svg,"application/xml").childNodes[0]),g.setAttribute("height","1em"),g.setAttribute("width","1em"),g},a.updateActiveButton=function(r){var g=this.graphInfo._fullLayout,u=r!==void 0?r.getAttribute("data-attr"):null;this.buttonElements.forEach(function(s){var h=s.getAttribute("data-val")||!0,l=s.getAttribute("data-attr"),o=s.getAttribute("data-toggle")==="true",p=d.select(s);if(o)l===u&&p.classed("active",!p.classed("active"));else{var c=l===null?l:w.nestedProperty(g,l).get();p.classed("active",c===h)}})},a.hasButtons=function(r){var g=this.buttons;if(!g||r.length!==g.length)return!1;for(var u=0;u<r.length;++u){if(r[u].length!==g[u].length)return!1;for(var s=0;s<r[u].length;s++)if(r[u][s].name!==g[u][s].name)return!1}return!0},a.getLogo=function(){var r=this.createGroup(),g=document.createElement("a");return g.href="https://plotly.com/",g.target="_blank",g.setAttribute("data-title",w._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),g.className="modebar-btn plotlyjsicon modebar-btn--logo",g.appendChild(this.createIcon(y.newplotlylogo)),r.appendChild(g),r},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){w.removeElement(this.container.querySelector(".modebar")),w.deleteRelatedStyleRule(this._uid)},G.exports=function(r,g){var u=r._fullLayout,s=new n({graphInfo:r,container:u._modebardiv.node(),buttons:g});return u._privateplot&&d.select(s.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),s}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../color/attributes"),w=(0,m("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});G.exports={visible:{valType:"boolean",editType:"plot"},buttons:w,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:d({editType:"plot"}),bgcolor:{valType:"color",dflt:v.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(m,G,W){G.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(m,G,W){var d=m("../../lib"),v=m("../color"),w=m("../../plot_api/plot_template"),y=m("../../plots/array_container_defaults"),e=m("./attributes"),t=m("./constants");function n(a,r,g,u){var s=u.calendar;function h(o,p){return d.coerce(a,r,e.buttons,o,p)}if(h("visible")){var l=h("step");l!=="all"&&(!s||s==="gregorian"||l!=="month"&&l!=="year"?h("stepmode"):r.stepmode="backward",h("count")),h("label")}}G.exports=function(a,r,g,u,s){var h=a.rangeselector||{},l=w.newContainer(r,"rangeselector");function o(i,x){return d.coerce(h,l,e,i,x)}if(o("visible",y(h,l,{name:"buttons",handleItemDefaults:n,calendar:s}).length>0)){var p=function(i,x,f){for(var _=f.filter(function(L){return x[L].anchor===i._id}),b=0,T=0;T<_.length;T++){var k=x[_[T]].domain;k&&(b=Math.max(k[1],b))}return[i.domain[0],b+t.yPad]}(r,g,u);o("x",p[0]),o("y",p[1]),d.noneOrAll(a,r,["x","y"]),o("xanchor"),o("yanchor"),d.coerceFont(o,"font",g.font);var c=o("bgcolor");o("activecolor",v.contrast(c,t.lightAmount,t.darkAmount)),o("bordercolor"),o("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../color"),e=m("../drawing"),t=m("../../lib"),n=t.strTranslate,a=m("../../lib/svg_text_utils"),r=m("../../plots/cartesian/axis_ids"),g=m("../../constants/alignment"),u=g.LINE_SPACING,s=g.FROM_TL,h=g.FROM_BR,l=m("./constants"),o=m("./get_update_object");function p(x){return x._id}function c(x,f,_){var b=t.ensureSingle(x,"rect","selector-rect",function(T){T.attr("shape-rendering","crispEdges")});b.attr({rx:l.rx,ry:l.ry}),b.call(y.stroke,f.bordercolor).call(y.fill,function(T,k){return k._isActive||k._isHovered?T.activecolor:T.bgcolor}(f,_)).style("stroke-width",f.borderwidth+"px")}function i(x,f,_,b){t.ensureSingle(x,"text","selector-text",function(T){T.attr("text-anchor","middle")}).call(e.font,f.font).text(function(T,k){return T.label?k?t.templateString(T.label,k):T.label:T.step==="all"?"all":T.count+T.step.charAt(0)}(_,b._fullLayout._meta)).call(function(T){a.convertToTspans(T,b)})}G.exports=function(x){var f=x._fullLayout._infolayer.selectAll(".rangeselector").data(function(_){for(var b=r.list(_,"x",!0),T=[],k=0;k<b.length;k++){var L=b[k];L.rangeselector&&L.rangeselector.visible&&T.push(L)}return T}(x),p);f.enter().append("g").classed("rangeselector",!0),f.exit().remove(),f.style({cursor:"pointer","pointer-events":"all"}),f.each(function(_){var b=d.select(this),T=_,k=T.rangeselector,L=b.selectAll("g.button").data(t.filterVisible(k.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(A){var I=d.select(this),P=o(T,A);A._isActive=function(S,E,z){if(E.step==="all")return S.autorange===!0;var D=Object.keys(z);return S.range[0]===z[D[0]]&&S.range[1]===z[D[1]]}(T,A,P),I.call(c,k,A),I.call(i,k,A,x),I.on("click",function(){x._dragged||v.call("_guiRelayout",x,P)}),I.on("mouseover",function(){A._isHovered=!0,I.call(c,k,A)}),I.on("mouseout",function(){A._isHovered=!1,I.call(c,k,A)})}),function(A,I,P,S,E){var z=0,D=0,j=P.borderwidth;I.each(function(){var ne=d.select(this).select(".selector-text"),H=P.font.size*u,N=Math.max(H*a.lineCount(ne),16)+3;D=Math.max(D,N)}),I.each(function(){var ne=d.select(this),H=ne.select(".selector-rect"),N=ne.select(".selector-text"),U=N.node()&&e.bBox(N.node()).width,te=P.font.size*u,B=a.lineCount(N),X=Math.max(U+10,l.minButtonWidth);ne.attr("transform",n(j+z,j)),H.attr({x:0,y:0,width:X,height:D}),a.positionText(N,X/2,D/2-(B-1)*te/2+3),z+=X+5});var V=A._fullLayout._size,Z=V.l+V.w*P.x,Q=V.t+V.h*(1-P.y),K="left";t.isRightAnchor(P)&&(Z-=z,K="right"),t.isCenterAnchor(P)&&(Z-=z/2,K="center");var $="top";t.isBottomAnchor(P)&&(Q-=D,$="bottom"),t.isMiddleAnchor(P)&&(Q-=D/2,$="middle"),z=Math.ceil(z),D=Math.ceil(D),Z=Math.round(Z),Q=Math.round(Q),w.autoMargin(A,S+"-range-selector",{x:P.x,y:P.y,l:z*s[K],r:z*h[K],b:D*h[$],t:D*s[$]}),E.attr("transform",n(Z,Q))}(x,L,k,T._name,b)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(m,G,W){var d=m("d3-time"),v=m("../../lib").titleCase;G.exports=function(w,y){var e=w._name,t={};if(y.step==="all")t[e+".autorange"]=!0;else{var n=function(a,r){var g,u=a.range,s=new Date(a.r2l(u[1])),h=r.step,l=d["utc"+v(h)],o=r.count;switch(r.stepmode){case"backward":g=a.l2r(+l.offset(s,-o));break;case"todate":var p=l.offset(s,-o);g=a.l2r(+l.ceil(p))}var c=u[1];return[g,c]}(w,y);t[e+".range[0]"]=n[0],t[e+".range[1]"]=n[1]}return t}},{"../../lib":515,"d3-time":122}],438:[function(m,G,W){G.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:m("./attributes")}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),draw:m("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(m,G,W){var d=m("../color/attributes");G.exports={bgcolor:{valType:"color",dflt:d.background,editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(m,G,W){var d=m("../../plots/cartesian/axis_ids").list,v=m("../../plots/cartesian/autorange").getAutoRange,w=m("./constants");G.exports=function(y){for(var e=d(y,"x",!0),t=0;t<e.length;t++){var n=e[t],a=n[w.name];a&&a.visible&&a.autorange&&(a._input.autorange=!0,a._input.range=a.range=v(y,n))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(m,G,W){G.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(m,G,W){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("../../plots/cartesian/axis_ids"),y=m("./attributes"),e=m("./oppaxis_attributes");G.exports=function(t,n,a){var r=t[a],g=n[a];if(r.rangeslider||n._requestRangeslider[g._id]){d.isPlainObject(r.rangeslider)||(r.rangeslider={});var u,s,h=r.rangeslider,l=v.newContainer(g,"rangeslider");if(b("visible")){b("bgcolor",n.plot_bgcolor),b("bordercolor"),b("borderwidth"),b("thickness"),b("autorange",!g.isValidRange(h.range)),b("range");var o=n._subplots;if(o)for(var p=o.cartesian.filter(function(k){return k.substr(0,k.indexOf("y"))===w.name2id(a)}).map(function(k){return k.substr(k.indexOf("y"),k.length)}),c=d.simpleMap(p,w.id2name),i=0;i<c.length;i++){var x=c[i];u=h[x]||{},s=v.newContainer(l,x,"yaxis");var f,_=n[x];u.range&&_.isValidRange(u.range)&&(f="fixed"),T("rangemode",f)!=="match"&&T("range",_.range.slice())}l._input=h}}function b(k,L){return d.coerce(h,l,y,k,L)}function T(k,L){return d.coerce(u,s,e,k,L)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../../lib"),e=y.strTranslate,t=m("../drawing"),n=m("../color"),a=m("../titles"),r=m("../../plots/cartesian"),g=m("../../plots/cartesian/axis_ids"),u=m("../dragelement"),s=m("../../lib/setcursor"),h=m("./constants");function l(f,_,b,T){var k=y.ensureSingle(f,"rect",h.bgClassName,function(P){P.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=T.borderwidth%2==0?T.borderwidth:T.borderwidth-1,A=-T._offsetShift,I=t.crispRound(_,T.borderwidth);k.attr({width:T._width+L,height:T._height+L,transform:e(A,A),"stroke-width":I}).call(n.stroke,T.bordercolor).call(n.fill,T.bgcolor)}function o(f,_,b,T){var k=_._fullLayout;y.ensureSingleById(k._topdefs,"clipPath",T._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:T._width,height:T._height})}function p(f,_,b,T){var k,L=_.calcdata,A=f.selectAll("g."+h.rangePlotClassName).data(b._subplotsWith,y.identity);A.enter().append("g").attr("class",function(I){return h.rangePlotClassName+" "+I}).call(t.setClipUrl,T._clipId,_),A.order(),A.exit().remove(),A.each(function(I,P){var S=d.select(this),E=P===0,z=g.getFromId(_,I,"y"),D=z._name,j=T[D],V={data:[],layout:{xaxis:{type:b.type,domain:[0,1],range:T.range.slice(),calendar:b.calendar},width:T._width,height:T._height,margin:{t:0,b:0,l:0,r:0}},_context:_._context};b.rangebreaks&&(V.layout.xaxis.rangebreaks=b.rangebreaks),V.layout[D]={type:z.type,domain:[0,1],range:j.rangemode!=="match"?j.range.slice():z.range.slice(),calendar:z.calendar},z.rangebreaks&&(V.layout[D].rangebreaks=z.rangebreaks),w.supplyDefaults(V);var Z=V._fullLayout.xaxis,Q=V._fullLayout[D];Z.clearCalc(),Z.setScale(),Q.clearCalc(),Q.setScale();var K={id:I,plotgroup:S,xaxis:Z,yaxis:Q,isRangePlot:!0};E?k=K:(K.mainplot="xy",K.mainplotinfo=k),r.rangePlot(_,K,function($,ne){for(var H=[],N=0;N<$.length;N++){var U=$[N],te=U[0].trace;te.xaxis+te.yaxis===ne&&H.push(U)}return H}(L,I))})}function c(f,_,b,T,k){y.ensureSingle(f,"rect",h.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",T._height).call(n.fill,h.maskColor),y.ensureSingle(f,"rect",h.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",T._height).call(n.fill,h.maskColor),k.rangemode!=="match"&&(y.ensureSingle(f,"rect",h.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",T._width).call(n.fill,h.maskOppAxisColor),y.ensureSingle(f,"rect",h.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",T._width).style("border-top",h.maskOppBorder).call(n.fill,h.maskOppAxisColor))}function i(f,_,b,T){_._context.staticPlot||y.ensureSingle(f,"rect",h.slideBoxClassName,function(k){k.attr({y:0,cursor:h.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:T._height,fill:h.slideBoxFill})}function x(f,_,b,T){var k=y.ensureSingle(f,"g",h.grabberMinClassName),L=y.ensureSingle(f,"g",h.grabberMaxClassName),A={x:0,width:h.handleWidth,rx:h.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":h.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(T._height/4),height:Math.round(T._height/2)};y.ensureSingle(k,"rect",h.handleMinClassName,function(S){S.attr(A)}).attr(I),y.ensureSingle(L,"rect",h.handleMaxClassName,function(S){S.attr(A)}).attr(I);var P={width:h.grabAreaWidth,x:0,y:0,fill:h.grabAreaFill,cursor:_._context.staticPlot?void 0:h.grabAreaCursor};y.ensureSingle(k,"rect",h.grabAreaMinClassName,function(S){S.attr(P)}).attr("height",T._height),y.ensureSingle(L,"rect",h.grabAreaMaxClassName,function(S){S.attr(P)}).attr("height",T._height)}G.exports=function(f){for(var _=f._fullLayout,b=_._rangeSliderData,T=0;T<b.length;T++){var k=b[T][h.name];k._clipId=k._id+"-"+_._uid}var L=_._infolayer.selectAll("g."+h.containerClassName).data(b,function(A){return A._name});L.exit().each(function(A){var I=A[h.name];_._topdefs.select("#"+I._clipId).remove()}).remove(),b.length!==0&&(L.enter().append("g").classed(h.containerClassName,!0).attr("pointer-events","all"),L.each(function(A){var I=d.select(this),P=A[h.name],S=_[g.id2name(A.anchor)],E=P[g.id2name(A.anchor)];if(P.range){var z,D=y.simpleMap(P.range,A.r2l),j=y.simpleMap(A.range,A.r2l);z=j[0]<j[1]?[Math.min(D[0],j[0]),Math.max(D[1],j[1])]:[Math.max(D[0],j[0]),Math.min(D[1],j[1])],P.range=P._input.range=y.simpleMap(z,A.l2r)}A.cleanRange("rangeslider.range");var V=_._size,Z=A.domain;P._width=V.w*(Z[1]-Z[0]);var Q=Math.round(V.l+V.w*Z[0]),K=Math.round(V.t+V.h*(1-A._counterDomainMin)+(A.side==="bottom"?A._depth:0)+P._offsetShift+h.extraPad);I.attr("transform",e(Q,K)),P._rl=y.simpleMap(P.range,A.r2l);var $=P._rl[0],ne=P._rl[1],H=ne-$;if(P.p2d=function(se){return se/P._width*H+$},P.d2p=function(se){return(se-$)/H*P._width},A.rangebreaks){var N=A.locateBreaks($,ne);if(N.length){var U,te,B=0;for(U=0;U<N.length;U++)B+=(te=N[U]).max-te.min;var X=P._width/(ne-$-B),J=[-X*$];for(U=0;U<N.length;U++)te=N[U],J.push(J[J.length-1]-X*(te.max-te.min));for(P.d2p=function(se){for(var oe=J[0],de=0;de<N.length;de++){var ce=N[de];if(se>=ce.max)oe=J[de+1];else if(se<ce.min)break}return oe+X*se},U=0;U<N.length;U++)(te=N[U]).pmin=P.d2p(te.min),te.pmax=P.d2p(te.max);P.p2d=function(se){for(var oe=J[0],de=0;de<N.length;de++){var ce=N[de];if(se>=ce.pmax)oe=J[de+1];else if(se<ce.pmin)break}return(se-oe)/X}}}if(E.rangemode!=="match"){var ee=S.r2l(E.range[0]),re=S.r2l(E.range[1])-ee;P.d2pOppAxis=function(se){return(se-ee)/re*P._height}}I.call(l,f,A,P).call(o,f,A,P).call(p,f,A,P).call(c,f,A,P,E).call(i,f,A,P).call(x,f,A,P),function(se,oe,de,ce){if(oe._context.staticPlot)return;var ve=se.select("rect."+h.slideBoxClassName).node(),Ae=se.select("rect."+h.grabAreaMinClassName).node(),fe=se.select("rect."+h.grabAreaMaxClassName).node();function me(){var _e=d.event,le=_e.target,ge=_e.clientX||_e.touches[0].clientX,Te=ge-se.node().getBoundingClientRect().left,Se=ce.d2p(de._rl[0]),Me=ce.d2p(de._rl[1]),ze=u.coverSlip();function Oe(Xe){var Be,Ie,Re,Ye=+(Xe.clientX||Xe.touches[0].clientX)-ge;switch(le){case ve:Re="ew-resize",Be=Se+Ye,Ie=Me+Ye;break;case Ae:Re="col-resize",Be=Se+Ye,Ie=Me;break;case fe:Re="col-resize",Be=Se,Ie=Me+Ye;break;default:Re="ew-resize",Be=Te,Ie=Te+Ye}if(Ie<Be){var Qe=Ie;Ie=Be,Be=Qe}ce._pixelMin=Be,ce._pixelMax=Ie,s(d.select(ze),Re),function(lt,xt,wt,bt){function nt(Nt){return wt.l2r(y.constrain(Nt,bt._rl[0],bt._rl[1]))}var $e=nt(bt.p2d(bt._pixelMin)),vt=nt(bt.p2d(bt._pixelMax));window.requestAnimationFrame(function(){v.call("_guiRelayout",xt,wt._name+".range",[$e,vt])})}(0,oe,de,ce)}function De(){ze.removeEventListener("mousemove",Oe),ze.removeEventListener("mouseup",De),this.removeEventListener("touchmove",Oe),this.removeEventListener("touchend",De),y.removeElement(ze)}this.addEventListener("touchmove",Oe),this.addEventListener("touchend",De),ze.addEventListener("mousemove",Oe),ze.addEventListener("mouseup",De)}se.on("mousedown",me),se.on("touchstart",me)}(I,f,A,P),function(se,oe,de,ce,ve,Ae){var fe=h.handleWidth/2;function me(De){return y.constrain(De,0,ce._width)}function _e(De){return y.constrain(De,0,ce._height)}function le(De){return y.constrain(De,-fe,ce._width+fe)}var ge=me(ce.d2p(de._rl[0])),Te=me(ce.d2p(de._rl[1]));if(se.select("rect."+h.slideBoxClassName).attr("x",ge).attr("width",Te-ge),se.select("rect."+h.maskMinClassName).attr("width",ge),se.select("rect."+h.maskMaxClassName).attr("x",Te).attr("width",ce._width-Te),Ae.rangemode!=="match"){var Se=ce._height-_e(ce.d2pOppAxis(ve._rl[1])),Me=ce._height-_e(ce.d2pOppAxis(ve._rl[0]));se.select("rect."+h.maskMinOppAxisClassName).attr("x",ge).attr("height",Se).attr("width",Te-ge),se.select("rect."+h.maskMaxOppAxisClassName).attr("x",ge).attr("y",Me).attr("height",ce._height-Me).attr("width",Te-ge),se.select("rect."+h.slideBoxClassName).attr("y",Se).attr("height",Me-Se)}var ze=Math.round(le(ge-fe))-.5,Oe=Math.round(le(Te-fe))+.5;se.select("g."+h.grabberMinClassName).attr("transform",e(ze,.5)),se.select("g."+h.grabberMaxClassName).attr("transform",e(Oe,.5))}(I,0,A,P,S,E),A.side==="bottom"&&a.draw(f,A._id+"title",{propContainer:A,propName:A._name+".title",placeholder:_._dfltTitle.x,attributes:{x:A._offset+A._length/2,y:K+P._height+P._offsetShift+10+1.5*A.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(m,G,W){var d=m("../../plots/cartesian/axis_ids"),v=m("../../lib/svg_text_utils"),w=m("./constants"),y=m("../../constants/alignment").LINE_SPACING,e=w.name;function t(n){var a=n&&n[e];return a&&a.visible}W.isVisible=t,W.makeData=function(n){var a=d.list({_fullLayout:n},"x",!0),r=n.margin,g=[];if(!n._has("gl2d"))for(var u=0;u<a.length;u++){var s=a[u];if(t(s)){g.push(s);var h=s[e];h._id=e+s._id,h._height=(n.height-r.b-r.t)*h.thickness,h._offsetShift=Math.floor(h.borderwidth/2)}}n._rangeSliderData=g},W.autoMarginOpts=function(n,a){var r=n._fullLayout,g=a[e],u=a._id.charAt(0),s=0,h=0;return a.side==="bottom"&&(s=a._depth,a.title.text!==r._dfltTitle[u]&&(h=1.5*a.title.font.size+10+g._offsetShift,h+=(a.title.text.match(v.BR_TAG_ALL)||[]).length*a.title.font.size*y)),{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:g._height+s+Math.max(r.margin.b,h),pad:w.extraPad+2*g._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("./oppaxis_attributes"),y=m("./helpers");G.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:d.extendFlat({},v,{yaxis:w})}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),calcAutorange:m("./calc_autorange"),draw:m("./draw"),isVisible:y.isVisible,makeData:y.makeData,autoMarginOpts:y.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(m,G,W){G.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(m,G,W){var d=m("../annotations/attributes"),v=m("../../traces/scatter/attributes").line,w=m("../drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=e(t("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:y({},d.xref,{}),yref:y({},d.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:v.color,width:y({},v.width,{min:1,dflt:1}),dash:y({},w,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(m,G,W){G.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes"),e=m("../shapes/helpers");function t(n,a,r){function g(I,P){return d.coerce(n,a,y,I,P)}var u=g("path"),s=g("type",u?"path":"rect")!=="path";s&&delete a.path,g("opacity"),g("line.color"),g("line.width"),g("line.dash");for(var h=["x","y"],l=0;l<2;l++){var o,p,c,i=h[l],x={_fullLayout:r},f=v.coerceRef(n,a,x,i);if((o=v.getFromId(x,f))._selectionIndices.push(a._index),c=e.rangeToShapePosition(o),p=e.shapePositionToRange(o),s){var _=i+"0",b=i+"1",T=n[_],k=n[b];n[_]=p(n[_],!0),n[b]=p(n[b],!0),v.coercePosition(a,x,g,f,_),v.coercePosition(a,x,g,f,b);var L=a[_],A=a[b];L!==void 0&&A!==void 0&&(a[_]=c(L),a[b]=c(A),n[_]=T,n[b]=k)}}s&&d.noneOrAll(n,a,["x0","x1","y0","y1"])}G.exports=function(n,a){w(n,a,{name:"selections",handleItemDefaults:t});for(var r=a.selections,g=0;g<r.length;g++){var u=r[g];u&&u.path===void 0&&(u.x0!==void 0&&u.x1!==void 0&&u.y0!==void 0&&u.y1!==void 0||(a.selections[g]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(m,G,W){var d=m("../shapes/draw_newshape/helpers").readPaths,v=m("../shapes/display_outlines"),w=m("../shapes/handle_outline").clearOutlineControllers,y=m("../color"),e=m("../drawing"),t=m("../../plot_api/plot_template").arrayEditor,n=m("../shapes/helpers"),a=n.getPathString;function r(l){var o=l._fullLayout;for(var p in w(l),o._selectionLayer.selectAll("path").remove(),o._plots){var c=o._plots[p].selectionLayer;c&&c.selectAll("path").remove()}for(var i=0;i<o.selections.length;i++)u(l,i)}function g(l){return l._context.editSelection}function u(l,o){l._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+o+'"]').remove();var p=n.makeSelectionsOptionsAndPlotinfo(l,o),c=p.options,i=p.plotinfo;c._input&&function(x){var f=a(l,c),_={"data-index":o,"fill-rule":"evenodd",d:f},b=c.opacity,T="rgba(0,0,0,0)",k=c.line.color||y.contrast(l._fullLayout.plot_bgcolor),L=c.line.width,A=c.line.dash;L||(L=5,A="solid");var I=g(l)&&l._fullLayout._activeSelectionIndex===o;I&&(T=l._fullLayout.activeselection.fillcolor,b=l._fullLayout.activeselection.opacity);for(var P=[],S=1;S>=0;S--){var E=x.append("path").attr(_).style("opacity",S?.1:b).call(y.stroke,k).call(y.fill,T).call(e.dashLine,S?"solid":A,S?4+L:L);if(s(E,l,c),I){var z=t(l.layout,"selections",c);E.style({cursor:"move"});var D={element:E.node(),plotinfo:i,gd:l,editHelpers:z,isActiveSelection:!0},j=d(f,l);v(j,E,D)}else E.style("pointer-events",S?"all":"none");P[S]=E}var V=P[0];P[1].node().addEventListener("click",function(){return function(Z,Q){if(!!g(Z)){var K=+Q.node().getAttribute("data-index");if(K>=0){if(K===Z._fullLayout._activeSelectionIndex)return void h(Z);Z._fullLayout._activeSelectionIndex=K,Z._fullLayout._deactivateSelection=h,r(Z)}}}(l,V)})}(l._fullLayout._selectionLayer)}function s(l,o,p){var c=p.xref+p.yref;e.setClipUrl(l,"clip"+o._fullLayout._uid+c,o)}function h(l){g(l)&&l._fullLayout._activeSelectionIndex>=0&&(w(l),delete l._fullLayout._activeSelectionIndex,r(l))}G.exports={draw:r,drawOne:u,activateLastSelection:function(l){if(!!g(l)){var o=l._fullLayout.selections.length-1;l._fullLayout._activeSelectionIndex=o,l._fullLayout._deactivateSelection=h,r(l)}}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(m,G,W){var d=m("../../drawing/attributes").dash,v=m("../../../lib/extend").extendFlat;G.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:v({},d,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(m,G,W){G.exports=function(d,v,w){w("newselection.mode"),w("newselection.line.width")&&(w("newselection.line.color"),w("newselection.line.dash")),w("activeselection.fillcolor"),w("activeselection.opacity")}},{}],453:[function(m,G,W){var d=m("../../dragelement/helpers").selectMode,v=m("../../shapes/handle_outline").clearOutline,w=m("../../shapes/draw_newshape/helpers"),y=w.readPaths,e=w.writePaths,t=w.fixDatesForPaths;G.exports=function(n,a){if(n.length){var r=n[0][0];if(r){var g=r.getAttribute("d"),u=a.gd,s=u._fullLayout.newselection,h=a.plotinfo,l=h.xaxis,o=h.yaxis,p=a.isActiveSelection,c=a.dragmode,i=(u.layout||{}).selections||[];if(!d(c)&&p!==void 0){var x=u._fullLayout._activeSelectionIndex;if(x<i.length)switch(u._fullLayout.selections[x].type){case"rect":c="select";break;case"path":c="lasso"}}var f,_=y(g,u,h,p),b={xref:l._id,yref:o._id,opacity:s.opacity,line:{color:s.line.color,width:s.line.width,dash:s.line.dash}};_.length===1&&(f=_[0]),f&&f.length===5&&c==="select"?(b.type="rect",b.x0=f[0][1],b.y0=f[0][2],b.x1=f[2][1],b.y1=f[2][2]):(b.type="path",l&&o&&t(_,l,o),b.path=e(_),f=null),v(u);for(var T=a.editHelpers,k=(T||{}).modifyItem,L=[],A=0;A<i.length;A++){var I=u._fullLayout.selections[A];if(I){if(L[A]=I._input,p!==void 0&&A===u._fullLayout._activeSelectionIndex){var P=b;switch(I.type){case"rect":k("x0",P.x0),k("x1",P.x1),k("y0",P.y0),k("y1",P.y1);break;case"path":k("path",P.path)}}}else L[A]=I}return p===void 0?(L.push(b),L):T?T.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(m,G,W){var d=m("../../lib").strTranslate;function v(w,y){switch(w.type){case"log":return w.p2d(y);case"date":return w.p2r(y,0,w.calendar);default:return w.p2r(y)}}G.exports={p2r:v,r2p:function(w,y){switch(w.type){case"log":return w.d2p(y);case"date":return w.r2p(y,0,w.calendar);default:return w.r2p(y)}},axValue:function(w){var y=w._id.charAt(0)==="y"?1:0;return function(e){return v(w,e[y])}},getTransform:function(w){return d(w.xaxis._offset,w.yaxis._offset)}}},{"../../lib":515}],455:[function(m,G,W){var d=m("./draw"),v=m("./select");G.exports={moduleType:"component",name:"selections",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),supplyDrawNewSelectionDefaults:m("./draw_newselection/defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("selections"),draw:d.draw,drawOne:d.drawOne,reselect:v.reselect,prepSelect:v.prepSelect,clearOutline:v.clearOutline,clearSelectionsCache:v.clearSelectionsCache,selectOnClick:v.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(m,G,W){var d=m("polybooljs"),v=m("point-in-polygon/nested"),w=m("../../registry"),y=m("../drawing").dashStyle,e=m("../color"),t=m("../fx"),n=m("../fx/helpers").makeEventData,a=m("../dragelement/helpers"),r=a.freeMode,g=a.rectMode,u=a.drawMode,s=a.openMode,h=a.selectMode,l=m("../shapes/helpers"),o=m("../shapes/constants"),p=m("../shapes/display_outlines"),c=m("../shapes/handle_outline").clearOutline,i=m("../shapes/draw_newshape/helpers"),x=i.handleEllipse,f=i.readPaths,_=m("../shapes/draw_newshape/newshapes"),b=m("./draw_newselection/newselections"),T=m("./draw").activateLastSelection,k=m("../../lib"),L=k.sorterAsc,A=m("../../lib/polygon"),I=m("../../lib/throttle"),P=m("../../plots/cartesian/axis_ids").getFromId,S=m("../../lib/clear_gl_canvases"),E=m("../../plot_api/subroutines").redrawReglTraces,z=m("./constants"),D=z.MINSELECT,j=A.filter,V=A.tester,Z=m("./helpers"),Q=Z.p2r,K=Z.axValue,$=Z.getTransform;function ne(De){return De.subplot!==void 0}function H(De,Xe,Be,Ie,Re,Ye,Qe){var lt,xt,wt,bt,nt,$e,vt,Nt,qt,Jt=Xe._hoverdata,Wt=Xe._fullLayout.clickmode.indexOf("event")>-1,ar=[];if(function(be){return be&&Array.isArray(be)&&be[0].hoverOnBox!==!0}(Jt)){B(De,Xe,Ye);var Dt=function(be,Fe){var Ve,Ke,Ge=be[0],ct=-1,st=[];for(Ke=0;Ke<Fe.length;Ke++)if(Ve=Fe[Ke],Ge.fullData._expandedIndex===Ve.cd[0].trace._expandedIndex){if(Ge.hoverOnBox===!0)break;Ge.pointNumber!==void 0?ct=Ge.pointNumber:Ge.binNumber!==void 0&&(ct=Ge.binNumber,st=Ge.pointNumbers);break}return{pointNumber:ct,pointNumbers:st,searchInfo:Ve}}(Jt,lt=ee(Xe,Be,Ie,Re));if(Dt.pointNumbers.length>0?function(be,Fe){var Ve,Ke,Ge,ct=[];for(Ge=0;Ge<be.length;Ge++)(Ve=be[Ge]).cd[0].trace.selectedpoints&&Ve.cd[0].trace.selectedpoints.length>0&&ct.push(Ve);if(ct.length===1&&ct[0]===Fe.searchInfo&&(Ke=Fe.searchInfo.cd[0].trace).selectedpoints.length===Fe.pointNumbers.length){for(Ge=0;Ge<Fe.pointNumbers.length;Ge++)if(Ke.selectedpoints.indexOf(Fe.pointNumbers[Ge])<0)return!1;return!0}return!1}(lt,Dt):function(be){var Fe,Ve,Ke,Ge=0;for(Ke=0;Ke<be.length;Ke++)if(Fe=be[Ke],(Ve=Fe.cd[0].trace).selectedpoints&&(Ve.selectedpoints.length>1||(Ge+=Ve.selectedpoints.length)>1))return!1;return Ge===1}(lt)&&($e=se(Dt))){for(Qe&&Qe.remove(),qt=0;qt<lt.length;qt++)(xt=lt[qt])._module.selectPoints(xt,!1);oe(Xe,lt),X(Ye),Wt&&Oe(Xe)}else{for(vt=De.shiftKey&&($e!==void 0?$e:se(Dt)),wt=function(be,Fe,Ve){return{pointNumber:be,searchInfo:Fe,subtract:!!Ve}}(Dt.pointNumber,Dt.searchInfo,vt),bt=te(Ye.selectionDefs.concat([wt])),qt=0;qt<lt.length;qt++)if(nt=ce(lt[qt]._module.selectPoints(lt[qt],bt),lt[qt]),ar.length)for(var Ne=0;Ne<nt.length;Ne++)ar.push(nt[Ne]);else ar=nt;if(oe(Xe,lt,Nt={points:ar}),wt&&Ye&&Ye.selectionDefs.push(wt),Qe){var qe=Ye.mergedPolygons,pe=s(Ye.dragmode);p(ve(qe,pe),Qe,Ye)}Wt&&ze(Xe,Nt)}}}function N(De){return"pointNumber"in De&&"searchInfo"in De}function U(De){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Xe,Be,Ie,Re){var Ye=De.searchInfo.cd[0].trace._expandedIndex;return Re.cd[0].trace._expandedIndex===Ye&&Ie===De.pointNumber},isRect:!1,degenerate:!1,subtract:!!De.subtract}}function te(De){if(De.length){for(var Xe=[],Be=N(De[0])?0:De[0][0][0],Ie=Be,Re=N(De[0])?0:De[0][0][1],Ye=Re,Qe=0;Qe<De.length;Qe++)if(N(De[Qe]))Xe.push(U(De[Qe]));else{var lt=V(De[Qe]);lt.subtract=!!De[Qe].subtract,Xe.push(lt),Be=Math.min(Be,lt.xmin),Ie=Math.max(Ie,lt.xmax),Re=Math.min(Re,lt.ymin),Ye=Math.max(Ye,lt.ymax)}return{xmin:Be,xmax:Ie,ymin:Re,ymax:Ye,pts:[],contains:function(xt,wt,bt,nt){for(var $e=!1,vt=0;vt<Xe.length;vt++)Xe[vt].contains(xt,wt,bt,nt)&&($e=!Xe[vt].subtract);return $e},isRect:!1,degenerate:!1}}}function B(De,Xe,Be){var Ie=Xe._fullLayout,Re=Be.plotinfo,Ye=Be.dragmode,Qe=Ie._lastSelectedSubplot&&Ie._lastSelectedSubplot===Re.id,lt=(De.shiftKey||De.altKey)&&!(u(Ye)&&s(Ye));Qe&&lt&&Re.selection&&Re.selection.selectionDefs&&!Be.selectionDefs?(Be.selectionDefs=Re.selection.selectionDefs,Be.mergedPolygons=Re.selection.mergedPolygons):lt&&Re.selection||X(Be),Qe||(c(Xe),Ie._lastSelectedSubplot=Re.id)}function X(De,Xe){var Be=De.dragmode,Ie=De.plotinfo,Re=De.gd;(function(nt){return nt._fullLayout._activeShapeIndex>=0})(Re)&&Re._fullLayout._deactivateShape(Re),function(nt){return nt._fullLayout._activeSelectionIndex>=0}(Re)&&Re._fullLayout._deactivateSelection(Re);var Ye=Re._fullLayout._zoomlayer,Qe=u(Be),lt=h(Be);if(Qe||lt){var xt,wt,bt=Ye.selectAll(".select-outline-"+Ie.id);bt&&Re._fullLayout._outlining&&(Qe&&(xt=_(bt,De)),xt&&w.call("_guiRelayout",Re,{shapes:xt}),lt&&!ne(De)&&(wt=b(bt,De)),wt&&(Re._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",Re,{selections:wt}).then(function(){Xe&&T(Re)})),Re._fullLayout._outlining=!1)}Ie.selection={},Ie.selection.selectionDefs=De.selectionDefs=[],Ie.selection.mergedPolygons=De.mergedPolygons=[]}function J(De){return De._id}function ee(De,Xe,Be,Ie){if(!De.calcdata)return[];var Re,Ye,Qe,lt=[],xt=Xe.map(J),wt=Be.map(J);for(Qe=0;Qe<De.calcdata.length;Qe++)if((Ye=(Re=De.calcdata[Qe])[0].trace).visible===!0&&Ye._module&&Ye._module.selectPoints)if(!ne({subplot:Ie})||Ye.subplot!==Ie&&Ye.geo!==Ie)if(Ye.type==="splom"){if(Ye._xaxes[xt[0]]&&Ye._yaxes[wt[0]]){var bt=re(Ye._module,Re,Xe[0],Be[0]);bt.scene=De._fullLayout._splomScenes[Ye.uid],lt.push(bt)}}else if(Ye.type==="sankey"){var nt=re(Ye._module,Re,Xe[0],Be[0]);lt.push(nt)}else{if(xt.indexOf(Ye.xaxis)===-1||wt.indexOf(Ye.yaxis)===-1)continue;lt.push(re(Ye._module,Re,P(De,Ye.xaxis),P(De,Ye.yaxis)))}else lt.push(re(Ye._module,Re,Xe[0],Be[0]));return lt}function re(De,Xe,Be,Ie){return{_module:De,cd:Xe,xaxis:Be,yaxis:Ie}}function se(De){var Xe=De.searchInfo.cd[0].trace,Be=De.pointNumber,Ie=De.pointNumbers,Re=Ie.length>0?Ie[0]:Be;return!!Xe.selectedpoints&&Xe.selectedpoints.indexOf(Re)>-1}function oe(De,Xe,Be){var Ie,Re;for(Ie=0;Ie<Xe.length;Ie++){var Ye=Xe[Ie].cd[0].trace._fullInput,Qe=De._fullLayout._tracePreGUI[Ye.uid]||{};Qe.selectedpoints===void 0&&(Qe.selectedpoints=Ye._input.selectedpoints||null)}if(Be){var lt=Be.points||[];for(Ie=0;Ie<Xe.length;Ie++)(Re=Xe[Ie].cd[0].trace)._input.selectedpoints=Re._fullInput.selectedpoints=[],Re._fullInput!==Re&&(Re.selectedpoints=[]);for(var xt=0;xt<lt.length;xt++){var wt=lt[xt],bt=wt.data,nt=wt.fullData,$e=wt.pointIndex,vt=wt.pointIndices;vt?([].push.apply(bt.selectedpoints,vt),Re._fullInput!==Re&&[].push.apply(nt.selectedpoints,vt)):(bt.selectedpoints.push($e),Re._fullInput!==Re&&nt.selectedpoints.push($e))}}else for(Ie=0;Ie<Xe.length;Ie++)delete(Re=Xe[Ie].cd[0].trace).selectedpoints,delete Re._input.selectedpoints,Re._fullInput!==Re&&delete Re._fullInput.selectedpoints;(function(Nt,qt){for(var Jt=!1,Wt=0;Wt<qt.length;Wt++){var ar=qt[Wt],Dt=ar.cd;w.traceIs(Dt[0].trace,"regl")&&(Jt=!0);var Ne=ar._module,qe=Ne.styleOnSelect||Ne.style;qe&&(qe(Nt,Dt,Dt[0].node3),Dt[0].nodeRangePlot3&&qe(Nt,Dt,Dt[0].nodeRangePlot3))}Jt&&(S(Nt),E(Nt))})(De,Xe)}function de(De,Xe,Be){for(var Ie=(Be?d.difference:d.union)({regions:De},{regions:[Xe]}).regions.reverse(),Re=0;Re<Ie.length;Re++){var Ye=Ie[Re];Ye.subtract=ge(Ye,Ie.slice(0,Re))}return Ie}function ce(De,Xe){if(Array.isArray(De))for(var Be=Xe.cd,Ie=Xe.cd[0].trace,Re=0;Re<De.length;Re++)De[Re]=n(De[Re],Ie,Be);return De}function ve(De,Xe){for(var Be=[],Ie=0;Ie<De.length;Ie++){Be[Ie]=[];for(var Re=0;Re<De[Ie].length;Re++){Be[Ie][Re]=[],Be[Ie][Re][0]=Re?"L":"M";for(var Ye=0;Ye<De[Ie][Re].length;Ye++)Be[Ie][Re].push(De[Ie][Re][Ye])}Xe||Be[Ie].push(["Z",Be[Ie][0][1],Be[Ie][0][2]])}return Be}function Ae(De,Xe){for(var Be,Ie,Re=[],Ye=[],Qe=0;Qe<Xe.length;Qe++){var lt=Xe[Qe];Ie=lt._module.selectPoints(lt,De),Ye.push(Ie),Be=ce(Ie,lt),Re=Re.concat(Be)}return Re}function fe(De,Xe,Be,Ie,Re){var Ye,Qe,lt,xt=!!Ie;Re&&(Ye=Re.plotinfo,Qe=Re.xaxes[0]._id,lt=Re.yaxes[0]._id);var wt=[],bt=[],nt=le(De),$e=De._fullLayout;if(Ye){var vt=$e._zoomlayer,Nt=$e.dragmode,qt=u(Nt),Jt=h(Nt);if(qt||Jt){var Wt=P(De,Qe,"x"),ar=P(De,lt,"y");if(Wt&&ar){var Dt=vt.selectAll(".select-outline-"+Ye.id);if(Dt&&De._fullLayout._outlining&&Dt.length){for(var Ne=Dt[0][0].getAttribute("d"),qe=f(Ne,De,Ye),pe=[],be=0;be<qe.length;be++){for(var Fe=qe[be],Ve=[],Ke=0;Ke<Fe.length;Ke++)Ve.push([Te(Wt,Fe[Ke][1]),Te(ar,Fe[Ke][2])]);Ve.xref=Qe,Ve.yref=lt,Ve.subtract=ge(Ve,pe),pe.push(Ve)}nt=nt.concat(pe)}}}}var Ge=Qe&&lt?[Qe+lt]:$e._subplots.cartesian;(function(Dr){var Nr=Dr.calcdata;if(!!Nr)for(var Wr=0;Wr<Nr.length;Wr++){var hn=Nr[Wr][0].trace,tn=Dr._fullLayout._splomScenes;if(tn){var Fn=tn[hn.uid];Fn&&(Fn.selectBatch=[])}}})(De);for(var ct={},st=0;st<Ge.length;st++){var Mt=Ge[st],Ot=Mt.indexOf("y"),it=Mt.slice(0,Ot),ht=Mt.slice(Ot),jt=Qe&&lt?Be:void 0;if(jt=_e(nt,it,ht,jt)){var kt=Ie;if(!xt){var Pt=P(De,it,"x"),Ee=P(De,ht,"y");kt=ee(De,[Pt],[Ee],Mt);for(var Ze=0;Ze<kt.length;Ze++){var at=kt[Ze],pt=at.cd[0],St=pt.trace;if(at._module.name==="scattergl"&&!pt.t.xpx){var Ut=St.x,Kt=St.y,Ht=St._length;pt.t.xpx=[],pt.t.ypx=[];for(var pr=0;pr<Ht;pr++)pt.t.xpx[pr]=Pt.c2p(Ut[pr]),pt.t.ypx[pr]=Ee.c2p(Kt[pr])}at._module.name==="splom"&&(ct[St.uid]||(ct[St.uid]=!0))}}var Mr=Ae(jt,kt);wt=wt.concat(Mr),bt=bt.concat(kt)}}var hr={points:wt};oe(De,bt,hr);var Qt=$e.clickmode.indexOf("event")>-1&&Xe;if(!Ye&&Xe){var tr=le(De,!0);if(tr.length){var rr=tr[0].xref,fr=tr[0].yref;if(rr&&fr){var yr=Se(tr);Me([P(De,rr,"x"),P(De,fr,"y")])(hr,yr)}}De._fullLayout._noEmitSelectedAtStart?De._fullLayout._noEmitSelectedAtStart=!1:Qt&&ze(De,hr),$e._reselect=!1}if(!Ye&&$e._deselect){var Sr=$e._deselect;(function(Dr,Nr,Wr){for(var hn=0;hn<Wr.length;hn++){var tn=Wr[hn];if(tn.xaxis&&tn.xaxis._id===Dr&&tn.yaxis&&tn.yaxis._id===Nr)return!0}return!1})(Qe=Sr.xref,lt=Sr.yref,bt)||me(De,Qe,lt,Ie),Qt&&(hr.points.length?ze(De,hr):Oe(De)),$e._deselect=!1}return{eventData:hr,selectionTesters:Be}}function me(De,Xe,Be,Ie){Ie=ee(De,[P(De,Xe,"x")],[P(De,Be,"y")],Xe+Be);for(var Re=0;Re<Ie.length;Re++){var Ye=Ie[Re];Ye._module.selectPoints(Ye,!1)}oe(De,Ie)}function _e(De,Xe,Be,Ie){for(var Re,Ye=0;Ye<De.length;Ye++){var Qe=De[Ye];Xe===Qe.xref&&Be===Qe.yref&&(Re?Ie=te(Re=de(Re,Qe,!!Qe.subtract)):(Re=[Qe],Ie=V(Qe)))}return Ie}function le(De,Xe){for(var Be=[],Ie=De._fullLayout,Re=Ie.selections,Ye=Re.length,Qe=0;Qe<Ye;Qe++)if(!Xe||Qe===Ie._activeSelectionIndex){var lt=Re[Qe];if(lt){var xt,wt,bt,nt,$e,vt=lt.xref,Nt=lt.yref,qt=P(De,vt,"x"),Jt=P(De,Nt,"y");if(lt.type==="rect"){$e=[];var Wt=Te(qt,lt.x0),ar=Te(qt,lt.x1),Dt=Te(Jt,lt.y0),Ne=Te(Jt,lt.y1);$e=[[Wt,Dt],[Wt,Ne],[ar,Ne],[ar,Dt]],xt=Math.min(Wt,ar),wt=Math.max(Wt,ar),bt=Math.min(Dt,Ne),nt=Math.max(Dt,Ne),$e.xmin=xt,$e.xmax=wt,$e.ymin=bt,$e.ymax=nt,$e.xref=vt,$e.yref=Nt,$e.subtract=!1,$e.isRect=!0,Be.push($e)}else if(lt.type==="path")for(var qe=lt.path.split("Z"),pe=[],be=0;be<qe.length;be++){var Fe=qe[be];if(Fe){Fe+="Z";var Ve=l.extractPathCoords(Fe,o.paramIsX,"raw"),Ke=l.extractPathCoords(Fe,o.paramIsY,"raw");xt=1/0,wt=-1/0,bt=1/0,nt=-1/0,$e=[];for(var Ge=0;Ge<Ve.length;Ge++){var ct=Te(qt,Ve[Ge]),st=Te(Jt,Ke[Ge]);$e.push([ct,st]),xt=Math.min(ct,xt),wt=Math.max(ct,wt),bt=Math.min(st,bt),nt=Math.max(st,nt)}$e.xmin=xt,$e.xmax=wt,$e.ymin=bt,$e.ymax=nt,$e.xref=vt,$e.yref=Nt,$e.subtract=ge($e,pe),pe.push($e),Be.push($e)}}}}return Be}function ge(De,Xe){for(var Be=!1,Ie=0;Ie<Xe.length;Ie++)for(var Re=Xe[Ie],Ye=0;Ye<De.length;Ye++)if(v(De[Ye],Re)){Be=!Be;break}return Be}function Te(De,Xe){return De.type==="date"&&(Xe=Xe.replace("_"," ")),De.type==="log"?De.c2p(Xe):De.r2p(Xe,null,De.calendar)}function Se(De){for(var Xe=De.length,Be=[],Ie=0;Ie<Xe;Ie++){var Re=De[Ie];Be=(Be=Be.concat(Re)).concat([Re[0]])}return function(Ye){return Ye.isRect=Ye.length===5&&Ye[0][0]===Ye[4][0]&&Ye[0][1]===Ye[4][1]&&Ye[0][0]===Ye[1][0]&&Ye[2][0]===Ye[3][0]&&Ye[0][1]===Ye[3][1]&&Ye[1][1]===Ye[2][1]||Ye[0][1]===Ye[1][1]&&Ye[2][1]===Ye[3][1]&&Ye[0][0]===Ye[3][0]&&Ye[1][0]===Ye[2][0],Ye.isRect&&(Ye.xmin=Math.min(Ye[0][0],Ye[2][0]),Ye.xmax=Math.max(Ye[0][0],Ye[2][0]),Ye.ymin=Math.min(Ye[0][1],Ye[2][1]),Ye.ymax=Math.max(Ye[0][1],Ye[2][1])),Ye}(Be)}function Me(De){return function(Xe,Be){for(var Ie,Re,Ye=0;Ye<De.length;Ye++){var Qe=De[Ye],lt=Qe._id,xt=lt.charAt(0);if(Be.isRect){Ie||(Ie={});var wt=Be[xt+"min"],bt=Be[xt+"max"];wt!==void 0&&bt!==void 0&&(Ie[lt]=[Q(Qe,wt),Q(Qe,bt)].sort(L))}else Re||(Re={}),Re[lt]=Be.map(K(Qe))}Ie&&(Xe.range=Ie),Re&&(Xe.lassoPoints=Re)}}function ze(De,Xe){Xe&&(Xe.selections=(De.layout||{}).selections||[]),De.emit("plotly_selected",Xe)}function Oe(De){De.emit("plotly_deselect",null)}G.exports={reselect:fe,prepSelect:function(De,Xe,Be,Ie,Re){var Ye=!ne(Ie),Qe=r(Re),lt=g(Re),xt=s(Re),wt=u(Re),bt=h(Re),nt=Re==="drawcircle",$e=Re==="drawline"||nt,vt=Ie.gd,Nt=vt._fullLayout,qt=bt&&Nt.newselection.mode==="immediate"&&Ye,Jt=Nt._zoomlayer,Wt=Ie.element.getBoundingClientRect(),ar=Ie.plotinfo,Dt=$(ar),Ne=Xe-Wt.left,qe=Be-Wt.top;Nt._calcInverseTransform(vt);var pe=k.apply3DTransform(Nt._invTransform)(Ne,qe);Ne=pe[0],qe=pe[1];var be,Fe,Ve,Ke,Ge,ct,st,Mt=Nt._invScaleX,Ot=Nt._invScaleY,it=Ne,ht=qe,jt="M"+Ne+","+qe,kt=Ie.xaxes[0],Pt=Ie.yaxes[0],Ee=kt._length,Ze=Pt._length,at=De.altKey&&!(u(Re)&&xt);B(De,vt,Ie),Qe&&(be=j([[Ne,qe]],z.BENDPX));var pt=Jt.selectAll("path.select-outline-"+ar.id).data([1]),St=wt?Nt.newshape:Nt.newselection,Ut=wt&&!xt?St.fillcolor:"rgba(0,0,0,0)",Kt=St.line.color||(Ye?e.contrast(vt._fullLayout.plot_bgcolor):"#7f7f7f");pt.enter().append("path").attr("class","select-outline select-outline-"+ar.id).style({opacity:wt?St.opacity/2:1,"stroke-dasharray":y(St.line.dash,St.line.width),"stroke-width":St.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,Kt).call(e.fill,Ut).attr("fill-rule","evenodd").classed("cursor-move",!!wt).attr("transform",Dt).attr("d",jt+"Z");var Ht=Jt.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Dt).attr("d","M0,0Z"),pr=Nt._uid+z.SELECTID,Mr=[],hr=ee(vt,Ie.xaxes,Ie.yaxes,Ie.subplot);qt&&!De.shiftKey&&(Ie._clearSubplotSelections=function(){if(Ye){var tr=kt._id,rr=Pt._id;me(vt,tr,rr,hr);for(var fr=(vt.layout||{}).selections||[],yr=[],Sr=!1,Dr=0;Dr<fr.length;Dr++){var Nr=Nt.selections[Dr];Nr.xref!==tr||Nr.yref!==rr?yr.push(fr[Dr]):Sr=!0}Sr&&(vt._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",vt,{selections:yr}))}});var Qt=function(tr){return tr.plotinfo.fillRangeItems||Me(tr.xaxes.concat(tr.yaxes))}(Ie);Ie.moveFn=function(tr,rr){Ie._clearSubplotSelections&&(Ie._clearSubplotSelections(),Ie._clearSubplotSelections=void 0),it=Math.max(0,Math.min(Ee,Mt*tr+Ne)),ht=Math.max(0,Math.min(Ze,Ot*rr+qe));var fr=Math.abs(it-Ne),yr=Math.abs(ht-qe);if(lt){var Sr,Dr,Nr;if(bt){var Wr=Nt.selectdirection;switch(Sr=Wr==="any"?yr<Math.min(.6*fr,D)?"h":fr<Math.min(.6*yr,D)?"v":"d":Wr){case"h":Dr=nt?Ze/2:0,Nr=Ze;break;case"v":Dr=nt?Ee/2:0,Nr=Ee}}if(wt)switch(Nt.newshape.drawdirection){case"vertical":Sr="h",Dr=nt?Ze/2:0,Nr=Ze;break;case"horizontal":Sr="v",Dr=nt?Ee/2:0,Nr=Ee;break;case"ortho":fr<yr?(Sr="h",Dr=qe,Nr=ht):(Sr="v",Dr=Ne,Nr=it);break;default:Sr="d"}Sr==="h"?((Ke=$e?x(nt,[it,Dr],[it,Nr]):[[Ne,Dr],[Ne,Nr],[it,Nr],[it,Dr]]).xmin=$e?it:Math.min(Ne,it),Ke.xmax=$e?it:Math.max(Ne,it),Ke.ymin=Math.min(Dr,Nr),Ke.ymax=Math.max(Dr,Nr),Ht.attr("d","M"+Ke.xmin+","+(qe-D)+"h-4v"+2*D+"h4ZM"+(Ke.xmax-1)+","+(qe-D)+"h4v"+2*D+"h-4Z")):Sr==="v"?((Ke=$e?x(nt,[Dr,ht],[Nr,ht]):[[Dr,qe],[Dr,ht],[Nr,ht],[Nr,qe]]).xmin=Math.min(Dr,Nr),Ke.xmax=Math.max(Dr,Nr),Ke.ymin=$e?ht:Math.min(qe,ht),Ke.ymax=$e?ht:Math.max(qe,ht),Ht.attr("d","M"+(Ne-D)+","+Ke.ymin+"v-4h"+2*D+"v4ZM"+(Ne-D)+","+(Ke.ymax-1)+"v4h"+2*D+"v-4Z")):Sr==="d"&&((Ke=$e?x(nt,[Ne,qe],[it,ht]):[[Ne,qe],[Ne,ht],[it,ht],[it,qe]]).xmin=Math.min(Ne,it),Ke.xmax=Math.max(Ne,it),Ke.ymin=Math.min(qe,ht),Ke.ymax=Math.max(qe,ht),Ht.attr("d","M0,0Z"))}else Qe&&(be.addPt([it,ht]),Ke=be.filtered);if(Ie.selectionDefs&&Ie.selectionDefs.length?(Ve=de(Ie.mergedPolygons,Ke,at),Ke.subtract=at,Fe=te(Ie.selectionDefs.concat([Ke]))):(Ve=[Ke],Fe=V(Ke)),p(ve(Ve,xt),pt,Ie),bt){var hn,tn=fe(vt,!1),Fn=tn.eventData?tn.eventData.points.slice():[];tn=fe(vt,!1,Fe,hr,Ie),Fe=tn.selectionTesters,st=tn.eventData,hn=be?be.filtered:Se(Ve),I.throttle(pr,z.SELECTDELAY,function(){for(var an=(Mr=Ae(Fe,hr)).slice(),xn=0;xn<Fn.length;xn++){for(var _n=Fn[xn],ti=!1,jr=0;jr<an.length;jr++)if(an[jr].curveNumber===_n.curveNumber&&an[jr].pointNumber===_n.pointNumber){ti=!0;break}ti||an.push(_n)}an.length&&(st||(st={}),st.points=an),Qt(st,hn),function(nn,vn){nn.emit("plotly_selecting",vn)}(vt,st)})}},Ie.clickFn=function(tr,rr){if(Ht.remove(),vt._fullLayout._activeShapeIndex>=0)vt._fullLayout._deactivateShape(vt);else if(!wt){var fr=Nt.clickmode;I.done(pr).then(function(){if(I.clear(pr),tr===2){for(pt.remove(),Ge=0;Ge<hr.length;Ge++)(ct=hr[Ge])._module.selectPoints(ct,!1);if(oe(vt,hr),X(Ie),Oe(vt),hr.length){var yr=hr[0].xaxis,Sr=hr[0].yaxis;if(yr&&Sr){for(var Dr=[],Nr=vt._fullLayout.selections,Wr=0;Wr<Nr.length;Wr++){var hn=Nr[Wr];hn&&(hn.xref===yr._id&&hn.yref===Sr._id||Dr.push(hn))}Dr.length<Nr.length&&(vt._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",vt,{selections:Dr}))}}}else fr.indexOf("select")>-1&&H(rr,vt,Ie.xaxes,Ie.yaxes,Ie.subplot,Ie,pt),fr==="event"&&ze(vt,void 0);t.click(vt,rr)}).catch(k.error)}},Ie.doneFn=function(){Ht.remove(),I.done(pr).then(function(){I.clear(pr),!qt&&Ke&&Ie.selectionDefs&&(Ke.subtract=at,Ie.selectionDefs.push(Ke),Ie.mergedPolygons.length=0,[].push.apply(Ie.mergedPolygons,Ve)),(qt||wt)&&X(Ie,qt),Ie.doneFnCompleted&&Ie.doneFnCompleted(Mr),bt&&ze(vt,st)}).catch(k.error)}},clearOutline:c,clearSelectionsCache:X,selectOnClick:H}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(m,G,W){var d=m("../annotations/attributes"),v=m("../../traces/scatter/attributes").line,w=m("../drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:y({},d.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:y({},d.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:y({},v.color,{editType:"arraydraw"}),width:y({},v.width,{editType:"calc+arraydraw"}),dash:y({},w,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("./constants"),y=m("./helpers");function e(r){return n(r.line.width,r.xsizemode,r.x0,r.x1,r.path,!1)}function t(r){return n(r.line.width,r.ysizemode,r.y0,r.y1,r.path,!0)}function n(r,g,u,s,h,l){var o=r/2,p=l;if(g==="pixel"){var c=h?y.extractPathCoords(h,l?w.paramIsY:w.paramIsX):[u,s],i=d.aggNums(Math.max,null,c),x=d.aggNums(Math.min,null,c),f=x<0?Math.abs(x)+o:o,_=i>0?i+o:o;return{ppad:o,ppadplus:p?f:_,ppadminus:p?_:f}}return{ppad:o}}function a(r,g,u,s,h){var l=r.type==="category"||r.type==="multicategory"?r.r2c:r.d2c;if(g!==void 0)return[l(g),l(u)];if(s){var o,p,c,i,x=1/0,f=-1/0,_=s.match(w.segmentRE);for(r.type==="date"&&(l=y.decodeDate(l)),o=0;o<_.length;o++)(p=h[_[o].charAt(0)].drawn)!==void 0&&(!(c=_[o].substr(1).match(w.paramRE))||c.length<p||((i=l(c[p]))<x&&(x=i),i>f&&(f=i)));return f>=x?[x,f]:void 0}}G.exports=function(r){var g=r._fullLayout,u=d.filterVisible(g.shapes);if(u.length&&r._fullData.length)for(var s=0;s<u.length;s++){var h,l,o=u[s];o._extremes={};var p=v.getRefType(o.xref),c=v.getRefType(o.yref);if(o.xref!=="paper"&&p!=="domain"){var i=o.xsizemode==="pixel"?o.xanchor:o.x0,x=o.xsizemode==="pixel"?o.xanchor:o.x1;(l=a(h=v.getFromId(r,o.xref),i,x,o.path,w.paramIsX))&&(o._extremes[h._id]=v.findExtremes(h,l,e(o)))}if(o.yref!=="paper"&&c!=="domain"){var f=o.ysizemode==="pixel"?o.yanchor:o.y0,_=o.ysizemode==="pixel"?o.yanchor:o.y1;(l=a(h=v.getFromId(r,o.yref),f,_,o.path,w.paramIsY))&&(o._extremes[h._id]=v.findExtremes(h,l,t(o)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(m,G,W){G.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes"),e=m("./helpers");function t(n,a,r){function g(E,z){return d.coerce(n,a,y,E,z)}if(g("visible")){var u=g("path"),s=g("type",u?"path":"rect")!=="path";s&&delete a.path,g("editable"),g("layer"),g("opacity"),g("fillcolor"),g("fillrule"),g("line.width")&&(g("line.color"),g("line.dash"));for(var h=g("xsizemode"),l=g("ysizemode"),o=["x","y"],p=0;p<2;p++){var c,i,x,f=o[p],_=f+"anchor",b=f==="x"?h:l,T={_fullLayout:r},k=v.coerceRef(n,a,T,f,void 0,"paper");if(v.getRefType(k)==="range"?((c=v.getFromId(T,k))._shapeIndices.push(a._index),x=e.rangeToShapePosition(c),i=e.shapePositionToRange(c)):i=x=d.identity,s){var L=f+"0",A=f+"1",I=n[L],P=n[A];n[L]=i(n[L],!0),n[A]=i(n[A],!0),b==="pixel"?(g(L,0),g(A,10)):(v.coercePosition(a,T,g,k,L,.25),v.coercePosition(a,T,g,k,A,.75)),a[L]=x(a[L]),a[A]=x(a[A]),n[L]=I,n[A]=P}if(b==="pixel"){var S=n[_];n[_]=i(n[_],!0),v.coercePosition(a,T,g,k,_,.25),a[_]=x(a[_]),n[_]=S}}s&&d.noneOrAll(n,a,["x0","x1","y0","y1"])}}G.exports=function(n,a){w(n,a,{name:"shapes",handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(m,G,W){var d=m("../../lib").strTranslate,v=m("../dragelement"),w=m("../dragelement/helpers"),y=w.drawMode,e=w.selectMode,t=m("../../registry"),n=m("../color"),a=m("./draw_newshape/constants"),r=a.i000,g=a.i090,u=a.i180,s=a.i270,h=m("./handle_outline").clearOutlineControllers,l=m("./draw_newshape/helpers"),o=l.pointsOnRectangle,p=l.pointsOnEllipse,c=l.writePaths,i=m("./draw_newshape/newshapes"),x=m("../selections/draw_newselection/newselections");function f(_,b){var T,k,L,A=_[b][1],I=_[b][2],P=_.length;return k=_[T=(b+1)%P][1],L=_[T][2],k===A&&L===I&&(k=_[T=(b+2)%P][1],L=_[T][2]),[T,k,L]}G.exports=function _(b,T,k,L){L||(L=0);var A=k.gd;function I(){_(b,T,k,L++),p(b[0])&&P({redrawing:!0})}function P(J){var ee={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,ee=i(T,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,ee=x(T,k),A._fullLayout._reselect=!0),Object.keys(ee).length&&t.call((J||{}).redrawing?"relayout":"_guiRelayout",A,ee)}var S,E,z,D,j,V=A._fullLayout._zoomlayer,Z=k.dragmode,Q=y(Z),K=e(Z);(Q||K)&&(A._fullLayout._outlining=!0),h(A),T.attr("d",c(b)),L||!k.isActiveShape&&!k.isActiveSelection||(j=function(J,ee){for(var re=0;re<ee.length;re++){var se=ee[re];J[re]=[];for(var oe=0;oe<se.length;oe++){J[re][oe]=[];for(var de=0;de<se[oe].length;de++)J[re][oe][de]=se[oe][de]}}return J}([],b),function(J){S=[];for(var ee=0;ee<b.length;ee++){var re=b[ee],se=o(re),oe=!se&&p(re);S[ee]=[];for(var de=re.length,ce=0;ce<de;ce++)if(re[ce][0]!=="Z"&&(!oe||ce===r||ce===g||ce===u||ce===s)){var ve,Ae=se&&k.isActiveSelection;Ae&&(ve=f(re,ce));var fe=re[ce][1],me=re[ce][2],_e=J.append(Ae?"rect":"circle").attr("data-i",ee).attr("data-j",ce).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Ae){var le=ve[1]-fe,ge=ve[2]-me,Te=ge?5:Math.max(Math.min(25,Math.abs(le)-5),5),Se=le?5:Math.max(Math.min(25,Math.abs(ge)-5),5);_e.classed(ge?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Te).attr("height",Se).attr("x",fe-Te/2).attr("y",me-Se/2).attr("transform",d(le/2,ge/2))}else _e.classed("cursor-grab",!0).attr("r",5).attr("cx",fe).attr("cy",me);S[ee][ce]={element:_e.node(),gd:A,prepFn:$,doneFn:H,clickFn:N},v.init(S[ee][ce])}}}(V.append("g").attr("class","outline-controllers")),function(){E=[],b.length&&(E[0]={element:T[0][0],gd:A,prepFn:te,doneFn:B,clickFn:X},v.init(E[0]))}());function $(J){z=+J.srcElement.getAttribute("data-i"),D=+J.srcElement.getAttribute("data-j"),S[z][D].moveFn=ne}function ne(J,ee){if(b.length){var re=j[z][D][1],se=j[z][D][2],oe=b[z],de=oe.length;if(o(oe)){var ce=J,ve=ee;k.isActiveSelection&&(f(oe,D)[1]===oe[D][1]?ve=0:ce=0);for(var Ae=0;Ae<de;Ae++)if(Ae!==D){var fe=oe[Ae];fe[1]===oe[D][1]&&(fe[1]=re+ce),fe[2]===oe[D][2]&&(fe[2]=se+ve)}if(oe[D][1]=re+ce,oe[D][2]=se+ve,!o(oe))for(var me=0;me<de;me++)for(var _e=0;_e<oe[me].length;_e++)oe[me][_e]=j[z][me][_e]}else oe[D][1]=re+J,oe[D][2]=se+ee;I()}}function H(){P()}function N(J,ee){if(J===2){z=+ee.srcElement.getAttribute("data-i"),D=+ee.srcElement.getAttribute("data-j");var re=b[z];o(re)||p(re)||function(){if(b.length&&b[z]&&b[z].length){for(var se=[],oe=0;oe<b[z].length;oe++)oe!==D&&se.push(b[z][oe]);se.length>1&&(se.length!==2||se[1][0]!=="Z")&&(D===0&&(se[0][0]="M"),b[z]=se,I(),P())}}()}}function U(J,ee){(function(re,se){if(b.length)for(var oe=0;oe<b.length;oe++)for(var de=0;de<b[oe].length;de++)for(var ce=0;ce+2<b[oe][de].length;ce+=2)b[oe][de][ce+1]=j[oe][de][ce+1]+re,b[oe][de][ce+2]=j[oe][de][ce+2]+se})(J,ee),I()}function te(J){(z=+J.srcElement.getAttribute("data-i"))||(z=0),E[z].moveFn=U}function B(){P()}function X(J){J===2&&function(ee){if(!!e(ee._fullLayout.dragmode)){h(ee);var re=ee._fullLayout._activeSelectionIndex,se=(ee.layout||{}).selections||[];if(re<se.length){for(var oe=[],de=0;de<se.length;de++)de!==re&&oe.push(se[de]);delete ee._fullLayout._activeSelectionIndex;var ce=ee._fullLayout.selections[re];ee._fullLayout._deselect={xref:ce.xref,yref:ce.yref},t.call("_guiRelayout",ee,{selections:oe})}}}(A)}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("./draw_newshape/helpers").readPaths,e=m("./display_outlines"),t=m("./handle_outline").clearOutlineControllers,n=m("../color"),a=m("../drawing"),r=m("../../plot_api/plot_template").arrayEditor,g=m("../dragelement"),u=m("../../lib/setcursor"),s=m("./constants"),h=m("./helpers"),l=h.getPathString;function o(b){var T=b._fullLayout;for(var k in T._shapeUpperLayer.selectAll("path").remove(),T._shapeLowerLayer.selectAll("path").remove(),T._plots){var L=T._plots[k].shapelayer;L&&L.selectAll("path").remove()}for(var A=0;A<T.shapes.length;A++)T.shapes[A].visible&&i(b,A)}function p(b){return!!b._fullLayout._outlining}function c(b){return!b._context.edits.shapePosition}function i(b,T){b._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+T+'"]').remove();var k=h.makeShapesOptionsAndPlotinfo(b,T),L=k.options,A=k.plotinfo;L._input&&L.visible!==!1&&(L.layer!=="below"?I(b._fullLayout._shapeUpperLayer):L.xref==="paper"||L.yref==="paper"?I(b._fullLayout._shapeLowerLayer):A._hadPlotinfo?I((A.mainplotinfo||A).shapelayer):I(b._fullLayout._shapeLowerLayer));function I(P){var S=l(b,L),E={"data-index":T,"fill-rule":L.fillrule,d:S},z=L.opacity,D=L.fillcolor,j=L.line.width?L.line.color:"rgba(0,0,0,0)",V=L.line.width,Z=L.line.dash;V||L.editable!==!0||(V=5,Z="solid");var Q=S[S.length-1]!=="Z",K=c(b)&&L.editable&&b._fullLayout._activeShapeIndex===T;K&&(D=Q?"rgba(0,0,0,0)":b._fullLayout.activeshape.fillcolor,z=b._fullLayout.activeshape.opacity);var $,ne=P.append("path").attr(E).style("opacity",z).call(n.stroke,j).call(n.fill,D).call(a.dashLine,Z,V);if(x(ne,b,L),(K||b._context.edits.shapePosition)&&($=r(b.layout,"shapes",L)),K){ne.style({cursor:"move"});var H={element:ne.node(),plotinfo:A,gd:b,editHelpers:$,isActiveShape:!0},N=y(S,b);e(N,ne,H)}else b._context.edits.shapePosition?function(U,te,B,X,J,ee){var re,se,oe,de,ce,ve,Ae,fe,me,_e,le,ge,Te,Se,Me,ze,Oe=B.xsizemode==="pixel",De=B.ysizemode==="pixel",Xe=B.type==="line",Be=B.type==="path",Ie=ee.modifyItem,Re=w.getFromId(U,B.xref),Ye=w.getRefType(B.xref),Qe=w.getFromId(U,B.yref),lt=w.getRefType(B.yref),xt=h.getDataToPixel(U,Re,!1,Ye),wt=h.getDataToPixel(U,Qe,!0,lt),bt=h.getPixelToData(U,Re,!1,Ye),nt=h.getPixelToData(U,Qe,!0,lt),$e=Xe?function(){var Dt=Math.max(B.line.width,10),Ne=J.append("g").attr("data-index",X);Ne.append("path").attr("d",te.attr("d")).style({cursor:"move","stroke-width":Dt,"stroke-opacity":"0"});var qe={"fill-opacity":"0"},pe=Math.max(Dt/2,10);return Ne.append("circle").attr({"data-line-point":"start-point",cx:Oe?xt(B.xanchor)+B.x0:xt(B.x0),cy:De?wt(B.yanchor)-B.y0:wt(B.y0),r:pe}).style(qe).classed("cursor-grab",!0),Ne.append("circle").attr({"data-line-point":"end-point",cx:Oe?xt(B.xanchor)+B.x1:xt(B.x1),cy:De?wt(B.yanchor)-B.y1:wt(B.y1),r:pe}).style(qe).classed("cursor-grab",!0),Ne}():te,vt={element:$e.node(),gd:U,prepFn:function(Dt){p(U)||(Oe&&(ce=xt(B.xanchor)),De&&(ve=wt(B.yanchor)),B.type==="path"?Me=B.path:(re=Oe?B.x0:xt(B.x0),se=De?B.y0:wt(B.y0),oe=Oe?B.x1:xt(B.x1),de=De?B.y1:wt(B.y1)),re<oe?(me=re,Te="x0",_e=oe,Se="x1"):(me=oe,Te="x1",_e=re,Se="x0"),!De&&se<de||De&&se>de?(Ae=se,le="y0",fe=de,ge="y1"):(Ae=de,le="y1",fe=se,ge="y0"),Nt(Dt),Wt(J,B),function(Ne,qe,pe){var be=qe.xref,Fe=qe.yref,Ve=w.getFromId(pe,be),Ke=w.getFromId(pe,Fe),Ge="";be==="paper"||Ve.autorange||(Ge+=be),Fe==="paper"||Ke.autorange||(Ge+=Fe),a.setClipUrl(Ne,Ge?"clip"+pe._fullLayout._uid+Ge:null,pe)}(te,B,U),vt.moveFn=ze==="move"?qt:Jt,vt.altKey=Dt.altKey)},doneFn:function(){p(U)||(u(te),ar(J),x(te,U,B),d.call("_guiRelayout",U,ee.getUpdateObj()))},clickFn:function(){p(U)||ar(J)}};function Nt(Dt){if(p(U))ze=null;else if(Xe)ze=Dt.target.tagName==="path"?"move":Dt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Ne=vt.element.getBoundingClientRect(),qe=Ne.right-Ne.left,pe=Ne.bottom-Ne.top,be=Dt.clientX-Ne.left,Fe=Dt.clientY-Ne.top,Ve=!Be&&qe>10&&pe>10&&!Dt.shiftKey?g.getCursor(be/qe,1-Fe/pe):"move";u(te,Ve),ze=Ve.split("-")[0]}}function qt(Dt,Ne){if(B.type==="path"){var qe=function(Fe){return Fe},pe=qe,be=qe;Oe?Ie("xanchor",B.xanchor=bt(ce+Dt)):(pe=function(Fe){return bt(xt(Fe)+Dt)},Re&&Re.type==="date"&&(pe=h.encodeDate(pe))),De?Ie("yanchor",B.yanchor=nt(ve+Ne)):(be=function(Fe){return nt(wt(Fe)+Ne)},Qe&&Qe.type==="date"&&(be=h.encodeDate(be))),Ie("path",B.path=f(Me,pe,be))}else Oe?Ie("xanchor",B.xanchor=bt(ce+Dt)):(Ie("x0",B.x0=bt(re+Dt)),Ie("x1",B.x1=bt(oe+Dt))),De?Ie("yanchor",B.yanchor=nt(ve+Ne)):(Ie("y0",B.y0=nt(se+Ne)),Ie("y1",B.y1=nt(de+Ne)));te.attr("d",l(U,B)),Wt(J,B)}function Jt(Dt,Ne){if(Be){var qe=function(Ee){return Ee},pe=qe,be=qe;Oe?Ie("xanchor",B.xanchor=bt(ce+Dt)):(pe=function(Ee){return bt(xt(Ee)+Dt)},Re&&Re.type==="date"&&(pe=h.encodeDate(pe))),De?Ie("yanchor",B.yanchor=nt(ve+Ne)):(be=function(Ee){return nt(wt(Ee)+Ne)},Qe&&Qe.type==="date"&&(be=h.encodeDate(be))),Ie("path",B.path=f(Me,pe,be))}else if(Xe){if(ze==="resize-over-start-point"){var Fe=re+Dt,Ve=De?se-Ne:se+Ne;Ie("x0",B.x0=Oe?Fe:bt(Fe)),Ie("y0",B.y0=De?Ve:nt(Ve))}else if(ze==="resize-over-end-point"){var Ke=oe+Dt,Ge=De?de-Ne:de+Ne;Ie("x1",B.x1=Oe?Ke:bt(Ke)),Ie("y1",B.y1=De?Ge:nt(Ge))}}else{var ct=function(Ee){return ze.indexOf(Ee)!==-1},st=ct("n"),Mt=ct("s"),Ot=ct("w"),it=ct("e"),ht=st?Ae+Ne:Ae,jt=Mt?fe+Ne:fe,kt=Ot?me+Dt:me,Pt=it?_e+Dt:_e;De&&(st&&(ht=Ae-Ne),Mt&&(jt=fe-Ne)),(!De&&jt-ht>10||De&&ht-jt>10)&&(Ie(le,B[le]=De?ht:nt(ht)),Ie(ge,B[ge]=De?jt:nt(jt))),Pt-kt>10&&(Ie(Te,B[Te]=Oe?kt:bt(kt)),Ie(Se,B[Se]=Oe?Pt:bt(Pt)))}te.attr("d",l(U,B)),Wt(J,B)}function Wt(Dt,Ne){(Oe||De)&&function(){var qe=Ne.type!=="path",pe=Dt.selectAll(".visual-cue").data([0]);pe.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var be=xt(Oe?Ne.xanchor:v.midRange(qe?[Ne.x0,Ne.x1]:h.extractPathCoords(Ne.path,s.paramIsX))),Fe=wt(De?Ne.yanchor:v.midRange(qe?[Ne.y0,Ne.y1]:h.extractPathCoords(Ne.path,s.paramIsY)));if(be=h.roundPositionForSharpStrokeRendering(be,1),Fe=h.roundPositionForSharpStrokeRendering(Fe,1),Oe&&De){var Ve="M"+(be-1-1)+","+(Fe-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";pe.attr("d",Ve)}else if(Oe){var Ke="M"+(be-1-1)+","+(Fe-9-1)+"v18 h2 v-18 Z";pe.attr("d",Ke)}else{var Ge="M"+(be-9-1)+","+(Fe-1-1)+"h18 v2 h-18 Z";pe.attr("d",Ge)}}()}function ar(Dt){Dt.selectAll(".visual-cue").remove()}g.init(vt),$e.node().onmousemove=Nt}(b,ne,L,T,P,$):L.editable===!0&&ne.style("pointer-events",Q||n.opacity(D)*z<=.5?"stroke":"all");ne.node().addEventListener("click",function(){return function(U,te){if(!!c(U)){var B=+te.node().getAttribute("data-index");if(B>=0){if(B===U._fullLayout._activeShapeIndex)return void _(U);U._fullLayout._activeShapeIndex=B,U._fullLayout._deactivateShape=_,o(U)}}}(b,ne)})}}function x(b,T,k){var L=(k.xref+k.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(b,L?"clip"+T._fullLayout._uid+L:null,T)}function f(b,T,k){return b.replace(s.segmentRE,function(L){var A=0,I=L.charAt(0),P=s.paramIsX[I],S=s.paramIsY[I],E=s.numParams[I];return I+L.substr(1).replace(s.paramRE,function(z){return A>=E||(P[A]?z=T(z):S[A]&&(z=k(z)),A++),z})})}function _(b){c(b)&&b._fullLayout._activeShapeIndex>=0&&(t(b),delete b._fullLayout._activeShapeIndex,o(b))}G.exports={draw:o,drawOne:i,eraseActiveShape:function(b){if(!!c(b)){t(b);var T=b._fullLayout._activeShapeIndex,k=(b.layout||{}).shapes||[];if(T<k.length){for(var L=[],A=0;A<k.length;A++)A!==T&&L.push(k[A]);delete b._fullLayout._activeShapeIndex,d.call("_guiRelayout",b,{shapes:L})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(m,G,W){var d=m("../../drawing/attributes").dash,v=m("../../../lib/extend").extendFlat;G.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:v({},d,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(m,G,W){G.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(m,G,W){var d=m("../../color");G.exports=function(v,w,y){if(y("newshape.drawdirection"),y("newshape.layer"),y("newshape.fillcolor"),y("newshape.fillrule"),y("newshape.opacity"),y("newshape.line.width")){var e=(v||{}).plot_bgcolor||"#FFF";y("newshape.line.color",d.contrast(e)),y("newshape.line.dash")}y("activeshape.fillcolor"),y("activeshape.opacity")}},{"../../color":367}],466:[function(m,G,W){var d=m("parse-svg-path"),v=m("./constants"),w=v.CIRCLE_SIDES,y=v.SQRT2,e=m("../../selections/helpers"),t=e.p2r,n=e.r2p,a=[0,3,4,5,6,1,2],r=[0,3,4,1,2];function g(s,h){return Math.abs(s-h)<=1e-6}function u(s,h){var l=h[1]-s[1],o=h[2]-s[2];return Math.sqrt(l*l+o*o)}W.writePaths=function(s){var h=s.length;if(!h)return"M0,0Z";for(var l="",o=0;o<h;o++)for(var p=s[o].length,c=0;c<p;c++){var i=s[o][c][0];if(i==="Z")l+="Z";else for(var x=s[o][c].length,f=0;f<x;f++){var _=f;i==="Q"||i==="S"?_=r[f]:i==="C"&&(_=a[f]),l+=s[o][c][_],f>0&&f<x-1&&(l+=",")}}return l},W.readPaths=function(s,h,l,o){var p,c,i,x=d(s),f=[],_=-1,b=0,T=0,k=function(){c=b,i=T};k();for(var L=0;L<x.length;L++){var A,I,P,S,E=[],z=x[L][0],D=z;switch(z){case"M":_++,f[_]=[],b=+x[L][1],T=+x[L][2],E.push([D,b,T]),k();break;case"Q":case"S":A=+x[L][1],P=+x[L][2],b=+x[L][3],T=+x[L][4],E.push([D,b,T,A,P]);break;case"C":A=+x[L][1],P=+x[L][2],I=+x[L][3],S=+x[L][4],b=+x[L][5],T=+x[L][6],E.push([D,b,T,A,P,I,S]);break;case"T":case"L":b=+x[L][1],T=+x[L][2],E.push([D,b,T]);break;case"H":D="L",b=+x[L][1],E.push([D,b,T]);break;case"V":D="L",T=+x[L][1],E.push([D,b,T]);break;case"A":D="L";var j=+x[L][1],V=+x[L][2];+x[L][4]||(j=-j,V=-V);var Z=b-j,Q=T;for(p=1;p<=w/2;p++){var K=2*Math.PI*p/w;E.push([D,Z+j*Math.cos(K),Q+V*Math.sin(K)])}break;case"Z":b===c&&T===i||(b=c,T=i,E.push([D,b,T]))}for(var $=(l||{}).domain,ne=h._fullLayout._size,H=l&&l.xsizemode==="pixel",N=l&&l.ysizemode==="pixel",U=o===!1,te=0;te<E.length;te++){for(p=0;p+2<7;p+=2){var B=E[te][p+1],X=E[te][p+2];B!==void 0&&X!==void 0&&(b=B,T=X,l&&(l.xaxis&&l.xaxis.p2r?(U&&(B-=l.xaxis._offset),B=H?n(l.xaxis,l.xanchor)+B:t(l.xaxis,B)):(U&&(B-=ne.l),$?B=$.x[0]+B/ne.w:B/=ne.w),l.yaxis&&l.yaxis.p2r?(U&&(X-=l.yaxis._offset),X=N?n(l.yaxis,l.yanchor)-X:t(l.yaxis,X)):(U&&(X-=ne.t),X=$?$.y[1]-X/ne.h:1-X/ne.h)),E[te][p+1]=B,E[te][p+2]=X)}f[_].push(E[te].slice())}}return f},W.pointsOnRectangle=function(s){if(s.length!==5)return!1;for(var h=1;h<3;h++)if(!g(s[0][h]-s[1][h],s[3][h]-s[2][h])||!g(s[0][h]-s[3][h],s[1][h]-s[2][h]))return!1;return!(!g(s[0][1],s[1][1])&&!g(s[0][1],s[3][1]))&&!!(u(s[0],s[1])*u(s[0],s[3]))},W.pointsOnEllipse=function(s){var h=s.length;if(h!==w+1)return!1;h=w;for(var l=0;l<h;l++){var o=(2*h-l)%h,p=(h/2+o)%h,c=(h/2+l)%h;if(!g(u(s[l],s[c]),u(s[o],s[p])))return!1}return!0},W.handleEllipse=function(s,h,l){if(!s)return[h,l];var o=W.ellipseOver({x0:h[0],y0:h[1],x1:l[0],y1:l[1]}),p=(o.x1+o.x0)/2,c=(o.y1+o.y0)/2,i=(o.x1-o.x0)/2,x=(o.y1-o.y0)/2;i||(i=x/=y),x||(x=i/=y);for(var f=[],_=0;_<w;_++){var b=2*_*Math.PI/w;f.push([p+i*Math.cos(b),c+x*Math.sin(b)])}return f},W.ellipseOver=function(s){var h=s.x0,l=s.y0,o=s.x1,p=s.y1,c=o-h,i=p-l,x=((h-=c)+o)/2,f=((l-=i)+p)/2;return{x0:x-(c*=y),y0:f-(i*=y),x1:x+c,y1:f+i}},W.fixDatesForPaths=function(s,h,l){var o=h.type==="date",p=l.type==="date";if(!o&&!p)return s;for(var c=0;c<s.length;c++)for(var i=0;i<s[c].length;i++)for(var x=0;x+2<s[c][i].length;x+=2)o&&(s[c][i][x+1]=s[c][i][x+1].replace(" ","_")),p&&(s[c][i][x+2]=s[c][i][x+2].replace(" ","_"));return s}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(m,G,W){var d=m("../../dragelement/helpers"),v=d.drawMode,w=d.openMode,y=m("./constants"),e=y.i000,t=y.i090,n=y.i180,a=y.i270,r=y.cos45,g=y.sin45,u=m("../../selections/helpers"),s=u.p2r,h=u.r2p,l=m(".././handle_outline").clearOutline,o=m("./helpers"),p=o.readPaths,c=o.writePaths,i=o.ellipseOver,x=o.fixDatesForPaths;G.exports=function(f,_){if(f.length){var b=f[0][0];if(b){var T=b.getAttribute("d"),k=_.gd,L=k._fullLayout.newshape,A=_.plotinfo,I=A.xaxis,P=A.yaxis,S=!!A.domain||!A.xaxis,E=!!A.domain||!A.yaxis,z=_.isActiveShape,D=_.dragmode,j=(k.layout||{}).shapes||[];if(!v(D)&&z!==void 0){var V=k._fullLayout._activeShapeIndex;if(V<j.length)switch(k._fullLayout.shapes[V].type){case"rect":D="drawrect";break;case"circle":D="drawcircle";break;case"line":D="drawline";break;case"path":var Z=j[V].path||"";D=Z[Z.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var Q,K=w(D),$=p(T,k,A,z),ne={editable:!0,xref:S?"paper":I._id,yref:E?"paper":P._id,layer:L.layer,opacity:L.opacity,line:{color:L.line.color,width:L.line.width,dash:L.line.dash}};if(K||(ne.fillcolor=L.fillcolor,ne.fillrule=L.fillrule),$.length===1&&(Q=$[0]),Q&&Q.length===5&&D==="drawrect")ne.type="rect",ne.x0=Q[0][1],ne.y0=Q[0][2],ne.x1=Q[2][1],ne.y1=Q[2][2];else if(Q&&D==="drawline")ne.type="line",ne.x0=Q[0][1],ne.y0=Q[0][2],ne.x1=Q[1][1],ne.y1=Q[1][2];else if(Q&&D==="drawcircle"){ne.type="circle";var H=Q[e][1],N=Q[t][1],U=Q[n][1],te=Q[a][1],B=Q[e][2],X=Q[t][2],J=Q[n][2],ee=Q[a][2],re=A.xaxis&&(A.xaxis.type==="date"||A.xaxis.type==="log"),se=A.yaxis&&(A.yaxis.type==="date"||A.yaxis.type==="log");re&&(H=h(A.xaxis,H),N=h(A.xaxis,N),U=h(A.xaxis,U),te=h(A.xaxis,te)),se&&(B=h(A.yaxis,B),X=h(A.yaxis,X),J=h(A.yaxis,J),ee=h(A.yaxis,ee));var oe=(N+te)/2,de=(B+J)/2,ce=i({x0:oe,y0:de,x1:oe+(te-N+U-H)/2*r,y1:de+(ee-X+J-B)/2*g});re&&(ce.x0=s(A.xaxis,ce.x0),ce.x1=s(A.xaxis,ce.x1)),se&&(ce.y0=s(A.yaxis,ce.y0),ce.y1=s(A.yaxis,ce.y1)),ne.x0=ce.x0,ne.y0=ce.y0,ne.x1=ce.x1,ne.y1=ce.y1}else ne.type="path",I&&P&&x($,I,P),ne.path=c($),Q=null;l(k);for(var ve=_.editHelpers,Ae=(ve||{}).modifyItem,fe=[],me=0;me<j.length;me++){var _e=k._fullLayout.shapes[me];if(fe[me]=_e._input,z!==void 0&&me===k._fullLayout._activeShapeIndex){var le=ne;switch(_e.type){case"line":case"rect":case"circle":Ae("x0",le.x0),Ae("x1",le.x1),Ae("y0",le.y0),Ae("y1",le.y1);break;case"path":Ae("path",le.path)}}}return z===void 0?(fe.push(ne),fe):ve?ve.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(m,G,W){G.exports={clearOutlineControllers:function(d){var v=d._fullLayout._zoomlayer;v&&v.selectAll(".outline-controllers").remove()},clearOutline:function(d){var v=d._fullLayout._zoomlayer;v&&v.selectAll(".select-outline").remove(),d._fullLayout._outlining=!1}}},{}],469:[function(m,G,W){var d=m("./constants"),v=m("../../lib"),w=m("../../plots/cartesian/axes");W.rangeToShapePosition=function(y){return y.type==="log"?y.r2d:function(e){return e}},W.shapePositionToRange=function(y){return y.type==="log"?y.d2r:function(e){return e}},W.decodeDate=function(y){return function(e){return e.replace&&(e=e.replace("_"," ")),y(e)}},W.encodeDate=function(y){return function(e){return y(e).replace(" ","_")}},W.extractPathCoords=function(y,e,t){var n=[];return y.match(d.segmentRE).forEach(function(a){var r=e[a.charAt(0)].drawn;if(r!==void 0){var g=a.substr(1).match(d.paramRE);if(g&&!(g.length<r)){var u=g[r],s=t?u:v.cleanNumber(u);n.push(s)}}}),n},W.getDataToPixel=function(y,e,t,n){var a,r=y._fullLayout._size;if(e)if(n==="domain")a=function(u){return e._length*(t?1-u:u)+e._offset};else{var g=W.shapePositionToRange(e);a=function(u){return e._offset+e.r2p(g(u,!0))},e.type==="date"&&(a=W.decodeDate(a))}else a=t?function(u){return r.t+r.h*(1-u)}:function(u){return r.l+r.w*u};return a},W.getPixelToData=function(y,e,t,n){var a,r=y._fullLayout._size;if(e)if(n==="domain")a=function(u){var s=(u-e._offset)/e._length;return t?1-s:s};else{var g=W.rangeToShapePosition(e);a=function(u){return g(e.p2r(u-e._offset))}}else a=t?function(u){return 1-(u-r.t)/r.h}:function(u){return(u-r.l)/r.w};return a},W.roundPositionForSharpStrokeRendering=function(y,e){var t=Math.round(e%2)===1,n=Math.round(y);return t?n+.5:n},W.makeShapesOptionsAndPlotinfo=function(y,e){var t=y._fullLayout.shapes[e]||{},n=y._fullLayout._plots[t.xref+t.yref];return n?n._hadPlotinfo=!0:(n={},t.xref&&t.xref!=="paper"&&(n.xaxis=y._fullLayout[t.xref+"axis"]),t.yref&&t.yref!=="paper"&&(n.yaxis=y._fullLayout[t.yref+"axis"])),n.xsizemode=t.xsizemode,n.ysizemode=t.ysizemode,n.xanchor=t.xanchor,n.yanchor=t.yanchor,{options:t,plotinfo:n}},W.makeSelectionsOptionsAndPlotinfo=function(y,e){var t=y._fullLayout.selections[e]||{},n=y._fullLayout._plots[t.xref+t.yref];return n?n._hadPlotinfo=!0:(n={},t.xref&&(n.xaxis=y._fullLayout[t.xref+"axis"]),t.yref&&(n.yaxis=y._fullLayout[t.yref+"axis"])),{options:t,plotinfo:n}},W.getPathString=function(y,e){var t,n,a,r,g,u,s,h,l=e.type,o=w.getRefType(e.xref),p=w.getRefType(e.yref),c=w.getFromId(y,e.xref),i=w.getFromId(y,e.yref),x=y._fullLayout._size;if(c?o==="domain"?n=function(P){return c._offset+c._length*P}:(t=W.shapePositionToRange(c),n=function(P){return c._offset+c.r2p(t(P,!0))}):n=function(P){return x.l+x.w*P},i?p==="domain"?r=function(P){return i._offset+i._length*(1-P)}:(a=W.shapePositionToRange(i),r=function(P){return i._offset+i.r2p(a(P,!0))}):r=function(P){return x.t+x.h*(1-P)},l==="path")return c&&c.type==="date"&&(n=W.decodeDate(n)),i&&i.type==="date"&&(r=W.decodeDate(r)),function(P,S,E){var z=P.path,D=P.xsizemode,j=P.ysizemode,V=P.xanchor,Z=P.yanchor;return z.replace(d.segmentRE,function(Q){var K=0,$=Q.charAt(0),ne=d.paramIsX[$],H=d.paramIsY[$],N=d.numParams[$],U=Q.substr(1).replace(d.paramRE,function(te){return ne[K]?te=D==="pixel"?S(V)+Number(te):S(te):H[K]&&(te=j==="pixel"?E(Z)-Number(te):E(te)),++K>N&&(te="X"),te});return K>N&&(U=U.replace(/[\s,]*X.*/,""),v.log("Ignoring extra params in segment "+Q)),$+U})}(e,n,r);if(e.xsizemode==="pixel"){var f=n(e.xanchor);g=f+e.x0,u=f+e.x1}else g=n(e.x0),u=n(e.x1);if(e.ysizemode==="pixel"){var _=r(e.yanchor);s=_-e.y0,h=_-e.y1}else s=r(e.y0),h=r(e.y1);if(l==="line")return"M"+g+","+s+"L"+u+","+h;if(l==="rect")return"M"+g+","+s+"H"+u+"V"+h+"H"+g+"Z";var b=(g+u)/2,T=(s+h)/2,k=Math.abs(b-g),L=Math.abs(T-s),A="A"+k+","+L,I=b+k+","+T;return"M"+I+A+" 0 1,1 "+(b+","+(T-L))+A+" 0 0,1 "+I+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(m,G,W){var d=m("./draw");G.exports={moduleType:"component",name:"shapes",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),supplyDrawNewShapeDefaults:m("./draw_newshape/defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("shapes"),calcAutorange:m("./calc_autorange"),draw:d.draw,drawOne:d.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../../plots/pad_attributes"),w=m("../../lib/extend").extendDeepAll,y=m("../../plot_api/edit_types").overrideAll,e=m("../../plots/animation_attributes"),t=m("../../plot_api/plot_template").templatedArray,n=m("./constants"),a=t("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});G.exports=y(t("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:w(v({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:d({})},font:d({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(m,G,W){G.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("./constants").name,e=w.steps;function t(a,r,g){function u(p,c){return d.coerce(a,r,w,p,c)}for(var s=v(a,r,{name:"steps",handleItemDefaults:n}),h=0,l=0;l<s.length;l++)s[l].visible&&h++;if(h<2?r.visible=!1:u("visible")){r._stepCount=h;var o=r._visibleSteps=d.filterVisible(s);(s[u("active")]||{}).visible||(r.active=o[0]._index),u("x"),u("y"),d.noneOrAll(a,r,["x","y"]),u("xanchor"),u("yanchor"),u("len"),u("lenmode"),u("pad.t"),u("pad.r"),u("pad.b"),u("pad.l"),d.coerceFont(u,"font",g.font),u("currentvalue.visible")&&(u("currentvalue.xanchor"),u("currentvalue.prefix"),u("currentvalue.suffix"),u("currentvalue.offset"),d.coerceFont(u,"currentvalue.font",r.font)),u("transition.duration"),u("transition.easing"),u("bgcolor"),u("activebgcolor"),u("bordercolor"),u("borderwidth"),u("ticklen"),u("tickwidth"),u("tickcolor"),u("minorticklen")}}function n(a,r){function g(s,h){return d.coerce(a,r,e,s,h)}if(a.method==="skip"||Array.isArray(a.args)?g("visible"):r.visible=!1){g("method"),g("args");var u=g("label","step-"+r._index);g("value",u),g("execute")}}G.exports=function(a,r){v(a,r,{name:y,handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../color"),y=m("../drawing"),e=m("../../lib"),t=e.strTranslate,n=m("../../lib/svg_text_utils"),a=m("../../plot_api/plot_template").arrayEditor,r=m("./constants"),g=m("../../constants/alignment"),u=g.LINE_SPACING,s=g.FROM_TL,h=g.FROM_BR;function l(E){return r.autoMarginIdRoot+E._index}function o(E){return E._index}function p(E,z){var D=y.tester.selectAll("g."+r.labelGroupClass).data(z._visibleSteps);D.enter().append("g").classed(r.labelGroupClass,!0);var j=0,V=0;D.each(function(te){var B=x(d.select(this),{step:te},z).node();if(B){var X=y.bBox(B);V=Math.max(V,X.height),j=Math.max(j,X.width)}}),D.remove();var Z=z._dims={};Z.inputAreaWidth=Math.max(r.railWidth,r.gripHeight);var Q=E._fullLayout._size;Z.lx=Q.l+Q.w*z.x,Z.ly=Q.t+Q.h*(1-z.y),z.lenmode==="fraction"?Z.outerLength=Math.round(Q.w*z.len):Z.outerLength=z.len,Z.inputAreaStart=0,Z.inputAreaLength=Math.round(Z.outerLength-z.pad.l-z.pad.r);var K=(Z.inputAreaLength-2*r.stepInset)/(z._stepCount-1),$=j+r.labelPadding;if(Z.labelStride=Math.max(1,Math.ceil($/K)),Z.labelHeight=V,Z.currentValueMaxWidth=0,Z.currentValueHeight=0,Z.currentValueTotalHeight=0,Z.currentValueMaxLines=1,z.currentvalue.visible){var ne=y.tester.append("g");D.each(function(te){var B=c(ne,z,te.label),X=B.node()&&y.bBox(B.node())||{width:0,height:0},J=n.lineCount(B);Z.currentValueMaxWidth=Math.max(Z.currentValueMaxWidth,Math.ceil(X.width)),Z.currentValueHeight=Math.max(Z.currentValueHeight,Math.ceil(X.height)),Z.currentValueMaxLines=Math.max(Z.currentValueMaxLines,J)}),Z.currentValueTotalHeight=Z.currentValueHeight+z.currentvalue.offset,ne.remove()}Z.height=Z.currentValueTotalHeight+r.tickOffset+z.ticklen+r.labelOffset+Z.labelHeight+z.pad.t+z.pad.b;var H="left";e.isRightAnchor(z)&&(Z.lx-=Z.outerLength,H="right"),e.isCenterAnchor(z)&&(Z.lx-=Z.outerLength/2,H="center");var N="top";e.isBottomAnchor(z)&&(Z.ly-=Z.height,N="bottom"),e.isMiddleAnchor(z)&&(Z.ly-=Z.height/2,N="middle"),Z.outerLength=Math.ceil(Z.outerLength),Z.height=Math.ceil(Z.height),Z.lx=Math.round(Z.lx),Z.ly=Math.round(Z.ly);var U={y:z.y,b:Z.height*h[N],t:Z.height*s[N]};z.lenmode==="fraction"?(U.l=0,U.xl=z.x-z.len*s[H],U.r=0,U.xr=z.x+z.len*h[H]):(U.x=z.x,U.l=Z.outerLength*s[H],U.r=Z.outerLength*h[H]),v.autoMargin(E,l(z),U)}function c(E,z,D){if(z.currentvalue.visible){var j,V,Z=z._dims;switch(z.currentvalue.xanchor){case"right":j=Z.inputAreaLength-r.currentValueInset-Z.currentValueMaxWidth,V="left";break;case"center":j=.5*Z.inputAreaLength,V="middle";break;default:j=r.currentValueInset,V="left"}var Q=e.ensureSingle(E,"text",r.labelClass,function(U){U.attr({"text-anchor":V,"data-notex":1})}),K=z.currentvalue.prefix?z.currentvalue.prefix:"";if(typeof D=="string")K+=D;else{var $=z.steps[z.active].label,ne=z._gd._fullLayout._meta;ne&&($=e.templateString($,ne)),K+=$}z.currentvalue.suffix&&(K+=z.currentvalue.suffix),Q.call(y.font,z.currentvalue.font).text(K).call(n.convertToTspans,z._gd);var H=n.lineCount(Q),N=(Z.currentValueMaxLines+1-H)*z.currentvalue.font.size*u;return n.positionText(Q,j,N),Q}}function i(E,z,D){e.ensureSingle(E,"rect",r.gripRectClass,function(j){j.call(T,z,E,D).style("pointer-events","all")}).attr({width:r.gripWidth,height:r.gripHeight,rx:r.gripRadius,ry:r.gripRadius}).call(w.stroke,D.bordercolor).call(w.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px")}function x(E,z,D){var j=e.ensureSingle(E,"text",r.labelClass,function(Q){Q.attr({"text-anchor":"middle","data-notex":1})}),V=z.step.label,Z=D._gd._fullLayout._meta;return Z&&(V=e.templateString(V,Z)),j.call(y.font,D.font).text(V).call(n.convertToTspans,D._gd),j}function f(E,z){var D=e.ensureSingle(E,"g",r.labelsClass),j=z._dims,V=D.selectAll("g."+r.labelGroupClass).data(j.labelSteps);V.enter().append("g").classed(r.labelGroupClass,!0),V.exit().remove(),V.each(function(Z){var Q=d.select(this);Q.call(x,Z,z),y.setTranslate(Q,A(z,Z.fraction),r.tickOffset+z.ticklen+z.font.size*u+r.labelOffset+j.currentValueTotalHeight)})}function _(E,z,D,j,V){var Z=Math.round(j*(D._stepCount-1)),Q=D._visibleSteps[Z]._index;Q!==D.active&&b(E,z,D,Q,!0,V)}function b(E,z,D,j,V,Z){var Q=D.active;D.active=j,a(E.layout,r.name,D).applyUpdate("active",j);var K=D.steps[D.active];z.call(L,D,Z),z.call(c,D),E.emit("plotly_sliderchange",{slider:D,step:D.steps[D.active],interaction:V,previousActive:Q}),K&&K.method&&V&&(z._nextMethod?(z._nextMethod.step=K,z._nextMethod.doCallback=V,z._nextMethod.doTransition=Z):(z._nextMethod={step:K,doCallback:V,doTransition:Z},z._nextMethodRaf=window.requestAnimationFrame(function(){var $=z._nextMethod.step;$.method&&($.execute&&v.executeAPICommand(E,$.method,$.args),z._nextMethod=null,z._nextMethodRaf=null)})))}function T(E,z,D){var j=D.node(),V=d.select(z);function Z(){return D.data()[0]}function Q(){var K=Z();z.emit("plotly_sliderstart",{slider:K});var $=D.select("."+r.gripRectClass);d.event.stopPropagation(),d.event.preventDefault(),$.call(w.fill,K.activebgcolor);var ne=I(K,d.mouse(j)[0]);function H(){var U=Z(),te=I(U,d.mouse(j)[0]);_(z,D,U,te,!1)}function N(){var U=Z();U._dragging=!1,$.call(w.fill,U.bgcolor),V.on("mouseup",null),V.on("mousemove",null),V.on("touchend",null),V.on("touchmove",null),z.emit("plotly_sliderend",{slider:U,step:U.steps[U.active]})}_(z,D,K,ne,!0),K._dragging=!0,V.on("mousemove",H),V.on("touchmove",H),V.on("mouseup",N),V.on("touchend",N)}E.on("mousedown",Q),E.on("touchstart",Q)}function k(E,z){var D=E.selectAll("rect."+r.tickRectClass).data(z._visibleSteps),j=z._dims;D.enter().append("rect").classed(r.tickRectClass,!0),D.exit().remove(),D.attr({width:z.tickwidth+"px","shape-rendering":"crispEdges"}),D.each(function(V,Z){var Q=Z%j.labelStride==0,K=d.select(this);K.attr({height:Q?z.ticklen:z.minorticklen}).call(w.fill,z.tickcolor),y.setTranslate(K,A(z,Z/(z._stepCount-1))-.5*z.tickwidth,(Q?r.tickOffset:r.minorTickOffset)+j.currentValueTotalHeight)})}function L(E,z,D){for(var j=E.select("rect."+r.gripRectClass),V=0,Z=0;Z<z._stepCount;Z++)if(z._visibleSteps[Z]._index===z.active){V=Z;break}var Q=A(z,V/(z._stepCount-1));if(!z._invokingCommand){var K=j;D&&z.transition.duration>0&&(K=K.transition().duration(z.transition.duration).ease(z.transition.easing)),K.attr("transform",t(Q-.5*r.gripWidth,z._dims.currentValueTotalHeight))}}function A(E,z){var D=E._dims;return D.inputAreaStart+r.stepInset+(D.inputAreaLength-2*r.stepInset)*Math.min(1,Math.max(0,z))}function I(E,z){var D=E._dims;return Math.min(1,Math.max(0,(z-r.stepInset-D.inputAreaStart)/(D.inputAreaLength-2*r.stepInset-2*D.inputAreaStart)))}function P(E,z,D){var j=D._dims,V=e.ensureSingle(E,"rect",r.railTouchRectClass,function(Z){Z.call(T,z,E,D).style("pointer-events","all")});V.attr({width:j.inputAreaLength,height:Math.max(j.inputAreaWidth,r.tickOffset+D.ticklen+j.labelHeight)}).call(w.fill,D.bgcolor).attr("opacity",0),y.setTranslate(V,0,j.currentValueTotalHeight)}function S(E,z){var D=z._dims,j=D.inputAreaLength-2*r.railInset,V=e.ensureSingle(E,"rect",r.railRectClass);V.attr({width:j,height:r.railWidth,rx:r.railRadius,ry:r.railRadius,"shape-rendering":"crispEdges"}).call(w.stroke,z.bordercolor).call(w.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px"),y.setTranslate(V,r.railInset,.5*(D.inputAreaWidth-r.railWidth)+D.currentValueTotalHeight)}G.exports=function(E){var z=E._fullLayout,D=function($,ne){for(var H=$[r.name],N=[],U=0;U<H.length;U++){var te=H[U];te.visible&&(te._gd=ne,N.push(te))}return N}(z,E),j=z._infolayer.selectAll("g."+r.containerClassName).data(D.length>0?[0]:[]);function V($){$._commandObserver&&($._commandObserver.remove(),delete $._commandObserver),v.autoMargin(E,l($))}if(j.enter().append("g").classed(r.containerClassName,!0).style("cursor","ew-resize"),j.exit().each(function(){d.select(this).selectAll("g."+r.groupClassName).each(V)}).remove(),D.length!==0){var Z=j.selectAll("g."+r.groupClassName).data(D,o);Z.enter().append("g").classed(r.groupClassName,!0),Z.exit().each(V).remove();for(var Q=0;Q<D.length;Q++){var K=D[Q];p(E,K)}Z.each(function($){var ne=d.select(this);(function(H){var N=H._dims;N.labelSteps=[];for(var U=H._stepCount,te=0;te<U;te+=N.labelStride)N.labelSteps.push({fraction:te/(U-1),step:H._visibleSteps[te]})})($),v.manageCommandObserver(E,$,$._visibleSteps,function(H){var N=ne.data()[0];N.active!==H.index&&(N._dragging||b(E,ne,N,H.index,!1,!0))}),function(H,N,U){(U.steps[U.active]||{}).visible||(U.active=U._visibleSteps[0]._index),N.call(c,U).call(S,U).call(f,U).call(k,U).call(P,H,U).call(i,H,U);var te=U._dims;y.setTranslate(N,te.lx+U.pad.l,te.ly+U.pad.t),N.call(L,U,!1),N.call(c,U)}(E,d.select(this),$)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(m,G,W){var d=m("./constants");G.exports={moduleType:"component",name:d.name,layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),draw:m("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib"),t=e.strTranslate,n=m("../drawing"),a=m("../color"),r=m("../../lib/svg_text_utils"),g=m("../../constants/interactions"),u=m("../../constants/alignment").OPPOSITE_SIDE,s=/ [XY][0-9]* /;G.exports={draw:function(h,l,o){var p,c=o.propContainer,i=o.propName,x=o.placeholder,f=o.traceIndex,_=o.avoid||{},b=o.attributes,T=o.transform,k=o.containerGroup,L=h._fullLayout,A=1,I=!1,P=c.title,S=(P&&P.text?P.text:"").trim(),E=P&&P.font?P.font:{},z=E.family,D=E.size,j=E.color;i==="title.text"?p="titleText":i.indexOf("axis")!==-1?p="axisTitleText":i.indexOf(!0)&&(p="colorbarTitleText");var V=h._context.edits[p];S===""?A=0:S.replace(s," % ")===x.replace(s," % ")&&(A=.2,I=!0,V||(S="")),o._meta?S=e.templateString(S,o._meta):L._meta&&(S=e.templateString(S,L._meta));var Z,Q=S||V;k||(k=e.ensureSingle(L._infolayer,"g","g-"+l),Z=L._hColorbarMoveTitle);var K=k.selectAll("text").data(Q?[0]:[]);if(K.enter().append("text"),K.text(S).attr("class",l),K.exit().remove(),!Q)return k;function $(N){e.syncOrAsync([ne,H],N)}function ne(N){var U;return!T&&Z&&(T={}),T?(U="",T.rotate&&(U+="rotate("+[T.rotate,b.x,b.y]+")"),(T.offset||Z)&&(U+=t(0,(T.offset||0)-(Z||0)))):U=null,N.attr("transform",U),N.style({"font-family":z,"font-size":d.round(D,2)+"px",fill:a.rgb(j),opacity:A*a.opacity(j),"font-weight":w.fontWeight}).attr(b).call(r.convertToTspans,h),w.previousPromises(h)}function H(N){var U=d.select(N.node().parentNode);if(_&&_.selection&&_.side&&S){U.attr("transform",null);var te=u[_.side],B=_.side==="left"||_.side==="top"?-1:1,X=v(_.pad)?_.pad:2,J=n.bBox(U.node()),ee={left:0,top:0,right:L.width,bottom:L.height},re=_.maxShift||B*(ee[_.side]-J[_.side]),se=0;if(re<0)se=re;else{var oe=_.offsetLeft||0,de=_.offsetTop||0;J.left-=oe,J.right-=oe,J.top-=de,J.bottom-=de,_.selection.each(function(){var ve=n.bBox(this);e.bBoxIntersect(J,ve,X)&&(se=Math.max(se,B*(ve[_.side]-J[te])+X))}),se=Math.min(re,se)}if(se>0||re<0){var ce={left:[-se,0],right:[se,0],top:[0,-se],bottom:[0,se]}[_.side];U.attr("transform",t(ce[0],ce[1]))}}}return K.call($),V&&(S?K.on(".opacity",null):(A=0,I=!0,K.text(x).on("mouseover.opacity",function(){d.select(this).transition().duration(g.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){d.select(this).transition().duration(g.HIDE_PLACEHOLDER).style("opacity",0)})),K.call(r.makeEditable,{gd:h}).on("edit",function(N){f!==void 0?y.call("_guiRestyle",h,i,N,f):y.call("_guiRelayout",h,i,N)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call($)}).on("input",function(N){this.text(N||" ").call(r.positionText,b.x,b.y)})),K.classed("js-placeholder",I),k}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../color/attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll,e=m("../../plots/pad_attributes"),t=m("../../plot_api/plot_template").templatedArray,n=t("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});G.exports=y(t("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:w(e({editType:"arraydraw"}),{}),font:d({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:v.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(m,G,W){G.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("./constants").name,e=w.buttons;function t(a,r,g){function u(s,h){return d.coerce(a,r,w,s,h)}u("visible",v(a,r,{name:"buttons",handleItemDefaults:n}).length>0)&&(u("active"),u("direction"),u("type"),u("showactive"),u("x"),u("y"),d.noneOrAll(a,r,["x","y"]),u("xanchor"),u("yanchor"),u("pad.t"),u("pad.r"),u("pad.b"),u("pad.l"),d.coerceFont(u,"font",g.font),u("bgcolor",g.paper_bgcolor),u("bordercolor"),u("borderwidth"))}function n(a,r){function g(u,s){return d.coerce(a,r,e,u,s)}g("visible",a.method==="skip"||Array.isArray(a.args))&&(g("method"),g("args"),g("args2"),g("label"),g("execute"))}G.exports=function(a,r){v(a,r,{name:y,handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../color"),y=m("../drawing"),e=m("../../lib"),t=m("../../lib/svg_text_utils"),n=m("../../plot_api/plot_template").arrayEditor,a=m("../../constants/alignment").LINE_SPACING,r=m("./constants"),g=m("./scrollbox");function u(A){return A._index}function s(A,I){return+A.attr(r.menuIndexAttrName)===I._index}function h(A,I,P,S,E,z,D,j){I.active=D,n(A.layout,r.name,I).applyUpdate("active",D),I.type==="buttons"?o(A,S,null,null,I):I.type==="dropdown"&&(E.attr(r.menuIndexAttrName,"-1"),l(A,S,E,z,I),j||o(A,S,E,z,I))}function l(A,I,P,S,E){var z=e.ensureSingle(I,"g",r.headerClassName,function(K){K.style("pointer-events","all")}),D=E._dims,j=E.active,V=E.buttons[j]||r.blankHeaderOpts,Z={y:E.pad.t,yPad:0,x:E.pad.l,xPad:0,index:0},Q={width:D.headerWidth,height:D.headerHeight};z.call(p,E,V,A).call(k,E,Z,Q),e.ensureSingle(I,"text",r.headerArrowClassName,function(K){K.attr("text-anchor","end").call(y.font,E.font).text(r.arrowSymbol[E.direction])}).attr({x:D.headerWidth-r.arrowOffsetX+E.pad.l,y:D.headerHeight/2+r.textOffsetY+E.pad.t}),z.on("click",function(){P.call(L,String(s(P,E)?-1:E._index)),o(A,I,P,S,E)}),z.on("mouseover",function(){z.call(f)}),z.on("mouseout",function(){z.call(_,E)}),y.setTranslate(I,D.lx,D.ly)}function o(A,I,P,S,E){P||(P=I).attr("pointer-events","all");var z=function(U){return+U.attr(r.menuIndexAttrName)==-1}(P)&&E.type!=="buttons"?[]:E.buttons,D=E.type==="dropdown"?r.dropdownButtonClassName:r.buttonClassName,j=P.selectAll("g."+D).data(e.filterVisible(z)),V=j.enter().append("g").classed(D,!0),Z=j.exit();E.type==="dropdown"?(V.attr("opacity","0").transition().attr("opacity","1"),Z.transition().attr("opacity","0").remove()):Z.remove();var Q=0,K=0,$=E._dims,ne=["up","down"].indexOf(E.direction)!==-1;E.type==="dropdown"&&(ne?K=$.headerHeight+r.gapButtonHeader:Q=$.headerWidth+r.gapButtonHeader),E.type==="dropdown"&&E.direction==="up"&&(K=-r.gapButtonHeader+r.gapButton-$.openHeight),E.type==="dropdown"&&E.direction==="left"&&(Q=-r.gapButtonHeader+r.gapButton-$.openWidth);var H={x:$.lx+Q+E.pad.l,y:$.ly+K+E.pad.t,yPad:r.gapButton,xPad:r.gapButton,index:0},N={l:H.x+E.borderwidth,t:H.y+E.borderwidth};j.each(function(U,te){var B=d.select(this);B.call(p,E,U,A).call(k,E,H),B.on("click",function(){d.event.defaultPrevented||(U.execute&&(U.args2&&E.active===te?(h(A,E,0,I,P,S,-1),v.executeAPICommand(A,U.method,U.args2)):(h(A,E,0,I,P,S,te),v.executeAPICommand(A,U.method,U.args))),A.emit("plotly_buttonclicked",{menu:E,button:U,active:E.active}))}),B.on("mouseover",function(){B.call(f)}),B.on("mouseout",function(){B.call(_,E),j.call(x,E)})}),j.call(x,E),ne?(N.w=Math.max($.openWidth,$.headerWidth),N.h=H.y-N.t):(N.w=H.x-N.l,N.h=Math.max($.openHeight,$.headerHeight)),N.direction=E.direction,S&&(j.size()?function(U,te,B,X,J,ee){var re,se,oe,de=J.direction,ce=de==="up"||de==="down",ve=J._dims,Ae=J.active;if(ce)for(se=0,oe=0;oe<Ae;oe++)se+=ve.heights[oe]+r.gapButton;else for(re=0,oe=0;oe<Ae;oe++)re+=ve.widths[oe]+r.gapButton;X.enable(ee,re,se),X.hbar&&X.hbar.attr("opacity","0").transition().attr("opacity","1"),X.vbar&&X.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,E,N):function(U){var te=!!U.hbar,B=!!U.vbar;te&&U.hbar.transition().attr("opacity","0").each("end",function(){te=!1,B||U.disable()}),B&&U.vbar.transition().attr("opacity","0").each("end",function(){B=!1,te||U.disable()})}(S))}function p(A,I,P,S){A.call(c,I).call(i,I,P,S)}function c(A,I){e.ensureSingle(A,"rect",r.itemRectClassName,function(P){P.attr({rx:r.rx,ry:r.ry,"shape-rendering":"crispEdges"})}).call(w.stroke,I.bordercolor).call(w.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px")}function i(A,I,P,S){var E=e.ensureSingle(A,"text",r.itemTextClassName,function(j){j.attr({"text-anchor":"start","data-notex":1})}),z=P.label,D=S._fullLayout._meta;D&&(z=e.templateString(z,D)),E.call(y.font,I.font).text(z).call(t.convertToTspans,S)}function x(A,I){var P=I.active;A.each(function(S,E){var z=d.select(this);E===P&&I.showactive&&z.select("rect."+r.itemRectClassName).call(w.fill,r.activeColor)})}function f(A){A.select("rect."+r.itemRectClassName).call(w.fill,r.hoverColor)}function _(A,I){A.select("rect."+r.itemRectClassName).call(w.fill,I.bgcolor)}function b(A,I){var P=I._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=y.tester.selectAll("g."+r.dropdownButtonClassName).data(e.filterVisible(I.buttons));S.enter().append("g").classed(r.dropdownButtonClassName,!0);var E=["up","down"].indexOf(I.direction)!==-1;S.each(function(Q,K){var $=d.select(this);$.call(p,I,Q,A);var ne=$.select("."+r.itemTextClassName),H=ne.node()&&y.bBox(ne.node()).width,N=Math.max(H+r.textPadX,r.minWidth),U=I.font.size*a,te=t.lineCount(ne),B=Math.max(U*te,r.minHeight)+r.textOffsetY;B=Math.ceil(B),N=Math.ceil(N),P.widths[K]=N,P.heights[K]=B,P.height1=Math.max(P.height1,B),P.width1=Math.max(P.width1,N),E?(P.totalWidth=Math.max(P.totalWidth,N),P.openWidth=P.totalWidth,P.totalHeight+=B+r.gapButton,P.openHeight+=B+r.gapButton):(P.totalWidth+=N+r.gapButton,P.openWidth+=N+r.gapButton,P.totalHeight=Math.max(P.totalHeight,B),P.openHeight=P.totalHeight)}),E?P.totalHeight-=r.gapButton:P.totalWidth-=r.gapButton,P.headerWidth=P.width1+r.arrowPadX,P.headerHeight=P.height1,I.type==="dropdown"&&(E?(P.width1+=r.arrowPadX,P.totalHeight=P.height1):P.totalWidth=P.width1,P.totalWidth+=r.arrowPadX),S.remove();var z=P.totalWidth+I.pad.l+I.pad.r,D=P.totalHeight+I.pad.t+I.pad.b,j=A._fullLayout._size;P.lx=j.l+j.w*I.x,P.ly=j.t+j.h*(1-I.y);var V="left";e.isRightAnchor(I)&&(P.lx-=z,V="right"),e.isCenterAnchor(I)&&(P.lx-=z/2,V="center");var Z="top";e.isBottomAnchor(I)&&(P.ly-=D,Z="bottom"),e.isMiddleAnchor(I)&&(P.ly-=D/2,Z="middle"),P.totalWidth=Math.ceil(P.totalWidth),P.totalHeight=Math.ceil(P.totalHeight),P.lx=Math.round(P.lx),P.ly=Math.round(P.ly),v.autoMargin(A,T(I),{x:I.x,y:I.y,l:z*({right:1,center:.5}[V]||0),r:z*({left:1,center:.5}[V]||0),b:D*({top:1,middle:.5}[Z]||0),t:D*({bottom:1,middle:.5}[Z]||0)})}function T(A){return r.autoMarginIdRoot+A._index}function k(A,I,P,S){S=S||{};var E=A.select("."+r.itemRectClassName),z=A.select("."+r.itemTextClassName),D=I.borderwidth,j=P.index,V=I._dims;y.setTranslate(A,D+P.x,D+P.y);var Z=["up","down"].indexOf(I.direction)!==-1,Q=S.height||(Z?V.heights[j]:V.height1);E.attr({x:0,y:0,width:S.width||(Z?V.width1:V.widths[j]),height:Q});var K=I.font.size*a,$=(t.lineCount(z)-1)*K/2;t.positionText(z,r.textOffsetX,Q/2-$+r.textOffsetY),Z?P.y+=V.heights[j]+P.yPad:P.x+=V.widths[j]+P.xPad,P.index++}function L(A,I){A.attr(r.menuIndexAttrName,I||"-1").selectAll("g."+r.dropdownButtonClassName).remove()}G.exports=function(A){var I=A._fullLayout,P=e.filterVisible(I[r.name]);function S(K){v.autoMargin(A,T(K))}var E=I._menulayer.selectAll("g."+r.containerClassName).data(P.length>0?[0]:[]);if(E.enter().append("g").classed(r.containerClassName,!0).style("cursor","pointer"),E.exit().each(function(){d.select(this).selectAll("g."+r.headerGroupClassName).each(S)}).remove(),P.length!==0){var z=E.selectAll("g."+r.headerGroupClassName).data(P,u);z.enter().append("g").classed(r.headerGroupClassName,!0);for(var D=e.ensureSingle(E,"g",r.dropdownButtonGroupClassName,function(K){K.style("pointer-events","all")}),j=0;j<P.length;j++){var V=P[j];b(A,V)}var Z="updatemenus"+I._uid,Q=new g(A,D,Z);z.enter().size()&&(D.node().parentNode.appendChild(D.node()),D.call(L)),z.exit().each(function(K){D.call(L),S(K)}).remove(),z.each(function(K){var $=d.select(this),ne=K.type==="dropdown"?D:null;v.manageCommandObserver(A,K,K.buttons,function(H){h(A,K,K.buttons[H.index],$,ne,Q,H.index,!0)}),K.type==="dropdown"?(l(A,$,D,Q,K),s(D,K)&&o(A,$,D,Q,K)):o(A,$,null,null,K)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(m,G,W){arguments[4][475][0].apply(W,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(m,G,W){G.exports=e;var d=m("@plotly/d3"),v=m("../color"),w=m("../drawing"),y=m("../../lib");function e(t,n,a){this.gd=t,this.container=n,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(t,n,a){var r=this.gd._fullLayout,g=r.width,u=r.height;this.position=t;var s,h,l,o,p=this.position.l,c=this.position.w,i=this.position.t,x=this.position.h,f=this.position.direction,_=f==="down",b=f==="left",T=f==="up",k=c,L=x;_||b||f==="right"||T||(this.position.direction="down",_=!0),_||T?(h=(s=p)+k,_?(l=i,L=(o=Math.min(l+L,u))-l):L=(o=i+L)-(l=Math.max(o-L,0))):(o=(l=i)+L,b?k=(h=p+k)-(s=Math.max(h-k,0)):(s=p,k=(h=Math.min(s+k,g))-s)),this._box={l:s,t:l,w:k,h:L};var A=c>k,I=e.barLength+2*e.barPad,P=e.barWidth+2*e.barPad,S=p,E=i+x;E+P>u&&(E=u-P);var z=this.container.selectAll("rect.scrollbar-horizontal").data(A?[0]:[]);z.exit().on(".drag",null).remove(),z.enter().append("rect").classed("scrollbar-horizontal",!0).call(v.fill,e.barColor),A?(this.hbar=z.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:E,width:I,height:P}),this._hbarXMin=S+I/2,this._hbarTranslateMax=k-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var D=x>L,j=e.barWidth+2*e.barPad,V=e.barLength+2*e.barPad,Z=p+c,Q=i;Z+j>g&&(Z=g-j);var K=this.container.selectAll("rect.scrollbar-vertical").data(D?[0]:[]);K.exit().on(".drag",null).remove(),K.enter().append("rect").classed("scrollbar-vertical",!0).call(v.fill,e.barColor),D?(this.vbar=K.attr({rx:e.barRadius,ry:e.barRadius,x:Z,y:Q,width:j,height:V}),this._vbarYMin=Q+V/2,this._vbarTranslateMax=L-V):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var $=this.id,ne=s-.5,H=D?h+j+.5:h+.5,N=l-.5,U=A?o+P+.5:o+.5,te=r._topdefs.selectAll("#"+$).data(A||D?[0]:[]);if(te.exit().remove(),te.enter().append("clipPath").attr("id",$).append("rect"),A||D?(this._clipRect=te.select("rect").attr({x:Math.floor(ne),y:Math.floor(N),width:Math.ceil(H)-Math.floor(ne),height:Math.ceil(U)-Math.floor(N)}),this.container.call(w.setClipUrl,$,this.gd),this.bg.attr({x:p,y:i,width:c,height:x})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(w.setClipUrl,null),delete this._clipRect),A||D){var B=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(B);var X=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault(),d.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));A&&this.hbar.on(".drag",null).call(X),D&&this.vbar.on(".drag",null).call(X)}this.setTranslate(n,a)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(w.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var t=this.translateX,n=this.translateY;this.hbar&&(t-=d.event.dx),this.vbar&&(n-=d.event.dy),this.setTranslate(t,n)},e.prototype._onBoxWheel=function(){var t=this.translateX,n=this.translateY;this.hbar&&(t+=d.event.deltaY),this.vbar&&(n+=d.event.deltaY),this.setTranslate(t,n)},e.prototype._onBarDrag=function(){var t=this.translateX,n=this.translateY;if(this.hbar){var a=t+this._hbarXMin,r=a+this._hbarTranslateMax;t=(y.constrain(d.event.x,a,r)-a)/(r-a)*(this.position.w-this._box.w)}if(this.vbar){var g=n+this._vbarYMin,u=g+this._vbarTranslateMax;n=(y.constrain(d.event.y,g,u)-g)/(u-g)*(this.position.h-this._box.h)}this.setTranslate(t,n)},e.prototype.setTranslate=function(t,n){var a=this.position.w-this._box.w,r=this.position.h-this._box.h;if(t=y.constrain(t||0,0,a),n=y.constrain(n||0,0,r),this.translateX=t,this.translateY=n,this.container.call(w.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-n),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+n-.5)}),this.hbar){var g=t/a;this.hbar.call(w.setTranslate,t+g*this._hbarTranslateMax,n)}if(this.vbar){var u=n/r;this.vbar.call(w.setTranslate,t,n+u*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(m,G,W){G.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(m,G,W){G.exports={axisRefDescription:function(d,v,w){return["If set to a",d,"axis id (e.g. *"+d+"* or","*"+d+"2*), the `"+d+"` position refers to a",d,"coordinate. If set to *paper*, the `"+d+"`","position refers to the distance from the",v,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",v,"("+w+"). If set to a",d,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",v,"of the domain of that axis: e.g.,","*"+d+"2 domain* refers to the domain of the second",d," axis and a",d,"position of 0.5 refers to the","point between the",v,"and the",w,"of the domain of the","second",d,"axis."].join(" ")}}},{}],485:[function(m,G,W){G.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(m,G,W){G.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(m,G,W){G.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(m,G,W){G.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(m,G,W){G.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(m,G,W){G.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(m,G,W){G.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(m,G,W){W.xmlns="http://www.w3.org/2000/xmlns/",W.svg="http://www.w3.org/2000/svg",W.xlink="http://www.w3.org/1999/xlink",W.svgAttrs={xmlns:W.svg,"xmlns:xlink":W.xlink}},{}],493:[function(m,G,W){W.version=m("./version").version,m("native-promise-only"),m("../build/plotcss");for(var d=m("./registry"),v=W.register=d.register,w=m("./plot_api"),y=Object.keys(w),e=0;e<y.length;e++){var t=y[e];t.charAt(0)!=="_"&&(W[t]=w[t]),v({moduleType:"apiMethod",name:t,fn:w[t]})}v(m("./traces/scatter")),v([m("./components/legend"),m("./components/fx"),m("./components/annotations"),m("./components/annotations3d"),m("./components/selections"),m("./components/shapes"),m("./components/images"),m("./components/updatemenus"),m("./components/sliders"),m("./components/rangeslider"),m("./components/rangeselector"),m("./components/grid"),m("./components/errorbars"),m("./components/colorscale"),m("./components/colorbar"),m("./components/modebar")]),v([m("./locale-en"),m("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(v(window.PlotlyLocales),delete window.PlotlyLocales),W.Icons=m("./fonts/ploticon");var n=m("./components/fx"),a=m("./plots/plots");W.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},W.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},W.Snapshot=m("./snapshot"),W.PlotSchema=m("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(m,G,W){G.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(m,G,W){W.isLeftAnchor=function(d){return d.xanchor==="left"||d.xanchor==="auto"&&d.x<=1/3},W.isCenterAnchor=function(d){return d.xanchor==="center"||d.xanchor==="auto"&&d.x>1/3&&d.x<2/3},W.isRightAnchor=function(d){return d.xanchor==="right"||d.xanchor==="auto"&&d.x>=2/3},W.isTopAnchor=function(d){return d.yanchor==="top"||d.yanchor==="auto"&&d.y>=2/3},W.isMiddleAnchor=function(d){return d.yanchor==="middle"||d.yanchor==="auto"&&d.y>1/3&&d.y<2/3},W.isBottomAnchor=function(d){return d.yanchor==="bottom"||d.yanchor==="auto"&&d.y<=1/3}},{}],496:[function(m,G,W){var d=m("./mod"),v=d.mod,w=d.modHalf,y=Math.PI,e=2*y;function t(g){return Math.abs(g[1]-g[0])>e-1e-14}function n(g,u){return w(u-g,e)}function a(g,u){if(t(u))return!0;var s,h;u[0]<u[1]?(s=u[0],h=u[1]):(s=u[1],h=u[0]),(s=v(s,e))>(h=v(h,e))&&(h+=e);var l=v(g,e),o=l+e;return l>=s&&l<=h||o>=s&&o<=h}function r(g,u,s,h,l,o,p){l=l||0,o=o||0;var c,i,x,f,_,b=t([s,h]);function T(I,P){return[I*Math.cos(P)+l,o-I*Math.sin(P)]}b?(c=0,i=y,x=e):s<h?(c=s,x=h):(c=h,x=s),g<u?(f=g,_=u):(f=u,_=g);var k,L=Math.abs(x-c)<=y?0:1;function A(I,P,S){return"A"+[I,I]+" "+[0,L,S]+" "+T(I,P)}return b?k=f===null?"M"+T(_,c)+A(_,i,0)+A(_,x,0)+"Z":"M"+T(f,c)+A(f,i,0)+A(f,x,0)+"ZM"+T(_,c)+A(_,i,1)+A(_,x,1)+"Z":f===null?(k="M"+T(_,c)+A(_,x,0),p&&(k+="L0,0Z")):k="M"+T(f,c)+"L"+T(_,c)+A(_,x,0)+"L"+T(f,x)+A(f,c,1)+"Z",k}G.exports={deg2rad:function(g){return g/180*y},rad2deg:function(g){return g/y*180},angleDelta:n,angleDist:function(g,u){return Math.abs(n(g,u))},isFullCircle:t,isAngleInsideSector:a,isPtInsideSector:function(g,u,s,h){return!!a(u,h)&&(s[0]<s[1]?(l=s[0],o=s[1]):(l=s[1],o=s[0]),g>=l&&g<=o);var l,o},pathArc:function(g,u,s,h,l){return r(null,g,u,s,h,l,0)},pathSector:function(g,u,s,h,l){return r(null,g,u,s,h,l,1)},pathAnnulus:function(g,u,s,h,l,o){return r(g,u,s,h,l,o,1)}}},{"./mod":522}],497:[function(m,G,W){var d=Array.isArray,v=ArrayBuffer,w=DataView;function y(n){return v.isView(n)&&!(n instanceof w)}function e(n){return d(n)||y(n)}function t(n,a,r){if(e(n)){if(e(n[0])){for(var g=r,u=0;u<n.length;u++)g=a(g,n[u].length);return g}return n.length}return 0}W.isTypedArray=y,W.isArrayOrTypedArray=e,W.isArray1D=function(n){return!e(n[0])},W.ensureArray=function(n,a){return d(n)||(n=[]),n.length=a,n},W.concat=function(){var n,a,r,g,u,s,h,l,o=[],p=!0,c=0;for(r=0;r<arguments.length;r++)(s=(g=arguments[r]).length)&&(a?o.push(g):(a=g,u=s),d(g)?n=!1:(p=!1,c?n!==g.constructor&&(n=!1):n=g.constructor),c+=s);if(!c)return[];if(!o.length)return a;if(p)return a.concat.apply(a,o);if(n){for((h=new n(c)).set(a),r=0;r<o.length;r++)g=o[r],h.set(g,u),u+=g.length;return h}for(h=new Array(c),l=0;l<a.length;l++)h[l]=a[l];for(r=0;r<o.length;r++){for(g=o[r],l=0;l<g.length;l++)h[u+l]=g[l];u+=l}return h},W.maxRowLength=function(n){return t(n,Math.max,0)},W.minRowLength=function(n){return t(n,Math.min,1/0)}},{}],498:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../constants/numerical").BADNUM,w=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;G.exports=function(y){return typeof y=="string"&&(y=y.replace(w,"")),d(y)?Number(y):v}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(m,G,W){G.exports=function(d){var v=d._fullLayout;v._glcanvas&&v._glcanvas.size()&&v._glcanvas.each(function(w){w.regl&&w.regl.clear({color:!0,depth:!0})})}},{}],500:[function(m,G,W){G.exports=function(d){d._responsiveChartHandler&&(window.removeEventListener("resize",d._responsiveChartHandler),delete d._responsiveChartHandler)}},{}],501:[function(m,G,W){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../plots/attributes"),y=m("../components/colorscale/scales"),e=m("../components/color"),t=m("../constants/interactions").DESELECTDIM,n=m("./nested_property"),a=m("./regex").counter,r=m("./mod").modHalf,g=m("./array").isArrayOrTypedArray;function u(s,h){var l=W.valObjectMeta[h.valType];if(h.arrayOk&&g(s))return!0;if(l.validateFunction)return l.validateFunction(s,h);var o={},p=o,c={set:function(i){p=i}};return l.coerceFunction(s,c,o,h),p!==o}W.valObjectMeta={data_array:{coerceFunction:function(s,h,l){g(s)?h.set(s):l!==void 0&&h.set(l)}},enumerated:{coerceFunction:function(s,h,l,o){o.coerceNumber&&(s=+s),o.values.indexOf(s)===-1?h.set(l):h.set(s)},validateFunction:function(s,h){h.coerceNumber&&(s=+s);for(var l=h.values,o=0;o<l.length;o++){var p=String(l[o]);if(p.charAt(0)==="/"&&p.charAt(p.length-1)==="/"){if(new RegExp(p.substr(1,p.length-2)).test(s))return!0}else if(s===l[o])return!0}return!1}},boolean:{coerceFunction:function(s,h,l){s===!0||s===!1?h.set(s):h.set(l)}},number:{coerceFunction:function(s,h,l,o){!d(s)||o.min!==void 0&&s<o.min||o.max!==void 0&&s>o.max?h.set(l):h.set(+s)}},integer:{coerceFunction:function(s,h,l,o){s%1||!d(s)||o.min!==void 0&&s<o.min||o.max!==void 0&&s>o.max?h.set(l):h.set(+s)}},string:{coerceFunction:function(s,h,l,o){if(typeof s!="string"){var p=typeof s=="number";o.strict!==!0&&p?h.set(String(s)):h.set(l)}else o.noBlank&&!s?h.set(l):h.set(s)}},color:{coerceFunction:function(s,h,l){v(s).isValid()?h.set(s):h.set(l)}},colorlist:{coerceFunction:function(s,h,l){Array.isArray(s)&&s.length&&s.every(function(o){return v(o).isValid()})?h.set(s):h.set(l)}},colorscale:{coerceFunction:function(s,h,l){h.set(y.get(s,l))}},angle:{coerceFunction:function(s,h,l){s==="auto"?h.set("auto"):d(s)?h.set(r(+s,360)):h.set(l)}},subplotid:{coerceFunction:function(s,h,l,o){var p=o.regex||a(l);typeof s=="string"&&p.test(s)?h.set(s):h.set(l)},validateFunction:function(s,h){var l=h.dflt;return s===l||typeof s=="string"&&!!a(l).test(s)}},flaglist:{coerceFunction:function(s,h,l,o){if((o.extras||[]).indexOf(s)===-1)if(typeof s=="string"){for(var p=s.split("+"),c=0;c<p.length;){var i=p[c];o.flags.indexOf(i)===-1||p.indexOf(i)<c?p.splice(c,1):c++}p.length?h.set(p.join("+")):h.set(l)}else h.set(l);else h.set(s)}},any:{coerceFunction:function(s,h,l){s===void 0?h.set(l):h.set(s)}},info_array:{coerceFunction:function(s,h,l,o){function p(E,z,D){var j,V={set:function(Z){j=Z}};return D===void 0&&(D=z.dflt),W.valObjectMeta[z.valType].coerceFunction(E,V,D,z),j}var c=o.dimensions===2||o.dimensions==="1-2"&&Array.isArray(s)&&Array.isArray(s[0]);if(Array.isArray(s)){var i,x,f,_,b,T,k=o.items,L=[],A=Array.isArray(k),I=A&&c&&Array.isArray(k[0]),P=c&&A&&!I,S=A&&!P?k.length:s.length;if(l=Array.isArray(l)?l:[],c)for(i=0;i<S;i++)for(L[i]=[],f=Array.isArray(s[i])?s[i]:[],b=P?k.length:A?k[i].length:f.length,x=0;x<b;x++)_=P?k[x]:A?k[i][x]:k,(T=p(f[x],_,(l[i]||[])[x]))!==void 0&&(L[i][x]=T);else for(i=0;i<S;i++)(T=p(s[i],A?k[i]:k,l[i]))!==void 0&&(L[i]=T);h.set(L)}else h.set(l)},validateFunction:function(s,h){if(!Array.isArray(s))return!1;var l=h.items,o=Array.isArray(l),p=h.dimensions===2;if(!h.freeLength&&s.length!==l.length)return!1;for(var c=0;c<s.length;c++)if(p){if(!Array.isArray(s[c])||!h.freeLength&&s[c].length!==l[c].length)return!1;for(var i=0;i<s[c].length;i++)if(!u(s[c][i],o?l[c][i]:l))return!1}else if(!u(s[c],o?l[c]:l))return!1;return!0}}},W.coerce=function(s,h,l,o,p){var c=n(l,o).get(),i=n(s,o),x=n(h,o),f=i.get(),_=h._template;if(f===void 0&&_&&(f=n(_,o).get(),_=0),p===void 0&&(p=c.dflt),c.arrayOk&&g(f))return x.set(f),f;var b=W.valObjectMeta[c.valType].coerceFunction;b(f,x,p,c);var T=x.get();return _&&T===p&&!u(f,c)&&(b(f=n(_,o).get(),x,p,c),T=x.get()),T},W.coerce2=function(s,h,l,o,p){var c=n(s,o),i=W.coerce(s,h,l,o,p),x=c.get();return x!=null&&i},W.coerceFont=function(s,h,l){var o={};return l=l||{},o.family=s(h+".family",l.family),o.size=s(h+".size",l.size),o.color=s(h+".color",l.color),o},W.coercePattern=function(s,h,l,o){if(s(h+".shape")){s(h+".solidity"),s(h+".size");var p=s(h+".fillmode")==="overlay";if(!o){var c=s(h+".bgcolor",p?l:void 0);s(h+".fgcolor",p?e.contrast(c):l)}s(h+".fgopacity",p?.5:1)}},W.coerceHoverinfo=function(s,h,l){var o,p=h._module.attributes,c=p.hoverinfo?p:w,i=c.hoverinfo;if(l._dataLength===1){var x=i.dflt==="all"?i.flags.slice():i.dflt.split("+");x.splice(x.indexOf("name"),1),o=x.join("+")}return W.coerce(s,h,c,"hoverinfo",o)},W.coerceSelectionMarkerOpacity=function(s,h){if(s.marker){var l,o,p=s.marker.opacity;p!==void 0&&(g(p)||s.selected||s.unselected||(l=p,o=t*p),h("selected.marker.opacity",l),h("unselected.marker.opacity",o))}},W.validate=u},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(m,G,W){var d,v,w=m("d3-time-format").timeFormat,y=m("fast-isnumeric"),e=m("./loggers"),t=m("./mod").mod,n=m("../constants/numerical"),a=n.BADNUM,r=n.ONEDAY,g=n.ONEHOUR,u=n.ONEMIN,s=n.ONESEC,h=n.EPOCHJD,l=m("../registry"),o=m("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,c=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,i=new Date().getFullYear()-70;function x(z){return z&&l.componentsRegistry.calendars&&typeof z=="string"&&z!=="gregorian"}function f(z,D){return String(z+Math.pow(10,D)).substr(1)}W.dateTick0=function(z,D){var j=function(Z,Q){return x(Z)?Q?l.getComponentMethod("calendars","CANONICAL_SUNDAY")[Z]:l.getComponentMethod("calendars","CANONICAL_TICK")[Z]:Q?"2000-01-02":"2000-01-01"}(z,!!D);if(D<2)return j;var V=W.dateTime2ms(j,z);return V+=r*(D-1),W.ms2DateTime(V,0,z)},W.dfltRange=function(z){return x(z)?l.getComponentMethod("calendars","DFLTRANGE")[z]:["2000-01-01","2001-01-01"]},W.isJSDate=function(z){return typeof z=="object"&&z!==null&&typeof z.getTime=="function"},W.dateTime2ms=function(z,D){if(W.isJSDate(z)){var j=z.getTimezoneOffset()*u,V=(z.getUTCMinutes()-z.getMinutes())*u+(z.getUTCSeconds()-z.getSeconds())*s+(z.getUTCMilliseconds()-z.getMilliseconds());if(V){var Z=3*u;j=j-Z/2+t(V-j+Z/2,Z)}return(z=Number(z)-j)>=d&&z<=v?z:a}if(typeof z!="string"&&typeof z!="number")return a;z=String(z);var Q=x(D),K=z.charAt(0);!Q||K!=="G"&&K!=="g"||(z=z.substr(1),D="");var $=Q&&D.substr(0,7)==="chinese",ne=z.match($?c:p);if(!ne)return a;var H=ne[1],N=ne[3]||"1",U=Number(ne[5]||1),te=Number(ne[7]||0),B=Number(ne[9]||0),X=Number(ne[11]||0);if(Q){if(H.length===2)return a;var J;H=Number(H);try{var ee=l.getComponentMethod("calendars","getCal")(D);if($){var re=N.charAt(N.length-1)==="i";N=parseInt(N,10),J=ee.newDate(H,ee.toMonthIndex(H,N,re),U)}else J=ee.newDate(H,Number(N),U)}catch{return a}return J?(J.toJD()-h)*r+te*g+B*u+X*s:a}H=H.length===2?(Number(H)+2e3-i)%100+i:Number(H),N-=1;var se=new Date(Date.UTC(2e3,N,U,te,B));return se.setUTCFullYear(H),se.getUTCMonth()!==N||se.getUTCDate()!==U?a:se.getTime()+X*s},d=W.MIN_MS=W.dateTime2ms("-9999"),v=W.MAX_MS=W.dateTime2ms("9999-12-31 23:59:59.9999"),W.isDateTime=function(z,D){return W.dateTime2ms(z,D)!==a};var _=90*r,b=3*g,T=5*u;function k(z,D,j,V,Z){if((D||j||V||Z)&&(z+=" "+f(D,2)+":"+f(j,2),(V||Z)&&(z+=":"+f(V,2),Z))){for(var Q=4;Z%10==0;)Q-=1,Z/=10;z+="."+f(Z,Q)}return z}W.ms2DateTime=function(z,D,j){if(typeof z!="number"||!(z>=d&&z<=v))return a;D||(D=0);var V,Z,Q,K,$,ne,H=Math.floor(10*t(z+.05,1)),N=Math.round(z-H/10);if(x(j)){var U=Math.floor(N/r)+h,te=Math.floor(t(z,r));try{V=l.getComponentMethod("calendars","getCal")(j).fromJD(U).formatDate("yyyy-mm-dd")}catch{V=o("G%Y-%m-%d")(new Date(N))}if(V.charAt(0)==="-")for(;V.length<11;)V="-0"+V.substr(1);else for(;V.length<10;)V="0"+V;Z=D<_?Math.floor(te/g):0,Q=D<_?Math.floor(te%g/u):0,K=D<b?Math.floor(te%u/s):0,$=D<T?te%s*10+H:0}else ne=new Date(N),V=o("%Y-%m-%d")(ne),Z=D<_?ne.getUTCHours():0,Q=D<_?ne.getUTCMinutes():0,K=D<b?ne.getUTCSeconds():0,$=D<T?10*ne.getUTCMilliseconds()+H:0;return k(V,Z,Q,K,$)},W.ms2DateTimeLocal=function(z){if(!(z>=d+r&&z<=v-r))return a;var D=Math.floor(10*t(z+.05,1)),j=new Date(Math.round(z-D/10));return k(w("%Y-%m-%d")(j),j.getHours(),j.getMinutes(),j.getSeconds(),10*j.getUTCMilliseconds()+D)},W.cleanDate=function(z,D,j){if(z===a)return D;if(W.isJSDate(z)||typeof z=="number"&&isFinite(z)){if(x(j))return e.error("JS Dates and milliseconds are incompatible with world calendars",z),D;if(!(z=W.ms2DateTimeLocal(+z))&&D!==void 0)return D}else if(!W.isDateTime(z,j))return e.error("unrecognized date",z),D;return z};var L=/%\d?f/g,A=/%h/g,I={1:"1",2:"1",3:"2",4:"2"};function P(z,D,j,V){z=z.replace(L,function(Q){var K=Math.min(+Q.charAt(1)||6,6);return(D/1e3%1+2).toFixed(K).substr(2).replace(/0+$/,"")||"0"});var Z=new Date(Math.floor(D+.05));if(z=z.replace(A,function(){return I[j("%q")(Z)]}),x(V))try{z=l.getComponentMethod("calendars","worldCalFmt")(z,D,V)}catch{return"Invalid"}return j(z)(Z)}var S=[59,59.9,59.99,59.999,59.9999];W.formatDate=function(z,D,j,V,Z,Q){if(Z=x(Z)&&Z,!D)if(j==="y")D=Q.year;else if(j==="m")D=Q.month;else{if(j!=="d")return function(K,$){var ne=t(K+.05,r),H=f(Math.floor(ne/g),2)+":"+f(t(Math.floor(ne/u),60),2);if($!=="M"){y($)||($=0);var N=(100+Math.min(t(K/s,60),S[$])).toFixed($).substr(1);$>0&&(N=N.replace(/0+$/,"").replace(/[\.]$/,"")),H+=":"+N}return H}(z,j)+`
`+P(Q.dayMonthYear,z,V,Z);D=Q.dayMonth+`
`+Q.year}return P(D,z,V,Z)};var E=3*r;W.incrementMonth=function(z,D,j){j=x(j)&&j;var V=t(z,r);if(z=Math.round(z-V),j)try{var Z=Math.round(z/r)+h,Q=l.getComponentMethod("calendars","getCal")(j),K=Q.fromJD(Z);return D%12?Q.add(K,D,"m"):Q.add(K,D/12,"y"),(K.toJD()-h)*r+V}catch{e.error("invalid ms "+z+" in calendar "+j)}var $=new Date(z+E);return $.setUTCMonth($.getUTCMonth()+D)+V-E},W.findExactDates=function(z,D){for(var j,V,Z=0,Q=0,K=0,$=0,ne=x(D)&&l.getComponentMethod("calendars","getCal")(D),H=0;H<z.length;H++)if(V=z[H],y(V)){if(!(V%r))if(ne)try{(j=ne.fromJD(V/r+h)).day()===1?j.month()===1?Z++:Q++:K++}catch{}else(j=new Date(V)).getUTCDate()===1?j.getUTCMonth()===0?Z++:Q++:K++}else $++;K+=Q+=Z;var N=z.length-$;return{exactYears:Z/N,exactMonths:Q/N,exactDays:K/N}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(m,G,W){var d=m("@plotly/d3"),v=m("./loggers"),w=m("./matrix"),y=m("gl-mat4");function e(g){var u=g&&g.parentNode;u&&u.removeChild(g)}function t(g,u,s){var h="plotly.js-style-"+g,l=document.getElementById(h);l||((l=document.createElement("style")).setAttribute("id",h),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var o=l.sheet;o.insertRule?o.insertRule(u+"{"+s+"}",0):o.addRule?o.addRule(u,s,0):v.warn("addStyleRule failed")}function n(g){var u=window.getComputedStyle(g,null),s=u.getPropertyValue("-webkit-transform")||u.getPropertyValue("-moz-transform")||u.getPropertyValue("-ms-transform")||u.getPropertyValue("-o-transform")||u.getPropertyValue("transform");return s==="none"?null:s.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(h){return+h})}function a(g){for(var u=[];r(g);)u.push(g),g=g.parentNode;return u}function r(g){return g&&(g instanceof Element||g instanceof HTMLElement)}G.exports={getGraphDiv:function(g){var u;if(typeof g=="string"){if((u=document.getElementById(g))===null)throw new Error("No DOM element with id '"+g+"' exists on the page.");return u}if(g==null)throw new Error("DOM element provided is null or undefined");return g},isPlotDiv:function(g){var u=d.select(g);return u.node()instanceof HTMLElement&&u.size()&&u.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(g,u){t("global",g,u)},addRelatedStyleRule:t,deleteRelatedStyleRule:function(g){var u="plotly.js-style-"+g,s=document.getElementById(u);s&&e(s)},getFullTransformMatrix:function(g){var u=a(g),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return u.forEach(function(h){var l=n(h);if(l){var o=w.convertCssMatrix(l);s=y.multiply(s,s,o)}}),s},getElementTransformMatrix:n,getElementAndAncestors:a,equalDomRects:function(g,u){return g&&u&&g.x===u.x&&g.y===u.y&&g.top===u.top&&g.left===u.left&&g.right===u.right&&g.bottom===u.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(m,G,W){var d=m("events").EventEmitter,v={init:function(w){if(w._ev instanceof d)return w;var y=new d,e=new d;return w._ev=y,w._internalEv=e,w.on=y.on.bind(y),w.once=y.once.bind(y),w.removeListener=y.removeListener.bind(y),w.removeAllListeners=y.removeAllListeners.bind(y),w._internalOn=e.on.bind(e),w._internalOnce=e.once.bind(e),w._removeInternalListener=e.removeListener.bind(e),w._removeAllInternalListeners=e.removeAllListeners.bind(e),w.emit=function(t,n){typeof jQuery<"u"&&jQuery(w).trigger(t,n),y.emit(t,n),e.emit(t,n)},w},triggerHandler:function(w,y,e){var t,n;typeof jQuery<"u"&&(t=jQuery(w).triggerHandler(y,e));var a=w._ev;if(!a)return t;var r,g=a._events[y];if(!g)return t;function u(s){return s.listener?(a.removeListener(y,s.listener),s.fired?void 0:(s.fired=!0,s.listener.apply(a,[e]))):s.apply(a,[e])}for(g=Array.isArray(g)?g:[g],r=0;r<g.length-1;r++)u(g[r]);return n=u(g[r]),t!==void 0?t:n},purge:function(w){return delete w._ev,delete w.on,delete w.once,delete w.removeListener,delete w.removeAllListeners,delete w.emit,delete w._ev,delete w._internalEv,delete w._internalOn,delete w._internalOnce,delete w._removeInternalListener,delete w._removeAllInternalListeners,w}};G.exports=v},{events:84}],505:[function(m,G,W){var d=m("./is_plain_object.js"),v=Array.isArray;function w(y,e,t,n){var a,r,g,u,s,h,l=y[0],o=y.length;if(o===2&&v(l)&&v(y[1])&&l.length===0){if(function(c,i){var x,f;for(x=0;x<c.length;x++){if((f=c[x])!==null&&typeof f=="object")return!1;f!==void 0&&(i[x]=f)}return!0}(y[1],l))return l;l.splice(0,l.length)}for(var p=1;p<o;p++)for(r in a=y[p])g=l[r],u=a[r],n&&v(u)?l[r]=u:e&&u&&(d(u)||(s=v(u)))?(s?(s=!1,h=g&&v(g)?g:[]):h=g&&d(g)?g:{},l[r]=w([h,u],e,t,n)):(u!==void 0||t)&&(l[r]=u);return l}W.extendFlat=function(){return w(arguments,!1,!1,!1)},W.extendDeep=function(){return w(arguments,!0,!1,!1)},W.extendDeepAll=function(){return w(arguments,!0,!0,!1)},W.extendDeepNoArrays=function(){return w(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(m,G,W){G.exports=function(d){for(var v={},w=[],y=0,e=0;e<d.length;e++){var t=d[e];v[t]!==1&&(v[t]=1,w[y++]=t)}return w}},{}],507:[function(m,G,W){function d(w){return w.visible===!0}function v(w){var y=w[0].trace;return y.visible===!0&&y._length!==0}G.exports=function(w){for(var y,e=(y=w,Array.isArray(y)&&Array.isArray(y[0])&&y[0][0]&&y[0][0].trace?v:d),t=[],n=0;n<w.length;n++){var a=w[n];e(a)&&t.push(a)}return t}},{}],508:[function(m,G,W){var d=m("@plotly/d3"),v=m("country-regex"),w=m("@turf/area"),y=m("@turf/centroid"),e=m("@turf/bbox"),t=m("./identity"),n=m("./loggers"),a=m("./is_plain_object"),r=m("./nested_property"),g=m("./polygon"),u=Object.keys(v),s={"ISO-3":t,"USA-states":t,"country names":function(l){for(var o=0;o<u.length;o++){var p=u[o];if(new RegExp(v[p]).test(l.trim().toLowerCase()))return p}return n.log("Unrecognized country name: "+l+"."),!1}};function h(l){var o=l.geojson,p=window.PlotlyGeoAssets||{},c=typeof o=="string"?p[o]:o;return a(c)?c:(n.error("Oops ... something went wrong when fetching "+o),!1)}G.exports={locationToFeature:function(l,o,p){if(!o||typeof o!="string")return!1;var c,i,x,f=s[l](o);if(f){if(l==="USA-states")for(c=[],x=0;x<p.length;x++)(i=p[x]).properties&&i.properties.gu&&i.properties.gu==="USA"&&c.push(i);else c=p;for(x=0;x<c.length;x++)if((i=c[x]).id===f)return i;n.log(["Location with id",f,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(l){var o,p,c,i,x=l.geometry,f=x.coordinates,_=l.id,b=[];function T(k){for(var L=0;L<k.length-1;L++)if(k[L][0]>0&&k[L+1][0]<0)return L;return null}switch(o=_==="RUS"||_==="FJI"?function(k){var L;if(T(k)===null)L=k;else for(L=new Array(k.length),i=0;i<k.length;i++)L[i]=[k[i][0]<0?k[i][0]+360:k[i][0],k[i][1]];b.push(g.tester(L))}:_==="ATA"?function(k){var L=T(k);if(L===null)return b.push(g.tester(k));var A=new Array(k.length+1),I=0;for(i=0;i<k.length;i++)i>L?A[I++]=[k[i][0]+360,k[i][1]]:i===L?(A[I++]=k[i],A[I++]=[k[i][0],-90]):A[I++]=k[i];var P=g.tester(A);P.pts.pop(),b.push(P)}:function(k){b.push(g.tester(k))},x.type){case"MultiPolygon":for(p=0;p<f.length;p++)for(c=0;c<f[p].length;c++)o(f[p][c]);break;case"Polygon":for(p=0;p<f.length;p++)o(f[p])}return b},getTraceGeojson:h,extractTraceFeature:function(l){var o=l[0].trace,p=h(o);if(!p)return!1;var c,i={},x=[];for(c=0;c<o._length;c++){var f=l[c];(f.loc||f.loc===0)&&(i[f.loc]=f)}function _(k){var L=r(k,o.featureidkey||"id").get(),A=i[L];if(A){var I=k.geometry;if(I.type==="Polygon"||I.type==="MultiPolygon"){var P={type:"Feature",id:L,geometry:I,properties:{}};P.properties.ct=function(S){var E,z=S.geometry;if(z.type==="MultiPolygon")for(var D=z.coordinates,j=0,V=0;V<D.length;V++){var Z={type:"Polygon",coordinates:D[V]},Q=w.default(Z);Q>j&&(j=Q,E=Z)}else E=z;return y.default(E).geometry.coordinates}(P),A.fIn=k,A.fOut=P,x.push(P)}else n.log(["Location",A.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete i[L]}switch(p.type){case"FeatureCollection":var b=p.features;for(c=0;c<b.length;c++)_(b[c]);break;case"Feature":_(p);break;default:return n.warn(["Invalid GeoJSON type",(p.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var T in i)n.log(["Location *"+T+"*","does not have a matching feature with id-key","*"+o.featureidkey+"*."].join(" "));return x},fetchTraceGeoData:function(l){var o=window.PlotlyGeoAssets||{},p=[];function c(_){return new Promise(function(b,T){d.json(_,function(k,L){if(k){delete o[_];var A=k.status===404?'GeoJSON at URL "'+_+'" does not exist.':"Unexpected error while fetching from "+_;return T(new Error(A))}return o[_]=L,b(L)})})}function i(_){return new Promise(function(b,T){var k=0,L=setInterval(function(){return o[_]&&o[_]!=="pending"?(clearInterval(L),b(o[_])):k>100?(clearInterval(L),T("Unexpected error while fetching from "+_)):void k++},50)})}for(var x=0;x<l.length;x++){var f=l[x][0].trace.geojson;typeof f=="string"&&(o[f]?o[f]==="pending"&&p.push(i(f)):(o[f]="pending",p.push(c(f))))}return p},computeBbox:function(l){return e.default(l)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(m,G,W){var d=m("../constants/numerical").BADNUM;W.calcTraceToLineCoords=function(v){for(var w=v[0].trace.connectgaps,y=[],e=[],t=0;t<v.length;t++){var n=v[t].lonlat;n[0]!==d?e.push(n):!w&&e.length>0&&(y.push(e),e=[])}return e.length>0&&y.push(e),y},W.makeLine=function(v){return v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v}},W.makePolygon=function(v){if(v.length===1)return{type:"Polygon",coordinates:v};for(var w=new Array(v.length),y=0;y<v.length;y++)w[y]=[v[y]];return{type:"MultiPolygon",coordinates:w}},W.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(m,G,W){var d,v,w,y=m("./mod").mod;function e(n,a,r,g,u,s,h,l){var o=r-n,p=u-n,c=h-u,i=g-a,x=s-a,f=l-s,_=o*f-c*i;if(_===0)return null;var b=(p*f-c*x)/_,T=(p*i-o*x)/_;return T<0||T>1||b<0||b>1?null:{x:n+o*b,y:a+i*b}}function t(n,a,r,g,u){var s=g*n+u*a;if(s<0)return g*g+u*u;if(s>r){var h=g-n,l=u-a;return h*h+l*l}var o=g*a-u*n;return o*o/r}W.segmentsIntersect=e,W.segmentDistance=function(n,a,r,g,u,s,h,l){if(e(n,a,r,g,u,s,h,l))return 0;var o=r-n,p=g-a,c=h-u,i=l-s,x=o*o+p*p,f=c*c+i*i,_=Math.min(t(o,p,x,u-n,s-a),t(o,p,x,h-n,l-a),t(c,i,f,n-u,a-s),t(c,i,f,r-u,g-s));return Math.sqrt(_)},W.getTextLocation=function(n,a,r,g){if(n===v&&g===w||(d={},v=n,w=g),d[r])return d[r];var u=n.getPointAtLength(y(r-g/2,a)),s=n.getPointAtLength(y(r+g/2,a)),h=Math.atan((s.y-u.y)/(s.x-u.x)),l=n.getPointAtLength(y(r,a)),o={x:(4*l.x+u.x+s.x)/6,y:(4*l.y+u.y+s.y)/6,theta:h};return d[r]=o,o},W.clearLocationCache=function(){v=null},W.getVisibleSegment=function(n,a,r){var g,u,s=a.left,h=a.right,l=a.top,o=a.bottom,p=0,c=n.getTotalLength(),i=c;function x(_){var b=n.getPointAtLength(_);_===0?g=b:_===c&&(u=b);var T=b.x<s?s-b.x:b.x>h?b.x-h:0,k=b.y<l?l-b.y:b.y>o?b.y-o:0;return Math.sqrt(T*T+k*k)}for(var f=x(p);f;){if((p+=f+r)>i)return;f=x(p)}for(f=x(i);f;){if(p>(i-=f+r))return;f=x(i)}return{min:p,max:i,len:i-p,total:c,isClosed:p===0&&i===c&&Math.abs(g.x-u.x)<.1&&Math.abs(g.y-u.y)<.1}},W.findPointOnPath=function(n,a,r,g){for(var u,s,h,l=(g=g||{}).pathLength||n.getTotalLength(),o=g.tolerance||.001,p=g.iterationLimit||30,c=n.getPointAtLength(0)[r]>n.getPointAtLength(l)[r]?-1:1,i=0,x=0,f=l;i<p;){if(u=(x+f)/2,h=(s=n.getPointAtLength(u))[r]-a,Math.abs(h)<o)return s;c*h>0?f=u:x=u,i++}return s}},{"./mod":522}],511:[function(m,G,W){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("color-normalize"),y=m("../components/colorscale"),e=m("../components/color/attributes").defaultLine,t=m("./array").isArrayOrTypedArray,n=w(e);function a(u,s){var h=u;return h[3]*=s,h}function r(u){if(d(u))return n;var s=w(u);return s.length?s:n}function g(u){return d(u)?u:1}G.exports={formatColor:function(u,s,h){var l,o,p,c,i,x=u.color,f=t(x),_=t(s),b=y.extractOpts(u),T=[];if(l=b.colorscale!==void 0?y.makeColorScaleFuncFromTrace(u):r,o=f?function(L,A){return L[A]===void 0?n:w(l(L[A]))}:r,p=_?function(L,A){return L[A]===void 0?1:g(L[A])}:g,f||_)for(var k=0;k<h;k++)c=o(x,k),i=p(s,k),T[k]=a(c,i);else T=a(w(x),s);return T},parseColorScale:function(u){var s=y.extractOpts(u),h=s.colorscale;return s.reversescale&&(h=y.flipScale(s.colorscale)),h.map(function(l){var o=l[0],p=v(l[1]).toRgb();return{index:o,rgb:[p.r,p.g,p.b,p.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(m,G,W){var d=m("./identity");function v(w){return[w]}G.exports={keyFun:function(w){return w.key},repeat:v,descend:d,wrap:v,unwrap:function(w){return w[0]}}},{"./identity":513}],513:[function(m,G,W){G.exports=function(d){return d}},{}],514:[function(m,G,W){G.exports=function(d,v){if(!v)return d;var w=1/Math.abs(v),y=w>1?(w*d+w*v)/w:d+v,e=String(y).length;if(e>16){var t=String(v).length;if(e>=String(d).length+t){var n=parseFloat(y).toPrecision(12);n.indexOf("e+")===-1&&(y=+n)}}return y}},{}],515:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-time-format").utcFormat,w=m("d3-format").format,y=m("fast-isnumeric"),e=m("../constants/numerical"),t=e.FP_SAFE,n=-t,a=e.BADNUM,r=G.exports={};r.adjustFormat=function(H){return!H||/^\d[.]\df/.test(H)||/[.]\d%/.test(H)?H:H==="0.f"?"~f":/^\d%/.test(H)?"~%":/^\ds/.test(H)?"~s":!/^[~,.0$]/.test(H)&&/[&fps]/.test(H)?"~"+H:H};var g={};r.warnBadFormat=function(H){var N=String(H);g[N]||(g[N]=1,r.warn('encountered bad format: "'+N+'"'))},r.noFormat=function(H){return String(H)},r.numberFormat=function(H){var N;try{N=w(r.adjustFormat(H))}catch{return r.warnBadFormat(H),r.noFormat}return N},r.nestedProperty=m("./nested_property"),r.keyedContainer=m("./keyed_container"),r.relativeAttr=m("./relative_attr"),r.isPlainObject=m("./is_plain_object"),r.toLogRange=m("./to_log_range"),r.relinkPrivateKeys=m("./relink_private");var u=m("./array");r.isTypedArray=u.isTypedArray,r.isArrayOrTypedArray=u.isArrayOrTypedArray,r.isArray1D=u.isArray1D,r.ensureArray=u.ensureArray,r.concat=u.concat,r.maxRowLength=u.maxRowLength,r.minRowLength=u.minRowLength;var s=m("./mod");r.mod=s.mod,r.modHalf=s.modHalf;var h=m("./coerce");r.valObjectMeta=h.valObjectMeta,r.coerce=h.coerce,r.coerce2=h.coerce2,r.coerceFont=h.coerceFont,r.coercePattern=h.coercePattern,r.coerceHoverinfo=h.coerceHoverinfo,r.coerceSelectionMarkerOpacity=h.coerceSelectionMarkerOpacity,r.validate=h.validate;var l=m("./dates");r.dateTime2ms=l.dateTime2ms,r.isDateTime=l.isDateTime,r.ms2DateTime=l.ms2DateTime,r.ms2DateTimeLocal=l.ms2DateTimeLocal,r.cleanDate=l.cleanDate,r.isJSDate=l.isJSDate,r.formatDate=l.formatDate,r.incrementMonth=l.incrementMonth,r.dateTick0=l.dateTick0,r.dfltRange=l.dfltRange,r.findExactDates=l.findExactDates,r.MIN_MS=l.MIN_MS,r.MAX_MS=l.MAX_MS;var o=m("./search");r.findBin=o.findBin,r.sorterAsc=o.sorterAsc,r.sorterDes=o.sorterDes,r.distinctVals=o.distinctVals,r.roundUp=o.roundUp,r.sort=o.sort,r.findIndexOfMin=o.findIndexOfMin,r.sortObjectKeys=m("./sort_object_keys");var p=m("./stats");r.aggNums=p.aggNums,r.len=p.len,r.mean=p.mean,r.median=p.median,r.midRange=p.midRange,r.variance=p.variance,r.stdev=p.stdev,r.interp=p.interp;var c=m("./matrix");r.init2dArray=c.init2dArray,r.transposeRagged=c.transposeRagged,r.dot=c.dot,r.translationMatrix=c.translationMatrix,r.rotationMatrix=c.rotationMatrix,r.rotationXYMatrix=c.rotationXYMatrix,r.apply3DTransform=c.apply3DTransform,r.apply2DTransform=c.apply2DTransform,r.apply2DTransform2=c.apply2DTransform2,r.convertCssMatrix=c.convertCssMatrix,r.inverseTransformMatrix=c.inverseTransformMatrix;var i=m("./angles");r.deg2rad=i.deg2rad,r.rad2deg=i.rad2deg,r.angleDelta=i.angleDelta,r.angleDist=i.angleDist,r.isFullCircle=i.isFullCircle,r.isAngleInsideSector=i.isAngleInsideSector,r.isPtInsideSector=i.isPtInsideSector,r.pathArc=i.pathArc,r.pathSector=i.pathSector,r.pathAnnulus=i.pathAnnulus;var x=m("./anchor_utils");r.isLeftAnchor=x.isLeftAnchor,r.isCenterAnchor=x.isCenterAnchor,r.isRightAnchor=x.isRightAnchor,r.isTopAnchor=x.isTopAnchor,r.isMiddleAnchor=x.isMiddleAnchor,r.isBottomAnchor=x.isBottomAnchor;var f=m("./geometry2d");r.segmentsIntersect=f.segmentsIntersect,r.segmentDistance=f.segmentDistance,r.getTextLocation=f.getTextLocation,r.clearLocationCache=f.clearLocationCache,r.getVisibleSegment=f.getVisibleSegment,r.findPointOnPath=f.findPointOnPath;var _=m("./extend");r.extendFlat=_.extendFlat,r.extendDeep=_.extendDeep,r.extendDeepAll=_.extendDeepAll,r.extendDeepNoArrays=_.extendDeepNoArrays;var b=m("./loggers");r.log=b.log,r.warn=b.warn,r.error=b.error;var T=m("./regex");r.counterRegex=T.counter;var k=m("./throttle");r.throttle=k.throttle,r.throttleDone=k.done,r.clearThrottle=k.clear;var L=m("./dom");function A(H){var N={};for(var U in H)for(var te=H[U],B=0;B<te.length;B++)N[te[B]]=+U;return N}r.getGraphDiv=L.getGraphDiv,r.isPlotDiv=L.isPlotDiv,r.removeElement=L.removeElement,r.addStyleRule=L.addStyleRule,r.addRelatedStyleRule=L.addRelatedStyleRule,r.deleteRelatedStyleRule=L.deleteRelatedStyleRule,r.getFullTransformMatrix=L.getFullTransformMatrix,r.getElementTransformMatrix=L.getElementTransformMatrix,r.getElementAndAncestors=L.getElementAndAncestors,r.equalDomRects=L.equalDomRects,r.clearResponsive=m("./clear_responsive"),r.preserveDrawingBuffer=m("./preserve_drawing_buffer"),r.makeTraceGroups=m("./make_trace_groups"),r._=m("./localize"),r.notifier=m("./notifier"),r.filterUnique=m("./filter_unique"),r.filterVisible=m("./filter_visible"),r.pushUnique=m("./push_unique"),r.increment=m("./increment"),r.cleanNumber=m("./clean_number"),r.ensureNumber=function(H){return y(H)?(H=Number(H))>t||H<n?a:H:a},r.isIndex=function(H,N){return!(N!==void 0&&H>=N)&&y(H)&&H>=0&&H%1==0},r.noop=m("./noop"),r.identity=m("./identity"),r.repeat=function(H,N){for(var U=new Array(N),te=0;te<N;te++)U[te]=H;return U},r.swapAttrs=function(H,N,U,te){U||(U="x"),te||(te="y");for(var B=0;B<N.length;B++){var X=N[B],J=r.nestedProperty(H,X.replace("?",U)),ee=r.nestedProperty(H,X.replace("?",te)),re=J.get();J.set(ee.get()),ee.set(re)}},r.raiseToTop=function(H){H.parentNode.appendChild(H)},r.cancelTransition=function(H){return H.transition().duration(0)},r.constrain=function(H,N,U){return N>U?Math.max(U,Math.min(N,H)):Math.max(N,Math.min(U,H))},r.bBoxIntersect=function(H,N,U){return U=U||0,H.left<=N.right+U&&N.left<=H.right+U&&H.top<=N.bottom+U&&N.top<=H.bottom+U},r.simpleMap=function(H,N,U,te,B){for(var X=H.length,J=new Array(X),ee=0;ee<X;ee++)J[ee]=N(H[ee],U,te,B);return J},r.randstr=function H(N,U,te,B){if(te||(te=16),U===void 0&&(U=24),U<=0)return"0";var X,J,ee=Math.log(Math.pow(2,U))/Math.log(te),re="";for(X=2;ee===1/0;X*=2)ee=Math.log(Math.pow(2,U/X))/Math.log(te)*X;var se=ee-Math.floor(ee);for(X=0;X<Math.floor(ee);X++)re=Math.floor(Math.random()*te).toString(te)+re;se&&(J=Math.pow(te,se),re=Math.floor(Math.random()*J).toString(te)+re);var oe=parseInt(re,te);return N&&N[re]||oe!==1/0&&oe>=Math.pow(2,U)?B>10?(r.warn("randstr failed uniqueness"),re):H(N,U,te,(B||0)+1):re},r.OptionControl=function(H,N){H||(H={}),N||(N="opt");var U={optionList:[],_newoption:function(te){te[N]=H,U[te.name]=te,U.optionList.push(te)}};return U["_"+N]=H,U},r.smooth=function(H,N){if((N=Math.round(N)||0)<2)return H;var U,te,B,X,J=H.length,ee=2*J,re=2*N-1,se=new Array(re),oe=new Array(J);for(U=0;U<re;U++)se[U]=(1-Math.cos(Math.PI*(U+1)/N))/(2*N);for(U=0;U<J;U++){for(X=0,te=0;te<re;te++)(B=U+te+1-N)<-J?B-=ee*Math.round(B/ee):B>=ee&&(B-=ee*Math.floor(B/ee)),B<0?B=-1-B:B>=J&&(B=ee-1-B),X+=H[B]*se[te];oe[U]=X}return oe},r.syncOrAsync=function(H,N,U){var te;function B(){return r.syncOrAsync(H,N,U)}for(;H.length;)if((te=(0,H.splice(0,1)[0])(N))&&te.then)return te.then(B);return U&&U(N)},r.stripTrailingSlash=function(H){return H.substr(-1)==="/"?H.substr(0,H.length-1):H},r.noneOrAll=function(H,N,U){if(H){var te,B=!1,X=!0;for(te=0;te<U.length;te++)H[U[te]]!=null?B=!0:X=!1;if(B&&!X)for(te=0;te<U.length;te++)H[U[te]]=N[U[te]]}},r.mergeArray=function(H,N,U,te){var B=typeof te=="function";if(r.isArrayOrTypedArray(H))for(var X=Math.min(H.length,N.length),J=0;J<X;J++){var ee=H[J];N[J][U]=B?te(ee):ee}},r.mergeArrayCastPositive=function(H,N,U){return r.mergeArray(H,N,U,function(te){var B=+te;return isFinite(B)&&B>0?B:0})},r.fillArray=function(H,N,U,te){if(te=te||r.identity,r.isArrayOrTypedArray(H))for(var B=0;B<N.length;B++)N[B][U]=te(H[B])},r.castOption=function(H,N,U,te){te=te||r.identity;var B=r.nestedProperty(H,U).get();return r.isArrayOrTypedArray(B)?Array.isArray(N)&&r.isArrayOrTypedArray(B[N[0]])?te(B[N[0]][N[1]]):te(B[N]):B},r.extractOption=function(H,N,U,te){if(U in H)return H[U];var B=r.nestedProperty(N,te).get();return Array.isArray(B)?void 0:B},r.tagSelected=function(H,N,U){var te,B,X=N.selectedpoints,J=N._indexToPoints;J&&(te=A(J));for(var ee=0;ee<X.length;ee++){var re=X[ee];if(r.isIndex(re)||r.isArrayOrTypedArray(re)&&r.isIndex(re[0])&&r.isIndex(re[1])){var se=te?te[re]:re,oe=U?U[se]:se;(B=oe)!==void 0&&B<H.length&&(H[oe].selected=1)}}},r.selIndices2selPoints=function(H){var N=H.selectedpoints,U=H._indexToPoints;if(U){for(var te=A(U),B=[],X=0;X<N.length;X++){var J=N[X];if(r.isIndex(J)){var ee=te[J];r.isIndex(ee)&&B.push(ee)}}return B}return N},r.getTargetArray=function(H,N){var U=N.target;if(typeof U=="string"&&U){var te=r.nestedProperty(H,U).get();return!!Array.isArray(te)&&te}return!!Array.isArray(U)&&U},r.minExtend=function(H,N){var U={};typeof N!="object"&&(N={});var te,B,X,J=Object.keys(H);for(te=0;te<J.length;te++)X=H[B=J[te]],B.charAt(0)!=="_"&&typeof X!="function"&&(B==="module"?U[B]=X:Array.isArray(X)?U[B]=B==="colorscale"?X.slice():X.slice(0,3):r.isTypedArray(X)?U[B]=X.subarray(0,3):U[B]=X&&typeof X=="object"?r.minExtend(H[B],N[B]):X);for(J=Object.keys(N),te=0;te<J.length;te++)typeof(X=N[B=J[te]])=="object"&&B in U&&typeof U[B]=="object"||(U[B]=X);return U},r.titleCase=function(H){return H.charAt(0).toUpperCase()+H.substr(1)},r.containsAny=function(H,N){for(var U=0;U<N.length;U++)if(H.indexOf(N[U])!==-1)return!0;return!1},r.isIE=function(){return window.navigator.msSaveBlob!==void 0};var I=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return I.test(window.navigator.userAgent)};var P=/iPad|iPhone|iPod/;r.isIOS=function(){return P.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;r.getFirefoxVersion=function(){var H=S.exec(window.navigator.userAgent);if(H&&H.length===2){var N=parseInt(H[1]);if(!isNaN(N))return N}return null},r.isD3Selection=function(H){return H instanceof d.selection},r.ensureSingle=function(H,N,U,te){var B=H.select(N+(U?"."+U:""));if(B.size())return B;var X=H.append(N);return U&&X.classed(U,!0),te&&X.call(te),X},r.ensureSingleById=function(H,N,U,te){var B=H.select(N+"#"+U);if(B.size())return B;var X=H.append(N).attr("id",U);return te&&X.call(te),X},r.objectFromPath=function(H,N){for(var U,te=H.split("."),B=U={},X=0;X<te.length;X++){var J=te[X],ee=null,re=te[X].match(/(.*)\[([0-9]+)\]/);re?(J=re[1],ee=re[2],U=U[J]=[],X===te.length-1?U[ee]=N:U[ee]={},U=U[ee]):(X===te.length-1?U[J]=N:U[J]={},U=U[J])}return B};var E=/^([^\[\.]+)\.(.+)?/,z=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(H){var N,U,te,B,X,J,ee;if(typeof H=="object"&&!Array.isArray(H))for(U in H)H.hasOwnProperty(U)&&((N=U.match(E))?(B=H[U],te=N[1],delete H[U],H[te]=r.extendDeepNoArrays(H[te]||{},r.objectFromPath(U,r.expandObjectPaths(B))[te])):(N=U.match(z))?(B=H[U],te=N[1],X=parseInt(N[2]),delete H[U],H[te]=H[te]||[],N[3]==="."?(ee=N[4],J=H[te][X]=H[te][X]||{},r.extendDeepNoArrays(J,r.objectFromPath(ee,r.expandObjectPaths(B)))):H[te][X]=r.expandObjectPaths(B)):H[U]=r.expandObjectPaths(H[U]));return H},r.numSeparate=function(H,N,U){if(U||(U=!1),typeof N!="string"||N.length===0)throw new Error("Separator string required for formatting!");typeof H=="number"&&(H=String(H));var te=/(\d+)(\d{3})/,B=N.charAt(0),X=N.charAt(1),J=H.split("."),ee=J[0],re=J.length>1?B+J[1]:"";if(X&&(J.length>1||ee.length>4||U))for(;te.test(ee);)ee=ee.replace(te,"$1"+X+"$2");return ee+re},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;r.templateString=function(H,N){var U={};return H.replace(r.TEMPLATE_STRING_REGEX,function(te,B){var X;return D.test(B)?X=N[B]:(U[B]=U[B]||r.nestedProperty(N,B).get,X=U[B]()),r.isValidTextValue(X)?X:""})};var j={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return Q.apply(j,arguments)};var V={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return Q.apply(V,arguments)};var Z=/^[:|\|]/;function Q(H,N,U){var te=this,B=arguments;N||(N={});var X={};return H.replace(r.TEMPLATE_STRING_REGEX,function(J,ee,re){var se,oe,de,ce=ee==="_xother"||ee==="_yother",ve=ee==="_xother_"||ee==="_yother_",Ae=ee==="xother_"||ee==="yother_",fe=ee==="xother"||ee==="yother"||ce||Ae||ve,me=ee;if((ce||ve)&&(me=me.substring(1)),(Ae||ve)&&(me=me.substring(0,me.length-1)),fe){if((se=N[me])===void 0)return""}else for(de=3;de<B.length;de++)if(oe=B[de]){if(oe.hasOwnProperty(me)){se=oe[me];break}if(D.test(me)||(se=r.nestedProperty(oe,me).get(),(se=X[me]||r.nestedProperty(oe,me).get())&&(X[me]=se)),se!==void 0)break}if(se===void 0&&te)return te.count<te.max&&(r.warn("Variable '"+me+"' in "+te.name+" could not be found!"),se=J),te.count===te.max&&r.warn("Too many "+te.name+" warnings - additional warnings will be suppressed"),te.count++,J;if(re){var _e;if(re[0]===":"&&(se=(_e=U?U.numberFormat:r.numberFormat)(re.replace(Z,""))(se)),re[0]==="|"){_e=U?U.timeFormat:v;var le=r.dateTime2ms(se);se=r.formatDate(le,re.replace(Z,""),!1,_e)}}else{var ge=me+"Label";N.hasOwnProperty(ge)&&(se=N[ge])}return fe&&(se="("+se+")",(ce||ve)&&(se=" "+se),(Ae||ve)&&(se+=" ")),se})}r.subplotSort=function(H,N){for(var U=Math.min(H.length,N.length)+1,te=0,B=0,X=0;X<U;X++){var J=H.charCodeAt(X)||0,ee=N.charCodeAt(X)||0,re=J>=48&&J<=57,se=ee>=48&&ee<=57;if(re&&(te=10*te+J-48),se&&(B=10*B+ee-48),!re||!se){if(te!==B)return te-B;if(J!==ee)return J-ee}}return B-te};var K=2e9;r.seedPseudoRandom=function(){K=2e9},r.pseudoRandom=function(){var H=K;return K=(69069*K+1)%4294967296,Math.abs(K-H)<429496729?r.pseudoRandom():K/4294967296},r.fillText=function(H,N,U){var te=Array.isArray(U)?function(J){U.push(J)}:function(J){U.text=J},B=r.extractOption(H,N,"htx","hovertext");if(r.isValidTextValue(B))return te(B);var X=r.extractOption(H,N,"tx","text");return r.isValidTextValue(X)?te(X):void 0},r.isValidTextValue=function(H){return H||H===0},r.formatPercent=function(H,N){N=N||0;for(var U=(Math.round(100*H*Math.pow(10,N))*Math.pow(.1,N)).toFixed(N)+"%",te=0;te<N;te++)U.indexOf(".")!==-1&&(U=(U=U.replace("0%","%")).replace(".%","%"));return U},r.isHidden=function(H){var N=window.getComputedStyle(H).display;return!N||N==="none"},r.strTranslate=function(H,N){return H||N?"translate("+H+","+N+")":""},r.strRotate=function(H){return H?"rotate("+H+")":""},r.strScale=function(H){return H!==1?"scale("+H+")":""},r.getTextTransform=function(H){var N=H.noCenter,U=H.textX,te=H.textY,B=H.targetX,X=H.targetY,J=H.anchorX||0,ee=H.anchorY||0,re=H.rotate,se=H.scale;return se?se>1&&(se=1):se=0,r.strTranslate(B-se*(U+J),X-se*(te+ee))+r.strScale(se)+(re?"rotate("+re+(N?"":" "+U+" "+te)+")":"")},r.setTransormAndDisplay=function(H,N){H.attr("transform",r.getTextTransform(N)),H.style("display",N.scale?null:"none")},r.ensureUniformFontSize=function(H,N){var U=r.extendFlat({},N);return U.size=Math.max(N.size,H._fullLayout.uniformtext.minsize||0),U},r.join2=function(H,N,U){var te=H.length;return te>1?H.slice(0,-1).join(N)+U+H[te-1]:H.join(N)},r.bigFont=function(H){return Math.round(1.2*H)};var $=r.getFirefoxVersion(),ne=$!==null&&$<86;r.getPositionFromD3Event=function(){return ne?[d.event.layerX,d.event.layerY]:[d.event.offsetX,d.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(m,G,W){G.exports=function(d){return window&&window.process&&window.process.versions?Object.prototype.toString.call(d)==="[object Object]":Object.prototype.toString.call(d)==="[object Object]"&&Object.getPrototypeOf(d).hasOwnProperty("hasOwnProperty")}},{}],517:[function(m,G,W){var d=m("./nested_property"),v=/^\w*$/;G.exports=function(w,y,e,t){var n,a,r;e=e||"name",t=t||"value";var g={};y&&y.length?(r=d(w,y),a=r.get()):a=w,y=y||"";var u={};if(a)for(n=0;n<a.length;n++)u[a[n][e]]=n;var s=v.test(t),h={set:function(l,o){var p=o===null?4:0;if(!a){if(!r||p===4)return;a=[],r.set(a)}var c=u[l];if(c===void 0){if(p===4)return;p|=3,c=a.length,u[l]=c}else o!==(s?a[c][t]:d(a[c],t).get())&&(p|=2);var i=a[c]=a[c]||{};return i[e]=l,s?i[t]=o:d(i,t).set(o),o!==null&&(p&=-5),g[c]=g[c]|p,h},get:function(l){if(a){var o=u[l];return o===void 0?void 0:s?a[o][t]:d(a[o],t).get()}},rename:function(l,o){var p=u[l];return p===void 0||(g[p]=1|g[p],u[o]=p,delete u[l],a[p][e]=o),h},remove:function(l){var o=u[l];if(o===void 0)return h;var p=a[o];if(Object.keys(p).length>2)return g[o]=2|g[o],h.set(l,null);if(s){for(n=o;n<a.length;n++)g[n]=3|g[n];for(n=o;n<a.length;n++)u[a[n][e]]--;a.splice(o,1),delete u[l]}else d(p,t).set(null),g[o]=6|g[o];return h},constructUpdate:function(){for(var l,o,p={},c=Object.keys(g),i=0;i<c.length;i++)o=c[i],l=y+"["+o+"]",a[o]?(1&g[o]&&(p[l+"."+e]=a[o][e]),2&g[o]&&(p[l+"."+t]=s?4&g[o]?null:a[o][t]:4&g[o]?null:d(a[o],t).get())):p[l]=null;return p}};return h}},{"./nested_property":523}],518:[function(m,G,W){var d=m("../registry");G.exports=function(v,w){for(var y=v._context.locale,e=0;e<2;e++){for(var t=v._context.locales,n=0;n<2;n++){var a=(t[y]||{}).dictionary;if(a){var r=a[w];if(r)return r}t=d.localeRegistry}var g=y.split("-")[0];if(g===y)break;y=g}return w}},{"../registry":647}],519:[function(m,G,W){var d=m("../plot_api/plot_config").dfltConfig,v=m("./notifier"),w=G.exports={};w.log=function(){var y;if(d.logging>1){var e=["LOG:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(d.notifyOnLogging>1){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"long")}},w.warn=function(){var y;if(d.logging>0){var e=["WARN:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(d.notifyOnLogging>0){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"stick")}},w.error=function(){var y;if(d.logging>0){var e=["ERROR:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.error.apply(console,e)}if(d.notifyOnLogging>0){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(m,G,W){var d=m("@plotly/d3");G.exports=function(v,w,y){var e=v.selectAll("g."+y.replace(/\s/g,".")).data(w,function(n){return n[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",y),e.order();var t=v.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(n){n[0][t]=d.select(this)}),e}},{"@plotly/d3":58}],521:[function(m,G,W){var d=m("gl-mat4");W.init2dArray=function(v,w){for(var y=new Array(v),e=0;e<v;e++)y[e]=new Array(w);return y},W.transposeRagged=function(v){var w,y,e=0,t=v.length;for(w=0;w<t;w++)e=Math.max(e,v[w].length);var n=new Array(e);for(w=0;w<e;w++)for(n[w]=new Array(t),y=0;y<t;y++)n[w][y]=v[y][w];return n},W.dot=function(v,w){if(!v.length||!w.length||v.length!==w.length)return null;var y,e,t=v.length;if(v[0].length)for(y=new Array(t),e=0;e<t;e++)y[e]=W.dot(v[e],w);else if(w[0].length){var n=W.transposeRagged(w);for(y=new Array(n.length),e=0;e<n.length;e++)y[e]=W.dot(v,n[e])}else for(y=0,e=0;e<t;e++)y+=v[e]*w[e];return y},W.translationMatrix=function(v,w){return[[1,0,v],[0,1,w],[0,0,1]]},W.rotationMatrix=function(v){var w=v*Math.PI/180;return[[Math.cos(w),-Math.sin(w),0],[Math.sin(w),Math.cos(w),0],[0,0,1]]},W.rotationXYMatrix=function(v,w,y){return W.dot(W.dot(W.translationMatrix(w,y),W.rotationMatrix(v)),W.translationMatrix(-w,-y))},W.apply3DTransform=function(v){return function(){var w=arguments,y=arguments.length===1?w[0]:[w[0],w[1],w[2]||0];return W.dot(v,[y[0],y[1],y[2],1]).slice(0,3)}},W.apply2DTransform=function(v){return function(){var w=arguments;w.length===3&&(w=w[0]);var y=arguments.length===1?w[0]:[w[0],w[1]];return W.dot(v,[y[0],y[1],1]).slice(0,2)}},W.apply2DTransform2=function(v){var w=W.apply2DTransform(v);return function(y){return w(y.slice(0,2)).concat(w(y.slice(2,4)))}},W.convertCssMatrix=function(v){if(v){var w=v.length;if(w===16)return v;if(w===6)return[v[0],v[1],0,0,v[2],v[3],0,0,0,0,1,0,v[4],v[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},W.inverseTransformMatrix=function(v){var w=[];return d.invert(w,v),[[w[0],w[1],w[2],w[3]],[w[4],w[5],w[6],w[7]],[w[8],w[9],w[10],w[11]],[w[12],w[13],w[14],w[15]]]}},{"gl-mat4":210}],522:[function(m,G,W){G.exports={mod:function(d,v){var w=d%v;return w<0?w+v:w},modHalf:function(d,v){return Math.abs(d)>v/2?d-Math.round(d/v)*v:d}}},{}],523:[function(m,G,W){var d=m("fast-isnumeric"),v=m("./array").isArrayOrTypedArray;function w(g,u){return function(){var s,h,l,o,p,c=g;for(o=0;o<u.length-1;o++){if((s=u[o])===-1){for(h=!0,l=[],p=0;p<c.length;p++)l[p]=w(c[p],u.slice(o+1))(),l[p]!==l[0]&&(h=!1);return h?l[0]:l}if(typeof s=="number"&&!v(c)||typeof(c=c[s])!="object"||c===null)return}if(typeof c=="object"&&c!==null&&(l=c[u[o]])!==null)return l}}G.exports=function(g,u){if(d(u))u=String(u);else if(typeof u!="string"||u.substr(u.length-4)==="[-1]")throw"bad property string";for(var s,h,l,o=0,p=u.split(".");o<p.length;){if(s=String(p[o]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(s[1])p[o]=s[1];else{if(o!==0)throw"bad property string";p.splice(0,1)}for(h=s[2].substr(1,s[2].length-2).split("]["),l=0;l<h.length;l++)o++,p.splice(o,0,Number(h[l]))}o++}return typeof g!="object"?function(c,i,x){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:x,obj:c}}(g,u,p):{set:t(g,p,u),get:w(g,p),astr:u,parts:p,obj:g}};var y=/(^|\.)args\[/;function e(g,u){return g===void 0||g===null&&!u.match(y)}function t(g,u,s){return function(h){var l,o,p=g,c="",i=e(h,s);for(o=0;o<u.length-1;o++){if(typeof(l=u[o])=="number"&&!v(p))throw"array index but container is not an array";if(l===-1){if(i=!a(p,u.slice(o+1),h,s))break;return}if(!r(p,l,u[o+1],i))break;if(typeof(p=p[l])!="object"||p===null)throw"container is not an object";c=n(c,l)}if(i){if(o===u.length-1&&(delete p[u[o]],Array.isArray(p)&&+u[o]==p.length-1))for(;p.length&&p[p.length-1]===void 0;)p.pop()}else p[u[o]]=h}}function n(g,u){var s=u;return d(u)?s="["+u+"]":g&&(s="."+u),g+s}function a(g,u,s,h){var l,o=v(s),p=!0,c=s,i=h.replace("-1",0),x=!o&&e(s,i),f=u[0];for(l=0;l<g.length;l++)i=h.replace("-1",l),o&&(x=e(c=s[l%s.length],i)),x&&(p=!1),r(g,l,f,x)&&t(g[l],u,h.replace("-1",l))(c);return p}function r(g,u,s,h){if(g[u]===void 0){if(h)return!1;g[u]=typeof s=="number"?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(m,G,W){G.exports=function(){}},{}],525:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=[];G.exports=function(y,e){if(w.indexOf(y)===-1){w.push(y);var t=1e3;v(e)?t=e:e==="long"&&(t=3e3);var n=d.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0),n.selectAll(".notifier-note").data(w).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(r){var g=d.select(this);g.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){g.transition().call(a)});for(var u=g.append("p"),s=r.split(/<br\s*\/?>/g),h=0;h<s.length;h++)h&&u.append("br"),u.append("span").text(s[h]);e==="stick"?g.transition().duration(350).style("opacity",1):g.transition().duration(700).style("opacity",1).transition().delay(t).call(a)})}function a(r){r.duration(700).style("opacity",0).each("end",function(g){var u=w.indexOf(g);u!==-1&&w.splice(u,1),d.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(m,G,W){var d=m("./setcursor"),v="data-savedcursor";G.exports=function(w,y){var e=w.attr(v);if(y){if(!e){for(var t=(w.attr("class")||"").split(" "),n=0;n<t.length;n++){var a=t[n];a.indexOf("cursor-")===0&&w.attr(v,a.substr(7)).classed(a,!1)}w.attr(v)||w.attr(v,"!!")}d(w,y)}else e&&(w.attr(v,null),e==="!!"?d(w):d(w,e))}},{"./setcursor":536}],527:[function(m,G,W){var d=m("./matrix").dot,v=m("../constants/numerical").BADNUM,w=G.exports={};w.tester=function(y){var e,t=y.slice(),n=t[0][0],a=n,r=t[0][1],g=r;for(t[t.length-1][0]===t[0][0]&&t[t.length-1][1]===t[0][1]||t.push(t[0]),e=1;e<t.length;e++)n=Math.min(n,t[e][0]),a=Math.max(a,t[e][0]),r=Math.min(r,t[e][1]),g=Math.max(g,t[e][1]);var u,s=!1;t.length===5&&(t[0][0]===t[1][0]?t[2][0]===t[3][0]&&t[0][1]===t[3][1]&&t[1][1]===t[2][1]&&(s=!0,u=function(o){return o[0]===t[0][0]}):t[0][1]===t[1][1]&&t[2][1]===t[3][1]&&t[0][0]===t[3][0]&&t[1][0]===t[2][0]&&(s=!0,u=function(o){return o[1]===t[0][1]}));var h=!0,l=t[0];for(e=1;e<t.length;e++)if(l[0]!==t[e][0]||l[1]!==t[e][1]){h=!1;break}return{xmin:n,xmax:a,ymin:r,ymax:g,pts:t,contains:s?function(o,p){var c=o[0],i=o[1];return!(c===v||c<n||c>a||i===v||i<r||i>g)&&(!p||!u(o))}:function(o,p){var c=o[0],i=o[1];if(c===v||c<n||c>a||i===v||i<r||i>g)return!1;var x,f,_,b,T,k=t.length,L=t[0][0],A=t[0][1],I=0;for(x=1;x<k;x++)if(f=L,_=A,L=t[x][0],A=t[x][1],!(c<(b=Math.min(f,L))||c>Math.max(f,L)||i>Math.max(_,A)))if(i<Math.min(_,A))c!==b&&I++;else{if(i===(T=L===f?i:_+(c-f)*(A-_)/(L-f)))return x!==1||!p;i<=T&&c!==b&&I++}return I%2==1},isRect:s,degenerate:h}},w.isSegmentBent=function(y,e,t,n){var a,r,g,u=y[e],s=[y[t][0]-u[0],y[t][1]-u[1]],h=d(s,s),l=Math.sqrt(h),o=[-s[1]/l,s[0]/l];for(a=e+1;a<t;a++)if(r=[y[a][0]-u[0],y[a][1]-u[1]],(g=d(r,s))<0||g>h||Math.abs(d(r,o))>n)return!0;return!1},w.filter=function(y,e){var t=[y[0]],n=0,a=0;function r(g){y.push(g);var u=t.length,s=n;t.splice(a+1);for(var h=s+1;h<y.length;h++)(h===y.length-1||w.isSegmentBent(y,s,h+1,e))&&(t.push(y[h]),t.length<u-2&&(n=h,a=t.length-1),s=h)}return y.length>1&&r(y.pop()),{addPt:r,raw:y,filtered:t}}},{"../constants/numerical":491,"./matrix":521}],528:[function(m,G,W){(function(d){(function(){var v=m("./show_no_webgl_msg"),w=m("regl");G.exports=function(y,e,t){var n=y._fullLayout,a=!0;return n._glcanvas.each(function(r){if(r.regl)r.regl.preloadCachedCode(t);else if(!r.pick||n._has("parcoords")){try{r.regl=w({canvas:this,attributes:{antialias:!r.pick,preserveDrawingBuffer:!0},pixelRatio:y._context.plotGlPixelRatio||d.devicePixelRatio,extensions:e||[],cachedCode:t||{}})}catch{a=!1}r.regl||(a=!1),a&&this.addEventListener("webglcontextlost",function(g){y&&y.emit&&y.emit("plotly_webglcontextlost",{event:g,layer:r.key})},!1)}}),a||v({container:n._glcontainer.node()}),a}}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(m,G,W){var d=m("fast-isnumeric"),v=m("is-mobile");G.exports=function(w){var y;if(typeof(y=w&&w.hasOwnProperty("userAgent")?w.userAgent:function(){var u;return typeof navigator<"u"&&(u=navigator.userAgent),u&&u.headers&&typeof u.headers["user-agent"]=="string"&&(u=u.headers["user-agent"]),u}())!="string")return!0;var e=v({ua:{headers:{"user-agent":y}},tablet:!0,featureDetect:!1});if(!e){for(var t=y.split(" "),n=1;n<t.length;n++)if(t[n].indexOf("Safari")!==-1)for(var a=n-1;a>-1;a--){var r=t[a];if(r.substr(0,8)==="Version/"){var g=r.substr(8).split(".")[0];if(d(g)&&(g=+g),g>=13)return!0}}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(m,G,W){G.exports=function(d,v){if(v instanceof RegExp){for(var w=v.toString(),y=0;y<d.length;y++)if(d[y]instanceof RegExp&&d[y].toString()===w)return d;d.push(v)}else!v&&v!==0||d.indexOf(v)!==-1||d.push(v);return d}},{}],531:[function(m,G,W){var d=m("../lib"),v=m("../plot_api/plot_config").dfltConfig,w={add:function(y,e,t,n,a){var r,g;y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},g=y.undoQueue.index,y.autoplay?y.undoQueue.inSequence||(y.autoplay=!1):(!y.undoQueue.sequence||y.undoQueue.beginSequence?(r={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},y.undoQueue.queue.splice(g,y.undoQueue.queue.length-g,r),y.undoQueue.index+=1):r=y.undoQueue.queue[g-1],y.undoQueue.beginSequence=!1,r&&(r.undo.calls.unshift(e),r.undo.args.unshift(t),r.redo.calls.push(n),r.redo.args.push(a)),y.undoQueue.queue.length>v.queueLength&&(y.undoQueue.queue.shift(),y.undoQueue.index--))},startSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!0,y.undoQueue.beginSequence=!0},stopSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!1,y.undoQueue.beginSequence=!1},undo:function(y){var e,t;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index<=0)){for(y.undoQueue.index--,e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,t=0;t<e.undo.calls.length;t++)w.plotDo(y,e.undo.calls[t],e.undo.args[t]);y.undoQueue.inSequence=!1,y.autoplay=!1}},redo:function(y){var e,t;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index>=y.undoQueue.queue.length)){for(e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,t=0;t<e.redo.calls.length;t++)w.plotDo(y,e.redo.calls[t],e.redo.args[t]);y.undoQueue.inSequence=!1,y.autoplay=!1,y.undoQueue.index++}}};w.plotDo=function(y,e,t){y.autoplay=!0,t=function(n,a){for(var r,g=[],u=0;u<a.length;u++)r=a[u],g[u]=r===n?r:typeof r=="object"?Array.isArray(r)?d.extendDeep([],r):d.extendDeepAll({},r):r;return g}(y,t),e.apply(null,t)},G.exports=w},{"../lib":515,"../plot_api/plot_config":553}],532:[function(m,G,W){W.counter=function(d,v,w,y){var e=(v||"")+(w?"":"$"),t=y===!1?"":"^";return d==="xy"?new RegExp(t+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(t+d+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(m,G,W){var d=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,v=/^[^\.\[\]]+$/;G.exports=function(w,y){for(;y;){var e=w.match(d);if(e)w=e[1];else{if(!w.match(v))throw new Error("bad relativeAttr call:"+[w,y]);w=""}if(y.charAt(0)!=="^")break;y=y.slice(1)}return w&&y.charAt(0)!=="["?w+"."+y:w+y}},{}],534:[function(m,G,W){var d=m("./array").isArrayOrTypedArray,v=m("./is_plain_object");G.exports=function w(y,e){for(var t in e){var n=e[t],a=y[t];if(a!==n)if(t.charAt(0)==="_"||typeof n=="function"){if(t in y)continue;y[t]=n}else if(d(n)&&d(a)&&v(n[0])){if(t==="customdata"||t==="ids")continue;for(var r=Math.min(n.length,a.length),g=0;g<r;g++)a[g]!==n[g]&&v(n[g])&&v(a[g])&&w(a[g],n[g])}else v(n)&&v(a)&&(w(a,n),Object.keys(a).length||delete y[t])}}},{"./array":497,"./is_plain_object":516}],535:[function(m,G,W){var d=m("fast-isnumeric"),v=m("./loggers"),w=m("./identity"),y=m("../constants/numerical").BADNUM;function e(r,g){return r<g}function t(r,g){return r<=g}function n(r,g){return r>g}function a(r,g){return r>=g}W.findBin=function(r,g,u){if(d(g.start))return u?Math.ceil((r-g.start)/g.size-1e-9)-1:Math.floor((r-g.start)/g.size+1e-9);var s,h,l=0,o=g.length,p=0,c=o>1?(g[o-1]-g[0])/(o-1):1;for(h=c>=0?u?e:t:u?a:n,r+=1e-9*c*(u?-1:1)*(c>=0?1:-1);l<o&&p++<100;)h(g[s=Math.floor((l+o)/2)],r)?l=s+1:o=s;return p>90&&v.log("Long binary search..."),l-1},W.sorterAsc=function(r,g){return r-g},W.sorterDes=function(r,g){return g-r},W.distinctVals=function(r){var g,u=r.slice();for(u.sort(W.sorterAsc),g=u.length-1;g>-1&&u[g]===y;g--);for(var s,h=u[g]-u[0]||1,l=h/(g||1)/1e4,o=[],p=0;p<=g;p++){var c=u[p],i=c-s;s===void 0?(o.push(c),s=c):i>l&&(h=Math.min(h,i),o.push(c),s=c)}return{vals:o,minDiff:h}},W.roundUp=function(r,g,u){for(var s,h=0,l=g.length-1,o=0,p=u?0:1,c=u?1:0,i=u?Math.ceil:Math.floor;h<l&&o++<100;)g[s=i((h+l)/2)]<=r?h=s+p:l=s-c;return g[h]},W.sort=function(r,g){for(var u=0,s=0,h=1;h<r.length;h++){var l=g(r[h],r[h-1]);if(l<0?u=1:l>0&&(s=1),u&&s)return r.sort(g)}return s?r:r.reverse()},W.findIndexOfMin=function(r,g){g=g||w;for(var u,s=1/0,h=0;h<r.length;h++){var l=g(r[h]);l<s&&(s=l,u=h)}return u}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(m,G,W){G.exports=function(d,v){(d.attr("class")||"").split(" ").forEach(function(w){w.indexOf("cursor-")===0&&d.classed(w,!1)}),v&&d.classed("cursor-"+v,!0)}},{}],537:[function(m,G,W){var d=m("../components/color"),v=function(){};G.exports=function(w){for(var y in w)typeof w[y]=="function"&&(w[y]=v);w.destroy=function(){w.container.parentNode.removeChild(w.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=d.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=d.lightLine,e.style["z-index"]=30;var t=document.createElement("p");return t.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",t.style.position="relative",t.style.top="50%",t.style.left="50%",t.style.height="30%",t.style.width="50%",t.style.margin="-15% 0 0 -25%",e.appendChild(t),w.container.appendChild(e),w.container.style.background="#FFFFFF",w.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(m,G,W){G.exports=function(d){return Object.keys(d).sort()}},{}],539:[function(m,G,W){var d=m("fast-isnumeric"),v=m("./array").isArrayOrTypedArray;W.aggNums=function(w,y,e,t){var n,a;if((!t||t>e.length)&&(t=e.length),d(y)||(y=!1),v(e[0])){for(a=new Array(t),n=0;n<t;n++)a[n]=W.aggNums(w,y,e[n]);e=a}for(n=0;n<t;n++)d(y)?d(e[n])&&(y=w(+y,+e[n])):y=e[n];return y},W.len=function(w){return W.aggNums(function(y){return y+1},0,w)},W.mean=function(w,y){return y||(y=W.len(w)),W.aggNums(function(e,t){return e+t},0,w)/y},W.midRange=function(w){if(w!==void 0&&w.length!==0)return(W.aggNums(Math.max,null,w)+W.aggNums(Math.min,null,w))/2},W.variance=function(w,y,e){return y||(y=W.len(w)),d(e)||(e=W.mean(w,y)),W.aggNums(function(t,n){return t+Math.pow(n-e,2)},0,w)/y},W.stdev=function(w,y,e){return Math.sqrt(W.variance(w,y,e))},W.median=function(w){var y=w.slice().sort();return W.interp(y,.5)},W.interp=function(w,y){if(!d(y))throw"n should be a finite number";if((y=y*w.length-.5)<0)return w[0];if(y>w.length-1)return w[w.length-1];var e=y%1;return e*w[Math.ceil(y)]+(1-e)*w[Math.floor(y)]}},{"./array":497,"fast-isnumeric":190}],540:[function(m,G,W){var d=m("color-normalize");G.exports=function(v){return v?d(v):[0,0,0,1]}},{"color-normalize":89}],541:[function(m,G,W){var d=m("@plotly/d3"),v=m("../lib"),w=v.strTranslate,y=m("../constants/xmlns_namespaces"),e=m("../constants/alignment").LINE_SPACING,t=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;W.convertToTspans=function(S,E,z){var D=S.text(),j=!S.attr("data-notex")&&E&&E._context.typesetMath&&typeof MathJax<"u"&&D.match(t),V=d.select(S.node().parentNode);if(!V.empty()){var Z=S.attr("class")?S.attr("class").split(" ")[0]:"text";return Z+="-math",V.selectAll("svg."+Z).remove(),V.selectAll("g."+Z+"-group").remove(),S.style("display",null).attr({"data-unformatted":D,"data-math":"N"}),j?(E&&E._promises||[]).push(new Promise(function(K){S.style("display","none");var $=parseInt(S.node().style.fontSize,10),ne={fontSize:$};(function(H,N,U){var te,B,X,J,ee=parseInt((MathJax.version||"").split(".")[0]);if(ee!==2&&ee!==3)return void v.warn("No MathJax version:",MathJax.version);var re=function(){var oe="math-output-"+v.randstr({},64),de=(J=d.select("body").append("div").attr({id:oe}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(H.replace(n,"\\lt ").replace(a,"\\gt "))).node();return ee===2?MathJax.Hub.Typeset(de):MathJax.typeset([de])},se=function(){var oe=J.select(ee===2?".MathJax_SVG":".MathJax"),de=!oe.empty()&&J.select("svg").node();if(de){var ce,ve=de.getBoundingClientRect();ce=ee===2?d.select("body").select("#MathJax_SVG_glyphs"):oe.select("defs"),U(oe,ce,ve)}else v.log("There was an error in the tex syntax.",H),U();J.remove()};ee===2?MathJax.Hub.Queue(function(){return B=v.extendDeepAll({},MathJax.Hub.config),X=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:r},displayAlign:"left"})},function(){if((te=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},re,se,function(){if(te!=="SVG")return MathJax.Hub.setRenderer(te)},function(){return X!==void 0&&(MathJax.Hub.processSectionDelay=X),MathJax.Hub.Config(B)}):ee===3&&(B=v.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=r,(te=MathJax.config.startup.output)!=="svg"&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){re(),se(),te!=="svg"&&(MathJax.config.startup.output=te),MathJax.config=B}))})(j[2],ne,function(H,N,U){V.selectAll("svg."+Z).remove(),V.selectAll("g."+Z+"-group").remove();var te=H&&H.select("svg");if(!te||!te.node())return Q(),void K();var B=V.append("g").classed(Z+"-group",!0).attr({"pointer-events":"none","data-unformatted":D,"data-math":"Y"});B.node().appendChild(te.node()),N&&N.node()&&te.node().insertBefore(N.node().cloneNode(!0),te.node().firstChild);var X=U.width,J=U.height;te.attr({class:Z,height:J,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ee=S.node().style.fill||"black",re=te.select("g");re.attr({fill:ee,stroke:ee});var se=re.node().getBoundingClientRect(),oe=se.width,de=se.height;(oe>X||de>J)&&(te.style("overflow","hidden"),oe=(se=te.node().getBoundingClientRect()).width,de=se.height);var ce=+S.attr("x"),ve=+S.attr("y"),Ae=-($||S.node().getBoundingClientRect().height)/4;if(Z[0]==="y")B.attr({transform:"rotate("+[-90,ce,ve]+")"+w(-oe/2,Ae-de/2)});else if(Z[0]==="l")ve=Ae-de/2;else if(Z[0]==="a"&&Z.indexOf("atitle")!==0)ce=0,ve=Ae;else{var fe=S.attr("text-anchor");ce-=oe*(fe==="middle"?.5:fe==="end"?1:0),ve=ve+Ae-de/2}te.attr({x:ce,y:ve}),z&&z.call(S,B),K(B)})})):Q(),S}function Q(){V.empty()||(Z=S.attr("class")+"-math",V.select("svg."+Z).remove()),S.text("").style("white-space","pre"),function(K,$){$=$.replace(l," ");var ne,H=!1,N=[],U=-1;function te(){U++;var le=document.createElementNS(y.svg,"tspan");d.select(le).attr({class:"line",dy:U*e+"em"}),K.appendChild(le),ne=le;var ge=N;if(N=[{node:le}],ge.length>1)for(var Te=1;Te<ge.length;Te++)B(ge[Te])}function B(le){var ge,Te=le.type,Se={};if(Te==="a"){ge="a";var Me=le.target,ze=le.href,Oe=le.popup;ze&&(Se={"xlink:xlink:show":Me==="_blank"||Me.charAt(0)!=="_"?"new":"replace",target:Me,"xlink:xlink:href":ze},Oe&&(Se.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Oe+'");return false;'))}else ge="tspan";le.style&&(Se.style=le.style);var De=document.createElementNS(y.svg,ge);if(Te==="sup"||Te==="sub"){X(ne,"\u200B"),ne.appendChild(De);var Xe=document.createElementNS(y.svg,"tspan");X(Xe,"\u200B"),d.select(Xe).attr("dy",s[Te]),Se.dy=u[Te],ne.appendChild(De),ne.appendChild(Xe)}else ne.appendChild(De);d.select(De).attr(Se),ne=le.node=De,N.push(le)}function X(le,ge){le.appendChild(document.createTextNode(ge))}function J(le){if(N.length!==1){var ge=N.pop();le!==ge.type&&v.log("Start tag <"+ge.type+"> doesnt match end tag <"+le+">. Pretending it did match.",$),ne=N[N.length-1].node}else v.log("Ignoring unexpected end tag </"+le+">.",$)}c.test($)?te():(ne=K,N=[{node:K}]);for(var ee=$.split(o),re=0;re<ee.length;re++){var se=ee[re],oe=se.match(p),de=oe&&oe[2].toLowerCase(),ce=g[de];if(de==="br")te();else if(ce===void 0)X(ne,A(se));else if(oe[1])J(de);else{var ve=oe[4],Ae={type:de},fe=b(ve,i);if(fe?(fe=fe.replace(T,"$1 fill:"),ce&&(fe+=";"+ce)):ce&&(fe=ce),fe&&(Ae.style=fe),de==="a"){H=!0;var me=b(ve,x);if(me){var _e=I(me);_e&&(Ae.href=_e,Ae.target=b(ve,f)||"_blank",Ae.popup=b(ve,_))}}B(Ae)}}return H}(S.node(),D)&&S.style("pointer-events","all"),W.positionText(S),z&&z.call(S)}};var n=/(<|&lt;|&#60;)/g,a=/(>|&gt;|&#62;)/g,r=[["$","$"],["\\(","\\)"]],g={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},u={sub:"0.3em",sup:"-0.6em"},s={sub:"-0.21em",sup:"0.42em"},h=["http:","https:","mailto:","",void 0,":"],l=W.NEWLINES=/(\r\n?|\n)/g,o=/(<[^<>]*>)/,p=/<(\/?)([^ >]*)(\s+(.*))?>/i,c=/<br(\s+.*)?>/i;W.BR_TAG_ALL=/<br(\s+.*)?>/gi;var i=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,x=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,f=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,_=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function b(S,E){if(!S)return null;var z=S.match(E),D=z&&(z[3]||z[4]);return D&&A(D)}var T=/(^|;)\s*color:/;W.plainText=function(S,E){for(var z=(E=E||{}).len!==void 0&&E.len!==-1?E.len:1/0,D=E.allowedTags!==void 0?E.allowedTags:["br"],j=3,V=S.split(o),Z=[],Q="",K=0,$=0;$<V.length;$++){var ne=V[$],H=ne.match(p),N=H&&H[2].toLowerCase();if(N)D.indexOf(N)!==-1&&(Z.push(ne),Q=N);else{var U=ne.length;if(K+U<z)Z.push(ne),K+=U;else if(K<z){var te=z-K;Q&&(Q!=="br"||te<=j||U<=j)&&Z.pop(),z>j?Z.push(ne.substr(0,te-j)+"..."):Z.push(ne.substr(0,te));break}Q=""}}return Z.join("")};var k={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function A(S){return S.replace(L,function(E,z){return(z.charAt(0)==="#"?function(D){if(!(D>1114111)){var j=String.fromCodePoint;if(j)return j(D);var V=String.fromCharCode;return D<=65535?V(D):V(55232+(D>>10),D%1024+56320)}}(z.charAt(1)==="x"?parseInt(z.substr(2),16):parseInt(z.substr(1),10)):k[z])||E})}function I(S){var E=encodeURI(decodeURI(S)),z=document.createElement("a"),D=document.createElement("a");z.href=S,D.href=E;var j=z.protocol,V=D.protocol;return h.indexOf(j)!==-1&&h.indexOf(V)!==-1?E:""}function P(S,E,z){var D,j,V,Z=z.horizontalAlign,Q=z.verticalAlign||"top",K=S.node().getBoundingClientRect(),$=E.node().getBoundingClientRect();return j=Q==="bottom"?function(){return K.bottom-D.height}:Q==="middle"?function(){return K.top+(K.height-D.height)/2}:function(){return K.top},V=Z==="right"?function(){return K.right-D.width}:Z==="center"?function(){return K.left+(K.width-D.width)/2}:function(){return K.left},function(){D=this.node().getBoundingClientRect();var ne=V()-$.left,H=j()-$.top,N=z.gd||{};if(z.gd){N._fullLayout._calcInverseTransform(N);var U=v.apply3DTransform(N._fullLayout._invTransform)(ne,H);ne=U[0],H=U[1]}return this.style({top:H+"px",left:ne+"px","z-index":1e3}),this}}W.convertEntities=A,W.sanitizeHTML=function(S){S=S.replace(l," ");for(var E=document.createElement("p"),z=E,D=[],j=S.split(o),V=0;V<j.length;V++){var Z=j[V],Q=Z.match(p),K=Q&&Q[2].toLowerCase();if(K in g)if(Q[1])D.length&&(z=D.pop());else{var $=Q[4],ne=b($,i),H=ne?{style:ne}:{};if(K==="a"){var N=b($,x);if(N){var U=I(N);if(U){H.href=U;var te=b($,f);te&&(H.target=te)}}}var B=document.createElement(K);z.appendChild(B),d.select(B).attr(H),z=B,D.push(B)}else z.appendChild(document.createTextNode(A(Z)))}return E.innerHTML},W.lineCount=function(S){return S.selectAll("tspan.line").size()||1},W.positionText=function(S,E,z){return S.each(function(){var D=d.select(this);function j(Q,K){return K===void 0?(K=D.attr(Q))===null&&(D.attr(Q,0),K=0):D.attr(Q,K),K}var V=j("x",E),Z=j("y",z);this.nodeName==="text"&&D.selectAll("tspan.line").attr({x:V,y:Z})})},W.makeTextShadow=function(S){var E="1px ",z="1px ",D="1px ";return E+z+D+S+", -"+E+"-"+z+D+S+", "+E+"-"+z+D+S+", -"+E+z+D+S},W.makeEditable=function(S,E){var z=E.gd,D=E.delegate,j=d.dispatch("edit","input","cancel"),V=D||S;if(S.style({"pointer-events":D?"none":"all"}),S.size()!==1)throw new Error("boo");function Z(){(function(){var ne=d.select(z).select(".svg-container"),H=ne.append("div"),N=S.node().style,U=parseFloat(N.fontSize||12),te=E.text;te===void 0&&(te=S.attr("data-unformatted")),H.classed("plugin-editable editable",!0).style({position:"absolute","font-family":N.fontFamily||"Arial","font-size":U,color:E.fill||N.fill||"black",opacity:1,"background-color":E.background||"transparent",outline:"#ffffff33 1px solid",margin:[-U/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(te).call(P(S,ne,E)).on("blur",function(){z._editing=!1,S.text(this.textContent).style({opacity:1});var B,X=d.select(this).attr("class");(B=X?"."+X.split(" ")[0]+"-math-group":"[class*=-math-group]")&&d.select(S.node().parentNode).select(B).style({opacity:0});var J=this.textContent;d.select(this).transition().duration(0).remove(),d.select(document).on("mouseup",null),j.edit.call(S,J)}).on("focus",function(){var B=this;z._editing=!0,d.select(document).on("mouseup",function(){if(d.event.target===B)return!1;document.activeElement===H.node()&&H.node().blur()})}).on("keyup",function(){d.event.which===27?(z._editing=!1,S.style({opacity:1}),d.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),j.cancel.call(S,this.textContent)):(j.input.call(S,this.textContent),d.select(this).call(P(S,ne,E)))}).on("keydown",function(){d.event.which===13&&this.blur()}).call(Q)})(),S.style({opacity:0});var K,$=V.attr("class");(K=$?"."+$.split(" ")[0]+"-math-group":"[class*=-math-group]")&&d.select(S.node().parentNode).select(K).style({opacity:0})}function Q(K){var $=K.node(),ne=document.createRange();ne.selectNodeContents($);var H=window.getSelection();H.removeAllRanges(),H.addRange(ne),$.focus()}return E.immediate?Z():V.on("click",Z),d.rebind(S,j,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(m,G,W){var d={};function v(w){w&&w.timer!==null&&(clearTimeout(w.timer),w.timer=null)}W.throttle=function(w,y,e){var t=d[w],n=Date.now();if(!t){for(var a in d)d[a].ts<n-6e4&&delete d[a];t=d[w]={ts:0,timer:null}}function r(){e(),t.ts=Date.now(),t.onDone&&(t.onDone(),t.onDone=null)}v(t),n>t.ts+y?r():t.timer=setTimeout(function(){r(),t.timer=null},y)},W.done=function(w){var y=d[w];return y&&y.timer?new Promise(function(e){var t=y.onDone;y.onDone=function(){t&&t(),e(),y.onDone=null}}):Promise.resolve()},W.clear=function(w){if(w)v(d[w]),delete d[w];else for(var y in d)W.clear(y)}},{}],543:[function(m,G,W){var d=m("fast-isnumeric");G.exports=function(v,w){if(v>0)return Math.log(v)/Math.LN10;var y=Math.log(Math.min(w[0],w[1]))/Math.LN10;return d(y)||(y=Math.log(Math.max(w[0],w[1]))/Math.LN10-6),y}},{"fast-isnumeric":190}],544:[function(m,G,W){var d=G.exports={},v=m("../plots/geo/constants").locationmodeToLayer,w=m("topojson-client").feature;d.getTopojsonName=function(y){return[y.scope.replace(/ /g,"-"),"_",y.resolution.toString(),"m"].join("")},d.getTopojsonPath=function(y,e){return y+e+".json"},d.getTopojsonFeatures=function(y,e){var t=v[y.locationmode],n=e.objects[t];return w(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(m,G,W){G.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(m,G,W){G.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(m,G,W){var d=m("../registry");G.exports=function(v){for(var w,y,e=d.layoutArrayContainers,t=d.layoutArrayRegexes,n=v.split("[")[0],a=0;a<t.length;a++)if((y=v.match(t[a]))&&y.index===0){w=y[0];break}if(w||(w=e[e.indexOf(n)]),!w)return!1;var r=v.substr(w.length);return r?!!(y=r.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:w,index:Number(y[1]),property:y[3]||""}:{array:w,index:"",property:""}}},{"../registry":647}],548:[function(m,G,W){var d=m("../lib"),v=d.extendFlat,w=d.isPlainObject,y={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},t=y.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");function a(u){for(var s={},h=0;h<u.length;h++)s[u[h]]=!1;return s}function r(u,s,h){var l=v({},u);for(var o in l){var p=l[o];w(p)&&(l[o]=g(p,s,h,o))}return h==="from-root"&&(l.editType=s),l}function g(u,s,h,l){if(u.valType){var o=v({},u);if(o.editType=s,Array.isArray(u.items)){o.items=new Array(u.items.length);for(var p=0;p<u.items.length;p++)o.items[p]=g(u.items[p],s)}return o}return r(u,s,l.charAt(0)==="_"?"nested":"from-root")}G.exports={traces:y,layout:e,traceFlags:function(){return a(t)},layoutFlags:function(){return a(n)},update:function(u,s){var h=s.editType;if(h&&h!=="none")for(var l=h.split("+"),o=0;o<l.length;o++)u[l[o]]=!0},overrideAll:r}},{"../lib":515}],549:[function(m,G,W){var d=m("fast-isnumeric"),v=m("gl-mat4/fromQuat"),w=m("../registry"),y=m("../lib"),e=m("../plots/plots"),t=m("../plots/cartesian/axis_ids"),n=m("../components/color"),a=t.cleanId,r=t.getFromTrace,g=w.traceIs;function u(f,_){var b=f[_],T=_.charAt(0);b&&b!=="paper"&&(f[_]=a(b,T,!0))}function s(f){function _(b,T){var k=f[b],L=f.title&&f.title[T];k&&!L&&(f.title||(f.title={}),f.title[T]=f[b],delete f[b])}f&&(typeof f.title!="string"&&typeof f.title!="number"||(f.title={text:f.title}),_("titlefont","font"),_("titleposition","position"),_("titleside","side"),_("titleoffset","offset"))}function h(f){if(!y.isPlainObject(f))return!1;var _=f.name;return delete f.name,delete f.showlegend,(typeof _=="string"||typeof _=="number")&&String(_)}function l(f,_,b,T){if(b&&!T)return f;if(T&&!b||!f.trim())return _;if(!_.trim())return f;var k,L=Math.min(f.length,_.length);for(k=0;k<L&&f.charAt(k)===_.charAt(k);k++);return f.substr(0,k).trim()}function o(f){var _="middle",b="center";return typeof f=="string"&&(f.indexOf("top")!==-1?_="top":f.indexOf("bottom")!==-1&&(_="bottom"),f.indexOf("left")!==-1?b="left":f.indexOf("right")!==-1&&(b="right")),_+" "+b}function p(f,_){return _ in f&&typeof f[_]=="object"&&Object.keys(f[_]).length===0}W.clearPromiseQueue=function(f){Array.isArray(f._promises)&&f._promises.length>0&&y.log("Clearing previous rejected promises from queue."),f._promises=[]},W.cleanLayout=function(f){var _,b;f||(f={}),f.xaxis1&&(f.xaxis||(f.xaxis=f.xaxis1),delete f.xaxis1),f.yaxis1&&(f.yaxis||(f.yaxis=f.yaxis1),delete f.yaxis1),f.scene1&&(f.scene||(f.scene=f.scene1),delete f.scene1);var T=(e.subplotsRegistry.cartesian||{}).attrRegex,k=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,A=(e.subplotsRegistry.gl3d||{}).attrRegex,I=Object.keys(f);for(_=0;_<I.length;_++){var P=I[_];if(T&&T.test(P)){var S=f[P];S.anchor&&S.anchor!=="free"&&(S.anchor=a(S.anchor)),S.overlaying&&(S.overlaying=a(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":S.isdate===!1&&S.islog===!1&&(S.type="linear")),S.autorange!=="withzero"&&S.autorange!=="tozero"||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,p(S,"domain")&&delete S.domain,S.autotick!==void 0&&(S.tickmode===void 0&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),s(S)}else if(k&&k.test(P))s(f[P].radialaxis);else if(L&&L.test(P)){var E=f[P];s(E.aaxis),s(E.baxis),s(E.caxis)}else if(A&&A.test(P)){var z=f[P],D=z.cameraposition;if(Array.isArray(D)&&D[0].length===4){var j=D[0],V=D[1],Z=D[2],Q=v([],j),K=[];for(b=0;b<3;++b)K[b]=V[b]+Z*Q[2+4*b];z.camera={eye:{x:K[0],y:K[1],z:K[2]},center:{x:V[0],y:V[1],z:V[2]},up:{x:0,y:0,z:1}},delete z.cameraposition}s(z.xaxis),s(z.yaxis),s(z.zaxis)}}var $=Array.isArray(f.annotations)?f.annotations.length:0;for(_=0;_<$;_++){var ne=f.annotations[_];y.isPlainObject(ne)&&(ne.ref&&(ne.ref==="paper"?(ne.xref="paper",ne.yref="paper"):ne.ref==="data"&&(ne.xref="x",ne.yref="y"),delete ne.ref),u(ne,"xref"),u(ne,"yref"))}var H=Array.isArray(f.shapes)?f.shapes.length:0;for(_=0;_<H;_++){var N=f.shapes[_];y.isPlainObject(N)&&(u(N,"xref"),u(N,"yref"))}var U=Array.isArray(f.images)?f.images.length:0;for(_=0;_<U;_++){var te=f.images[_];y.isPlainObject(te)&&(u(te,"xref"),u(te,"yref"))}var B=f.legend;return B&&(B.x>3?(B.x=1.02,B.xanchor="left"):B.x<-2&&(B.x=-.02,B.xanchor="right"),B.y>3?(B.y=1.02,B.yanchor="bottom"):B.y<-2&&(B.y=-.02,B.yanchor="top")),s(f),f.dragmode==="rotate"&&(f.dragmode="orbit"),n.clean(f),f.template&&f.template.layout&&W.cleanLayout(f.template.layout),f},W.cleanData=function(f){for(var _=0;_<f.length;_++){var b,T=f[_];if(T.type==="histogramy"&&"xbins"in T&&!("ybins"in T)&&(T.ybins=T.xbins,delete T.xbins),T.error_y&&"opacity"in T.error_y){var k=n.defaults,L=T.error_y.color||(g(T,"bar")?n.defaultLine:k[_%k.length]);T.error_y.color=n.addOpacity(n.rgb(L),n.opacity(L)*T.error_y.opacity),delete T.error_y.opacity}if("bardir"in T&&(T.bardir!=="h"||!g(T,"bar")&&T.type.substr(0,9)!=="histogram"||(T.orientation="h",W.swapXYData(T)),delete T.bardir),T.type==="histogramy"&&W.swapXYData(T),T.type!=="histogramx"&&T.type!=="histogramy"||(T.type="histogram"),"scl"in T&&!("colorscale"in T)&&(T.colorscale=T.scl,delete T.scl),"reversescl"in T&&!("reversescale"in T)&&(T.reversescale=T.reversescl,delete T.reversescl),T.xaxis&&(T.xaxis=a(T.xaxis,"x")),T.yaxis&&(T.yaxis=a(T.yaxis,"y")),g(T,"gl3d")&&T.scene&&(T.scene=e.subplotsRegistry.gl3d.cleanId(T.scene)),!g(T,"pie-like")&&!g(T,"bar-like"))if(Array.isArray(T.textposition))for(b=0;b<T.textposition.length;b++)T.textposition[b]=o(T.textposition[b]);else T.textposition&&(T.textposition=o(T.textposition));var A=w.getModule(T);if(A&&A.colorbar){var I=A.colorbar.container,P=I?T[I]:T;P&&P.colorscale&&(P.colorscale==="YIGnBu"&&(P.colorscale="YlGnBu"),P.colorscale==="YIOrRd"&&(P.colorscale="YlOrRd"))}if(T.type==="surface"&&y.isPlainObject(T.contours)){var S=["x","y","z"];for(b=0;b<S.length;b++){var E=T.contours[S[b]];y.isPlainObject(E)&&(E.highlightColor&&(E.highlightcolor=E.highlightColor,delete E.highlightColor),E.highlightWidth&&(E.highlightwidth=E.highlightWidth,delete E.highlightWidth))}}if(T.type==="candlestick"||T.type==="ohlc"){var z=(T.increasing||{}).showlegend!==!1,D=(T.decreasing||{}).showlegend!==!1,j=h(T.increasing),V=h(T.decreasing);if(j!==!1&&V!==!1){var Z=l(j,V,z,D);Z&&(T.name=Z)}else!j&&!V||T.name||(T.name=j||V)}if(Array.isArray(T.transforms)){var Q=T.transforms;for(b=0;b<Q.length;b++){var K=Q[b];if(y.isPlainObject(K))switch(K.type){case"filter":K.filtersrc&&(K.target=K.filtersrc,delete K.filtersrc),K.calendar&&(K.valuecalendar||(K.valuecalendar=K.calendar),delete K.calendar);break;case"groupby":if(K.styles=K.styles||K.style,K.styles&&!Array.isArray(K.styles)){var $=K.styles,ne=Object.keys($);K.styles=[];for(var H=0;H<ne.length;H++)K.styles.push({target:ne[H],value:$[ne[H]]})}}}}p(T,"line")&&delete T.line,"marker"in T&&(p(T.marker,"line")&&delete T.marker.line,p(T,"marker")&&delete T.marker),n.clean(T),T.autobinx&&(delete T.autobinx,delete T.xbins),T.autobiny&&(delete T.autobiny,delete T.ybins),s(T),T.colorbar&&s(T.colorbar),T.marker&&T.marker.colorbar&&s(T.marker.colorbar),T.line&&T.line.colorbar&&s(T.line.colorbar),T.aaxis&&s(T.aaxis),T.baxis&&s(T.baxis)}},W.swapXYData=function(f){var _;if(y.swapAttrs(f,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(f.z)&&Array.isArray(f.z[0])&&(f.transpose?delete f.transpose:f.transpose=!0),f.error_x&&f.error_y){var b=f.error_y,T="copy_ystyle"in b?b.copy_ystyle:!(b.color||b.thickness||b.width);y.swapAttrs(f,["error_?.copy_ystyle"]),T&&y.swapAttrs(f,["error_?.color","error_?.thickness","error_?.width"])}if(typeof f.hoverinfo=="string"){var k=f.hoverinfo.split("+");for(_=0;_<k.length;_++)k[_]==="x"?k[_]="y":k[_]==="y"&&(k[_]="x");f.hoverinfo=k.join("+")}},W.coerceTraceIndices=function(f,_){if(d(_))return[_];if(!Array.isArray(_)||!_.length)return f.data.map(function(k,L){return L});if(Array.isArray(_)){for(var b=[],T=0;T<_.length;T++)y.isIndex(_[T],f.data.length)?b.push(_[T]):y.warn("trace index (",_[T],") is not a number or is out of bounds");return b}return _},W.manageArrayContainers=function(f,_,b){var T=f.obj,k=f.parts,L=k.length,A=k[L-1],I=d(A);if(I&&_===null){var P=k.slice(0,L-1).join(".");y.nestedProperty(T,P).get().splice(A,1)}else I&&f.get()===void 0&&f.get()===void 0&&(b[f.astr]=null),f.set(_)};var c=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function i(f){var _=f.search(c);if(_>0)return f.substr(0,_)}W.hasParent=function(f,_){for(var b=i(_);b;){if(b in f)return!0;b=i(b)}return!1};var x=["x","y","z"];W.clearAxisTypes=function(f,_,b){for(var T=0;T<_.length;T++)for(var k=f._fullData[T],L=0;L<3;L++){var A=r(f,k,x[L]);if(A&&A.type!=="log"){var I=A._name,P=A._id.substr(1);if(P.substr(0,5)==="scene"){if(b[P]!==void 0)continue;I=P+"."+I}var S=I+".type";b[I]===void 0&&b[S]===void 0&&y.nestedProperty(f.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(m,G,W){var d=m("./plot_api");W._doPlot=d._doPlot,W.newPlot=d.newPlot,W.restyle=d.restyle,W.relayout=d.relayout,W.redraw=d.redraw,W.update=d.update,W._guiRestyle=d._guiRestyle,W._guiRelayout=d._guiRelayout,W._guiUpdate=d._guiUpdate,W._storeDirectGUIEdit=d._storeDirectGUIEdit,W.react=d.react,W.extendTraces=d.extendTraces,W.prependTraces=d.prependTraces,W.addTraces=d.addTraces,W.deleteTraces=d.deleteTraces,W.moveTraces=d.moveTraces,W.purge=d.purge,W.addFrames=d.addFrames,W.deleteFrames=d.deleteFrames,W.animate=d.animate,W.setPlotConfig=d.setPlotConfig,W.toImage=m("./to_image"),W.validate=m("./validate"),W.downloadImage=m("../snapshot/download");var v=m("./template_api");W.makeTemplate=v.makeTemplate,W.validateTemplate=v.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(m,G,W){var d=m("../lib/is_plain_object"),v=m("../lib/noop"),w=m("../lib/loggers"),y=m("../lib/search").sorterAsc,e=m("../registry");W.containerArrayMatch=m("./container_array_match");var t=W.isAddVal=function(a){return a==="add"||d(a)},n=W.isRemoveVal=function(a){return a===null||a==="remove"};W.applyContainerArrayChanges=function(a,r,g,u,s){var h=r.astr,l=e.getComponentMethod(h,"supplyLayoutDefaults"),o=e.getComponentMethod(h,"draw"),p=e.getComponentMethod(h,"drawOne"),c=u.replot||u.recalc||l===v||o===v,i=a.layout,x=a._fullLayout;if(g[""]){Object.keys(g).length>1&&w.warn("Full array edits are incompatible with other edits",h);var f=g[""][""];if(n(f))r.set(null);else{if(!Array.isArray(f))return w.warn("Unrecognized full array edit value",h,f),!0;r.set(f)}return!c&&(l(i,x),o(a),!0)}var _,b,T,k,L,A,I,P,S=Object.keys(g).map(Number).sort(y),E=r.get(),z=E||[],D=s(x,h).get(),j=[],V=-1,Z=z.length;for(_=0;_<S.length;_++)if(k=g[T=S[_]],L=Object.keys(k),A=k[""],I=t(A),T<0||T>z.length-(I?0:1))w.warn("index out of range",h,T);else if(A!==void 0)L.length>1&&w.warn("Insertion & removal are incompatible with edits to the same index.",h,T),n(A)?j.push(T):I?(A==="add"&&(A={}),z.splice(T,0,A),D&&D.splice(T,0,{})):w.warn("Unrecognized full object edit value",h,T,A),V===-1&&(V=T);else for(b=0;b<L.length;b++)P=h+"["+T+"].",s(z[T],L[b],P).set(k[L[b]]);for(_=j.length-1;_>=0;_--)z.splice(j[_],1),D&&D.splice(j[_],1);if(z.length?E||r.set(z):r.set(null),c)return!1;if(l(i,x),p!==v){var Q;if(V===-1)Q=S;else{for(Z=Math.max(z.length,Z),Q=[],_=0;_<S.length&&!((T=S[_])>=V);_++)Q.push(T);for(_=V;_<Z;_++)Q.push(_)}for(_=0;_<Q.length;_++)p(a,Q[_])}else o(a);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("has-hover"),y=m("../lib"),e=y.nestedProperty,t=m("../lib/events"),n=m("../lib/queue"),a=m("../registry"),r=m("./plot_schema"),g=m("../plots/plots"),u=m("../plots/cartesian/axes"),s=m("../components/drawing"),h=m("../components/color"),l=m("../plots/cartesian/graph_interact").initInteractions,o=m("../constants/xmlns_namespaces"),p=m("../components/selections").clearOutline,c=m("./plot_config").dfltConfig,i=m("./manage_arrays"),x=m("./helpers"),f=m("./subroutines"),_=m("./edit_types"),b=m("../plots/cartesian/constants").AX_NAME_PATTERN,T=0;function k(le){var ge=le._fullLayout;ge._redrawFromAutoMarginCount?ge._redrawFromAutoMarginCount--:le.emit("plotly_afterplot")}function L(le,ge){try{le._fullLayout._paper.style("background",ge)}catch(Te){y.error(Te)}}function A(le,ge){L(le,h.combine(ge,"white"))}function I(le,ge){if(!le._context){le._context=y.extendDeep({},c);var Te=d.select("base");le._context._baseUrl=Te.size()&&Te.attr("href")?window.location.href.split("#")[0]:""}var Se,Me,ze,Oe=le._context;if(ge){for(Me=Object.keys(ge),Se=0;Se<Me.length;Se++)(ze=Me[Se])!=="editable"&&ze!=="edits"&&ze in Oe&&(ze==="setBackground"&&ge[ze]==="opaque"?Oe[ze]=A:Oe[ze]=ge[ze]);ge.plot3dPixelRatio&&!Oe.plotGlPixelRatio&&(Oe.plotGlPixelRatio=Oe.plot3dPixelRatio);var De=ge.editable;if(De!==void 0)for(Oe.editable=De,Me=Object.keys(Oe.edits),Se=0;Se<Me.length;Se++)Oe.edits[Me[Se]]=De;if(ge.edits)for(Me=Object.keys(ge.edits),Se=0;Se<Me.length;Se++)(ze=Me[Se])in Oe.edits&&(Oe.edits[ze]=ge.edits[ze]);Oe._exportedPlot=ge._exportedPlot}Oe.staticPlot&&(Oe.editable=!1,Oe.edits={},Oe.autosizable=!1,Oe.scrollZoom=!1,Oe.doubleClick=!1,Oe.showTips=!1,Oe.showLink=!1,Oe.displayModeBar=!1),Oe.displayModeBar!=="hover"||w||(Oe.displayModeBar=!0),Oe.setBackground!=="transparent"&&typeof Oe.setBackground=="function"||(Oe.setBackground=L),Oe._hasZeroHeight=Oe._hasZeroHeight||le.clientHeight===0,Oe._hasZeroWidth=Oe._hasZeroWidth||le.clientWidth===0;var Xe=Oe.scrollZoom,Be=Oe._scrollZoom={};if(Xe===!0)Be.cartesian=1,Be.gl3d=1,Be.geo=1,Be.mapbox=1;else if(typeof Xe=="string"){var Ie=Xe.split("+");for(Se=0;Se<Ie.length;Se++)Be[Ie[Se]]=1}else Xe!==!1&&(Be.gl3d=1,Be.geo=1,Be.mapbox=1)}function P(le,ge){var Te,Se,Me=ge+1,ze=[];for(Te=0;Te<le.length;Te++)(Se=le[Te])<0?ze.push(Me+Se):ze.push(Se);return ze}function S(le,ge,Te){var Se,Me;for(Se=0;Se<ge.length;Se++){if((Me=ge[Se])!==parseInt(Me,10))throw new Error("all values in "+Te+" must be integers");if(Me>=le.data.length||Me<-le.data.length)throw new Error(Te+" must be valid indices for gd.data.");if(ge.indexOf(Me,Se+1)>-1||Me>=0&&ge.indexOf(-le.data.length+Me)>-1||Me<0&&ge.indexOf(le.data.length+Me)>-1)throw new Error("each index in "+Te+" must be unique.")}}function E(le,ge,Te){if(!Array.isArray(le.data))throw new Error("gd.data must be an array.");if(ge===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ge)||(ge=[ge]),S(le,ge,"currentIndices"),Te===void 0||Array.isArray(Te)||(Te=[Te]),Te!==void 0&&S(le,Te,"newIndices"),Te!==void 0&&ge.length!==Te.length)throw new Error("current and new indices must be of equal length.")}function z(le,ge,Te,Se,Me){(function(Ye,Qe,lt,xt){var wt=y.isPlainObject(xt);if(!Array.isArray(Ye.data))throw new Error("gd.data must be an array");if(!y.isPlainObject(Qe))throw new Error("update must be a key:value object");if(lt===void 0)throw new Error("indices must be an integer or array of integers");for(var bt in S(Ye,lt,"indices"),Qe){if(!Array.isArray(Qe[bt])||Qe[bt].length!==lt.length)throw new Error("attribute "+bt+" must be an array of length equal to indices array length");if(wt&&(!(bt in xt)||!Array.isArray(xt[bt])||xt[bt].length!==Qe[bt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(le,ge,Te,Se);for(var ze=function(Ye,Qe,lt,xt){var wt,bt,nt,$e,vt,Nt=y.isPlainObject(xt),qt=[];for(var Jt in Array.isArray(lt)||(lt=[lt]),lt=P(lt,Ye.data.length-1),Qe)for(var Wt=0;Wt<lt.length;Wt++){if(wt=Ye.data[lt[Wt]],bt=(nt=e(wt,Jt)).get(),$e=Qe[Jt][Wt],!y.isArrayOrTypedArray($e))throw new Error("attribute: "+Jt+" index: "+Wt+" must be an array");if(!y.isArrayOrTypedArray(bt))throw new Error("cannot extend missing or non-array attribute: "+Jt);if(bt.constructor!==$e.constructor)throw new Error("cannot extend array with an array of a different type: "+Jt);vt=Nt?xt[Jt][Wt]:xt,v(vt)||(vt=-1),qt.push({prop:nt,target:bt,insert:$e,maxp:Math.floor(vt)})}return qt}(le,ge,Te,Se),Oe={},De={},Xe=0;Xe<ze.length;Xe++){var Be=ze[Xe].prop,Ie=ze[Xe].maxp,Re=Me(ze[Xe].target,ze[Xe].insert,Ie);Be.set(Re[0]),Array.isArray(Oe[Be.astr])||(Oe[Be.astr]=[]),Oe[Be.astr].push(Re[1]),Array.isArray(De[Be.astr])||(De[Be.astr]=[]),De[Be.astr].push(ze[Xe].target.length)}return{update:Oe,maxPoints:De}}function D(le,ge){var Te=new le.constructor(le.length+ge.length);return Te.set(le),Te.set(ge,le.length),Te}function j(le,ge,Te,Se){le=y.getGraphDiv(le),x.clearPromiseQueue(le);var Me={};if(typeof ge=="string")Me[ge]=Te;else{if(!y.isPlainObject(ge))return y.warn("Restyle fail.",ge,Te,Se),Promise.reject();Me=y.extendFlat({},ge),Se===void 0&&(Se=Te)}Object.keys(Me).length&&(le.changed=!0);var ze=x.coerceTraceIndices(le,Se),Oe=K(le,Me,ze),De=Oe.flags;De.calc&&(le.calcdata=void 0),De.clearAxisTypes&&x.clearAxisTypes(le,ze,{});var Xe=[];De.fullReplot?Xe.push(W._doPlot):(Xe.push(g.previousPromises),g.supplyDefaults(le),De.markerSize&&(g.doCalcdata(le),N(Xe)),De.style&&Xe.push(f.doTraceStyle),De.colorbars&&Xe.push(f.doColorBars),Xe.push(k)),Xe.push(g.rehover,g.redrag,g.reselect),n.add(le,j,[le,Oe.undoit,Oe.traces],j,[le,Oe.redoit,Oe.traces]);var Be=y.syncOrAsync(Xe,le);return Be&&Be.then||(Be=Promise.resolve()),Be.then(function(){return le.emit("plotly_restyle",Oe.eventData),le})}function V(le){return le===void 0?null:le}function Z(le,ge){return ge?function(Te,Se,Me){var ze=e(Te,Se),Oe=ze.set;return ze.set=function(De){Q((Me||"")+Se,ze.get(),De,le),Oe(De)},ze}:e}function Q(le,ge,Te,Se){if(Array.isArray(ge)||Array.isArray(Te))for(var Me=Array.isArray(ge)?ge:[],ze=Array.isArray(Te)?Te:[],Oe=Math.max(Me.length,ze.length),De=0;De<Oe;De++)Q(le+"["+De+"]",Me[De],ze[De],Se);else if(y.isPlainObject(ge)||y.isPlainObject(Te)){var Xe=y.isPlainObject(ge)?ge:{},Be=y.isPlainObject(Te)?Te:{},Ie=y.extendFlat({},Xe,Be);for(var Re in Ie)Q(le+"."+Re,Xe[Re],Be[Re],Se)}else Se[le]===void 0&&(Se[le]=V(ge))}function K(le,ge,Te){var Se,Me=le._fullLayout,ze=le._fullData,Oe=le.data,De=Me._guiEditing,Xe=Z(Me._preGUI,De),Be=y.extendDeepAll({},ge);$(ge);var Ie,Re=_.traceFlags(),Ye={},Qe={};function lt(){return Te.map(function(){})}function xt(at){var pt=u.id2name(at);Ie.indexOf(pt)===-1&&Ie.push(pt)}function wt(at){return"LAYOUT"+at+".autorange"}function bt(at){return"LAYOUT"+at+".range"}function nt(at){for(var pt=at;pt<ze.length;pt++)if(ze[pt]._input===Oe[at])return ze[pt]}function $e(at,pt,St){if(Array.isArray(at))at.forEach(function(Ht){$e(Ht,pt,St)});else if(!(at in ge)&&!x.hasParent(ge,at)){var Ut;if(at.substr(0,6)==="LAYOUT")Ut=Xe(le.layout,at.replace("LAYOUT",""));else{var Kt=Te[St];Ut=Z(Me._tracePreGUI[nt(Kt)._fullInput.uid],De)(Oe[Kt],at)}at in Qe||(Qe[at]=lt()),Qe[at][St]===void 0&&(Qe[at][St]=V(Ut.get())),pt!==void 0&&Ut.set(pt)}}function vt(at){return function(pt){return ze[pt][at]}}function Nt(at){return function(pt,St){return pt===!1?ze[Te[St]][at]:null}}for(var qt in ge){if(x.hasParent(ge,qt))throw new Error("cannot set "+qt+" and a parent attribute simultaneously");var Jt,Wt,ar,Dt,Ne,qe,pe=ge[qt];if(qt!=="autobinx"&&qt!=="autobiny"||(qt=qt.charAt(qt.length-1)+"bins",pe=Array.isArray(pe)?pe.map(Nt(qt)):pe===!1?Te.map(vt(qt)):null),Ye[qt]=pe,qt.substr(0,6)!=="LAYOUT"){for(Qe[qt]=lt(),Se=0;Se<Te.length;Se++)if(Jt=Oe[Te[Se]],Wt=nt(Te[Se]),Dt=(ar=Z(Me._tracePreGUI[Wt._fullInput.uid],De)(Jt,qt)).get(),(Ne=Array.isArray(pe)?pe[Se%pe.length]:pe)!==void 0){var be=ar.parts[ar.parts.length-1],Fe=qt.substr(0,qt.length-be.length-1),Ve=Fe?Fe+".":"",Ke=Fe?e(Wt,Fe).get():Wt;if((qe=r.getTraceValObject(Wt,ar.parts))&&qe.impliedEdits&&Ne!==null)for(var Ge in qe.impliedEdits)$e(y.relativeAttr(qt,Ge),qe.impliedEdits[Ge],Se);else if(be!=="thicknessmode"&&be!=="lenmode"||Dt===Ne||Ne!=="fraction"&&Ne!=="pixels"||!Ke){if(qt==="type"&&(Ne==="pie"!=(Dt==="pie")||Ne==="funnelarea"!=(Dt==="funnelarea"))){var ct="x",st="y";Ne!=="bar"&&Dt!=="bar"||Jt.orientation!=="h"||(ct="y",st="x"),y.swapAttrs(Jt,["?","?src"],"labels",ct),y.swapAttrs(Jt,["d?","?0"],"label",ct),y.swapAttrs(Jt,["?","?src"],"values",st),Dt==="pie"||Dt==="funnelarea"?(e(Jt,"marker.color").set(e(Jt,"marker.colors").get()),Me._pielayer.selectAll("g.trace").remove()):a.traceIs(Jt,"cartesian")&&e(Jt,"marker.colors").set(e(Jt,"marker.color").get())}}else{var Mt=Me._size,Ot=Ke.orient,it=Ot==="top"||Ot==="bottom";if(be==="thicknessmode"){var ht=it?Mt.h:Mt.w;$e(Ve+"thickness",Ke.thickness*(Ne==="fraction"?1/ht:ht),Se)}else{var jt=it?Mt.w:Mt.h;$e(Ve+"len",Ke.len*(Ne==="fraction"?1/jt:jt),Se)}}if(Qe[qt][Se]=V(Dt),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(qt)!==-1){if(qt==="orientation"){ar.set(Ne);var kt=Jt.x&&!Jt.y?"h":"v";if((ar.get()||kt)===Wt.orientation)continue}else qt==="orientationaxes"&&(Jt.orientation={v:"h",h:"v"}[Wt.orientation]);x.swapXYData(Jt),Re.calc=Re.clearAxisTypes=!0}else g.dataArrayContainers.indexOf(ar.parts[0])!==-1?(x.manageArrayContainers(ar,Ne,Qe),Re.calc=!0):(qe?qe.arrayOk&&!a.traceIs(Wt,"regl")&&(y.isArrayOrTypedArray(Ne)||y.isArrayOrTypedArray(Dt))?Re.calc=!0:_.update(Re,qe):Re.calc=!0,ar.set(Ne))}if(["swapxyaxes","orientationaxes"].indexOf(qt)!==-1&&u.swap(le,Te),qt==="orientationaxes"){var Pt=e(le.layout,"hovermode"),Ee=Pt.get();Ee==="x"?Pt.set("y"):Ee==="y"?Pt.set("x"):Ee==="x unified"?Pt.set("y unified"):Ee==="y unified"&&Pt.set("x unified")}if(["orientation","type"].indexOf(qt)!==-1){for(Ie=[],Se=0;Se<Te.length;Se++){var Ze=Oe[Te[Se]];a.traceIs(Ze,"cartesian")&&(xt(Ze.xaxis||"x"),xt(Ze.yaxis||"y"))}$e(Ie.map(wt),!0,0),$e(Ie.map(bt),[0,1],0)}}else ar=Xe(le.layout,qt.replace("LAYOUT","")),Qe[qt]=[V(ar.get())],ar.set(Array.isArray(pe)?pe[0]:pe),Re.calc=!0}return(Re.calc||Re.plot)&&(Re.fullReplot=!0),{flags:Re,undoit:Qe,redoit:Ye,traces:Te,eventData:y.extendDeepNoArrays([],[Be,Te])}}function $(le){var ge,Te,Se,Me=y.counterRegex("axis",".title",!1,!1),ze=/colorbar\.title$/,Oe=Object.keys(le);for(ge=0;ge<Oe.length;ge++)Te=Oe[ge],Se=le[Te],Te!=="title"&&!Me.test(Te)&&!ze.test(Te)||typeof Se!="string"&&typeof Se!="number"?Te.indexOf("titlefont")>-1&&Te.indexOf("grouptitlefont")===-1?De(Te,Te.replace("titlefont","title.font")):Te.indexOf("titleposition")>-1?De(Te,Te.replace("titleposition","title.position")):Te.indexOf("titleside")>-1?De(Te,Te.replace("titleside","title.side")):Te.indexOf("titleoffset")>-1&&De(Te,Te.replace("titleoffset","title.offset")):De(Te,Te.replace("title","title.text"));function De(Xe,Be){le[Be]=le[Xe],delete le[Xe]}}function ne(le,ge,Te){le=y.getGraphDiv(le),x.clearPromiseQueue(le);var Se={};if(typeof ge=="string")Se[ge]=Te;else{if(!y.isPlainObject(ge))return y.warn("Relayout fail.",ge,Te),Promise.reject();Se=y.extendFlat({},ge)}Object.keys(Se).length&&(le.changed=!0);var Me=X(le,Se),ze=Me.flags;ze.calc&&(le.calcdata=void 0);var Oe=[g.previousPromises];ze.layoutReplot?Oe.push(f.layoutReplot):Object.keys(Se).length&&(H(le,ze,Me)||g.supplyDefaults(le),ze.legend&&Oe.push(f.doLegend),ze.layoutstyle&&Oe.push(f.layoutStyles),ze.axrange&&N(Oe,Me.rangesAltered),ze.ticks&&Oe.push(f.doTicksRelayout),ze.modebar&&Oe.push(f.doModeBar),ze.camera&&Oe.push(f.doCamera),ze.colorbars&&Oe.push(f.doColorBars),Oe.push(k)),Oe.push(g.rehover,g.redrag,g.reselect),n.add(le,ne,[le,Me.undoit],ne,[le,Me.redoit]);var De=y.syncOrAsync(Oe,le);return De&&De.then||(De=Promise.resolve(le)),De.then(function(){return le.emit("plotly_relayout",Me.eventData),le})}function H(le,ge,Te){var Se=le._fullLayout;if(!ge.axrange)return!1;for(var Me in ge)if(Me!=="axrange"&&ge[Me])return!1;for(var ze in Te.rangesAltered){var Oe=u.id2name(ze),De=le.layout[Oe],Xe=Se[Oe];if(Xe.autorange=De.autorange,De.range&&(Xe.range=De.range.slice()),Xe.cleanRange(),Xe._matchGroup){for(var Be in Xe._matchGroup)if(Be!==ze){var Ie=Se[u.id2name(Be)];Ie.autorange=Xe.autorange,Ie.range=Xe.range.slice(),Ie._input.range=Xe.range.slice()}}}return!0}function N(le,ge){var Te=ge?function(Se){var Me=[];for(var ze in ge){var Oe=u.getFromId(Se,ze);if(Me.push(ze),(Oe.ticklabelposition||"").indexOf("inside")!==-1&&Oe._anchorAxis&&Me.push(Oe._anchorAxis._id),Oe._matchGroup)for(var De in Oe._matchGroup)ge[De]||Me.push(De)}return u.draw(Se,Me,{skipTitle:!0})}:function(Se){return u.draw(Se,"redraw")};le.push(p,f.doAutoRangeAndConstraints,Te,f.drawData,f.finalDraw)}var U=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,te=/^[xyz]axis[0-9]*\.autorange$/,B=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function X(le,ge){var Te,Se,Me,ze=le.layout,Oe=le._fullLayout,De=Oe._guiEditing,Xe=Z(Oe._preGUI,De),Be=Object.keys(ge),Ie=u.list(le),Re=y.extendDeepAll({},ge),Ye={};for($(ge),Be=Object.keys(ge),Se=0;Se<Be.length;Se++)if(Be[Se].indexOf("allaxes")===0){for(Me=0;Me<Ie.length;Me++){var Qe=Ie[Me]._id.substr(1),lt=Qe.indexOf("scene")!==-1?Qe+".":"",xt=Be[Se].replace("allaxes",lt+Ie[Me]._name);ge[xt]||(ge[xt]=ge[Be[Se]])}delete ge[Be[Se]]}var wt=_.layoutFlags(),bt={},nt={};function $e(Kt,Ht){if(Array.isArray(Kt))Kt.forEach(function(Mr){$e(Mr,Ht)});else if(!(Kt in ge)&&!x.hasParent(ge,Kt)){var pr=Xe(ze,Kt);Kt in nt||(nt[Kt]=V(pr.get())),Ht!==void 0&&pr.set(Ht)}}var vt,Nt={};function qt(Kt){var Ht=u.name2id(Kt.split(".")[0]);return Nt[Ht]=1,Ht}for(var Jt in ge){if(x.hasParent(ge,Jt))throw new Error("cannot set "+Jt+" and a parent attribute simultaneously");for(var Wt=Xe(ze,Jt),ar=ge[Jt],Dt=Wt.parts.length-1;Dt>0&&typeof Wt.parts[Dt]!="string";)Dt--;var Ne=Wt.parts[Dt],qe=Wt.parts[Dt-1]+"."+Ne,pe=Wt.parts.slice(0,Dt).join("."),be=e(le.layout,pe).get(),Fe=e(Oe,pe).get(),Ve=Wt.get();if(ar!==void 0){bt[Jt]=ar,nt[Jt]=Ne==="reverse"?ar:V(Ve);var Ke=r.getLayoutValObject(Oe,Wt.parts);if(Ke&&Ke.impliedEdits&&ar!==null)for(var Ge in Ke.impliedEdits)$e(y.relativeAttr(Jt,Ge),Ke.impliedEdits[Ge]);if(["width","height"].indexOf(Jt)!==-1)if(ar){$e("autosize",null);var ct=Jt==="height"?"width":"height";$e(ct,Oe[ct])}else Oe[Jt]=le._initialAutoSize[Jt];else if(Jt==="autosize")$e("width",ar?null:Oe.width),$e("height",ar?null:Oe.height);else if(qe.match(U))qt(qe),e(Oe,pe+"._inputRange").set(null);else if(qe.match(te)){qt(qe),e(Oe,pe+"._inputRange").set(null);var st=e(Oe,pe).get();st._inputDomain&&(st._input.domain=st._inputDomain.slice())}else qe.match(B)&&e(Oe,pe+"._inputDomain").set(null);if(Ne==="type"){vt=be;var Mt=Fe.type==="linear"&&ar==="log",Ot=Fe.type==="log"&&ar==="linear";if(Mt||Ot){if(vt&&vt.range)if(Fe.autorange)Mt&&(vt.range=vt.range[1]>vt.range[0]?[1,2]:[2,1]);else{var it=vt.range[0],ht=vt.range[1];Mt?(it<=0&&ht<=0&&$e(pe+".autorange",!0),it<=0?it=ht/1e6:ht<=0&&(ht=it/1e6),$e(pe+".range[0]",Math.log(it)/Math.LN10),$e(pe+".range[1]",Math.log(ht)/Math.LN10)):($e(pe+".range[0]",Math.pow(10,it)),$e(pe+".range[1]",Math.pow(10,ht)))}else $e(pe+".autorange",!0);Array.isArray(Oe._subplots.polar)&&Oe._subplots.polar.length&&Oe[Wt.parts[0]]&&Wt.parts[1]==="radialaxis"&&delete Oe[Wt.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(le,Fe,ar,$e),a.getComponentMethod("images","convertCoords")(le,Fe,ar,$e)}else $e(pe+".autorange",!0),$e(pe+".range",null);e(Oe,pe+"._inputRange").set(null)}else if(Ne.match(b)){var jt=e(Oe,Jt).get(),kt=(ar||{}).type;kt&&kt!=="-"||(kt="linear"),a.getComponentMethod("annotations","convertCoords")(le,jt,kt,$e),a.getComponentMethod("images","convertCoords")(le,jt,kt,$e)}var Pt=i.containerArrayMatch(Jt);if(Pt){Te=Pt.array,Se=Pt.index;var Ee=Pt.property,Ze=Ke||{editType:"calc"};Se!==""&&Ee===""&&(i.isAddVal(ar)?nt[Jt]=null:i.isRemoveVal(ar)?nt[Jt]=(e(ze,Te).get()||[])[Se]:y.warn("unrecognized full object value",ge)),_.update(wt,Ze),Ye[Te]||(Ye[Te]={});var at=Ye[Te][Se];at||(at=Ye[Te][Se]={}),at[Ee]=ar,delete ge[Jt]}else Ne==="reverse"?(be.range?be.range.reverse():($e(pe+".autorange",!0),be.range=[1,0]),Fe.autorange?wt.calc=!0:wt.plot=!0):(Jt==="dragmode"&&(ar===!1&&Ve!==!1||ar!==!1&&Ve===!1)||Oe._has("scatter-like")&&Oe._has("regl")&&Jt==="dragmode"&&(ar==="lasso"||ar==="select")&&Ve!=="lasso"&&Ve!=="select"||Oe._has("gl2d")?wt.plot=!0:Ke?_.update(wt,Ke):wt.calc=!0,Wt.set(ar))}}for(Te in Ye)i.applyContainerArrayChanges(le,Xe(ze,Te),Ye[Te],wt,Xe)||(wt.plot=!0);for(var pt in Nt){var St=(vt=u.getFromId(le,pt))&&vt._constraintGroup;if(St)for(var Ut in wt.calc=!0,St)Nt[Ut]||(u.getFromId(le,Ut)._constraintShrinkable=!0)}return(J(le)||ge.height||ge.width)&&(wt.plot=!0),(wt.plot||wt.calc)&&(wt.layoutReplot=!0),{flags:wt,rangesAltered:Nt,undoit:nt,redoit:bt,eventData:Re}}function J(le){var ge=le._fullLayout,Te=ge.width,Se=ge.height;return le.layout.autosize&&g.plotAutoSize(le,le.layout,ge),ge.width!==Te||ge.height!==Se}function ee(le,ge,Te,Se){le=y.getGraphDiv(le),x.clearPromiseQueue(le),y.isPlainObject(ge)||(ge={}),y.isPlainObject(Te)||(Te={}),Object.keys(ge).length&&(le.changed=!0),Object.keys(Te).length&&(le.changed=!0);var Me=x.coerceTraceIndices(le,Se),ze=K(le,y.extendFlat({},ge),Me),Oe=ze.flags,De=X(le,y.extendFlat({},Te)),Xe=De.flags;(Oe.calc||Xe.calc)&&(le.calcdata=void 0),Oe.clearAxisTypes&&x.clearAxisTypes(le,Me,Te);var Be=[];Xe.layoutReplot?Be.push(f.layoutReplot):Oe.fullReplot?Be.push(W._doPlot):(Be.push(g.previousPromises),H(le,Xe,De)||g.supplyDefaults(le),Oe.style&&Be.push(f.doTraceStyle),(Oe.colorbars||Xe.colorbars)&&Be.push(f.doColorBars),Xe.legend&&Be.push(f.doLegend),Xe.layoutstyle&&Be.push(f.layoutStyles),Xe.axrange&&N(Be,De.rangesAltered),Xe.ticks&&Be.push(f.doTicksRelayout),Xe.modebar&&Be.push(f.doModeBar),Xe.camera&&Be.push(f.doCamera),Be.push(k)),Be.push(g.rehover,g.redrag,g.reselect),n.add(le,ee,[le,ze.undoit,De.undoit,ze.traces],ee,[le,ze.redoit,De.redoit,ze.traces]);var Ie=y.syncOrAsync(Be,le);return Ie&&Ie.then||(Ie=Promise.resolve(le)),Ie.then(function(){return le.emit("plotly_update",{data:ze.eventData,layout:De.eventData}),le})}function re(le){return function(ge){ge._fullLayout._guiEditing=!0;var Te=le.apply(null,arguments);return ge._fullLayout._guiEditing=!1,Te}}var se=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],oe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(le,ge){for(var Te=0;Te<ge.length;Te++){var Se=ge[Te],Me=le.match(Se.pattern);if(Me){var ze=Me[1]||"";return{head:ze,tail:le.substr(ze.length+1),attr:Se.attr}}}}function ce(le,ge){var Te=e(ge,le).get();if(Te!==void 0)return Te;var Se=le.split(".");for(Se.pop();Se.length>1;)if(Se.pop(),(Te=e(ge,Se.join(".")+".uirevision").get())!==void 0)return Te;return ge.uirevision}function ve(le,ge){for(var Te=0;Te<ge.length;Te++)if(ge[Te]._fullInput.uid===le)return Te;return-1}function Ae(le,ge,Te){for(var Se=0;Se<ge.length;Se++)if(ge[Se].uid===le)return Se;return!ge[Te]||ge[Te].uid?-1:Te}function fe(le,ge){var Te=y.isPlainObject(le),Se=Array.isArray(le);return Te||Se?(Te&&y.isPlainObject(ge)||Se&&Array.isArray(ge))&&JSON.stringify(le)===JSON.stringify(ge):le===ge}function me(le,ge,Te,Se){var Me,ze,Oe,De=Se.getValObject,Xe=Se.flags,Be=Se.immutable,Ie=Se.inArray,Re=Se.arrayIndex;function Ye(){var be=Me.editType;Ie&&be.indexOf("arraydraw")!==-1?y.pushUnique(Xe.arrays[Ie],Re):(_.update(Xe,Me),be!=="none"&&Xe.nChanges++,Se.transition&&Me.anim&&Xe.nChangesAnim++,(U.test(Oe)||te.test(Oe))&&(Xe.rangesAltered[Te[0]]=1),B.test(Oe)&&e(ge,"_inputDomain").set(null),ze==="datarevision"&&(Xe.newDataRevision=1))}function Qe(be){return be.valType==="data_array"||be.arrayOk}for(ze in le){if(Xe.calc&&!Se.transition)return;var lt=le[ze],xt=ge[ze],wt=Te.concat(ze);if(Oe=wt.join("."),ze.charAt(0)!=="_"&&typeof lt!="function"&&lt!==xt){if((ze==="tick0"||ze==="dtick")&&Te[0]!=="geo"){var bt=ge.tickmode;if(bt==="auto"||bt==="array"||!bt)continue}if((ze!=="range"||!ge.autorange)&&(ze!=="zmin"&&ze!=="zmax"||ge.type!=="contourcarpet")&&(Me=De(wt))&&(!Me._compareAsJSON||JSON.stringify(lt)!==JSON.stringify(xt))){var nt,$e=Me.valType,vt=Qe(Me),Nt=Array.isArray(lt),qt=Array.isArray(xt);if(Nt&&qt){var Jt="_input_"+ze,Wt=le[Jt],ar=ge[Jt];if(Array.isArray(Wt)&&Wt===ar)continue}if(xt===void 0)vt&&Nt?Xe.calc=!0:Ye();else if(Me._isLinkedToArray){var Dt=[],Ne=!1;Ie||(Xe.arrays[ze]=Dt);var qe=Math.min(lt.length,xt.length),pe=Math.max(lt.length,xt.length);if(qe!==pe){if(Me.editType!=="arraydraw"){Ye();continue}Ne=!0}for(nt=0;nt<qe;nt++)me(lt[nt],xt[nt],wt.concat(nt),y.extendFlat({inArray:ze,arrayIndex:nt},Se));if(Ne)for(nt=qe;nt<pe;nt++)Dt.push(nt)}else!$e&&y.isPlainObject(lt)?me(lt,xt,wt,Se):vt?Nt&&qt?(Be&&(Xe.calc=!0),(Be||Se.newDataRevision)&&Ye()):Nt!==qt?Xe.calc=!0:Ye():Nt&&qt&&lt.length===xt.length&&String(lt)===String(xt)||Ye()}}}for(ze in ge)if(!(ze in le)&&ze.charAt(0)!=="_"&&typeof ge[ze]!="function"){if(Qe(Me=De(Te.concat(ze)))&&Array.isArray(ge[ze]))return void(Xe.calc=!0);Ye()}}function _e(le){var ge=le._fullLayout,Te=le.getBoundingClientRect();if(!y.equalDomRects(Te,ge._lastBBox)){var Se=ge._invTransform=y.inverseTransformMatrix(y.getFullTransformMatrix(le));ge._invScaleX=Math.sqrt(Se[0][0]*Se[0][0]+Se[0][1]*Se[0][1]+Se[0][2]*Se[0][2]),ge._invScaleY=Math.sqrt(Se[1][0]*Se[1][0]+Se[1][1]*Se[1][1]+Se[1][2]*Se[1][2]),ge._lastBBox=Te}}W.animate=function(le,ge,Te){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Se=le._transitionData;Se._frameQueue||(Se._frameQueue=[]);var Me=(Te=g.supplyAnimationDefaults(Te)).transition,ze=Te.frame;function Oe(Be){return Array.isArray(Me)?Be>=Me.length?Me[0]:Me[Be]:Me}function De(Be){return Array.isArray(ze)?Be>=ze.length?ze[0]:ze[Be]:ze}function Xe(Be,Ie){var Re=0;return function(){if(Be&&++Re===Ie)return Be()}}return Se._frameWaitingCnt===void 0&&(Se._frameWaitingCnt=0),new Promise(function(Be,Ie){function Re(){Se._currentFrame&&Se._currentFrame.onComplete&&Se._currentFrame.onComplete();var Wt=Se._currentFrame=Se._frameQueue.shift();if(Wt){var ar=Wt.name?Wt.name.toString():null;le._fullLayout._currentFrame=ar,Se._lastFrameAt=Date.now(),Se._timeToNext=Wt.frameOpts.duration,g.transition(le,Wt.frame.data,Wt.frame.layout,x.coerceTraceIndices(le,Wt.frame.traces),Wt.frameOpts,Wt.transitionOpts).then(function(){Wt.onComplete&&Wt.onComplete()}),le.emit("plotly_animatingframe",{name:ar,frame:Wt.frame,animation:{frame:Wt.frameOpts,transition:Wt.transitionOpts}})}else le.emit("plotly_animated"),window.cancelAnimationFrame(Se._animationRaf),Se._animationRaf=null}function Ye(){le.emit("plotly_animating"),Se._lastFrameAt=-1/0,Se._timeToNext=0,Se._runningTransitions=0,Se._currentFrame=null;var Wt=function(){Se._animationRaf=window.requestAnimationFrame(Wt),Date.now()-Se._lastFrameAt>Se._timeToNext&&Re()};Wt()}var Qe,lt,xt=0;function wt(Wt){return Array.isArray(Me)?xt>=Me.length?Wt.transitionOpts=Me[xt]:Wt.transitionOpts=Me[0]:Wt.transitionOpts=Me,xt++,Wt}var bt=[],nt=ge==null,$e=Array.isArray(ge);if(!nt&&!$e&&y.isPlainObject(ge))bt.push({type:"object",data:wt(y.extendFlat({},ge))});else if(nt||["string","number"].indexOf(typeof ge)!==-1)for(Qe=0;Qe<Se._frames.length;Qe++)(lt=Se._frames[Qe])&&(nt||String(lt.group)===String(ge))&&bt.push({type:"byname",name:String(lt.name),data:wt({name:lt.name})});else if($e)for(Qe=0;Qe<ge.length;Qe++){var vt=ge[Qe];["number","string"].indexOf(typeof vt)!==-1?(vt=String(vt),bt.push({type:"byname",name:vt,data:wt({name:vt})})):y.isPlainObject(vt)&&bt.push({type:"object",data:wt(y.extendFlat({},vt))})}for(Qe=0;Qe<bt.length;Qe++)if((lt=bt[Qe]).type==="byname"&&!Se._frameHash[lt.data.name])return y.warn('animate failure: frame not found: "'+lt.data.name+'"'),void Ie();["next","immediate"].indexOf(Te.mode)!==-1&&function(){if(Se._frameQueue.length!==0){for(;Se._frameQueue.length;){var Wt=Se._frameQueue.pop();Wt.onInterrupt&&Wt.onInterrupt()}le.emit("plotly_animationinterrupted",[])}}(),Te.direction==="reverse"&&bt.reverse();var Nt=le._fullLayout._currentFrame;if(Nt&&Te.fromcurrent){var qt=-1;for(Qe=0;Qe<bt.length;Qe++)if((lt=bt[Qe]).type==="byname"&&lt.name===Nt){qt=Qe;break}if(qt>0&&qt<bt.length-1){var Jt=[];for(Qe=0;Qe<bt.length;Qe++)lt=bt[Qe],(bt[Qe].type!=="byname"||Qe>qt)&&Jt.push(lt);bt=Jt}}bt.length>0?function(Wt){if(Wt.length!==0){for(var ar=0;ar<Wt.length;ar++){var Dt;Dt=Wt[ar].type==="byname"?g.computeFrame(le,Wt[ar].name):Wt[ar].data;var Ne=De(ar),qe=Oe(ar);qe.duration=Math.min(qe.duration,Ne.duration);var pe={frame:Dt,name:Wt[ar].name,frameOpts:Ne,transitionOpts:qe};ar===Wt.length-1&&(pe.onComplete=Xe(Be,2),pe.onInterrupt=Ie),Se._frameQueue.push(pe)}Te.mode==="immediate"&&(Se._lastFrameAt=-1/0),Se._animationRaf||Ye()}}(bt):(le.emit("plotly_animated"),Be())})},W.addFrames=function(le,ge,Te){if(le=y.getGraphDiv(le),ge==null)return Promise.resolve();if(!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Se,Me,ze,Oe,De=le._transitionData._frames,Xe=le._transitionData._frameHash;if(!Array.isArray(ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ge);var Be=De.length+2*ge.length,Ie=[],Re={};for(Se=ge.length-1;Se>=0;Se--)if(y.isPlainObject(ge[Se])){var Ye=ge[Se].name,Qe=(Xe[Ye]||Re[Ye]||{}).name,lt=ge[Se].name,xt=Xe[Qe]||Re[Qe];Qe&&lt&&typeof lt=="number"&&xt&&T<5&&(T++,y.warn('addFrames: overwriting frame "'+(Xe[Qe]||Re[Qe]).name+'" with a frame whose name of type "number" also equates to "'+Qe+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),T===5&&y.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Re[Ye]={name:Ye},Ie.push({frame:g.supplyFrameDefaults(ge[Se]),index:Te&&Te[Se]!==void 0&&Te[Se]!==null?Te[Se]:Be+Se})}Ie.sort(function(Jt,Wt){return Jt.index>Wt.index?-1:Jt.index<Wt.index?1:0});var wt=[],bt=[],nt=De.length;for(Se=Ie.length-1;Se>=0;Se--){if(typeof(Me=Ie[Se].frame).name=="number"&&y.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Me.name)for(;Xe[Me.name="frame "+le._transitionData._counter++];);if(Xe[Me.name]){for(ze=0;ze<De.length&&(De[ze]||{}).name!==Me.name;ze++);wt.push({type:"replace",index:ze,value:Me}),bt.unshift({type:"replace",index:ze,value:De[ze]})}else Oe=Math.max(0,Math.min(Ie[Se].index,nt)),wt.push({type:"insert",index:Oe,value:Me}),bt.unshift({type:"delete",index:Oe}),nt++}var $e=g.modifyFrames,vt=g.modifyFrames,Nt=[le,bt],qt=[le,wt];return n&&n.add(le,$e,Nt,vt,qt),g.modifyFrames(le,wt)},W.deleteFrames=function(le,ge){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le);var Te,Se,Me=le._transitionData._frames,ze=[],Oe=[];if(!ge)for(ge=[],Te=0;Te<Me.length;Te++)ge.push(Te);for((ge=ge.slice()).sort(),Te=ge.length-1;Te>=0;Te--)Se=ge[Te],ze.push({type:"delete",index:Se}),Oe.unshift({type:"insert",index:Se,value:Me[Se]});var De=g.modifyFrames,Xe=g.modifyFrames,Be=[le,Oe],Ie=[le,ze];return n&&n.add(le,De,Be,Xe,Ie),g.modifyFrames(le,ze)},W.addTraces=function le(ge,Te,Se){ge=y.getGraphDiv(ge);var Me,ze,Oe=[],De=W.deleteTraces,Xe=le,Be=[ge,Oe],Ie=[ge,Te];for(function(Re,Ye,Qe){var lt,xt;if(!Array.isArray(Re.data))throw new Error("gd.data must be an array.");if(Ye===void 0)throw new Error("traces must be defined.");for(Array.isArray(Ye)||(Ye=[Ye]),lt=0;lt<Ye.length;lt++)if(typeof(xt=Ye[lt])!="object"||Array.isArray(xt)||xt===null)throw new Error("all values in traces array must be non-array objects");if(Qe===void 0||Array.isArray(Qe)||(Qe=[Qe]),Qe!==void 0&&Qe.length!==Ye.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ge,Te,Se),Array.isArray(Te)||(Te=[Te]),Te=Te.map(function(Re){return y.extendFlat({},Re)}),x.cleanData(Te),Me=0;Me<Te.length;Me++)ge.data.push(Te[Me]);for(Me=0;Me<Te.length;Me++)Oe.push(-Te.length+Me);if(Se===void 0)return ze=W.redraw(ge),n.add(ge,De,Be,Xe,Ie),ze;Array.isArray(Se)||(Se=[Se]);try{E(ge,Oe,Se)}catch(Re){throw ge.data.splice(ge.data.length-Te.length,Te.length),Re}return n.startSequence(ge),n.add(ge,De,Be,Xe,Ie),ze=W.moveTraces(ge,Oe,Se),n.stopSequence(ge),ze},W.deleteTraces=function le(ge,Te){ge=y.getGraphDiv(ge);var Se,Me,ze=[],Oe=W.addTraces,De=le,Xe=[ge,ze,Te],Be=[ge,Te];if(Te===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Te)||(Te=[Te]),S(ge,Te,"indices"),(Te=P(Te,ge.data.length-1)).sort(y.sorterDes),Se=0;Se<Te.length;Se+=1)Me=ge.data.splice(Te[Se],1)[0],ze.push(Me);var Ie=W.redraw(ge);return n.add(ge,Oe,Xe,De,Be),Ie},W.extendTraces=function le(ge,Te,Se,Me){function ze(Be,Ie,Re){var Ye,Qe;if(y.isTypedArray(Be))if(Re<0){var lt=new Be.constructor(0),xt=D(Be,Ie);Re<0?(Ye=xt,Qe=lt):(Ye=lt,Qe=xt)}else if(Ye=new Be.constructor(Re),Qe=new Be.constructor(Be.length+Ie.length-Re),Re===Ie.length)Ye.set(Ie),Qe.set(Be);else if(Re<Ie.length){var wt=Ie.length-Re;Ye.set(Ie.subarray(wt)),Qe.set(Be),Qe.set(Ie.subarray(0,wt),Be.length)}else{var bt=Re-Ie.length,nt=Be.length-bt;Ye.set(Be.subarray(nt)),Ye.set(Ie,bt),Qe.set(Be.subarray(0,nt))}else Ye=Be.concat(Ie),Qe=Re>=0&&Re<Ye.length?Ye.splice(0,Ye.length-Re):[];return[Ye,Qe]}var Oe=z(ge=y.getGraphDiv(ge),Te,Se,Me,ze),De=W.redraw(ge),Xe=[ge,Oe.update,Se,Oe.maxPoints];return n.add(ge,W.prependTraces,Xe,le,arguments),De},W.moveTraces=function le(ge,Te,Se){var Me,ze=[],Oe=[],De=le,Xe=le,Be=[ge=y.getGraphDiv(ge),Se,Te],Ie=[ge,Te,Se];if(E(ge,Te,Se),Te=Array.isArray(Te)?Te:[Te],Se===void 0)for(Se=[],Me=0;Me<Te.length;Me++)Se.push(-Te.length+Me);for(Se=Array.isArray(Se)?Se:[Se],Te=P(Te,ge.data.length-1),Se=P(Se,ge.data.length-1),Me=0;Me<ge.data.length;Me++)Te.indexOf(Me)===-1&&ze.push(ge.data[Me]);for(Me=0;Me<Te.length;Me++)Oe.push({newIndex:Se[Me],trace:ge.data[Te[Me]]});for(Oe.sort(function(Ye,Qe){return Ye.newIndex-Qe.newIndex}),Me=0;Me<Oe.length;Me+=1)ze.splice(Oe[Me].newIndex,0,Oe[Me].trace);ge.data=ze;var Re=W.redraw(ge);return n.add(ge,De,Be,Xe,Ie),Re},W.prependTraces=function le(ge,Te,Se,Me){function ze(Be,Ie,Re){var Ye,Qe;if(y.isTypedArray(Be))if(Re<=0){var lt=new Be.constructor(0),xt=D(Ie,Be);Re<0?(Ye=xt,Qe=lt):(Ye=lt,Qe=xt)}else if(Ye=new Be.constructor(Re),Qe=new Be.constructor(Be.length+Ie.length-Re),Re===Ie.length)Ye.set(Ie),Qe.set(Be);else if(Re<Ie.length){var wt=Ie.length-Re;Ye.set(Ie.subarray(0,wt)),Qe.set(Ie.subarray(wt)),Qe.set(Be,wt)}else{var bt=Re-Ie.length;Ye.set(Ie),Ye.set(Be.subarray(0,bt),Ie.length),Qe.set(Be.subarray(bt))}else Ye=Ie.concat(Be),Qe=Re>=0&&Re<Ye.length?Ye.splice(Re,Ye.length):[];return[Ye,Qe]}var Oe=z(ge=y.getGraphDiv(ge),Te,Se,Me,ze),De=W.redraw(ge),Xe=[ge,Oe.update,Se,Oe.maxPoints];return n.add(ge,W.extendTraces,Xe,le,arguments),De},W.newPlot=function(le,ge,Te,Se){return le=y.getGraphDiv(le),g.cleanPlot([],{},le._fullData||[],le._fullLayout||{}),g.purge(le),W._doPlot(le,ge,Te,Se)},W._doPlot=function(le,ge,Te,Se){var Me;if(le=y.getGraphDiv(le),t.init(le),y.isPlainObject(ge)){var ze=ge;ge=ze.data,Te=ze.layout,Se=ze.config,Me=ze.frames}if(t.triggerHandler(le,"plotly_beforeplot",[ge,Te,Se])===!1)return Promise.reject();ge||Te||y.isPlotDiv(le)||y.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",le),I(le,Se),Te||(Te={}),d.select(le).classed("js-plotly-plot",!0),s.makeTester(),Array.isArray(le._promises)||(le._promises=[]);var Oe=(le.data||[]).length===0&&Array.isArray(ge);Array.isArray(ge)&&(x.cleanData(ge),Oe?le.data=ge:le.data.push.apply(le.data,ge),le.empty=!1),le.layout&&!Oe||(le.layout=x.cleanLayout(Te)),g.supplyDefaults(le);var De=le._fullLayout,Xe=De._has("cartesian");De._replotting=!0,(Oe||De._shouldCreateBgLayer)&&(function(bt){var nt=d.select(bt),$e=bt._fullLayout;if($e._calcInverseTransform=_e,$e._calcInverseTransform(bt),$e._container=nt.selectAll(".plot-container").data([0]),$e._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),$e._paperdiv=$e._container.selectAll(".svg-container").data([0]),$e._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),$e._glcontainer=$e._paperdiv.selectAll(".gl-container").data([{}]),$e._glcontainer.enter().append("div").classed("gl-container",!0),$e._paperdiv.selectAll(".main-svg").remove(),$e._paperdiv.select(".modebar-container").remove(),$e._paper=$e._paperdiv.insert("svg",":first-child").classed("main-svg",!0),$e._toppaper=$e._paperdiv.append("svg").classed("main-svg",!0),$e._modebardiv=$e._paperdiv.append("div"),delete $e._modeBar,$e._hoverpaper=$e._paperdiv.append("svg").classed("main-svg",!0),!$e._uid){var vt={};d.selectAll("defs").each(function(){this.id&&(vt[this.id.split("-")[1]]=1)}),$e._uid=y.randstr(vt)}$e._paperdiv.selectAll(".main-svg").attr(o.svgAttrs),$e._defs=$e._paper.append("defs").attr("id","defs-"+$e._uid),$e._clips=$e._defs.append("g").classed("clips",!0),$e._topdefs=$e._toppaper.append("defs").attr("id","topdefs-"+$e._uid),$e._topclips=$e._topdefs.append("g").classed("clips",!0),$e._bgLayer=$e._paper.append("g").classed("bglayer",!0),$e._draggers=$e._paper.append("g").classed("draglayer",!0);var Nt=$e._paper.append("g").classed("layer-below",!0);$e._imageLowerLayer=Nt.append("g").classed("imagelayer",!0),$e._shapeLowerLayer=Nt.append("g").classed("shapelayer",!0),$e._cartesianlayer=$e._paper.append("g").classed("cartesianlayer",!0),$e._polarlayer=$e._paper.append("g").classed("polarlayer",!0),$e._smithlayer=$e._paper.append("g").classed("smithlayer",!0),$e._ternarylayer=$e._paper.append("g").classed("ternarylayer",!0),$e._geolayer=$e._paper.append("g").classed("geolayer",!0),$e._funnelarealayer=$e._paper.append("g").classed("funnelarealayer",!0),$e._pielayer=$e._paper.append("g").classed("pielayer",!0),$e._iciclelayer=$e._paper.append("g").classed("iciclelayer",!0),$e._treemaplayer=$e._paper.append("g").classed("treemaplayer",!0),$e._sunburstlayer=$e._paper.append("g").classed("sunburstlayer",!0),$e._indicatorlayer=$e._toppaper.append("g").classed("indicatorlayer",!0),$e._glimages=$e._paper.append("g").classed("glimages",!0);var qt=$e._toppaper.append("g").classed("layer-above",!0);$e._imageUpperLayer=qt.append("g").classed("imagelayer",!0),$e._shapeUpperLayer=qt.append("g").classed("shapelayer",!0),$e._selectionLayer=$e._toppaper.append("g").classed("selectionlayer",!0),$e._infolayer=$e._toppaper.append("g").classed("infolayer",!0),$e._menulayer=$e._toppaper.append("g").classed("menulayer",!0),$e._zoomlayer=$e._toppaper.append("g").classed("zoomlayer",!0),$e._hoverlayer=$e._hoverpaper.append("g").classed("hoverlayer",!0),$e._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),bt.emit("plotly_framework")}(le),De._shouldCreateBgLayer&&delete De._shouldCreateBgLayer),s.initGradients(le),s.initPatterns(le),Oe&&u.saveShowSpikeInitial(le);var Be=!le.calcdata||le.calcdata.length!==(le._fullData||[]).length;Be&&g.doCalcdata(le);for(var Ie=0;Ie<le.calcdata.length;Ie++)le.calcdata[Ie][0].trace=le._fullData[Ie];le._context.responsive?le._responsiveChartHandler||(le._responsiveChartHandler=function(){y.isHidden(le)||g.resize(le)},window.addEventListener("resize",le._responsiveChartHandler)):y.clearResponsive(le);var Re=y.extendFlat({},De._size),Ye=0;function Qe(){if(g.clearAutoMarginIds(le),f.drawMarginPushers(le),u.allowAutoMargin(le),De._has("pie"))for(var bt=le._fullData,nt=0;nt<bt.length;nt++){var $e=bt[nt];$e.type==="pie"&&$e.automargin&&g.allowAutoMargin(le,"pie."+$e.uid+".automargin")}return g.doAutoMargin(le),g.previousPromises(le)}function lt(){le._transitioning||(f.doAutoRangeAndConstraints(le),Oe&&u.saveRangeInitial(le),a.getComponentMethod("rangeslider","calcAutorange")(le))}var xt=[g.previousPromises,function(){if(Me)return W.addFrames(le,Me)},function bt(){for(var nt=De._basePlotModules,$e=0;$e<nt.length;$e++)nt[$e].drawFramework&&nt[$e].drawFramework(le);!De._glcanvas&&De._has("gl")&&(De._glcanvas=De._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Jt){return Jt.key}),De._glcanvas.enter().append("canvas").attr("class",function(Jt){return"gl-canvas gl-canvas-"+Jt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var vt=le._context.plotGlPixelRatio;if(De._glcanvas){De._glcanvas.attr("width",De.width*vt).attr("height",De.height*vt).style("width",De.width+"px").style("height",De.height+"px");var Nt=De._glcanvas.data()[0].regl;if(Nt&&(Math.floor(De.width*vt)!==Nt._gl.drawingBufferWidth||Math.floor(De.height*vt)!==Nt._gl.drawingBufferHeight)){var qt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Ye)return y.log(qt+" Clearing graph and plotting again."),g.cleanPlot([],{},le._fullData,De),g.supplyDefaults(le),De=le._fullLayout,g.doCalcdata(le),Ye++,bt();y.error(qt)}}return De.modebar.orientation==="h"?De._modebardiv.style("height",null).style("width","100%"):De._modebardiv.style("width",null).style("height",De.height+"px"),g.previousPromises(le)},Qe,function(){if(g.didMarginChange(Re,De._size))return y.syncOrAsync([Qe,f.layoutStyles],le)}];Xe&&xt.push(function(){if(Be)return y.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),lt],le);lt()}),xt.push(f.layoutStyles),Xe&&xt.push(function(){return u.draw(le,Oe?"":"redraw")},function(bt){bt._fullLayout._insideTickLabelsAutorange&&ne(bt,bt._fullLayout._insideTickLabelsAutorange).then(function(){bt._fullLayout._insideTickLabelsAutorange=void 0})}),xt.push(f.drawData,f.finalDraw,l,g.addLinks,g.rehover,g.redrag,g.reselect,g.doAutoMargin,function(bt){bt._fullLayout._insideTickLabelsAutorange&&Oe&&u.saveRangeInitial(bt,!0)},g.previousPromises);var wt=y.syncOrAsync(xt,le);return wt&&wt.then||(wt=Promise.resolve()),wt.then(function(){return k(le),le})},W.purge=function(le){var ge=(le=y.getGraphDiv(le))._fullLayout||{},Te=le._fullData||[];return g.cleanPlot([],{},Te,ge),g.purge(le),t.purge(le),ge._container&&ge._container.remove(),delete le._context,le},W.react=function(le,ge,Te,Se){var Me,ze;le=y.getGraphDiv(le),x.clearPromiseQueue(le);var Oe=le._fullData,De=le._fullLayout;if(y.isPlotDiv(le)&&Oe&&De){if(y.isPlainObject(ge)){var Xe=ge;ge=Xe.data,Te=Xe.layout,Se=Xe.config,Me=Xe.frames}var Be=!1;if(Se){var Ie=y.extendDeep({},le._context);le._context=void 0,I(le,Se),Be=function pe(be,Fe){var Ve;for(Ve in be)if(Ve.charAt(0)!=="_"){var Ke=be[Ve],Ge=Fe[Ve];if(Ke!==Ge)if(y.isPlainObject(Ke)&&y.isPlainObject(Ge)){if(pe(Ke,Ge))return!0}else{if(!Array.isArray(Ke)||!Array.isArray(Ge)||Ke.length!==Ge.length)return!0;for(var ct=0;ct<Ke.length;ct++)if(Ke[ct]!==Ge[ct]&&(!y.isPlainObject(Ke[ct])||!y.isPlainObject(Ge[ct])||pe(Ke[ct],Ge[ct])))return!0}}}(Ie,le._context)}le.data=ge||[],x.cleanData(le.data),le.layout=Te||{},x.cleanLayout(le.layout),function(pe,be,Fe,Ve){var Ke,Ge,ct,st,Mt,Ot,it,ht,jt,kt,Pt=Ve._preGUI,Ee=[],Ze={},at={};for(Ke in Pt){if(Mt=de(Ke,se)){if(jt=Mt.head,kt=Mt.tail,Ge=Mt.attr||jt+".uirevision",(st=(ct=e(Ve,Ge).get())&&ce(Ge,be))&&st===ct){if((Ot=Pt[Ke])===null&&(Ot=void 0),fe(ht=(it=e(be,Ke)).get(),Ot)){ht===void 0&&kt==="autorange"&&Ee.push(jt),it.set(V(e(Ve,Ke).get()));continue}if(kt==="autorange"||kt.substr(0,6)==="range["){var pt=Pt[jt+".range[0]"],St=Pt[jt+".range[1]"],Ut=Pt[jt+".autorange"];if(Ut||Ut===null&&pt===null&&St===null){if(!(jt in Ze)){var Kt=e(be,jt).get();Ze[jt]=Kt&&(Kt.autorange||Kt.autorange!==!1&&(!Kt.range||Kt.range.length!==2))}if(Ze[jt]){it.set(V(e(Ve,Ke).get()));continue}}}}}else y.warn("unrecognized GUI edit: "+Ke);delete Pt[Ke],Mt&&Mt.tail.substr(0,6)==="range["&&(at[Mt.head]=1)}for(var Ht=0;Ht<Ee.length;Ht++){var pr=Ee[Ht];if(at[pr]){var Mr=e(be,pr).get();Mr&&delete Mr.autorange}}var hr=Ve._tracePreGUI;for(var Qt in hr){var tr,rr=hr[Qt],fr=null;for(Ke in rr){if(!fr){var yr=ve(Qt,Fe);if(yr<0){delete hr[Qt];break}var Sr=Ae(Qt,pe,(tr=Fe[yr]._fullInput).index);if(Sr<0){delete hr[Qt];break}fr=pe[Sr]}if(Mt=de(Ke,oe)){if(Mt.attr?st=(ct=e(Ve,Mt.attr).get())&&ce(Mt.attr,be):(ct=tr.uirevision,(st=fr.uirevision)===void 0&&(st=be.uirevision)),st&&st===ct&&((Ot=rr[Ke])===null&&(Ot=void 0),fe(ht=(it=e(fr,Ke)).get(),Ot))){it.set(V(e(tr,Ke).get()));continue}}else y.warn("unrecognized GUI edit: "+Ke+" in trace uid "+Qt);delete rr[Ke]}}}(le.data,le.layout,Oe,De),g.supplyDefaults(le,{skipUpdateCalc:!0});var Re=le._fullData,Ye=le._fullLayout,Qe=Ye.datarevision===void 0,lt=Ye.transition,xt=function(pe,be,Fe,Ve,Ke){var Ge=_.layoutFlags();function ct(st){return r.getLayoutValObject(Fe,st)}return Ge.arrays={},Ge.rangesAltered={},Ge.nChanges=0,Ge.nChangesAnim=0,me(be,Fe,[],{getValObject:ct,flags:Ge,immutable:Ve,transition:Ke,gd:pe}),(Ge.plot||Ge.calc)&&(Ge.layoutReplot=!0),Ke&&Ge.nChanges&&Ge.nChangesAnim&&(Ge.anim=Ge.nChanges===Ge.nChangesAnim?"all":"some"),Ge}(le,De,Ye,Qe,lt),wt=xt.newDataRevision,bt=function(pe,be,Fe,Ve,Ke,Ge){var ct=be.length===Fe.length;if(!Ke&&!ct)return{fullReplot:!0,calc:!0};var st,Mt,Ot=_.traceFlags();Ot.arrays={},Ot.nChanges=0,Ot.nChangesAnim=0;var it={getValObject:function(jt){var kt=r.getTraceValObject(Mt,jt);return!Mt._module.animatable&&kt.anim&&(kt.anim=!1),kt},flags:Ot,immutable:Ve,transition:Ke,newDataRevision:Ge,gd:pe},ht={};for(st=0;st<be.length;st++)if(Fe[st]){if(Mt=Fe[st]._fullInput,g.hasMakesDataTransform(Mt)&&(Mt=Fe[st]),ht[Mt.uid])continue;ht[Mt.uid]=1,me(be[st]._fullInput,Mt,[],it)}return(Ot.calc||Ot.plot)&&(Ot.fullReplot=!0),Ke&&Ot.nChanges&&Ot.nChangesAnim&&(Ot.anim=Ot.nChanges===Ot.nChangesAnim&&ct?"all":"some"),Ot}(le,Oe,Re,Qe,lt,wt);if(J(le)&&(xt.layoutReplot=!0),bt.calc||xt.calc){le.calcdata=void 0;for(var nt=Object.getOwnPropertyNames(Ye),$e=0;$e<nt.length;$e++){var vt=nt[$e],Nt=vt.substring(0,5);if(Nt==="xaxis"||Nt==="yaxis"){var qt=Ye[vt]._emptyCategories;qt&&qt()}}}else g.supplyDefaultsUpdateCalc(le.calcdata,Re);var Jt=[];if(Me&&(le._transitionData={},g.createTransitionData(le),Jt.push(function(){return W.addFrames(le,Me)})),Ye.transition&&!Be&&(bt.anim||xt.anim))xt.ticks&&Jt.push(f.doTicksRelayout),g.doCalcdata(le),f.doAutoRangeAndConstraints(le),Jt.push(function(){return g.transitionFromReact(le,bt,xt,De)});else if(bt.fullReplot||xt.layoutReplot||Be)le._fullLayout._skipDefaults=!0,Jt.push(W._doPlot);else{for(var Wt in xt.arrays){var ar=xt.arrays[Wt];if(ar.length){var Dt=a.getComponentMethod(Wt,"drawOne");if(Dt!==y.noop)for(var Ne=0;Ne<ar.length;Ne++)Dt(le,ar[Ne]);else{var qe=a.getComponentMethod(Wt,"draw");if(qe===y.noop)throw new Error("cannot draw components: "+Wt);qe(le)}}}Jt.push(g.previousPromises),bt.style&&Jt.push(f.doTraceStyle),(bt.colorbars||xt.colorbars)&&Jt.push(f.doColorBars),xt.legend&&Jt.push(f.doLegend),xt.layoutstyle&&Jt.push(f.layoutStyles),xt.axrange&&N(Jt),xt.ticks&&Jt.push(f.doTicksRelayout),xt.modebar&&Jt.push(f.doModeBar),xt.camera&&Jt.push(f.doCamera),Jt.push(k)}Jt.push(g.rehover,g.redrag,g.reselect),(ze=y.syncOrAsync(Jt,le))&&ze.then||(ze=Promise.resolve(le))}else ze=W.newPlot(le,ge,Te,Se);return ze.then(function(){return le.emit("plotly_react",{data:ge,layout:Te}),le})},W.redraw=function(le){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le);return x.cleanData(le.data),x.cleanLayout(le.layout),le.calcdata=void 0,W._doPlot(le).then(function(){return le.emit("plotly_redraw"),le})},W.relayout=ne,W.restyle=j,W.setPlotConfig=function(le){return y.extendFlat(c,le)},W.update=ee,W._guiRelayout=re(ne),W._guiRestyle=re(j),W._guiUpdate=re(ee),W._storeDirectGUIEdit=function(le,ge,Te){for(var Se in Te)Q(Se,e(le,Se).get(),Te[Se],ge)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(m,G,W){var d={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},v={};(function w(y,e){for(var t in y){var n=y[t];n.valType?e[t]=n.dflt:(e[t]||(e[t]={}),w(n,e[t]))}})(d,v),G.exports={configAttributes:d,dfltConfig:v}},{}],554:[function(m,G,W){var d=m("../registry"),v=m("../lib"),w=m("../plots/attributes"),y=m("../plots/layout_attributes"),e=m("../plots/frame_attributes"),t=m("../plots/animation_attributes"),n=m("./plot_config").configAttributes,a=m("./edit_types"),r=v.extendDeepAll,g=v.isPlainObject,u=v.isArrayOrTypedArray,s=v.nestedProperty,h=v.valObjectMeta,l=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function o(b,T,k){if(!b)return!1;if(b._isLinkedToArray){if(p(T[k]))k++;else if(k<T.length)return!1}for(;k<T.length;k++){var L=b[T[k]];if(!g(L)||(b=L,k===T.length-1))break;if(b._isLinkedToArray){if(!p(T[++k]))return!1}else if(b.valType==="info_array"){var A=T[++k];if(!p(A))return!1;var I=b.items;if(Array.isArray(I)){if(A>=I.length)return!1;if(b.dimensions===2){if(k++,T.length===k)return b;var P=T[k];if(!p(P))return!1;b=I[A][P]}else b=I[A]}else b=I}}return b}function p(b){return b===Math.round(b)&&b>=0}function c(){var b,T,k={};for(b in r(k,y),d.subplotsRegistry)if((T=d.subplotsRegistry[b]).layoutAttributes)if(Array.isArray(T.attr))for(var L=0;L<T.attr.length;L++)f(k,T,T.attr[L]);else f(k,T,T.attr==="subplot"?T.name:T.attr);for(b in d.componentsRegistry){var A=(T=d.componentsRegistry[b]).schema;if(A&&(A.subplots||A.layout)){var I=A.subplots;if(I&&I.xaxis&&!I.yaxis)for(var P in I.xaxis)delete k.yaxis[P]}else T.name==="colorscale"?r(k,T.layoutAttributes):T.layoutAttributes&&_(k,T.layoutAttributes,T.name)}return{layoutAttributes:x(k)}}function i(){var b={frames:r({},e)};return x(b),b.frames}function x(b){return function(T){W.crawl(T,function(k,L,A){W.isValObject(k)?k.arrayOk!==!0&&k.valType!=="data_array"||(A[L+"src"]={valType:"string",editType:"none"}):g(k)&&(k.role="object")})}(b),function(T){W.crawl(T,function(k,L,A){if(k){var I=k._isLinkedToArray;I&&(delete k._isLinkedToArray,A[L]={items:{}},A[L].items[I]=k,A[L].role="object")}})}(b),function(T){(function k(L){for(var A in L)if(g(L[A]))k(L[A]);else if(Array.isArray(L[A]))for(var I=0;I<L[A].length;I++)k(L[A][I]);else L[A]instanceof RegExp&&(L[A]=L[A].toString())})(T)}(b),b}function f(b,T,k){var L=s(b,k),A=r({},T.layoutAttributes);A._isSubplotObj=!0,L.set(A)}function _(b,T,k){var L=s(b,k);L.set(r(L.get()||{},T))}W.IS_SUBPLOT_OBJ="_isSubplotObj",W.IS_LINKED_TO_ARRAY="_isLinkedToArray",W.DEPRECATED="_deprecated",W.UNDERSCORE_ATTRS=l,W.get=function(){var b={};d.allTypes.forEach(function(k){b[k]=function(L){var A,I;A=d.modules[L]._module,I=A.basePlotModule;var P={type:null},S=r({},w),E=r({},A.attributes);W.crawl(E,function(j,V,Z,Q,K){s(S,K).set(void 0),j===void 0&&s(E,K).set(void 0)}),r(P,S),d.traceIs(L,"noOpacity")&&delete P.opacity,d.traceIs(L,"showLegend")||(delete P.showlegend,delete P.legendgroup),d.traceIs(L,"noHover")&&(delete P.hoverinfo,delete P.hoverlabel),A.selectPoints||delete P.selectedpoints,r(P,E),I.attributes&&r(P,I.attributes),P.type=L;var z={meta:A.meta||{},categories:A.categories||{},animatable:Boolean(A.animatable),type:L,attributes:x(P)};if(A.layoutAttributes){var D={};r(D,A.layoutAttributes),z.layoutAttributes=x(D)}return A.animatable||W.crawl(z,function(j){W.isValObject(j)&&"anim"in j&&delete j.anim}),z}(k)});var T={};return Object.keys(d.transformsRegistry).forEach(function(k){T[k]=function(L){var A=d.transformsRegistry[L],I=r({},A.attributes);return Object.keys(d.componentsRegistry).forEach(function(P){var S=d.componentsRegistry[P];S.schema&&S.schema.transforms&&S.schema.transforms[L]&&Object.keys(S.schema.transforms[L]).forEach(function(E){_(I,S.schema.transforms[L][E],E)})}),{attributes:x(I)}}(k)}),{defs:{valObjects:h,metaKeys:l.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:b,layout:c(),transforms:T,frames:i(),animation:x(t),config:x(n)}},W.crawl=function(b,T,k,L){var A=k||0;L=L||"",Object.keys(b).forEach(function(I){var P=b[I];if(l.indexOf(I)===-1){var S=(L?L+".":"")+I;T(P,I,b,A,S),W.isValObject(P)||g(P)&&I!=="impliedEdits"&&W.crawl(P,T,A+1,S)}})},W.isValObject=function(b){return b&&b.valType!==void 0},W.findArrayAttributes=function(b){var T,k,L=[],A=[],I=[];function P(j,V,Z,Q){A=A.slice(0,Q).concat([V]),I=I.slice(0,Q).concat([j&&j._isLinkedToArray]),j&&(j.valType==="data_array"||j.arrayOk===!0)&&!(A[Q-1]==="colorbar"&&(V==="ticktext"||V==="tickvals"))&&function K($,ne,H){var N=$[A[ne]],U=H+A[ne];if(ne===A.length-1)u(N)&&L.push(k+U);else if(I[ne]){if(Array.isArray(N))for(var te=0;te<N.length;te++)g(N[te])&&K(N[te],ne+1,U+"["+te+"].")}else g(N)&&K(N,ne+1,U+".")}(T,0,"")}T=b,k="",W.crawl(w,P),b._module&&b._module.attributes&&W.crawl(b._module.attributes,P);var S=b.transforms;if(S)for(var E=0;E<S.length;E++){var z=S[E],D=z._module;D&&(k="transforms["+E+"].",T=z,W.crawl(D.attributes,P))}return L},W.getTraceValObject=function(b,T){var k,L,A=T[0],I=1;if(A==="transforms"){if(T.length===1)return w.transforms;var P=b.transforms;if(!Array.isArray(P)||!P.length)return!1;var S=T[1];if(!p(S)||S>=P.length)return!1;L=(k=(d.transformsRegistry[P[S].type]||{}).attributes)&&k[T[2]],I=3}else{var E=b._module;if(E||(E=(d.modules[b.type||w.type.dflt]||{})._module),!E)return!1;if(!(L=(k=E.attributes)&&k[A])){var z=E.basePlotModule;z&&z.attributes&&(L=z.attributes[A])}L||(L=w[A])}return o(L,T,I)},W.getLayoutValObject=function(b,T){return o(function(k,L){var A,I,P,S,E=k._basePlotModules;if(E){var z;for(A=0;A<E.length;A++){if((P=E[A]).attrRegex&&P.attrRegex.test(L)){if(P.layoutAttrOverrides)return P.layoutAttrOverrides;!z&&P.layoutAttributes&&(z=P.layoutAttributes)}var D=P.baseLayoutAttrOverrides;if(D&&L in D)return D[L]}if(z)return z}var j=k._modules;if(j){for(A=0;A<j.length;A++)if((S=j[A].layoutAttributes)&&L in S)return S[L]}for(I in d.componentsRegistry){if((P=d.componentsRegistry[I]).name==="colorscale"&&L.indexOf("coloraxis")===0)return P.layoutAttributes[L];if(!P.schema&&L===P.name)return P.layoutAttributes}return L in y&&y[L]}(b,T[0]),T,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(m,G,W){var d=m("../lib"),v=m("../plots/attributes"),w={name:{valType:"string",editType:"none"}};function y(t){return t&&typeof t=="string"}function e(t){var n=t.length-1;return t.charAt(n)!=="s"&&d.warn("bad argument to arrayDefaultKey: "+t),t.substr(0,t.length-1)+"defaults"}w.templateitemname={valType:"string",editType:"calc"},W.templatedArray=function(t,n){return n._isLinkedToArray=t,n.name=w.name,n.templateitemname=w.templateitemname,n},W.traceTemplater=function(t){var n,a,r={};for(n in t)a=t[n],Array.isArray(a)&&a.length&&(r[n]=0);return{newTrace:function(g){var u={type:n=d.coerce(g,{},v,"type"),_template:null};if(n in r){a=t[n];var s=r[n]%a.length;r[n]++,u._template=a[s]}return u}}},W.newContainer=function(t,n,a){var r=t._template,g=r&&(r[n]||a&&r[a]);return d.isPlainObject(g)||(g=null),t[n]={_template:g}},W.arrayTemplater=function(t,n,a){var r=t._template,g=r&&r[e(n)],u=r&&r[n];Array.isArray(u)&&u.length||(u=[]);var s={};return{newItem:function(h){var l={name:h.name,_input:h},o=l.templateitemname=h.templateitemname;if(!y(o))return l._template=g,l;for(var p=0;p<u.length;p++){var c=u[p];if(c.name===o)return s[o]=1,l._template=c,l}return l[a]=h[a]||!1,l._template=!1,l},defaultItems:function(){for(var h=[],l=0;l<u.length;l++){var o=u[l],p=o.name;if(y(p)&&!s[p]){var c={_template:o,name:p,_input:{_templateitemname:p}};c.templateitemname=o.templateitemname,h.push(c),s[p]=1}}return h}}},W.arrayDefaultKey=e,W.arrayEditor=function(t,n,a){var r=(d.nestedProperty(t,n).get()||[]).length,g=a._index,u=g>=r&&(a._input||{})._templateitemname;u&&(g=r);var s,h=n+"["+g+"]";function l(){s={},u&&(s[h]={},s[h].templateitemname=u)}function o(c,i){u?d.nestedProperty(s[h],c).set(i):s[h+"."+c]=i}function p(){var c=s;return l(),c}return l(),{modifyBase:function(c,i){s[c]=i},modifyItem:o,getUpdateObj:p,applyUpdate:function(c,i){c&&o(c,i);var x=p();for(var f in x)d.nestedProperty(t,f).set(x[f])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(m,G,W){var d=m("@plotly/d3"),v=m("../registry"),w=m("../plots/plots"),y=m("../lib"),e=m("../lib/clear_gl_canvases"),t=m("../components/color"),n=m("../components/drawing"),a=m("../components/titles"),r=m("../components/modebar"),g=m("../plots/cartesian/axes"),u=m("../constants/alignment"),s=m("../plots/cartesian/constraints"),h=s.enforce,l=s.clean,o=m("../plots/cartesian/autorange").doAutoRange;function p(T,k,L){for(var A=0;A<L.length;A++){var I=L[A][0],P=L[A][1];if(!(I[0]>=T[1]||I[1]<=T[0])&&P[0]<k[1]&&P[1]>k[0])return!0}return!1}function c(T){var k,L,A,I,P,S,E=T._fullLayout,z=E._size,D=z.p,j=g.list(T,"",!0);if(E._paperdiv.style({width:T._context.responsive&&E.autosize&&!T._context._hasZeroWidth&&!T.layout.width?"100%":E.width+"px",height:T._context.responsive&&E.autosize&&!T._context._hasZeroHeight&&!T.layout.height?"100%":E.height+"px"}).selectAll(".main-svg").call(n.setSize,E.width,E.height),T._context.setBackground(T,E.paper_bgcolor),W.drawMainTitle(T),r.manage(T),!E._has("cartesian"))return w.previousPromises(T);function V(Ye,Qe,lt){var xt=Ye._lw/2;return Ye._id.charAt(0)==="x"?Qe?lt==="top"?Qe._offset-D-xt:Qe._offset+Qe._length+D+xt:z.t+z.h*(1-(Ye.position||0))+xt%1:Qe?lt==="right"?Qe._offset+Qe._length+D+xt:Qe._offset-D-xt:z.l+z.w*(Ye.position||0)+xt%1}for(k=0;k<j.length;k++){var Z=(I=j[k])._anchorAxis;I._linepositions={},I._lw=n.crispRound(T,I.linewidth,1),I._mainLinePosition=V(I,Z,I.side),I._mainMirrorPosition=I.mirror&&Z?V(I,Z,u.OPPOSITE_SIDE[I.side]):null}var Q=[],K=[],$=[],ne=t.opacity(E.paper_bgcolor)===1&&t.opacity(E.plot_bgcolor)===1&&E.paper_bgcolor===E.plot_bgcolor;for(L in E._plots)if((A=E._plots[L]).mainplot)A.bg&&A.bg.remove(),A.bg=void 0;else{var H=A.xaxis.domain,N=A.yaxis.domain,U=A.plotgroup;if(p(H,N,$)){var te=U.node(),B=A.bg=y.ensureSingle(U,"rect","bg");te.insertBefore(B.node(),te.childNodes[0]),K.push(L)}else U.select("rect.bg").remove(),$.push([H,N]),ne||(Q.push(L),K.push(L))}var X,J,ee,re,se,oe,de,ce,ve,Ae,fe,me,_e,le=E._bgLayer.selectAll(".bg").data(Q);for(le.enter().append("rect").classed("bg",!0),le.exit().remove(),le.each(function(Ye){E._plots[Ye].bg=d.select(this)}),k=0;k<K.length;k++)A=E._plots[K[k]],P=A.xaxis,S=A.yaxis,A.bg&&P._offset!==void 0&&S._offset!==void 0&&A.bg.call(n.setRect,P._offset-D,S._offset-D,P._length+2*D,S._length+2*D).call(t.fill,E.plot_bgcolor).style("stroke-width",0);if(!E._hasOnlyLargeSploms)for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var ge,Te,Se=A.clipId="clip"+E._uid+L+"plot",Me=y.ensureSingleById(E._clips,"clipPath",Se,function(Ye){Ye.classed("plotclip",!0).append("rect")});A.clipRect=Me.select("rect").attr({width:P._length,height:S._length}),n.setTranslate(A.plot,P._offset,S._offset),A._hasClipOnAxisFalse?(ge=null,Te=Se):(ge=Se,Te=null),n.setClipUrl(A.plot,ge,T),A.layerClipId=Te}function ze(Ye){return"M"+X+","+Ye+"H"+J}function Oe(Ye){return"M"+P._offset+","+Ye+"h"+P._length}function De(Ye){return"M"+Ye+","+ce+"V"+de}function Xe(Ye){return"M"+Ye+","+S._offset+"v"+S._length}function Be(Ye,Qe,lt){if(!Ye.showline||L!==Ye._mainSubplot)return"";if(!Ye._anchorAxis)return lt(Ye._mainLinePosition);var xt=Qe(Ye._mainLinePosition);return Ye.mirror&&(xt+=Qe(Ye._mainMirrorPosition)),xt}for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var Ie="M0,0";i(P,L)&&(se=f(P,"left",S,j),X=P._offset-(se?D+se:0),oe=f(P,"right",S,j),J=P._offset+P._length+(oe?D+oe:0),ee=V(P,S,"bottom"),re=V(P,S,"top"),!(_e=!P._anchorAxis||L!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[L]=[ee,re]),Ie=Be(P,ze,Oe),_e&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(Ie+=ze(ee)+ze(re)),A.xlines.style("stroke-width",P._lw+"px").call(t.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),A.xlines.attr("d",Ie);var Re="M0,0";i(S,L)&&(fe=f(S,"bottom",P,j),de=S._offset+S._length+(fe?D:0),me=f(S,"top",P,j),ce=S._offset-(me?D:0),ve=V(S,P,"left"),Ae=V(S,P,"right"),!(_e=!S._anchorAxis||L!==S._mainSubplot)||S.mirror!=="allticks"&&S.mirror!=="all"||(S._linepositions[L]=[ve,Ae]),Re=Be(S,De,Xe),_e&&S.showline&&(S.mirror==="all"||S.mirror==="allticks")&&(Re+=De(ve)+De(Ae)),A.ylines.style("stroke-width",S._lw+"px").call(t.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),A.ylines.attr("d",Re)}return g.makeClipPaths(T),w.previousPromises(T)}function i(T,k){return(T.ticks||T.showline)&&(k===T._mainSubplot||T.mirror==="all"||T.mirror==="allticks")}function x(T,k,L){if(!L.showline||!L._lw)return!1;if(L.mirror==="all"||L.mirror==="allticks")return!0;var A=L._anchorAxis;if(!A)return!1;var I=u.FROM_BL[k];return L.side===k?A.domain[I]===T.domain[I]:L.mirror&&A.domain[1-I]===T.domain[1-I]}function f(T,k,L,A){if(x(T,k,L))return L._lw;for(var I=0;I<A.length;I++){var P=A[I];if(P._mainAxis===L._mainAxis&&x(T,k,P))return P._lw}return 0}function _(T,k){var L=T.title,A=T._size,I=0;switch(k==="start"?I=L.pad.l:k==="end"&&(I=-L.pad.r),L.xref){case"paper":return A.l+A.w*L.x+I;case"container":default:return T.width*L.x+I}}function b(T,k){var L=T.title,A=T._size,I=0;if(k!=="0em"&&k?k===u.CAP_SHIFT+"em"&&(I=L.pad.t):I=-L.pad.b,L.y==="auto")return A.t/2;switch(L.yref){case"paper":return A.t+A.h-A.h*L.y+I;case"container":default:return T.height-T.height*L.y+I}}W.layoutStyles=function(T){return y.syncOrAsync([w.doAutoMargin,c],T)},W.drawMainTitle=function(T){var k=T._fullLayout,L=function(I){var P=I.title,S="middle";return y.isRightAnchor(P)?S="end":y.isLeftAnchor(P)&&(S="start"),S}(k),A=function(I){var P=I.title,S="0em";return y.isTopAnchor(P)?S=u.CAP_SHIFT+"em":y.isMiddleAnchor(P)&&(S=u.MID_SHIFT+"em"),S}(k);a.draw(T,"gtitle",{propContainer:k,propName:"title.text",placeholder:k._dfltTitle.plot,attributes:{x:_(k,L),y:b(k,A),"text-anchor":L,dy:A}})},W.doTraceStyle=function(T){var k,L=T.calcdata,A=[];for(k=0;k<L.length;k++){var I=L[k],P=I[0]||{},S=P.trace||{},E=S._module||{},z=E.arraysToCalcdata;z&&z(I,S);var D=E.editStyle;D&&A.push({fn:D,cd0:P})}if(A.length){for(k=0;k<A.length;k++){var j=A[k];j.fn(T,j.cd0)}e(T),W.redrawReglTraces(T)}return w.style(T),v.getComponentMethod("legend","draw")(T),w.previousPromises(T)},W.doColorBars=function(T){return v.getComponentMethod("colorbar","draw")(T),w.previousPromises(T)},W.layoutReplot=function(T){var k=T.layout;return T.layout=void 0,v.call("_doPlot",T,"",k)},W.doLegend=function(T){return v.getComponentMethod("legend","draw")(T),w.previousPromises(T)},W.doTicksRelayout=function(T){return g.draw(T,"redraw"),T._fullLayout._hasOnlyLargeSploms&&(v.subplotsRegistry.splom.updateGrid(T),e(T),W.redrawReglTraces(T)),W.drawMainTitle(T),w.previousPromises(T)},W.doModeBar=function(T){var k=T._fullLayout;r.manage(T);for(var L=0;L<k._basePlotModules.length;L++){var A=k._basePlotModules[L].updateFx;A&&A(T)}return w.previousPromises(T)},W.doCamera=function(T){for(var k=T._fullLayout,L=k._subplots.gl3d,A=0;A<L.length;A++){var I=k[L[A]];I._scene.setViewport(I)}},W.drawData=function(T){var k=T._fullLayout;e(T);for(var L=k._basePlotModules,A=0;A<L.length;A++)L[A].plot(T);return W.redrawReglTraces(T),w.style(T),v.getComponentMethod("selections","draw")(T),v.getComponentMethod("shapes","draw")(T),v.getComponentMethod("annotations","draw")(T),v.getComponentMethod("images","draw")(T),k._replotting=!1,w.previousPromises(T)},W.redrawReglTraces=function(T){var k=T._fullLayout;if(k._has("regl")){var L,A,I=T._fullData,P=[],S=[];for(k._hasOnlyLargeSploms&&k._splomGrid.draw(),L=0;L<I.length;L++){var E=I[L];E.visible===!0&&E._length!==0&&(E.type==="splom"?k._splomScenes[E.uid].draw():E.type==="scattergl"?y.pushUnique(P,E.xaxis+E.yaxis):E.type==="scatterpolargl"&&y.pushUnique(S,E.subplot))}for(L=0;L<P.length;L++)(A=k._plots[P[L]])._scene&&A._scene.draw();for(L=0;L<S.length;L++)(A=k[S[L]]._subplot)._scene&&A._scene.draw()}},W.doAutoRangeAndConstraints=function(T){for(var k,L=g.list(T,"",!0),A={},I=0;I<L.length;I++)if(!A[(k=L[I])._id]){A[k._id]=1,l(T,k),o(T,k);var P=k._matchGroup;if(P)for(var S in P){var E=g.getFromId(T,S);o(T,E,k.range),A[S]=1}}h(T)},W.finalDraw=function(T){v.getComponentMethod("rangeslider","draw")(T),v.getComponentMethod("rangeselector","draw")(T)},W.drawMarginPushers=function(T){v.getComponentMethod("legend","draw")(T),v.getComponentMethod("rangeselector","draw")(T),v.getComponentMethod("sliders","draw")(T),v.getComponentMethod("updatemenus","draw")(T),v.getComponentMethod("colorbar","draw")(T)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(m,G,W){var d=m("../lib"),v=d.isPlainObject,w=m("./plot_schema"),y=m("../plots/plots"),e=m("../plots/attributes"),t=m("./plot_template"),n=m("./plot_config").dfltConfig;function a(p,c){p=d.extendDeep({},p);var i,x,f=Object.keys(p).sort();function _(A,I,P){if(v(I)&&v(A))a(A,I);else if(Array.isArray(I)&&Array.isArray(A)){var S=t.arrayTemplater({_template:p},P);for(x=0;x<I.length;x++){var E=I[x],z=S.newItem(E)._template;z&&a(z,E)}var D=S.defaultItems();for(x=0;x<D.length;x++)I.push(D[x]._template);for(x=0;x<I.length;x++)delete I[x].templateitemname}}for(i=0;i<f.length;i++){var b=f[i],T=p[b];if(b in c?_(T,c[b],b):c[b]=T,r(b)===b)for(var k in c){var L=r(k);k===L||L!==b||k in p||_(T,c[k],b)}}}function r(p){return p.replace(/[0-9]+$/,"")}function g(p,c,i,x,f){var _=f&&i(f);for(var b in p){var T=p[b],k=h(p,b,x),L=h(p,b,f),A=i(L);if(!A){var I=r(b);I!==b&&(A=i(L=h(p,I,f)))}if((!_||_!==A)&&!(!A||A._noTemplating||A.valType==="data_array"||A.arrayOk&&Array.isArray(T)))if(!A.valType&&v(T))g(T,c,i,k,L);else if(A._isLinkedToArray&&Array.isArray(T))for(var P=!1,S=0,E={},z=0;z<T.length;z++){var D=T[z];if(v(D)){var j=D.name;if(j)E[j]||(g(D,c,i,h(T,S,k),h(T,S,L)),S++,E[j]=1);else if(!P){var V=h(p,t.arrayDefaultKey(b),x),Z=h(T,S,k);g(D,c,i,Z,h(T,S,L));var Q=d.nestedProperty(c,Z);d.nestedProperty(c,V).set(Q.get()),Q.set(null),P=!0}}}else d.nestedProperty(c,k).set(T)}}function u(p,c){return w.getLayoutValObject(p,d.nestedProperty({},c).parts)}function s(p,c){return w.getTraceValObject(p,d.nestedProperty({},c).parts)}function h(p,c,i){return i?Array.isArray(p)?i+"["+c+"]":i+"."+c:c}function l(p){for(var c=0;c<p.length;c++)if(v(p[c]))return!0}function o(p){var c;switch(p.code){case"data":c="The template has no key data.";break;case"layout":c="The template has no key layout.";break;case"missing":c=p.path?"There are no templates for item "+p.path+" with name "+p.templateitemname:"There are no templates for trace "+p.index+", of type "+p.traceType+".";break;case"unused":c=p.path?"The template item at "+p.path+" was not used in constructing the plot.":p.dataCount?"Some of the templates of type "+p.traceType+" were not used. The template has "+p.templateCount+" traces, the data only has "+p.dataCount+" of this type.":"The template has "+p.templateCount+" traces of type "+p.traceType+" but there are none in the data.";break;case"reused":c="Some of the templates of type "+p.traceType+" were used more than once. The template has "+p.templateCount+" traces, the data has "+p.dataCount+" of this type."}return p.msg=c,p}W.makeTemplate=function(p){p=d.isPlainObject(p)?p:d.getGraphDiv(p),p=d.extendDeep({_context:n},{data:p.data,layout:p.layout}),y.supplyDefaults(p);var c=p.data||[],i=p.layout||{};i._basePlotModules=p._fullLayout._basePlotModules,i._modules=p._fullLayout._modules;var x={data:{},layout:{}};c.forEach(function(S){var E={};g(S,E,s.bind(null,S));var z=d.coerce(S,{},e,"type"),D=x.data[z];D||(D=x.data[z]=[]),D.push(E)}),g(i,x.layout,u.bind(null,i)),delete x.layout.template;var f=i.template;if(v(f)){var _,b,T,k,L,A,I=f.layout;v(I)&&a(I,x.layout);var P=f.data;if(v(P)){for(b in x.data)if(T=P[b],Array.isArray(T)){for(A=(L=x.data[b]).length,k=T.length,_=0;_<A;_++)a(T[_%k],L[_]);for(_=A;_<k;_++)L.push(d.extendDeep({},T[_]))}for(b in P)b in x.data||(x.data[b]=d.extendDeep([],P[b]))}}return x},W.validateTemplate=function(p,c){var i=d.extendDeep({},{_context:n,data:p.data,layout:p.layout}),x=i.layout||{};v(c)||(c=x.template||{});var f=c.layout,_=c.data,b=[];i.layout=x,i.layout.template=c,y.supplyDefaults(i);var T=i._fullLayout,k=i._fullData,L={};if(v(f)?(function D(j,V){for(var Z in j)if(Z.charAt(0)!=="_"&&v(j[Z])){var Q,K=r(Z),$=[];for(Q=0;Q<V.length;Q++)$.push(h(j,Z,V[Q])),K!==Z&&$.push(h(j,K,V[Q]));for(Q=0;Q<$.length;Q++)L[$[Q]]=1;D(j[Z],$)}}(T,["layout"]),function D(j,V){for(var Z in j)if(Z.indexOf("defaults")===-1&&v(j[Z])){var Q=h(j,Z,V);L[Q]?D(j[Z],Q):b.push({code:"unused",path:Q})}}(f,"layout")):b.push({code:"layout"}),v(_)){for(var A,I={},P=0;P<k.length;P++){var S=k[P];I[A=S.type]=(I[A]||0)+1,S._fullInput._template||b.push({code:"missing",index:S._fullInput.index,traceType:A})}for(A in _){var E=_[A].length,z=I[A]||0;E>z?b.push({code:"unused",traceType:A,templateCount:E,dataCount:z}):z>E&&b.push({code:"reused",traceType:A,templateCount:E,dataCount:z})}}else b.push({code:"data"});if(function D(j,V){for(var Z in j)if(Z.charAt(0)!=="_"){var Q=j[Z],K=h(j,Z,V);v(Q)?(Array.isArray(j)&&Q._template===!1&&Q.templateitemname&&b.push({code:"missing",path:K,templateitemname:Q.templateitemname}),D(Q,K)):Array.isArray(Q)&&l(Q)&&D(Q,K)}}({data:k,layout:T},""),b.length)return b.map(o)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(m,G,W){var d=m("fast-isnumeric"),v=m("./plot_api"),w=m("../plots/plots"),y=m("../lib"),e=m("../snapshot/helpers"),t=m("../snapshot/tosvg"),n=m("../snapshot/svgtoimg"),a=m("../version").version,r={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};G.exports=function(g,u){var s,h,l,o;function p(z){return!(z in u)||y.validate(u[z],r[z])}if(u=u||{},y.isPlainObject(g)?(s=g.data||[],h=g.layout||{},l=g.config||{},o={}):(g=y.getGraphDiv(g),s=y.extendDeep([],g.data),h=y.extendDeep({},g.layout),l=g._context,o=g._fullLayout||{}),!p("width")&&u.width!==null||!p("height")&&u.height!==null)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Export format is not "+y.join2(r.format.values,", "," or ")+".");var c={};function i(z,D){return y.coerce(u,c,r,z,D)}var x=i("format"),f=i("width"),_=i("height"),b=i("scale"),T=i("setBackground"),k=i("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var A=y.extendFlat({},h);f?A.width=f:u.width===null&&d(o.width)&&(A.width=o.width),_?A.height=_:u.height===null&&d(o.height)&&(A.height=o.height);var I=y.extendFlat({},l,{_exportedPlot:!0,staticPlot:!0,setBackground:T}),P=e.getRedrawFunc(L);function S(){return new Promise(function(z){setTimeout(z,e.getDelay(L._fullLayout))})}function E(){return new Promise(function(z,D){var j=t(L,x,b),V=L._fullLayout.width,Z=L._fullLayout.height;function Q(){v.purge(L),document.body.removeChild(L)}if(x==="full-json"){var K=w.graphJson(L,!1,"keepdata","object",!0,!0);return K.version=a,K=JSON.stringify(K),Q(),z(k?K:e.encodeJSON(K))}if(Q(),x==="svg")return z(k?j:e.encodeSVG(j));var $=document.createElement("canvas");$.id=y.randstr(),n({format:x,width:V,height:Z,scale:b,canvas:$,svg:j,promise:!0}).then(z).catch(D)})}return new Promise(function(z,D){v.newPlot(L,s,A,I).then(P).then(S).then(E).then(function(j){z(function(V){return k?V.replace(e.IMAGE_URL_PREFIX,""):V}(j))}).catch(function(j){D(j)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(m,G,W){var d=m("../lib"),v=m("../plots/plots"),w=m("./plot_schema"),y=m("./plot_config").dfltConfig,e=d.isPlainObject,t=Array.isArray,n=d.isArrayOrTypedArray;function a(c,i,x,f,_,b){b=b||[];for(var T=Object.keys(c),k=0;k<T.length;k++){var L=T[k];if(L!=="transforms"){var A=b.slice();A.push(L);var I=c[L],P=i[L],S=l(x,L),E=(S||{}).valType,z=E==="info_array",D=E==="colorscale",j=(S||{}).items;if(h(x,L))if(e(I)&&e(P)&&E!=="any")a(I,P,S,f,_,A);else if(z&&t(I)){I.length>P.length&&f.push(s("unused",_,A.concat(P.length)));var V,Z,Q,K,$,ne=P.length,H=Array.isArray(j);if(H&&(ne=Math.min(ne,j.length)),S.dimensions===2)for(Z=0;Z<ne;Z++)if(t(I[Z])){I[Z].length>P[Z].length&&f.push(s("unused",_,A.concat(Z,P[Z].length)));var N=P[Z].length;for(V=0;V<(H?Math.min(N,j[Z].length):N);V++)Q=H?j[Z][V]:j,K=I[Z][V],$=P[Z][V],d.validate(K,Q)?$!==K&&$!==+K&&f.push(s("dynamic",_,A.concat(Z,V),K,$)):f.push(s("value",_,A.concat(Z,V),K))}else f.push(s("array",_,A.concat(Z),I[Z]));else for(Z=0;Z<ne;Z++)Q=H?j[Z]:j,K=I[Z],$=P[Z],d.validate(K,Q)?$!==K&&$!==+K&&f.push(s("dynamic",_,A.concat(Z),K,$)):f.push(s("value",_,A.concat(Z),K))}else if(S.items&&!z&&t(I)){var U,te,B=j[Object.keys(j)[0]],X=[];for(U=0;U<P.length;U++){var J=P[U]._index||U;if((te=A.slice()).push(J),e(I[J])&&e(P[U])){X.push(J);var ee=I[J],re=P[U];e(ee)&&ee.visible!==!1&&re.visible===!1?f.push(s("invisible",_,te)):a(ee,re,B,f,_,te)}}for(U=0;U<I.length;U++)(te=A.slice()).push(U),e(I[U])?X.indexOf(U)===-1&&f.push(s("unused",_,te)):f.push(s("object",_,te,I[U]))}else!e(I)&&e(P)?f.push(s("object",_,A,I)):n(I)||!n(P)||z||D?L in i?d.validate(I,S)?S.valType==="enumerated"&&(S.coerceNumber&&I!==+P||I!==P)&&f.push(s("dynamic",_,A,I,P)):f.push(s("value",_,A,I)):f.push(s("unused",_,A,I)):f.push(s("array",_,A,I));else f.push(s("schema",_,A))}}return f}function r(c,i){for(var x=c.layout.layoutAttributes,f=0;f<i.length;f++){var _=i[f],b=c.traces[_.type],T=b.layoutAttributes;T&&(_.subplot?d.extendFlat(x[b.attributes.subplot.dflt],T):d.extendFlat(x,T))}return x}G.exports=function(c,i){c===void 0&&(c=[]),i===void 0&&(i={});var x,f,_=w.get(),b=[],T={_context:d.extendFlat({},y)};t(c)?(T.data=d.extendDeep([],c),x=c):(T.data=[],x=[],b.push(s("array","data"))),e(i)?(T.layout=d.extendDeep({},i),f=i):(T.layout={},f={},arguments.length>1&&b.push(s("object","layout"))),v.supplyDefaults(T);for(var k=T._fullData,L=x.length,A=0;A<L;A++){var I=x[A],P=["data",A];if(e(I)){var S=k[A],E=S.type,z=_.traces[E].attributes;z.type={valType:"enumerated",values:[E]},S.visible===!1&&I.visible!==!1&&b.push(s("invisible",P)),a(I,S,z,b,P);var D=I.transforms,j=S.transforms;if(D){t(D)||b.push(s("array",P,["transforms"])),P.push("transforms");for(var V=0;V<D.length;V++){var Z=["transforms",V],Q=D[V].type;if(e(D[V])){var K=_.transforms[Q]?_.transforms[Q].attributes:{};K.type={valType:"enumerated",values:Object.keys(_.transforms)},a(D[V],j[V],K,b,P,Z)}else b.push(s("object",P,Z))}}}else b.push(s("object",P))}var $=T._fullLayout,ne=r(_,k);return a(f,$,ne,b,"layout"),b.length===0?void 0:b};var g={object:function(c,i){return(c==="layout"&&i===""?"The layout argument":c[0]==="data"&&i===""?"Trace "+c[1]+" in the data argument":u(c)+"key "+i)+" must be linked to an object container"},array:function(c,i){return(c==="data"?"The data argument":u(c)+"key "+i)+" must be linked to an array container"},schema:function(c,i){return u(c)+"key "+i+" is not part of the schema"},unused:function(c,i,x){var f=e(x)?"container":"key";return u(c)+f+" "+i+" did not get coerced"},dynamic:function(c,i,x,f){return[u(c)+"key",i,"(set to '"+x+"')","got reset to","'"+f+"'","during defaults."].join(" ")},invisible:function(c,i){return(i?u(c)+"item "+i:"Trace "+c[1])+" got defaulted to be not visible"},value:function(c,i,x){return[u(c)+"key "+i,"is set to an invalid value ("+x+")"].join(" ")}};function u(c){return t(c)?"In data trace "+c[1]+", ":"In "+c+", "}function s(c,i,x,f,_){var b,T;x=x||"",t(i)?(b=i[0],T=i[1]):(b=i,T=null);var k=function(A){if(!t(A))return String(A);for(var I="",P=0;P<A.length;P++){var S=A[P];typeof S=="number"?I=I.substr(0,I.length-1)+"["+S+"]":I+=S,P<A.length-1&&(I+=".")}return I}(x),L=g[c](i,k,f,_);return d.log(L),{code:c,container:b,trace:T,path:x,astr:k,msg:L}}function h(c,i){var x=p(i),f=x.keyMinusId,_=x.id;return!!(f in c&&c[f]._isSubplotObj&&_)||i in c}function l(c,i){return i in c?c[i]:c[p(i).keyMinusId]}var o=d.counterRegex("([a-z]+)");function p(c){var i=c.match(o);return{keyMinusId:i&&i[1],id:i&&i[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(m,G,W){G.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(m,G,W){var d=m("../lib"),v=m("../plot_api/plot_template");G.exports=function(w,y,e){var t,n,a=e.name,r=e.inclusionAttr||"visible",g=y[a],u=d.isArrayOrTypedArray(w[a])?w[a]:[],s=y[a]=[],h=v.arrayTemplater(y,a,r);for(t=0;t<u.length;t++){var l=u[t];d.isPlainObject(l)?n=h.newItem(l):(n=h.newItem({}))[r]=!1,n._index=t,n[r]!==!1&&e.handleItemDefaults(l,n,y,e),s.push(n)}var o=h.defaultItems();for(t=0;t<o.length;t++)(n=o[t])._index=s.length,e.handleItemDefaults({},n,y,e,{}),s.push(n);if(d.isArrayOrTypedArray(g)){var p=Math.min(g.length,s.length);for(t=0;t<p;t++)d.relinkPrivateKeys(s[t],g[t])}return s}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(m,G,W){var d=m("./font_attributes"),v=m("../components/fx/attributes");G.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:d({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:v.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=v.dateTime2ms,y=v.incrementMonth,e=m("../../constants/numerical").ONEAVGMONTH;G.exports=function(t,n,a,r){if(n.type!=="date")return{vals:r};var g=t[a+"periodalignment"];if(!g)return{vals:r};var u,s=t[a+"period"];if(d(s)){if((s=+s)<=0)return{vals:r}}else if(typeof s=="string"&&s.charAt(0)==="M"){var h=+s.substring(1);if(!(h>0&&Math.round(h)===h))return{vals:r};u=h}for(var l=n.calendar,o=g==="start",p=g==="end",c=t[a+"period0"],i=w(c,l)||0,x=[],f=[],_=[],b=r.length,T=0;T<b;T++){var k,L,A,I=r[T];if(u){for(k=Math.round((I-i)/(u*e)),A=y(i,u*k,l);A>I;)A=y(A,-u,l);for(;A<=I;)A=y(A,u,l);L=y(A,-u,l)}else{for(A=i+(k=Math.round((I-i)/s))*s;A>I;)A-=s;for(;A<=I;)A+=s;L=A-s}x[T]=o?L:p?A:(L+A)/2,f[T]=L,_[T]=A}return{vals:x,starts:f,ends:_}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(m,G,W){G.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../constants/numerical").FP_SAFE,e=m("../../registry"),t=m("../../components/drawing"),n=m("./axis_ids"),a=n.getFromId,r=n.isLinked;function g(f,_){var b,T,k=[],L=f._fullLayout,A=s(L,_,0),I=s(L,_,1),P=h(f,_),S=P.min,E=P.max;if(S.length===0||E.length===0)return w.simpleMap(_.range,_.r2l);var z=S[0].val,D=E[0].val;for(b=1;b<S.length&&z===D;b++)z=Math.min(z,S[b].val);for(b=1;b<E.length&&z===D;b++)D=Math.max(D,E[b].val);var j=!1;if(_.range){var V=w.simpleMap(_.range,_.r2l);j=V[1]<V[0]}_.autorange==="reversed"&&(j=!0,_.autorange=!0);var Z,Q,K,$,ne,H,N=_.rangemode,U=N==="tozero",te=N==="nonnegative",B=_._length,X=B/10,J=0;for(b=0;b<S.length;b++)for(Z=S[b],T=0;T<E.length;T++)(H=(Q=E[T]).val-Z.val-u(_,Z.val,Q.val))>0&&((ne=B-A(Z)-I(Q))>X?H/ne>J&&(K=Z,$=Q,J=H/ne):H/B>J&&(K={val:Z.val,nopad:1},$={val:Q.val,nopad:1},J=H/B));if(z===D){var ee=z-1,re=z+1;if(U)if(z===0)k=[0,1];else{var se=(z>0?E:S).reduce(function(de,ce){return Math.max(de,I(ce))},0),oe=z/(1-Math.min(.5,se/B));k=z>0?[0,oe]:[oe,0]}else k=te?[Math.max(0,ee),Math.max(1,re)]:[ee,re]}else U?(K.val>=0&&(K={val:0,nopad:1}),$.val<=0&&($={val:0,nopad:1})):te&&(K.val-J*A(K)<0&&(K={val:0,nopad:1}),$.val<=0&&($={val:1,nopad:1})),J=($.val-K.val-u(_,Z.val,Q.val))/(B-A(K)-I($)),k=[K.val-J*A(K),$.val+J*I($)];return j&&k.reverse(),w.simpleMap(k,_.l2r||Number)}function u(f,_,b){var T=0;if(f.rangebreaks)for(var k=f.locateBreaks(_,b),L=0;L<k.length;L++){var A=k[L];T+=A.max-A.min}return T}function s(f,_,b){var T=.05*_._length,k=_._anchorAxis||{};if((_.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var L=_.autorange==="reversed";if(!L){var A=w.simpleMap(_.range,_.r2l);L=A[1]<A[0]}L&&(b=!b)}var I=0;return r(f,_._id)||(I=function(P,S,E){var z=0,D=S._id.charAt(0)==="x";for(var j in P._plots){var V=P._plots[j];if(S._id===V.xaxis._id||S._id===V.yaxis._id){var Z=(D?V.yaxis:V.xaxis)||{};if((Z.ticklabelposition||"").indexOf("inside")!==-1&&(!E&&(Z.side==="left"||Z.side==="bottom")||E&&(Z.side==="top"||Z.side==="right"))){if(Z._vals){var Q=w.deg2rad(Z._tickAngles[Z._id+"tick"]||0),K=Math.abs(Math.cos(Q)),$=Math.abs(Math.sin(Q));if(!Z._vals[0].bb){var ne=Z._id+"tick";Z._selections[ne].each(function(B){var X=d.select(this);X.select(".text-math-group").empty()&&(B.bb=t.bBox(X.node()))})}for(var H=0;H<Z._vals.length;H++){var N=Z._vals[H].bb;if(N){var U=6+N.width,te=6+N.height;z=Math.max(z,D?Math.max(U*K,te*$):Math.max(te*K,U*$))}}}Z.ticks==="inside"&&Z.ticklabelposition==="inside"&&(z+=Z.ticklen||0)}}}return z}(f,_,b)),T=Math.max(I,T),_.constrain==="domain"&&_._inputDomain&&(T*=(_._inputDomain[1]-_._inputDomain[0])/(_.domain[1]-_.domain[0])),function(P){return P.nopad?0:P.pad+(P.extrapad?T:I)}}G.exports={getAutoRange:g,makePadFn:s,doAutoRange:function(f,_,b){if(_.setScale(),_.autorange){_.range=b?b.slice():g(f,_),_._r=_.range.slice(),_._rl=w.simpleMap(_._r,_.r2l);var T=_._input,k={};k[_._attr+".range"]=_.range,k[_._attr+".autorange"]=_.autorange,e.call("_storeDirectGUIEdit",f.layout,f._fullLayout._preGUI,k),T.range=_.range.slice(),T.autorange=_.autorange}var L=_._anchorAxis;if(L&&L.rangeslider){var A=L.rangeslider[_._name];A&&A.rangemode==="auto"&&(A.range=g(f,_)),L._input.rangeslider[_._name]=w.extendFlat({},A)}},findExtremes:function(f,_,b){b||(b={}),f._m||f.setScale();var T,k,L,A,I,P,S,E,z,D=[],j=[],V=_.length,Z=b.padded||!1,Q=b.tozero&&(f.type==="linear"||f.type==="-"),K=f.type==="log",$=!1,ne=b.vpadLinearized||!1;function H(re){if(Array.isArray(re))return $=!0,function(oe){return Math.max(Number(re[oe]||0),0)};var se=Math.max(Number(re||0),0);return function(){return se}}var N=H((f._m>0?b.ppadplus:b.ppadminus)||b.ppad||0),U=H((f._m>0?b.ppadminus:b.ppadplus)||b.ppad||0),te=H(b.vpadplus||b.vpad),B=H(b.vpadminus||b.vpad);if(!$){if(E=1/0,z=-1/0,K)for(T=0;T<V;T++)(k=_[T])<E&&k>0&&(E=k),k>z&&k<y&&(z=k);else for(T=0;T<V;T++)(k=_[T])<E&&k>-y&&(E=k),k>z&&k<y&&(z=k);_=[E,z],V=2}var X={tozero:Q,extrapad:Z};function J(re){L=_[re],v(L)&&(P=N(re),S=U(re),ne?(A=f.c2l(L)-B(re),I=f.c2l(L)+te(re)):(E=L-B(re),z=L+te(re),K&&E<z/10&&(E=z/10),A=f.c2l(E),I=f.c2l(z)),Q&&(A=Math.min(0,A),I=Math.max(0,I)),c(A)&&l(D,A,S,X),c(I)&&o(j,I,P,X))}var ee=Math.min(6,V);for(T=0;T<ee;T++)J(T);for(T=V-1;T>=ee;T--)J(T);return{min:D,max:j,opts:b}},concatExtremes:h};function h(f,_,b){var T,k,L,A=_._id,I=f._fullData,P=f._fullLayout,S=[],E=[];function z(Q,K){for(T=0;T<K.length;T++){var $=Q[K[T]],ne=($._extremes||{})[A];if($.visible===!0&&ne){for(k=0;k<ne.min.length;k++)L=ne.min[k],l(S,L.val,L.pad,{extrapad:L.extrapad});for(k=0;k<ne.max.length;k++)L=ne.max[k],o(E,L.val,L.pad,{extrapad:L.extrapad})}}}if(z(I,_._traceIndices),z(P.annotations||[],_._annIndices||[]),z(P.shapes||[],_._shapeIndices||[]),_._matchGroup&&!b){for(var D in _._matchGroup)if(D!==_._id){var j=a(f,D),V=h(f,j,!0),Z=_._length/j._length;for(k=0;k<V.min.length;k++)L=V.min[k],l(S,L.val,L.pad*Z,{extrapad:L.extrapad});for(k=0;k<V.max.length;k++)L=V.max[k],o(E,L.val,L.pad*Z,{extrapad:L.extrapad})}}return{min:S,max:E}}function l(f,_,b,T){p(f,_,b,T,i)}function o(f,_,b,T){p(f,_,b,T,x)}function p(f,_,b,T,k){for(var L=T.tozero,A=T.extrapad,I=!0,P=0;P<f.length&&I;P++){var S=f[P];if(k(S.val,_)&&S.pad>=b&&(S.extrapad||!A)){I=!1;break}k(_,S.val)&&S.pad<=b&&(A||!S.extrapad)&&(f.splice(P,1),P--)}if(I){var E=L&&_===0;f.push({val:_,pad:E?0:b,extrapad:!E&&A})}}function c(f){return v(f)&&Math.abs(f)<y}function i(f,_){return f<=_}function x(f,_){return f>=_}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib"),t=e.strTranslate,n=m("../../lib/svg_text_utils"),a=m("../../components/titles"),r=m("../../components/color"),g=m("../../components/drawing"),u=m("./layout_attributes"),s=m("./clean_ticks"),h=m("../../constants/numerical"),l=h.ONEMAXYEAR,o=h.ONEAVGYEAR,p=h.ONEMINYEAR,c=h.ONEMAXQUARTER,i=h.ONEAVGQUARTER,x=h.ONEMINQUARTER,f=h.ONEMAXMONTH,_=h.ONEAVGMONTH,b=h.ONEMINMONTH,T=h.ONEWEEK,k=h.ONEDAY,L=k/2,A=h.ONEHOUR,I=h.ONEMIN,P=h.ONESEC,S=h.MINUS_SIGN,E=h.BADNUM,z={K:"zeroline"},D={K:"gridline",L:"path"},j={K:"minor-gridline",L:"path"},V={K:"tick",L:"path"},Z={K:"tick",L:"text"},Q={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},K=m("../../constants/alignment"),$=K.MID_SHIFT,ne=K.CAP_SHIFT,H=K.LINE_SPACING,N=K.OPPOSITE_SIDE,U=G.exports={};U.setConvert=m("./set_convert");var te=m("./axis_autotype"),B=m("./axis_ids"),X=B.idSort,J=B.isLinked;U.id2name=B.id2name,U.name2id=B.name2id,U.cleanId=B.cleanId,U.list=B.list,U.listIds=B.listIds,U.getFromId=B.getFromId,U.getFromTrace=B.getFromTrace;var ee=m("./autorange");U.getAutoRange=ee.getAutoRange,U.findExtremes=ee.findExtremes;function re(pe){var be=1e-4*(pe[1]-pe[0]);return[pe[0]-be,pe[1]+be]}U.coerceRef=function(pe,be,Fe,Ve,Ke,Ge){var ct=Ve.charAt(Ve.length-1),st=Fe._fullLayout._subplots[ct+"axis"],Mt=Ve+"ref",Ot={};return Ke||(Ke=st[0]||(typeof Ge=="string"?Ge:Ge[0])),Ge||(Ge=Ke),st=st.concat(st.map(function(it){return it+" domain"})),Ot[Mt]={valType:"enumerated",values:st.concat(Ge?typeof Ge=="string"?[Ge]:Ge:[]),dflt:Ke},e.coerce(pe,be,Ot,Mt)},U.getRefType=function(pe){return pe===void 0?pe:pe==="paper"?"paper":pe==="pixel"?"pixel":/( domain)$/.test(pe)?"domain":"range"},U.coercePosition=function(pe,be,Fe,Ve,Ke,Ge){var ct,st;if(U.getRefType(Ve)!=="range")ct=e.ensureNumber,st=Fe(Ke,Ge);else{var Mt=U.getFromId(be,Ve);st=Fe(Ke,Ge=Mt.fraction2r(Ge)),ct=Mt.cleanPos}pe[Ke]=ct(st)},U.cleanPosition=function(pe,be,Fe){return(Fe==="paper"||Fe==="pixel"?e.ensureNumber:U.getFromId(be,Fe).cleanPos)(pe)},U.redrawComponents=function(pe,be){be=be||U.listIds(pe);var Fe=pe._fullLayout;function Ve(Ke,Ge,ct,st){for(var Mt=y.getComponentMethod(Ke,Ge),Ot={},it=0;it<be.length;it++)for(var ht=Fe[U.id2name(be[it])][ct],jt=0;jt<ht.length;jt++){var kt=ht[jt];if(!Ot[kt]&&(Mt(pe,kt),Ot[kt]=1,st))return}}Ve("annotations","drawOne","_annIndices"),Ve("shapes","drawOne","_shapeIndices"),Ve("images","draw","_imgIndices",!0),Ve("selections","drawOne","_selectionIndices")};var se=U.getDataConversions=function(pe,be,Fe,Ve){var Ke,Ge=Fe==="x"||Fe==="y"||Fe==="z"?Fe:Ve;if(Array.isArray(Ge)){if(Ke={type:te(Ve,void 0,{autotypenumbers:pe._fullLayout.autotypenumbers}),_categories:[]},U.setConvert(Ke),Ke.type==="category")for(var ct=0;ct<Ve.length;ct++)Ke.d2c(Ve[ct])}else Ke=U.getFromTrace(pe,be,Ge);return Ke?{d2c:Ke.d2c,c2d:Ke.c2d}:Ge==="ids"?{d2c:de,c2d:de}:{d2c:oe,c2d:oe}};function oe(pe){return+pe}function de(pe){return String(pe)}function ce(pe,be){return Math.abs((pe/be+.5)%1-.5)<.001}function ve(pe,be){return Math.abs(pe/be-1)<.001}function Ae(pe){return+pe.substring(1)}function fe(pe){var be=re(e.simpleMap(pe.range,pe.r2l)),Fe=Math.min(be[0],be[1]),Ve=Math.max(be[0],be[1]),Ke=pe.type==="category"?pe.d2l_noadd:pe.d2l;pe.type==="log"&&String(pe.dtick).charAt(0)!=="L"&&(pe.dtick="L"+Math.pow(10,Math.floor(Math.min(pe.range[0],pe.range[1]))-1));for(var Ge=[],ct=0;ct<=1;ct++)if(!ct||pe.minor){var st=ct?pe.minor.tickvals:pe.tickvals,Mt=ct?[]:pe.ticktext;if(st){Array.isArray(Mt)||(Mt=[]);for(var Ot=0;Ot<st.length;Ot++){var it=Ke(st[Ot]);if(it>Fe&&it<Ve){var ht=Mt[Ot]===void 0?U.tickText(pe,it):De(pe,it,String(Mt[Ot]));ct&&(ht.minor=!0,ht.text=""),Ge.push(ht)}}}}return pe.rangebreaks&&(Ge=Ge.filter(function(jt){return pe.maskBreaks(jt.x)!==E})),Ge}U.getDataToCoordFunc=function(pe,be,Fe,Ve){return se(pe,be,Fe,Ve).d2c},U.counterLetter=function(pe){var be=pe.charAt(0);return be==="x"?"y":be==="y"?"x":void 0},U.minDtick=function(pe,be,Fe,Ve){["log","category","multicategory"].indexOf(pe.type)===-1&&Ve?pe._minDtick===void 0?(pe._minDtick=be,pe._forceTick0=Fe):pe._minDtick&&((pe._minDtick/be+1e-6)%1<2e-6&&((Fe-pe._forceTick0)/be%1+1.000001)%1<2e-6?(pe._minDtick=be,pe._forceTick0=Fe):((be/pe._minDtick+1e-6)%1>2e-6||((Fe-pe._forceTick0)/pe._minDtick%1+1.000001)%1>2e-6)&&(pe._minDtick=0)):pe._minDtick=0},U.saveRangeInitial=function(pe,be){for(var Fe=U.list(pe,"",!0),Ve=!1,Ke=0;Ke<Fe.length;Ke++){var Ge=Fe[Ke],ct=Ge._rangeInitial===void 0,st=ct||!(Ge.range[0]===Ge._rangeInitial[0]&&Ge.range[1]===Ge._rangeInitial[1]);(ct&&Ge.autorange===!1||be&&st)&&(Ge._rangeInitial=Ge.range.slice(),Ve=!0)}return Ve},U.saveShowSpikeInitial=function(pe,be){for(var Fe=U.list(pe,"",!0),Ve=!1,Ke="on",Ge=0;Ge<Fe.length;Ge++){var ct=Fe[Ge],st=ct._showSpikeInitial===void 0,Mt=st||ct.showspikes!==ct._showspikes;(st||be&&Mt)&&(ct._showSpikeInitial=ct.showspikes,Ve=!0),Ke!=="on"||ct.showspikes||(Ke="off")}return pe._fullLayout._cartesianSpikesEnabled=Ke,Ve},U.autoBin=function(pe,be,Fe,Ve,Ke,Ge){var ct,st=e.aggNums(Math.min,null,pe),Mt=e.aggNums(Math.max,null,pe);if(be.type==="category"||be.type==="multicategory")return{start:st-.5,end:Mt+.5,size:Math.max(1,Math.round(Ge)||1),_dataSpan:Mt-st};if(Ke||(Ke=be.calendar),ct=be.type==="log"?{type:"linear",range:[st,Mt]}:{type:be.type,range:e.simpleMap([st,Mt],be.c2r,0,Ke),calendar:Ke},U.setConvert(ct),Ge=Ge&&s.dtick(Ge,ct.type))ct.dtick=Ge,ct.tick0=s.tick0(void 0,ct.type,Ke);else{var Ot;if(Fe)Ot=(Mt-st)/Fe;else{var it=e.distinctVals(pe),ht=Math.pow(10,Math.floor(Math.log(it.minDiff)/Math.LN10)),jt=ht*e.roundUp(it.minDiff/ht,[.9,1.9,4.9,9.9],!0);Ot=Math.max(jt,2*e.stdev(pe)/Math.pow(pe.length,Ve?.25:.4)),v(Ot)||(Ot=1)}U.autoTicks(ct,Ot)}var kt,Pt=ct.dtick,Ee=U.tickIncrement(U.tickFirst(ct),Pt,"reverse",Ke);if(typeof Pt=="number")kt=(Ee=function(Ze,at,pt,St,Ut){var Kt=0,Ht=0,pr=0,Mr=0;function hr(fr){return(1+100*(fr-Ze)/pt.dtick)%100<2}for(var Qt=0;Qt<at.length;Qt++)at[Qt]%1==0?pr++:v(at[Qt])||Mr++,hr(at[Qt])&&Kt++,hr(at[Qt]+pt.dtick/2)&&Ht++;var tr=at.length-Mr;if(pr===tr&&pt.type!=="date")pt.dtick<1?Ze=St-.5*pt.dtick:(Ze-=.5)+pt.dtick<St&&(Ze+=pt.dtick);else if(Ht<.1*tr&&(Kt>.3*tr||hr(St)||hr(Ut))){var rr=pt.dtick/2;Ze+=Ze+rr<St?rr:-rr}return Ze}(Ee,pe,ct,st,Mt))+(1+Math.floor((Mt-Ee)/Pt))*Pt;else for(ct.dtick.charAt(0)==="M"&&(Ee=function(Ze,at,pt,St,Ut){var Kt=e.findExactDates(at,Ut);if(Kt.exactDays>.8){var Ht=Number(pt.substr(1));Kt.exactYears>.8&&Ht%12==0?Ze=U.tickIncrement(Ze,"M6","reverse")+1.5*k:Kt.exactMonths>.8?Ze=U.tickIncrement(Ze,"M1","reverse")+15.5*k:Ze-=L;var pr=U.tickIncrement(Ze,pt);if(pr<=St)return pr}return Ze}(Ee,pe,Pt,st,Ke)),kt=Ee,0;kt<=Mt;)kt=U.tickIncrement(kt,Pt,!1,Ke);return{start:be.c2r(Ee,0,Ke),end:be.c2r(kt,0,Ke),size:Pt,_dataSpan:Mt-st}},U.prepMinorTicks=function(pe,be,Fe){if(!be.minor.dtick){delete pe.dtick;var Ve,Ke=be.dtick&&v(be._tmin);if(Ke){var Ge=U.tickIncrement(be._tmin,be.dtick,!0);Ve=[be._tmin,.99*Ge+.01*be._tmin]}else{var ct=e.simpleMap(be.range,be.r2l);Ve=[ct[0],.8*ct[0]+.2*ct[1]]}if(pe.range=e.simpleMap(Ve,be.l2r),pe._isMinor=!0,U.prepTicks(pe,Fe),Ke){var st=v(be.dtick),Mt=v(pe.dtick),Ot=st?be.dtick:+be.dtick.substring(1),it=Mt?pe.dtick:+pe.dtick.substring(1);st&&Mt?ce(Ot,it)?Ot===2*T&&it===2*k&&(pe.dtick=T):Ot===2*T&&it===3*k?pe.dtick=T:Ot!==T||(be._input.minor||{}).nticks?ve(Ot/it,2.5)?pe.dtick=Ot/2:pe.dtick=Ot:pe.dtick=k:String(be.dtick).charAt(0)==="M"?Mt?pe.dtick="M1":ce(Ot,it)?Ot>=12&&it===2&&(pe.dtick="M3"):pe.dtick=be.dtick:String(pe.dtick).charAt(0)==="L"?String(be.dtick).charAt(0)==="L"?ce(Ot,it)||(pe.dtick=ve(Ot/it,2.5)?be.dtick/2:be.dtick):pe.dtick="D1":pe.dtick==="D2"&&+be.dtick>1&&(pe.dtick=1)}pe.range=be.range}be.minor._tick0Init===void 0&&(pe.tick0=be.tick0)},U.prepTicks=function(pe,be){var Fe=e.simpleMap(pe.range,pe.r2l,void 0,void 0,be);if(pe.tickmode==="auto"||!pe.dtick){var Ve,Ke=pe.nticks;Ke||(pe.type==="category"||pe.type==="multicategory"?(Ve=pe.tickfont?e.bigFont(pe.tickfont.size||12):15,Ke=pe._length/Ve):(Ve=pe._id.charAt(0)==="y"?40:80,Ke=e.constrain(pe._length/Ve,4,9)+1),pe._name==="radialaxis"&&(Ke*=2)),pe.minor&&pe.minor.tickmode!=="array"||pe.tickmode==="array"&&(Ke*=100),pe._roughDTick=Math.abs(Fe[1]-Fe[0])/Ke,U.autoTicks(pe,pe._roughDTick),pe._minDtick>0&&pe.dtick<2*pe._minDtick&&(pe.dtick=pe._minDtick,pe.tick0=pe.l2r(pe._forceTick0))}pe.ticklabelmode==="period"&&function(Ge){var ct;function st(){return!(v(Ge.dtick)||Ge.dtick.charAt(0)!=="M")}var Mt=st(),Ot=U.getTickFormat(Ge);if(Ot){var it=Ge._dtickInit!==Ge.dtick;/%[fLQsSMX]/.test(Ot)||(/%[HI]/.test(Ot)?(ct=A,it&&!Mt&&Ge.dtick<A&&(Ge.dtick=A)):/%p/.test(Ot)?(ct=L,it&&!Mt&&Ge.dtick<L&&(Ge.dtick=L)):/%[Aadejuwx]/.test(Ot)?(ct=k,it&&!Mt&&Ge.dtick<k&&(Ge.dtick=k)):/%[UVW]/.test(Ot)?(ct=T,it&&!Mt&&Ge.dtick<T&&(Ge.dtick=T)):/%[Bbm]/.test(Ot)?(ct=_,it&&(Mt?Ae(Ge.dtick)<1:Ge.dtick<b)&&(Ge.dtick="M1")):/%[q]/.test(Ot)?(ct=i,it&&(Mt?Ae(Ge.dtick)<3:Ge.dtick<x)&&(Ge.dtick="M3")):/%[Yy]/.test(Ot)&&(ct=o,it&&(Mt?Ae(Ge.dtick)<12:Ge.dtick<p)&&(Ge.dtick="M12")))}(Mt=st())&&Ge.tick0===Ge._dowTick0&&(Ge.tick0=Ge._rawTick0),Ge._definedDelta=ct}(pe),pe.tick0||(pe.tick0=pe.type==="date"?"2000-01-01":0),pe.type==="date"&&pe.dtick<.1&&(pe.dtick=.1),Oe(pe)},U.calcTicks=function(pe,be){for(var Fe,Ve,Ke=pe.type,Ge=pe.calendar,ct=pe.ticklabelstep,st=pe.ticklabelmode==="period",Mt=e.simpleMap(pe.range,pe.r2l,void 0,void 0,be),Ot=Mt[1]<Mt[0],it=Math.min(Mt[0],Mt[1]),ht=Math.max(Mt[0],Mt[1]),jt=Math.max(1e3,pe._length||0),kt=[],Pt=[],Ee=[],Ze=[],at=pe.minor&&(pe.minor.ticks||pe.minor.showgrid),pt=1;pt>=(at?0:1);pt--){var St=!pt;pt?(pe._dtickInit=pe.dtick,pe._tick0Init=pe.tick0):(pe.minor._dtickInit=pe.minor.dtick,pe.minor._tick0Init=pe.minor.tick0);var Ut=pt?pe:e.extendFlat({},pe,pe.minor);if(St?U.prepMinorTicks(Ut,pe,be):U.prepTicks(Ut,be),Ut.tickmode!=="array"){var Kt=re(Mt),Ht=Kt[0],pr=Kt[1],Mr=v(Ut.dtick),hr=Ke==="log"&&!(Mr||Ut.dtick.charAt(0)==="L"),Qt=U.tickFirst(Ut,be);if(pt){if(pe._tmin=Qt,Qt<Ht!==Ot)break;Ke!=="category"&&Ke!=="multicategory"||(pr=Ot?Math.max(-.5,pr):Math.min(pe._categories.length-.5,pr))}var tr,rr,fr=null,yr=Qt;pt&&(Mr?rr=pe.dtick:Ke==="date"?typeof pe.dtick=="string"&&pe.dtick.charAt(0)==="M"&&(rr=_*pe.dtick.substring(1)):rr=pe._roughDTick,tr=Math.round((pe.r2l(yr)-pe.r2l(pe.tick0))/rr)-1);var Sr=Ut.dtick;for(Ut.rangebreaks&&Ut._tick0Init!==Ut.tick0&&(yr=Dt(yr,pe),Ot||(yr=U.tickIncrement(yr,Sr,!Ot,Ge))),pt&&st&&(yr=U.tickIncrement(yr,Sr,!Ot,Ge),tr--);Ot?yr>=pr:yr<=pr;yr=U.tickIncrement(yr,Sr,Ot,Ge)){if(pt&&tr++,Ut.rangebreaks&&!Ot){if(yr<Ht)continue;if(Ut.maskBreaks(yr)===E&&Dt(yr,Ut)>=ht)break}if(Ee.length>jt||yr===fr)break;fr=yr;var Dr={value:yr};pt?(hr&&yr!==(0|yr)&&(Dr.simpleLabel=!0),ct>1&&tr%ct&&(Dr.skipLabel=!0),Ee.push(Dr)):(Dr.minor=!0,Ze.push(Dr))}}else pt?(Ee=[],kt=fe(pe)):(Ze=[],Pt=fe(pe))}if(at&&!(pe.minor.ticks==="inside"&&pe.ticks==="outside"||pe.minor.ticks==="outside"&&pe.ticks==="inside")){for(var Nr=Ee.map(function(Cn){return Cn.value}),Wr=[],hn=0;hn<Ze.length;hn++){var tn=Ze[hn],Fn=tn.value;if(Nr.indexOf(Fn)===-1){for(var an=!1,xn=0;!an&&xn<Ee.length;xn++)1e7+Ee[xn].value===1e7+Fn&&(an=!0);an||Wr.push(tn)}}Ze=Wr}if(st&&function(Cn,oi,nr){for(var vr=0;vr<Cn.length;vr++){var It=Cn[vr].value,lr=vr,dr=vr+1;vr<Cn.length-1?(lr=vr,dr=vr+1):vr>0?(lr=vr-1,dr=vr):(lr=vr,dr=vr);var Br,Fr=Cn[lr].value,zr=Cn[dr].value,Er=Math.abs(zr-Fr),xr=nr||Er,_r=0;xr>=p?_r=Er>=p&&Er<=l?Er:o:nr===i&&xr>=x?_r=Er>=x&&Er<=c?Er:i:xr>=b?_r=Er>=b&&Er<=f?Er:_:nr===T&&xr>=T?_r=T:xr>=k?_r=k:nr===L&&xr>=L?_r=L:nr===A&&xr>=A&&(_r=A),_r>=Er&&(_r=Er,Br=!0);var kr=It+_r;if(oi.rangebreaks&&_r>0){for(var Cr=0,Gr=0;Gr<84;Gr++){var qr=(Gr+.5)/84;oi.maskBreaks(It*(1-qr)+qr*kr)!==E&&Cr++}(_r*=Cr/84)||(Cn[vr].drop=!0),Br&&Er>T&&(_r=Er)}(_r>0||vr===0)&&(Cn[vr].periodX=It+_r/2)}}(Ee,pe,pe._definedDelta),pe.rangebreaks){var _n=pe._id.charAt(0)==="y",ti=1;pe.tickmode==="auto"&&(ti=pe.tickfont?pe.tickfont.size:12);var jr=NaN;for(Fe=Ee.length-1;Fe>-1;Fe--)if(Ee[Fe].drop)Ee.splice(Fe,1);else{Ee[Fe].value=Dt(Ee[Fe].value,pe);var nn=pe.c2p(Ee[Fe].value);(_n?jr>nn-ti:jr<nn+ti)?Ee.splice(Ot?Fe+1:Fe,1):jr=nn}}ar(pe)&&Math.abs(Mt[1]-Mt[0])===360&&Ee.pop(),pe._tmax=(Ee[Ee.length-1]||{}).value,pe._prevDateHead="",pe._inCalcTicks=!0;var vn,en,fn=function(Cn){Cn.text="",pe._prevDateHead=Ve};for(Ee=Ee.concat(Ze),Fe=0;Fe<Ee.length;Fe++){var Gn=Ee[Fe].minor,Tn=Ee[Fe].value;Gn?Pt.push({x:Tn,minor:!0}):(Ve=pe._prevDateHead,vn=U.tickText(pe,Tn,!1,Ee[Fe].simpleLabel),(en=Ee[Fe].periodX)!==void 0&&(vn.periodX=en,(en>ht||en<it)&&(en>ht&&(vn.periodX=ht),en<it&&(vn.periodX=it),fn(vn))),Ee[Fe].skipLabel&&fn(vn),kt.push(vn))}return kt=kt.concat(Pt),pe._inCalcTicks=!1,st&&kt.length&&(kt[0].noTick=!0),kt};var me=[2,5,10],_e=[1,2,3,6,12],le=[1,2,5,10,15,30],ge=[1,2,3,7,14],Te=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Se=[-.301,0,.301,.699,1],Me=[15,30,45,90,180];function ze(pe,be,Fe){return be*e.roundUp(pe/be,Fe)}function Oe(pe){var be=pe.dtick;if(pe._tickexponent=0,v(be)||typeof be=="string"||(be=1),pe.type!=="category"&&pe.type!=="multicategory"||(pe._tickround=null),pe.type==="date"){var Fe=pe.r2l(pe.tick0),Ve=pe.l2r(Fe).replace(/(^-|i)/g,""),Ke=Ve.length;if(String(be).charAt(0)==="M")Ke>10||Ve.substr(5)!=="01-01"?pe._tickround="d":pe._tickround=+be.substr(1)%12==0?"y":"m";else if(be>=k&&Ke<=10||be>=15*k)pe._tickround="d";else if(be>=I&&Ke<=16||be>=A)pe._tickround="M";else if(be>=P&&Ke<=19||be>=I)pe._tickround="S";else{var Ge=pe.l2r(Fe+be).replace(/^-/,"").length;pe._tickround=Math.max(Ke,Ge)-20,pe._tickround<0&&(pe._tickround=4)}}else if(v(be)||be.charAt(0)==="L"){var ct=pe.range.map(pe.r2d||Number);v(be)||(be=Number(be.substr(1))),pe._tickround=2-Math.floor(Math.log(be)/Math.LN10+.01);var st=Math.max(Math.abs(ct[0]),Math.abs(ct[1])),Mt=Math.floor(Math.log(st)/Math.LN10+.01),Ot=pe.minexponent===void 0?3:pe.minexponent;Math.abs(Mt)>Ot&&(Be(pe.exponentformat)&&!Ie(Mt)?pe._tickexponent=3*Math.round((Mt-1)/3):pe._tickexponent=Mt)}else pe._tickround=null}function De(pe,be,Fe){var Ve=pe.tickfont||{};return{x:be,dx:0,dy:0,text:Fe||"",fontSize:Ve.size,font:Ve.family,fontColor:Ve.color}}U.autoTicks=function(pe,be,Fe){var Ve;function Ke(ht){return Math.pow(ht,Math.floor(Math.log(be)/Math.LN10))}if(pe.type==="date"){pe.tick0=e.dateTick0(pe.calendar,0);var Ge=2*be;if(Ge>o)be/=o,Ve=Ke(10),pe.dtick="M"+12*ze(be,Ve,me);else if(Ge>_)be/=_,pe.dtick="M"+ze(be,1,_e);else if(Ge>k){if(pe.dtick=ze(be,k,pe._hasDayOfWeekBreaks?[1,2,7,14]:ge),!Fe){var ct=U.getTickFormat(pe),st=pe.ticklabelmode==="period";st&&(pe._rawTick0=pe.tick0),/%[uVW]/.test(ct)?pe.tick0=e.dateTick0(pe.calendar,2):pe.tick0=e.dateTick0(pe.calendar,1),st&&(pe._dowTick0=pe.tick0)}}else Ge>A?pe.dtick=ze(be,A,_e):Ge>I?pe.dtick=ze(be,I,le):Ge>P?pe.dtick=ze(be,P,le):(Ve=Ke(10),pe.dtick=ze(be,Ve,me))}else if(pe.type==="log"){pe.tick0=0;var Mt=e.simpleMap(pe.range,pe.r2l);if(pe._isMinor&&(be*=1.5),be>.7)pe.dtick=Math.ceil(be);else if(Math.abs(Mt[1]-Mt[0])<1){var Ot=1.5*Math.abs((Mt[1]-Mt[0])/be);be=Math.abs(Math.pow(10,Mt[1])-Math.pow(10,Mt[0]))/Ot,Ve=Ke(10),pe.dtick="L"+ze(be,Ve,me)}else pe.dtick=be>.3?"D2":"D1"}else pe.type==="category"||pe.type==="multicategory"?(pe.tick0=0,pe.dtick=Math.ceil(Math.max(be,1))):ar(pe)?(pe.tick0=0,Ve=1,pe.dtick=ze(be,Ve,Me)):(pe.tick0=0,Ve=Ke(10),pe.dtick=ze(be,Ve,me));if(pe.dtick===0&&(pe.dtick=1),!v(pe.dtick)&&typeof pe.dtick!="string"){var it=pe.dtick;throw pe.dtick=1,"ax.dtick error: "+String(it)}},U.tickIncrement=function(pe,be,Fe,Ve){var Ke=Fe?-1:1;if(v(be))return e.increment(pe,Ke*be);var Ge=be.charAt(0),ct=Ke*Number(be.substr(1));if(Ge==="M")return e.incrementMonth(pe,ct,Ve);if(Ge==="L")return Math.log(Math.pow(10,pe)+ct)/Math.LN10;if(Ge==="D"){var st=be==="D2"?Se:Te,Mt=pe+.01*Ke,Ot=e.roundUp(e.mod(Mt,1),st,Fe);return Math.floor(Mt)+Math.log(d.round(Math.pow(10,Ot),1))/Math.LN10}throw"unrecognized dtick "+String(be)},U.tickFirst=function(pe,be){var Fe=pe.r2l||Number,Ve=e.simpleMap(pe.range,Fe,void 0,void 0,be),Ke=Ve[1]<Ve[0],Ge=Ke?Math.floor:Math.ceil,ct=re(Ve)[0],st=pe.dtick,Mt=Fe(pe.tick0);if(v(st)){var Ot=Ge((ct-Mt)/st)*st+Mt;return pe.type!=="category"&&pe.type!=="multicategory"||(Ot=e.constrain(Ot,0,pe._categories.length-1)),Ot}var it=st.charAt(0),ht=Number(st.substr(1));if(it==="M"){for(var jt,kt,Pt,Ee=0,Ze=Mt;Ee<10;){if(((jt=U.tickIncrement(Ze,st,Ke,pe.calendar))-ct)*(Ze-ct)<=0)return Ke?Math.min(Ze,jt):Math.max(Ze,jt);kt=(ct-(Ze+jt)/2)/(jt-Ze),Pt=it+(Math.abs(Math.round(kt))||1)*ht,Ze=U.tickIncrement(Ze,Pt,kt<0?!Ke:Ke,pe.calendar),Ee++}return e.error("tickFirst did not converge",pe),Ze}if(it==="L")return Math.log(Ge((Math.pow(10,ct)-Mt)/ht)*ht+Mt)/Math.LN10;if(it==="D"){var at=st==="D2"?Se:Te,pt=e.roundUp(e.mod(ct,1),at,Ke);return Math.floor(ct)+Math.log(d.round(Math.pow(10,pt),1))/Math.LN10}throw"unrecognized dtick "+String(st)},U.tickText=function(pe,be,Fe,Ve){var Ke,Ge=De(pe,be),ct=pe.tickmode==="array",st=Fe||ct,Mt=pe.type,Ot=Mt==="category"?pe.d2l_noadd:pe.d2l;if(ct&&Array.isArray(pe.ticktext)){var it=e.simpleMap(pe.range,pe.r2l),ht=(Math.abs(it[1]-it[0])-(pe._lBreaks||0))/1e4;for(Ke=0;Ke<pe.ticktext.length&&!(Math.abs(be-Ot(pe.tickvals[Ke]))<ht);Ke++);if(Ke<pe.ticktext.length)return Ge.text=String(pe.ticktext[Ke]),Ge}function jt(Ee){if(Ee===void 0)return!0;if(Fe)return Ee==="none";var Ze={first:pe._tmin,last:pe._tmax}[Ee];return Ee!=="all"&&be!==Ze}var kt=Fe?"never":pe.exponentformat!=="none"&&jt(pe.showexponent)?"hide":"";if(Mt==="date"?function(Ee,Ze,at,pt){var St=Ee._tickround,Ut=at&&Ee.hoverformat||U.getTickFormat(Ee);pt&&(St=v(St)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[St]);var Kt,Ht=e.formatDate(Ze.x,Ut,St,Ee._dateFormat,Ee.calendar,Ee._extraFormat),pr=Ht.indexOf(`
`);if(pr!==-1&&(Kt=Ht.substr(pr+1),Ht=Ht.substr(0,pr)),pt&&(Ht==="00:00:00"||Ht==="00:00"?(Ht=Kt,Kt=""):Ht.length===8&&(Ht=Ht.replace(/:00$/,""))),Kt)if(at)St==="d"?Ht+=", "+Kt:Ht=Kt+(Ht?", "+Ht:"");else if(Ee._inCalcTicks&&Ee._prevDateHead===Kt){var Mr=Ne(Ee),hr=Ee._trueSide||Ee.side;(!Mr&&hr==="top"||Mr&&hr==="bottom")&&(Ht+="<br> ")}else Ee._prevDateHead=Kt,Ht+="<br>"+Kt;Ze.text=Ht}(pe,Ge,Fe,st):Mt==="log"?function(Ee,Ze,at,pt,St){var Ut=Ee.dtick,Kt=Ze.x,Ht=Ee.tickformat,pr=typeof Ut=="string"&&Ut.charAt(0);if(St==="never"&&(St=""),pt&&pr!=="L"&&(Ut="L3",pr="L"),Ht||pr==="L")Ze.text=Re(Math.pow(10,Kt),Ee,St,pt);else if(v(Ut)||pr==="D"&&e.mod(Kt+.01,1)<.1){var Mr=Math.round(Kt),hr=Math.abs(Mr),Qt=Ee.exponentformat;Qt==="power"||Be(Qt)&&Ie(Mr)?(Ze.text=Mr===0?1:Mr===1?"10":"10<sup>"+(Mr>1?"":S)+hr+"</sup>",Ze.fontSize*=1.25):(Qt==="e"||Qt==="E")&&hr>2?Ze.text="1"+Qt+(Mr>0?"+":S)+hr:(Ze.text=Re(Math.pow(10,Kt),Ee,"","fakehover"),Ut==="D1"&&Ee._id.charAt(0)==="y"&&(Ze.dy-=Ze.fontSize/6))}else{if(pr!=="D")throw"unrecognized dtick "+String(Ut);Ze.text=String(Math.round(Math.pow(10,e.mod(Kt,1)))),Ze.fontSize*=.75}if(Ee.dtick==="D1"){var tr=String(Ze.text).charAt(0);tr!=="0"&&tr!=="1"||(Ee._id.charAt(0)==="y"?Ze.dx-=Ze.fontSize/4:(Ze.dy+=Ze.fontSize/2,Ze.dx+=(Ee.range[1]>Ee.range[0]?1:-1)*Ze.fontSize*(Kt<0?.5:.25)))}}(pe,Ge,0,st,kt):Mt==="category"?function(Ee,Ze){var at=Ee._categories[Math.round(Ze.x)];at===void 0&&(at=""),Ze.text=String(at)}(pe,Ge):Mt==="multicategory"?function(Ee,Ze,at){var pt=Math.round(Ze.x),St=Ee._categories[pt]||[],Ut=St[1]===void 0?"":String(St[1]),Kt=St[0]===void 0?"":String(St[0]);at?Ze.text=Kt+" - "+Ut:(Ze.text=Ut,Ze.text2=Kt)}(pe,Ge,Fe):ar(pe)?function(Ee,Ze,at,pt,St){if(Ee.thetaunit!=="radians"||at)Ze.text=Re(Ze.x,Ee,St,pt);else{var Ut=Ze.x/180;if(Ut===0)Ze.text="0";else{var Kt=function(pr){function Mr(rr,fr){return Math.abs(rr-fr)<=1e-6}var hr=function(rr){for(var fr=1;!Mr(Math.round(rr*fr)/fr,rr);)fr*=10;return fr}(pr),Qt=pr*hr,tr=Math.abs(function rr(fr,yr){return Mr(yr,0)?fr:rr(yr,fr%yr)}(Qt,hr));return[Math.round(Qt/tr),Math.round(hr/tr)]}(Ut);if(Kt[1]>=100)Ze.text=Re(e.deg2rad(Ze.x),Ee,St,pt);else{var Ht=Ze.x<0;Kt[1]===1?Kt[0]===1?Ze.text="\u03C0":Ze.text=Kt[0]+"\u03C0":Ze.text=["<sup>",Kt[0],"</sup>","\u2044","<sub>",Kt[1],"</sub>","\u03C0"].join(""),Ht&&(Ze.text=S+Ze.text)}}}}(pe,Ge,Fe,st,kt):function(Ee,Ze,at,pt,St){St==="never"?St="":Ee.showexponent==="all"&&Math.abs(Ze.x/Ee.dtick)<1e-6&&(St="hide"),Ze.text=Re(Ze.x,Ee,St,pt)}(pe,Ge,0,st,kt),Ve||(pe.tickprefix&&!jt(pe.showtickprefix)&&(Ge.text=pe.tickprefix+Ge.text),pe.ticksuffix&&!jt(pe.showticksuffix)&&(Ge.text+=pe.ticksuffix)),pe.tickson==="boundaries"||pe.showdividers){var Pt=function(Ee){var Ze=pe.l2p(Ee);return Ze>=0&&Ze<=pe._length?Ee:null};Ge.xbnd=[Pt(Ge.x-.5),Pt(Ge.x+pe.dtick-.5)]}return Ge},U.hoverLabelText=function(pe,be,Fe){Fe&&(pe=e.extendFlat({},pe,{hoverformat:Fe}));var Ve=Array.isArray(be)?be[0]:be,Ke=Array.isArray(be)?be[1]:void 0;if(Ke!==void 0&&Ke!==Ve)return U.hoverLabelText(pe,Ve,Fe)+" - "+U.hoverLabelText(pe,Ke,Fe);var Ge=pe.type==="log"&&Ve<=0,ct=U.tickText(pe,pe.c2l(Ge?-Ve:Ve),"hover").text;return Ge?Ve===0?"0":S+ct:ct};var Xe=["f","p","n","\u03BC","m","","k","M","G","T"];function Be(pe){return pe==="SI"||pe==="B"}function Ie(pe){return pe>14||pe<-15}function Re(pe,be,Fe,Ve){var Ke=pe<0,Ge=be._tickround,ct=Fe||be.exponentformat||"B",st=be._tickexponent,Mt=U.getTickFormat(be),Ot=be.separatethousands;if(Ve){var it={exponentformat:ct,minexponent:be.minexponent,dtick:be.showexponent==="none"?be.dtick:v(pe)&&Math.abs(pe)||1,range:be.showexponent==="none"?be.range.map(be.r2d):[0,pe||1]};Oe(it),Ge=(Number(it._tickround)||0)+4,st=it._tickexponent,be.hoverformat&&(Mt=be.hoverformat)}if(Mt)return be._numFormat(Mt)(pe).replace(/-/g,S);var ht,jt=Math.pow(10,-Ge)/2;if(ct==="none"&&(st=0),(pe=Math.abs(pe))<jt)pe="0",Ke=!1;else{if(pe+=jt,st&&(pe*=Math.pow(10,-st),Ge+=st),Ge===0)pe=String(Math.floor(pe));else if(Ge<0){pe=(pe=String(Math.round(pe))).substr(0,pe.length+Ge);for(var kt=Ge;kt<0;kt++)pe+="0"}else{var Pt=(pe=String(pe)).indexOf(".")+1;Pt&&(pe=pe.substr(0,Pt+Ge).replace(/\.?0+$/,""))}pe=e.numSeparate(pe,be._separators,Ot)}return st&&ct!=="hide"&&(Be(ct)&&Ie(st)&&(ct="power"),ht=st<0?S+-st:ct!=="power"?"+"+st:String(st),ct==="e"||ct==="E"?pe+=ct+ht:ct==="power"?pe+="\xD710<sup>"+ht+"</sup>":ct==="B"&&st===9?pe+="B":Be(ct)&&(pe+=Xe[st/3+5])),Ke?S+pe:pe}function Ye(pe,be){if(pe){var Fe=Object.keys(Q).reduce(function(Ve,Ke){return be.indexOf(Ke)!==-1&&Q[Ke].forEach(function(Ge){Ve[Ge]=1}),Ve},{});Object.keys(pe).forEach(function(Ve){Fe[Ve]||(Ve.length===1?pe[Ve]=0:delete pe[Ve])})}}function Qe(pe,be){for(var Fe=[],Ve={},Ke=0;Ke<be.length;Ke++){var Ge=be[Ke];Ve[Ge.text2]?Ve[Ge.text2].push(Ge.x):Ve[Ge.text2]=[Ge.x]}for(var ct in Ve)Fe.push(De(pe,e.interp(Ve[ct],.5),ct));return Fe}function lt(pe){return pe.periodX!==void 0?pe.periodX:pe.x}function xt(pe){return[pe.text,pe.x,pe.axInfo,pe.font,pe.fontSize,pe.fontColor].join("_")}function wt(pe){var be=pe.title.font.size,Fe=(pe.title.text.match(n.BR_TAG_ALL)||[]).length;return pe.title.hasOwnProperty("standoff")?Fe?be*(ne+Fe*H):be*ne:Fe?be*(Fe+1)*H:be}function bt(pe,be){var Fe=pe.l2p(be);return Fe>1&&Fe<pe._length-1}function nt(pe){var be=d.select(pe),Fe=be.select(".text-math-group");return Fe.empty()?be.select("text"):Fe}function $e(pe){return pe._id+".automargin"}function vt(pe){return $e(pe)+".mirror"}function Nt(pe){return pe._id+".rangeslider"}function qt(pe,be){for(var Fe=0;Fe<be.length;Fe++)pe.indexOf(be[Fe])===-1&&pe.push(be[Fe])}function Jt(pe,be,Fe){var Ve,Ke,Ge=[],ct=[],st=pe.layout;for(Ve=0;Ve<be.length;Ve++)Ge.push(U.getFromId(pe,be[Ve]));for(Ve=0;Ve<Fe.length;Ve++)ct.push(U.getFromId(pe,Fe[Ve]));var Mt=Object.keys(u),Ot=["anchor","domain","overlaying","position","side","tickangle","editType"],it=["linear","log"];for(Ve=0;Ve<Mt.length;Ve++){var ht=Mt[Ve],jt=Ge[0][ht],kt=ct[0][ht],Pt=!0,Ee=!1,Ze=!1;if(ht.charAt(0)!=="_"&&typeof jt!="function"&&Ot.indexOf(ht)===-1){for(Ke=1;Ke<Ge.length&&Pt;Ke++){var at=Ge[Ke][ht];ht==="type"&&it.indexOf(jt)!==-1&&it.indexOf(at)!==-1&&jt!==at?Ee=!0:at!==jt&&(Pt=!1)}for(Ke=1;Ke<ct.length&&Pt;Ke++){var pt=ct[Ke][ht];ht==="type"&&it.indexOf(kt)!==-1&&it.indexOf(pt)!==-1&&kt!==pt?Ze=!0:ct[Ke][ht]!==kt&&(Pt=!1)}Pt&&(Ee&&(st[Ge[0]._name].type="linear"),Ze&&(st[ct[0]._name].type="linear"),Wt(st,ht,Ge,ct,pe._fullLayout._dfltTitle))}}for(Ve=0;Ve<pe._fullLayout.annotations.length;Ve++){var St=pe._fullLayout.annotations[Ve];be.indexOf(St.xref)!==-1&&Fe.indexOf(St.yref)!==-1&&e.swapAttrs(st.annotations[Ve],["?"])}}function Wt(pe,be,Fe,Ve,Ke){var Ge,ct=e.nestedProperty,st=ct(pe[Fe[0]._name],be).get(),Mt=ct(pe[Ve[0]._name],be).get();for(be==="title"&&(st&&st.text===Ke.x&&(st.text=Ke.y),Mt&&Mt.text===Ke.y&&(Mt.text=Ke.x)),Ge=0;Ge<Fe.length;Ge++)ct(pe,Fe[Ge]._name+"."+be).set(Mt);for(Ge=0;Ge<Ve.length;Ge++)ct(pe,Ve[Ge]._name+"."+be).set(st)}function ar(pe){return pe._id==="angularaxis"}function Dt(pe,be){for(var Fe=be._rangebreaks.length,Ve=0;Ve<Fe;Ve++){var Ke=be._rangebreaks[Ve];if(pe>=Ke.min&&pe<Ke.max)return Ke.max}return pe}function Ne(pe){return(pe.ticklabelposition||"").indexOf("inside")!==-1}function qe(pe,be){Ne(pe._anchorAxis||{})&&pe._hideCounterAxisInsideTickLabels&&pe._hideCounterAxisInsideTickLabels(be)}U.getTickFormat=function(pe){var be,Fe,Ve,Ke,Ge,ct,st,Mt;function Ot(jt){return typeof jt!="string"?jt:Number(jt.replace("M",""))*_}function it(jt,kt){var Pt=["L","D"];if(typeof jt==typeof kt){if(typeof jt=="number")return jt-kt;var Ee=Pt.indexOf(jt.charAt(0)),Ze=Pt.indexOf(kt.charAt(0));return Ee===Ze?Number(jt.replace(/(L|D)/g,""))-Number(kt.replace(/(L|D)/g,"")):Ee-Ze}return typeof jt=="number"?1:-1}function ht(jt,kt){var Pt=kt[0]===null,Ee=kt[1]===null,Ze=it(jt,kt[0])>=0,at=it(jt,kt[1])<=0;return(Pt||Ze)&&(Ee||at)}if(pe.tickformatstops&&pe.tickformatstops.length>0)switch(pe.type){case"date":case"linear":for(be=0;be<pe.tickformatstops.length;be++)if((Ve=pe.tickformatstops[be]).enabled&&(Ke=pe.dtick,Ge=Ve.dtickrange,ct=void 0,st=void 0,Mt=void 0,ct=Ot||function(jt){return jt},st=Ge[0],Mt=Ge[1],(!st&&typeof st!="number"||ct(st)<=ct(Ke))&&(!Mt&&typeof Mt!="number"||ct(Mt)>=ct(Ke)))){Fe=Ve;break}break;case"log":for(be=0;be<pe.tickformatstops.length;be++)if((Ve=pe.tickformatstops[be]).enabled&&ht(pe.dtick,Ve.dtickrange)){Fe=Ve;break}}return Fe?Fe.value:pe.tickformat},U.getSubplots=function(pe,be){var Fe=pe._fullLayout._subplots,Ve=Fe.cartesian.concat(Fe.gl2d||[]),Ke=be?U.findSubplotsWithAxis(Ve,be):Ve;return Ke.sort(function(Ge,ct){var st=Ge.substr(1).split("y"),Mt=ct.substr(1).split("y");return st[0]===Mt[0]?+st[1]-+Mt[1]:+st[0]-+Mt[0]}),Ke},U.findSubplotsWithAxis=function(pe,be){for(var Fe=new RegExp(be._id.charAt(0)==="x"?"^"+be._id+"y":be._id+"$"),Ve=[],Ke=0;Ke<pe.length;Ke++){var Ge=pe[Ke];Fe.test(Ge)&&Ve.push(Ge)}return Ve},U.makeClipPaths=function(pe){var be=pe._fullLayout;if(!be._hasOnlyLargeSploms){var Fe,Ve,Ke={_offset:0,_length:be.width,_id:""},Ge={_offset:0,_length:be.height,_id:""},ct=U.list(pe,"x",!0),st=U.list(pe,"y",!0),Mt=[];for(Fe=0;Fe<ct.length;Fe++)for(Mt.push({x:ct[Fe],y:Ge}),Ve=0;Ve<st.length;Ve++)Fe===0&&Mt.push({x:Ke,y:st[Ve]}),Mt.push({x:ct[Fe],y:st[Ve]});var Ot=be._clips.selectAll(".axesclip").data(Mt,function(it){return it.x._id+it.y._id});Ot.enter().append("clipPath").classed("axesclip",!0).attr("id",function(it){return"clip"+be._uid+it.x._id+it.y._id}).append("rect"),Ot.exit().remove(),Ot.each(function(it){d.select(this).select("rect").attr({x:it.x._offset||0,y:it.y._offset||0,width:it.x._length||1,height:it.y._length||1})})}},U.draw=function(pe,be,Fe){var Ve=pe._fullLayout;be==="redraw"&&Ve._paper.selectAll("g.subplot").each(function(Ge){var ct=Ge[0],st=Ve._plots[ct];if(st){var Mt=st.xaxis,Ot=st.yaxis;st.xaxislayer.selectAll("."+Mt._id+"tick").remove(),st.yaxislayer.selectAll("."+Ot._id+"tick").remove(),st.xaxislayer.selectAll("."+Mt._id+"tick2").remove(),st.yaxislayer.selectAll("."+Ot._id+"tick2").remove(),st.xaxislayer.selectAll("."+Mt._id+"divider").remove(),st.yaxislayer.selectAll("."+Ot._id+"divider").remove(),st.minorGridlayer&&st.minorGridlayer.selectAll("path").remove(),st.gridlayer&&st.gridlayer.selectAll("path").remove(),st.zerolinelayer&&st.zerolinelayer.selectAll("path").remove(),Ve._infolayer.select(".g-"+Mt._id+"title").remove(),Ve._infolayer.select(".g-"+Ot._id+"title").remove()}});var Ke=be&&be!=="redraw"?be:U.listIds(pe);return e.syncOrAsync(Ke.map(function(Ge){return function(){if(Ge){var ct=U.getFromId(pe,Ge),st=U.drawOne(pe,ct,Fe);return ct._r=ct.range.slice(),ct._rl=e.simpleMap(ct._r,ct.r2l),st}}}))},U.drawOne=function(pe,be,Fe){var Ve,Ke,Ge;Fe=Fe||{},be.setScale();var ct=pe._fullLayout,st=be._id,Mt=st.charAt(0),Ot=U.counterLetter(st),it=ct._plots[be._mainSubplot];if(it){var ht=it[Mt+"axislayer"],jt=be._mainLinePosition,kt=be._mainMirrorPosition,Pt=be._vals=U.calcTicks(be),Ee=[be.mirror,jt,kt].join("_");for(Ve=0;Ve<Pt.length;Ve++)Pt[Ve].axInfo=Ee;be._selections={},be._tickAngles&&(be._prevTickAngles=be._tickAngles),be._tickAngles={},be._depth=null;var Ze={};if(be.visible){var at,pt,St=U.makeTransTickFn(be),Ut=U.makeTransTickLabelFn(be),Kt=be.ticks==="inside",Ht=be.ticks==="outside";if(be.tickson==="boundaries"){var pr=function(nr,vr){var It,lr=[],dr=function(Br,Fr){var zr=Br.xbnd[Fr];zr!==null&&lr.push(e.extendFlat({},Br,{x:zr}))};if(vr.length){for(It=0;It<vr.length;It++)dr(vr[It],0);dr(vr[It-1],1)}return lr}(0,Pt);pt=U.clipEnds(be,pr),at=Kt?pt:pr}else pt=U.clipEnds(be,Pt),at=Kt&&be.ticklabelmode!=="period"?pt:Pt;var Mr,hr=be._gridVals=pt,Qt=function(nr,vr){var It,lr,dr=[],Br=vr.length&&vr[vr.length-1].x<vr[0].x,Fr=function(Er,xr){var _r=Er.xbnd[xr];_r!==null&&dr.push(e.extendFlat({},Er,{x:_r}))};if(nr.showdividers&&vr.length){for(It=0;It<vr.length;It++){var zr=vr[It];zr.text2!==lr&&Fr(zr,Br?1:0),lr=zr.text2}Fr(vr[It-1],Br?0:1)}return dr}(be,Pt);if(!ct._hasOnlyLargeSploms){var tr=be._subplotsWith,rr={};for(Ve=0;Ve<tr.length;Ve++){Ke=tr[Ve];var fr=(Ge=ct._plots[Ke])[Ot+"axis"],yr=fr._mainAxis._id;if(!rr[yr]){rr[yr]=1;var Sr=Mt==="x"?"M0,"+fr._offset+"v"+fr._length:"M"+fr._offset+",0h"+fr._length;U.drawGrid(pe,be,{vals:hr,counterAxis:fr,layer:Ge.gridlayer.select("."+st),minorLayer:Ge.minorGridlayer.select("."+st),path:Sr,transFn:St}),U.drawZeroLine(pe,be,{counterAxis:fr,layer:Ge.zerolinelayer,path:Sr,transFn:St})}}}var Dr=U.getTickSigns(be),Nr=U.getTickSigns(be,"minor");if(be.ticks||be.minor&&be.minor.ticks){var Wr,hn,tn,Fn,an=U.makeTickPath(be,jt,Dr[2]),xn=U.makeTickPath(be,jt,Nr[2],{minor:!0});if(be._anchorAxis&&be.mirror&&be.mirror!==!0?(Wr=U.makeTickPath(be,kt,Dr[3]),hn=U.makeTickPath(be,kt,Nr[3],{minor:!0}),tn=an+Wr,Fn=xn+hn):(Wr="",hn="",tn=an,Fn=xn),be.showdividers&&Ht&&be.tickson==="boundaries"){var _n={};for(Ve=0;Ve<Qt.length;Ve++)_n[Qt[Ve].x]=1;Mr=function(nr){return _n[nr.x]?Wr:tn}}else Mr=function(nr){return nr.minor?Fn:tn}}if(U.drawTicks(pe,be,{vals:at,layer:ht,path:Mr,transFn:St}),be.mirror==="allticks"){var ti=Object.keys(be._linepositions||{});for(Ve=0;Ve<ti.length;Ve++){Ke=ti[Ve],Ge=ct._plots[Ke];var jr=be._linepositions[Ke]||[],nn=jr[0],vn=jr[1],en=jr[2],fn=U.makeTickPath(be,nn,en?Dr[0]:Nr[0],{minor:en})+U.makeTickPath(be,vn,en?Dr[1]:Nr[1],{minor:en});U.drawTicks(pe,be,{vals:at,layer:Ge[Mt+"axislayer"],path:fn,transFn:St})}}var Gn=[];if(Gn.push(function(){return U.drawLabels(pe,be,{vals:Pt,layer:ht,plotinfo:Ge,transFn:Ut,labelFns:U.makeLabelFns(be,jt)})}),be.type==="multicategory"){var Tn={x:2,y:10}[Mt];Gn.push(function(){var nr={x:"height",y:"width"}[Mt],vr=oi()[nr]+Tn+(be._tickAngles[st+"tick"]?be.tickfont.size*H:0);return U.drawLabels(pe,be,{vals:Qe(be,Pt),layer:ht,cls:st+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:St,labelFns:U.makeLabelFns(be,jt+vr*Dr[4])})}),Gn.push(function(){return be._depth=Dr[4]*(oi("tick2")[be.side]-jt),function(nr,vr,It){var lr=vr._id+"divider",dr=It.vals,Br=It.layer.selectAll("path."+lr).data(dr,xt);Br.exit().remove(),Br.enter().insert("path",":first-child").classed(lr,1).classed("crisp",1).call(r.stroke,vr.dividercolor).style("stroke-width",g.crispRound(nr,vr.dividerwidth,1)+"px"),Br.attr("transform",It.transFn).attr("d",It.path)}(pe,be,{vals:Qt,layer:ht,path:U.makeTickPath(be,jt,Dr[4],{len:be._depth}),transFn:St})})}else be.title.hasOwnProperty("standoff")&&Gn.push(function(){be._depth=Dr[4]*(oi()[be.side]-jt)});var Cn=y.getComponentMethod("rangeslider","isVisible")(be);return Gn.push(function(){var nr,vr,It,lr,dr=be.side.charAt(0),Br=N[be.side].charAt(0),Fr=U.getPxPosition(pe,be),zr=Ht?be.ticklen:0;if((be.automargin||Cn)&&(be.type==="multicategory"?nr=oi("tick2"):(nr=oi(),Mt==="x"&&dr==="b"&&(be._depth=Math.max(nr.width>0?nr.bottom-Fr:0,zr)))),be.automargin){vr={x:0,y:0,r:0,l:0,t:0,b:0};var Er=[0,1];if(Mt==="x"){if(dr==="b"?vr[dr]=be._depth:(vr[dr]=be._depth=Math.max(nr.width>0?Fr-nr.top:0,zr),Er.reverse()),nr.width>0){var xr=nr.right-(be._offset+be._length);xr>0&&(vr.xr=1,vr.r=xr);var _r=be._offset-nr.left;_r>0&&(vr.xl=0,vr.l=_r)}}else if(dr==="l"?vr[dr]=be._depth=Math.max(nr.height>0?Fr-nr.left:0,zr):(vr[dr]=be._depth=Math.max(nr.height>0?nr.right-Fr:0,zr),Er.reverse()),nr.height>0){var kr=nr.bottom-(be._offset+be._length);kr>0&&(vr.yb=0,vr.b=kr);var Cr=be._offset-nr.top;Cr>0&&(vr.yt=1,vr.t=Cr)}vr[Ot]=be.anchor==="free"?be.position:be._anchorAxis.domain[Er[0]],be.title.text!==ct._dfltTitle[Mt]&&(vr[dr]+=wt(be)+(be.title.standoff||0)),be.mirror&&be.anchor!=="free"&&((It={x:0,y:0,r:0,l:0,t:0,b:0})[Br]=be.linewidth,be.mirror&&be.mirror!==!0&&(It[Br]+=zr),be.mirror===!0||be.mirror==="ticks"?It[Ot]=be._anchorAxis.domain[Er[1]]:be.mirror!=="all"&&be.mirror!=="allticks"||(It[Ot]=[be._counterDomainMin,be._counterDomainMax][Er[1]]))}Cn&&(lr=y.getComponentMethod("rangeslider","autoMarginOpts")(pe,be)),typeof be.automargin=="string"&&(Ye(vr,be.automargin),Ye(It,be.automargin)),w.autoMargin(pe,$e(be),vr),w.autoMargin(pe,vt(be),It),w.autoMargin(pe,Nt(be),lr)}),Fe.skipTitle||Cn&&be.side==="bottom"||Gn.push(function(){return function(nr,vr){var It,lr=nr._fullLayout,dr=vr._id,Br=dr.charAt(0),Fr=vr.title.font.size;if(vr.title.hasOwnProperty("standoff"))It=vr._depth+vr.title.standoff+wt(vr);else{var zr=Ne(vr);if(vr.type==="multicategory")It=vr._depth;else{var Er=1.5*Fr;zr&&(Er=.5*Fr,vr.ticks==="outside"&&(Er+=vr.ticklen)),It=10+Er+(vr.linewidth?vr.linewidth-1:0)}zr||(It+=Br==="x"?vr.side==="top"?Fr*(vr.showticklabels?1:0):Fr*(vr.showticklabels?1.5:.5):vr.side==="right"?Fr*(vr.showticklabels?1:.5):Fr*(vr.showticklabels?.5:0))}var xr,_r,kr,Cr,Gr=U.getPxPosition(nr,vr);if(Br==="x"?(_r=vr._offset+vr._length/2,kr=vr.side==="top"?Gr-It:Gr+It):(kr=vr._offset+vr._length/2,_r=vr.side==="right"?Gr+It:Gr-It,xr={rotate:"-90",offset:0}),vr.type!=="multicategory"){var qr=vr._selections[vr._id+"tick"];if(Cr={selection:qr,side:vr.side},qr&&qr.node()&&qr.node().parentNode){var Qr=g.getTranslate(qr.node().parentNode);Cr.offsetLeft=Qr.x,Cr.offsetTop=Qr.y}vr.title.hasOwnProperty("standoff")&&(Cr.pad=0)}return a.draw(nr,dr+"title",{propContainer:vr,propName:vr._name+".title.text",placeholder:lr._dfltTitle[Br],avoid:Cr,transform:xr,attributes:{x:_r,y:kr,"text-anchor":"middle"}})}(pe,be)}),e.syncOrAsync(Gn)}}function oi(nr){var vr=st+(nr||"tick");return Ze[vr]||(Ze[vr]=function(It,lr){var dr,Br,Fr,zr;return It._selections[lr].size()?(dr=1/0,Br=-1/0,Fr=1/0,zr=-1/0,It._selections[lr].each(function(){var Er=nt(this),xr=g.bBox(Er.node().parentNode);dr=Math.min(dr,xr.top),Br=Math.max(Br,xr.bottom),Fr=Math.min(Fr,xr.left),zr=Math.max(zr,xr.right)})):(dr=0,Br=0,Fr=0,zr=0),{top:dr,bottom:Br,left:Fr,right:zr,height:Br-dr,width:zr-Fr}}(be,vr)),Ze[vr]}},U.getTickSigns=function(pe,be){var Fe=pe._id.charAt(0),Ve={x:"top",y:"right"}[Fe],Ke=pe.side===Ve?1:-1,Ge=[-1,1,Ke,-Ke];return(be?(pe.minor||{}).ticks:pe.ticks)!=="inside"==(Fe==="x")&&(Ge=Ge.map(function(ct){return-ct})),pe.side&&Ge.push({l:-1,t:-1,r:1,b:1}[pe.side.charAt(0)]),Ge},U.makeTransTickFn=function(pe){return pe._id.charAt(0)==="x"?function(be){return t(pe._offset+pe.l2p(be.x),0)}:function(be){return t(0,pe._offset+pe.l2p(be.x))}},U.makeTransTickLabelFn=function(pe){var be=function(Ke){var Ge=Ke.ticklabelposition||"",ct=function(at){return Ge.indexOf(at)!==-1},st=ct("top"),Mt=ct("left"),Ot=ct("right"),it=ct("bottom"),ht=ct("inside"),jt=it||Mt||st||Ot;if(!jt&&!ht)return[0,0];var kt=Ke.side,Pt=jt?(Ke.tickwidth||0)/2:0,Ee=3,Ze=Ke.tickfont?Ke.tickfont.size:12;return(it||st)&&(Pt+=Ze*ne,Ee+=(Ke.linewidth||0)/2),(Mt||Ot)&&(Pt+=(Ke.linewidth||0)/2,Ee+=3),ht&&kt==="top"&&(Ee-=Ze*(1-ne)),(Mt||st)&&(Pt=-Pt),kt!=="bottom"&&kt!=="right"||(Ee=-Ee),[jt?Pt:0,ht?Ee:0]}(pe),Fe=be[0],Ve=be[1];return pe._id.charAt(0)==="x"?function(Ke){return t(Fe+pe._offset+pe.l2p(lt(Ke)),Ve)}:function(Ke){return t(Ve,Fe+pe._offset+pe.l2p(lt(Ke)))}},U.makeTickPath=function(pe,be,Fe,Ve){Ve||(Ve={});var Ke=Ve.minor;if(Ke&&!pe.minor)return"";var Ge=Ve.len!==void 0?Ve.len:Ke?pe.minor.ticklen:pe.ticklen,ct=pe._id.charAt(0),st=(pe.linewidth||1)/2;return ct==="x"?"M0,"+(be+st*Fe)+"v"+Ge*Fe:"M"+(be+st*Fe)+",0h"+Ge*Fe},U.makeLabelFns=function(pe,be,Fe){var Ve=pe.ticklabelposition||"",Ke=function(tr){return Ve.indexOf(tr)!==-1},Ge=Ke("top"),ct=Ke("left"),st=Ke("right"),Mt=Ke("bottom")||ct||Ge||st,Ot=Ke("inside"),it=Ve==="inside"&&pe.ticks==="inside"||!Ot&&pe.ticks==="outside"&&pe.tickson!=="boundaries",ht=0,jt=0,kt=it?pe.ticklen:0;if(Ot?kt*=-1:Mt&&(kt=0),it&&(ht+=kt,Fe)){var Pt=e.deg2rad(Fe);ht=kt*Math.cos(Pt)+1,jt=kt*Math.sin(Pt)}pe.showticklabels&&(it||pe.showline)&&(ht+=.2*pe.tickfont.size);var Ee,Ze,at,pt,St,Ut={labelStandoff:ht+=(pe.linewidth||1)/2*(Ot?-1:1),labelShift:jt},Kt=0,Ht=pe.side,pr=pe._id.charAt(0),Mr=pe.tickangle;if(pr==="x")pt=(St=!Ot&&Ht==="bottom"||Ot&&Ht==="top")?1:-1,Ot&&(pt*=-1),Ee=jt*pt,Ze=be+ht*pt,at=St?1:-.2,Math.abs(Mr)===90&&(Ot?at+=$:at=Mr===-90&&Ht==="bottom"?ne:Mr===90&&Ht==="top"?$:.5,Kt=$/2*(Mr/90)),Ut.xFn=function(tr){return tr.dx+Ee+Kt*tr.fontSize},Ut.yFn=function(tr){return tr.dy+Ze+tr.fontSize*at},Ut.anchorFn=function(tr,rr){if(Mt){if(ct)return"end";if(st)return"start"}return v(rr)&&rr!==0&&rr!==180?rr*pt<0!==Ot?"end":"start":"middle"},Ut.heightFn=function(tr,rr,fr){return rr<-60||rr>60?-.5*fr:pe.side==="top"!==Ot?-fr:0};else if(pr==="y"){if(pt=(St=!Ot&&Ht==="left"||Ot&&Ht==="right")?1:-1,Ot&&(pt*=-1),Ee=ht,Ze=jt*pt,at=0,Ot||Math.abs(Mr)!==90||(at=Mr===-90&&Ht==="left"||Mr===90&&Ht==="right"?ne:.5),Ot){var hr=v(Mr)?+Mr:0;if(hr!==0){var Qt=e.deg2rad(hr);Kt=Math.abs(Math.sin(Qt))*ne*pt,at=0}}Ut.xFn=function(tr){return tr.dx+be-(Ee+tr.fontSize*at)*pt+Kt*tr.fontSize},Ut.yFn=function(tr){return tr.dy+Ze+tr.fontSize*$},Ut.anchorFn=function(tr,rr){return v(rr)&&Math.abs(rr)===90?"middle":St?"end":"start"},Ut.heightFn=function(tr,rr,fr){return pe.side==="right"&&(rr*=-1),rr<-30?-fr:rr<30?-.5*fr:0}}return Ut},U.drawTicks=function(pe,be,Fe){Fe=Fe||{};var Ve=be._id+"tick",Ke=[].concat(be.minor&&be.minor.ticks?Fe.vals.filter(function(ct){return ct.minor&&!ct.noTick}):[]).concat(be.ticks?Fe.vals.filter(function(ct){return!ct.minor&&!ct.noTick}):[]),Ge=Fe.layer.selectAll("path."+Ve).data(Ke,xt);Ge.exit().remove(),Ge.enter().append("path").classed(Ve,1).classed("ticks",1).classed("crisp",Fe.crisp!==!1).each(function(ct){return r.stroke(d.select(this),ct.minor?be.minor.tickcolor:be.tickcolor)}).style("stroke-width",function(ct){return g.crispRound(pe,ct.minor?be.minor.tickwidth:be.tickwidth,1)+"px"}).attr("d",Fe.path).style("display",null),qe(be,[V]),Ge.attr("transform",Fe.transFn)},U.drawGrid=function(pe,be,Fe){Fe=Fe||{};var Ve=be._id+"grid",Ke=be.minor&&be.minor.showgrid,Ge=Ke?Fe.vals.filter(function(at){return at.minor}):[],ct=be.showgrid?Fe.vals.filter(function(at){return!at.minor}):[],st=Fe.counterAxis;if(st&&U.shouldShowZeroLine(pe,be,st))for(var Mt=be.tickmode==="array",Ot=0;Ot<ct.length;Ot++){var it=ct[Ot].x;if(Mt?!it:Math.abs(it)<be.dtick/100){if(ct=ct.slice(0,Ot).concat(ct.slice(Ot+1)),!Mt)break;Ot--}}be._gw=g.crispRound(pe,be.gridwidth,1);for(var ht=Ke?g.crispRound(pe,be.minor.gridwidth,1):0,jt=Fe.layer,kt=Fe.minorLayer,Pt=1;Pt>=0;Pt--){var Ee=Pt?jt:kt;if(Ee){var Ze=Ee.selectAll("path."+Ve).data(Pt?ct:Ge,xt);Ze.exit().remove(),Ze.enter().append("path").classed(Ve,1).classed("crisp",Fe.crisp!==!1),Ze.attr("transform",Fe.transFn).attr("d",Fe.path).each(function(at){return r.stroke(d.select(this),at.minor?be.minor.gridcolor:be.gridcolor||"#ddd")}).style("stroke-dasharray",function(at){return g.dashStyle(at.minor?be.minor.griddash:be.griddash,at.minor?be.minor.gridwidth:be.gridwidth)}).style("stroke-width",function(at){return(at.minor?ht:be._gw)+"px"}).style("display",null),typeof Fe.path=="function"&&Ze.attr("d",Fe.path)}}qe(be,[D,j])},U.drawZeroLine=function(pe,be,Fe){Fe=Fe||Fe;var Ve=be._id+"zl",Ke=U.shouldShowZeroLine(pe,be,Fe.counterAxis),Ge=Fe.layer.selectAll("path."+Ve).data(Ke?[{x:0,id:be._id}]:[]);Ge.exit().remove(),Ge.enter().append("path").classed(Ve,1).classed("zl",1).classed("crisp",Fe.crisp!==!1).each(function(){Fe.layer.selectAll("path").sort(function(ct,st){return X(ct.id,st.id)})}),Ge.attr("transform",Fe.transFn).attr("d",Fe.path).call(r.stroke,be.zerolinecolor||r.defaultLine).style("stroke-width",g.crispRound(pe,be.zerolinewidth,be._gw||1)+"px").style("display",null),qe(be,[z])},U.drawLabels=function(pe,be,Fe){Fe=Fe||{};var Ve=pe._fullLayout,Ke=be._id,Ge=Ke.charAt(0),ct=Fe.cls||Ke+"tick",st=Fe.vals.filter(function(pt){return pt.text}),Mt=Fe.labelFns,Ot=Fe.secondary?0:be.tickangle,it=(be._prevTickAngles||{})[ct],ht=Fe.layer.selectAll("g."+ct).data(be.showticklabels?st:[],xt),jt=[];function kt(pt,St){pt.each(function(Ut){var Kt=d.select(this),Ht=Kt.select(".text-math-group"),pr=Mt.anchorFn(Ut,St),Mr=Fe.transFn.call(Kt.node(),Ut)+(v(St)&&+St!=0?" rotate("+St+","+Mt.xFn(Ut)+","+(Mt.yFn(Ut)-Ut.fontSize/2)+")":""),hr=n.lineCount(Kt),Qt=H*Ut.fontSize,tr=Mt.heightFn(Ut,v(St)?+St:0,(hr-1)*Qt);if(tr&&(Mr+=t(0,tr)),Ht.empty()){var rr=Kt.select("text");rr.attr({transform:Mr,"text-anchor":pr}),rr.style("opacity",1),be._adjustTickLabelsOverflow&&be._adjustTickLabelsOverflow()}else{var fr=g.bBox(Ht.node()).width*{end:-.5,start:.5}[pr];Ht.attr("transform",Mr+t(fr,0))}})}ht.enter().append("g").classed(ct,1).append("text").attr("text-anchor","middle").each(function(pt){var St=d.select(this),Ut=pe._promises.length;St.call(n.positionText,Mt.xFn(pt),Mt.yFn(pt)).call(g.font,pt.font,pt.fontSize,pt.fontColor).text(pt.text).call(n.convertToTspans,pe),pe._promises[Ut]?jt.push(pe._promises.pop().then(function(){kt(St,Ot)})):kt(St,Ot)}),qe(be,[Z]),ht.exit().remove(),Fe.repositionOnUpdate&&ht.each(function(pt){d.select(this).select("text").call(n.positionText,Mt.xFn(pt),Mt.yFn(pt))}),be._adjustTickLabelsOverflow=function(){var pt=be.ticklabeloverflow;if(pt&&pt!=="allow"){var St=pt.indexOf("hide")!==-1,Ut=be._id.charAt(0)==="x",Kt=0,Ht=Ut?pe._fullLayout.width:pe._fullLayout.height;if(pt.indexOf("domain")!==-1){var pr=e.simpleMap(be.range,be.r2l);Kt=be.l2p(pr[0])+be._offset,Ht=be.l2p(pr[1])+be._offset}var Mr=Math.min(Kt,Ht),hr=Math.max(Kt,Ht),Qt=be.side,tr=1/0,rr=-1/0;for(var fr in ht.each(function(Dr){var Nr=d.select(this);if(Nr.select(".text-math-group").empty()){var Wr=g.bBox(Nr.node()),hn=0;Ut?(Wr.right>hr||Wr.left<Mr)&&(hn=1):(Wr.bottom>hr||Wr.top+(be.tickangle?0:Dr.fontSize/4)<Mr)&&(hn=1);var tn=Nr.select("text");hn?St&&tn.style("opacity",0):(tn.style("opacity",1),tr=Qt==="bottom"||Qt==="right"?Math.min(tr,Ut?Wr.top:Wr.left):-1/0,rr=Qt==="top"||Qt==="left"?Math.max(rr,Ut?Wr.bottom:Wr.right):1/0)}}),Ve._plots){var yr=Ve._plots[fr];if(be._id===yr.xaxis._id||be._id===yr.yaxis._id){var Sr=Ut?yr.yaxis:yr.xaxis;Sr&&(Sr["_visibleLabelMin_"+be._id]=tr,Sr["_visibleLabelMax_"+be._id]=rr)}}}},be._hideCounterAxisInsideTickLabels=function(pt){var St=be._id.charAt(0)==="x",Ut=[];for(var Kt in Ve._plots){var Ht=Ve._plots[Kt];be._id!==Ht.xaxis._id&&be._id!==Ht.yaxis._id||Ut.push(St?Ht.yaxis:Ht.xaxis)}Ut.forEach(function(pr,Mr){pr&&Ne(pr)&&(pt||[z,j,D,V,Z]).forEach(function(hr){var Qt=hr.K==="tick"&&hr.L==="text"&&be.ticklabelmode==="period",tr=Ve._plots[be._mainSubplot];(hr.K===z.K?tr.zerolinelayer.selectAll("."+be._id+"zl"):hr.K===j.K?tr.minorGridlayer.selectAll("."+be._id):hr.K===D.K?tr.gridlayer.selectAll("."+be._id):tr[be._id.charAt(0)+"axislayer"]).each(function(){var rr=d.select(this);hr.L&&(rr=rr.selectAll(hr.L)),rr.each(function(fr){var yr=be.l2p(Qt?lt(fr):fr.x)+be._offset,Sr=d.select(this);yr<be["_visibleLabelMax_"+pr._id]&&yr>be["_visibleLabelMin_"+pr._id]?Sr.style("display","none"):hr.K!=="tick"||Mr||Sr.style("display",null)})})})})},kt(ht,it+1?it:Ot);var Pt=null;be._selections&&(be._selections[ct]=ht);var Ee=[function(){return jt.length&&Promise.all(jt)}];be.automargin&&Ve._redrawFromAutoMarginCount&&it===90?(Pt=90,Ee.push(function(){kt(ht,it)})):Ee.push(function(){if(kt(ht,Ot),st.length&&Ge==="x"&&!v(Ot)&&(be.type!=="log"||String(be.dtick).charAt(0)!=="D")){Pt=0;var pt,St=0,Ut=[];if(ht.each(function(Nr){St=Math.max(St,Nr.fontSize);var Wr=be.l2p(Nr.x),hn=nt(this),tn=g.bBox(hn.node());Ut.push({top:0,bottom:10,height:10,left:Wr-tn.width/2,right:Wr+tn.width/2+2,width:tn.width+2})}),be.tickson!=="boundaries"&&!be.showdividers||Fe.secondary){var Kt=st.length,Ht=Math.abs((st[Kt-1].x-st[0].x)*be._m)/(Kt-1),pr=be.ticklabelposition||"",Mr=function(Nr){return pr.indexOf(Nr)!==-1},hr=Mr("top"),Qt=Mr("left"),tr=Mr("right"),rr=Mr("bottom")||Qt||hr||tr?(be.tickwidth||0)+6:0,fr=Ht<2.5*St||be.type==="multicategory"||be._name==="realaxis";for(pt=0;pt<Ut.length-1;pt++)if(e.bBoxIntersect(Ut[pt],Ut[pt+1],rr)){Pt=fr?90:30;break}}else{var yr=2;for(be.ticks&&(yr+=be.tickwidth/2),pt=0;pt<Ut.length;pt++){var Sr=st[pt].xbnd,Dr=Ut[pt];if(Sr[0]!==null&&Dr.left-be.l2p(Sr[0])<yr||Sr[1]!==null&&be.l2p(Sr[1])-Dr.right<yr){Pt=90;break}}}Pt&&kt(ht,Pt)}}),be._tickAngles&&Ee.push(function(){be._tickAngles[ct]=Pt===null?v(Ot)?Ot:0:Pt});var Ze=be._anchorAxis;Ze&&Ze.autorange&&Ne(be)&&!J(Ve,be._id)&&(Ve._insideTickLabelsAutorange||(Ve._insideTickLabelsAutorange={}),Ve._insideTickLabelsAutorange[Ze._name+".autorange"]=Ze.autorange,Ee.push(function(){ht.each(function(pt,St){var Ut=nt(this);Ut.select(".text-math-group").empty()&&(be._vals[St].bb=g.bBox(Ut.node()))})}));var at=e.syncOrAsync(Ee);return at&&at.then&&pe._promises.push(at),at},U.getPxPosition=function(pe,be){var Fe,Ve=pe._fullLayout._size,Ke=be._id.charAt(0),Ge=be.side;return be.anchor!=="free"?Fe=be._anchorAxis:Ke==="x"?Fe={_offset:Ve.t+(1-(be.position||0))*Ve.h,_length:0}:Ke==="y"&&(Fe={_offset:Ve.l+(be.position||0)*Ve.w,_length:0}),Ge==="top"||Ge==="left"?Fe._offset:Ge==="bottom"||Ge==="right"?Fe._offset+Fe._length:void 0},U.shouldShowZeroLine=function(pe,be,Fe){var Ve=e.simpleMap(be.range,be.r2l);return Ve[0]*Ve[1]<=0&&be.zeroline&&(be.type==="linear"||be.type==="-")&&!(be.rangebreaks&&be.maskBreaks(0)===E)&&(bt(be,0)||!function(Ke,Ge,ct,st){var Mt=ct._mainAxis;if(!Mt)return;var Ot=Ke._fullLayout,it=Ge._id.charAt(0),ht=U.counterLetter(Ge._id),jt=Ge._offset+(Math.abs(st[0])<Math.abs(st[1])==(it==="x")?0:Ge._length);function kt(pt){if(!pt.showline||!pt.linewidth)return!1;var St=Math.max((pt.linewidth+Ge.zerolinewidth)/2,1);function Ut(pr){return typeof pr=="number"&&Math.abs(pr-jt)<St}if(Ut(pt._mainLinePosition)||Ut(pt._mainMirrorPosition))return!0;var Kt=pt._linepositions||{};for(var Ht in Kt)if(Ut(Kt[Ht][0])||Ut(Kt[Ht][1]))return!0}var Pt=Ot._plots[ct._mainSubplot];if(!(Pt.mainplotinfo||Pt).overlays.length)return kt(ct);for(var Ee=U.list(Ke,ht),Ze=0;Ze<Ee.length;Ze++){var at=Ee[Ze];if(at._mainAxis===Mt&&kt(at))return!0}}(pe,be,Fe,Ve)||function(Ke,Ge){for(var ct=Ke._fullData,st=Ge._mainSubplot,Mt=Ge._id.charAt(0),Ot=0;Ot<ct.length;Ot++){var it=ct[Ot];if(it.visible===!0&&it.xaxis+it.yaxis===st&&(y.traceIs(it,"bar-like")&&it.orientation==={x:"h",y:"v"}[Mt]||it.fill&&it.fill.charAt(it.fill.length-1)===Mt))return!0}return!1}(pe,be))},U.clipEnds=function(pe,be){return be.filter(function(Fe){return bt(pe,Fe.x)})},U.allowAutoMargin=function(pe){for(var be=U.list(pe,"",!0),Fe=0;Fe<be.length;Fe++){var Ve=be[Fe];Ve.automargin&&(w.allowAutoMargin(pe,$e(Ve)),Ve.mirror&&w.allowAutoMargin(pe,vt(Ve))),y.getComponentMethod("rangeslider","isVisible")(Ve)&&w.allowAutoMargin(pe,Nt(Ve))}},U.swap=function(pe,be){for(var Fe=function(Ke,Ge){var ct,st,Mt=[];for(ct=0;ct<Ge.length;ct++){var Ot=[],it=Ke._fullData[Ge[ct]].xaxis,ht=Ke._fullData[Ge[ct]].yaxis;if(it&&ht){for(st=0;st<Mt.length;st++)Mt[st].x.indexOf(it)===-1&&Mt[st].y.indexOf(ht)===-1||Ot.push(st);if(Ot.length){var jt,kt=Mt[Ot[0]];if(Ot.length>1)for(st=1;st<Ot.length;st++)jt=Mt[Ot[st]],qt(kt.x,jt.x),qt(kt.y,jt.y);qt(kt.x,[it]),qt(kt.y,[ht])}else Mt.push({x:[it],y:[ht]})}}return Mt}(pe,be),Ve=0;Ve<Fe.length;Ve++)Jt(pe,Fe[Ve].x,Fe[Ve].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM,y=v.isArrayOrTypedArray,e=v.isDateTime,t=v.cleanNumber,n=Math.round;function a(g,u){return u?d(g):typeof g=="number"}function r(g){return Math.max(1,(g-1)/1e3)}G.exports=function(g,u,s){var h=g,l=s.noMultiCategory;if(y(h)&&!h.length)return"-";if(!l&&function(x){return y(x[0])&&y(x[1])}(h))return"multicategory";if(l&&Array.isArray(h[0])){for(var o=[],p=0;p<h.length;p++)if(y(h[p]))for(var c=0;c<h[p].length;c++)o.push(h[p][c]);h=o}if(function(x,f){for(var _=x.length,b=r(_),T=0,k=0,L={},A=0;A<_;A+=b){var I=n(A),P=x[I],S=String(P);L[S]||(L[S]=1,e(P,f)&&T++,d(P)&&k++)}return T>2*k}(h,u))return"date";var i=s.autotypenumbers!=="strict";return function(x,f){for(var _=x.length,b=r(_),T=0,k=0,L={},A=0;A<_;A+=b){var I=n(A),P=x[I],S=String(P);if(!L[S]){L[S]=1;var E=typeof P;E==="boolean"?k++:(f?t(P)!==w:E==="number")?T++:E==="string"&&k++}}return k>2*T}(h,i)?"category":function(x,f){for(var _=x.length,b=0;b<_;b++)if(a(x[b],f))return!0;return!1}(h,i)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../lib"),y=m("../../plot_api/plot_template"),e=m("../array_container_defaults"),t=m("./layout_attributes"),n=m("./tick_value_defaults"),a=m("./tick_mark_defaults"),r=m("./tick_label_defaults"),g=m("./prefix_suffix_defaults"),u=m("./category_order_defaults"),s=m("./line_grid_defaults"),h=m("./set_convert"),l=m("./constants").WEEKDAY_PATTERN,o=m("./constants").HOUR_PATTERN;function p(x,f,_){function b(E,z){return w.coerce(x,f,t.rangebreaks,E,z)}if(b("enabled")){var T=b("bounds");if(T&&T.length>=2){var k,L,A="";if(T.length===2){for(k=0;k<2;k++)if(L=i(T[k])){A=l;break}}var I=b("pattern",A);if(I===l)for(k=0;k<2;k++)(L=i(T[k]))&&(f.bounds[k]=T[k]=L-1);if(I)for(k=0;k<2;k++)switch(L=T[k],I){case l:if(!d(L)||(L=+L)!==Math.floor(L)||L<0||L>=7)return void(f.enabled=!1);f.bounds[k]=T[k]=L;break;case o:if(!d(L)||(L=+L)<0||L>24)return void(f.enabled=!1);f.bounds[k]=T[k]=L}if(_.autorange===!1){var P=_.range;if(P[0]<P[1]){if(T[0]<P[0]&&T[1]>P[1])return void(f.enabled=!1)}else if(T[0]>P[0]&&T[1]<P[1])return void(f.enabled=!1)}}else{var S=b("values");if(!S||!S.length)return void(f.enabled=!1);b("dvalue")}}}G.exports=function(x,f,_,b,T){var k,L=b.letter,A=b.font||{},I=b.splomStash||{},P=_("visible",!b.visibleDflt),S=f._template||{},E=f.type||S.type||"-";E==="date"&&(v.getComponentMethod("calendars","handleDefaults")(x,f,"calendar",b.calendar),b.noTicklabelmode||(k=_("ticklabelmode")));var z="";b.noTicklabelposition&&E!=="multicategory"||(z=w.coerce(x,f,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:k==="period"?["outside","inside"]:L==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),b.noTicklabeloverflow||_("ticklabeloverflow",z.indexOf("inside")!==-1?"hide past domain":E==="category"||E==="multicategory"?"allow":"hide past div"),h(f,T);var D=!f.isValidRange(x.range);D&&b.reverseDflt&&(D="reversed"),!_("autorange",D)||E!=="linear"&&E!=="-"||_("rangemode"),_("range"),f.cleanRange(),u(x,f,_,b),E==="category"||b.noHover||_("hoverformat");var j=_("color"),V=j!==t.color.dflt?j:A.color,Z=I.label||T._dfltTitle[L];if(g(x,f,_,E,b),!P)return f;_("title.text",Z),w.coerceFont(_,"title.font",{family:A.family,size:w.bigFont(A.size),color:V}),n(x,f,_,E);var Q=b.hasMinor;if(Q&&(y.newContainer(f,"minor"),n(x,f,_,E,{isMinor:!0})),r(x,f,_,E,b),a(x,f,_,b),Q){var K=b.isMinor;b.isMinor=!0,a(x,f,_,b),b.isMinor=K}s(x,f,_,{dfltColor:j,bgColor:b.bgColor,showGrid:b.showGrid,hasMinor:Q,attributes:t}),!Q||f.minor.ticks||f.minor.showgrid||delete f.minor,(f.showline||f.ticks)&&_("mirror"),b.automargin&&_("automargin");var $,ne=E==="multicategory";if(b.noTickson||E!=="category"&&!ne||!f.ticks&&!f.showgrid||(ne&&($="boundaries"),_("tickson",$)==="boundaries"&&delete f.ticklabelposition),ne&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),E==="date")if(e(x,f,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:p}),f.rangebreaks.length){for(var H=0;H<f.rangebreaks.length;H++)if(f.rangebreaks[H].pattern===l){f._hasDayOfWeekBreaks=!0;break}if(h(f,T),T._has("scattergl")||T._has("splom"))for(var N=0;N<b.data.length;N++){var U=b.data[N];U.type!=="scattergl"&&U.type!=="splom"||(U.visible=!1,w.warn(U.type+" traces do not work on axes with rangebreaks. Setting trace "+U.index+" to `visible: false`."))}}else delete f.rangebreaks;return f};var c={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function i(x){if(typeof x=="string")return c[x.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(m,G,W){var d=m("../../constants/docs"),v=d.FORMAT_LINK,w=d.DATE_FORMAT_LINK;function y(t,n){return["Sets the "+t+" formatting rule"+(n?"for `"+n+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+v+"."].join(" ")}function e(t,n){return y(t,n)+[" And for dates see: "+w+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}G.exports={axisHoverFormat:function(t,n){return{valType:"string",dflt:"",editType:"none",description:(n?y:e)("hover text",t)+["By default the values are formatted using "+(n?"generic number format":"`"+t+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:y,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(m,G,W){var d=m("../../registry"),v=m("./constants");function w(y,e){if(e&&e.length){for(var t=0;t<e.length;t++)if(e[t][y])return!0}return!1}W.id2name=function(y){if(typeof y=="string"&&y.match(v.AX_ID_PATTERN)){var e=y.split(" ")[0].substr(1);return e==="1"&&(e=""),y.charAt(0)+"axis"+e}},W.name2id=function(y){if(y.match(v.AX_NAME_PATTERN)){var e=y.substr(5);return e==="1"&&(e=""),y.charAt(0)+e}},W.cleanId=function(y,e,t){var n=/( domain)$/.test(y);if(typeof y=="string"&&y.match(v.AX_ID_PATTERN)&&(!e||y.charAt(0)===e)&&(!n||t)){var a=y.split(" ")[0].substr(1).replace(/^0+/,"");return a==="1"&&(a=""),y.charAt(0)+a+(n&&t?" domain":"")}},W.list=function(y,e,t){var n=y._fullLayout;if(!n)return[];var a,r=W.listIds(y,e),g=new Array(r.length);for(a=0;a<r.length;a++){var u=r[a];g[a]=n[u.charAt(0)+"axis"+u.substr(1)]}if(!t){var s=n._subplots.gl3d||[];for(a=0;a<s.length;a++){var h=n[s[a]];e?g.push(h[e+"axis"]):g.push(h.xaxis,h.yaxis,h.zaxis)}}return g},W.listIds=function(y,e){var t=y._fullLayout;if(!t)return[];var n=t._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},W.getFromId=function(y,e,t){var n=y._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),t==="x"?e=e.replace(/y[0-9]*/,""):t==="y"&&(e=e.replace(/x[0-9]*/,"")),n[W.id2name(e)]},W.getFromTrace=function(y,e,t){var n=y._fullLayout,a=null;if(d.traceIs(e,"gl3d")){var r=e.scene;r.substr(0,5)==="scene"&&(a=n[r][t+"axis"])}else a=W.getFromId(y,e[t+"axis"]||t);return a},W.idSort=function(y,e){var t=y.charAt(0),n=e.charAt(0);return t!==n?t>n?1:-1:+(y.substr(1)||1)-+(e.substr(1)||1)},W.ref2id=function(y){return!!/^[xyz]/.test(y)&&y.split(" ")[0]},W.isLinked=function(y,e){return w(e,y._axisMatchGroups)||w(e,y._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(m,G,W){G.exports=function(d,v,w,y){if(v.type==="category"){var e,t=d.categoryarray,n=Array.isArray(t)&&t.length>0;n&&(e="array");var a,r=w("categoryorder",e);r==="array"&&(a=w("categoryarray")),n||r!=="array"||(r=v.categoryorder="trace"),r==="trace"?v._initialCategories=[]:r==="array"?v._initialCategories=a.slice():(a=function(g,u){var s,h,l,o=u.dataAttr||g._id.charAt(0),p={};if(u.axData)s=u.axData;else for(s=[],h=0;h<u.data.length;h++){var c=u.data[h];c[o+"axis"]===g._id&&s.push(c)}for(h=0;h<s.length;h++){var i=s[h][o];for(l=0;l<i.length;l++){var x=i[l];x!=null&&(p[x]=1)}}return Object.keys(p)}(v,y).sort(),r==="category ascending"?v._initialCategories=a:r==="category descending"&&(v._initialCategories=a.reverse()))}}},{}],572:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical"),y=w.ONEDAY,e=w.ONEWEEK;W.dtick=function(t,n){var a=n==="log",r=n==="date",g=n==="category",u=r?y:1;if(!t)return u;if(d(t))return(t=Number(t))<=0?u:g?Math.max(1,Math.round(t)):r?Math.max(.1,t):t;if(typeof t!="string"||!r&&!a)return u;var s=t.charAt(0),h=t.substr(1);return(h=d(h)?Number(h):0)<=0||!(r&&s==="M"&&h===Math.round(h)||a&&s==="L"||a&&s==="D"&&(h===1||h===2))?u:t},W.tick0=function(t,n,a,r){return n==="date"?v.cleanDate(t,v.dateTick0(a,r%e==0?1:0)):r!=="D1"&&r!=="D2"?d(t)?Number(t):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(m,G,W){var d=m("../../lib/regex").counter;G.exports={idRegex:{x:d("x","( domain)?"),y:d("y","( domain)?")},attrRegex:d("[xy]axis"),xAxisMatch:d("xaxis"),yAxisMatch:d("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(m,G,W){var d=m("../../lib"),v=m("./autorange"),w=m("./axis_ids").id2name,y=m("./layout_attributes"),e=m("./scale_zoom"),t=m("./set_convert"),n=m("../../constants/numerical").ALMOST_EQUAL,a=m("../../constants/alignment").FROM_BL;function r(p,c,i){var x=i.axIds,f=i.layoutOut,_=i.hasImage,b=f._axisConstraintGroups,T=f._axisMatchGroups,k=c._id,L=k.charAt(0),A=((f._splomAxes||{})[L]||{})[k]||{},I=c._id,P=I.charAt(0)==="x";function S(te,B){return d.coerce(p,c,y,te,B)}c._matchGroup=null,c._constraintGroup=null,S("constrain",_?"domain":"range"),d.coerce(p,c,{constraintoward:{valType:"enumerated",values:P?["left","center","right"]:["bottom","middle","top"],dflt:P?"center":"middle"}},"constraintoward");var E,z,D=c.type,j=[];for(E=0;E<x.length;E++)(z=x[E])!==I&&f[w(z)].type===D&&j.push(z);var V=u(b,I);if(V){var Z=[];for(E=0;E<j.length;E++)V[z=j[E]]||Z.push(z);j=Z}var Q,K,$=j.length;$&&(p.matches||A.matches)&&(Q=d.coerce(p,c,{matches:{valType:"enumerated",values:j,dflt:j.indexOf(A.matches)!==-1?A.matches:void 0}},"matches"));var ne=_&&!P?c.anchor:void 0;if($&&!Q&&(p.scaleanchor||ne)&&(K=d.coerce(p,c,{scaleanchor:{valType:"enumerated",values:j}},"scaleanchor",ne)),Q){c._matchGroup=s(T,I,Q,1);var H=f[w(Q)],N=g(f,c)/g(f,H);P!==(Q.charAt(0)==="x")&&(N=(P?"x":"y")+N),s(b,I,Q,N)}else p.matches&&x.indexOf(p.matches)!==-1&&d.warn("ignored "+c._name+'.matches: "'+p.matches+'" to avoid an infinite loop');if(K){var U=S("scaleratio");U||(U=c.scaleratio=1),s(b,I,K,U)}else p.scaleanchor&&x.indexOf(p.scaleanchor)!==-1&&d.warn("ignored "+c._name+'.scaleanchor: "'+p.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function g(p,c){var i=c.domain;return i||(i=p[w(c.overlaying)].domain),i[1]-i[0]}function u(p,c){for(var i=0;i<p.length;i++)if(p[i][c])return p[i];return null}function s(p,c,i,x){var f,_,b,T,k,L=u(p,c);L===null?((L={})[c]=1,k=p.length,p.push(L)):k=p.indexOf(L);var A=Object.keys(L);for(f=0;f<p.length;f++)if(b=p[f],f!==k&&b[i]){var I=b[i];for(_=0;_<A.length;_++)b[T=A[_]]=h(I,h(x,L[T]));return void p.splice(k,1)}if(x!==1)for(_=0;_<A.length;_++){var P=A[_];L[P]=h(x,L[P])}L[i]=1}function h(p,c){var i,x,f="",_="";typeof p=="string"&&(i=(f=p.match(/^[xy]*/)[0]).length,p=+p.substr(i)),typeof c=="string"&&(x=(_=c.match(/^[xy]*/)[0]).length,c=+c.substr(x));var b=p*c;return i||x?i&&x&&f.charAt(0)!==_.charAt(0)?i===x?b:(i>x?f.substr(x):_.substr(i))+b:f+_+p*c:b}function l(p,c){for(var i=c._size,x=i.h/i.w,f={},_=Object.keys(p),b=0;b<_.length;b++){var T=_[b],k=p[T];if(typeof k=="string"){var L=k.match(/^[xy]*/)[0],A=L.length;k=+k.substr(A);for(var I=L.charAt(0)==="y"?x:1/x,P=0;P<A;P++)k*=I}f[T]=k}return f}function o(p,c){var i=p._inputDomain,x=a[p.constraintoward],f=i[0]+(i[1]-i[0])*x;p.domain=p._input.domain=[f+(i[0]-f)/c,f+(i[1]-f)/c],p.setScale()}W.handleDefaults=function(p,c,i){var x,f,_,b,T,k,L,A,I=i.axIds,P=i.axHasImage,S=c._axisConstraintGroups=[],E=c._axisMatchGroups=[];for(x=0;x<I.length;x++)r(T=p[b=w(I[x])],k=c[b],{axIds:I,layoutOut:c,hasImage:P[b]});function z(H,N){for(x=0;x<H.length;x++)for(_ in f=H[x])c[w(_)][N]=f}for(z(E,"_matchGroup"),x=0;x<S.length;x++)for(_ in f=S[x])if((k=c[w(_)]).fixedrange){for(var D in f){var j=w(D);(p[j]||{}).fixedrange===!1&&d.warn("fixedrange was specified as false for axis "+j+" but was overridden because another axis in its constraint group has fixedrange true"),c[j].fixedrange=!0}break}for(x=0;x<S.length;){for(_ in f=S[x]){(k=c[w(_)])._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(f).length&&(S.splice(x,1),x--);break}x++}z(S,"_constraintGroup");var V=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Z=!1,Q=!1;function K(){A=k[L],L==="rangebreaks"&&(Q=k._hasDayOfWeekBreaks)}for(x=0;x<E.length;x++){f=E[x];for(var $=0;$<V.length;$++){var ne;for(_ in L=V[$],A=null,f)if(T=p[b=w(_)],k=c[b],L in k){if(!k.matches&&(ne=k,L in T)){K();break}A===null&&L in T&&K()}if(L==="range"&&A&&(Z=!0),L==="autorange"&&A===null&&Z&&(A=!1),A===null&&L in ne&&(A=ne[L]),A!==null)for(_ in f)(k=c[w(_)])[L]=L==="range"?A.slice():A,L==="rangebreaks"&&(k._hasDayOfWeekBreaks=Q,t(k,c))}}},W.enforce=function(p){var c,i,x,f,_,b,T,k,L=p._fullLayout,A=L._axisConstraintGroups||[];for(c=0;c<A.length;c++){x=l(A[c],L);var I=Object.keys(x),P=1/0,S=0,E=1/0,z={},D={},j=!1;for(i=0;i<I.length;i++)D[f=I[i]]=_=L[w(f)],_._inputDomain?_.domain=_._inputDomain.slice():_._inputDomain=_.domain.slice(),_._inputRange||(_._inputRange=_.range.slice()),_.setScale(),z[f]=b=Math.abs(_._m)/x[f],P=Math.min(P,b),_.constrain!=="domain"&&_._constraintShrinkable||(E=Math.min(E,b)),delete _._constraintShrinkable,S=Math.max(S,b),_.constrain==="domain"&&(j=!0);if(!(P>n*S)||j){for(i=0;i<I.length;i++)if(b=z[f=I[i]],T=(_=D[f]).constrain,b!==E||T==="domain")if(k=b/E,T==="range")e(_,k);else{var V=_._inputDomain,Z=(_.domain[1]-_.domain[0])/(V[1]-V[0]),Q=(_.r2l(_.range[1])-_.r2l(_.range[0]))/(_.r2l(_._inputRange[1])-_.r2l(_._inputRange[0]));if((k/=Z)*Q<1){_.domain=_._input.domain=V.slice(),e(_,k);continue}if(Q<1&&(_.range=_._input.range=_._inputRange.slice(),k*=Q),_.autorange){var K=_.r2l(_.range[0]),$=_.r2l(_.range[1]),ne=(K+$)/2,H=ne,N=ne,U=Math.abs($-ne),te=ne-U*k*1.0001,B=ne+U*k*1.0001,X=v.makePadFn(L,_,0),J=v.makePadFn(L,_,1);o(_,k);var ee,re,se=Math.abs(_._m),oe=v.concatExtremes(p,_),de=oe.min,ce=oe.max;for(re=0;re<de.length;re++)(ee=de[re].val-X(de[re])/se)>te&&ee<H&&(H=ee);for(re=0;re<ce.length;re++)(ee=ce[re].val+J(ce[re])/se)<B&&ee>N&&(N=ee);k/=(N-H)/(2*U),H=_.l2r(H),N=_.l2r(N),_.range=_._input.range=K<$?[H,N]:[N,H]}o(_,k)}}}},W.getAxisGroup=function(p,c){for(var i=p._axisMatchGroups,x=0;x<i.length;x++)if(i[x][c])return"g"+x;return c},W.clean=function(p,c){if(c._inputDomain){for(var i=!1,x=c._id,f=p._fullLayout._axisConstraintGroups,_=0;_<f.length;_++)if(f[_][x]){i=!0;break}i&&c.constrain==="domain"||(c._input.domain=c.domain=c._inputDomain,delete c._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("tinycolor2"),e=m("has-passive-events"),t=m("../../registry"),n=v.strTranslate,a=m("../../lib/svg_text_utils"),r=m("../../components/color"),g=m("../../components/drawing"),u=m("../../components/fx"),s=m("./axes"),h=m("../../lib/setcursor"),l=m("../../components/dragelement"),o=m("../../components/dragelement/helpers"),p=o.selectingOrDrawing,c=o.freeMode,i=m("../../constants/alignment").FROM_TL,x=m("../../lib/clear_gl_canvases"),f=m("../../plot_api/subroutines").redrawReglTraces,_=m("../plots"),b=m("./axis_ids").getFromId,T=m("../../components/selections").prepSelect,k=m("../../components/selections").clearOutline,L=m("../../components/selections").selectOnClick,A=m("./scale_zoom"),I=m("./constants"),P=I.MINDRAG,S=I.MINZOOM,E=!0;function z(ee,re,se,oe){var de=v.ensureSingle(ee.draglayer,re,se,function(ce){ce.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ee.id)});return de.call(h,oe),de.node()}function D(ee,re,se,oe,de,ce,ve){var Ae=z(ee,"rect",re,se);return d.select(Ae).call(g.setRect,oe,de,ce,ve),Ae}function j(ee,re){for(var se=0;se<ee.length;se++)if(!ee[se].fixedrange)return re;return""}function V(ee,re,se,oe,de){for(var ce=0;ce<ee.length;ce++){var ve=ee[ce];if(!ve.fixedrange)if(ve.rangebreaks){var Ae=ve._id.charAt(0)==="y",fe=Ae?1-re:re,me=Ae?1-se:se;oe[ve._name+".range[0]"]=ve.l2r(ve.p2l(fe*ve._length)),oe[ve._name+".range[1]"]=ve.l2r(ve.p2l(me*ve._length))}else{var _e=ve._rl[0],le=ve._rl[1]-_e;oe[ve._name+".range[0]"]=ve.l2r(_e+le*re),oe[ve._name+".range[1]"]=ve.l2r(_e+le*se)}}if(de&&de.length){var ge=(re+(1-se))/2;V(de,ge,1-ge,oe,[])}}function Z(ee,re){for(var se=0;se<ee.length;se++){var oe=ee[se];if(!oe.fixedrange)if(oe.rangebreaks){var de=oe._length,ce=(oe.p2l(0+re)-oe.p2l(0)+(oe.p2l(de+re)-oe.p2l(de)))/2;oe.range=[oe.l2r(oe._rl[0]-ce),oe.l2r(oe._rl[1]-ce)]}else oe.range=[oe.l2r(oe._rl[0]-re/oe._m),oe.l2r(oe._rl[1]-re/oe._m)]}}function Q(ee){return 1-(ee>=0?Math.min(ee,.9):1/(1/Math.max(ee,-.3)+3.222))}function K(ee,re,se,oe,de){return ee.append("path").attr("class","zoombox").style({fill:re>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(se,oe)).attr("d",de+"Z")}function $(ee,re,se){return ee.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(re,se)).attr("d","M0,0Z")}function ne(ee,re,se,oe,de,ce){ee.attr("d",oe+"M"+se.l+","+se.t+"v"+se.h+"h"+se.w+"v-"+se.h+"h-"+se.w+"Z"),H(ee,re,de,ce)}function H(ee,re,se,oe){se||(ee.transition().style("fill",oe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),re.transition().style("opacity",1).duration(200))}function N(ee){d.select(ee).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function U(ee){E&&ee.data&&ee._context.showTips&&(v.notifier(v._(ee,"Double-click to zoom back out"),"long"),E=!1)}function te(ee){var re=Math.floor(Math.min(ee.b-ee.t,ee.r-ee.l,S)/2);return"M"+(ee.l-3.5)+","+(ee.t-.5+re)+"h3v"+-re+"h"+re+"v-3h-"+(re+3)+"ZM"+(ee.r+3.5)+","+(ee.t-.5+re)+"h-3v"+-re+"h"+-re+"v-3h"+(re+3)+"ZM"+(ee.r+3.5)+","+(ee.b+.5-re)+"h-3v"+re+"h"+-re+"v3h"+(re+3)+"ZM"+(ee.l-3.5)+","+(ee.b+.5-re)+"h3v"+re+"h"+re+"v3h-"+(re+3)+"Z"}function B(ee,re,se,oe,de){for(var ce,ve,Ae,fe,me=!1,_e={},le={},ge=(de||{}).xaHash,Te=(de||{}).yaHash,Se=0;Se<re.length;Se++){var Me=re[Se];for(ce in se)if(Me[ce]){for(Ae in Me)de&&(ge[Ae]||Te[Ae])||(Ae.charAt(0)==="x"?se:oe)[Ae]||(_e[Ae]=ce);for(ve in oe)de&&(ge[ve]||Te[ve])||!Me[ve]||(me=!0)}for(ve in oe)if(Me[ve])for(fe in Me)de&&(ge[fe]||Te[fe])||(fe.charAt(0)==="x"?se:oe)[fe]||(le[fe]=ve)}me&&(v.extendFlat(_e,le),le={});var ze={},Oe=[];for(Ae in _e){var De=b(ee,Ae);Oe.push(De),ze[De._id]=De}var Xe={},Be=[];for(fe in le){var Ie=b(ee,fe);Be.push(Ie),Xe[Ie._id]=Ie}return{xaHash:ze,yaHash:Xe,xaxes:Oe,yaxes:Be,xLinks:_e,yLinks:le,isSubplotConstrained:me}}function X(ee,re){if(e){var se=ee.onwheel!==void 0?"wheel":"mousewheel";ee._onwheel&&ee.removeEventListener(se,ee._onwheel),ee._onwheel=re,ee.addEventListener(se,re,{passive:!1})}else ee.onwheel!==void 0?ee.onwheel=re:ee.onmousewheel!==void 0?ee.onmousewheel=re:ee.isAddedWheelEvent||(ee.isAddedWheelEvent=!0,ee.addEventListener("wheel",re,{passive:!1}))}function J(ee){var re=[];for(var se in ee)re.push(ee[se]);return re}G.exports={makeDragBox:function(ee,re,se,oe,de,ce,ve,Ae){var fe,me,_e,le,ge,Te,Se,Me,ze,Oe,De,Xe,Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e,vt=ee._fullLayout._zoomlayer,Nt=ve+Ae==="nsew",qt=(ve+Ae).length===1;function Jt(){if(fe=re.xaxis,me=re.yaxis,ze=fe._length,Oe=me._length,Se=fe._offset,Me=me._offset,(_e={})[fe._id]=fe,(le={})[me._id]=me,ve&&Ae)for(var Qt=re.overlays,tr=0;tr<Qt.length;tr++){var rr=Qt[tr].xaxis;_e[rr._id]=rr;var fr=Qt[tr].yaxis;le[fr._id]=fr}ge=J(_e),Te=J(le),Be=j(ge,Ae),Ie=j(Te,ve),Re=!Ie&&!Be,Xe=B(ee,ee._fullLayout._axisMatchGroups,_e,le);var yr=(De=B(ee,ee._fullLayout._axisConstraintGroups,_e,le,Xe)).isSubplotConstrained||Xe.isSubplotConstrained;Ye=Ae||yr,Qe=ve||yr;var Sr=ee._fullLayout;lt=Sr._has("scattergl"),xt=Sr._has("splom"),wt=Sr._has("svg")}Jt();var Wt=function(Qt,tr,rr){return Qt?Qt==="nsew"?rr?"":tr==="pan"?"move":"crosshair":Qt.toLowerCase()+"-resize":"pointer"}(Ie+Be,ee._fullLayout.dragmode,Nt),ar=D(re,ve+Ae+"drag",Wt,se,oe,de,ce);if(Re&&!Nt)return ar.onmousedown=null,ar.style.pointerEvents="none",ar;var Dt,Ne,qe,pe,be,Fe,Ve,Ke,Ge,ct,st={element:ar,gd:ee,plotinfo:re};function Mt(){st.plotinfo.selection=!1,k(ee)}function Ot(Qt,tr){var rr=st.gd;if(rr._fullLayout._activeShapeIndex>=0)rr._fullLayout._deactivateShape(rr);else{var fr=rr._fullLayout.clickmode;if(N(rr),Qt!==2||qt||Ut(),Nt)fr.indexOf("select")>-1&&L(tr,rr,ge,Te,re.id,st),fr.indexOf("event")>-1&&u.click(rr,tr,re.id);else if(Qt===1&&qt){var yr=ve?me:fe,Sr=ve==="s"||Ae==="w"?0:1,Dr=yr._name+".range["+Sr+"]",Nr=function(tn,Fn){var an,xn=tn.range[Fn],_n=Math.abs(xn-tn.range[1-Fn]);return tn.type==="date"?xn:tn.type==="log"?(an=Math.ceil(Math.max(0,-Math.log(_n)/Math.LN10))+3,w("."+an+"g")(Math.pow(10,xn))):(an=Math.floor(Math.log(Math.abs(xn))/Math.LN10)-Math.floor(Math.log(_n)/Math.LN10)+4,w("."+String(an)+"g")(xn))}(yr,Sr),Wr="left",hn="middle";if(yr.fixedrange)return;ve?(hn=ve==="n"?"top":"bottom",yr.side==="right"&&(Wr="right")):Ae==="e"&&(Wr="right"),rr._context.showAxisRangeEntryBoxes&&d.select(ar).call(a.makeEditable,{gd:rr,immediate:!0,background:rr._fullLayout.paper_bgcolor,text:String(Nr),fill:yr.tickfont?yr.tickfont.color:"#444",horizontalAlign:Wr,verticalAlign:hn}).on("edit",function(tn){var Fn=yr.d2r(tn);Fn!==void 0&&t.call("_guiRelayout",rr,Dr,Fn)})}}}function it(Qt,tr){if(ee._transitioningWithDuration)return!1;var rr=Math.max(0,Math.min(ze,nt*Qt+Dt)),fr=Math.max(0,Math.min(Oe,$e*tr+Ne)),yr=Math.abs(rr-Dt),Sr=Math.abs(fr-Ne);function Dr(){Ve="",qe.r=qe.l,qe.t=qe.b,Ge.attr("d","M0,0Z")}if(qe.l=Math.min(Dt,rr),qe.r=Math.max(Dt,rr),qe.t=Math.min(Ne,fr),qe.b=Math.max(Ne,fr),De.isSubplotConstrained)yr>S||Sr>S?(Ve="xy",yr/ze>Sr/Oe?(Sr=yr*Oe/ze,Ne>fr?qe.t=Ne-Sr:qe.b=Ne+Sr):(yr=Sr*ze/Oe,Dt>rr?qe.l=Dt-yr:qe.r=Dt+yr),Ge.attr("d",te(qe))):Dr();else if(Xe.isSubplotConstrained)if(yr>S||Sr>S){Ve="xy";var Nr=Math.min(qe.l/ze,(Oe-qe.b)/Oe),Wr=Math.max(qe.r/ze,(Oe-qe.t)/Oe);qe.l=Nr*ze,qe.r=Wr*ze,qe.b=(1-Nr)*Oe,qe.t=(1-Wr)*Oe,Ge.attr("d",te(qe))}else Dr();else!Ie||Sr<Math.min(Math.max(.6*yr,P),S)?yr<P||!Be?Dr():(qe.t=0,qe.b=Oe,Ve="x",Ge.attr("d",function(hn,tn){return"M"+(hn.l-.5)+","+(tn-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(hn.r+.5)+","+(tn-S-.5)+"h3v"+(2*S+1)+"h-3Z"}(qe,Ne))):!Be||yr<Math.min(.6*Sr,S)?(qe.l=0,qe.r=ze,Ve="y",Ge.attr("d",function(hn,tn){return"M"+(tn-S-.5)+","+(hn.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(tn-S-.5)+","+(hn.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(qe,Dt))):(Ve="xy",Ge.attr("d",te(qe)));qe.w=qe.r-qe.l,qe.h=qe.b-qe.t,Ve&&(ct=!0),ee._dragged=ct,ne(Ke,Ge,qe,be,Fe,pe),ht(),ee.emit("plotly_relayouting",bt),Fe=!0}function ht(){bt={},Ve!=="xy"&&Ve!=="x"||(V(ge,qe.l/ze,qe.r/ze,bt,De.xaxes),pt("x",bt)),Ve!=="xy"&&Ve!=="y"||(V(Te,(Oe-qe.b)/Oe,(Oe-qe.t)/Oe,bt,De.yaxes),pt("y",bt))}function jt(){ht(),N(ee),Kt(),U(ee)}st.prepFn=function(Qt,tr,rr){var fr=st.dragmode,yr=ee._fullLayout.dragmode;yr!==fr&&(st.dragmode=yr),Jt(),nt=ee._fullLayout._invScaleX,$e=ee._fullLayout._invScaleY,Re||(Nt?Qt.shiftKey?yr==="pan"?yr="zoom":p(yr)||(yr="pan"):Qt.ctrlKey&&(yr="pan"):yr="pan"),c(yr)?st.minDrag=1:st.minDrag=void 0,p(yr)?(st.xaxes=ge,st.yaxes=Te,T(Qt,tr,rr,st,yr)):(st.clickFn=Ot,p(fr)&&Mt(),Re||(yr==="zoom"?(st.moveFn=it,st.doneFn=jt,st.minDrag=1,function(Sr,Dr,Nr){var Wr=ar.getBoundingClientRect();Dt=Dr-Wr.left,Ne=Nr-Wr.top,ee._fullLayout._calcInverseTransform(ee);var hn=v.apply3DTransform(ee._fullLayout._invTransform)(Dt,Ne);Dt=hn[0],Ne=hn[1],qe={l:Dt,r:Dt,w:0,t:Ne,b:Ne,h:0},pe=ee._hmpixcount?ee._hmlumcount/ee._hmpixcount:y(ee._fullLayout.plot_bgcolor).getLuminance(),Fe=!1,Ve="xy",ct=!1,Ke=K(vt,pe,Se,Me,be="M0,0H"+ze+"V"+Oe+"H0V0"),Ge=$(vt,Se,Me)}(0,tr,rr)):yr==="pan"&&(st.moveFn=at,st.doneFn=Kt))),ee._fullLayout._redrag=function(){var Sr=ee._dragdata;if(Sr&&Sr.element===ar){var Dr=ee._fullLayout.dragmode;p(Dr)||(Jt(),Ht([0,0,ze,Oe]),st.moveFn(Sr.dx,Sr.dy))}}},l.init(st);var kt=[0,0,ze,Oe],Pt=null,Ee=I.REDRAWDELAY,Ze=re.mainplot?ee._fullLayout._plots[re.mainplot]:re;function at(Qt,tr){if(Qt*=nt,tr*=$e,!ee._transitioningWithDuration){if(ee._fullLayout._replotting=!0,Be==="ew"||Ie==="ns"){var rr=Be?-Qt:0,fr=Ie?-tr:0;if(Xe.isSubplotConstrained){if(Be&&Ie){var yr=(Qt/ze-tr/Oe)/2;rr=-(Qt=yr*ze),fr=-(tr=-yr*Oe)}Ie?rr=-fr*ze/Oe:fr=-rr*Oe/ze}return Be&&(Z(ge,Qt),pt("x")),Ie&&(Z(Te,tr),pt("y")),Ht([rr,fr,ze,Oe]),St(),void ee.emit("plotly_relayouting",bt)}var Sr,Dr,Nr=Be==="w"==(Ie==="n")?1:-1;if(Be&&Ie&&(De.isSubplotConstrained||Xe.isSubplotConstrained)){var Wr=(Qt/ze+Nr*tr/Oe)/2;Qt=Wr*ze,tr=Nr*Wr*Oe}if(Be==="w"?Qt=an(ge,0,Qt):Be==="e"?Qt=an(ge,1,-Qt):Be||(Qt=0),Ie==="n"?tr=an(Te,1,tr):Ie==="s"?tr=an(Te,0,-tr):Ie||(tr=0),Sr=Be==="w"?Qt:0,Dr=Ie==="n"?tr:0,De.isSubplotConstrained&&!Xe.isSubplotConstrained||Xe.isSubplotConstrained&&Be&&Ie&&Nr>0){var hn;if(Xe.isSubplotConstrained||!Be&&Ie.length===1){for(hn=0;hn<ge.length;hn++)ge[hn].range=ge[hn]._r.slice(),A(ge[hn],1-tr/Oe);Sr=(Qt=tr*ze/Oe)/2}if(Xe.isSubplotConstrained||!Ie&&Be.length===1){for(hn=0;hn<Te.length;hn++)Te[hn].range=Te[hn]._r.slice(),A(Te[hn],1-Qt/ze);Dr=(tr=Qt*Oe/ze)/2}}Xe.isSubplotConstrained&&Ie||pt("x"),Xe.isSubplotConstrained&&Be||pt("y");var tn=ze-Qt,Fn=Oe-tr;!Xe.isSubplotConstrained||Be&&Ie||(Be?(Dr=Sr?0:Qt*Oe/ze,Fn=tn*Oe/ze):(Sr=Dr?0:tr*ze/Oe,tn=Fn*ze/Oe)),Ht([Sr,Dr,tn,Fn]),St(),ee.emit("plotly_relayouting",bt)}function an(xn,_n,ti){for(var jr,nn,vn=1-_n,en=0;en<xn.length;en++){var fn=xn[en];if(!fn.fixedrange){jr=fn,nn=fn._rl[vn]+(fn._rl[_n]-fn._rl[vn])/Q(ti/fn._length);var Gn=fn.l2r(nn);Gn!==!1&&Gn!==void 0&&(fn.range[_n]=Gn)}}return jr._length*(jr._rl[_n]-nn)/(jr._rl[_n]-jr._rl[vn])}}function pt(Qt,tr){for(var rr=Xe.isSubplotConstrained?{x:Te,y:ge}[Qt]:Xe[Qt+"axes"],fr=Xe.isSubplotConstrained?{x:ge,y:Te}[Qt]:[],yr=0;yr<rr.length;yr++){var Sr=rr[yr],Dr=Sr._id,Nr=Xe.xLinks[Dr]||Xe.yLinks[Dr],Wr=fr[0]||_e[Nr]||le[Nr];Wr&&(tr?(tr[Sr._name+".range[0]"]=tr[Wr._name+".range[0]"],tr[Sr._name+".range[1]"]=tr[Wr._name+".range[1]"]):Sr.range=Wr.range.slice())}}function St(){var Qt,tr=[];function rr(Sr){for(Qt=0;Qt<Sr.length;Qt++)Sr[Qt].fixedrange||tr.push(Sr[Qt]._id)}for(Ye&&(rr(ge),rr(De.xaxes),rr(Xe.xaxes)),Qe&&(rr(Te),rr(De.yaxes),rr(Xe.yaxes)),bt={},Qt=0;Qt<tr.length;Qt++){var fr=tr[Qt],yr=b(ee,fr);s.drawOne(ee,yr,{skipTitle:!0}),bt[yr._name+".range[0]"]=yr.range[0],bt[yr._name+".range[1]"]=yr.range[1]}s.redrawComponents(ee,tr)}function Ut(){if(!ee._transitioningWithDuration){var Qt=ee._context.doubleClick,tr=[];Be&&(tr=tr.concat(ge)),Ie&&(tr=tr.concat(Te)),Xe.xaxes&&(tr=tr.concat(Xe.xaxes)),Xe.yaxes&&(tr=tr.concat(Xe.yaxes));var rr,fr,yr,Sr={};if(Qt==="reset+autosize"){for(Qt="autosize",fr=0;fr<tr.length;fr++)if((rr=tr[fr])._rangeInitial&&(rr.range[0]!==rr._rangeInitial[0]||rr.range[1]!==rr._rangeInitial[1])||!rr._rangeInitial&&!rr.autorange){Qt="reset";break}}if(Qt==="autosize")for(fr=0;fr<tr.length;fr++)(rr=tr[fr]).fixedrange||(Sr[rr._name+".autorange"]=!0);else if(Qt==="reset")for((Be||De.isSubplotConstrained)&&(tr=tr.concat(De.xaxes)),Ie&&!De.isSubplotConstrained&&(tr=tr.concat(De.yaxes)),De.isSubplotConstrained&&(Be?Ie||(tr=tr.concat(Te)):tr=tr.concat(ge)),fr=0;fr<tr.length;fr++)(rr=tr[fr]).fixedrange||(rr._rangeInitial?(yr=rr._rangeInitial,Sr[rr._name+".range[0]"]=yr[0],Sr[rr._name+".range[1]"]=yr[1]):Sr[rr._name+".autorange"]=!0);ee.emit("plotly_doubleclick",null),t.call("_guiRelayout",ee,Sr)}}function Kt(){Ht([0,0,ze,Oe]),v.syncOrAsync([_.previousPromises,function(){ee._fullLayout._replotting=!1,t.call("_guiRelayout",ee,bt)}],ee)}function Ht(Qt){var tr,rr,fr,yr,Sr=ee._fullLayout,Dr=Sr._plots,Nr=Sr._subplots.cartesian;if(xt&&t.subplotsRegistry.splom.drag(ee),lt){for(tr=0;tr<Nr.length;tr++)if(fr=(rr=Dr[Nr[tr]]).xaxis,yr=rr.yaxis,rr._scene){var Wr=v.simpleMap(fr.range,fr.r2l),hn=v.simpleMap(yr.range,yr.r2l);rr._scene.update({range:[Wr[0],hn[0],Wr[1],hn[1]]})}}if((xt||lt)&&(x(ee),f(ee)),wt){var tn=Qt[2]/fe._length,Fn=Qt[3]/me._length;for(tr=0;tr<Nr.length;tr++){fr=(rr=Dr[Nr[tr]]).xaxis,yr=rr.yaxis;var an,xn,_n,ti,jr=(Ye||Xe.isSubplotConstrained)&&!fr.fixedrange&&_e[fr._id],nn=(Qe||Xe.isSubplotConstrained)&&!yr.fixedrange&&le[yr._id];if(jr?(an=tn,_n=Ae||Xe.isSubplotConstrained?Qt[0]:hr(fr,an)):Xe.xaHash[fr._id]?(an=tn,_n=Qt[0]*fr._length/fe._length):Xe.yaHash[fr._id]?(an=Fn,_n=Ie==="ns"?-Qt[1]*fr._length/me._length:hr(fr,an,{n:"top",s:"bottom"}[Ie])):_n=Mr(fr,an=pr(fr,tn,Fn)),nn?(xn=Fn,ti=ve||Xe.isSubplotConstrained?Qt[1]:hr(yr,xn)):Xe.yaHash[yr._id]?(xn=Fn,ti=Qt[1]*yr._length/me._length):Xe.xaHash[yr._id]?(xn=tn,ti=Be==="ew"?-Qt[0]*yr._length/fe._length:hr(yr,xn,{e:"right",w:"left"}[Be])):ti=Mr(yr,xn=pr(yr,tn,Fn)),an||xn){an||(an=1),xn||(xn=1);var vn=fr._offset-_n/an,en=yr._offset-ti/xn;rr.clipRect.call(g.setTranslate,_n,ti).call(g.setScale,an,xn),rr.plot.call(g.setTranslate,vn,en).call(g.setScale,1/an,1/xn),an===rr.xScaleFactor&&xn===rr.yScaleFactor||(g.setPointGroupScale(rr.zoomScalePts,an,xn),g.setTextPointsScale(rr.zoomScaleTxt,an,xn)),g.hideOutsideRangePoints(rr.clipOnAxisFalseTraces,rr),rr.xScaleFactor=an,rr.yScaleFactor=xn}}}}function pr(Qt,tr,rr){return Qt.fixedrange?0:Ye&&De.xaHash[Qt._id]?tr:Qe&&(De.isSubplotConstrained?De.xaHash:De.yaHash)[Qt._id]?rr:0}function Mr(Qt,tr){return tr?(Qt.range=Qt._r.slice(),A(Qt,tr),hr(Qt,tr)):0}function hr(Qt,tr,rr){return Qt._length*(1-tr)*i[rr||Qt.constraintoward||"middle"]}return ve.length*Ae.length!=1&&X(ar,function(Qt){if(ee._context._scrollZoom.cartesian||ee._fullLayout._enablescrollzoom){if(Mt(),ee._transitioningWithDuration)return Qt.preventDefault(),void Qt.stopPropagation();Jt(),clearTimeout(Pt);var tr=-Qt.deltaY;if(isFinite(tr)||(tr=Qt.wheelDelta/10),isFinite(tr)){var rr,fr=Math.exp(-Math.min(Math.max(tr,-20),20)/200),yr=Ze.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Sr=(Qt.clientX-yr.left)/yr.width,Dr=(yr.bottom-Qt.clientY)/yr.height;if(Ye){for(Ae||(Sr=.5),rr=0;rr<ge.length;rr++)Nr(ge[rr],Sr,fr);pt("x"),kt[2]*=fr,kt[0]+=kt[2]*Sr*(1/fr-1)}if(Qe){for(ve||(Dr=.5),rr=0;rr<Te.length;rr++)Nr(Te[rr],Dr,fr);pt("y"),kt[3]*=fr,kt[1]+=kt[3]*(1-Dr)*(1/fr-1)}Ht(kt),St(),ee.emit("plotly_relayouting",bt),Pt=setTimeout(function(){ee._fullLayout&&(kt=[0,0,ze,Oe],Kt())},Ee),Qt.preventDefault()}else v.log("Did not find wheel motion attributes: ",Qt)}function Nr(Wr,hn,tn){if(!Wr.fixedrange){var Fn=v.simpleMap(Wr.range,Wr.r2l),an=Fn[0]+(Fn[1]-Fn[0])*hn;Wr.range=Fn.map(function(xn){return Wr.l2r(an+(xn-an)*tn)})}}}),ar},makeDragger:z,makeRectDragger:D,makeZoombox:K,makeCorners:$,updateZoombox:ne,xyCorners:te,transitionZoombox:H,removeZoombox:N,showDoubleClickNotifier:U,attachWheelEventHandler:X}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/fx"),w=m("../../components/dragelement"),y=m("../../lib/setcursor"),e=m("./dragbox").makeDragBox,t=m("./constants").DRAGGERSIZE;W.initInteractions=function(n){var a=n._fullLayout;if(n._context.staticPlot)d.select(n).selectAll(".drag").remove();else if(a._has("cartesian")||a._has("splom")){Object.keys(a._plots||{}).sort(function(g,u){if((a._plots[g].mainplot&&!0)===(a._plots[u].mainplot&&!0)){var s=g.split("y"),h=u.split("y");return s[0]===h[0]?Number(s[1]||1)-Number(h[1]||1):Number(s[0]||1)-Number(h[0]||1)}return a._plots[g].mainplot?1:-1}).forEach(function(g){var u=a._plots[g],s=u.xaxis,h=u.yaxis;if(!u.mainplot){var l=e(n,u,s._offset,h._offset,s._length,h._length,"ns","ew");l.onmousemove=function(c){n._fullLayout._rehover=function(){n._fullLayout._hoversubplot===g&&n._fullLayout._plots[g]&&v.hover(n,c,g)},v.hover(n,c,g),n._fullLayout._lasthover=l,n._fullLayout._hoversubplot=g},l.onmouseout=function(c){n._dragging||(n._fullLayout._hoversubplot=null,w.unhover(n,c))},n._context.showAxisDragHandles&&(e(n,u,s._offset-t,h._offset-t,t,t,"n","w"),e(n,u,s._offset+s._length,h._offset-t,t,t,"n","e"),e(n,u,s._offset-t,h._offset+h._length,t,t,"s","w"),e(n,u,s._offset+s._length,h._offset+h._length,t,t,"s","e"))}if(n._context.showAxisDragHandles){if(g===s._mainSubplot){var o=s._mainLinePosition;s.side==="top"&&(o-=t),e(n,u,s._offset+.1*s._length,o,.8*s._length,t,"","ew"),e(n,u,s._offset,o,.1*s._length,t,"","w"),e(n,u,s._offset+.9*s._length,o,.1*s._length,t,"","e")}if(g===h._mainSubplot){var p=h._mainLinePosition;h.side!=="right"&&(p-=t),e(n,u,p,h._offset+.1*h._length,t,.8*h._length,"ns",""),e(n,u,p,h._offset+.9*h._length,t,.1*h._length,"s",""),e(n,u,p,h._offset,t,.1*h._length,"n","")}}});var r=a._hoverlayer.node();r.onmousemove=function(g){g.target=n._fullLayout._lasthover,v.hover(n,g,a._hoversubplot)},r.onclick=function(g){g.target=n._fullLayout._lasthover,v.click(n,g)},r.onmousedown=function(g){n._fullLayout._lasthover.onmousedown(g)},W.updateFx(n)}},W.updateFx=function(n){var a=n._fullLayout,r=a.dragmode==="pan"?"move":"crosshair";y(a._draggers,r)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("./axis_ids");G.exports=function(y){return function(e,t){var n=e[y];if(Array.isArray(n))for(var a=d.subplotsRegistry.cartesian,r=a.idRegex,g=t._subplots,u=g.xaxis,s=g.yaxis,h=g.cartesian,l=t._has("cartesian")||t._has("gl2d"),o=0;o<n.length;o++){var p=n[o];if(v.isPlainObject(p)){var c=w.cleanId(p.xref,"x",!1),i=w.cleanId(p.yref,"y",!1),x=r.x.test(c),f=r.y.test(i);if(x||f){l||v.pushUnique(t._basePlotModules,a);var _=!1;x&&u.indexOf(c)===-1&&(u.push(c),_=!0),f&&s.indexOf(i)===-1&&(s.push(i),_=!0),_&&x&&f&&h.push(c+i)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=m("../plots"),e=m("../../components/drawing"),t=m("../get_data").getModuleCalcData,n=m("./axis_ids"),a=m("./constants"),r=m("../../constants/xmlns_namespaces"),g=w.ensureSingle;function u(p,c,i){return w.ensureSingle(p,c,i,function(x){x.datum(i)})}function s(p,c,i,x,f){for(var _,b,T,k=a.traceLayerClasses,L=p._fullLayout,A=L._modules,I=[],P=[],S=0;S<A.length;S++){var E=(_=A[S]).name,z=v.modules[E].categories;if(z.svg){var D=_.layerName||E+"layer",j=_.plot;T=(b=t(i,j))[0],i=b[1],T.length&&I.push({i:k.indexOf(D),className:D,plotMethod:j,cdModule:T}),z.zoomScale&&P.push("."+D)}}I.sort(function(Q,K){return Q.i-K.i});var V=c.plot.selectAll("g.mlayer").data(I,function(Q){return Q.className});if(V.enter().append("g").attr("class",function(Q){return Q.className}).classed("mlayer",!0).classed("rangeplot",c.isRangePlot),V.exit().remove(),V.order(),V.each(function(Q){var K=d.select(this),$=Q.className;Q.plotMethod(p,c,Q.cdModule,K,x,f),a.clipOnAxisFalseQuery.indexOf("."+$)===-1&&e.setClipUrl(K,c.layerClipId,p)}),L._has("scattergl")&&(_=v.getModule("scattergl"),T=t(i,_)[0],_.plot(p,c,T)),!p._context.staticPlot&&(c._hasClipOnAxisFalse&&(c.clipOnAxisFalseTraces=c.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var Z=c.plot.selectAll(P.join(",")).selectAll(".trace");c.zoomScalePts=Z.selectAll("path.point"),c.zoomScaleTxt=Z.selectAll(".textpoint")}}function h(p,c){var i=c.plotgroup,x=c.id,f=a.layerValue2layerClass[c.xaxis.layer],_=a.layerValue2layerClass[c.yaxis.layer],b=p._fullLayout._hasOnlyLargeSploms;if(c.mainplot){var T=c.mainplotinfo,k=T.plotgroup,L=x+"-x",A=x+"-y";c.minorGridlayer=T.minorGridlayer,c.gridlayer=T.gridlayer,c.zerolinelayer=T.zerolinelayer,g(T.overlinesBelow,"path",L),g(T.overlinesBelow,"path",A),g(T.overaxesBelow,"g",L),g(T.overaxesBelow,"g",A),c.plot=g(T.overplot,"g",x),g(T.overlinesAbove,"path",L),g(T.overlinesAbove,"path",A),g(T.overaxesAbove,"g",L),g(T.overaxesAbove,"g",A),c.xlines=k.select(".overlines-"+f).select("."+L),c.ylines=k.select(".overlines-"+_).select("."+A),c.xaxislayer=k.select(".overaxes-"+f).select("."+L),c.yaxislayer=k.select(".overaxes-"+_).select("."+A)}else if(b)c.xlines=g(i,"path","xlines-above"),c.ylines=g(i,"path","ylines-above"),c.xaxislayer=g(i,"g","xaxislayer-above"),c.yaxislayer=g(i,"g","yaxislayer-above");else{var I=g(i,"g","layer-subplot");c.shapelayer=g(I,"g","shapelayer"),c.imagelayer=g(I,"g","imagelayer"),c.minorGridlayer=g(i,"g","minor-gridlayer"),c.gridlayer=g(i,"g","gridlayer"),c.zerolinelayer=g(i,"g","zerolinelayer"),g(i,"path","xlines-below"),g(i,"path","ylines-below"),c.overlinesBelow=g(i,"g","overlines-below"),g(i,"g","xaxislayer-below"),g(i,"g","yaxislayer-below"),c.overaxesBelow=g(i,"g","overaxes-below"),c.plot=g(i,"g","plot"),c.overplot=g(i,"g","overplot"),c.xlines=g(i,"path","xlines-above"),c.ylines=g(i,"path","ylines-above"),c.overlinesAbove=g(i,"g","overlines-above"),g(i,"g","xaxislayer-above"),g(i,"g","yaxislayer-above"),c.overaxesAbove=g(i,"g","overaxes-above"),c.xlines=i.select(".xlines-"+f),c.ylines=i.select(".ylines-"+_),c.xaxislayer=i.select(".xaxislayer-"+f),c.yaxislayer=i.select(".yaxislayer-"+_)}b||(u(c.minorGridlayer,"g",c.xaxis._id),u(c.minorGridlayer,"g",c.yaxis._id),c.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),u(c.gridlayer,"g",c.xaxis._id),u(c.gridlayer,"g",c.yaxis._id),c.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),c.xlines.style("fill","none").classed("crisp",!0),c.ylines.style("fill","none").classed("crisp",!0)}function l(p,c){if(p){var i={};for(var x in p.each(function(T){var k=T[0];d.select(this).remove(),o(k,c),i[k]=!0}),c._plots)for(var f=c._plots[x].overlays||[],_=0;_<f.length;_++){var b=f[_];i[b.id]&&b.plot.selectAll(".trace").remove()}}}function o(p,c){c._draggers.selectAll("g."+p).remove(),c._defs.select("#clip"+c._uid+p+"plot").remove()}W.name="cartesian",W.attr=["xaxis","yaxis"],W.idRoot=["x","y"],W.idRegex=a.idRegex,W.attrRegex=a.attrRegex,W.attributes=m("./attributes"),W.layoutAttributes=m("./layout_attributes"),W.supplyLayoutDefaults=m("./layout_defaults"),W.transitionAxes=m("./transition_axes"),W.finalizeSubplots=function(p,c){var i,x,f,_=c._subplots,b=_.xaxis,T=_.yaxis,k=_.cartesian,L=k.concat(_.gl2d||[]),A={},I={};for(i=0;i<L.length;i++){var P=L[i].split("y");A[P[0]]=1,I["y"+P[1]]=1}for(i=0;i<b.length;i++)A[x=b[i]]||(f=(p[n.id2name(x)]||{}).anchor,a.idRegex.y.test(f)||(f="y"),k.push(x+f),L.push(x+f),I[f]||(I[f]=1,w.pushUnique(T,f)));for(i=0;i<T.length;i++)I[f=T[i]]||(x=(p[n.id2name(f)]||{}).anchor,a.idRegex.x.test(x)||(x="x"),k.push(x+f),L.push(x+f),A[x]||(A[x]=1,w.pushUnique(b,x)));if(!L.length){for(var S in x="",f="",p)a.attrRegex.test(S)&&(S.charAt(0)==="x"?(!x||+S.substr(5)<+x.substr(5))&&(x=S):(!f||+S.substr(5)<+f.substr(5))&&(f=S));x=x?n.name2id(x):"x",f=f?n.name2id(f):"y",b.push(x),T.push(f),k.push(x+f)}},W.plot=function(p,c,i,x){var f,_=p._fullLayout,b=_._subplots.cartesian,T=p.calcdata;if(!Array.isArray(c))for(c=[],f=0;f<T.length;f++)c.push(f);for(f=0;f<b.length;f++){for(var k,L=b[f],A=_._plots[L],I=[],P=0;P<T.length;P++){var S=T[P],E=S[0].trace;E.xaxis+E.yaxis===L&&((c.indexOf(E.index)!==-1||E.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===L&&["tonextx","tonexty","tonext"].indexOf(E.fill)!==-1&&I.indexOf(k)===-1&&I.push(k),I.push(S)),k=S)}s(p,A,I,i,x)}},W.clean=function(p,c,i,x){var f,_,b,T=x._plots||{},k=c._plots||{},L=x._subplots||{};if(x._hasOnlyLargeSploms&&!c._hasOnlyLargeSploms)for(b in T)(f=T[b]).plotgroup&&f.plotgroup.remove();var A=x._has&&x._has("gl"),I=c._has&&c._has("gl");if(A&&!I)for(b in T)(f=T[b])._scene&&f._scene.destroy();if(L.xaxis&&L.yaxis){var P=n.listIds({_fullLayout:x});for(_=0;_<P.length;_++){var S=P[_];c[n.id2name(S)]||x._infolayer.selectAll(".g-"+S+"title").remove()}}var E=x._has&&x._has("cartesian"),z=c._has&&c._has("cartesian");if(E&&!z)l(x._cartesianlayer.selectAll(".subplot"),x),x._defs.selectAll(".axesclip").remove(),delete x._axisConstraintGroups,delete x._axisMatchGroups;else if(L.cartesian)for(_=0;_<L.cartesian.length;_++){var D=L.cartesian[_];if(!k[D]){var j="."+D+",."+D+"-x,."+D+"-y";x._cartesianlayer.selectAll(j).remove(),o(D,x)}}},W.drawFramework=function(p){var c=p._fullLayout,i=function(f){var _,b,T,k,L,A,I=f._fullLayout,P=I._subplots.cartesian,S=P.length,E=[],z=[];for(_=0;_<S;_++){T=P[_],k=I._plots[T],L=k.xaxis,A=k.yaxis;var D=L._mainAxis,j=A._mainAxis,V=D._id+j._id,Z=I._plots[V];k.overlays=[],V!==T&&Z?(k.mainplot=V,k.mainplotinfo=Z,z.push(T)):(k.mainplot=void 0,k.mainplotinfo=void 0,E.push(T))}for(_=0;_<z.length;_++)T=z[_],(k=I._plots[T]).mainplotinfo.overlays.push(k);var Q=E.concat(z),K=new Array(S);for(_=0;_<S;_++){T=Q[_],k=I._plots[T],L=k.xaxis,A=k.yaxis;var $=[T,L.layer,A.layer,L.overlaying||"",A.overlaying||""];for(b=0;b<k.overlays.length;b++)$.push(k.overlays[b].id);K[_]=$}return K}(p),x=c._cartesianlayer.selectAll(".subplot").data(i,String);x.enter().append("g").attr("class",function(f){return"subplot "+f[0]}),x.order(),x.exit().call(l,c),x.each(function(f){var _=f[0],b=c._plots[_];b.plotgroup=d.select(this),h(p,b),b.draglayer=g(c._draggers,"g",_)})},W.rangePlot=function(p,c,i){h(p,c),s(p,c,i),y.style(p)},W.toSVG=function(p){var c=p._fullLayout._glimages,i=d.select(p).selectAll(".svg-container");i.filter(function(x,f){return f===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var x=this.toDataURL("image/png");c.append("svg:image").attr({xmlns:r.svg,"xlink:href":x,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},W.updateFx=m("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(m,G,W){var d=m("../font_attributes"),v=m("../../components/color/attributes"),w=m("../../components/drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/plot_template").templatedArray,t=m("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=m("../../constants/numerical").ONEDAY,a=m("./constants"),r=a.HOUR_PATTERN,g=a.WEEKDAY_PATTERN,u={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function s(k){return{valType:"integer",min:0,dflt:k?5:0,editType:"ticks"}}var h={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},l={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},o={valType:"data_array",editType:"ticks"},p={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function c(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=5),L}function i(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var x={valType:"color",dflt:v.defaultLine,editType:"ticks"},f={valType:"color",dflt:v.lightLine,editType:"ticks"};function _(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var b=y({},w,{editType:"ticks"}),T={valType:"boolean",editType:"ticks"};G.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:v.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:d({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[g,r,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:u,nticks:s(),tick0:h,dtick:l,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:o,ticktext:{valType:"data_array",editType:"ticks"},ticks:p,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:c(),tickwidth:i(),tickcolor:x,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:y({},w,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:d({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:t("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:t("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:T,gridcolor:f,gridwidth:_(),griddash:b,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},minor:{tickmode:u,nticks:s("minor"),tick0:h,dtick:l,tickvals:o,ticks:p,ticklen:c("minor"),tickwidth:i("minor"),tickcolor:x,gridcolor:f,gridwidth:_("minor"),griddash:b,showgrid:T,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:d({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../../components/fx/helpers").isUnifiedHover,y=m("../../components/fx/hovermode_defaults"),e=m("../../plot_api/plot_template"),t=m("../layout_attributes"),n=m("./layout_attributes"),a=m("./type_defaults"),r=m("./axis_defaults"),g=m("./constraints"),u=m("./position_defaults"),s=m("./axis_ids"),h=s.id2name,l=s.name2id,o=m("./constants").AX_ID_PATTERN,p=m("../../registry"),c=p.traceIs,i=p.getComponentMethod;function x(f,_,b){Array.isArray(f[_])?f[_].push(b):f[_]=[b]}G.exports=function(f,_,b){var T,k,L=_.autotypenumbers,A={},I={},P={},S={},E={},z={},D={},j={},V={},Z={};for(T=0;T<b.length;T++){var Q=b[T];if(c(Q,"cartesian")||c(Q,"gl2d")){var K,$;if(Q.xaxis)K=h(Q.xaxis),x(A,K,Q);else if(Q.xaxes)for(k=0;k<Q.xaxes.length;k++)x(A,h(Q.xaxes[k]),Q);if(Q.yaxis)$=h(Q.yaxis),x(A,$,Q);else if(Q.yaxes)for(k=0;k<Q.yaxes.length;k++)x(A,h(Q.yaxes[k]),Q);Q.type==="funnel"?Q.orientation==="h"?(K&&(I[K]=!0),$&&(D[$]=!0)):$&&(P[$]=!0):Q.type==="image"?($&&(j[$]=!0),K&&(j[K]=!0)):($&&(E[$]=!0,z[$]=!0),c(Q,"carpet")&&(Q.type!=="carpet"||Q._cheater)||K&&(S[K]=!0)),Q.type==="carpet"&&Q._cheater&&K&&(I[K]=!0),c(Q,"2dMap")&&(V[K]=!0,V[$]=!0),c(Q,"oriented")&&(Z[Q.orientation==="h"?$:K]=!0)}}var ne=_._subplots,H=ne.xaxis,N=ne.yaxis,U=d.simpleMap(H,h),te=d.simpleMap(N,h),B=U.concat(te),X=v.background;H.length&&N.length&&(X=d.coerce(f,_,t,"plot_bgcolor"));var J,ee,re,se,oe,de=v.combine(X,_.paper_bgcolor);function ce(){var $e=A[J]||[];oe._traceIndices=$e.map(function(vt){return vt._expandedIndex}),oe._annIndices=[],oe._shapeIndices=[],oe._selectionIndices=[],oe._imgIndices=[],oe._subplotsWith=[],oe._counterAxes=[],oe._name=oe._attr=J,oe._id=ee}function ve($e,vt){return d.coerce(se,oe,n,$e,vt)}function Ae($e,vt){return d.coerce2(se,oe,n,$e,vt)}function fe($e){return $e==="x"?N:H}function me($e,vt){for(var Nt=$e==="x"?U:te,qt=[],Jt=0;Jt<Nt.length;Jt++){var Wt=Nt[Jt];Wt===vt||(f[Wt]||{}).overlaying||qt.push(l(Wt))}return qt}var _e={x:fe("x"),y:fe("y")},le=_e.x.concat(_e.y),ge={},Te=[];function Se(){var $e=se.matches;o.test($e)&&le.indexOf($e)===-1&&(ge[$e]=se.type,Te=Object.keys(ge))}var Me=y(f,_),ze=w(Me);for(T=0;T<B.length;T++){J=B[T],ee=l(J),re=J.charAt(0),d.isPlainObject(f[J])||(f[J]={}),se=f[J],oe=e.newContainer(_,J,re+"axis"),ce();var Oe=re==="x"&&!S[J]&&I[J]||re==="y"&&!E[J]&&P[J],De=re==="y"&&(!z[J]&&D[J]||j[J]),Xe={hasMinor:!0,letter:re,font:_.font,outerTicks:V[J],showGrid:!Z[J],data:A[J]||[],bgColor:de,calendar:_.calendar,automargin:!0,visibleDflt:Oe,reverseDflt:De,autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[re]||{})[ee]};ve("uirevision",_.uirevision),a(se,oe,ve,Xe),r(se,oe,ve,Xe,_);var Be=ze&&re===Me.charAt(0),Ie=Ae("spikecolor",ze?oe.color:void 0),Re=Ae("spikethickness",ze?1.5:void 0),Ye=Ae("spikedash",ze?"dot":void 0),Qe=Ae("spikemode",ze?"across":void 0),lt=Ae("spikesnap");ve("showspikes",!!(Be||Ie||Re||Ye||Qe||lt))||(delete oe.spikecolor,delete oe.spikethickness,delete oe.spikedash,delete oe.spikemode,delete oe.spikesnap),u(se,oe,ve,{letter:re,counterAxes:_e[re],overlayableAxes:me(re,J),grid:_.grid}),ve("title.standoff"),Se(),oe._input=se}for(T=0;T<Te.length;){ee=Te[T++],re=(J=h(ee)).charAt(0),d.isPlainObject(f[J])||(f[J]={}),se=f[J],oe=e.newContainer(_,J,re+"axis"),ce();var xt={letter:re,font:_.font,outerTicks:V[J],showGrid:!Z[J],data:[],bgColor:de,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[re]||{})[ee]};ve("uirevision",_.uirevision),oe.type=ge[ee]||"linear",r(se,oe,ve,xt,_),u(se,oe,ve,{letter:re,counterAxes:_e[re],overlayableAxes:me(re,J),grid:_.grid}),ve("fixedrange"),Se(),oe._input=se}var wt=i("rangeslider","handleDefaults"),bt=i("rangeselector","handleDefaults");for(T=0;T<U.length;T++)J=U[T],se=f[J],oe=_[J],wt(f,_,J),oe.type==="date"&&bt(se,oe,_,te,oe.calendar),ve("fixedrange");for(T=0;T<te.length;T++){J=te[T],se=f[J],oe=_[J];var nt=_[h(oe.anchor)];ve("fixedrange",i("rangeslider","isVisible")(nt))}g.handleDefaults(f,_,{axIds:le.concat(Te).sort(s.idSort),axHasImage:j})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(m,G,W){var d=m("tinycolor2").mix,v=m("../../components/color/attributes"),w=m("../../lib");G.exports=function(y,e,t,n){var a=(n=n||{}).dfltColor;function r(f,_){return w.coerce2(y,e,n.attributes,f,_)}var g=r("linecolor",a),u=r("linewidth");t("showline",n.showLine||!!g||!!u)||(delete e.linecolor,delete e.linewidth);var s=r("gridcolor",d(a,n.bgColor,n.blend||v.lightFraction).toRgbString()),h=r("gridwidth"),l=r("griddash");if(t("showgrid",n.showGrid||!!s||!!h||!!l)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),n.hasMinor){var o=r("minor.gridcolor",d(e.gridcolor,n.bgColor,67).toRgbString()),p=r("minor.gridwidth",e.gridwidth||1),c=r("minor.griddash",e.griddash||"solid");t("minor.showgrid",!!o||!!p||!!c)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!n.noZeroLine){var i=r("zerolinecolor",a),x=r("zerolinewidth");t("zeroline",n.showGrid||!!i||!!x)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib");G.exports=function(w,y,e,t){var n,a,r,g,u=t.counterAxes||[],s=t.overlayableAxes||[],h=t.letter,l=t.grid;l&&(a=l._domains[h][l._axisMap[y._id]],n=l._anchors[y._id],a&&(r=l[h+"side"].split(" ")[0],g=l.domain[h][r==="right"||r==="top"?1:0])),a=a||[0,1],n=n||(d(w.position)?"free":u[0]||"free"),r=r||(h==="x"?"bottom":"left"),g=g||0,v.coerce(w,y,{anchor:{valType:"enumerated",values:["free"].concat(u),dflt:n}},"anchor")==="free"&&e("position",g),v.coerce(w,y,{side:{valType:"enumerated",values:h==="x"?["bottom","top"]:["left","right"],dflt:r}},"side");var o=!1;if(s.length&&(o=v.coerce(w,y,{overlaying:{valType:"enumerated",values:[!1].concat(s),dflt:!1}},"overlaying")),!o){var p=e("domain",a);p[0]>p[1]-1/4096&&(y.domain=a),v.noneOrAll(w.domain,y.domain,a)}return e("layer"),y}},{"../../lib":515,"fast-isnumeric":190}],583:[function(m,G,W){var d=m("./show_dflt");G.exports=function(v,w,y,e,t){t||(t={});var n=t.tickSuffixDflt,a=d(v);y("tickprefix")&&y("showtickprefix",a),y("ticksuffix",n)&&y("showticksuffix",a)}},{"./show_dflt":586}],584:[function(m,G,W){var d=m("../../constants/alignment").FROM_BL;G.exports=function(v,w,y){y===void 0&&(y=d[v.constraintoward||"center"]);var e=[v.r2l(v.range[0]),v.r2l(v.range[1])],t=e[0]+(e[1]-e[0])*y;v.range=v._input.range=[v.l2r(t+(e[0]-t)*w),v.l2r(t+(e[1]-t)*w)],v.setScale()}},{"../../constants/alignment":483}],585:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-time-format").utcFormat,w=m("../../lib"),y=w.numberFormat,e=m("fast-isnumeric"),t=w.cleanNumber,n=w.ms2DateTime,a=w.dateTime2ms,r=w.ensureNumber,g=w.isArrayOrTypedArray,u=m("../../constants/numerical"),s=u.FP_SAFE,h=u.BADNUM,l=u.LOG_CLIP,o=u.ONEWEEK,p=u.ONEDAY,c=u.ONEHOUR,i=u.ONEMIN,x=u.ONESEC,f=m("./axis_ids"),_=m("./constants"),b=_.HOUR_PATTERN,T=_.WEEKDAY_PATTERN;function k(A){return Math.pow(10,A)}function L(A){return A!=null}G.exports=function(A,I){I=I||{};var P=A._id||"x",S=P.charAt(0);function E(B,X){if(B>0)return Math.log(B)/Math.LN10;if(B<=0&&X&&A.range&&A.range.length===2){var J=A.range[0],ee=A.range[1];return .5*(J+ee-2*l*Math.abs(J-ee))}return h}function z(B,X,J,ee){if((ee||{}).msUTC&&e(B))return+B;var re=a(B,J||A.calendar);if(re===h){if(!e(B))return h;B=+B;var se=Math.floor(10*w.mod(B+.05,1)),oe=Math.round(B-se/10);re=a(new Date(oe))+se/10}return re}function D(B,X,J){return n(B,X,J||A.calendar)}function j(B){return A._categories[Math.round(B)]}function V(B){if(L(B)){if(A._categoriesMap===void 0&&(A._categoriesMap={}),A._categoriesMap[B]!==void 0)return A._categoriesMap[B];A._categories.push(typeof B=="number"?String(B):B);var X=A._categories.length-1;return A._categoriesMap[B]=X,X}return h}function Z(B){if(A._categoriesMap)return A._categoriesMap[B]}function Q(B){var X=Z(B);return X!==void 0?X:e(B)?+B:void 0}function K(B){return e(B)?+B:Z(B)}function $(B,X,J){return d.round(J+X*B,2)}function ne(B,X,J){return(B-J)/X}var H=function(B){return e(B)?$(B,A._m,A._b):h},N=function(B){return ne(B,A._m,A._b)};if(A.rangebreaks){var U=S==="y";H=function(B){if(!e(B))return h;var X=A._rangebreaks.length;if(!X)return $(B,A._m,A._b);var J=U;A.range[0]>A.range[1]&&(J=!J);for(var ee=J?-1:1,re=ee*B,se=0,oe=0;oe<X;oe++){var de=ee*A._rangebreaks[oe].min,ce=ee*A._rangebreaks[oe].max;if(re<de)break;if(!(re>ce)){se=re<(de+ce)/2?oe:oe+1;break}se=oe+1}var ve=A._B[se]||0;return isFinite(ve)?$(B,A._m2,ve):0},N=function(B){var X=A._rangebreaks.length;if(!X)return ne(B,A._m,A._b);for(var J=0,ee=0;ee<X&&!(B<A._rangebreaks[ee].pmin);ee++)B>A._rangebreaks[ee].pmax&&(J=ee+1);return ne(B,A._m2,A._B[J])}}A.c2l=A.type==="log"?E:r,A.l2c=A.type==="log"?k:r,A.l2p=H,A.p2l=N,A.c2p=A.type==="log"?function(B,X){return H(E(B,X))}:H,A.p2c=A.type==="log"?function(B){return k(N(B))}:N,["linear","-"].indexOf(A.type)!==-1?(A.d2r=A.r2d=A.d2c=A.r2c=A.d2l=A.r2l=t,A.c2d=A.c2r=A.l2d=A.l2r=r,A.d2p=A.r2p=function(B){return A.l2p(t(B))},A.p2d=A.p2r=N,A.cleanPos=r):A.type==="log"?(A.d2r=A.d2l=function(B,X){return E(t(B),X)},A.r2d=A.r2c=function(B){return k(t(B))},A.d2c=A.r2l=t,A.c2d=A.l2r=r,A.c2r=E,A.l2d=k,A.d2p=function(B,X){return A.l2p(A.d2r(B,X))},A.p2d=function(B){return k(N(B))},A.r2p=function(B){return A.l2p(t(B))},A.p2r=N,A.cleanPos=r):A.type==="date"?(A.d2r=A.r2d=w.identity,A.d2c=A.r2c=A.d2l=A.r2l=z,A.c2d=A.c2r=A.l2d=A.l2r=D,A.d2p=A.r2p=function(B,X,J){return A.l2p(z(B,0,J))},A.p2d=A.p2r=function(B,X,J){return D(N(B),X,J)},A.cleanPos=function(B){return w.cleanDate(B,h,A.calendar)}):A.type==="category"?(A.d2c=A.d2l=V,A.r2d=A.c2d=A.l2d=j,A.d2r=A.d2l_noadd=Q,A.r2c=function(B){var X=K(B);return X!==void 0?X:A.fraction2r(.5)},A.l2r=A.c2r=r,A.r2l=K,A.d2p=function(B){return A.l2p(A.r2c(B))},A.p2d=function(B){return j(N(B))},A.r2p=A.d2p,A.p2r=N,A.cleanPos=function(B){return typeof B=="string"&&B!==""?B:r(B)}):A.type==="multicategory"&&(A.r2d=A.c2d=A.l2d=j,A.d2r=A.d2l_noadd=Q,A.r2c=function(B){var X=Q(B);return X!==void 0?X:A.fraction2r(.5)},A.r2c_just_indices=Z,A.l2r=A.c2r=r,A.r2l=Q,A.d2p=function(B){return A.l2p(A.r2c(B))},A.p2d=function(B){return j(N(B))},A.r2p=A.d2p,A.p2r=N,A.cleanPos=function(B){return Array.isArray(B)||typeof B=="string"&&B!==""?B:r(B)},A.setupMultiCategory=function(B){var X,J,ee=A._traceIndices,re=A._matchGroup;if(re&&A._categories.length===0){for(var se in re)if(se!==P){var oe=I[f.id2name(se)];ee=ee.concat(oe._traceIndices)}}var de=[[0,{}],[0,{}]],ce=[];for(X=0;X<ee.length;X++){var ve=B[ee[X]];if(S in ve){var Ae=ve[S],fe=ve._length||w.minRowLength(Ae);if(g(Ae[0])&&g(Ae[1]))for(J=0;J<fe;J++){var me=Ae[0][J],_e=Ae[1][J];L(me)&&L(_e)&&(ce.push([me,_e]),me in de[0][1]||(de[0][1][me]=de[0][0]++),_e in de[1][1]||(de[1][1][_e]=de[1][0]++))}}}for(ce.sort(function(le,ge){var Te=de[0][1],Se=Te[le[0]]-Te[ge[0]];if(Se)return Se;var Me=de[1][1];return Me[le[1]]-Me[ge[1]]}),X=0;X<ce.length;X++)V(ce[X])}),A.fraction2r=function(B){var X=A.r2l(A.range[0]),J=A.r2l(A.range[1]);return A.l2r(X+B*(J-X))},A.r2fraction=function(B){var X=A.r2l(A.range[0]),J=A.r2l(A.range[1]);return(A.r2l(B)-X)/(J-X)},A.cleanRange=function(B,X){X||(X={}),B||(B="range");var J,ee,re=w.nestedProperty(A,B).get();if(ee=(ee=A.type==="date"?w.dfltRange(A.calendar):S==="y"?_.DFLTRANGEY:A._name==="realaxis"?[0,1]:X.dfltRange||_.DFLTRANGEX).slice(),A.rangemode!=="tozero"&&A.rangemode!=="nonnegative"||(ee[0]=0),re&&re.length===2)for(A.type!=="date"||A.autorange||(re[0]=w.cleanDate(re[0],h,A.calendar),re[1]=w.cleanDate(re[1],h,A.calendar)),J=0;J<2;J++)if(A.type==="date"){if(!w.isDateTime(re[J],A.calendar)){A[B]=ee;break}if(A.r2l(re[0])===A.r2l(re[1])){var se=w.constrain(A.r2l(re[0]),w.MIN_MS+1e3,w.MAX_MS-1e3);re[0]=A.l2r(se-1e3),re[1]=A.l2r(se+1e3);break}}else{if(!e(re[J])){if(!e(re[1-J])){A[B]=ee;break}re[J]=re[1-J]*(J?10:.1)}if(re[J]<-s?re[J]=-s:re[J]>s&&(re[J]=s),re[0]===re[1]){var oe=Math.max(1,Math.abs(1e-6*re[0]));re[0]-=oe,re[1]+=oe}}else w.nestedProperty(A,B).set(ee)},A.setScale=function(B){var X=I._size;if(A.overlaying){var J=f.getFromId({_fullLayout:I},A.overlaying);A.domain=J.domain}var ee=B&&A._r?"_r":"range",re=A.calendar;A.cleanRange(ee);var se,oe,de=A.r2l(A[ee][0],re),ce=A.r2l(A[ee][1],re),ve=S==="y";if(ve?(A._offset=X.t+(1-A.domain[1])*X.h,A._length=X.h*(A.domain[1]-A.domain[0]),A._m=A._length/(de-ce),A._b=-A._m*ce):(A._offset=X.l+A.domain[0]*X.w,A._length=X.w*(A.domain[1]-A.domain[0]),A._m=A._length/(ce-de),A._b=-A._m*de),A._rangebreaks=[],A._lBreaks=0,A._m2=0,A._B=[],A.rangebreaks&&(A._rangebreaks=A.locateBreaks(Math.min(de,ce),Math.max(de,ce)),A._rangebreaks.length)){for(se=0;se<A._rangebreaks.length;se++)oe=A._rangebreaks[se],A._lBreaks+=Math.abs(oe.max-oe.min);var Ae=ve;de>ce&&(Ae=!Ae),Ae&&A._rangebreaks.reverse();var fe=Ae?-1:1;for(A._m2=fe*A._length/(Math.abs(ce-de)-A._lBreaks),A._B.push(-A._m2*(ve?ce:de)),se=0;se<A._rangebreaks.length;se++)oe=A._rangebreaks[se],A._B.push(A._B[A._B.length-1]-fe*A._m2*(oe.max-oe.min));for(se=0;se<A._rangebreaks.length;se++)(oe=A._rangebreaks[se]).pmin=H(oe.min),oe.pmax=H(oe.max)}if(!isFinite(A._m)||!isFinite(A._b)||A._length<0)throw I._replotting=!1,new Error("Something went wrong with axis scaling")},A.maskBreaks=function(B){var X,J,ee,re,se,oe=A.rangebreaks||[];oe._cachedPatterns||(oe._cachedPatterns=oe.map(function(me){return me.enabled&&me.bounds?w.simpleMap(me.bounds,me.pattern?t:A.d2c):null})),oe._cachedValues||(oe._cachedValues=oe.map(function(me){return me.enabled&&me.values?w.simpleMap(me.values,A.d2c).sort(w.sorterAsc):null}));for(var de=0;de<oe.length;de++){var ce=oe[de];if(ce.enabled){if(ce.bounds){var ve=ce.pattern;switch(J=(X=oe._cachedPatterns[de])[0],ee=X[1],ve){case T:re=(se=new Date(B)).getUTCDay(),J>ee&&(ee+=7,re<J&&(re+=7));break;case b:re=(se=new Date(B)).getUTCHours()+(se.getUTCMinutes()/60+se.getUTCSeconds()/3600+se.getUTCMilliseconds()/36e5),J>ee&&(ee+=24,re<J&&(re+=24));break;case"":re=B}if(re>=J&&re<ee)return h}else for(var Ae=oe._cachedValues[de],fe=0;fe<Ae.length;fe++)if(ee=(J=Ae[fe])+ce.dvalue,B>=J&&B<ee)return h}}return B},A.locateBreaks=function(B,X){var J,ee,re,se,oe=[];if(!A.rangebreaks)return oe;var de=A.rangebreaks.slice().sort(function(Me,ze){return Me.pattern===T&&ze.pattern===b?-1:ze.pattern===T&&Me.pattern===b?1:0}),ce=function(Me,ze){if((Me=w.constrain(Me,B,X))!==(ze=w.constrain(ze,B,X))){for(var Oe=!0,De=0;De<oe.length;De++){var Xe=oe[De];Me<Xe.max&&ze>=Xe.min&&(Me<Xe.min&&(Xe.min=Me),ze>Xe.max&&(Xe.max=ze),Oe=!1)}Oe&&oe.push({min:Me,max:ze})}};for(J=0;J<de.length;J++){var ve=de[J];if(ve.enabled)if(ve.bounds){var Ae=B,fe=X;ve.pattern&&(Ae=Math.floor(Ae)),re=(ee=w.simpleMap(ve.bounds,ve.pattern?t:A.r2l))[0],se=ee[1];var me,_e,le=new Date(Ae);switch(ve.pattern){case T:_e=o,me=(se-re+(se<re?7:0))*p,Ae+=re*p-(le.getUTCDay()*p+le.getUTCHours()*c+le.getUTCMinutes()*i+le.getUTCSeconds()*x+le.getUTCMilliseconds());break;case b:_e=p,me=(se-re+(se<re?24:0))*c,Ae+=re*c-(le.getUTCHours()*c+le.getUTCMinutes()*i+le.getUTCSeconds()*x+le.getUTCMilliseconds());break;default:Ae=Math.min(ee[0],ee[1]),me=_e=(fe=Math.max(ee[0],ee[1]))-Ae}for(var ge=Ae;ge<fe;ge+=_e)ce(ge,ge+me)}else for(var Te=w.simpleMap(ve.values,A.d2c),Se=0;Se<Te.length;Se++)ce(re=Te[Se],se=re+ve.dvalue)}return oe.sort(function(Me,ze){return Me.min-ze.min}),oe},A.makeCalcdata=function(B,X,J){var ee,re,se,oe,de=A.type,ce=de==="date"&&B[X+"calendar"];if(X in B){if(ee=B[X],oe=B._length||w.minRowLength(ee),w.isTypedArray(ee)&&(de==="linear"||de==="log")){if(oe===ee.length)return ee;if(ee.subarray)return ee.subarray(0,oe)}if(de==="multicategory")return function(fe,me){for(var _e=new Array(me),le=0;le<me;le++){var ge=(fe[0]||[])[le],Te=(fe[1]||[])[le];_e[le]=Z([ge,Te])}return _e}(ee,oe);for(re=new Array(oe),se=0;se<oe;se++)re[se]=A.d2c(ee[se],0,ce,J)}else{var ve=X+"0"in B?A.d2c(B[X+"0"],0,ce):0,Ae=B["d"+X]?Number(B["d"+X]):1;for(ee=B[{x:"y",y:"x"}[X]],oe=B._length||ee.length,re=new Array(oe),se=0;se<oe;se++)re[se]=ve+se*Ae}if(A.rangebreaks)for(se=0;se<oe;se++)re[se]=A.maskBreaks(re[se]);return re},A.isValidRange=function(B){return Array.isArray(B)&&B.length===2&&e(A.r2l(B[0]))&&e(A.r2l(B[1]))},A.isPtWithinRange=function(B,X){var J=A.c2l(B[S],null,X),ee=A.r2l(A.range[0]),re=A.r2l(A.range[1]);return ee<re?ee<=J&&J<=re:re<=J&&J<=ee},A._emptyCategories=function(){A._categories=[],A._categoriesMap={}},A.clearCalc=function(){var B=A._matchGroup;if(B){var X=null,J=null;for(var ee in B){var re=I[f.id2name(ee)];if(re._categories){X=re._categories,J=re._categoriesMap;break}}X&&J?(A._categories=X,A._categoriesMap=J):A._emptyCategories()}else A._emptyCategories();if(A._initialCategories)for(var se=0;se<A._initialCategories.length;se++)V(A._initialCategories[se])},A.sortByInitialCategories=function(){var B=[];if(A._emptyCategories(),A._initialCategories)for(var X=0;X<A._initialCategories.length;X++)V(A._initialCategories[X]);B=B.concat(A._traceIndices);var J=A._matchGroup;for(var ee in J)if(P!==ee){var re=I[f.id2name(ee)];re._categories=A._categories,re._categoriesMap=A._categoriesMap,B=B.concat(re._traceIndices)}return B};var te=I._d3locale;A.type==="date"&&(A._dateFormat=te?te.timeFormat:v,A._extraFormat=I._extraFormat),A._separators=I.separators,A._numFormat=te?te.numberFormat:y,delete A._minDtick,delete A._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(m,G,W){G.exports=function(d){var v=["showexponent","showtickprefix","showticksuffix"].filter(function(w){return d[w]!==void 0});if(v.every(function(w){return d[w]===d[v[0]]})||v.length===1)return d[v[0]]}},{}],587:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color").contrast,w=m("./layout_attributes"),y=m("./show_dflt"),e=m("../array_container_defaults");function t(n,a){function r(g,u){return d.coerce(n,a,w.tickformatstops,g,u)}r("enabled")&&(r("dtickrange"),r("value"))}G.exports=function(n,a,r,g,u){u||(u={});var s=y(n);if(r("showticklabels")){var h=u.font||{},l=a.color,o=(a.ticklabelposition||"").indexOf("inside")!==-1?v(u.bgColor):l&&l!==w.color.dflt?l:h.color;if(d.coerceFont(r,"tickfont",{family:h.family,size:h.size,color:o}),u.noTicklabelstep||g==="multicategory"||g==="log"||r("ticklabelstep"),u.noAng||r("tickangle"),g!=="category"){var p=r("tickformat");e(n,a,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:t}),a.tickformatstops.length||delete a.tickformatstops,u.noExp||p||g==="date"||(r("showexponent",s),r("exponentformat"),r("minexponent"),r("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e,t){var n=t.isMinor,a=n?w.minor||{}:w,r=n?y.minor:y,g=n?v.minor:v,u=n?"minor.":"",s=d.coerce2(a,r,g,"ticklen",n?.6*(y.ticklen||5):void 0),h=d.coerce2(a,r,g,"tickwidth",n?y.tickwidth||1:void 0),l=d.coerce2(a,r,g,"tickcolor",(n?y.tickcolor:void 0)||r.color);e(u+"ticks",!n&&t.outerTicks||s||h||l?"outside":"")||(delete r.ticklen,delete r.tickwidth,delete r.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(m,G,W){var d=m("./clean_ticks"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t,n){n||(n={});var a=n.isMinor,r=a?w.minor||{}:w,g=a?y.minor:y,u=a?"minor.":"";function s(i){var x=r[i];return x!==void 0?x:(g._template||{})[i]}var h=s("tick0"),l=s("dtick"),o=s("tickvals"),p=e(u+"tickmode",v(o)?"array":l?"linear":"auto");if(p==="auto")e(u+"nticks");else if(p==="linear"){var c=g.dtick=d.dtick(l,t);g.tick0=d.tick0(h,t,y.calendar,c)}else t!=="multicategory"&&(e(u+"tickvals")===void 0?g.tickmode="auto":a||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=m("../../components/drawing"),e=m("./axes");G.exports=function(t,n,a,r){var g=t._fullLayout;if(n.length!==0){var u,s,h,l;r&&(u=r());var o=d.ease(a.easing);return t._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(l),l=null,function(){for(var i={},x=0;x<n.length;x++){var f=n[x],_=f.plotinfo.xaxis,b=f.plotinfo.yaxis;f.xr0&&(i[_._name+".range"]=f.xr0.slice()),f.yr0&&(i[b._name+".range"]=f.yr0.slice())}return v.call("relayout",t,i).then(function(){for(var T=0;T<n.length;T++)p(n[T].plotinfo)})}()}),s=Date.now(),l=window.requestAnimationFrame(function i(){h=Date.now();for(var x=Math.min(1,(h-s)/a.duration),f=o(x),_=0;_<n.length;_++)c(n[_],f);h-s>a.duration?(function(){for(var b={},T=0;T<n.length;T++){var k=n[T],L=k.plotinfo.xaxis,A=k.plotinfo.yaxis;k.xr1&&(b[L._name+".range"]=k.xr1.slice()),k.yr1&&(b[A._name+".range"]=k.yr1.slice())}u&&u(),v.call("relayout",t,b).then(function(){for(var I=0;I<n.length;I++)p(n[I].plotinfo)})}(),l=window.cancelAnimationFrame(i)):l=window.requestAnimationFrame(i)}),Promise.resolve()}function p(i){var x=i.xaxis,f=i.yaxis;g._defs.select("#"+i.clipId+"> rect").call(y.setTranslate,0,0).call(y.setScale,1,1),i.plot.call(y.setTranslate,x._offset,f._offset).call(y.setScale,1,1);var _=i.plot.selectAll(".scatterlayer .trace");_.selectAll(".point").call(y.setPointGroupScale,1,1),_.selectAll(".textpoint").call(y.setTextPointsScale,1,1),_.call(y.hideOutsideRangePoints,i)}function c(i,x){var f=i.plotinfo,_=f.xaxis,b=f.yaxis,T=_._length,k=b._length,L=!!i.xr1,A=!!i.yr1,I=[];if(L){var P=w.simpleMap(i.xr0,_.r2l),S=w.simpleMap(i.xr1,_.r2l),E=P[1]-P[0],z=S[1]-S[0];I[0]=(P[0]*(1-x)+x*S[0]-P[0])/(P[1]-P[0])*T,I[2]=T*(1-x+x*z/E),_.range[0]=_.l2r(P[0]*(1-x)+x*S[0]),_.range[1]=_.l2r(P[1]*(1-x)+x*S[1])}else I[0]=0,I[2]=T;if(A){var D=w.simpleMap(i.yr0,b.r2l),j=w.simpleMap(i.yr1,b.r2l),V=D[1]-D[0],Z=j[1]-j[0];I[1]=(D[1]*(1-x)+x*j[1]-D[1])/(D[0]-D[1])*k,I[3]=k*(1-x+x*Z/V),b.range[0]=_.l2r(D[0]*(1-x)+x*j[0]),b.range[1]=b.l2r(D[1]*(1-x)+x*j[1])}else I[1]=0,I[3]=k;e.drawOne(t,_,{skipTitle:!0}),e.drawOne(t,b,{skipTitle:!0}),e.redrawComponents(t,[_._id,b._id]);var Q=L?T/I[2]:1,K=A?k/I[3]:1,$=L?I[0]:0,ne=A?I[1]:0,H=L?I[0]/I[2]*T:0,N=A?I[1]/I[3]*k:0,U=_._offset-H,te=b._offset-N;f.clipRect.call(y.setTranslate,$,ne).call(y.setScale,1/Q,1/K),f.plot.call(y.setTranslate,U,te).call(y.setScale,Q,K),y.setPointGroupScale(f.zoomScalePts,1/Q,1/K),y.setTextPointsScale(f.zoomScaleTxt,1/Q,1/K)}e.redrawComponents(t)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(m,G,W){var d=m("../../registry").traceIs,v=m("./axis_autotype");function w(e){return{v:"x",h:"y"}[e.orientation||"v"]}function y(e,t){var n=w(e),a=d(e,"box-violin"),r=d(e._fullInput||{},"candlestick");return a&&!r&&t===n&&e[n]===void 0&&e[n+"0"]===void 0}G.exports=function(e,t,n,a){n("autotypenumbers",a.autotypenumbersDflt),n("type",(a.splomStash||{}).type)==="-"&&(function(r,g){if(r.type==="-"){var u,s=r._id,h=s.charAt(0);s.indexOf("scene")!==-1&&(s=h);var l=function(b,T,k){for(var L=0;L<b.length;L++){var A=b[L];if(A.type==="splom"&&A._length>0&&(A["_"+k+"axes"]||{})[T]||(A[k+"axis"]||k)===T&&(y(A,k)||(A[k]||[]).length||A[k+"0"]))return A}}(g,s,h);if(!!l){if(l.type==="histogram"&&h==={v:"y",h:"x"}[l.orientation||"v"])return void(r.type="linear");var o=h+"calendar",p=l[o],c={noMultiCategory:!d(l,"cartesian")||d(l,"noMultiCategory")};if(l.type==="box"&&l._hasPreCompStats&&h==={h:"x",v:"y"}[l.orientation||"v"]&&(c.noMultiCategory=!0),c.autotypenumbers=r.autotypenumbers,y(l,h)){var i=w(l),x=[];for(u=0;u<g.length;u++){var f=g[u];d(f,"box-violin")&&(f[h+"axis"]||h)===s&&(f[i]!==void 0?x.push(f[i][0]):f.name!==void 0?x.push(f.name):x.push("text"),f[o]!==p&&(p=void 0))}r.type=v(x,p,c)}else if(l.type==="splom"){var _=l.dimensions[l._axesDim[s]];_.visible&&(r.type=v(_.values,p,c))}else r.type=v(l[h]||[l[h+"0"]],p,c)}}}(t,a.data),t.type==="-"?t.type="linear":e.type=t.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(m,G,W){var d=m("../registry"),v=m("../lib");function w(n,a,r){var g,u,s,h=!1;if(a.type==="data")g=n._fullData[a.traces!==null?a.traces[0]:0];else{if(a.type!=="layout")return!1;g=n._fullLayout}return u=v.nestedProperty(g,a.prop).get(),(s=r[a.type]=r[a.type]||{}).hasOwnProperty(a.prop)&&s[a.prop]!==u&&(h=!0),s[a.prop]=u,{changed:h,value:u}}function y(n,a){var r=[],g=a[0],u={};if(typeof g=="string")u[g]=a[1];else{if(!v.isPlainObject(g))return r;u=g}return t(u,function(s,h,l){r.push({type:"layout",prop:s,value:l})},"",0),r}function e(n,a){var r,g,u,s,h=[];if(g=a[0],u=a[1],r=a[2],s={},typeof g=="string")s[g]=u;else{if(!v.isPlainObject(g))return h;s=g,r===void 0&&(r=u)}return r===void 0&&(r=null),t(s,function(l,o,p){var c,i;if(Array.isArray(p)){i=p.slice();var x=Math.min(i.length,n.data.length);r&&(x=Math.min(x,r.length)),c=[];for(var f=0;f<x;f++)c[f]=r?r[f]:f}else i=p,c=r?r.slice():null;if(c===null)Array.isArray(i)&&(i=i[0]);else if(Array.isArray(c)){if(!Array.isArray(i)){var _=i;i=[];for(var b=0;b<c.length;b++)i[b]=_}i.length=Math.min(c.length,i.length)}h.push({type:"data",prop:l,traces:c,value:i})},"",0),h}function t(n,a,r,g){Object.keys(n).forEach(function(u){var s=n[u];if(u[0]!=="_"){var h=r+(g>0?".":"")+u;v.isPlainObject(s)?t(s,a,h,g+1):a(h,u,s)}})}W.manageCommandObserver=function(n,a,r,g){var u={},s=!0;a&&a._commandObserver&&(u=a._commandObserver),u.cache||(u.cache={}),u.lookupTable={};var h=W.hasSimpleAPICommandBindings(n,r,u.lookupTable);if(a&&a._commandObserver){if(h)return u;if(a._commandObserver.remove)return a._commandObserver.remove(),a._commandObserver=null,u}if(h){w(n,h,u.cache),u.check=function(){if(s){var p=w(n,h,u.cache);return p.changed&&g&&u.lookupTable[p.value]!==void 0&&(u.disable(),Promise.resolve(g({value:p.value,type:h.type,prop:h.prop,traces:h.traces,index:u.lookupTable[p.value]})).then(u.enable,u.enable)),p.changed}};for(var l=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],o=0;o<l.length;o++)n._internalOn(l[o],u.check);u.remove=function(){for(var p=0;p<l.length;p++)n._removeInternalListener(l[p],u.check)}}else v.log("Unable to automatically bind plot updates to API command"),u.lookupTable={},u.remove=function(){};return u.disable=function(){s=!1},u.enable=function(){s=!0},a&&(a._commandObserver=u),u},W.hasSimpleAPICommandBindings=function(n,a,r){var g,u,s=a.length;for(g=0;g<s;g++){var h,l=a[g],o=l.method,p=l.args;if(Array.isArray(p)||(p=[]),!o)return!1;var c=W.computeAPICommandBindings(n,o,p);if(c.length!==1)return!1;if(u){if((h=c[0]).type!==u.type||h.prop!==u.prop)return!1;if(Array.isArray(u.traces)){if(!Array.isArray(h.traces))return!1;h.traces.sort();for(var i=0;i<u.traces.length;i++)if(u.traces[i]!==h.traces[i])return!1}else if(h.prop!==u.prop)return!1}else u=c[0],Array.isArray(u.traces)&&u.traces.sort();var x=(h=c[0]).value;if(Array.isArray(x)){if(x.length!==1)return!1;x=x[0]}r&&(r[x]=g)}return u},W.executeAPICommand=function(n,a,r){if(a==="skip")return Promise.resolve();var g=d.apiMethodRegistry[a],u=[n];Array.isArray(r)||(r=[]);for(var s=0;s<r.length;s++)u.push(r[s]);return g.apply(null,u).catch(function(h){return v.warn("API call to Plotly."+a+" rejected.",h),Promise.reject(h)})},W.computeAPICommandBindings=function(n,a,r){var g;switch(Array.isArray(r)||(r=[]),a){case"restyle":g=e(n,r);break;case"relayout":g=y(n,r);break;case"update":g=e(n,[r[0],r[2]]).concat(y(n,[r[1]]));break;case"animate":g=function(u,s){return Array.isArray(s[0])&&s[0].length===1&&["string","number"].indexOf(typeof s[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:s[0][0].toString()}]:[]}(0,r);break;default:g=[]}return g}},{"../lib":515,"../registry":647}],593:[function(m,G,W){var d=m("../lib/extend").extendFlat;W.attributes=function(v,w){w=w||{};var y={valType:"info_array",editType:(v=v||{}).editType,items:[{valType:"number",min:0,max:1,editType:v.editType},{valType:"number",min:0,max:1,editType:v.editType}],dflt:[0,1]},e=(v.name&&v.name,v.trace,w.description&&w.description,{x:d({},y,{}),y:d({},y,{}),editType:v.editType});return v.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:v.editType},e.column={valType:"integer",min:0,dflt:0,editType:v.editType}),e},W.defaults=function(v,w,y,e){var t=e&&e.x||[0,1],n=e&&e.y||[0,1],a=w.grid;if(a){var r=y("domain.column");r!==void 0&&(r<a.columns?t=a._domains.x[r]:delete v.domain.column);var g=y("domain.row");g!==void 0&&(g<a.rows?n=a._domains.y[g]:delete v.domain.row)}var u=y("domain.x",t),s=y("domain.y",n);u[0]<u[1]||(v.domain.x=t.slice()),s[0]<s[1]||(v.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(m,G,W){G.exports=function(d){var v=d.editType,w=d.colorEditType;w===void 0&&(w=v);var y={family:{valType:"string",noBlank:!0,strict:!0,editType:v},size:{valType:"number",min:1,editType:v},color:{valType:"color",editType:w},editType:v};return d.autoSize&&(y.size.dflt="auto"),d.autoColor&&(y.color.dflt="auto"),d.arrayOk&&(y.family.arrayOk=!0,y.size.arrayOk=!0,y.color.arrayOk=!0),y}},{}],595:[function(m,G,W){G.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(m,G,W){W.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},W.axesNames=["lonaxis","lataxis"],W.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},W.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},W.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},W.clipPad=.001,W.precision=.1,W.landColor="#F0DC82",W.waterColor="#3399FF",W.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},W.sphereSVG={type:"Sphere"},W.fillLayers={ocean:1,land:1,lakes:1},W.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},W.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],W.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],W.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-geo"),w=v.geoPath,y=v.geoDistance,e=m("d3-geo-projection"),t=m("../../registry"),n=m("../../lib"),a=n.strTranslate,r=m("../../components/color"),g=m("../../components/drawing"),u=m("../../components/fx"),s=m("../plots"),h=m("../cartesian/axes"),l=m("../cartesian/autorange").getAutoRange,o=m("../../components/dragelement"),p=m("../../components/selections").prepSelect,c=m("../../components/selections").clearOutline,i=m("../../components/selections").selectOnClick,x=m("./zoom"),f=m("./constants"),_=m("../../lib/geo_location_utils"),b=m("../../lib/topojson_utils"),T=m("topojson-client").feature;function k(I){this.id=I.id,this.graphDiv=I.graphDiv,this.container=I.container,this.topojsonURL=I.topojsonURL,this.isStatic=I.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=k.prototype;function A(I,P){var S=f.clipPad,E=I[0]+S,z=I[1]-S,D=P[0]+S,j=P[1]-S;E>0&&z<0&&(z+=360);var V=(z-E)/4;return{type:"Polygon",coordinates:[[[E,D],[E,j],[E+V,j],[E+2*V,j],[E+3*V,j],[z,j],[z,D],[z-V,D],[z-2*V,D],[z-3*V,D],[E,D]]]}}G.exports=function(I){return new k(I)},L.plot=function(I,P,S,E){var z=this;if(E)return z.update(I,P,!0);z._geoCalcData=I,z._fullLayout=P;var D=P[this.id],j=[],V=!1;for(var Z in f.layerNameToAdjective)if(Z!=="frame"&&D["show"+Z]){V=!0;break}for(var Q=!1,K=0;K<I.length;K++){var $=I[0][0].trace;$._geo=z,$.locationmode&&(V=!0);var ne=$.marker;if(ne){var H=ne.angle,N=ne.angleref;(H||N==="north"||N==="previous")&&(Q=!0)}}if(this._hasMarkerAngles=Q,V){var U=b.getTopojsonName(D);z.topojson!==null&&U===z.topojsonName||(z.topojsonName=U,PlotlyGeoAssets.topojson[z.topojsonName]===void 0&&j.push(z.fetchTopojson()))}j=j.concat(_.fetchTraceGeoData(I)),S.push(new Promise(function(te,B){Promise.all(j).then(function(){z.topojson=PlotlyGeoAssets.topojson[z.topojsonName],z.update(I,P),te()}).catch(B)}))},L.fetchTopojson=function(){var I=this,P=b.getTopojsonPath(I.topojsonURL,I.topojsonName);return new Promise(function(S,E){d.json(P,function(z,D){if(z)return z.status===404?E(new Error(["plotly.js could not find topojson file at",P+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):E(new Error(["unexpected error while fetching topojson file at",P].join(" ")));PlotlyGeoAssets.topojson[I.topojsonName]=D,S()})})},L.update=function(I,P,S){var E=P[this.id];this.hasChoropleth=!1;for(var z=0;z<I.length;z++){var D=I[z],j=D[0].trace;j.type==="choropleth"&&(this.hasChoropleth=!0),j.visible===!0&&j._length>0&&j._module.calcGeoJSON(D,P)}if(!S){if(this.updateProjection(I,P))return;this.viewInitial&&this.scope===E.scope||this.saveViewInitial(E)}this.scope=E.scope,this.updateBaseLayers(P,E),this.updateDims(P,E),this.updateFx(P,E),s.generalUpdatePerTraceModule(this.graphDiv,this,I,E);var V=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=V.selectAll(".point"),this.dataPoints.text=V.selectAll("text"),this.dataPaths.line=V.selectAll(".js-line");var Z=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=Z.selectAll("path"),this._render()},L.updateProjection=function(I,P){var S=this.graphDiv,E=P[this.id],z=P._size,D=E.domain,j=E.projection,V=E.lonaxis,Z=E.lataxis,Q=V._ax,K=Z._ax,$=this.projection=function(le){var ge=le.projection,Te=ge.type,Se=f.projNames[Te];Se="geo"+n.titleCase(Se);for(var Me=(v[Se]||e[Se])(),ze=le._isSatellite?180*Math.acos(1/ge.distance)/Math.PI:le._isClipped?f.lonaxisSpan[Te]/2:null,Oe=["center","rotate","parallels","clipExtent"],De=function(Ie){return Ie?Me:[]},Xe=0;Xe<Oe.length;Xe++){var Be=Oe[Xe];typeof Me[Be]!="function"&&(Me[Be]=De)}return Me.isLonLatOverEdges=function(Ie){if(Me(Ie)===null)return!0;if(ze){var Re=Me.rotate();return y(Ie,[-Re[0],-Re[1]])>ze*Math.PI/180}return!1},Me.getPath=function(){return w().projection(Me)},Me.getBounds=function(Ie){return Me.getPath().bounds(Ie)},Me.precision(f.precision),le._isSatellite&&Me.tilt(ge.tilt).distance(ge.distance),ze&&Me.clipAngle(ze-f.clipPad),Me}(E),ne=[[z.l+z.w*D.x[0],z.t+z.h*(1-D.y[1])],[z.l+z.w*D.x[1],z.t+z.h*(1-D.y[0])]],H=E.center||{},N=j.rotation||{},U=V.range||[],te=Z.range||[];if(E.fitbounds){Q._length=ne[1][0]-ne[0][0],K._length=ne[1][1]-ne[0][1],Q.range=l(S,Q),K.range=l(S,K);var B=(Q.range[0]+Q.range[1])/2,X=(K.range[0]+K.range[1])/2;if(E._isScoped)H={lon:B,lat:X};else if(E._isClipped){H={lon:B,lat:X},N={lon:B,lat:X,roll:N.roll};var J=j.type,ee=f.lonaxisSpan[J]/2||180,re=f.lataxisSpan[J]/2||90;U=[B-ee,B+ee],te=[X-re,X+re]}else H={lon:B,lat:X},N={lon:B,lat:N.lat,roll:N.roll}}$.center([H.lon-N.lon,H.lat-N.lat]).rotate([-N.lon,-N.lat,N.roll]).parallels(j.parallels);var se=A(U,te);$.fitExtent(ne,se);var oe=this.bounds=$.getBounds(se),de=this.fitScale=$.scale(),ce=$.translate();if(E.fitbounds){var ve=$.getBounds(A(Q.range,K.range)),Ae=Math.min((oe[1][0]-oe[0][0])/(ve[1][0]-ve[0][0]),(oe[1][1]-oe[0][1])/(ve[1][1]-ve[0][1]));isFinite(Ae)?$.scale(Ae*de):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else $.scale(j.scale*de);var fe=this.midPt=[(oe[0][0]+oe[1][0])/2,(oe[0][1]+oe[1][1])/2];if($.translate([ce[0]+(fe[0]-ce[0]),ce[1]+(fe[1]-ce[1])]).clipExtent(oe),E._isAlbersUsa){var me=$([H.lon,H.lat]),_e=$.translate();$.translate([_e[0]-(me[0]-_e[0]),_e[1]-(me[1]-_e[1])])}},L.updateBaseLayers=function(I,P){var S=this,E=S.topojson,z=S.layers,D=S.basePaths;function j($){return $==="lonaxis"||$==="lataxis"}function V($){return Boolean(f.lineLayers[$])}function Z($){return Boolean(f.fillLayers[$])}var Q=(this.hasChoropleth?f.layersForChoropleth:f.layers).filter(function($){return V($)||Z($)?P["show"+$]:!j($)||P[$].showgrid}),K=S.framework.selectAll(".layer").data(Q,String);K.exit().each(function($){delete z[$],delete D[$],d.select(this).remove()}),K.enter().append("g").attr("class",function($){return"layer "+$}).each(function($){var ne=z[$]=d.select(this);$==="bg"?S.bgRect=ne.append("rect").style("pointer-events","all"):j($)?D[$]=ne.append("path").style("fill","none"):$==="backplot"?ne.append("g").classed("choroplethlayer",!0):$==="frontplot"?ne.append("g").classed("scatterlayer",!0):V($)?D[$]=ne.append("path").style("fill","none").style("stroke-miterlimit",2):Z($)&&(D[$]=ne.append("path").style("stroke","none"))}),K.order(),K.each(function($){var ne=D[$],H=f.layerNameToAdjective[$];$==="frame"?ne.datum(f.sphereSVG):V($)||Z($)?ne.datum(T(E,E.objects[$])):j($)&&ne.datum(function(N,U,te){var B,X,J,ee=U[N],re=f.scopeDefaults[U.scope];N==="lonaxis"?(B=re.lonaxisRange,X=re.lataxisRange,J=function(_e,le){return[_e,le]}):N==="lataxis"&&(B=re.lataxisRange,X=re.lonaxisRange,J=function(_e,le){return[le,_e]});var se={type:"linear",range:[B[0],B[1]-1e-6],tick0:ee.tick0,dtick:ee.dtick};h.setConvert(se,te);var oe=h.calcTicks(se);U.isScoped||N!=="lonaxis"||oe.pop();for(var de=oe.length,ce=new Array(de),ve=0;ve<de;ve++)for(var Ae=oe[ve].x,fe=ce[ve]=[],me=X[0];me<X[1]+2.5;me+=2.5)fe.push(J(Ae,me));return{type:"MultiLineString",coordinates:ce}}($,P,I)).call(r.stroke,P[$].gridcolor).call(g.dashLine,P[$].griddash,P[$].gridwidth),V($)?ne.call(r.stroke,P[H+"color"]).call(g.dashLine,"",P[H+"width"]):Z($)&&ne.call(r.fill,P[H+"color"])})},L.updateDims=function(I,P){var S=this.bounds,E=(P.framewidth||0)/2,z=S[0][0]-E,D=S[0][1]-E,j=S[1][0]-z+E,V=S[1][1]-D+E;g.setRect(this.clipRect,z,D,j,V),this.bgRect.call(g.setRect,z,D,j,V).call(r.fill,P.bgcolor),this.xaxis._offset=z,this.xaxis._length=j,this.yaxis._offset=D,this.yaxis._length=V},L.updateFx=function(I,P){var S=this,E=S.graphDiv,z=S.bgRect,D=I.dragmode,j=I.clickmode;if(!S.isStatic){var V={element:S.bgRect.node(),gd:E,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function(Q,K){K.isRect?(Q.range={})[S.id]=[Z([K.xmin,K.ymin]),Z([K.xmax,K.ymax])]:(Q.lassoPoints={})[S.id]=K.map(Z)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function(Q){Q===2&&c(E)}};D==="pan"?(z.node().onmousedown=null,z.call(x(S,P)),z.on("dblclick.zoom",function(){var Q=S.viewInitial,K={};for(var $ in Q)K[S.id+"."+$]=Q[$];t.call("_guiRelayout",E,K),E.emit("plotly_doubleclick",null)}),E._context._scrollZoom.geo||z.on("wheel.zoom",null)):D!=="select"&&D!=="lasso"||(z.on(".zoom",null),V.prepFn=function(Q,K,$){p(Q,K,$,V,D)},o.init(V)),z.on("mousemove",function(){var Q=S.projection.invert(n.getPositionFromD3Event());if(!Q)return o.unhover(E,d.event);S.xaxis.p2c=function(){return Q[0]},S.yaxis.p2c=function(){return Q[1]},u.hover(E,d.event,S.id)}),z.on("mouseout",function(){E._dragging||o.unhover(E,d.event)}),z.on("click",function(){D!=="select"&&D!=="lasso"&&(j.indexOf("select")>-1&&i(d.event,E,[S.xaxis],[S.yaxis],S.id,V),j.indexOf("event")>-1&&u.click(E,d.event))})}function Z(Q){return S.projection.invert([Q[0]+S.xaxis._offset,Q[1]+S.yaxis._offset])}},L.makeFramework=function(){var I=this,P=I.graphDiv,S=P._fullLayout,E="clip"+S._uid+I.id;I.clipDef=S._clips.append("clipPath").attr("id",E),I.clipRect=I.clipDef.append("rect"),I.framework=d.select(I.container).append("g").attr("class","geo "+I.id).call(g.setClipUrl,E,P),I.project=function(z){var D=I.projection(z);return D?[D[0]-I.xaxis._offset,D[1]-I.yaxis._offset]:[null,null]},I.xaxis={_id:"x",c2p:function(z){return I.project(z)[0]}},I.yaxis={_id:"y",c2p:function(z){return I.project(z)[1]}},I.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(I.mockAxis,S)},L.saveViewInitial=function(I){var P,S=I.center||{},E=I.projection,z=E.rotation||{};this.viewInitial={fitbounds:I.fitbounds,"projection.scale":E.scale},P=I._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:I._isClipped?{"projection.rotation.lon":z.lon,"projection.rotation.lat":z.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":z.lon},n.extendFlat(this.viewInitial,P)},L.render=function(I){this._hasMarkerAngles&&I?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},L._render=function(){var I,P=this.projection,S=P.getPath();function E(D){var j=P(D.lonlat);return j?a(j[0],j[1]):null}function z(D){return P.isLonLatOverEdges(D.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",S);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(D){return S(D.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",z).attr("transform",E)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(m,G,W){var d=m("../../plots/get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("./geo"),y="geo",e=v(y),t={};t.geo={valType:"subplotid",dflt:y,editType:"calc"},G.exports={attr:y,name:y,idRoot:y,idRegex:e,attrRegex:e,attributes:t,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(n){for(var a=n._fullLayout,r=n.calcdata,g=a._subplots.geo,u=0;u<g.length;u++){var s=g[u],h=d(r,y,s),l=a[s]._subplot;l||(l=w({id:s,graphDiv:n,container:a._geolayer.node(),topojsonURL:n._context.topojsonURL,staticPlot:n._context.staticPlot}),a[s]._subplot=l),l.plot(h,a,n._promises)}},updateFx:function(n){for(var a=n._fullLayout,r=a._subplots.geo,g=0;g<r.length;g++){var u=a[r[g]];u._subplot.updateFx(a,u)}},clean:function(n,a,r,g){for(var u=g._subplots.geo||[],s=0;s<u.length;s++){var h=u[s],l=g[h]._subplot;!a[h]&&l&&(l.framework.remove(),l.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(m,G,W){var d=m("../../components/color/attributes"),v=m("../domain").attributes,w=m("../../components/drawing/attributes").dash,y=m("./constants"),e=m("../../plot_api/edit_types").overrideAll,t=m("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:d.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:w};(G.exports=e({domain:v({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:t(y.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:t(y.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:d.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:y.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:y.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:y.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:y.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:d.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:d.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:d.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:d.background},lonaxis:n,lataxis:n},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(m,G,W){var d=m("../../lib"),v=m("../subplot_defaults"),w=m("../get_data").getSubplotData,y=m("./constants"),e=m("./layout_attributes"),t=y.axesNames;function n(a,r,g,u){var s=w(u.fullData,"geo",u.id).map(function(N){return N._expandedIndex}),h=g("resolution"),l=g("scope"),o=y.scopeDefaults[l],p=g("projection.type",o.projType),c=r._isAlbersUsa=p==="albers usa";c&&(l=r.scope="usa");var i=r._isScoped=l!=="world",x=r._isSatellite=p==="satellite",f=r._isConic=p.indexOf("conic")!==-1||p==="albers",_=r._isClipped=!!y.lonaxisSpan[p];if(a.visible===!1){var b=d.extendDeep({},r._template);b.showcoastlines=!1,b.showcountries=!1,b.showframe=!1,b.showlakes=!1,b.showland=!1,b.showocean=!1,b.showrivers=!1,b.showsubunits=!1,b.lonaxis&&(b.lonaxis.showgrid=!1),b.lataxis&&(b.lataxis.showgrid=!1),r._template=b}for(var T=g("visible"),k=0;k<t.length;k++){var L,A=t[k],I=[30,10][k];if(i)L=o[A+"Range"];else{var P=y[A+"Span"],S=(P[p]||P["*"])/2,E=g("projection.rotation."+A.substr(0,3),o.projRotate[k]);L=[E-S,E+S]}var z=g(A+".range",L);g(A+".tick0"),g(A+".dtick",I),g(A+".showgrid",!!T&&void 0)&&(g(A+".gridcolor"),g(A+".gridwidth"),g(A+".griddash")),r[A]._ax={type:"linear",_id:A.slice(0,3),_traceIndices:s,setScale:d.identity,c2l:d.identity,r2l:d.identity,autorange:!0,range:z.slice(),_m:1,_input:{}}}var D=r.lonaxis.range,j=r.lataxis.range,V=D[0],Z=D[1];V>0&&Z<0&&(Z+=360);var Q,K,$,ne=(V+Z)/2;if(!c){var H=i?o.projRotate:[ne,0,0];Q=g("projection.rotation.lon",H[0]),g("projection.rotation.lat",H[1]),g("projection.rotation.roll",H[2]),g("showcoastlines",!i&&T)&&(g("coastlinecolor"),g("coastlinewidth")),g("showocean",!!T&&void 0)&&g("oceancolor")}c?(K=-96.6,$=38.7):(K=i?ne:Q,$=(j[0]+j[1])/2),g("center.lon",K),g("center.lat",$),x&&(g("projection.tilt"),g("projection.distance")),f&&g("projection.parallels",o.projParallels||[0,60]),g("projection.scale"),g("showland",!!T&&void 0)&&g("landcolor"),g("showlakes",!!T&&void 0)&&g("lakecolor"),g("showrivers",!!T&&void 0)&&(g("rivercolor"),g("riverwidth")),g("showcountries",i&&l!=="usa"&&T)&&(g("countrycolor"),g("countrywidth")),(l==="usa"||l==="north america"&&h===50)&&(g("showsubunits",T),g("subunitcolor"),g("subunitwidth")),i||g("showframe",T)&&(g("framecolor"),g("framewidth")),g("bgcolor"),g("fitbounds")&&(delete r.projection.scale,i?(delete r.center.lon,delete r.center.lat):_?(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon,delete r.projection.rotation.lat,delete r.lonaxis.range,delete r.lataxis.range):(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon))}G.exports=function(a,r,g){v(a,r,g,{type:"geo",attributes:e,handleDefaults:n,fullData:g,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../registry"),y=Math.PI/180,e=180/Math.PI,t={cursor:"pointer"},n={cursor:"auto"};function a(T,k){return d.behavior.zoom().translate(k.translate()).scale(k.scale())}function r(T,k,L){var A=T.id,I=T.graphDiv,P=I.layout,S=P[A],E=I._fullLayout,z=E[A],D={},j={};function V(Z,Q){D[A+"."+Z]=v.nestedProperty(S,Z).get(),w.call("_storeDirectGUIEdit",P,E._preGUI,D);var K=v.nestedProperty(z,Z);K.get()!==Q&&(K.set(Q),v.nestedProperty(S,Z).set(Q),j[A+"."+Z]=Q)}L(V),V("projection.scale",k.scale()/T.fitScale),V("fitbounds",!1),I.emit("plotly_relayout",j)}function g(T,k){var L=a(0,k);function A(I){var P=k.invert(T.midPt);I("center.lon",P[0]),I("center.lat",P[1])}return L.on("zoomstart",function(){d.select(this).style(t)}).on("zoom",function(){k.scale(d.event.scale).translate(d.event.translate),T.render(!0);var I=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":I[0],"geo.center.lat":I[1]})}).on("zoomend",function(){d.select(this).style(n),r(T,k,A)}),L}function u(T,k){var L,A,I,P,S,E,z,D,j,V=a(0,k);function Z(K){return k.invert(K)}function Q(K){var $=k.rotate(),ne=k.invert(T.midPt);K("projection.rotation.lon",-$[0]),K("center.lon",ne[0]),K("center.lat",ne[1])}return V.on("zoomstart",function(){d.select(this).style(t),L=d.mouse(this),A=k.rotate(),I=k.translate(),P=A,S=Z(L)}).on("zoom",function(){if(E=d.mouse(this),function(ne){var H=Z(ne);if(!H)return!0;var N=k(H);return Math.abs(N[0]-ne[0])>2||Math.abs(N[1]-ne[1])>2}(L))return V.scale(k.scale()),void V.translate(k.translate());k.scale(d.event.scale),k.translate([I[0],d.event.translate[1]]),S?Z(E)&&(D=Z(E),z=[P[0]+(D[0]-S[0]),A[1],A[2]],k.rotate(z),P=z):S=Z(L=E),j=!0,T.render(!0);var K=k.rotate(),$=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":$[0],"geo.center.lat":$[1],"geo.projection.rotation.lon":-K[0]})}).on("zoomend",function(){d.select(this).style(n),j&&r(T,k,Q)}),V}function s(T,k){var L;k.rotate(),k.scale();var A=a(0,k),I=function(V){for(var Z=0,Q=arguments.length,K=[];++Z<Q;)K.push(arguments[Z]);var $=d.dispatch.apply(null,K);return $.of=function(ne,H){return function(N){var U;try{U=N.sourceEvent=d.event,N.target=V,d.event=N,$[N.type].apply(ne,H)}finally{d.event=U}}},$}(A,"zoomstart","zoom","zoomend"),P=0,S=A.on;function E(V){P++||V({type:"zoomstart"})}function z(V){V({type:"zoom"})}function D(V){--P||V({type:"zoomend"})}function j(V){var Z=k.rotate();V("projection.rotation.lon",-Z[0]),V("projection.rotation.lat",-Z[1])}return A.on("zoomstart",function(){d.select(this).style(t);var V=d.mouse(this),Z=k.rotate(),Q=Z,K=k.translate(),$=l(Z);L=h(k,V),S.call(A,"zoom",function(){var ne=d.mouse(this);if(k.scale(d.event.scale),L){if(h(k,ne)){k.rotate(Z).translate(K);var H=h(k,ne),N=p(L,H),U=_(o($,N)),te=c(U,L,Q);isFinite(te[0])&&isFinite(te[1])&&isFinite(te[2])||(te=Q),k.rotate(te),Q=te}}else L=h(k,V=ne);z(I.of(this,arguments))}),E(I.of(this,arguments))}).on("zoomend",function(){d.select(this).style(n),S.call(A,"zoom",null),D(I.of(this,arguments)),r(T,k,j)}).on("zoom.redraw",function(){T.render(!0);var V=k.rotate();T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.projection.rotation.lon":-V[0],"geo.projection.rotation.lat":-V[1]})}),d.rebind(A,I,"on")}function h(T,k){var L=T.invert(k);return L&&isFinite(L[0])&&isFinite(L[1])&&function(A){var I=A[0]*y,P=A[1]*y,S=Math.cos(P);return[S*Math.cos(I),S*Math.sin(I),Math.sin(P)]}(L)}function l(T){var k=.5*T[0]*y,L=.5*T[1]*y,A=.5*T[2]*y,I=Math.sin(k),P=Math.cos(k),S=Math.sin(L),E=Math.cos(L),z=Math.sin(A),D=Math.cos(A);return[P*E*D+I*S*z,I*E*D-P*S*z,P*S*D+I*E*z,P*E*z-I*S*D]}function o(T,k){var L=T[0],A=T[1],I=T[2],P=T[3],S=k[0],E=k[1],z=k[2],D=k[3];return[L*S-A*E-I*z-P*D,L*E+A*S+I*D-P*z,L*z-A*D+I*S+P*E,L*D+A*z-I*E+P*S]}function p(T,k){if(T&&k){var L=function(S,E){return[S[1]*E[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]]}(T,k),A=Math.sqrt(b(L,L)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(T,k)))),P=Math.sin(I)/A;return A&&[Math.cos(I),L[2]*P,-L[1]*P,L[0]*P]}}function c(T,k,L){var A=f(k,2,T[0]);A=f(A,1,T[1]),A=f(A,0,T[2]-L[2]);var I,P,S=k[0],E=k[1],z=k[2],D=A[0],j=A[1],V=A[2],Z=Math.atan2(E,S)*e,Q=Math.sqrt(S*S+E*E);Math.abs(j)>Q?(P=(j>0?90:-90)-Z,I=0):(P=Math.asin(j/Q)*e-Z,I=Math.sqrt(Q*Q-j*j));var K=180-P-2*Z,$=(Math.atan2(V,D)-Math.atan2(z,I))*e,ne=(Math.atan2(V,D)-Math.atan2(z,-I))*e;return i(L[0],L[1],P,$)<=i(L[0],L[1],K,ne)?[P,$,L[2]]:[K,ne,L[2]]}function i(T,k,L,A){var I=x(L-T),P=x(A-k);return Math.sqrt(I*I+P*P)}function x(T){return(T%360+540)%360-180}function f(T,k,L){var A=L*y,I=T.slice(),P=k===0?1:0,S=k===2?1:2,E=Math.cos(A),z=Math.sin(A);return I[P]=T[P]*E-T[S]*z,I[S]=T[S]*E+T[P]*z,I}function _(T){return[Math.atan2(2*(T[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*e,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*e]}function b(T,k){for(var L=0,A=0,I=T.length;A<I;++A)L+=T[A]*k[A];return L}G.exports=function(T,k){var L=T.projection;return(k._isScoped?g:k._isClipped?s:u)(T,L)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(m,G,W){var d=m("../registry"),v=m("./cartesian/constants").SUBPLOT_PATTERN;W.getSubplotCalcData=function(w,y,e){var t=d.subplotsRegistry[y];if(!t)return[];for(var n=t.attr,a=[],r=0;r<w.length;r++){var g=w[r];g[0].trace[n]===e&&a.push(g)}return a},W.getModuleCalcData=function(w,y){var e,t=[],n=[];if(!(e=typeof y=="string"?d.getModule(y).plot:typeof y=="function"?y:y.plot))return[t,w];for(var a=0;a<w.length;a++){var r=w[a],g=r[0].trace;g.visible===!0&&g._length!==0&&(g._module.plot===e?t.push(r):n.push(r))}return[t,n]},W.getSubplotData=function(w,y,e){if(!d.subplotsRegistry[y])return[];var t,n,a,r=d.subplotsRegistry[y].attr,g=[];if(y==="gl2d"){var u=e.match(v);n="x"+u[1],a="y"+u[2]}for(var s=0;s<w.length;s++)t=w[s],y==="gl2d"&&d.traceIs(t,"gl2d")?t[r[0]]===n&&t[r[1]]===a&&g.push(t):t[r]===e&&g.push(t);return g}},{"../registry":647,"./cartesian/constants":573}],603:[function(m,G,W){var d=m("mouse-change"),v=m("mouse-wheel"),w=m("mouse-event-offset"),y=m("../cartesian/constants"),e=m("has-passive-events");function t(n,a){this.element=n,this.plot=a,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}G.exports=function(n){var a=n.mouseContainer,r=n.glplot,g=new t(a,r);function u(){n.xaxis.autorange=!1,n.yaxis.autorange=!1}function s(h,l,o){var p,c,i=n.calcDataBox(),x=r.viewBox,f=g.lastPos[0],_=g.lastPos[1],b=y.MINDRAG*r.pixelRatio,T=y.MINZOOM*r.pixelRatio;function k(E,z,D){var j=Math.min(z,D),V=Math.max(z,D);j!==V?(i[E]=j,i[E+2]=V,g.dataBox=i,n.setRanges(i)):(n.selectBox.selectBox=[0,0,1,1],n.glplot.setDirty())}switch(l*=r.pixelRatio,o*=r.pixelRatio,o=x[3]-x[1]-o,n.fullLayout.dragmode){case"zoom":if(h){var L=l/(x[2]-x[0])*(i[2]-i[0])+i[0],A=o/(x[3]-x[1])*(i[3]-i[1])+i[1];g.boxInited||(g.boxStart[0]=L,g.boxStart[1]=A,g.dragStart[0]=l,g.dragStart[1]=o),g.boxEnd[0]=L,g.boxEnd[1]=A,g.boxInited=!0,g.boxEnabled||g.boxStart[0]===g.boxEnd[0]&&g.boxStart[1]===g.boxEnd[1]||(g.boxEnabled=!0);var I=Math.abs(g.dragStart[0]-l)<T,P=Math.abs(g.dragStart[1]-o)<T;if(!function(){for(var E=n.graphDiv._fullLayout._axisConstraintGroups,z=n.xaxis._id,D=n.yaxis._id,j=0;j<E.length;j++)if(E[j][z]!==-1){if(E[j][D]!==-1)return!0;break}return!1}()||I&&P)I&&(g.boxEnd[0]=g.boxStart[0]),P&&(g.boxEnd[1]=g.boxStart[1]);else{p=g.boxEnd[0]-g.boxStart[0],c=g.boxEnd[1]-g.boxStart[1];var S=(i[3]-i[1])/(i[2]-i[0]);Math.abs(p*S)>Math.abs(c)?(g.boxEnd[1]=g.boxStart[1]+Math.abs(p)*S*(c>=0?1:-1),g.boxEnd[1]<i[1]?(g.boxEnd[1]=i[1],g.boxEnd[0]=g.boxStart[0]+(i[1]-g.boxStart[1])/Math.abs(S)):g.boxEnd[1]>i[3]&&(g.boxEnd[1]=i[3],g.boxEnd[0]=g.boxStart[0]+(i[3]-g.boxStart[1])/Math.abs(S))):(g.boxEnd[0]=g.boxStart[0]+Math.abs(c)/S*(p>=0?1:-1),g.boxEnd[0]<i[0]?(g.boxEnd[0]=i[0],g.boxEnd[1]=g.boxStart[1]+(i[0]-g.boxStart[0])*Math.abs(S)):g.boxEnd[0]>i[2]&&(g.boxEnd[0]=i[2],g.boxEnd[1]=g.boxStart[1]+(i[2]-g.boxStart[0])*Math.abs(S)))}}else g.boxEnabled?(p=g.boxStart[0]!==g.boxEnd[0],c=g.boxStart[1]!==g.boxEnd[1],p||c?(p&&(k(0,g.boxStart[0],g.boxEnd[0]),n.xaxis.autorange=!1),c&&(k(1,g.boxStart[1],g.boxEnd[1]),n.yaxis.autorange=!1),n.relayoutCallback()):n.glplot.setDirty(),g.boxEnabled=!1,g.boxInited=!1):g.boxInited&&(g.boxInited=!1);break;case"pan":g.boxEnabled=!1,g.boxInited=!1,h?(g.panning||(g.dragStart[0]=l,g.dragStart[1]=o),Math.abs(g.dragStart[0]-l)<b&&(l=g.dragStart[0]),Math.abs(g.dragStart[1]-o)<b&&(o=g.dragStart[1]),p=(f-l)*(i[2]-i[0])/(r.viewBox[2]-r.viewBox[0]),c=(_-o)*(i[3]-i[1])/(r.viewBox[3]-r.viewBox[1]),i[0]+=p,i[2]+=p,i[1]+=c,i[3]+=c,n.setRanges(i),g.panning=!0,g.lastInputTime=Date.now(),u(),n.cameraChanged(),n.handleAnnotations()):g.panning&&(g.panning=!1,n.relayoutCallback())}g.lastPos[0]=l,g.lastPos[1]=o}return g.mouseListener=d(a,s),a.addEventListener("touchstart",function(h){var l=w(h.changedTouches[0],a);s(0,l[0],l[1]),s(1,l[0],l[1]),h.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchmove",function(h){h.preventDefault();var l=w(h.changedTouches[0],a);s(1,l[0],l[1]),h.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchend",function(h){s(0,g.lastPos[0],g.lastPos[1]),h.preventDefault()},!!e&&{passive:!1}),g.wheelListener=v(a,function(h,l){if(!n.scrollZoom)return!1;var o=n.calcDataBox(),p=r.viewBox,c=g.lastPos[0],i=g.lastPos[1],x=Math.exp(5*l/(p[3]-p[1])),f=c/(p[2]-p[0])*(o[2]-o[0])+o[0],_=i/(p[3]-p[1])*(o[3]-o[1])+o[1];return o[0]=(o[0]-f)*x+f,o[2]=(o[2]-f)*x+f,o[1]=(o[1]-_)*x+_,o[3]=(o[3]-_)*x+_,n.setRanges(o),g.lastInputTime=Date.now(),u(),n.cameraChanged(),n.handleAnnotations(),n.relayoutCallback(),!0},!0),g}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(m,G,W){var d=m("../cartesian/axes"),v=m("../../lib/str2rgbarray");function w(t){this.scene=t,this.gl=t.gl,this.pixelRatio=t.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var y=w.prototype,e=["xaxis","yaxis"];y.merge=function(t){var n,a,r,g,u,s,h,l,o,p,c;for(this.titleEnable=!1,this.backgroundColor=v(t.plot_bgcolor),p=0;p<2;++p){var i=(n=e[p]).charAt(0);for(r=(a=t[this.scene[n]._name]).title.text===this.scene.fullLayout._dfltTitle[i]?"":a.title.text,c=0;c<=2;c+=2)this.labelEnable[p+c]=!1,this.labels[p+c]=r,this.labelColor[p+c]=v(a.title.font.color),this.labelFont[p+c]=a.title.font.family,this.labelSize[p+c]=a.title.font.size,this.labelPad[p+c]=this.getLabelPad(n,a),this.tickEnable[p+c]=!1,this.tickColor[p+c]=v((a.tickfont||{}).color),this.tickAngle[p+c]=a.tickangle==="auto"?0:Math.PI*-a.tickangle/180,this.tickPad[p+c]=this.getTickPad(a),this.tickMarkLength[p+c]=0,this.tickMarkWidth[p+c]=a.tickwidth||0,this.tickMarkColor[p+c]=v(a.tickcolor),this.borderLineEnable[p+c]=!1,this.borderLineColor[p+c]=v(a.linecolor),this.borderLineWidth[p+c]=a.linewidth||0;h=this.hasSharedAxis(a),u=this.hasAxisInDfltPos(n,a)&&!h,s=this.hasAxisInAltrPos(n,a)&&!h,g=a.mirror||!1,l=h?String(g).indexOf("all")!==-1:!!g,o=h?g==="allticks":String(g).indexOf("ticks")!==-1,u?this.labelEnable[p]=!0:s&&(this.labelEnable[p+2]=!0),u?this.tickEnable[p]=a.showticklabels:s&&(this.tickEnable[p+2]=a.showticklabels),(u||l)&&(this.borderLineEnable[p]=a.showline),(s||l)&&(this.borderLineEnable[p+2]=a.showline),(u||o)&&(this.tickMarkLength[p]=this.getTickMarkLength(a)),(s||o)&&(this.tickMarkLength[p+2]=this.getTickMarkLength(a)),this.gridLineEnable[p]=a.showgrid,this.gridLineColor[p]=v(a.gridcolor),this.gridLineWidth[p]=a.gridwidth,this.zeroLineEnable[p]=a.zeroline,this.zeroLineColor[p]=v(a.zerolinecolor),this.zeroLineWidth[p]=a.zerolinewidth}},y.hasSharedAxis=function(t){var n=this.scene,a=n.fullLayout._subplots.gl2d;return d.findSubplotsWithAxis(a,t).indexOf(n.id)!==0},y.hasAxisInDfltPos=function(t,n){var a=n.side;return t==="xaxis"?a==="bottom":t==="yaxis"?a==="left":void 0},y.hasAxisInAltrPos=function(t,n){var a=n.side;return t==="xaxis"?a==="top":t==="yaxis"?a==="right":void 0},y.getLabelPad=function(t,n){var a=n.title.font.size,r=n.showticklabels;return t==="xaxis"?n.side==="top"?a*(1.5+(r?1:0))-10:a*(1.5+(r?.5:0))-10:t==="yaxis"?n.side==="right"?10+a*(1.5+(r?1:.5)):10+a*(1.5+(r?.5:0)):void 0},y.getTickPad=function(t){return t.ticks==="outside"?10+t.ticklen:15},y.getTickMarkLength=function(t){if(!t.ticks)return 0;var n=t.ticklen;return t.ticks==="inside"?-n:n},G.exports=function(t){return new w(t)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(m,G,W){var d=m("../../plot_api/edit_types").overrideAll,v=m("./scene2d"),w=m("../layout_attributes"),y=m("../../constants/xmlns_namespaces"),e=m("../cartesian/constants"),t=m("../cartesian"),n=m("../../components/fx/layout_attributes"),a=m("../get_data").getSubplotData;W.name="gl2d",W.attr=["xaxis","yaxis"],W.idRoot=["x","y"],W.idRegex=e.idRegex,W.attrRegex=e.attrRegex,W.attributes=m("../cartesian/attributes"),W.supplyLayoutDefaults=function(r,g,u){g._has("cartesian")||t.supplyLayoutDefaults(r,g,u)},W.layoutAttrOverrides=d(t.layoutAttributes,"plot","from-root"),W.baseLayoutAttrOverrides=d({plot_bgcolor:w.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),W.plot=function(r){for(var g=r._fullLayout,u=r._fullData,s=g._subplots.gl2d,h=0;h<s.length;h++){var l=s[h],o=g._plots[l],p=a(u,"gl2d",l),c=o._scene2d;c===void 0&&(c=new v({id:l,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio},g),o._scene2d=c),c.plot(p,r.calcdata,g,r.layout)}},W.clean=function(r,g,u,s){for(var h=s._subplots.gl2d||[],l=0;l<h.length;l++){var o=h[l],p=s._plots[o];if(p._scene2d){var c=a(r,"gl2d",o);c.length===0&&(p._scene2d.destroy(),delete s._plots[o])}}t.clean.apply(this,arguments)},W.drawFramework=function(r){r._context.staticPlot||t.drawFramework(r)},W.toSVG=function(r){for(var g=r._fullLayout,u=g._subplots.gl2d,s=0;s<u.length;s++){var h=g._plots[u[s]]._scene2d,l=h.toImage("png");g._glimages.append("svg:image").attr({xmlns:y.svg,"xlink:href":l,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),h.destroy()}},W.updateFx=function(r){for(var g=r._fullLayout,u=g._subplots.gl2d,s=0;s<u.length;s++)g._plots[u[s]]._scene2d.updateFx(g.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(m,G,W){var d,v,w=m("../../registry"),y=m("../../plots/cartesian/axes"),e=m("../../components/fx"),t=m("../../../stackgl_modules").gl_plot2d,n=m("../../../stackgl_modules").gl_spikes2d,a=m("../../../stackgl_modules").gl_select_box,r=m("webgl-context"),g=m("./convert"),u=m("./camera"),s=m("../../lib/show_no_webgl_msg"),h=m("../cartesian/constraints"),l=h.enforce,o=h.clean,p=m("../cartesian/autorange").doAutoRange,c=m("../../components/dragelement/helpers"),i=c.drawMode,x=c.selectMode,f=["xaxis","yaxis"],_=m("../cartesian/constants").SUBPLOT_PATTERN;function b(k,L){this.container=k.container,this.graphDiv=k.graphDiv,this.pixelRatio=k.plotGlPixelRatio||window.devicePixelRatio,this.id=k.id,this.staticPlot=!!k.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=g(this),this.glplotOptions.merge(L),this.glplot=t(this.glplotOptions),this.camera=u(this),this.traces={},this.spikes=n(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}G.exports=b;var T=b.prototype;T.makeFramework=function(){if(this.staticPlot){if(!(v||(d=document.createElement("canvas"),v=r({canvas:d,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=d,this.gl=v}else{var k=this.container.querySelector(".gl-canvas-focus"),L=r({canvas:k,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return s(this),void(this.stopped=!0);this.canvas=k,this.gl=L}var A=this.canvas;A.style.width="100%",A.style.height="100%",A.style.position="absolute",A.style.top="0px",A.style.left="0px",A.style["pointer-events"]="none",this.updateSize(A);var I=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(I),S.appendChild(P);var E=this;P.addEventListener("mouseout",function(){E.isMouseOver=!1,E.unhover()}),P.addEventListener("mouseover",function(){E.isMouseOver=!0})},T.toImage=function(k){k||(k="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(d),this.updateSize(this.canvas);var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P);for(var S=0,E=I-1;S<E;++S,--E)for(var z=0;z<A;++z)for(var D=0;D<4;++D){var j=P[4*(A*S+z)+D];P[4*(A*S+z)+D]=P[4*(A*E+z)+D],P[4*(A*E+z)+D]=j}var V=document.createElement("canvas");V.width=A,V.height=I;var Z,Q=V.getContext("2d",{willReadFrequently:!0}),K=Q.createImageData(A,I);switch(K.data.set(P),Q.putImageData(K,0,0),k){case"jpeg":Z=V.toDataURL("image/jpeg");break;case"webp":Z=V.toDataURL("image/webp");break;default:Z=V.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(d),Z},T.updateSize=function(k){k||(k=this.canvas);var L=this.pixelRatio,A=this.fullLayout,I=A.width,P=A.height,S=0|Math.ceil(L*I),E=0|Math.ceil(L*P);return k.width===S&&k.height===E||(k.width=S,k.height=E),k},T.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var k=[y.calcTicks(this.xaxis),y.calcTicks(this.yaxis)],L=0;L<2;++L)for(var A=0;A<k[L].length;++A)k[L][A].text=k[L][A].text+"";return k},T.updateRefs=function(k){this.fullLayout=k;var L=this.id.match(_),A="xaxis"+L[1],I="yaxis"+L[2];this.xaxis=this.fullLayout[A],this.yaxis=this.fullLayout[I]},T.relayoutCallback=function(){var k=this.graphDiv,L=this.xaxis,A=this.yaxis,I=k.layout,P={},S=P[L._name+".range"]=L.range.slice(),E=P[A._name+".range"]=A.range.slice();P[L._name+".autorange"]=L.autorange,P[A._name+".autorange"]=A.autorange,w.call("_storeDirectGUIEdit",k.layout,k._fullLayout._preGUI,P);var z=I[L._name];z.range=S,z.autorange=L.autorange;var D=I[A._name];D.range=E,D.autorange=A.autorange,P.lastInputTime=this.camera.lastInputTime,k.emit("plotly_relayout",P)},T.cameraChanged=function(){var k=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(A,I){for(var P=0;P<2;++P){var S=A[P],E=I[P];if(S.length!==E.length)return!0;for(var z=0;z<S.length;++z)if(S[z].x!==E[z].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=k.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},T.handleAnnotations=function(){for(var k=this.graphDiv,L=this.fullLayout.annotations,A=0;A<L.length;A++){var I=L[A];I.xref===this.xaxis._id&&I.yref===this.yaxis._id&&w.getComponentMethod("annotations","drawOne")(k,A)}},T.destroy=function(){if(this.glplot){var k=this.traces;k&&Object.keys(k).map(function(L){k[L].dispose(),delete k[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},T.plot=function(k,L,A){var I=this.glplot;this.updateRefs(A),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(k,L),this.updateFx(A.dragmode);var P=A.width,S=A.height;this.updateSize(this.canvas);var E=this.glplotOptions;E.merge(A),E.screenBox=[0,0,P,S];var z={_fullLayout:{_axisConstraintGroups:A._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:A._size}};o(z,this.xaxis),o(z,this.yaxis);var D,j,V=A._size,Z=this.xaxis.domain,Q=this.yaxis.domain;for(E.viewBox=[V.l+Z[0]*V.w,V.b+Q[0]*V.h,P-V.r-(1-Z[1])*V.w,S-V.t-(1-Q[1])*V.h],this.mouseContainer.style.width=V.w*(Z[1]-Z[0])+"px",this.mouseContainer.style.height=V.h*(Q[1]-Q[0])+"px",this.mouseContainer.height=V.h*(Q[1]-Q[0]),this.mouseContainer.style.left=V.l+Z[0]*V.w+"px",this.mouseContainer.style.top=V.t+(1-Q[1])*V.h+"px",j=0;j<2;++j)(D=this[f[j]])._length=E.viewBox[j+2]-E.viewBox[j],p(this.graphDiv,D),D.setScale();l(z),E.ticks=this.computeTickMarks(),E.dataBox=this.calcDataBox(),E.merge(A),I.update(E),this.glplot.draw()},T.calcDataBox=function(){var k=this.xaxis,L=this.yaxis,A=k.range,I=L.range,P=k.r2l,S=L.r2l;return[P(A[0]),S(I[0]),P(A[1]),S(I[1])]},T.setRanges=function(k){var L=this.xaxis,A=this.yaxis,I=L.l2r,P=A.l2r;L.range=[I(k[0]),I(k[2])],A.range=[P(k[1]),P(k[3])]},T.updateTraces=function(k,L){var A,I,P,S=Object.keys(this.traces);this.fullData=k;e:for(A=0;A<S.length;A++){var E=S[A],z=this.traces[E];for(I=0;I<k.length;I++)if((P=k[I]).uid===E&&P.type===z.type)continue e;z.dispose(),delete this.traces[E]}for(A=0;A<k.length;A++){P=k[A];var D=L[A],j=this.traces[P.uid];j?j.update(P,D):(j=P._module.plot(this,P,D),this.traces[P.uid]=j)}this.glplot.objects.sort(function(V,Z){return V._trace.index-Z._trace.index})},T.updateFx=function(k){x(k)||i(k)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=k==="pan"?"move":k==="zoom"?"crosshair":null},T.emitPointAction=function(k,L){for(var A,I=k.trace.uid,P=k.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===I&&(A=this.fullData[S]);var E={x:k.traceCoord[0],y:k.traceCoord[1],curveNumber:A.index,pointNumber:P,data:A._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(E,A,P),this.graphDiv.emit(L,{points:[E]})},T.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var k=this.glplot,L=this.camera,A=L.mouseListener,I=this.lastButtonState===1&&A.buttons===0,P=this.fullLayout;this.lastButtonState=A.buttons,this.cameraChanged();var S,E=A.x*k.pixelRatio,z=this.canvas.height-k.pixelRatio*A.y;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var D=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],j=0;j<2;j++)L.boxStart[j]===L.boxEnd[j]&&(D[j]=k.dataBox[j],D[j+2]=k.dataBox[j+2]);k.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var V=P._size,Z=this.xaxis.domain,Q=this.yaxis.domain,K=(S=k.pick(E/k.pixelRatio+V.l+Z[0]*V.w,z/k.pixelRatio-(V.t+(1-Q[1])*V.h)))&&S.object._trace.handlePick(S);if(K&&I&&this.emitPointAction(K,"plotly_click"),S&&S.object._trace.hoverinfo!=="skip"&&P.hovermode&&K&&(!this.lastPickResult||this.lastPickResult.traceUid!==K.trace.uid||this.lastPickResult.dataCoord[0]!==K.dataCoord[0]||this.lastPickResult.dataCoord[1]!==K.dataCoord[1])){var $=K;this.lastPickResult={traceUid:K.trace?K.trace.uid:null,dataCoord:K.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),$.screenCoord=[((k.viewBox[2]-k.viewBox[0])*(S.dataCoord[0]-k.dataBox[0])/(k.dataBox[2]-k.dataBox[0])+k.viewBox[0])/k.pixelRatio,(this.canvas.height-(k.viewBox[3]-k.viewBox[1])*(S.dataCoord[1]-k.dataBox[1])/(k.dataBox[3]-k.dataBox[1])-k.viewBox[1])/k.pixelRatio],this.emitPointAction(K,"plotly_hover");var ne=this.fullData[$.trace.index]||{},H=$.pointIndex,N=e.castHoverinfo(ne,P,H);if(N&&N!=="all"){var U=N.split("+");U.indexOf("x")===-1&&($.traceCoord[0]=void 0),U.indexOf("y")===-1&&($.traceCoord[1]=void 0),U.indexOf("z")===-1&&($.traceCoord[2]=void 0),U.indexOf("text")===-1&&($.textLabel=void 0),U.indexOf("name")===-1&&($.name=void 0)}e.loneHover({x:$.screenCoord[0],y:$.screenCoord[1],xLabel:this.hoverFormatter("xaxis",$.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",$.traceCoord[1]),zLabel:$.traceCoord[2],text:$.textLabel,name:$.name,color:e.castHoverOption(ne,H,"bgcolor")||$.color,borderColor:e.castHoverOption(ne,H,"bordercolor"),fontFamily:e.castHoverOption(ne,H,"font.family"),fontSize:e.castHoverOption(ne,H,"font.size"),fontColor:e.castHoverOption(ne,H,"font.color"),nameLength:e.castHoverOption(ne,H,"namelength"),textAlign:e.castHoverOption(ne,H,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),k.draw()}},T.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},T.hoverFormatter=function(k,L){if(L!==void 0){var A=this[k];return y.tickText(A,A.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(m,G,W){var d=m("../../plot_api/edit_types").overrideAll,v=m("../../components/fx/layout_attributes"),w=m("./scene"),y=m("../get_data").getSubplotData,e=m("../../lib"),t=m("../../constants/xmlns_namespaces");W.name="gl3d",W.attr="scene",W.idRoot="scene",W.idRegex=W.attrRegex=e.counterRegex("scene"),W.attributes=m("./layout/attributes"),W.layoutAttributes=m("./layout/layout_attributes"),W.baseLayoutAttrOverrides=d({hoverlabel:v.hoverlabel},"plot","nested"),W.supplyLayoutDefaults=m("./layout/defaults"),W.plot=function(n){for(var a=n._fullLayout,r=n._fullData,g=a._subplots.gl3d,u=0;u<g.length;u++){var s=g[u],h=y(r,"gl3d",s),l=a[s],o=l.camera,p=l._scene;p||(p=new w({id:s,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio,camera:o},a),l._scene=p),p.viewInitial||(p.viewInitial={up:{x:o.up.x,y:o.up.y,z:o.up.z},eye:{x:o.eye.x,y:o.eye.y,z:o.eye.z},center:{x:o.center.x,y:o.center.y,z:o.center.z}}),p.plot(h,a,n.layout)}},W.clean=function(n,a,r,g){for(var u=g._subplots.gl3d||[],s=0;s<u.length;s++){var h=u[s];!a[h]&&g[h]._scene&&(g[h]._scene.destroy(),g._infolayer&&g._infolayer.selectAll(".annotation-"+h).remove())}},W.toSVG=function(n){for(var a=n._fullLayout,r=a._subplots.gl3d,g=a._size,u=0;u<r.length;u++){var s=a[r[u]],h=s.domain,l=s._scene,o=l.toImage("png");a._glimages.append("svg:image").attr({xmlns:t.svg,"xlink:href":o,x:g.l+g.w*h.x[0],y:g.t+g.h*(1-h.y[1]),width:g.w*(h.x[1]-h.x[0]),height:g.h*(h.y[1]-h.y[0]),preserveAspectRatio:"none"}),l.destroy()}},W.cleanId=function(n){if(n.match(/^scene[0-9]*$/)){var a=n.substr(5);return a==="1"&&(a=""),"scene"+a}},W.updateFx=function(n){for(var a=n._fullLayout,r=a._subplots.gl3d,g=0;g<r.length;g++)a[r[g]]._scene.updateFx(a.dragmode,a.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(m,G,W){G.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(m,G,W){var d=m("../../../components/color"),v=m("../../cartesian/layout_attributes"),w=m("../../../lib/extend").extendFlat,y=m("../../../plot_api/edit_types").overrideAll;G.exports=y({visible:v.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:d.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:v.color,categoryorder:v.categoryorder,categoryarray:v.categoryarray,title:{text:v.title.text,font:v.title.font},type:w({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:v.autorange,rangemode:v.rangemode,range:w({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,mirror:v.mirror,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,showticklabels:v.showticklabels,tickfont:v.tickfont,tickangle:v.tickangle,tickprefix:v.tickprefix,showtickprefix:v.showtickprefix,ticksuffix:v.ticksuffix,showticksuffix:v.showticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickformat:v.tickformat,tickformatstops:v.tickformatstops,hoverformat:v.hoverformat,showline:v.showline,linecolor:v.linecolor,linewidth:v.linewidth,showgrid:v.showgrid,gridcolor:w({},v.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:v.gridwidth,zeroline:v.zeroline,zerolinecolor:v.zerolinecolor,zerolinewidth:v.zerolinewidth,_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(m,G,W){var d=m("tinycolor2").mix,v=m("../../../lib"),w=m("../../../plot_api/plot_template"),y=m("./axis_attributes"),e=m("../../cartesian/type_defaults"),t=m("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"];G.exports=function(a,r,g){var u,s;function h(p,c){return v.coerce(u,s,y,p,c)}for(var l=0;l<n.length;l++){var o=n[l];u=a[o]||{},(s=w.newContainer(r,o))._id=o[0]+g.scene,s._name=o,e(u,s,h,g),t(u,s,h,{font:g.font,letter:o[0],data:g.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:g.bgColor,calendar:g.calendar},g.fullLayout),h("gridcolor",d(s.color,g.bgColor,13600/187).toRgbString()),h("title.text",o[0]),s.setScale=v.noop,h("showspikes")&&(h("spikesides"),h("spikethickness"),h("spikecolor",s.color)),h("showaxeslabels"),h("showbackground")&&h("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(m,G,W){var d=m("../../../lib/str2rgbarray"),v=m("../../../lib"),w=["xaxis","yaxis","zaxis"];function y(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}y.prototype.merge=function(e,t){for(var n=0;n<3;++n){var a=t[w[n]];a.visible?(this.labels[n]=e._meta?v.templateString(a.title.text,e._meta):a.title.text,"font"in a.title&&(a.title.font.color&&(this.labelColor[n]=d(a.title.font.color)),a.title.font.family&&(this.labelFont[n]=a.title.font.family),a.title.font.size&&(this.labelSize[n]=a.title.font.size)),"showline"in a&&(this.lineEnable[n]=a.showline),"linecolor"in a&&(this.lineColor[n]=d(a.linecolor)),"linewidth"in a&&(this.lineWidth[n]=a.linewidth),"showgrid"in a&&(this.gridEnable[n]=a.showgrid),"gridcolor"in a&&(this.gridColor[n]=d(a.gridcolor)),"gridwidth"in a&&(this.gridWidth[n]=a.gridwidth),a.type==="log"?this.zeroEnable[n]=!1:"zeroline"in a&&(this.zeroEnable[n]=a.zeroline),"zerolinecolor"in a&&(this.zeroLineColor[n]=d(a.zerolinecolor)),"zerolinewidth"in a&&(this.zeroLineWidth[n]=a.zerolinewidth),"ticks"in a&&a.ticks?this.lineTickEnable[n]=!0:this.lineTickEnable[n]=!1,"ticklen"in a&&(this.lineTickLength[n]=this._defaultLineTickLength[n]=a.ticklen),"tickcolor"in a&&(this.lineTickColor[n]=d(a.tickcolor)),"tickwidth"in a&&(this.lineTickWidth[n]=a.tickwidth),"tickangle"in a&&(this.tickAngle[n]=a.tickangle==="auto"?-3600:Math.PI*-a.tickangle/180),"showticklabels"in a&&(this.tickEnable[n]=a.showticklabels),"tickfont"in a&&(a.tickfont.color&&(this.tickColor[n]=d(a.tickfont.color)),a.tickfont.family&&(this.tickFont[n]=a.tickfont.family),a.tickfont.size&&(this.tickSize[n]=a.tickfont.size)),"mirror"in a?["ticks","all","allticks"].indexOf(a.mirror)!==-1?(this.lineTickMirror[n]=!0,this.lineMirror[n]=!0):a.mirror===!0?(this.lineTickMirror[n]=!1,this.lineMirror[n]=!0):(this.lineTickMirror[n]=!1,this.lineMirror[n]=!1):this.lineMirror[n]=!1,"showbackground"in a&&a.showbackground!==!1?(this.backgroundEnable[n]=!0,this.backgroundColor[n]=d(a.backgroundcolor)):this.backgroundEnable[n]=!1):(this.tickEnable[n]=!1,this.labelEnable[n]=!1,this.lineEnable[n]=!1,this.lineTickEnable[n]=!1,this.gridEnable[n]=!1,this.zeroEnable[n]=!1,this.backgroundEnable[n]=!1)}},G.exports=function(e,t){var n=new y;return n.merge(e,t),n}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(m,G,W){var d=m("../../../lib"),v=m("../../../components/color"),w=m("../../../registry"),y=m("../../subplot_defaults"),e=m("./axis_defaults"),t=m("./layout_attributes"),n=m("../../get_data").getSubplotData;function a(r,g,u,s){for(var h=u("bgcolor"),l=v.combine(h,s.paper_bgcolor),o=["up","center","eye"],p=0;p<o.length;p++)u("camera."+o[p]+".x"),u("camera."+o[p]+".y"),u("camera."+o[p]+".z");u("camera.projection.type");var c=!!u("aspectratio.x")&&!!u("aspectratio.y")&&!!u("aspectratio.z"),i=u("aspectmode",c?"manual":"auto");c||(r.aspectratio=g.aspectratio={x:1,y:1,z:1},i==="manual"&&(g.aspectmode="auto"),r.aspectmode=g.aspectmode);var x=n(s.fullData,"gl3d",s.id);e(r,g,{font:s.font,scene:s.id,data:x,bgColor:l,calendar:s.calendar,autotypenumbersDflt:s.autotypenumbersDflt,fullLayout:s.fullLayout}),w.getComponentMethod("annotations3d","handleDefaults")(r,g,s);var f=s.getDfltFromLayout("dragmode");if(f!==!1&&!f)if(f="orbit",r.camera&&r.camera.up){var _=r.camera.up.x,b=r.camera.up.y,T=r.camera.up.z;T!==0&&(_&&b&&T?T/Math.sqrt(_*_+b*b+T*T)>.999&&(f="turntable"):f="turntable")}else f="turntable";u("dragmode",f),u("hovermode",s.getDfltFromLayout("hovermode"))}G.exports=function(r,g,u){var s=g._basePlotModules.length>1;y(r,g,u,{type:"gl3d",attributes:t,handleDefaults:a,fullLayout:g,font:g.font,fullData:u,getDfltFromLayout:function(h){if(!s)return d.validate(r[h],t[h])?r[h]:void 0},autotypenumbersDflt:g.autotypenumbers,paper_bgcolor:g.paper_bgcolor,calendar:g.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(m,G,W){var d=m("./axis_attributes"),v=m("../../domain").attributes,w=m("../../../lib/extend").extendFlat,y=m("../../../lib").counterRegex;function e(t,n,a){return{x:{valType:"number",dflt:t,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}G.exports={_arrayAttrRegexps:[y("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:w(e(0,0,1),{}),center:w(e(0,0,0),{}),eye:w(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:v({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:d,yaxis:d,zaxis:d,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(m,G,W){var d=m("../../../lib/str2rgbarray"),v=["xaxis","yaxis","zaxis"];function w(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}w.prototype.merge=function(y){for(var e=0;e<3;++e){var t=y[v[e]];t.visible?(this.enabled[e]=t.showspikes,this.colors[e]=d(t.spikecolor),this.drawSides[e]=t.spikesides,this.lineWidth[e]=t.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},G.exports=function(y){var e=new w;return e.merge(y),e}},{"../../../lib/str2rgbarray":540}],615:[function(m,G,W){G.exports=function(e){for(var t=e.axesOptions,n=e.glplot.axesPixels,a=e.fullSceneLayout,r=[[],[],[]],g=0;g<3;++g){var u=a[w[g]];if(u._length=(n[g].hi-n[g].lo)*n[g].pixelsPerDataUnit/e.dataScale[g],Math.abs(u._length)===1/0||isNaN(u._length))r[g]=[];else{u._input_range=u.range.slice(),u.range[0]=n[g].lo/e.dataScale[g],u.range[1]=n[g].hi/e.dataScale[g],u._m=1/(e.dataScale[g]*n[g].pixelsPerDataUnit),u.range[0]===u.range[1]&&(u.range[0]-=1,u.range[1]+=1);var s=u.tickmode;if(u.tickmode==="auto"){u.tickmode="linear";var h=u.nticks||v.constrain(u._length/40,4,9);d.autoTicks(u,Math.abs(u.range[1]-u.range[0])/h)}for(var l=d.calcTicks(u,{msUTC:!0}),o=0;o<l.length;++o)l[o].x=l[o].x*e.dataScale[g],u.type==="date"&&(l[o].text=l[o].text.replace(/\<br\>/g," "));r[g]=l,u.tickmode=s}}for(t.ticks=r,g=0;g<3;++g)for(y[g]=.5*(e.glplot.bounds[0][g]+e.glplot.bounds[1][g]),o=0;o<2;++o)t.bounds[o][g]=e.glplot.bounds[o][g];e.contourLevels=function(p){for(var c=new Array(3),i=0;i<3;++i){for(var x=p[i],f=new Array(x.length),_=0;_<x.length;++_)f[_]=x[_].x;c[i]=f}return c}(r)};var d=m("../../cartesian/axes"),v=m("../../../lib"),w=["xaxis","yaxis","zaxis"],y=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(m,G,W){function d(v,w){var y,e,t=[0,0,0,0];for(y=0;y<4;++y)for(e=0;e<4;++e)t[e]+=v[4*y+e]*w[y];return t}G.exports=function(v,w){return d(v.projection,d(v.view,d(v.model,[w[0],w[1],w[2],1])))}},{}],617:[function(m,G,W){var d,v,w=m("../../../stackgl_modules").gl_plot3d,y=w.createCamera,e=w.createScene,t=m("webgl-context"),n=m("has-passive-events"),a=m("../../registry"),r=m("../../lib"),g=r.preserveDrawingBuffer(),u=m("../../plots/cartesian/axes"),s=m("../../components/fx"),h=m("../../lib/str2rgbarray"),l=m("../../lib/show_no_webgl_msg"),o=m("./project"),p=m("./layout/convert"),c=m("./layout/spikes"),i=m("./layout/tick_marks");function x(k,L){var A=document.createElement("div"),I=k.container;this.graphDiv=k.graphDiv;var P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none",A.appendChild(P),this.svgContainer=P,A.id=k.id,A.style.position="absolute",A.style.top=A.style.left="0px",A.style.width=A.style.height="100%",I.appendChild(A),this.fullLayout=L,this.id=k.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(L,L[this.id]),this.spikeOptions=c(L[this.id]),this.container=A,this.staticMode=!!k.staticPlot,this.pixelRatio=this.pixelRatio||k.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var f=x.prototype;f.prepareOptions=function(){var k={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:g,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(v||(d=document.createElement("canvas"),v=t({canvas:d,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");k.gl=v,k.canvas=d}return k};var _=!0;f.tryCreatePlot=function(){var k=this.prepareOptions(),L=!0;try{this.glplot=e(k)}catch{if(this.staticMode||!_||g)L=!1;else{r.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{g=k.glOptions.preserveDrawingBuffer=!0,this.glplot=e(k)}catch{g=k.glOptions.preserveDrawingBuffer=!1,L=!1}}}return _=!1,L},f.initializeGLCamera=function(){var k=this.fullSceneLayout.camera,L=k.projection.type==="orthographic";this.camera=y(this.container,{center:[k.center.x,k.center.y,k.center.z],eye:[k.eye.x,k.eye.y,k.eye.z],up:[k.up.x,k.up.y,k.up.z],_ortho:L,zoomMin:.01,zoomMax:100,mode:"orbit"})},f.initializeGLPlot=function(){var k=this;if(k.initializeGLCamera(),!k.tryCreatePlot())return l(k);k.traces={},k.make4thDimension();var L=k.graphDiv,A=L.layout,I=function(){var S={};return k.isCameraChanged(A)&&(S[k.id+".camera"]=k.getCamera()),k.isAspectChanged(A)&&(S[k.id+".aspectratio"]=k.glplot.getAspectratio(),A[k.id].aspectmode!=="manual"&&(k.fullSceneLayout.aspectmode=A[k.id].aspectmode=S[k.id+".aspectmode"]="manual")),S},P=function(S){if(S.fullSceneLayout.dragmode!==!1){var E=I();S.saveLayout(A),S.graphDiv.emit("plotly_relayout",E)}};return k.glplot.canvas&&(k.glplot.canvas.addEventListener("mouseup",function(){P(k)}),k.glplot.canvas.addEventListener("wheel",function(S){if(L._context._scrollZoom.gl3d){if(k.camera._ortho){var E=S.deltaX>S.deltaY?1.1:.9090909090909091,z=k.glplot.getAspectratio();k.glplot.setAspectratio({x:E*z.x,y:E*z.y,z:E*z.z})}P(k)}},!!n&&{passive:!1}),k.glplot.canvas.addEventListener("mousemove",function(){if(k.fullSceneLayout.dragmode!==!1&&k.camera.mouseListener.buttons!==0){var S=I();k.graphDiv.emit("plotly_relayouting",S)}}),k.staticMode||k.glplot.canvas.addEventListener("webglcontextlost",function(S){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:S,layer:k.id})},!1)),k.glplot.oncontextloss=function(){k.recoverContext()},k.glplot.onrender=function(){k.render()},!0},f.render=function(){var k,L=this,A=L.graphDiv,I=L.svgContainer,P=L.container.getBoundingClientRect();A._fullLayout._calcInverseTransform(A);var S=A._fullLayout._invScaleX,E=A._fullLayout._invScaleY,z=P.width*S,D=P.height*E;I.setAttributeNS(null,"viewBox","0 0 "+z+" "+D),I.setAttributeNS(null,"width",z),I.setAttributeNS(null,"height",D),i(L),L.glplot.axes.update(L.axesOptions);for(var j=Object.keys(L.traces),V=null,Z=L.glplot.selection,Q=0;Q<j.length;++Q)(k=L.traces[j[Q]]).data.hoverinfo!=="skip"&&k.handlePick(Z)&&(V=k),k.setContourLevels&&k.setContourLevels();function K(oe,de,ce){var ve=L.fullSceneLayout[oe+"axis"];return ve.type!=="log"&&(de=ve.d2l(de)),u.hoverLabelText(ve,de,ce)}if(V!==null){var $=o(L.glplot.cameraParams,Z.dataCoordinate);k=V.data;var ne,H=A._fullData[k.index],N=Z.index,U={xLabel:K("x",Z.traceCoordinate[0],k.xhoverformat),yLabel:K("y",Z.traceCoordinate[1],k.yhoverformat),zLabel:K("z",Z.traceCoordinate[2],k.zhoverformat)},te=s.castHoverinfo(H,L.fullLayout,N),B=(te||"").split("+"),X=te&&te==="all";H.hovertemplate||X||(B.indexOf("x")===-1&&(U.xLabel=void 0),B.indexOf("y")===-1&&(U.yLabel=void 0),B.indexOf("z")===-1&&(U.zLabel=void 0),B.indexOf("text")===-1&&(Z.textLabel=void 0),B.indexOf("name")===-1&&(V.name=void 0));var J=[];k.type==="cone"||k.type==="streamtube"?(U.uLabel=K("x",Z.traceCoordinate[3],k.uhoverformat),(X||B.indexOf("u")!==-1)&&J.push("u: "+U.uLabel),U.vLabel=K("y",Z.traceCoordinate[4],k.vhoverformat),(X||B.indexOf("v")!==-1)&&J.push("v: "+U.vLabel),U.wLabel=K("z",Z.traceCoordinate[5],k.whoverformat),(X||B.indexOf("w")!==-1)&&J.push("w: "+U.wLabel),U.normLabel=Z.traceCoordinate[6].toPrecision(3),(X||B.indexOf("norm")!==-1)&&J.push("norm: "+U.normLabel),k.type==="streamtube"&&(U.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(X||B.indexOf("divergence")!==-1)&&J.push("divergence: "+U.divergenceLabel)),Z.textLabel&&J.push(Z.textLabel),ne=J.join("<br>")):k.type==="isosurface"||k.type==="volume"?(U.valueLabel=u.hoverLabelText(L._mockAxis,L._mockAxis.d2l(Z.traceCoordinate[3]),k.valuehoverformat),J.push("value: "+U.valueLabel),Z.textLabel&&J.push(Z.textLabel),ne=J.join("<br>")):ne=Z.textLabel;var ee={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:H._input,fullData:H,curveNumber:H.index,pointNumber:N};s.appendArrayPointValue(ee,H,N),k._module.eventData&&(ee=H._module.eventData(ee,Z,H,{},N));var re={points:[ee]};if(L.fullSceneLayout.hovermode){var se=[];s.loneHover({trace:H,x:(.5+.5*$[0]/$[3])*z,y:(.5-.5*$[1]/$[3])*D,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:ne,name:V.name,color:s.castHoverOption(H,N,"bgcolor")||V.color,borderColor:s.castHoverOption(H,N,"bordercolor"),fontFamily:s.castHoverOption(H,N,"font.family"),fontSize:s.castHoverOption(H,N,"font.size"),fontColor:s.castHoverOption(H,N,"font.color"),nameLength:s.castHoverOption(H,N,"namelength"),textAlign:s.castHoverOption(H,N,"align"),hovertemplate:r.castOption(H,N,"hovertemplate"),hovertemplateLabels:r.extendFlat({},ee,U),eventData:[ee]},{container:I,gd:A,inOut_bbox:se}),ee.bbox=se[0]}Z.buttons&&Z.distance<5?A.emit("plotly_click",re):A.emit("plotly_hover",re),this.oldEventData=re}else s.loneUnhover(I),this.oldEventData&&A.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;L.drawAnnotations(L)},f.recoverContext=function(){var k=this;k.glplot.dispose();var L=function(){k.glplot.gl.isContextLost()?requestAnimationFrame(L):k.initializeGLPlot()?k.plot.apply(k,k.plotArgs):r.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var b=["xaxis","yaxis","zaxis"];function T(k,L,A){for(var I=k.fullSceneLayout,P=0;P<3;P++){var S=b[P],E=S.charAt(0),z=I[S],D=L[E],j=L[E+"calendar"],V=L["_"+E+"length"];if(r.isArrayOrTypedArray(D))for(var Z,Q=0;Q<(V||D.length);Q++)if(r.isArrayOrTypedArray(D[Q]))for(var K=0;K<D[Q].length;++K)Z=z.d2l(D[Q][K],0,j),!isNaN(Z)&&isFinite(Z)&&(A[0][P]=Math.min(A[0][P],Z),A[1][P]=Math.max(A[1][P],Z));else Z=z.d2l(D[Q],0,j),!isNaN(Z)&&isFinite(Z)&&(A[0][P]=Math.min(A[0][P],Z),A[1][P]=Math.max(A[1][P],Z));else A[0][P]=Math.min(A[0][P],0),A[1][P]=Math.max(A[1][P],V-1)}}f.plot=function(k,L,A){if(this.plotArgs=[k,L,A],!this.glplot.contextLost){var I,P,S,E,z,D,j=L[this.id],V=A[this.id];this.fullLayout=L,this.fullSceneLayout=j,this.axesOptions.merge(L,j),this.spikeOptions.merge(j),this.setViewport(j),this.updateFx(j.dragmode,j.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(h(j.bgcolor)),this.setConvert(z),k?Array.isArray(k)||(k=[k]):k=[];var Z=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&T(this,I,Z);(function(Te,Se){for(var Me=Te.fullSceneLayout,ze=Me.annotations||[],Oe=0;Oe<3;Oe++)for(var De=b[Oe],Xe=De.charAt(0),Be=Me[De],Ie=0;Ie<ze.length;Ie++){var Re=ze[Ie];if(Re.visible){var Ye=Be.r2l(Re[Xe]);!isNaN(Ye)&&isFinite(Ye)&&(Se[0][Oe]=Math.min(Se[0][Oe],Ye),Se[1][Oe]=Math.max(Se[1][Oe],Ye))}}})(this,Z);var Q=[1,1,1];for(E=0;E<3;++E)Z[1][E]===Z[0][E]?Q[E]=1:Q[E]=1/(Z[1][E]-Z[0][E]);for(this.dataScale=Q,this.convertAnnotations(this),S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&((P=this.traces[I.uid])?P.data.type===I.type?P.update(I):(P.dispose(),P=I._module.plot(this,I),this.traces[I.uid]=P):(P=I._module.plot(this,I),this.traces[I.uid]=P),P.name=I.name);var K=Object.keys(this.traces);e:for(S=0;S<K.length;++S){for(E=0;E<k.length;++E)if(k[E].uid===K[S]&&k[E].visible===!0&&k[E]._length!==0)continue e;(P=this.traces[K[S]]).dispose(),delete this.traces[K[S]]}this.glplot.objects.sort(function(Te,Se){return Te._trace.data.index-Se._trace.data.index});var $,ne=[[0,0,0],[0,0,0]],H=[],N={};for(S=0;S<3;++S){if((D=(z=j[b[S]]).type)in N?(N[D].acc*=Q[S],N[D].count+=1):N[D]={acc:Q[S],count:1},z.autorange){ne[0][S]=1/0,ne[1][S]=-1/0;var U=this.glplot.objects,te=this.fullSceneLayout.annotations||[],B=z._name.charAt(0);for(E=0;E<U.length;E++){var X=U[E],J=X.bounds,ee=X._trace.data._pad||0;X.constructor.name==="ErrorBars"&&z._lowerLogErrorBound?ne[0][S]=Math.min(ne[0][S],z._lowerLogErrorBound):ne[0][S]=Math.min(ne[0][S],J[0][S]/Q[S]-ee),ne[1][S]=Math.max(ne[1][S],J[1][S]/Q[S]+ee)}for(E=0;E<te.length;E++){var re=te[E];if(re.visible){var se=z.r2l(re[B]);ne[0][S]=Math.min(ne[0][S],se),ne[1][S]=Math.max(ne[1][S],se)}}if("rangemode"in z&&z.rangemode==="tozero"&&(ne[0][S]=Math.min(ne[0][S],0),ne[1][S]=Math.max(ne[1][S],0)),ne[0][S]>ne[1][S])ne[0][S]=-1,ne[1][S]=1;else{var oe=ne[1][S]-ne[0][S];ne[0][S]-=oe/32,ne[1][S]+=oe/32}if(z.autorange==="reversed"){var de=ne[0][S];ne[0][S]=ne[1][S],ne[1][S]=de}}else{var ce=z.range;ne[0][S]=z.r2l(ce[0]),ne[1][S]=z.r2l(ce[1])}ne[0][S]===ne[1][S]&&(ne[0][S]-=1,ne[1][S]+=1),H[S]=ne[1][S]-ne[0][S],this.glplot.setBounds(S,{min:ne[0][S]*Q[S],max:ne[1][S]*Q[S]})}var ve=j.aspectmode;if(ve==="cube")$=[1,1,1];else if(ve==="manual"){var Ae=j.aspectratio;$=[Ae.x,Ae.y,Ae.z]}else{if(ve!=="auto"&&ve!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var fe=[1,1,1];for(S=0;S<3;++S){var me=N[D=(z=j[b[S]]).type];fe[S]=Math.pow(me.acc,1/me.count)/Q[S]}$=ve==="data"||Math.max.apply(null,fe)/Math.min.apply(null,fe)<=4?fe:[1,1,1]}j.aspectratio.x=V.aspectratio.x=$[0],j.aspectratio.y=V.aspectratio.y=$[1],j.aspectratio.z=V.aspectratio.z=$[2],this.glplot.setAspectratio(j.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:j.aspectratio.x,y:j.aspectratio.y,z:j.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=j.aspectmode);var _e=j.domain||null,le=L._size||null;if(_e&&le){var ge=this.container.style;ge.position="absolute",ge.left=le.l+_e.x[0]*le.w+"px",ge.top=le.t+(1-_e.y[1])*le.h+"px",ge.width=le.w*(_e.x[1]-_e.x[0])+"px",ge.height=le.h*(_e.y[1]-_e.y[0])+"px"}this.glplot.redraw()}},f.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},f.getCamera=function(){var k;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(k=this.camera).up[0],y:k.up[1],z:k.up[2]},center:{x:k.center[0],y:k.center[1],z:k.center[2]},eye:{x:k.eye[0],y:k.eye[1],z:k.eye[2]},projection:{type:k._ortho===!0?"orthographic":"perspective"}}},f.setViewport=function(k){var L,A=k.camera;this.camera.lookAt.apply(this,[[(L=A).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(k.aspectratio),A.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},f.isCameraChanged=function(k){var L=this.getCamera(),A=r.nestedProperty(k,this.id+".camera").get();function I(z,D,j,V){var Z=["up","center","eye"],Q=["x","y","z"];return D[Z[j]]&&z[Z[j]][Q[V]]===D[Z[j]][Q[V]]}var P=!1;if(A===void 0)P=!0;else{for(var S=0;S<3;S++)for(var E=0;E<3;E++)if(!I(L,A,S,E)){P=!0;break}(!A.projection||L.projection&&L.projection.type!==A.projection.type)&&(P=!0)}return P},f.isAspectChanged=function(k){var L=this.glplot.getAspectratio(),A=r.nestedProperty(k,this.id+".aspectratio").get();return A===void 0||A.x!==L.x||A.y!==L.y||A.z!==L.z},f.saveLayout=function(k){var L,A,I,P,S,E,z=this.fullLayout,D=this.isCameraChanged(k),j=this.isAspectChanged(k),V=D||j;if(V){var Z={};D&&(L=this.getCamera(),I=(A=r.nestedProperty(k,this.id+".camera")).get(),Z[this.id+".camera"]=I),j&&(P=this.glplot.getAspectratio(),E=(S=r.nestedProperty(k,this.id+".aspectratio")).get(),Z[this.id+".aspectratio"]=E),a.call("_storeDirectGUIEdit",k,z._preGUI,Z),D&&(A.set(L),r.nestedProperty(z,this.id+".camera").set(L)),j&&(S.set(P),r.nestedProperty(z,this.id+".aspectratio").set(P),this.glplot.redraw())}return V},f.updateFx=function(k,L){var A=this.camera;if(A)if(k==="orbit")A.mode="orbit",A.keyBindingMode="rotate";else if(k==="turntable"){A.up=[0,0,1],A.mode="turntable",A.keyBindingMode="rotate";var I=this.graphDiv,P=I._fullLayout,S=this.fullSceneLayout.camera,E=S.up.x,z=S.up.y,D=S.up.z;if(D/Math.sqrt(E*E+z*z+D*D)<.999){var j=this.id+".camera.up",V={x:0,y:0,z:1},Z={};Z[j]=V;var Q=I.layout;a.call("_storeDirectGUIEdit",Q,P._preGUI,Z),S.up=V,r.nestedProperty(Q,j).set(V)}}else A.keyBindingMode=k;this.fullSceneLayout.hovermode=L},f.toImage=function(k){k||(k="png"),this.staticMode&&this.container.appendChild(d),this.glplot.redraw();var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P),function(j,V,Z){for(var Q=0,K=Z-1;Q<K;++Q,--K)for(var $=0;$<V;++$)for(var ne=0;ne<4;++ne){var H=4*(V*Q+$)+ne,N=4*(V*K+$)+ne,U=j[H];j[H]=j[N],j[N]=U}}(P,A,I),function(j,V,Z){for(var Q=0;Q<Z;++Q)for(var K=0;K<V;++K){var $=4*(V*Q+K),ne=j[$+3];if(ne>0)for(var H=255/ne,N=0;N<3;++N)j[$+N]=Math.min(H*j[$+N],255)}}(P,A,I);var S=document.createElement("canvas");S.width=A,S.height=I;var E,z=S.getContext("2d",{willReadFrequently:!0}),D=z.createImageData(A,I);switch(D.data.set(P),z.putImageData(D,0,0),k){case"jpeg":E=S.toDataURL("image/jpeg");break;case"webp":E=S.toDataURL("image/webp");break;default:E=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(d),E},f.setConvert=function(){for(var k=0;k<3;k++){var L=this.fullSceneLayout[b[k]];u.setConvert(L,this.fullLayout),L.setScale=r.noop}},f.make4thDimension=function(){var k=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},u.setConvert(this._mockAxis,k)},G.exports=x},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(m,G,W){G.exports=function(d,v,w,y){y=y||d.length;for(var e=new Array(y),t=0;t<y;t++)e[t]=[d[t],v[t],w[t]];return e}},{}],619:[function(m,G,W){var d=m("./font_attributes"),v=m("./animation_attributes"),w=m("../components/color/attributes"),y=m("../components/shapes/draw_newshape/attributes"),e=m("../components/selections/draw_newselection/attributes"),t=m("./pad_attributes"),n=m("../lib/extend").extendFlat,a=d({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif',a.size.dflt=12,a.color.dflt=w.defaultLine,G.exports={font:a,title:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(t({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:w.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:w.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:w.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:y.newshape,activeshape:y.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},v.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:d({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(m,G,W){var d=m("../../lib/sort_object_keys"),v='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',w=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',v].join(" "),y=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:v,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:w,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:w,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},t=d(e);G.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:t,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",t.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){var y=v.split(" "),e=y[0],t=y[1],n=d.isArrayOrTypedArray(w)?d.mean(w):w,a=.5+n/100,r=1.5+n/100,g=["",""],u=[0,0];switch(e){case"top":g[0]="top",u[1]=-r;break;case"bottom":g[0]="bottom",u[1]=r}switch(t){case"left":g[1]="right",u[0]=-a;break;case"right":g[1]="left",u[0]=a}return{anchor:g[0]&&g[1]?g.join("-"):g[0]?g[0]:g[1]?g[1]:"center",offset:u}}},{"../../lib":515}],622:[function(m,G,W){var d=m("mapbox-gl/dist/mapbox-gl-unminified"),v=m("../../lib"),w=v.strTranslate,y=v.strScale,e=m("../../plots/get_data").getSubplotCalcData,t=m("../../constants/xmlns_namespaces"),n=m("@plotly/d3"),a=m("../../components/drawing"),r=m("../../lib/svg_text_utils"),g=m("./mapbox"),u=W.constants=m("./constants");function s(h){return typeof h=="string"&&(u.styleValuesMapbox.indexOf(h)!==-1||h.indexOf("mapbox://")===0)}W.name="mapbox",W.attr="subplot",W.idRoot="mapbox",W.idRegex=W.attrRegex=v.counterRegex("mapbox"),W.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},W.layoutAttributes=m("./layout_attributes"),W.supplyLayoutDefaults=m("./layout_defaults"),W.plot=function(h){var l=h._fullLayout,o=h.calcdata,p=l._subplots.mapbox;if(d.version!==u.requiredVersion)throw new Error(u.wrongVersionErrorMsg);var c=function(T,k){var L=T._fullLayout;if(T._context.mapboxAccessToken==="")return"";for(var A=[],I=[],P=!1,S=!1,E=0;E<k.length;E++){var z=L[k[E]],D=z.accesstoken;s(z.style)&&(D?v.pushUnique(A,D):(s(z._input.style)&&(v.error("Uses Mapbox map style, but did not set an access token."),P=!0),S=!0)),D&&v.pushUnique(I,D)}if(S){var j=P?u.noAccessTokenErrorMsg:u.missingStyleErrorMsg;throw v.error(j),new Error(j)}return A.length?(A.length>1&&v.warn(u.multipleTokensErrorMsg),A[0]):(I.length&&v.log(["Listed mapbox access token(s)",I.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(h,p);d.accessToken=c;for(var i=0;i<p.length;i++){var x=p[i],f=e(o,"mapbox",x),_=l[x],b=_._subplot;b||(b=new g(h,x),l[x]._subplot=b),b.viewInitial||(b.viewInitial={center:v.extendFlat({},_.center),zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),b.plot(f,l,h._promises)}},W.clean=function(h,l,o,p){for(var c=p._subplots.mapbox||[],i=0;i<c.length;i++){var x=c[i];!l[x]&&p[x]._subplot&&p[x]._subplot.destroy()}},W.toSVG=function(h){for(var l=h._fullLayout,o=l._subplots.mapbox,p=l._size,c=0;c<o.length;c++){var i=l[o[c]],x=i.domain,f=i._subplot.toImage("png");l._glimages.append("svg:image").attr({xmlns:t.svg,"xlink:href":f,x:p.l+p.w*x.x[0],y:p.t+p.h*(1-x.y[1]),width:p.w*(x.x[1]-x.x[0]),height:p.h*(x.y[1]-x.y[0]),preserveAspectRatio:"none"});var _=n.select(i._subplot.div);if(_.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var b=l._glimages.append("g");b.attr("transform",w(p.l+p.w*x.x[0]+10,p.t+p.h*(1-x.y[0])-31)),b.append("path").attr("d",u.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),b.append("path").attr("d",u.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),b.append("path").attr("d",u.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),b.append("polygon").attr("points",u.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var T=_.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),k=l._glimages.append("g"),L=k.append("text");L.text(T).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":T});var A=a.bBox(L.node()),I=p.w*(x.x[1]-x.x[0]);if(A.width>I/2){var P=T.split("|").join("<br>");L.text(P).attr("data-unformatted",P).call(r.convertToTspans,h),A=a.bBox(L.node())}L.attr("transform",w(-3,8-A.height)),k.insert("rect",".static-attribution").attr({x:-A.width-6,y:-A.height-3,width:A.width+6,height:A.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;A.width+6>I&&(S=I/(A.width+6));var E=[p.l+p.w*x.x[1],p.t+p.h*(1-x.y[0])];k.attr("transform",w(E[0],E[1])+y(S))}},W.updateFx=function(h){for(var l=h._fullLayout,o=l._subplots.mapbox,p=0;p<o.length;p++)l[o[p]]._subplot.updateFx(l)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(m,G,W){var d=m("../../lib"),v=m("../../lib/svg_text_utils").sanitizeHTML,w=m("./convert_text_opts"),y=m("./constants");function e(r,g){this.subplot=r,this.uid=r.uid+"-"+g,this.index=g,this.idSource="source-"+this.uid,this.idLayer=y.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var t=e.prototype;function n(r){if(!r.visible)return!1;var g=r.source;if(Array.isArray(g)&&g.length>0){for(var u=0;u<g.length;u++)if(typeof g[u]!="string"||g[u].length===0)return!1;return!0}return d.isPlainObject(g)||typeof g=="string"&&g.length>0}function a(r){var g={},u={};switch(r.type){case"circle":d.extendFlat(u,{"circle-radius":r.circle.radius,"circle-color":r.color,"circle-opacity":r.opacity});break;case"line":d.extendFlat(u,{"line-width":r.line.width,"line-color":r.color,"line-opacity":r.opacity,"line-dasharray":r.line.dash});break;case"fill":d.extendFlat(u,{"fill-color":r.color,"fill-outline-color":r.fill.outlinecolor,"fill-opacity":r.opacity});break;case"symbol":var s=r.symbol,h=w(s.textposition,s.iconsize);d.extendFlat(g,{"icon-image":s.icon+"-15","icon-size":s.iconsize/10,"text-field":s.text,"text-size":s.textfont.size,"text-anchor":h.anchor,"text-offset":h.offset,"symbol-placement":s.placement}),d.extendFlat(u,{"icon-color":r.color,"text-color":s.textfont.color,"text-opacity":r.opacity});break;case"raster":d.extendFlat(u,{"raster-fade-duration":0,"raster-opacity":r.opacity})}return{layout:g,paint:u}}t.update=function(r){this.visible?this.needsNewImage(r)?this.updateImage(r):this.needsNewSource(r)?(this.removeLayer(),this.updateSource(r),this.updateLayer(r)):this.needsNewLayer(r)?this.updateLayer(r):this.updateStyle(r):(this.updateSource(r),this.updateLayer(r)),this.visible=n(r)},t.needsNewImage=function(r){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&r.sourcetype==="image"&&(this.source!==r.source||JSON.stringify(this.coordinates)!==JSON.stringify(r.coordinates))},t.needsNewSource=function(r){return this.sourceType!==r.sourcetype||JSON.stringify(this.source)!==JSON.stringify(r.source)||this.layerType!==r.type},t.needsNewLayer=function(r){return this.layerType!==r.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},t.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},t.updateImage=function(r){this.subplot.map.getSource(this.idSource).updateImage({url:r.source,coordinates:r.coordinates});var g=this.findFollowingMapboxLayerId(this.lookupBelow());g!==null&&this.subplot.map.moveLayer(this.idLayer,g)},t.updateSource=function(r){var g=this.subplot.map;if(g.getSource(this.idSource)&&g.removeSource(this.idSource),this.sourceType=r.sourcetype,this.source=r.source,n(r)){var u=function(s){var h,l=s.sourcetype,o=s.source,p={type:l};return l==="geojson"?h="data":l==="vector"?h=typeof o=="string"?"url":"tiles":l==="raster"?(h="tiles",p.tileSize=256):l==="image"&&(h="url",p.coordinates=s.coordinates),p[h]=o,s.sourceattribution&&(p.attribution=v(s.sourceattribution)),p}(r);g.addSource(this.idSource,u)}},t.findFollowingMapboxLayerId=function(r){if(r==="traces")for(var g=this.subplot.getMapLayers(),u=0;u<g.length;u++){var s=g[u].id;if(typeof s=="string"&&s.indexOf(y.traceLayerPrefix)===0){r=s;break}}return r},t.updateLayer=function(r){var g=this.subplot,u=a(r),s=this.lookupBelow(),h=this.findFollowingMapboxLayerId(s);this.removeLayer(),n(r)&&g.addLayer({id:this.idLayer,source:this.idSource,"source-layer":r.sourcelayer||"",type:r.type,minzoom:r.minzoom,maxzoom:r.maxzoom,layout:u.layout,paint:u.paint},h),this.layerType=r.type,this.below=s},t.updateStyle=function(r){if(n(r)){var g=a(r);this.subplot.setOptions(this.idLayer,"setLayoutProperty",g.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",g.paint)}},t.removeLayer=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer)},t.dispose=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer),r.getSource(this.idSource)&&r.removeSource(this.idSource)},G.exports=function(r,g,u){var s=new e(r,g);return s.update(u),s}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color").defaultLine,w=m("../domain").attributes,y=m("../font_attributes"),e=m("../../traces/scatter/attributes").textposition,t=m("../../plot_api/edit_types").overrideAll,n=m("../../plot_api/plot_template").templatedArray,a=m("./constants"),r=y({});r.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(G.exports=t({_arrayAttrRegexps:[d.counterRegex("mapbox",".layers",!0)],domain:w({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:v},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:v}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:r,textposition:d.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(m,G,W){var d=m("../../lib"),v=m("../subplot_defaults"),w=m("../array_container_defaults"),y=m("./layout_attributes");function e(n,a,r,g){r("accesstoken",g.accessToken),r("style"),r("center.lon"),r("center.lat"),r("zoom"),r("bearing"),r("pitch");var u=r("bounds.west"),s=r("bounds.east"),h=r("bounds.south"),l=r("bounds.north");u!==void 0&&s!==void 0&&h!==void 0&&l!==void 0||delete a.bounds,w(n,a,{name:"layers",handleItemDefaults:t}),a._input=n}function t(n,a){function r(l,o){return d.coerce(n,a,y.layers,l,o)}if(r("visible")){var g,u=r("sourcetype"),s=u==="raster"||u==="image";r("source"),r("sourceattribution"),u==="vector"&&r("sourcelayer"),u==="image"&&r("coordinates"),s&&(g="raster");var h=r("type",g);s&&h!=="raster"&&(h=a.type="raster",d.log("Source types *raster* and *image* must drawn *raster* layer type.")),r("below"),r("color"),r("opacity"),r("minzoom"),r("maxzoom"),h==="circle"&&r("circle.radius"),h==="line"&&(r("line.width"),r("line.dash")),h==="fill"&&r("fill.outlinecolor"),h==="symbol"&&(r("symbol.icon"),r("symbol.iconsize"),r("symbol.text"),d.coerceFont(r,"symbol.textfont"),r("symbol.textposition"),r("symbol.placement"))}}G.exports=function(n,a,r){v(n,a,r,{type:"mapbox",attributes:y,handleDefaults:e,partition:"y",accessToken:a._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(m,G,W){var d=m("mapbox-gl/dist/mapbox-gl-unminified"),v=m("../../lib"),w=m("../../lib/geo_location_utils"),y=m("../../registry"),e=m("../cartesian/axes"),t=m("../../components/dragelement"),n=m("../../components/fx"),a=m("../../components/dragelement/helpers"),r=a.drawMode,g=a.selectMode,u=m("../../components/selections").prepSelect,s=m("../../components/selections").clearOutline,h=m("../../components/selections").clearSelectionsCache,l=m("../../components/selections").selectOnClick,o=m("./constants"),p=m("./layers");function c(T,k){this.id=k,this.gd=T;var L=T._fullLayout,A=T._context;this.container=L._glcontainer.node(),this.isStatic=A.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var i=c.prototype;i.plot=function(T,k,L){var A,I=this,P=k[I.id];I.map&&P.accesstoken!==I.accessToken&&(I.map.remove(),I.map=null,I.styleObj=null,I.traceHash={},I.layerList=[]),A=I.map?new Promise(function(S,E){I.updateMap(T,k,S,E)}):new Promise(function(S,E){I.createMap(T,k,S,E)}),L.push(A)},i.createMap=function(T,k,L,A){var I=this,P=k[I.id],S=I.styleObj=f(P.style);I.accessToken=P.accesstoken;var E=P.bounds,z=E?[[E.west,E.south],[E.east,E.north]]:null,D=I.map=new d.Map({container:I.div,style:S.style,center:b(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,maxBounds:z,interactive:!I.isStatic,preserveDrawingBuffer:I.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new d.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",I.rejectOnError(A),I.isStatic||I.initFx(T,k);var j=[];j.push(new Promise(function(V){D.once("load",V)})),j=j.concat(w.fetchTraceGeoData(T)),Promise.all(j).then(function(){I.fillBelowLookup(T,k),I.updateData(T),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},i.updateMap=function(T,k,L,A){var I=this,P=I.map,S=k[this.id];I.rejectOnError(A);var E=[],z=f(S.style);JSON.stringify(I.styleObj)!==JSON.stringify(z)&&(I.styleObj=z,P.setStyle(z.style),I.traceHash={},E.push(new Promise(function(D){P.once("styledata",D)}))),E=E.concat(w.fetchTraceGeoData(T)),Promise.all(E).then(function(){I.fillBelowLookup(T,k),I.updateData(T),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},i.fillBelowLookup=function(T,k){var L,A,I=k[this.id].layers,P=this.belowLookup={},S=!1;for(L=0;L<T.length;L++){var E=T[L][0].trace,z=E._module;typeof E.below=="string"?A=E.below:z.getBelow&&(A=z.getBelow(E,this)),A===""&&(S=!0),P["trace-"+E.uid]=A||""}for(L=0;L<I.length;L++){var D=I[L];A=typeof D.below=="string"?D.below:S?"traces":"",P["layout-"+L]=A}var j,V,Z={};for(j in P)Z[A=P[j]]?Z[A].push(j):Z[A]=[j];for(A in Z){var Q=Z[A];if(Q.length>1)for(L=0;L<Q.length;L++)(j=Q[L]).indexOf("trace-")===0?(V=j.split("trace-")[1],this.traceHash[V]&&(this.traceHash[V].below=null)):j.indexOf("layout-")===0&&(V=j.split("layout-")[1],this.layerList[V]&&(this.layerList[V].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function f(T){var k={};return v.isPlainObject(T)?(k.id=T.id,k.style=T):typeof T=="string"?(k.id=T,o.styleValuesMapbox.indexOf(T)!==-1?k.style=_(T):o.stylesNonMapbox[T]?k.style=o.stylesNonMapbox[T]:k.style=T):(k.id=o.styleValueDflt,k.style=_(o.styleValueDflt)),k.transition={duration:0,delay:0},k}function _(T){return o.styleUrlPrefix+T+"-"+o.styleUrlSuffix}function b(T){return[T.lon,T.lat]}i.updateData=function(T){var k,L,A,I,P=this.traceHash,S=T.slice().sort(function(V,Z){return x[V[0].trace.type]-x[Z[0].trace.type]});for(A=0;A<S.length;A++){var E=S[A],z=!1;(k=P[(L=E[0].trace).uid])&&(k.type===L.type?(k.update(E),z=!0):k.dispose()),!z&&L._module&&(P[L.uid]=L._module.plot(this,E))}var D=Object.keys(P);e:for(A=0;A<D.length;A++){var j=D[A];for(I=0;I<T.length;I++)if(j===(L=T[I][0].trace).uid)continue e;(k=P[j]).dispose(),delete P[j]}},i.updateLayout=function(T){var k=this.map,L=T[this.id];this.dragging||this.wheeling||(k.setCenter(b(L.center)),k.setZoom(L.zoom),k.setBearing(L.bearing),k.setPitch(L.pitch)),this.updateLayers(T),this.updateFramework(T),this.updateFx(T),this.map.resize(),this.gd._context._scrollZoom.mapbox?k.scrollZoom.enable():k.scrollZoom.disable()},i.resolveOnRender=function(T){var k=this.map;k.on("render",function L(){k.loaded()&&(k.off("render",L),setTimeout(T,10))})},i.rejectOnError=function(T){var k=this.map;function L(){T(new Error(o.mapOnErrorMsg))}k.once("error",L),k.once("style.error",L),k.once("source.error",L),k.once("tile.error",L),k.once("layer.error",L)},i.createFramework=function(T){var k=this,L=k.div=document.createElement("div");L.id=k.uid,L.style.position="absolute",k.container.appendChild(L),k.xaxis={_id:"x",c2p:function(A){return k.project(A).x}},k.yaxis={_id:"y",c2p:function(A){return k.project(A).y}},k.updateFramework(T),k.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(k.mockAxis,T)},i.initFx=function(T,k){var L=this,A=L.gd,I=L.map;function P(){n.loneUnhover(k._hoverlayer)}function S(){var E=L.getView();A.emit("plotly_relayouting",L.getViewEditsWithDerived(E))}I.on("moveend",function(E){if(L.map){var z=A._fullLayout;if(E.originalEvent||L.wheeling){var D=z[L.id];y.call("_storeDirectGUIEdit",A.layout,z._preGUI,L.getViewEdits(D));var j=L.getView();D._input.center=D.center=j.center,D._input.zoom=D.zoom=j.zoom,D._input.bearing=D.bearing=j.bearing,D._input.pitch=D.pitch=j.pitch,A.emit("plotly_relayout",L.getViewEditsWithDerived(j))}E.originalEvent&&E.originalEvent.type==="mouseup"?L.dragging=!1:L.wheeling&&(L.wheeling=!1),z._rehover&&z._rehover()}}),I.on("wheel",function(){L.wheeling=!0}),I.on("mousemove",function(E){var z=L.div.getBoundingClientRect(),D=[E.originalEvent.offsetX,E.originalEvent.offsetY];E.target.getBoundingClientRect=function(){return z},L.xaxis.p2c=function(){return I.unproject(D).lng},L.yaxis.p2c=function(){return I.unproject(D).lat},A._fullLayout._rehover=function(){A._fullLayout._hoversubplot===L.id&&A._fullLayout[L.id]&&n.hover(A,E,L.id)},n.hover(A,E,L.id),A._fullLayout._hoversubplot=L.id}),I.on("dragstart",function(){L.dragging=!0,P()}),I.on("zoomstart",P),I.on("mouseout",function(){A._fullLayout._hoversubplot=null}),I.on("drag",S),I.on("zoom",S),I.on("dblclick",function(){var E=A._fullLayout[L.id];y.call("_storeDirectGUIEdit",A.layout,A._fullLayout._preGUI,L.getViewEdits(E));var z=L.viewInitial;I.setCenter(b(z.center)),I.setZoom(z.zoom),I.setBearing(z.bearing),I.setPitch(z.pitch);var D=L.getView();E._input.center=E.center=D.center,E._input.zoom=E.zoom=D.zoom,E._input.bearing=E.bearing=D.bearing,E._input.pitch=E.pitch=D.pitch,A.emit("plotly_doubleclick",null),A.emit("plotly_relayout",L.getViewEditsWithDerived(D))}),L.clearOutline=function(){h(L.dragOptions),s(L.dragOptions.gd)},L.onClickInPanFn=function(E){return function(z){var D=A._fullLayout.clickmode;D.indexOf("select")>-1&&l(z.originalEvent,A,[L.xaxis],[L.yaxis],L.id,E),D.indexOf("event")>-1&&n.click(A,z.originalEvent)}}},i.updateFx=function(T){var k=this,L=k.map,A=k.gd;if(!k.isStatic){var I,P=T.dragmode;I=function(z,D){D.isRect?(z.range={})[k.id]=[E([D.xmin,D.ymin]),E([D.xmax,D.ymax])]:(z.lassoPoints={})[k.id]=D.map(E)};var S=k.dragOptions;k.dragOptions=v.extendDeep(S||{},{dragmode:T.dragmode,element:k.div,gd:A,plotinfo:{id:k.id,domain:T[k.id].domain,xaxis:k.xaxis,yaxis:k.yaxis,fillRangeItems:I},xaxes:[k.xaxis],yaxes:[k.yaxis],subplot:k.id}),L.off("click",k.onClickInPanHandler),g(P)||r(P)?(L.dragPan.disable(),L.on("zoomstart",k.clearSelect),k.dragOptions.prepFn=function(z,D,j){u(z,D,j,k.dragOptions,P)},t.init(k.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",k.clearSelect),k.div.onmousedown=null,k.div.ontouchstart=null,k.div.removeEventListener("touchstart",k.div._ontouchstart),k.onClickInPanHandler=k.onClickInPanFn(k.dragOptions),L.on("click",k.onClickInPanHandler))}function E(z){var D=k.map.unproject(z);return[D.lng,D.lat]}},i.updateFramework=function(T){var k=T[this.id].domain,L=T._size,A=this.div.style;A.width=L.w*(k.x[1]-k.x[0])+"px",A.height=L.h*(k.y[1]-k.y[0])+"px",A.left=L.l+k.x[0]*L.w+"px",A.top=L.t+(1-k.y[1])*L.h+"px",this.xaxis._offset=L.l+k.x[0]*L.w,this.xaxis._length=L.w*(k.x[1]-k.x[0]),this.yaxis._offset=L.t+(1-k.y[1])*L.h,this.yaxis._length=L.h*(k.y[1]-k.y[0])},i.updateLayers=function(T){var k,L=T[this.id].layers,A=this.layerList;if(L.length!==A.length){for(k=0;k<A.length;k++)A[k].dispose();for(A=this.layerList=[],k=0;k<L.length;k++)A.push(p(this,k,L[k]))}else for(k=0;k<L.length;k++)A[k].update(L[k])},i.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},i.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},i.setOptions=function(T,k,L){for(var A in L)this.map[k](T,A,L[A])},i.getMapLayers=function(){return this.map.getStyle().layers},i.addLayer=function(T,k){var L=this.map;if(typeof k=="string"){if(k==="")return void L.addLayer(T,k);for(var A=this.getMapLayers(),I=0;I<A.length;I++)if(k===A[I].id)return void L.addLayer(T,k);v.warn(["Trying to add layer with *below* value",k,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(T)},i.project=function(T){return this.map.project(new d.LngLat(T[0],T[1]))},i.getView=function(){var T=this.map,k=T.getCenter(),L={lon:k.lng,lat:k.lat},A=T.getCanvas(),I=parseInt(A.style.width),P=parseInt(A.style.height);return{center:L,zoom:T.getZoom(),bearing:T.getBearing(),pitch:T.getPitch(),_derived:{coordinates:[T.unproject([0,0]).toArray(),T.unproject([I,0]).toArray(),T.unproject([I,P]).toArray(),T.unproject([0,P]).toArray()]}}},i.getViewEdits=function(T){for(var k=this.id,L=["center","zoom","bearing","pitch"],A={},I=0;I<L.length;I++){var P=L[I];A[k+"."+P]=T[P]}return A},i.getViewEditsWithDerived=function(T){var k=this.id,L=this.getViewEdits(T);return L[k+"._derived"]=T._derived,L},G.exports=c},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(m,G,W){G.exports=function(d){var v=d.editType;return{t:{valType:"number",dflt:0,editType:v},r:{valType:"number",dflt:0,editType:v},b:{valType:"number",dflt:0,editType:v},l:{valType:"number",dflt:0,editType:v},editType:v}}},{}],628:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-time-format").timeFormatLocale,w=m("d3-format").formatLocale,y=m("fast-isnumeric"),e=m("../registry"),t=m("../plot_api/plot_schema"),n=m("../plot_api/plot_template"),a=m("../lib"),r=m("../components/color"),g=m("../constants/numerical").BADNUM,u=m("./cartesian/axis_ids"),s=m("../components/shapes/handle_outline").clearOutline,h=m("./animation_attributes"),l=m("./frame_attributes"),o=m("../plots/get_data").getModuleCalcData,p=a.relinkPrivateKeys,c=a._,i=G.exports={};a.extendFlat(i,e),i.attributes=m("./attributes"),i.attributes.type.values=i.allTypes,i.fontAttrs=m("./font_attributes"),i.layoutAttributes=m("./layout_attributes"),i.fontWeight="normal";var x=i.transformsRegistry,f=m("./command");i.executeAPICommand=f.executeAPICommand,i.computeAPICommandBindings=f.computeAPICommandBindings,i.manageCommandObserver=f.manageCommandObserver,i.hasSimpleAPICommandBindings=f.hasSimpleAPICommandBindings,i.redrawText=function(V){return V=a.getGraphDiv(V),new Promise(function(Z){setTimeout(function(){V._fullLayout&&(e.getComponentMethod("annotations","draw")(V),e.getComponentMethod("legend","draw")(V),e.getComponentMethod("colorbar","draw")(V),Z(i.previousPromises(V)))},300)})},i.resize=function(V){var Z;V=a.getGraphDiv(V);var Q=new Promise(function(K,$){V&&!a.isHidden(V)||$(new Error("Resize must be passed a displayed plot div element.")),V._redrawTimer&&clearTimeout(V._redrawTimer),V._resolveResize&&(Z=V._resolveResize),V._resolveResize=K,V._redrawTimer=setTimeout(function(){if(!V.layout||V.layout.width&&V.layout.height||a.isHidden(V))K(V);else{delete V.layout.width,delete V.layout.height;var ne=V.changed;V.autoplay=!0,e.call("relayout",V,{autosize:!0}).then(function(){V.changed=ne,V._resolveResize===K&&(delete V._resolveResize,K(V))})}},100)});return Z&&Z(Q),Q},i.previousPromises=function(V){if((V._promises||[]).length)return Promise.all(V._promises).then(function(){V._promises=[]})},i.addLinks=function(V){if(V._context.showLink||V._context.showSources){var Z=V._fullLayout,Q=a.ensureSingle(Z._paper,"text","js-plot-link-container",function(U){U.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var te=d.select(this);te.append("tspan").classed("js-link-to-tool",!0),te.append("tspan").classed("js-link-spacer",!0),te.append("tspan").classed("js-sourcelinks",!0)})}),K=Q.node(),$={y:Z._paper.attr("height")-9};document.body.contains(K)&&K.getComputedTextLength()>=Z.width-20?($["text-anchor"]="start",$.x=5):($["text-anchor"]="end",$.x=Z._paper.attr("width")-7),Q.attr($);var ne=Q.select(".js-link-to-tool"),H=Q.select(".js-link-spacer"),N=Q.select(".js-sourcelinks");V._context.showSources&&V._context.showSources(V),V._context.showLink&&function(U,te){te.text("");var B=te.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(U._context.linkText+" "+String.fromCharCode(187));if(U._context.sendData)B.on("click",function(){i.sendDataToCloud(U)});else{var X=window.location.pathname.split("/"),J=window.location.search;B.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+X[2].split(".")[0]+"/"+X[1]+J})}}(V,ne),H.text(ne.text()&&N.text()?" - ":"")}},i.sendDataToCloud=function(V){var Z=(window.PLOTLYENV||{}).BASE_URL||V._context.plotlyServerURL;if(Z){V.emit("plotly_beforeexport");var Q=d.select(V).append("div").attr("id","hiddenform").style("display","none"),K=Q.append("form").attr({action:Z+"/external",method:"post",target:"_blank"});return K.append("input").attr({type:"text",name:"data"}).node().value=i.graphJson(V,!1,"keepdata"),K.node().submit(),Q.remove(),V.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],b=["year","month","dayMonth","dayMonthYear"];function T(V,Z){var Q=V._context.locale;Q||(Q="en-US");var K=!1,$={};function ne(X){for(var J=!0,ee=0;ee<Z.length;ee++){var re=Z[ee];$[re]||(X[re]?$[re]=X[re]:J=!1)}J&&(K=!0)}for(var H=0;H<2;H++){for(var N=V._context.locales,U=0;U<2;U++){var te=(N[Q]||{}).format;if(te&&(ne(te),K))break;N=e.localeRegistry}var B=Q.split("-")[0];if(K||B===Q)break;Q=B}return K||ne(e.localeRegistry.en.format),$}function k(V,Z){var Q={_fullLayout:Z},K=V._id.charAt(0)==="x",$=V._mainAxis._anchorAxis,ne="",H="",N="";if($&&(N=$._mainAxis._id,ne=K?V._id+N:N+V._id),!ne||!Z._plots[ne]){ne="";for(var U=V._counterAxes,te=0;te<U.length;te++){var B=U[te],X=K?V._id+B:B+V._id;H||(H=X);var J=u.getFromId(Q,B);if(N&&J.overlaying===N){ne=X;break}}}return ne||H}function L(V){var Z=V.transforms;if(Array.isArray(Z)&&Z.length)for(var Q=0;Q<Z.length;Q++){var K=Z[Q],$=K._module||x[K.type];if($&&$.makesData)return!0}return!1}function A(V,Z,Q,K){for(var $=V.transforms,ne=[V],H=0;H<$.length;H++){var N=$[H],U=x[N.type];U&&U.transform&&(ne=U.transform(ne,{transform:N,fullTrace:V,fullData:Z,layout:Q,fullLayout:K,transformIndex:H}))}return ne}function I(V){return typeof V=="string"&&V.substr(V.length-2)==="px"&&parseFloat(V)}function P(V){var Z=V.margin;if(!V._size){var Q=V._size={l:Math.round(Z.l),r:Math.round(Z.r),t:Math.round(Z.t),b:Math.round(Z.b),p:Math.round(Z.pad)};Q.w=Math.round(V.width)-Q.l-Q.r,Q.h=Math.round(V.height)-Q.t-Q.b}V._pushmargin||(V._pushmargin={}),V._pushmarginIds||(V._pushmarginIds={})}i.supplyDefaults=function(V,Z){var Q=Z&&Z.skipUpdateCalc,K=V._fullLayout||{};if(K._skipDefaults)delete K._skipDefaults;else{var $,ne=V._fullLayout={},H=V.layout||{},N=V._fullData||[],U=V._fullData=[],te=V.data||[],B=V.calcdata||[],X=V._context||{};V._transitionData||i.createTransitionData(V),ne._dfltTitle={plot:c(V,"Click to enter Plot title"),x:c(V,"Click to enter X axis title"),y:c(V,"Click to enter Y axis title"),colorbar:c(V,"Click to enter Colorscale title"),annotation:c(V,"new text")},ne._traceWord=c(V,"trace");var J=T(V,_);if(ne._mapboxAccessToken=X.mapboxAccessToken,K._initialAutoSizeIsDone){var ee=K.width,re=K.height;i.supplyLayoutGlobalDefaults(H,ne,J),H.width||(ne.width=ee),H.height||(ne.height=re),i.sanitizeMargins(ne)}else{i.supplyLayoutGlobalDefaults(H,ne,J);var se=!H.width||!H.height,oe=ne.autosize,de=X.autosizable;se&&(oe||de)?i.plotAutoSize(V,H,ne):se&&i.sanitizeMargins(ne),!oe&&se&&(H.width=ne.width,H.height=ne.height)}ne._d3locale=function(Ie,Re){return Ie.decimal=Re.charAt(0),Ie.thousands=Re.charAt(1),{numberFormat:function(Ye){try{Ye=w(Ie).format(a.adjustFormat(Ye))}catch{return a.warnBadFormat(Ye),a.noFormat}return Ye},timeFormat:v(Ie).utcFormat}}(J,ne.separators),ne._extraFormat=T(V,b),ne._initialAutoSizeIsDone=!0,ne._dataLength=te.length,ne._modules=[],ne._visibleModules=[],ne._basePlotModules=[];var ce=ne._subplots=function(){var Ie,Re,Ye=e.collectableSubplotTypes,Qe={};if(!Ye){Ye=[];var lt=e.subplotsRegistry;for(var xt in lt){var wt=lt[xt].attr;if(wt&&(Ye.push(xt),Array.isArray(wt)))for(Re=0;Re<wt.length;Re++)a.pushUnique(Ye,wt[Re])}}for(Ie=0;Ie<Ye.length;Ie++)Qe[Ye[Ie]]=[];return Qe}(),ve=ne._splomAxes={x:{},y:{}},Ae=ne._splomSubplots={};ne._splomGridDflt={},ne._scatterStackOpts={},ne._firstScatter={},ne._alignmentOpts={},ne._colorAxes={},ne._requestRangeslider={},ne._traceUids=function(Ie,Re){var Ye,Qe,lt=Re.length,xt=[];for(Ye=0;Ye<Ie.length;Ye++){var wt=Ie[Ye]._fullInput;wt!==Qe&&xt.push(wt),Qe=wt}var bt=xt.length,nt=new Array(lt),$e={};function vt(Jt,Wt){nt[Wt]=Jt,$e[Jt]=1}function Nt(Jt,Wt){if(Jt&&typeof Jt=="string"&&!$e[Jt])return vt(Jt,Wt),!0}for(Ye=0;Ye<lt;Ye++){var qt=Re[Ye].uid;typeof qt=="number"&&(qt=String(qt)),Nt(qt,Ye)||Ye<bt&&Nt(xt[Ye].uid,Ye)||vt(a.randstr($e),Ye)}return nt}(N,te),ne._globalTransforms=(V._context||{}).globalTransforms,i.supplyDataDefaults(te,U,H,ne);var fe=Object.keys(ve.x),me=Object.keys(ve.y);if(fe.length>1&&me.length>1){for(e.getComponentMethod("grid","sizeDefaults")(H,ne),$=0;$<fe.length;$++)a.pushUnique(ce.xaxis,fe[$]);for($=0;$<me.length;$++)a.pushUnique(ce.yaxis,me[$]);for(var _e in Ae)a.pushUnique(ce.cartesian,_e)}if(ne._has=i._hasPlotType.bind(ne),N.length===U.length)for($=0;$<U.length;$++)p(U[$],N[$]);i.supplyLayoutModuleDefaults(H,ne,U,V._transitionData);var le=ne._visibleModules,ge=[];for($=0;$<le.length;$++){var Te=le[$].crossTraceDefaults;Te&&a.pushUnique(ge,Te)}for($=0;$<ge.length;$++)ge[$](U,ne);ne._hasOnlyLargeSploms=ne._basePlotModules.length===1&&ne._basePlotModules[0].name==="splom"&&fe.length>15&&me.length>15&&ne.shapes.length===0&&ne.images.length===0,i.linkSubplots(U,ne,N,K),i.cleanPlot(U,ne,N,K);var Se=!(!K._has||!K._has("gl2d")),Me=!(!ne._has||!ne._has("gl2d")),ze=!(!K._has||!K._has("cartesian"))||Se,Oe=!(!ne._has||!ne._has("cartesian"))||Me;ze&&!Oe?K._bgLayer.remove():Oe&&!ze&&(ne._shouldCreateBgLayer=!0),K._zoomlayer&&!V._dragging&&s({_fullLayout:K}),function(Ie,Re){var Ye,Qe=[];Re.meta&&(Ye=Re._meta={meta:Re.meta,layout:{meta:Re.meta}});for(var lt=0;lt<Ie.length;lt++){var xt=Ie[lt];xt.meta?Qe[xt.index]=xt._meta={meta:xt.meta}:Re.meta&&(xt._meta={meta:Re.meta}),Re.meta&&(xt._meta.layout={meta:Re.meta})}Qe.length&&(Ye||(Ye=Re._meta={}),Ye.data=Qe)}(U,ne),p(ne,K),e.getComponentMethod("colorscale","crossTraceDefaults")(U,ne),ne._preGUI||(ne._preGUI={}),ne._tracePreGUI||(ne._tracePreGUI={});var De,Xe=ne._tracePreGUI,Be={};for(De in Xe)Be[De]="old";for($=0;$<U.length;$++)Be[De=U[$]._fullInput.uid]||(Xe[De]={}),Be[De]="new";for(De in Be)Be[De]==="old"&&delete Xe[De];P(ne),e.getComponentMethod("rangeslider","makeData")(ne),Q||B.length!==U.length||i.supplyDefaultsUpdateCalc(B,U)}},i.supplyDefaultsUpdateCalc=function(V,Z){for(var Q=0;Q<Z.length;Q++){var K=Z[Q],$=(V[Q]||[])[0];if($&&$.trace){var ne=$.trace;if(ne._hasCalcTransform){var H,N,U,te=ne._arrayAttrs;for(H=0;H<te.length;H++)N=te[H],U=a.nestedProperty(ne,N).get().slice(),a.nestedProperty(K,N).set(U)}$.trace=K}}},i.createTransitionData=function(V){V._transitionData||(V._transitionData={}),V._transitionData._frames||(V._transitionData._frames=[]),V._transitionData._frameHash||(V._transitionData._frameHash={}),V._transitionData._counter||(V._transitionData._counter=0),V._transitionData._interruptCallbacks||(V._transitionData._interruptCallbacks=[])},i._hasPlotType=function(V){var Z,Q=this._basePlotModules||[];for(Z=0;Z<Q.length;Z++)if(Q[Z].name===V)return!0;var K=this._modules||[];for(Z=0;Z<K.length;Z++){var $=K[Z].name;if($===V)return!0;var ne=e.modules[$];if(ne&&ne.categories[V])return!0}return!1},i.cleanPlot=function(V,Z,Q,K){var $,ne,H=K._basePlotModules||[];for($=0;$<H.length;$++){var N=H[$];N.clean&&N.clean(V,Z,Q,K)}var U=K._has&&K._has("gl"),te=Z._has&&Z._has("gl");U&&!te&&K._glcontainer!==void 0&&(K._glcontainer.selectAll(".gl-canvas").remove(),K._glcontainer.selectAll(".no-webgl").remove(),K._glcanvas=null);var B=!!K._infolayer;e:for($=0;$<Q.length;$++){var X=Q[$].uid;for(ne=0;ne<V.length;ne++)if(X===V[ne].uid)continue e;B&&K._infolayer.select(".cb"+X).remove()}},i.linkSubplots=function(V,Z,Q,K){var $,ne,H=K._plots||{},N=Z._plots={},U=Z._subplots,te={_fullData:V,_fullLayout:Z},B=U.cartesian.concat(U.gl2d||[]);for($=0;$<B.length;$++){var X,J=B[$],ee=H[J],re=u.getFromId(te,J,"x"),se=u.getFromId(te,J,"y");for(ee?X=N[J]=ee:(X=N[J]={}).id=J,re._counterAxes.push(se._id),se._counterAxes.push(re._id),re._subplotsWith.push(J),se._subplotsWith.push(J),X.xaxis=re,X.yaxis=se,X._hasClipOnAxisFalse=!1,ne=0;ne<V.length;ne++){var oe=V[ne];if(oe.xaxis===X.xaxis._id&&oe.yaxis===X.yaxis._id&&oe.cliponaxis===!1){X._hasClipOnAxisFalse=!0;break}}}var de,ce=u.list(te,null,!0);for($=0;$<ce.length;$++){var ve=null;(de=ce[$]).overlaying&&(ve=u.getFromId(te,de.overlaying))&&ve.overlaying&&(de.overlaying=!1,ve=null),de._mainAxis=ve||de,ve&&(de.domain=ve.domain.slice()),de._anchorAxis=de.anchor==="free"?null:u.getFromId(te,de.anchor)}for($=0;$<ce.length;$++)if((de=ce[$])._counterAxes.sort(u.idSort),de._subplotsWith.sort(a.subplotSort),de._mainSubplot=k(de,Z),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var Ae=1,fe=0;for(ne=0;ne<de._counterAxes.length;ne++){var me=u.getFromId(te,de._counterAxes[ne]);Ae=Math.min(Ae,me.domain[0]),fe=Math.max(fe,me.domain[1])}Ae<fe&&(de._counterDomainMin=Ae,de._counterDomainMax=fe)}},i.clearExpandedTraceDefaultColors=function(V){var Z,Q,K;for(Q=[],(Z=V._module._colorAttrs)||(V._module._colorAttrs=Z=[],t.crawl(V._module.attributes,function($,ne,H,N){Q[N]=ne,Q.length=N+1,$.valType==="color"&&$.dflt===void 0&&Z.push(Q.join("."))})),K=0;K<Z.length;K++)a.nestedProperty(V,"_input."+Z[K]).get()||a.nestedProperty(V,Z[K]).set(null)},i.supplyDataDefaults=function(V,Z,Q,K){var $,ne,H,N=K._modules,U=K._visibleModules,te=K._basePlotModules,B=0,X=0;function J(_e){Z.push(_e);var le=_e._module;le&&(a.pushUnique(N,le),_e.visible===!0&&a.pushUnique(U,le),a.pushUnique(te,_e._module.basePlotModule),B++,_e._input.visible!==!1&&X++)}K._transformModules=[];var ee={},re=[],se=(Q.template||{}).data||{},oe=n.traceTemplater(se);for($=0;$<V.length;$++){if(H=V[$],(ne=oe.newTrace(H)).uid=K._traceUids[$],i.supplyTraceDefaults(H,ne,X,K,$),ne.index=$,ne._input=H,ne._expandedIndex=B,ne.transforms&&ne.transforms.length)for(var de=H.visible!==!1&&ne.visible===!1,ce=A(ne,Z,Q,K),ve=0;ve<ce.length;ve++){var Ae=ce[ve],fe={_template:ne._template,type:ne.type,uid:ne.uid+ve};de&&Ae.visible===!1&&delete Ae.visible,i.supplyTraceDefaults(Ae,fe,B,K,$),p(fe,Ae),fe.index=$,fe._input=H,fe._fullInput=ne,fe._expandedIndex=B,fe._expandedInput=Ae,J(fe)}else ne._fullInput=ne,ne._expandedInput=ne,J(ne);e.traceIs(ne,"carpetAxis")&&(ee[ne.carpet]=ne),e.traceIs(ne,"carpetDependent")&&re.push($)}for($=0;$<re.length;$++)if((ne=Z[re[$]]).visible){var me=ee[ne.carpet];ne._carpet=me,me&&me.visible?(ne.xaxis=me.xaxis,ne.yaxis=me.yaxis):ne.visible=!1}},i.supplyAnimationDefaults=function(V){var Z;V=V||{};var Q={};function K($,ne){return a.coerce(V||{},Q,h,$,ne)}if(K("mode"),K("direction"),K("fromcurrent"),Array.isArray(V.frame))for(Q.frame=[],Z=0;Z<V.frame.length;Z++)Q.frame[Z]=i.supplyAnimationFrameDefaults(V.frame[Z]||{});else Q.frame=i.supplyAnimationFrameDefaults(V.frame||{});if(Array.isArray(V.transition))for(Q.transition=[],Z=0;Z<V.transition.length;Z++)Q.transition[Z]=i.supplyAnimationTransitionDefaults(V.transition[Z]||{});else Q.transition=i.supplyAnimationTransitionDefaults(V.transition||{});return Q},i.supplyAnimationFrameDefaults=function(V){var Z={};function Q(K,$){return a.coerce(V||{},Z,h.frame,K,$)}return Q("duration"),Q("redraw"),Z},i.supplyAnimationTransitionDefaults=function(V){var Z={};function Q(K,$){return a.coerce(V||{},Z,h.transition,K,$)}return Q("duration"),Q("easing"),Z},i.supplyFrameDefaults=function(V){var Z={};function Q(K,$){return a.coerce(V,Z,l,K,$)}return Q("group"),Q("name"),Q("traces"),Q("baseframe"),Q("data"),Q("layout"),Z},i.supplyTraceDefaults=function(V,Z,Q,K,$){var ne,H=K.colorway||r.defaults,N=H[Q%H.length];function U(ce,ve){return a.coerce(V,Z,i.attributes,ce,ve)}var te=U("visible");U("type"),U("name",K._traceWord+" "+$),U("uirevision",K.uirevision);var B=i.getModule(Z);if(Z._module=B,B){var X=B.basePlotModule,J=X.attr,ee=X.attributes;if(J&&ee){var re=K._subplots,se="";if(te||X.name!=="gl2d"){if(Array.isArray(J))for(ne=0;ne<J.length;ne++){var oe=J[ne],de=a.coerce(V,Z,ee,oe);re[oe]&&a.pushUnique(re[oe],de),se+=de}else se=a.coerce(V,Z,ee,J);re[X.name]&&a.pushUnique(re[X.name],se)}}}return te&&(U("customdata"),U("ids"),U("meta"),e.traceIs(Z,"showLegend")?(a.coerce(V,Z,B.attributes.showlegend?B.attributes:i.attributes,"showlegend"),U("legendwidth"),U("legendgroup"),U("legendgrouptitle.text"),U("legendrank"),Z._dfltShowLegend=!0):Z._dfltShowLegend=!1,B&&B.supplyDefaults(V,Z,N,K),e.traceIs(Z,"noOpacity")||U("opacity"),e.traceIs(Z,"notLegendIsolatable")&&(Z.visible=!!Z.visible),e.traceIs(Z,"noHover")||(Z.hovertemplate||a.coerceHoverinfo(V,Z,K),Z.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(V,Z,N,K)),B&&B.selectPoints&&U("selectedpoints"),i.supplyTransformDefaults(V,Z,K)),Z},i.hasMakesDataTransform=L,i.supplyTransformDefaults=function(V,Z,Q){if(Z._length||L(V)){var K=Q._globalTransforms||[],$=Q._transformModules||[];if(Array.isArray(V.transforms)||K.length!==0)for(var ne=V.transforms||[],H=K.concat(ne),N=Z.transforms=[],U=0;U<H.length;U++){var te,B=H[U],X=B.type,J=x[X],ee=!(B._module&&B._module===J),re=J&&typeof J.transform=="function";J||a.warn("Unrecognized transform type "+X+"."),J&&J.supplyDefaults&&(ee||re)?((te=J.supplyDefaults(B,Z,Q,V)).type=X,te._module=J,a.pushUnique($,J)):te=a.extendFlat({},B),N.push(te)}}},i.supplyLayoutGlobalDefaults=function(V,Z,Q){function K(U,te){return a.coerce(V,Z,i.layoutAttributes,U,te)}var $=V.template;a.isPlainObject($)&&(Z.template=$,Z._template=$.layout,Z._dataTemplate=$.data),K("autotypenumbers");var ne=a.coerceFont(K,"font"),H=ne.size;a.coerceFont(K,"title.font",a.extendFlat({},ne,{size:Math.round(1.4*H)})),K("title.text",Z._dfltTitle.plot),K("title.xref"),K("title.yref"),K("title.x"),K("title.y"),K("title.xanchor"),K("title.yanchor"),K("title.pad.t"),K("title.pad.r"),K("title.pad.b"),K("title.pad.l"),K("uniformtext.mode")&&K("uniformtext.minsize"),K("autosize",!(V.width&&V.height)),K("width"),K("height"),K("minreducedwidth"),K("minreducedheight"),K("margin.l"),K("margin.r"),K("margin.t"),K("margin.b"),K("margin.pad"),K("margin.autoexpand"),V.width&&V.height&&i.sanitizeMargins(Z),e.getComponentMethod("grid","sizeDefaults")(V,Z),K("paper_bgcolor"),K("separators",Q.decimal+Q.thousands),K("hidesources"),K("colorway"),K("datarevision");var N=K("uirevision");K("editrevision",N),K("selectionrevision",N),e.getComponentMethod("modebar","supplyLayoutDefaults")(V,Z),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(V,Z,K),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(V,Z,K),K("meta"),a.isPlainObject(V.transition)&&(K("transition.duration"),K("transition.easing"),K("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(V,Z,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(V,Z,K)},i.plotAutoSize=function(V,Z,Q){var K,$,ne=V._context||{},H=ne.frameMargins,N=a.isPlotDiv(V);if(N&&V.emit("plotly_autosize"),ne.fillFrame)K=window.innerWidth,$=window.innerHeight,document.body.style.overflow="hidden";else{var U=N?window.getComputedStyle(V):{};if(K=I(U.width)||I(U.maxWidth)||Q.width,$=I(U.height)||I(U.maxHeight)||Q.height,y(H)&&H>0){var te=1-2*H;K=Math.round(te*K),$=Math.round(te*$)}}var B=i.layoutAttributes.width.min,X=i.layoutAttributes.height.min;K<B&&(K=B),$<X&&($=X);var J=!Z.width&&Math.abs(Q.width-K)>1,ee=!Z.height&&Math.abs(Q.height-$)>1;(ee||J)&&(J&&(Q.width=K),ee&&(Q.height=$)),V._initialAutoSize||(V._initialAutoSize={width:K,height:$}),i.sanitizeMargins(Q)},i.supplyLayoutModuleDefaults=function(V,Z,Q,K){var $,ne,H,N=e.componentsRegistry,U=Z._basePlotModules,te=e.subplotsRegistry.cartesian;for($ in N)(H=N[$]).includeBasePlot&&H.includeBasePlot(V,Z);for(var B in U.length||U.push(te),Z._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(V,Z),te.finalizeSubplots(V,Z)),Z._subplots)Z._subplots[B].sort(a.subplotSort);for(ne=0;ne<U.length;ne++)(H=U[ne]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q);var X=Z._modules;for(ne=0;ne<X.length;ne++)(H=X[ne]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q);var J=Z._transformModules;for(ne=0;ne<J.length;ne++)(H=J[ne]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q,K);for($ in N)(H=N[$]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q)},i.purge=function(V){var Z=V._fullLayout||{};Z._glcontainer!==void 0&&(Z._glcontainer.selectAll(".gl-canvas").remove(),Z._glcontainer.remove(),Z._glcanvas=null),Z._modeBar&&Z._modeBar.destroy(),V._transitionData&&(V._transitionData._interruptCallbacks&&(V._transitionData._interruptCallbacks.length=0),V._transitionData._animationRaf&&window.cancelAnimationFrame(V._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(V),delete V.data,delete V.layout,delete V._fullData,delete V._fullLayout,delete V.calcdata,delete V.empty,delete V.fid,delete V.undoqueue,delete V.undonum,delete V.autoplay,delete V.changed,delete V._promises,delete V._redrawTimer,delete V._hmlumcount,delete V._hmpixcount,delete V._transitionData,delete V._transitioning,delete V._initialAutoSize,delete V._transitioningWithDuration,delete V._dragging,delete V._dragged,delete V._dragdata,delete V._hoverdata,delete V._snapshotInProgress,delete V._editing,delete V._mouseDownTime,delete V._legendMouseDownTime,V.removeAllListeners&&V.removeAllListeners()},i.style=function(V){var Z,Q=V._fullLayout._visibleModules,K=[];for(Z=0;Z<Q.length;Z++){var $=Q[Z];$.style&&a.pushUnique(K,$.style)}for(Z=0;Z<K.length;Z++)K[Z](V)},i.sanitizeMargins=function(V){if(V&&V.margin){var Z,Q=V.width,K=V.height,$=V.margin,ne=Q-($.l+$.r),H=K-($.t+$.b);ne<0&&(Z=(Q-1)/($.l+$.r),$.l=Math.floor(Z*$.l),$.r=Math.floor(Z*$.r)),H<0&&(Z=(K-1)/($.t+$.b),$.t=Math.floor(Z*$.t),$.b=Math.floor(Z*$.b))}},i.clearAutoMarginIds=function(V){V._fullLayout._pushmarginIds={}},i.allowAutoMargin=function(V,Z){V._fullLayout._pushmarginIds[Z]=1},i.autoMargin=function(V,Z,Q){var K=V._fullLayout,$=K.width,ne=K.height,H=K.margin,N=K.minreducedwidth,U=K.minreducedheight,te=a.constrain($-H.l-H.r,2,N),B=a.constrain(ne-H.t-H.b,2,U),X=Math.max(0,$-te),J=Math.max(0,ne-B),ee=K._pushmargin,re=K._pushmarginIds;if(H.autoexpand!==!1){if(Q){var se=Q.pad;if(se===void 0&&(se=Math.min(12,H.l,H.r,H.t,H.b)),X){var oe=(Q.l+Q.r)/X;oe>1&&(Q.l/=oe,Q.r/=oe)}if(J){var de=(Q.t+Q.b)/J;de>1&&(Q.t/=de,Q.b/=de)}var ce=Q.xl!==void 0?Q.xl:Q.x,ve=Q.xr!==void 0?Q.xr:Q.x,Ae=Q.yt!==void 0?Q.yt:Q.y,fe=Q.yb!==void 0?Q.yb:Q.y;ee[Z]={l:{val:ce,size:Q.l+se},r:{val:ve,size:Q.r+se},b:{val:fe,size:Q.b+se},t:{val:Ae,size:Q.t+se}},re[Z]=1}else delete ee[Z],delete re[Z];if(!K._replotting)return i.doAutoMargin(V)}},i.doAutoMargin=function(V){var Z=V._fullLayout,Q=Z.width,K=Z.height;Z._size||(Z._size={}),P(Z);var $=Z._size,ne=Z.margin,H=a.extendFlat({},$),N=ne.l,U=ne.r,te=ne.t,B=ne.b,X=Z._pushmargin,J=Z._pushmarginIds,ee=Z.minreducedwidth,re=Z.minreducedheight;if(Z.margin.autoexpand!==!1){for(var se in X)J[se]||delete X[se];for(var oe in X.base={l:{val:0,size:N},r:{val:1,size:U},t:{val:1,size:te},b:{val:0,size:B}},X){var de=X[oe].l||{},ce=X[oe].b||{},ve=de.val,Ae=de.size,fe=ce.val,me=ce.size;for(var _e in X){if(y(Ae)&&X[_e].r){var le=X[_e].r.val,ge=X[_e].r.size;if(le>ve){var Te=(Ae*le+(ge-Q)*ve)/(le-ve),Se=(ge*(1-ve)+(Ae-Q)*(1-le))/(le-ve);Te+Se>N+U&&(N=Te,U=Se)}}if(y(me)&&X[_e].t){var Me=X[_e].t.val,ze=X[_e].t.size;if(Me>fe){var Oe=(me*Me+(ze-K)*fe)/(Me-fe),De=(ze*(1-fe)+(me-K)*(1-Me))/(Me-fe);Oe+De>B+te&&(B=Oe,te=De)}}}}}var Xe=a.constrain(Q-ne.l-ne.r,2,ee),Be=a.constrain(K-ne.t-ne.b,2,re),Ie=Math.max(0,Q-Xe),Re=Math.max(0,K-Be);if(Ie){var Ye=(N+U)/Ie;Ye>1&&(N/=Ye,U/=Ye)}if(Re){var Qe=(B+te)/Re;Qe>1&&(B/=Qe,te/=Qe)}if($.l=Math.round(N),$.r=Math.round(U),$.t=Math.round(te),$.b=Math.round(B),$.p=Math.round(ne.pad),$.w=Math.round(Q)-$.l-$.r,$.h=Math.round(K)-$.t-$.b,!Z._replotting&&i.didMarginChange(H,$)){"_redrawFromAutoMarginCount"in Z?Z._redrawFromAutoMarginCount++:Z._redrawFromAutoMarginCount=1;var lt=3*(1+Object.keys(J).length);if(Z._redrawFromAutoMarginCount<lt)return e.call("_doPlot",V);Z._size=H,a.warn("Too many auto-margin redraws.")}(function(xt){var wt=u.list(xt,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(bt){for(var nt=0;nt<wt.length;nt++){var $e=wt[nt][bt];$e&&$e()}})})(V)};var S=["l","r","t","b","p","w","h"];function E(V,Z,Q){var K=!1,$=[i.previousPromises,function(){if(V._transitionData)return V._transitioning=!1,function(H){var N=Promise.resolve();if(!H)return N;for(;H.length;)N=N.then(H.shift());return N}(V._transitionData._interruptCallbacks)},Q.prepareFn,i.rehover,i.reselect,function(){return V.emit("plotly_transitioning",[]),new Promise(function(H){V._transitioning=!0,Z.duration>0&&(V._transitioningWithDuration=!0),V._transitionData._interruptCallbacks.push(function(){K=!0}),Q.redraw&&V._transitionData._interruptCallbacks.push(function(){return e.call("redraw",V)}),V._transitionData._interruptCallbacks.push(function(){V.emit("plotly_transitioninterrupted",[])});var N=0,U=0;function te(){return N++,function(){U++,K||U!==N||function(B){!V._transitionData||(function(X){if(X)for(;X.length;)X.shift()}(V._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(Q.redraw)return e.call("redraw",V)}).then(function(){V._transitioning=!1,V._transitioningWithDuration=!1,V.emit("plotly_transitioned",[])}).then(B))}(H)}}Q.runFn(te),setTimeout(te())})}],ne=a.syncOrAsync($,V);return ne&&ne.then||(ne=Promise.resolve()),ne.then(function(){return V})}i.didMarginChange=function(V,Z){for(var Q=0;Q<S.length;Q++){var K=S[Q],$=V[K],ne=Z[K];if(!y($)||Math.abs(ne-$)>1)return!0}return!1},i.graphJson=function(V,Z,Q,K,$,ne){($&&Z&&!V._fullData||$&&!Z&&!V._fullLayout)&&i.supplyDefaults(V);var H=$?V._fullData:V.data,N=$?V._fullLayout:V.layout,U=(V._transitionData||{})._frames;function te(J,ee){if(typeof J=="function")return ee?"_function_":null;if(a.isPlainObject(J)){var re,se={};return Object.keys(J).sort().forEach(function(oe){if(["_","["].indexOf(oe.charAt(0))===-1)if(typeof J[oe]!="function"){if(Q==="keepdata"){if(oe.substr(oe.length-3)==="src")return}else if(Q==="keepstream"){if(typeof(re=J[oe+"src"])=="string"&&re.indexOf(":")>0&&!a.isPlainObject(J.stream))return}else if(Q!=="keepall"&&typeof(re=J[oe+"src"])=="string"&&re.indexOf(":")>0)return;se[oe]=te(J[oe],ee)}else ee&&(se[oe]="_function")}),se}return Array.isArray(J)?J.map(function(oe){return te(oe,ee)}):a.isTypedArray(J)?a.simpleMap(J,a.identity):a.isJSDate(J)?a.ms2DateTimeLocal(+J):J}var B={data:(H||[]).map(function(J){var ee=te(J);return Z&&delete ee.fit,ee})};if(!Z&&(B.layout=te(N),$)){var X=N._size;B.layout.computed={margin:{b:X.b,l:X.l,r:X.r,t:X.t}}}return U&&(B.frames=te(U)),ne&&(B.config=te(V._context,!0)),K==="object"?B:JSON.stringify(B)},i.modifyFrames=function(V,Z){var Q,K,$,ne=V._transitionData._frames,H=V._transitionData._frameHash;for(Q=0;Q<Z.length;Q++)switch((K=Z[Q]).type){case"replace":$=K.value;var N=(ne[K.index]||{}).name,U=$.name;ne[K.index]=H[U]=$,U!==N&&(delete H[N],H[U]=$);break;case"insert":H[($=K.value).name]=$,ne.splice(K.index,0,$);break;case"delete":delete H[($=ne[K.index]).name],ne.splice(K.index,1)}return Promise.resolve()},i.computeFrame=function(V,Z){var Q,K,$,ne,H=V._transitionData._frameHash;if(!Z)throw new Error("computeFrame must be given a string frame name");var N=H[Z.toString()];if(!N)return!1;for(var U=[N],te=[N.name];N.baseframe&&(N=H[N.baseframe.toString()])&&te.indexOf(N.name)===-1;)U.push(N),te.push(N.name);for(var B={};N=U.pop();)if(N.layout&&(B.layout=i.extendLayout(B.layout,N.layout)),N.data){if(B.data||(B.data=[]),!(K=N.traces))for(K=[],Q=0;Q<N.data.length;Q++)K[Q]=Q;for(B.traces||(B.traces=[]),Q=0;Q<N.data.length;Q++)($=K[Q])!=null&&((ne=B.traces.indexOf($))===-1&&(ne=B.data.length,B.traces[ne]=$),B.data[ne]=i.extendTrace(B.data[ne],N.data[Q]))}return B},i.recomputeFrameHash=function(V){for(var Z=V._transitionData._frameHash={},Q=V._transitionData._frames,K=0;K<Q.length;K++){var $=Q[K];$&&$.name&&(Z[$.name]=$)}},i.extendObjectWithContainers=function(V,Z,Q){var K,$,ne,H,N,U,te,B=a.extendDeepNoArrays({},Z||{}),X=a.expandObjectPaths(B),J={};if(Q&&Q.length)for(ne=0;ne<Q.length;ne++)($=(K=a.nestedProperty(X,Q[ne])).get())===void 0?a.nestedProperty(J,Q[ne]).set(null):(K.set(null),a.nestedProperty(J,Q[ne]).set($));if(V=a.extendDeepNoArrays(V||{},X),Q&&Q.length){for(ne=0;ne<Q.length;ne++)if(U=a.nestedProperty(J,Q[ne]).get()){for(te=(N=a.nestedProperty(V,Q[ne])).get(),Array.isArray(te)||(te=[],N.set(te)),H=0;H<U.length;H++){var ee=U[H];te[H]=ee===null?null:i.extendObjectWithContainers(te[H],ee)}N.set(te)}}return V},i.dataArrayContainers=["transforms","dimensions"],i.layoutArrayContainers=e.layoutArrayContainers,i.extendTrace=function(V,Z){return i.extendObjectWithContainers(V,Z,i.dataArrayContainers)},i.extendLayout=function(V,Z){return i.extendObjectWithContainers(V,Z,i.layoutArrayContainers)},i.transition=function(V,Z,Q,K,$,ne){var H={redraw:$.redraw},N={},U=[];return H.prepareFn=function(){for(var te=Array.isArray(Z)?Z.length:0,B=K.slice(0,te),X=0;X<B.length;X++){var J=B[X],ee=V._fullData[J]._module;if(ee){if(ee.animatable){var re=ee.basePlotModule.name;N[re]||(N[re]=[]),N[re].push(J)}V.data[B[X]]=i.extendTrace(V.data[B[X]],Z[X])}}var se=a.expandObjectPaths(a.extendDeepNoArrays({},Q)),oe=/^[xy]axis[0-9]*$/;for(var de in se)oe.test(de)&&delete se[de].range;i.extendLayout(V.layout,se),delete V.calcdata,i.supplyDefaults(V),i.doCalcdata(V);var ce=a.expandObjectPaths(Q);if(ce){var ve=V._fullLayout._plots;for(var Ae in ve){var fe=ve[Ae],me=fe.xaxis,_e=fe.yaxis,le=me.range.slice(),ge=_e.range.slice(),Te=null,Se=null,Me=null,ze=null;Array.isArray(ce[me._name+".range"])?Te=ce[me._name+".range"].slice():Array.isArray((ce[me._name]||{}).range)&&(Te=ce[me._name].range.slice()),Array.isArray(ce[_e._name+".range"])?Se=ce[_e._name+".range"].slice():Array.isArray((ce[_e._name]||{}).range)&&(Se=ce[_e._name].range.slice()),le&&Te&&(me.r2l(le[0])!==me.r2l(Te[0])||me.r2l(le[1])!==me.r2l(Te[1]))&&(Me={xr0:le,xr1:Te}),ge&&Se&&(_e.r2l(ge[0])!==_e.r2l(Se[0])||_e.r2l(ge[1])!==_e.r2l(Se[1]))&&(ze={yr0:ge,yr1:Se}),(Me||ze)&&U.push(a.extendFlat({plotinfo:fe},Me,ze))}}return Promise.resolve()},H.runFn=function(te){var B,X,J=V._fullLayout._basePlotModules,ee=U.length;if(Q)for(X=0;X<J.length;X++)J[X].transitionAxes&&J[X].transitionAxes(V,U,ne,te);for(var re in ee?((B=a.extendFlat({},ne)).duration=0,delete N.cartesian):B=ne,N){var se=N[re];V._fullData[se[0]]._module.basePlotModule.plot(V,se,B,te)}},E(V,ne,H)},i.transitionFromReact=function(V,Z,Q,K){var $=V._fullLayout,ne=$.transition,H={},N=[];return H.prepareFn=function(){var U=$._plots;for(var te in H.redraw=!1,Z.anim==="some"&&(H.redraw=!0),Q.anim==="some"&&(H.redraw=!0),U){var B=U[te],X=B.xaxis,J=B.yaxis,ee=K[X._name].range.slice(),re=K[J._name].range.slice(),se=X.range.slice(),oe=J.range.slice();X.setScale(),J.setScale();var de=null,ce=null;X.r2l(ee[0])===X.r2l(se[0])&&X.r2l(ee[1])===X.r2l(se[1])||(de={xr0:ee,xr1:se}),J.r2l(re[0])===J.r2l(oe[0])&&J.r2l(re[1])===J.r2l(oe[1])||(ce={yr0:re,yr1:oe}),(de||ce)&&N.push(a.extendFlat({plotinfo:B},de,ce))}return Promise.resolve()},H.runFn=function(U){for(var te,B,X,J=V._fullData,ee=V._fullLayout._basePlotModules,re=[],se=0;se<J.length;se++)re.push(se);function oe(){if(V._fullLayout)for(var ce=0;ce<ee.length;ce++)ee[ce].transitionAxes&&ee[ce].transitionAxes(V,N,te,U)}function de(){if(V._fullLayout)for(var ce=0;ce<ee.length;ce++)ee[ce].plot(V,X,B,U)}N.length&&Z.anim?ne.ordering==="traces first"?(te=a.extendFlat({},ne,{duration:0}),X=re,B=ne,setTimeout(oe,ne.duration),de()):(te=ne,X=null,B=a.extendFlat({},ne,{duration:0}),setTimeout(de,te.duration),oe()):N.length?(te=ne,oe()):Z.anim&&(X=re,B=ne,de())},E(V,ne,H)},i.doCalcdata=function(V,Z){var Q,K,$,ne,H=u.list(V),N=V._fullData,U=V._fullLayout,te=new Array(N.length),B=(V.calcdata||[]).slice();for(V.calcdata=te,U._numBoxes=0,U._numViolins=0,U._violinScaleGroupStats={},V._hmpixcount=0,V._hmlumcount=0,U._piecolormap={},U._sunburstcolormap={},U._treemapcolormap={},U._iciclecolormap={},U._funnelareacolormap={},$=0;$<N.length;$++)Array.isArray(Z)&&Z.indexOf($)===-1&&(te[$]=B[$]);for($=0;$<N.length;$++)(Q=N[$])._arrayAttrs=t.findArrayAttributes(Q),Q._extremes={};var X=U._subplots.polar||[];for($=0;$<X.length;$++)H.push(U[X[$]].radialaxis,U[X[$]].angularaxis);for(var J in U._colorAxes){var ee=U[J];ee.cauto!==!1&&(delete ee.cmin,delete ee.cmax)}var re=!1;function se(ce){if(Q=N[ce],K=Q._module,Q.visible===!0&&Q.transforms){if(K&&K.calc){var ve=K.calc(V,Q);ve[0]&&ve[0].t&&ve[0].t._scene&&delete ve[0].t._scene.dirty}for(ne=0;ne<Q.transforms.length;ne++){var Ae=Q.transforms[ne];(K=x[Ae.type])&&K.calcTransform&&(Q._hasCalcTransform=!0,re=!0,K.calcTransform(V,Q,Ae))}}}function oe(ce,ve){if(Q=N[ce],!!(K=Q._module).isContainer===ve){var Ae=[];if(Q.visible===!0&&Q._length!==0){delete Q._indexToPoints;var fe=Q.transforms||[];for(ne=fe.length-1;ne>=0;ne--)if(fe[ne].enabled){Q._indexToPoints=fe[ne]._indexToPoints;break}K&&K.calc&&(Ae=K.calc(V,Q))}Array.isArray(Ae)&&Ae[0]||(Ae=[{x:g,y:g}]),Ae[0].t||(Ae[0].t={}),Ae[0].trace=Q,te[ce]=Ae}}for(D(H,N,U),$=0;$<N.length;$++)oe($,!0);for($=0;$<N.length;$++)se($);for(re&&D(H,N,U),$=0;$<N.length;$++)oe($,!0);for($=0;$<N.length;$++)oe($,!1);j(V);var de=function(ce,ve){var Ae,fe,me,_e,le,ge=[];function Te(Dt,Ne,qe){var pe=Ne._id.charAt(0);if(Dt==="histogram2dcontour"){var be=Ne._counterAxes[0],Fe=u.getFromId(ve,be),Ve=pe==="x"||be==="x"&&Fe.type==="category",Ke=pe==="y"||be==="y"&&Fe.type==="category";return function(Ge,ct){return Ge===0||ct===0||Ve&&Ge===qe[ct].length-1||Ke&&ct===qe.length-1?-1:(pe==="y"?ct:Ge)-1}}return function(Ge,ct){return pe==="y"?ct:Ge}}var Se={min:function(Dt){return a.aggNums(Math.min,null,Dt)},max:function(Dt){return a.aggNums(Math.max,null,Dt)},sum:function(Dt){return a.aggNums(function(Ne,qe){return Ne+qe},null,Dt)},total:function(Dt){return a.aggNums(function(Ne,qe){return Ne+qe},null,Dt)},mean:function(Dt){return a.mean(Dt)},median:function(Dt){return a.median(Dt)}};for(Ae=0;Ae<ce.length;Ae++){var Me=ce[Ae];if(Me.type==="category"){var ze=Me.categoryorder.match(z);if(ze){var Oe=ze[1],De=ze[2],Xe=Me._id.charAt(0),Be=Xe==="x",Ie=[];for(fe=0;fe<Me._categories.length;fe++)Ie.push([Me._categories[fe],[]]);for(fe=0;fe<Me._traceIndices.length;fe++){var Re=Me._traceIndices[fe],Ye=ve._fullData[Re];if(Ye.visible===!0){var Qe=Ye.type;e.traceIs(Ye,"histogram")&&(delete Ye._xautoBinFinished,delete Ye._yautoBinFinished);var lt=Qe==="splom",xt=Qe==="scattergl",wt=ve.calcdata[Re];for(me=0;me<wt.length;me++){var bt,nt,$e=wt[me];if(lt){var vt=Ye._axesDim[Me._id];if(!Be){var Nt=Ye._diag[vt][0];Nt&&(Me=ve._fullLayout[u.id2name(Nt)])}var qt=$e.trace.dimensions[vt].values;for(_e=0;_e<qt.length;_e++)for(bt=Me._categoriesMap[qt[_e]],le=0;le<$e.trace.dimensions.length;le++)if(le!==vt){var Jt=$e.trace.dimensions[le];Ie[bt][1].push(Jt.values[_e])}}else if(xt){for(_e=0;_e<$e.t.x.length;_e++)Be?(bt=$e.t.x[_e],nt=$e.t.y[_e]):(bt=$e.t.y[_e],nt=$e.t.x[_e]),Ie[bt][1].push(nt);$e.t&&$e.t._scene&&delete $e.t._scene.dirty}else if($e.hasOwnProperty("z")){nt=$e.z;var Wt=Te(Ye.type,Me,nt);for(_e=0;_e<nt.length;_e++)for(le=0;le<nt[_e].length;le++)(bt=Wt(le,_e))+1&&Ie[bt][1].push(nt[_e][le])}else for((bt=$e.p)===void 0&&(bt=$e[Xe]),(nt=$e.s)===void 0&&(nt=$e.v),nt===void 0&&(nt=Be?$e.y:$e.x),Array.isArray(nt)||(nt=nt===void 0?[]:[nt]),_e=0;_e<nt.length;_e++)Ie[bt][1].push(nt[_e])}}}Me._categoriesValue=Ie;var ar=[];for(fe=0;fe<Ie.length;fe++)ar.push([Ie[fe][0],Se[Oe](Ie[fe][1])]);ar.sort(function(Dt,Ne){return Dt[1]-Ne[1]}),Me._categoriesAggregatedValue=ar,Me._initialCategories=ar.map(function(Dt){return Dt[0]}),De==="descending"&&Me._initialCategories.reverse(),ge=ge.concat(Me.sortByInitialCategories())}}}return ge}(H,V);if(de.length){for(U._numBoxes=0,U._numViolins=0,$=0;$<de.length;$++)oe(de[$],!0);for($=0;$<de.length;$++)oe(de[$],!1);j(V)}e.getComponentMethod("fx","calc")(V),e.getComponentMethod("errorbars","calc")(V)};var z=/(total|sum|min|max|mean|median) (ascending|descending)/;function D(V,Z,Q){var K={};function $(U){U.clearCalc(),U.type==="multicategory"&&U.setupMultiCategory(Z),K[U._id]=1}a.simpleMap(V,$);for(var ne=Q._axisMatchGroups||[],H=0;H<ne.length;H++)for(var N in ne[H])K[N]||$(Q[u.id2name(N)])}function j(V){var Z,Q,K,$=V._fullLayout,ne=$._visibleModules,H={};for(Q=0;Q<ne.length;Q++){var N=ne[Q],U=N.crossTraceCalc;if(U){var te=N.basePlotModule.name;H[te]?a.pushUnique(H[te],U):H[te]=[U]}}for(K in H){var B=H[K],X=$._subplots[K];if(Array.isArray(X))for(Z=0;Z<X.length;Z++){var J=X[Z],ee=K==="cartesian"?$._plots[J]:$[J];for(Q=0;Q<B.length;Q++)B[Q](V,ee,J)}else for(Q=0;Q<B.length;Q++)B[Q](V)}}i.rehover=function(V){V._fullLayout._rehover&&V._fullLayout._rehover()},i.redrag=function(V){V._fullLayout._redrag&&V._fullLayout._redrag()},i.reselect=function(V){var Z=V._fullLayout,Q=(V.layout||{}).selections,K=Z._previousSelections;Z._previousSelections=Q;var $=Z._reselect||JSON.stringify(Q)!==JSON.stringify(K);e.getComponentMethod("selections","reselect")(V,$)},i.generalUpdatePerTraceModule=function(V,Z,Q,K){var $,ne=Z.traceHash,H={};for($=0;$<Q.length;$++){var N=Q[$],U=N[0].trace;U.visible&&(H[U.type]=H[U.type]||[],H[U.type].push(N))}for(var te in ne)if(!H[te]){var B=ne[te][0];B[0].trace.visible=!1,H[te]=[B]}for(var X in H){var J=H[X];J[0][0].trace._module.plot(V,Z,a.filterVisible(J),K)}Z.traceHash=H},i.plotBasePlot=function(V,Z,Q,K,$){var ne=e.getModule(V),H=o(Z.calcdata,ne)[0];ne.plot(Z,H,K,$)},i.cleanBasePlot=function(V,Z,Q,K,$){var ne=$._has&&$._has(V),H=Q._has&&Q._has(V);ne&&!H&&$["_"+V+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(m,G,W){G.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(m,G,W){var d=m("../../lib"),v=m("../../lib/polygon").tester,w=d.findIndexOfMin,y=d.isAngleInsideSector,e=d.angleDelta,t=d.angleDist;function n(u,s,h,l){var o,p,c=l[0],i=l[1],x=r(Math.sin(s)-Math.sin(u)),f=r(Math.cos(s)-Math.cos(u)),_=Math.tan(h),b=r(1/_),T=x/f,k=i-T*c;return b?x&&f?p=_*(o=k/(_-T)):f?(o=i*b,p=i):(o=c,p=c*_):x&&f?(o=0,p=k):f?(o=0,p=i):o=p=NaN,[o,p]}function a(u,s,h,l){return d.isFullCircle([s,h])?function(o,p){var c,i=p.length,x=new Array(i+1);for(c=0;c<i;c++){var f=p[c];x[c]=[o*Math.cos(f),o*Math.sin(f)]}return x[c]=x[0].slice(),x}(u,l):function(o,p,c,i){var x,f,_=i.length,b=[];function T(D){return[o*Math.cos(D),o*Math.sin(D)]}function k(D,j,V){return n(D,j,V,T(D))}function L(D){return d.mod(D,_)}function A(D){return y(D,[p,c])}var I=w(i,function(D){return A(D)?t(D,p):1/0}),P=k(i[I],i[L(I-1)],p);for(b.push(P),x=I,f=0;f<_;x++,f++){var S=i[L(x)];if(!A(S))break;b.push(T(S))}var E=w(i,function(D){return A(D)?t(D,c):1/0}),z=k(i[E],i[L(E+1)],c);return b.push(z),b.push([0,0]),b.push(b[0].slice()),b}(u,s,h,l)}function r(u){return Math.abs(u)>1e-10?u:0}function g(u,s,h){s=s||0,h=h||0;for(var l=u.length,o=new Array(l),p=0;p<l;p++){var c=u[p];o[p]=[s+c[0],h-c[1]]}return o}G.exports={isPtInsidePolygon:function(u,s,h,l,o){if(!y(s,l))return!1;var p,c;h[0]<h[1]?(p=h[0],c=h[1]):(p=h[1],c=h[0]);var i=v(a(p,l[0],l[1],o)),x=v(a(c,l[0],l[1],o)),f=[u*Math.cos(s),u*Math.sin(s)];return x.contains(f)&&!i.contains(f)},findPolygonOffset:function(u,s,h,l){for(var o=1/0,p=1/0,c=a(u,s,h,l),i=0;i<c.length;i++){var x=c[i];o=Math.min(o,x[0]),p=Math.min(p,-x[1])}return[o,p]},findEnclosingVertexAngles:function(u,s){var h=w(s,function(o){var p=e(o,u);return p>0?p:1/0}),l=d.mod(h+1,s.length);return[s[h],s[l]]},findIntersectionXY:n,findXYatLength:function(u,s,h,l){var o=-s*h,p=s*s+1,c=2*(s*o-h),i=o*o+h*h-u*u,x=Math.sqrt(c*c-4*p*i),f=(-c+x)/(2*p),_=(-c-x)/(2*p);return[[f,s*f+o+l],[_,s*_+o+l]]},clampTiny:r,pathPolygon:function(u,s,h,l,o,p){return"M"+g(a(u,s,h,l),o,p).join("L")},pathPolygonAnnulus:function(u,s,h,l,o,p,c){var i,x;u<s?(i=u,x=s):(i=s,x=u);var f=g(a(i,h,l,o),p,c);return"M"+g(a(x,h,l,o),p,c).reverse().join("L")+"M"+f.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(m,G,W){var d=m("../get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("./polar"),y=m("./constants"),e=y.attr,t=y.name,n=v(t),a={};a[e]={valType:"subplotid",dflt:t,editType:"calc"},G.exports={attr:e,name:t,idRoot:t,idRegex:n,attrRegex:n,attributes:a,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(r){for(var g=r._fullLayout,u=r.calcdata,s=g._subplots[t],h=0;h<s.length;h++){var l=s[h],o=d(u,t,l),p=g[l]._subplot;p||(p=w(r,l),g[l]._subplot=p),p.plot(o,g,r._promises)}},clean:function(r,g,u,s){for(var h=s._subplots[t]||[],l=s._has&&s._has("gl"),o=g._has&&g._has("gl"),p=l&&!o,c=0;c<h.length;c++){var i=h[c],x=s[i]._subplot;if(!g[i]&&x)for(var f in x.framework.remove(),x.layers["radial-axis-title"].remove(),x.clipPaths)x.clipPaths[f].remove();p&&x._scene&&(x._scene.destroy(),x._scene=null)}},toSVG:m("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(m,G,W){var d=m("../../components/color/attributes"),v=m("../cartesian/layout_attributes"),w=m("../domain").attributes,y=m("../../lib").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=e({color:v.color,showline:y({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:y({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,ticklabelstep:v.ticklabelstep,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickfont:v.tickfont,tickangle:v.tickangle,tickformat:v.tickformat,tickformatstops:v.tickformatstops,layer:v.layer},"plot","from-root"),a={visible:y({},v.visible,{dflt:!0}),type:y({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:y({},v.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:y({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:v.categoryorder,categoryarray:v.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:y({},v.title.text,{editType:"plot",dflt:""}),font:y({},v.title.font,{editType:"plot"}),editType:"plot"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}};y(a,t,n);var r={visible:y({},v.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:v.autotypenumbers,categoryorder:v.categoryorder,categoryarray:v.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};y(r,t,n),G.exports={domain:w({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:d.background},radialaxis:a,angularaxis:r,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../../plot_api/plot_template"),y=m("../subplot_defaults"),e=m("../get_data").getSubplotData,t=m("../cartesian/tick_value_defaults"),n=m("../cartesian/tick_mark_defaults"),a=m("../cartesian/tick_label_defaults"),r=m("../cartesian/prefix_suffix_defaults"),g=m("../cartesian/category_order_defaults"),u=m("../cartesian/line_grid_defaults"),s=m("../cartesian/axis_autotype"),h=m("./layout_attributes"),l=m("./set_convert"),o=m("./constants"),p=o.axisNames;function c(x,f,_,b){var T=_("bgcolor");b.bgColor=v.combine(T,b.paper_bgcolor);var k=_("sector");_("hole");var L,A=e(b.fullData,o.name,b.id),I=b.layoutOut;function P(te,B){return _(L+"."+te,B)}for(var S=0;S<p.length;S++){L=p[S],d.isPlainObject(x[L])||(x[L]={});var E=x[L],z=w.newContainer(f,L);z._id=z._name=L,z._attr=b.id+"."+L,z._traceIndices=A.map(function(te){return te._expandedIndex});var D=o.axisName2dataArray[L],j=i(E,z,P,A,D,b);g(E,z,P,{axData:A,dataAttr:D});var V=P("visible");switch(l(z,f,I),P("uirevision",f.uirevision),z._m=1,L){case"radialaxis":var Z=P("autorange",!z.isValidRange(E.range));E.autorange=Z,!Z||j!=="linear"&&j!=="-"||P("rangemode"),Z==="reversed"&&(z._m=-1),P("range"),z.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(j==="date"){d.log("Polar plots do not support date angular axes yet.");for(var Q=0;Q<A.length;Q++)A[Q].visible=!1;j=E.type=z.type="linear"}P(j==="linear"?"thetaunit":"period");var K=P("direction");P("rotation",{counterclockwise:0,clockwise:90}[K])}if(r(E,z,P,z.type,{tickSuffixDflt:z.thetaunit==="degrees"?"\xB0":void 0}),V){var $,ne,H,N,U=b.font||{};ne=($=P("color"))===E.color?$:U.color,H=U.size,N=U.family,t(E,z,P,z.type),a(E,z,P,z.type,{font:{color:ne,size:H,family:N}}),n(E,z,P,{outerTicks:!0}),u(E,z,P,{dfltColor:$,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[L]}),P("layer"),L==="radialaxis"&&(P("side"),P("angle",k[0]),P("title.text"),d.coerceFont(P,"title.font",{color:ne,size:d.bigFont(H),family:N}))}j!=="category"&&P("hoverformat"),z._input=E}f.angularaxis.type==="category"&&_("gridshape")}function i(x,f,_,b,T,k){var L=_("autotypenumbers",k.autotypenumbersDflt);if(_("type")==="-"){for(var A,I=0;I<b.length;I++)if(b[I].visible){A=b[I];break}A&&A[T]&&(f.type=s(A[T],"gregorian",{noMultiCategory:!0,autotypenumbers:L})),f.type==="-"?f.type="linear":x.type=f.type}return f.type}G.exports=function(x,f,_){y(x,f,_,{type:o.name,attributes:h,handleDefaults:c,font:f.font,autotypenumbersDflt:f.autotypenumbers,paper_bgcolor:f.paper_bgcolor,fullData:_,layoutOut:f})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(m,G,W){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../lib"),e=y.strRotate,t=y.strTranslate,n=m("../../components/color"),a=m("../../components/drawing"),r=m("../plots"),g=m("../../plots/cartesian/axes"),u=m("../cartesian/set_convert"),s=m("./set_convert"),h=m("../cartesian/autorange").doAutoRange,l=m("../cartesian/dragbox"),o=m("../../components/dragelement"),p=m("../../components/fx"),c=m("../../components/titles"),i=m("../../components/selections").prepSelect,x=m("../../components/selections").selectOnClick,f=m("../../components/selections").clearOutline,_=m("../../lib/setcursor"),b=m("../../lib/clear_gl_canvases"),T=m("../../plot_api/subroutines").redrawReglTraces,k=m("../../constants/alignment").MID_SHIFT,L=m("./constants"),A=m("./helpers"),I=m("../smith/helpers"),P=I.smith,S=I.reactanceArc,E=I.resistanceArc,z=I.smithTransform,D=y._,j=y.mod,V=y.deg2rad,Z=y.rad2deg;function Q(N,U,te){this.isSmith=te||!1,this.id=U,this.gd=N,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var B=N._fullLayout,X="clip"+B._uid+U;this.clipIds.forTraces=X+"-for-traces",this.clipPaths.forTraces=B._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=B["_"+(te?"smith":"polar")+"layer"].append("g").attr("class",U),this.getHole=function(J){return this.isSmith?0:J.hole},this.getSector=function(J){return this.isSmith?[0,360]:J.sector},this.getRadial=function(J){return this.isSmith?J.realaxis:J.radialaxis},this.getAngular=function(J){return this.isSmith?J.imaginaryaxis:J.angularaxis},te||(this.radialTickLayout=null,this.angularTickLayout=null)}var K=Q.prototype;function $(N){var U=N.ticks+String(N.ticklen)+String(N.showticklabels);return"side"in N&&(U+=N.side),U}function ne(N,U){return U[y.findIndexOfMin(U,function(te){return y.angleDist(N,te)})]}function H(N,U,te){return U?(N.attr("display",null),N.attr(te)):N&&N.attr("display","none"),N}G.exports=function(N,U,te){return new Q(N,U,te)},K.plot=function(N,U){for(var te=U[this.id],B=!1,X=0;X<N.length;X++)if(N[X][0].trace.cliponaxis===!1){B=!0;break}this._hasClipOnAxisFalse=B,this.updateLayers(U,te),this.updateLayout(U,te),r.generalUpdatePerTraceModule(this.gd,this,N,te),this.updateFx(U,te),this.isSmith&&(delete te.realaxis.range,delete te.imaginaryaxis.range)},K.updateLayers=function(N,U){var te=this.isSmith,B=this.layers,X=this.getRadial(U),J=this.getAngular(U),ee=L.layerNames,re=ee.indexOf("frontplot"),se=ee.slice(0,re),oe=J.layer==="below traces",de=X.layer==="below traces";oe&&se.push("angular-line"),de&&se.push("radial-line"),oe&&se.push("angular-axis"),de&&se.push("radial-axis"),se.push("frontplot"),oe||se.push("angular-line"),de||se.push("radial-line"),oe||se.push("angular-axis"),de||se.push("radial-axis");var ce=(te?"smith":"polar")+"sublayer",ve=this.framework.selectAll("."+ce).data(se,String);ve.enter().append("g").attr("class",function(Ae){return ce+" "+Ae}).each(function(Ae){var fe=B[Ae]=d.select(this);switch(Ae){case"frontplot":te||fe.append("g").classed("barlayer",!0),fe.append("g").classed("scatterlayer",!0);break;case"backplot":fe.append("g").classed("maplayer",!0);break;case"plotbg":B.bg=fe.append("path");break;case"radial-grid":case"angular-grid":fe.style("fill","none");break;case"radial-line":fe.append("line").style("fill","none");break;case"angular-line":fe.append("path").style("fill","none")}}),ve.order()},K.updateLayout=function(N,U){var te=this.layers,B=N._size,X=this.getRadial(U),J=this.getAngular(U),ee=U.domain.x,re=U.domain.y;this.xOffset=B.l+B.w*ee[0],this.yOffset=B.t+B.h*(1-re[1]);var se=this.xLength=B.w*(ee[1]-ee[0]),oe=this.yLength=B.h*(re[1]-re[0]),de=this.getSector(U);this.sectorInRad=de.map(V);var ce,ve,Ae,fe,me,_e=this.sectorBBox=function(xt){var wt,bt,nt,$e,vt=xt[0],Nt=xt[1]-vt,qt=j(vt,360),Jt=qt+Nt,Wt=Math.cos(V(qt)),ar=Math.sin(V(qt)),Dt=Math.cos(V(Jt)),Ne=Math.sin(V(Jt));return $e=qt<=90&&Jt>=90||qt>90&&Jt>=450?1:ar<=0&&Ne<=0?0:Math.max(ar,Ne),wt=qt<=180&&Jt>=180||qt>180&&Jt>=540?-1:Wt>=0&&Dt>=0?0:Math.min(Wt,Dt),bt=qt<=270&&Jt>=270||qt>270&&Jt>=630?-1:ar>=0&&Ne>=0?0:Math.min(ar,Ne),nt=Jt>=360?1:Wt<=0&&Dt<=0?0:Math.max(Wt,Dt),[wt,bt,nt,$e]}(de),le=_e[2]-_e[0],ge=_e[3]-_e[1],Te=oe/se,Se=Math.abs(ge/le);Te>Se?(ce=se,me=(oe-(ve=se*Se))/B.h/2,Ae=[ee[0],ee[1]],fe=[re[0]+me,re[1]-me]):(ve=oe,me=(se-(ce=oe/Se))/B.w/2,Ae=[ee[0]+me,ee[1]-me],fe=[re[0],re[1]]),this.xLength2=ce,this.yLength2=ve,this.xDomain2=Ae,this.yDomain2=fe;var Me,ze=this.xOffset2=B.l+B.w*Ae[0],Oe=this.yOffset2=B.t+B.h*(1-fe[1]),De=this.radius=ce/le,Xe=this.innerRadius=this.getHole(U)*De,Be=this.cx=ze-De*_e[0],Ie=this.cy=Oe+De*_e[3],Re=this.cxx=Be-ze,Ye=this.cyy=Ie-Oe,Qe=X.side;Qe==="counterclockwise"?(Me=Qe,Qe="top"):Qe==="clockwise"&&(Me=Qe,Qe="bottom"),this.radialAxis=this.mockAxis(N,U,X,{_id:"x",side:Qe,_trueSide:Me,domain:[Xe/B.w,De/B.w]}),this.angularAxis=this.mockAxis(N,U,J,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(N,U),this.updateAngularAxis(N,U),this.updateRadialAxis(N,U),this.updateRadialAxisTitle(N,U),this.xaxis=this.mockCartesianAxis(N,U,{_id:"x",domain:Ae}),this.yaxis=this.mockCartesianAxis(N,U,{_id:"y",domain:fe});var lt=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",lt).attr("transform",t(Re,Ye)),te.frontplot.attr("transform",t(ze,Oe)).call(a.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),te.bg.attr("d",lt).attr("transform",t(Be,Ie)).call(n.fill,U.bgcolor)},K.mockAxis=function(N,U,te,B){var X=y.extendFlat({},te,B);return s(X,U,N),X},K.mockCartesianAxis=function(N,U,te){var B=this,X=B.isSmith,J=te._id,ee=y.extendFlat({type:"linear"},te);u(ee,N);var re={x:[0,2],y:[1,3]};return ee.setRange=function(){var se=B.sectorBBox,oe=re[J],de=B.radialAxis._rl,ce=(de[1]-de[0])/(1-B.getHole(U));ee.range=[se[oe[0]]*ce,se[oe[1]]*ce]},ee.isPtWithinRange=J!=="x"||X?function(){return!0}:function(se){return B.isPtInside(se)},ee.setRange(),ee.setScale(),ee},K.doAutoRange=function(N,U){var te=this.gd,B=this.radialAxis,X=this.getRadial(U);h(te,B);var J=B.range;X.range=J.slice(),X._input.range=J.slice(),B._rl=[B.r2l(J[0],null,"gregorian"),B.r2l(J[1],null,"gregorian")]},K.updateRadialAxis=function(N,U){var te=this,B=te.gd,X=te.layers,J=te.radius,ee=te.innerRadius,re=te.cx,se=te.cy,oe=te.getRadial(U),de=j(te.getSector(U)[0],360),ce=te.radialAxis,ve=ee<J,Ae=te.isSmith;Ae||(te.fillViewInitialKey("radialaxis.angle",oe.angle),te.fillViewInitialKey("radialaxis.range",ce.range.slice()),ce.setGeometry()),ce.tickangle==="auto"&&de>90&&de<=270&&(ce.tickangle=180);var fe=Ae?function(De){var Xe=z(te,P([De.x,0]));return t(Xe[0]-re,Xe[1]-se)}:function(De){return t(ce.l2p(De.x)+ee,0)},me=Ae?function(De){return E(te,De.x,-1/0,1/0)}:function(De){return te.pathArc(ce.r2p(De.x)+ee)},_e=$(oe);if(te.radialTickLayout!==_e&&(X["radial-axis"].selectAll(".xtick").remove(),te.radialTickLayout=_e),ve){ce.setScale();var le=0,ge=Ae?(ce.tickvals||[]).filter(function(De){return De>=0}).map(function(De){return g.tickText(ce,De,!0,!1)}):g.calcTicks(ce),Te=Ae?ge:g.clipEnds(ce,ge),Se=g.getTickSigns(ce)[2];Ae&&((ce.ticks==="top"&&ce.side==="bottom"||ce.ticks==="bottom"&&ce.side==="top")&&(Se=-Se),ce.ticks==="top"&&ce.side==="top"&&(le=-ce.ticklen),ce.ticks==="bottom"&&ce.side==="bottom"&&(le=ce.ticklen)),g.drawTicks(B,ce,{vals:ge,layer:X["radial-axis"],path:g.makeTickPath(ce,0,Se),transFn:fe,crisp:!1}),g.drawGrid(B,ce,{vals:Te,layer:X["radial-grid"],path:me,transFn:y.noop,crisp:!1}),g.drawLabels(B,ce,{vals:ge,layer:X["radial-axis"],transFn:fe,labelFns:g.makeLabelFns(ce,le)})}var Me=te.radialAxisAngle=te.vangles?Z(ne(V(oe.angle),te.vangles)):oe.angle,ze=t(re,se),Oe=ze+e(-Me);H(X["radial-axis"],ve&&(oe.showticklabels||oe.ticks),{transform:Oe}),H(X["radial-grid"],ve&&oe.showgrid,{transform:Ae?"":ze}),H(X["radial-line"].select("line"),ve&&oe.showline,{x1:Ae?-J:ee,y1:0,x2:J,y2:0,transform:Oe}).attr("stroke-width",oe.linewidth).call(n.stroke,oe.linecolor)},K.updateRadialAxisTitle=function(N,U,te){if(!this.isSmith){var B=this.gd,X=this.radius,J=this.cx,ee=this.cy,re=this.getRadial(U),se=this.id+"title",oe=0;if(re.title){var de=a.bBox(this.layers["radial-axis"].node()).height,ce=re.title.font.size,ve=re.side;oe=ve==="top"?ce:ve==="counterclockwise"?-(de+.4*ce):de+.8*ce}var Ae=te!==void 0?te:this.radialAxisAngle,fe=V(Ae),me=Math.cos(fe),_e=Math.sin(fe),le=J+X/2*me+oe*_e,ge=ee-X/2*_e+oe*me;this.layers["radial-axis-title"]=c.draw(B,se,{propContainer:re,propName:this.id+".radialaxis.title",placeholder:D(B,"Click to enter radial axis title"),attributes:{x:le,y:ge,"text-anchor":"middle"},transform:{rotate:-Ae}})}},K.updateAngularAxis=function(N,U){var te=this,B=te.gd,X=te.layers,J=te.radius,ee=te.innerRadius,re=te.cx,se=te.cy,oe=te.getAngular(U),de=te.angularAxis,ce=te.isSmith;ce||(te.fillViewInitialKey("angularaxis.rotation",oe.rotation),de.setGeometry(),de.setScale());var ve=ce?function(De){var Xe=z(te,P([0,De.x]));return Math.atan2(Xe[0]-re,Xe[1]-se)-Math.PI/2}:function(De){return de.t2g(De.x)};de.type==="linear"&&de.thetaunit==="radians"&&(de.tick0=Z(de.tick0),de.dtick=Z(de.dtick));var Ae=function(De){return t(re+J*Math.cos(De),se-J*Math.sin(De))},fe=ce?function(De){var Xe=z(te,P([0,De.x]));return t(Xe[0],Xe[1])}:function(De){return Ae(ve(De))},me=ce?function(De){var Xe=z(te,P([0,De.x])),Be=Math.atan2(Xe[0]-re,Xe[1]-se)-Math.PI/2;return t(Xe[0],Xe[1])+e(-Z(Be))}:function(De){var Xe=ve(De);return Ae(Xe)+e(-Z(Xe))},_e=ce?function(De){return S(te,De.x,0,1/0)}:function(De){var Xe=ve(De),Be=Math.cos(Xe),Ie=Math.sin(Xe);return"M"+[re+ee*Be,se-ee*Ie]+"L"+[re+J*Be,se-J*Ie]},le=g.makeLabelFns(de,0).labelStandoff,ge={xFn:function(De){var Xe=ve(De);return Math.cos(Xe)*le},yFn:function(De){var Xe=ve(De),Be=Math.sin(Xe)>0?.2:1;return-Math.sin(Xe)*(le+De.fontSize*Be)+Math.abs(Math.cos(Xe))*(De.fontSize*k)},anchorFn:function(De){var Xe=ve(De),Be=Math.cos(Xe);return Math.abs(Be)<.1?"middle":Be>0?"start":"end"},heightFn:function(De,Xe,Be){var Ie=ve(De);return-.5*(1+Math.sin(Ie))*Be}},Te=$(oe);te.angularTickLayout!==Te&&(X["angular-axis"].selectAll("."+de._id+"tick").remove(),te.angularTickLayout=Te);var Se,Me=ce?[1/0].concat(de.tickvals||[]).map(function(De){return g.tickText(de,De,!0,!1)}):g.calcTicks(de);if(ce&&(Me[0].text="\u221E",Me[0].fontSize*=1.75),U.gridshape==="linear"?(Se=Me.map(ve),y.angleDelta(Se[0],Se[1])<0&&(Se=Se.slice().reverse())):Se=null,te.vangles=Se,de.type==="category"&&(Me=Me.filter(function(De){return y.isAngleInsideSector(ve(De),te.sectorInRad)})),de.visible){var ze=de.ticks==="inside"?-1:1,Oe=(de.linewidth||1)/2;g.drawTicks(B,de,{vals:Me,layer:X["angular-axis"],path:"M"+ze*Oe+",0h"+ze*de.ticklen,transFn:me,crisp:!1}),g.drawGrid(B,de,{vals:Me,layer:X["angular-grid"],path:_e,transFn:y.noop,crisp:!1}),g.drawLabels(B,de,{vals:Me,layer:X["angular-axis"],repositionOnUpdate:!0,transFn:fe,labelFns:ge})}H(X["angular-line"].select("path"),oe.showline,{d:te.pathSubplot(),transform:t(re,se)}).attr("stroke-width",oe.linewidth).call(n.stroke,oe.linecolor)},K.updateFx=function(N,U){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(N),this.updateRadialDrag(N,U,0),this.updateRadialDrag(N,U,1)),this.updateHoverAndMainDrag(N))},K.updateHoverAndMainDrag=function(N){var U,te,B=this,X=B.isSmith,J=B.gd,ee=B.layers,re=N._zoomlayer,se=L.MINZOOM,oe=L.OFFEDGE,de=B.radius,ce=B.innerRadius,ve=B.cx,Ae=B.cy,fe=B.cxx,me=B.cyy,_e=B.sectorInRad,le=B.vangles,ge=B.radialAxis,Te=A.clampTiny,Se=A.findXYatLength,Me=A.findEnclosingVertexAngles,ze=L.cornerHalfWidth,Oe=L.cornerLen/2,De=l.makeDragger(ee,"path","maindrag",N.dragmode===!1?"none":"crosshair");d.select(De).attr("d",B.pathSubplot()).attr("transform",t(ve,Ae)),De.onmousemove=function(Ve){p.hover(J,Ve,B.id),J._fullLayout._lasthover=De,J._fullLayout._hoversubplot=B.id},De.onmouseout=function(Ve){J._dragging||o.unhover(J,Ve)};var Xe,Be,Ie,Re,Ye,Qe,lt,xt,wt,bt={element:De,gd:J,subplot:B.id,plotinfo:{id:B.id,xaxis:B.xaxis,yaxis:B.yaxis},xaxes:[B.xaxis],yaxes:[B.yaxis]};function nt(Ve,Ke){return Math.sqrt(Ve*Ve+Ke*Ke)}function $e(Ve,Ke){return nt(Ve-fe,Ke-me)}function vt(Ve,Ke){return Math.atan2(me-Ke,Ve-fe)}function Nt(Ve,Ke){return[Ve*Math.cos(Ke),Ve*Math.sin(-Ke)]}function qt(Ve,Ke){if(Ve===0)return B.pathSector(2*ze);var Ge=Oe/Ve,ct=Ke-Ge,st=Ke+Ge,Mt=Math.max(0,Math.min(Ve,de)),Ot=Mt-ze,it=Mt+ze;return"M"+Nt(Ot,ct)+"A"+[Ot,Ot]+" 0,0,0 "+Nt(Ot,st)+"L"+Nt(it,st)+"A"+[it,it]+" 0,0,1 "+Nt(it,ct)+"Z"}function Jt(Ve,Ke,Ge){if(Ve===0)return B.pathSector(2*ze);var ct,st,Mt=Nt(Ve,Ke),Ot=Nt(Ve,Ge),it=Te((Mt[0]+Ot[0])/2),ht=Te((Mt[1]+Ot[1])/2);if(it&&ht){var jt=ht/it,kt=-1/jt,Pt=Se(ze,jt,it,ht);ct=Se(Oe,kt,Pt[0][0],Pt[0][1]),st=Se(Oe,kt,Pt[1][0],Pt[1][1])}else{var Ee,Ze;ht?(Ee=Oe,Ze=ze):(Ee=ze,Ze=Oe),ct=[[it-Ee,ht-Ze],[it+Ee,ht-Ze]],st=[[it-Ee,ht+Ze],[it+Ee,ht+Ze]]}return"M"+ct.join("L")+"L"+st.reverse().join("L")+"Z"}function Wt(Ve,Ke){return Ke=Math.max(Math.min(Ke,de),ce),Ve<oe?Ve=0:de-Ve<oe?Ve=de:Ke<oe?Ke=0:de-Ke<oe&&(Ke=de),Math.abs(Ke-Ve)>se?(Ve<Ke?(Ie=Ve,Re=Ke):(Ie=Ke,Re=Ve),!0):(Ie=null,Re=null,!1)}function ar(Ve,Ke){Ve=Ve||Ye,Ke=Ke||"M0,0Z",xt.attr("d",Ve),wt.attr("d",Ke),l.transitionZoombox(xt,wt,Qe,lt),Qe=!0;var Ge={};be(Ge),J.emit("plotly_relayouting",Ge)}function Dt(Ve,Ke){var Ge,ct,st=Xe+(Ve*=U),Mt=Be+(Ke*=te),Ot=$e(Xe,Be),it=Math.min($e(st,Mt),de),ht=vt(Xe,Be);Wt(Ot,it)&&(Ge=Ye+B.pathSector(Re),Ie&&(Ge+=B.pathSector(Ie)),ct=qt(Ie,ht)+qt(Re,ht)),ar(Ge,ct)}function Ne(Ve,Ke,Ge,ct){var st=A.findIntersectionXY(Ge,ct,Ge,[Ve-fe,me-Ke]);return nt(st[0],st[1])}function qe(Ve,Ke){var Ge,ct,st=Xe+Ve,Mt=Be+Ke,Ot=vt(Xe,Be),it=vt(st,Mt),ht=Me(Ot,le),jt=Me(it,le);Wt(Ne(Xe,Be,ht[0],ht[1]),Math.min(Ne(st,Mt,jt[0],jt[1]),de))&&(Ge=Ye+B.pathSector(Re),Ie&&(Ge+=B.pathSector(Ie)),ct=[Jt(Ie,ht[0],ht[1]),Jt(Re,ht[0],ht[1])].join(" ")),ar(Ge,ct)}function pe(){if(l.removeZoombox(J),Ie!==null&&Re!==null){var Ve={};be(Ve),l.showDoubleClickNotifier(J),w.call("_guiRelayout",J,Ve)}}function be(Ve){var Ke=ge._rl,Ge=(Ke[1]-Ke[0])/(1-ce/de)/de,ct=[Ke[0]+(Ie-ce)*Ge,Ke[0]+(Re-ce)*Ge];Ve[B.id+".radialaxis.range"]=ct}function Fe(Ve,Ke){var Ge=J._fullLayout.clickmode;if(l.removeZoombox(J),Ve===2){var ct={};for(var st in B.viewInitial)ct[B.id+"."+st]=B.viewInitial[st];J.emit("plotly_doubleclick",null),w.call("_guiRelayout",J,ct)}Ge.indexOf("select")>-1&&Ve===1&&x(Ke,J,[B.xaxis],[B.yaxis],B.id,bt),Ge.indexOf("event")>-1&&p.click(J,Ke,B.id)}bt.prepFn=function(Ve,Ke,Ge){var ct=J._fullLayout.dragmode,st=De.getBoundingClientRect();J._fullLayout._calcInverseTransform(J);var Mt=J._fullLayout._invTransform;U=J._fullLayout._invScaleX,te=J._fullLayout._invScaleY;var Ot=y.apply3DTransform(Mt)(Ke-st.left,Ge-st.top);if(Xe=Ot[0],Be=Ot[1],le){var it=A.findPolygonOffset(de,_e[0],_e[1],le);Xe+=fe+it[0],Be+=me+it[1]}switch(ct){case"zoom":bt.clickFn=Fe,X||(bt.moveFn=le?qe:Dt,bt.doneFn=pe,function(){Ie=null,Re=null,Ye=B.pathSubplot(),Qe=!1;var ht=J._fullLayout[B.id];lt=v(ht.bgcolor).getLuminance(),(xt=l.makeZoombox(re,lt,ve,Ae,Ye)).attr("fill-rule","evenodd"),wt=l.makeCorners(re,ve,Ae),f(J)}());break;case"select":case"lasso":i(Ve,Ke,Ge,bt,ct)}},o.init(bt)},K.updateRadialDrag=function(N,U,te){var B=this,X=B.gd,J=B.layers,ee=B.radius,re=B.innerRadius,se=B.cx,oe=B.cy,de=B.radialAxis,ce=L.radialDragBoxSize,ve=ce/2;if(de.visible){var Ae,fe,me,_e=V(B.radialAxisAngle),le=de._rl,ge=le[0],Te=le[1],Se=le[te],Me=.75*(le[1]-le[0])/(1-B.getHole(U))/ee;te?(Ae=se+(ee+ve)*Math.cos(_e),fe=oe-(ee+ve)*Math.sin(_e),me="radialdrag"):(Ae=se+(re-ve)*Math.cos(_e),fe=oe-(re-ve)*Math.sin(_e),me="radialdrag-inner");var ze,Oe,De,Xe=l.makeRectDragger(J,me,"crosshair",-ve,-ve,ce,ce),Be={element:Xe,gd:X};N.dragmode===!1&&(Be.dragmode=!1),H(d.select(Xe),de.visible&&re<ee,{transform:t(Ae,fe)}),Be.prepFn=function(){ze=null,Oe=null,De=null,Be.moveFn=Ie,Be.doneFn=Re,f(X)},Be.clampFn=function(lt,xt){return Math.sqrt(lt*lt+xt*xt)<L.MINDRAG&&(lt=0,xt=0),[lt,xt]},o.init(Be)}function Ie(lt,xt){if(ze)ze(lt,xt);else{var wt=[lt,-xt],bt=[Math.cos(_e),Math.sin(_e)],nt=Math.abs(y.dot(wt,bt)/Math.sqrt(y.dot(wt,wt)));isNaN(nt)||(ze=nt<.5?Ye:Qe)}var $e={};(function(vt){Oe!==null?vt[B.id+".radialaxis.angle"]=Oe:De!==null&&(vt[B.id+".radialaxis.range["+te+"]"]=De)})($e),X.emit("plotly_relayouting",$e)}function Re(){Oe!==null?w.call("_guiRelayout",X,B.id+".radialaxis.angle",Oe):De!==null&&w.call("_guiRelayout",X,B.id+".radialaxis.range["+te+"]",De)}function Ye(lt,xt){if(te!==0){var wt=Ae+lt,bt=fe+xt;Oe=Math.atan2(oe-bt,wt-se),B.vangles&&(Oe=ne(Oe,B.vangles)),Oe=Z(Oe);var nt=t(se,oe)+e(-Oe);J["radial-axis"].attr("transform",nt),J["radial-line"].select("line").attr("transform",nt);var $e=B.gd._fullLayout,vt=$e[B.id];B.updateRadialAxisTitle($e,vt,Oe)}}function Qe(lt,xt){var wt=y.dot([lt,-xt],[Math.cos(_e),Math.sin(_e)]);if(De=Se-Me*wt,Me>0==(te?De>ge:De<Te)){var bt=X._fullLayout,nt=bt[B.id];de.range[te]=De,de._rl[te]=De,B.updateRadialAxis(bt,nt),B.xaxis.setRange(),B.xaxis.setScale(),B.yaxis.setRange(),B.yaxis.setScale();var $e=!1;for(var vt in B.traceHash){var Nt=B.traceHash[vt],qt=y.filterVisible(Nt);Nt[0][0].trace._module.plot(X,B,qt,nt),w.traceIs(vt,"gl")&&qt.length&&($e=!0)}$e&&(b(X),T(X))}else De=null}},K.updateAngularDrag=function(N){var U=this,te=U.gd,B=U.layers,X=U.radius,J=U.angularAxis,ee=U.cx,re=U.cy,se=U.cxx,oe=U.cyy,de=L.angularDragBoxSize,ce=l.makeDragger(B,"path","angulardrag",N.dragmode===!1?"none":"move"),ve={element:ce,gd:te};function Ae(Be,Ie){return Math.atan2(oe+de-Ie,Be-se-de)}N.dragmode===!1?ve.dragmode=!1:d.select(ce).attr("d",U.pathAnnulus(X,X+de)).attr("transform",t(ee,re)).call(_,"move");var fe,me,_e,le,ge,Te,Se=B.frontplot.select(".scatterlayer").selectAll(".trace"),Me=Se.selectAll(".point"),ze=Se.selectAll(".textpoint");function Oe(Be,Ie){var Re=U.gd._fullLayout,Ye=Re[U.id],Qe=Ae(fe+Be*N._invScaleX,me+Ie*N._invScaleY),lt=Z(Qe-Te);if(le=_e+lt,B.frontplot.attr("transform",t(U.xOffset2,U.yOffset2)+e([-lt,se,oe])),U.vangles){ge=U.radialAxisAngle+lt;var xt=t(ee,re)+e(-lt),wt=t(ee,re)+e(-ge);B.bg.attr("transform",xt),B["radial-grid"].attr("transform",xt),B["radial-axis"].attr("transform",wt),B["radial-line"].select("line").attr("transform",wt),U.updateRadialAxisTitle(Re,Ye,ge)}else U.clipPaths.forTraces.select("path").attr("transform",t(se,oe)+e(lt));Me.each(function(){var qt=d.select(this),Jt=a.getTranslate(qt);qt.attr("transform",t(Jt.x,Jt.y)+e([lt]))}),ze.each(function(){var qt=d.select(this),Jt=qt.select("text"),Wt=a.getTranslate(qt);qt.attr("transform",e([lt,Jt.attr("x"),Jt.attr("y")])+t(Wt.x,Wt.y))}),J.rotation=y.modHalf(le,360),U.updateAngularAxis(Re,Ye),U._hasClipOnAxisFalse&&!y.isFullCircle(U.sectorInRad)&&Se.call(a.hideOutsideRangePoints,U);var bt=!1;for(var nt in U.traceHash)if(w.traceIs(nt,"gl")){var $e=U.traceHash[nt],vt=y.filterVisible($e);$e[0][0].trace._module.plot(te,U,vt,Ye),vt.length&&(bt=!0)}bt&&(b(te),T(te));var Nt={};De(Nt),te.emit("plotly_relayouting",Nt)}function De(Be){Be[U.id+".angularaxis.rotation"]=le,U.vangles&&(Be[U.id+".radialaxis.angle"]=ge)}function Xe(){ze.select("text").attr("transform",null);var Be={};De(Be),w.call("_guiRelayout",te,Be)}ve.prepFn=function(Be,Ie,Re){var Ye=N[U.id];_e=Ye.angularaxis.rotation;var Qe=ce.getBoundingClientRect();fe=Ie-Qe.left,me=Re-Qe.top,te._fullLayout._calcInverseTransform(te);var lt=y.apply3DTransform(N._invTransform)(fe,me);fe=lt[0],me=lt[1],Te=Ae(fe,me),ve.moveFn=Oe,ve.doneFn=Xe,f(te)},U.vangles&&!y.isFullCircle(U.sectorInRad)&&(ve.prepFn=y.noop,_(d.select(ce),null)),o.init(ve)},K.isPtInside=function(N){if(this.isSmith)return!0;var U=this.sectorInRad,te=this.vangles,B=this.angularAxis.c2g(N.theta),X=this.radialAxis,J=X.c2l(N.r),ee=X._rl;return(te?A.isPtInsidePolygon:y.isPtInsideSector)(J,B,ee,U,te)},K.pathArc=function(N){var U=this.sectorInRad,te=this.vangles;return(te?A.pathPolygon:y.pathArc)(N,U[0],U[1],te)},K.pathSector=function(N){var U=this.sectorInRad,te=this.vangles;return(te?A.pathPolygon:y.pathSector)(N,U[0],U[1],te)},K.pathAnnulus=function(N,U){var te=this.sectorInRad,B=this.vangles;return(B?A.pathPolygonAnnulus:y.pathAnnulus)(N,U,te[0],te[1],B)},K.pathSubplot=function(){var N=this.innerRadius,U=this.radius;return N?this.pathAnnulus(N,U):this.pathSector(U)},K.fillViewInitialKey=function(N,U){N in this.viewInitial||(this.viewInitial[N]=U)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(m,G,W){var d=m("../../lib"),v=m("../cartesian/set_convert"),w=d.deg2rad,y=d.rad2deg;G.exports=function(e,t,n){switch(v(e,n),e._id){case"x":case"radialaxis":(function(a,r){var g=r._subplot;a.setGeometry=function(){var u=a._rl[0],s=a._rl[1],h=g.innerRadius,l=(g.radius-h)/(s-u),o=h/l,p=u>s?function(c){return c<=0}:function(c){return c>=0};a.c2g=function(c){var i=a.c2l(c)-u;return(p(i)?i:0)+o},a.g2c=function(c){return a.l2c(c+u-o)},a.g2p=function(c){return c*l},a.c2p=function(c){return a.g2p(a.c2g(c))}}})(e,t);break;case"angularaxis":(function(a,r){var g=a.type;if(g==="linear"){var u=a.d2c,s=a.c2d;a.d2c=function(h,l){return function(o,p){return p==="degrees"?w(o):o}(u(h),l)},a.c2d=function(h,l){return s(function(o,p){return p==="degrees"?y(o):o}(h,l))}}a.makeCalcdata=function(h,l){var o,p,c=h[l],i=h._length,x=function(k){return a.d2c(k,h.thetaunit)};if(c){if(d.isTypedArray(c)&&g==="linear"){if(i===c.length)return c;if(c.subarray)return c.subarray(0,i)}for(o=new Array(i),p=0;p<i;p++)o[p]=x(c[p])}else{var f=l+"0",_="d"+l,b=f in h?x(h[f]):0,T=h[_]?x(h[_]):(a.period||2*Math.PI)/i;for(o=new Array(i),p=0;p<i;p++)o[p]=b+p*T}return o},a.setGeometry=function(){var h,l,o,p,c=r.sector,i=c.map(w),x={clockwise:-1,counterclockwise:1}[a.direction],f=w(a.rotation),_=function(L){return x*L+f},b=function(L){return(L-f)/x};switch(g){case"linear":l=h=d.identity,p=w,o=y,a.range=d.isFullCircle(i)?[c[0],c[0]+360]:i.map(b).map(y);break;case"category":var T=a._categories.length,k=a.period?Math.max(a.period,T):T;k===0&&(k=1),l=p=function(L){return 2*L*Math.PI/k},h=o=function(L){return L*k/Math.PI/2},a.range=[0,k]}a.c2g=function(L){return _(l(L))},a.g2c=function(L){return h(b(L))},a.t2g=function(L){return _(p(L))},a.g2t=function(L){return o(b(L))}}})(e,t)}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(m,G,W){G.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(m,G,W){function d(e){return e<0?-1:e>0?1:0}function v(e){var t=e[0],n=e[1];if(!isFinite(t)||!isFinite(n))return[1,0];var a=(t+1)*(t+1)+n*n;return[(t*t+n*n-1)/a,2*n/a]}function w(e,t){var n=t[0],a=t[1];return[n*e.radius+e.cx,-a*e.radius+e.cy]}function y(e,t){return t*e.radius}G.exports={smith:v,reactanceArc:function(e,t,n,a){var r=w(e,v([n,t])),g=r[0],u=r[1],s=w(e,v([a,t])),h=s[0],l=s[1];if(t===0)return["M"+g+","+u,"L"+h+","+l].join(" ");var o=y(e,1/Math.abs(t));return["M"+g+","+u,"A"+o+","+o+" 0 0,"+(t<0?1:0)+" "+h+","+l].join(" ")},resistanceArc:function(e,t,n,a){var r=y(e,1/(t+1)),g=w(e,v([t,n])),u=g[0],s=g[1],h=w(e,v([t,a])),l=h[0],o=h[1];if(d(n)!==d(a)){var p=w(e,v([t,0]));return["M"+u+","+s,"A"+r+","+r+" 0 0,"+(0<n?0:1)+" "+p[0]+","+p[1],"A"+r+","+r+" 0 0,"+(a<0?0:1)+l+","+o].join(" ")}return["M"+u+","+s,"A"+r+","+r+" 0 0,"+(a<n?0:1)+" "+l+","+o].join(" ")},smithTransform:w}},{}],638:[function(m,G,W){var d=m("../get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("../polar/polar"),y=m("./constants"),e=y.attr,t=y.name,n=v(t),a={};a[e]={valType:"subplotid",dflt:t,editType:"calc"},G.exports={attr:e,name:t,idRoot:t,idRegex:n,attrRegex:n,attributes:a,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(r){for(var g=r._fullLayout,u=r.calcdata,s=g._subplots[t],h=0;h<s.length;h++){var l=s[h],o=d(u,t,l),p=g[l]._subplot;p||(p=w(r,l,!0),g[l]._subplot=p),p.plot(o,g,r._promises)}},clean:function(r,g,u,s){for(var h=s._subplots[t]||[],l=0;l<h.length;l++){var o=h[l],p=s[o]._subplot;if(!g[o]&&p)for(var c in p.framework.remove(),p.clipPaths)p.clipPaths[c].remove()}},toSVG:m("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(m,G,W){var d=m("../../components/color/attributes"),v=m("../cartesian/layout_attributes"),w=m("../domain").attributes,y=m("../../lib").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=e({color:v.color,showline:y({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:y({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({ticklen:v.ticklen,tickwidth:y({},v.tickwidth,{dflt:2}),tickcolor:v.tickcolor,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,tickfont:v.tickfont,tickformat:v.tickformat,hoverformat:v.hoverformat,layer:v.layer},"plot","from-root"),a=y({visible:y({},v.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:y({},v.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},t,n),r=y({visible:y({},v.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:v.ticks,editType:"calc"},t,n);G.exports={domain:w({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:d.background},realaxis:a,imaginaryaxis:r,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(m,G,W){var d,v,w,y=m("../../lib"),e=m("../../components/color"),t=m("../../plot_api/plot_template"),n=m("../subplot_defaults"),a=m("../get_data").getSubplotData,r=m("../cartesian/prefix_suffix_defaults"),g=m("../cartesian/tick_label_defaults"),u=m("../cartesian/line_grid_defaults"),s=m("../cartesian/set_convert"),h=m("./layout_attributes"),l=m("./constants"),o=l.axisNames,p=(d=function(i){return i.slice().reverse().map(function(x){return-x}).concat([0]).concat(i)},v=String,w={},function(i){var x=v?v(i):i;if(x in w)return w[x];var f=d(i);return w[x]=f,f});function c(i,x,f,_){var b=f("bgcolor");_.bgColor=e.combine(b,_.paper_bgcolor);var T,k=a(_.fullData,l.name,_.id),L=_.layoutOut;function A(K,$){return f(T+"."+K,$)}for(var I=0;I<o.length;I++){T=o[I],y.isPlainObject(i[T])||(i[T]={});var P=i[T],S=t.newContainer(x,T);S._id=S._name=T,S._attr=_.id+"."+T,S._traceIndices=k.map(function(K){return K._expandedIndex});var E=A("visible");if(S.type="linear",s(S,L),r(P,S,A,S.type),E){var z,D,j,V,Z=T==="realaxis";Z&&A("side"),Z?A("tickvals"):A("tickvals",p(x.realaxis.tickvals||h.realaxis.tickvals.dflt));var Q=_.font||{};E&&(D=(z=A("color"))===P.color?z:Q.color,j=Q.size,V=Q.family),g(P,S,A,S.type,{noTicklabelstep:!0,noAng:!Z,noExp:!0,font:{color:D,size:j,family:V}}),y.coerce2(i,x,h,T+".ticklen"),y.coerce2(i,x,h,T+".tickwidth"),y.coerce2(i,x,h,T+".tickcolor",x.color),A("ticks")||(delete x[T].ticklen,delete x[T].tickwidth,delete x[T].tickcolor),u(P,S,A,{dfltColor:z,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[T]}),A("layer")}A("hoverformat"),delete S.type,S._input=P}}G.exports=function(i,x,f){n(i,x,f,{noUirevision:!0,type:l.name,attributes:h,handleDefaults:c,font:x.font,paper_bgcolor:x.paper_bgcolor,fullData:f,layoutOut:x})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(m,G,W){var d=m("../lib"),v=m("../plot_api/plot_template"),w=m("./domain").defaults;G.exports=function(y,e,t,n){var a,r,g=n.type,u=n.attributes,s=n.handleDefaults,h=n.partition||"x",l=e._subplots[g],o=l.length,p=o&&l[0].replace(/\d+$/,"");function c(_,b){return d.coerce(a,r,u,_,b)}for(var i=0;i<o;i++){var x=l[i];a=y[x]?y[x]:y[x]={},r=v.newContainer(e,x,p),n.noUirevision||c("uirevision",e.uirevision);var f={};f[h]=[i/o,(i+1)/o],w(r,e,c,f),n.id=x,s(a,r,c,n)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(m,G,W){var d=m("../constants/docs");d.FORMAT_LINK,d.DATE_FORMAT_LINK;function v(w){var y=w.description?" "+w.description:"",e=w.keys||[];if(e.length>0){for(var t=[],n=0;n<e.length;n++)t[n]="`"+e[n]+"`";y+="Finally, the template string has access to ",y=e.length===1?"variable "+t[0]:"variables "+t.slice(0,-1).join(", ")+" and "+t.slice(-1)+"."}return y}W.hovertemplateAttrs=function(w,y){w=w||{},v(y=y||{});var e={valType:"string",dflt:"",editType:w.editType||"none"};return w.arrayOk!==!1&&(e.arrayOk=!0),e},W.texttemplateAttrs=function(w,y){w=w||{},v(y=y||{});var e={valType:"string",dflt:"",editType:w.editType||"calc"};return w.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(m,G,W){var d=m("./ternary"),v=m("../../plots/get_data").getSubplotCalcData,w=m("../../lib").counterRegex;W.name="ternary";var y=W.attr="subplot";W.idRoot="ternary",W.idRegex=W.attrRegex=w("ternary"),(W.attributes={})[y]={valType:"subplotid",dflt:"ternary",editType:"calc"},W.layoutAttributes=m("./layout_attributes"),W.supplyLayoutDefaults=m("./layout_defaults"),W.plot=function(e){for(var t=e._fullLayout,n=e.calcdata,a=t._subplots.ternary,r=0;r<a.length;r++){var g=a[r],u=v(n,"ternary",g),s=t[g]._subplot;s||(s=new d({id:g,graphDiv:e,container:t._ternarylayer.node()},t),t[g]._subplot=s),s.plot(u,t,e._promises)}},W.clean=function(e,t,n,a){for(var r=a._subplots.ternary||[],g=0;g<r.length;g++){var u=r[g],s=a[u]._subplot;!t[u]&&s&&(s.plotContainer.remove(),s.clipDef.remove(),s.clipDefRelative.remove(),s.layers["a-title"].remove(),s.layers["b-title"].remove(),s.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(m,G,W){var d=m("../../components/color/attributes"),v=m("../domain").attributes,w=m("../cartesian/layout_attributes"),y=m("../../plot_api/edit_types").overrideAll,e=m("../../lib/extend").extendFlat,t={title:{text:w.title.text,font:w.title.font},color:w.color,tickmode:w.tickmode,nticks:e({},w.nticks,{dflt:6,min:1}),tick0:w.tick0,dtick:w.dtick,tickvals:w.tickvals,ticktext:w.ticktext,ticks:w.ticks,ticklen:w.ticklen,tickwidth:w.tickwidth,tickcolor:w.tickcolor,ticklabelstep:w.ticklabelstep,showticklabels:w.showticklabels,showtickprefix:w.showtickprefix,tickprefix:w.tickprefix,showticksuffix:w.showticksuffix,ticksuffix:w.ticksuffix,showexponent:w.showexponent,exponentformat:w.exponentformat,minexponent:w.minexponent,separatethousands:w.separatethousands,tickfont:w.tickfont,tickangle:w.tickangle,tickformat:w.tickformat,tickformatstops:w.tickformatstops,hoverformat:w.hoverformat,showline:e({},w.showline,{dflt:!0}),linecolor:w.linecolor,linewidth:w.linewidth,showgrid:e({},w.showgrid,{dflt:!0}),gridcolor:w.gridcolor,gridwidth:w.gridwidth,griddash:w.griddash,layer:w.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:w._deprecated.title,titlefont:w._deprecated.titlefont}},n=G.exports=y({domain:v({name:"ternary"}),bgcolor:{valType:"color",dflt:d.background},sum:{valType:"number",dflt:1,min:0},aaxis:t,baxis:t,caxis:t},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(m,G,W){var d=m("../../components/color"),v=m("../../plot_api/plot_template"),w=m("../../lib"),y=m("../subplot_defaults"),e=m("../cartesian/tick_label_defaults"),t=m("../cartesian/prefix_suffix_defaults"),n=m("../cartesian/tick_mark_defaults"),a=m("../cartesian/tick_value_defaults"),r=m("../cartesian/line_grid_defaults"),g=m("./layout_attributes"),u=["aaxis","baxis","caxis"];function s(l,o,p,c){var i,x,f,_=p("bgcolor"),b=p("sum");c.bgColor=d.combine(_,c.paper_bgcolor);for(var T=0;T<u.length;T++)x=l[i=u[T]]||{},(f=v.newContainer(o,i))._name=i,h(x,f,c,o);var k=o.aaxis,L=o.baxis,A=o.caxis;k.min+L.min+A.min>=b&&(k.min=0,L.min=0,A.min=0,l.aaxis&&delete l.aaxis.min,l.baxis&&delete l.baxis.min,l.caxis&&delete l.caxis.min)}function h(l,o,p,c){var i=g[o._name];function x(L,A){return w.coerce(l,o,i,L,A)}x("uirevision",c.uirevision),o.type="linear";var f=x("color"),_=f!==i.color.dflt?f:p.font.color,b=o._name.charAt(0).toUpperCase(),T="Component "+b,k=x("title.text",T);o._hovertitle=k===T?k:b,w.coerceFont(x,"title.font",{family:p.font.family,size:w.bigFont(p.font.size),color:_}),x("min"),a(l,o,x,"linear"),t(l,o,x,"linear"),e(l,o,x,"linear"),n(l,o,x,{outerTicks:!0}),x("showticklabels")&&(w.coerceFont(x,"tickfont",{family:p.font.family,size:p.font.size,color:_}),x("tickangle"),x("tickformat")),r(l,o,x,{dfltColor:f,bgColor:p.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),x("hoverformat"),x("layer")}G.exports=function(l,o,p){y(l,o,p,{type:"ternary",attributes:g,handleDefaults:s,font:o.font,paper_bgcolor:o.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(m,G,W){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../lib"),e=y.strTranslate,t=y._,n=m("../../components/color"),a=m("../../components/drawing"),r=m("../cartesian/set_convert"),g=m("../../lib/extend").extendFlat,u=m("../plots"),s=m("../cartesian/axes"),h=m("../../components/dragelement"),l=m("../../components/fx"),o=m("../../components/dragelement/helpers"),p=o.freeMode,c=o.rectMode,i=m("../../components/titles"),x=m("../../components/selections").prepSelect,f=m("../../components/selections").selectOnClick,_=m("../../components/selections").clearOutline,b=m("../../components/selections").clearSelectionsCache,T=m("../cartesian/constants");function k(j,V){this.id=j.id,this.graphDiv=j.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}G.exports=k;var L=k.prototype;L.init=function(j){this.container=j._ternarylayer,this.defs=j._defs,this.layoutId=j._uid,this.traceHash={},this.layers={}},L.plot=function(j,V){var Z=V[this.id],Q=V._size;this._hasClipOnAxisFalse=!1;for(var K=0;K<j.length;K++)if(j[K][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Z),this.adjustLayout(Z,Q),u.generalUpdatePerTraceModule(this.graphDiv,this,j,Z),this.layers.plotbg.select("path").call(n.fill,Z.bgcolor)},L.makeFramework=function(j){var V=this.graphDiv,Z=j[this.id],Q=this.clipId="clip"+this.layoutId+this.id,K=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=y.ensureSingleById(j._clips,"clipPath",Q,function($){$.append("path").attr("d","M0,0Z")}),this.clipDefRelative=y.ensureSingleById(j._clips,"clipPath",K,function($){$.append("path").attr("d","M0,0Z")}),this.plotContainer=y.ensureSingle(this.container,"g",this.id),this.updateLayers(Z),a.setClipUrl(this.layers.backplot,Q,V),a.setClipUrl(this.layers.grids,Q,V)},L.updateLayers=function(j){var V=this.layers,Z=["draglayer","plotbg","backplot","grids"];j.aaxis.layer==="below traces"&&Z.push("aaxis","aline"),j.baxis.layer==="below traces"&&Z.push("baxis","bline"),j.caxis.layer==="below traces"&&Z.push("caxis","cline"),Z.push("frontplot"),j.aaxis.layer==="above traces"&&Z.push("aaxis","aline"),j.baxis.layer==="above traces"&&Z.push("baxis","bline"),j.caxis.layer==="above traces"&&Z.push("caxis","cline");var Q=this.plotContainer.selectAll("g.toplevel").data(Z,String),K=["agrid","bgrid","cgrid"];Q.enter().append("g").attr("class",function($){return"toplevel "+$}).each(function($){var ne=d.select(this);V[$]=ne,$==="frontplot"?ne.append("g").classed("scatterlayer",!0):$==="backplot"?ne.append("g").classed("maplayer",!0):$==="plotbg"?ne.append("path").attr("d","M0,0Z"):$==="aline"||$==="bline"||$==="cline"?ne.append("path"):$==="grids"&&K.forEach(function(H){V[H]=ne.append("g").classed("grid "+H,!0)})}),Q.order()};var A=Math.sqrt(4/3);L.adjustLayout=function(j,V){var Z,Q,K,$,ne,H,N=this,U=j.domain,te=(U.x[0]+U.x[1])/2,B=(U.y[0]+U.y[1])/2,X=U.x[1]-U.x[0],J=U.y[1]-U.y[0],ee=X*V.w,re=J*V.h,se=j.sum,oe=j.aaxis.min,de=j.baxis.min,ce=j.caxis.min;ee>A*re?K=($=re)*A:$=(K=ee)/A,ne=X*K/ee,H=J*$/re,Z=V.l+V.w*te-K/2,Q=V.t+V.h*(1-B)-$/2,N.x0=Z,N.y0=Q,N.w=K,N.h=$,N.sum=se,N.xaxis={type:"linear",range:[oe+2*ce-se,se-oe-2*de],domain:[te-ne/2,te+ne/2],_id:"x"},r(N.xaxis,N.graphDiv._fullLayout),N.xaxis.setScale(),N.xaxis.isPtWithinRange=function(ze){return ze.a>=N.aaxis.range[0]&&ze.a<=N.aaxis.range[1]&&ze.b>=N.baxis.range[1]&&ze.b<=N.baxis.range[0]&&ze.c>=N.caxis.range[1]&&ze.c<=N.caxis.range[0]},N.yaxis={type:"linear",range:[oe,se-de-ce],domain:[B-H/2,B+H/2],_id:"y"},r(N.yaxis,N.graphDiv._fullLayout),N.yaxis.setScale(),N.yaxis.isPtWithinRange=function(){return!0};var ve=N.yaxis.domain[0],Ae=N.aaxis=g({},j.aaxis,{range:[oe,se-de-ce],side:"left",tickangle:(+j.aaxis.tickangle||0)-30,domain:[ve,ve+H*A],anchor:"free",position:0,_id:"y",_length:K});r(Ae,N.graphDiv._fullLayout),Ae.setScale();var fe=N.baxis=g({},j.baxis,{range:[se-oe-ce,de],side:"bottom",domain:N.xaxis.domain,anchor:"free",position:0,_id:"x",_length:K});r(fe,N.graphDiv._fullLayout),fe.setScale();var me=N.caxis=g({},j.caxis,{range:[se-oe-de,ce],side:"right",tickangle:(+j.caxis.tickangle||0)+30,domain:[ve,ve+H*A],anchor:"free",position:0,_id:"y",_length:K});r(me,N.graphDiv._fullLayout),me.setScale();var _e="M"+Z+","+(Q+$)+"h"+K+"l-"+K/2+",-"+$+"Z";N.clipDef.select("path").attr("d",_e),N.layers.plotbg.select("path").attr("d",_e);var le="M0,"+$+"h"+K+"l-"+K/2+",-"+$+"Z";N.clipDefRelative.select("path").attr("d",le);var ge=e(Z,Q);N.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ge),N.clipDefRelative.select("path").attr("transform",null);var Te=e(Z-fe._offset,Q+$);N.layers.baxis.attr("transform",Te),N.layers.bgrid.attr("transform",Te);var Se=e(Z+K/2,Q)+"rotate(30)"+e(0,-Ae._offset);N.layers.aaxis.attr("transform",Se),N.layers.agrid.attr("transform",Se);var Me=e(Z+K/2,Q)+"rotate(-30)"+e(0,-me._offset);N.layers.caxis.attr("transform",Me),N.layers.cgrid.attr("transform",Me),N.drawAxes(!0),N.layers.aline.select("path").attr("d",Ae.showline?"M"+Z+","+(Q+$)+"l"+K/2+",-"+$:"M0,0").call(n.stroke,Ae.linecolor||"#000").style("stroke-width",(Ae.linewidth||0)+"px"),N.layers.bline.select("path").attr("d",fe.showline?"M"+Z+","+(Q+$)+"h"+K:"M0,0").call(n.stroke,fe.linecolor||"#000").style("stroke-width",(fe.linewidth||0)+"px"),N.layers.cline.select("path").attr("d",me.showline?"M"+(Z+K/2)+","+Q+"l"+K/2+","+$:"M0,0").call(n.stroke,me.linecolor||"#000").style("stroke-width",(me.linewidth||0)+"px"),N.graphDiv._context.staticPlot||N.initInteractions(),a.setClipUrl(N.layers.frontplot,N._hasClipOnAxisFalse?null:N.clipId,N.graphDiv)},L.drawAxes=function(j){var V=this.graphDiv,Z=this.id.substr(7)+"title",Q=this.layers,K=this.aaxis,$=this.baxis,ne=this.caxis;if(this.drawAx(K),this.drawAx($),this.drawAx(ne),j){var H=Math.max(K.showticklabels?K.tickfont.size/2:0,(ne.showticklabels?.75*ne.tickfont.size:0)+(ne.ticks==="outside"?.87*ne.ticklen:0)),N=($.showticklabels?$.tickfont.size:0)+($.ticks==="outside"?$.ticklen:0)+3;Q["a-title"]=i.draw(V,"a"+Z,{propContainer:K,propName:this.id+".aaxis.title",placeholder:t(V,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-K.title.font.size/3-H,"text-anchor":"middle"}}),Q["b-title"]=i.draw(V,"b"+Z,{propContainer:$,propName:this.id+".baxis.title",placeholder:t(V,"Click to enter Component B title"),attributes:{x:this.x0-N,y:this.y0+this.h+.83*$.title.font.size+N,"text-anchor":"middle"}}),Q["c-title"]=i.draw(V,"c"+Z,{propContainer:ne,propName:this.id+".caxis.title",placeholder:t(V,"Click to enter Component C title"),attributes:{x:this.x0+this.w+N,y:this.y0+this.h+.83*ne.title.font.size+N,"text-anchor":"middle"}})}},L.drawAx=function(j){var V,Z=this.graphDiv,Q=j._name,K=Q.charAt(0),$=j._id,ne=this.layers[Q],H=K+"tickLayout",N=(V=j).ticks+String(V.ticklen)+String(V.showticklabels);this[H]!==N&&(ne.selectAll("."+$+"tick").remove(),this[H]=N),j.setScale();var U=s.calcTicks(j),te=s.clipEnds(j,U),B=s.makeTransTickFn(j),X=s.getTickSigns(j)[2],J=y.deg2rad(30),ee=X*(j.linewidth||1)/2,re=X*j.ticklen,se=this.w,oe=this.h,de=K==="b"?"M0,"+ee+"l"+Math.sin(J)*re+","+Math.cos(J)*re:"M"+ee+",0l"+Math.cos(J)*re+","+-Math.sin(J)*re,ce={a:"M0,0l"+oe+",-"+se/2,b:"M0,0l-"+se/2+",-"+oe,c:"M0,0l-"+oe+","+se/2}[K];s.drawTicks(Z,j,{vals:j.ticks==="inside"?te:U,layer:ne,path:de,transFn:B,crisp:!1}),s.drawGrid(Z,j,{vals:te,layer:this.layers[K+"grid"],path:ce,transFn:B,crisp:!1}),s.drawLabels(Z,j,{vals:U,layer:ne,transFn:B,labelFns:s.makeLabelFns(j,0,30)})};var I=T.MINZOOM/2+.87,P="m-0.87,.5h"+I+"v3h-"+(I+5.2)+"l"+(I/2+2.6)+",-"+(.87*I+4.5)+"l2.6,1.5l-"+I/2+","+.87*I+"Z",S="m0.87,.5h-"+I+"v3h"+(I+5.2)+"l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-2.6,1.5l"+I/2+","+.87*I+"Z",E="m0,1l"+I/2+","+.87*I+"l2.6,-1.5l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-"+(I/2+2.6)+","+(.87*I+4.5)+"l2.6,1.5l"+I/2+",-"+.87*I+"Z",z=!0;function D(j){d.select(j).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearOutline=function(){b(this.dragOptions),_(this.dragOptions.gd)},L.initInteractions=function(){var j,V,Z,Q,K,$,ne,H,N,U,te,B,X=this,J=X.layers.plotbg.select("path").node(),ee=X.graphDiv,re=ee._fullLayout._zoomlayer;function se(le){var ge={};return ge[X.id+".aaxis.min"]=le.a,ge[X.id+".baxis.min"]=le.b,ge[X.id+".caxis.min"]=le.c,ge}function oe(le,ge){var Te=ee._fullLayout.clickmode;D(ee),le===2&&(ee.emit("plotly_doubleclick",null),w.call("_guiRelayout",ee,se({a:0,b:0,c:0}))),Te.indexOf("select")>-1&&le===1&&f(ge,ee,[X.xaxis],[X.yaxis],X.id,X.dragOptions),Te.indexOf("event")>-1&&l.click(ee,ge,X.id)}function de(le,ge){return 1-ge/X.h}function ce(le,ge){return 1-(le+(X.h-ge)/Math.sqrt(3))/X.w}function ve(le,ge){return(le-(X.h-ge)/Math.sqrt(3))/X.w}function Ae(le,ge){var Te=Z+le*j,Se=Q+ge*V,Me=Math.max(0,Math.min(1,de(0,Q),de(0,Se))),ze=Math.max(0,Math.min(1,ce(Z,Q),ce(Te,Se))),Oe=Math.max(0,Math.min(1,ve(Z,Q),ve(Te,Se))),De=(Me/2+Oe)*X.w,Xe=(1-Me/2-ze)*X.w,Be=(De+Xe)/2,Ie=Xe-De,Re=(1-Me)*X.h,Ye=Re-Ie/A;Ie<T.MINZOOM?(ne=K,te.attr("d",N),B.attr("d","M0,0Z")):(ne={a:K.a+Me*$,b:K.b+ze*$,c:K.c+Oe*$},te.attr("d",N+"M"+De+","+Re+"H"+Xe+"L"+Be+","+Ye+"L"+De+","+Re+"Z"),B.attr("d","M"+Z+","+Q+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+De+","+Re+P+"M"+Xe+","+Re+S+"M"+Be+","+Ye+E)),U||(te.transition().style("fill",H>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),B.transition().style("opacity",1).duration(200),U=!0),ee.emit("plotly_relayouting",se(ne))}function fe(){D(ee),ne!==K&&(w.call("_guiRelayout",ee,se(ne)),z&&ee.data&&ee._context.showTips&&(y.notifier(t(ee,"Double-click to zoom back out"),"long"),z=!1))}function me(le,ge){var Te=le/X.xaxis._m,Se=ge/X.yaxis._m,Me=[(ne={a:K.a-Se,b:K.b+(Te+Se)/2,c:K.c-(Te-Se)/2}).a,ne.b,ne.c].sort(y.sorterAsc),ze=Me.indexOf(ne.a),Oe=Me.indexOf(ne.b),De=Me.indexOf(ne.c);Me[0]<0&&(Me[1]+Me[0]/2<0?(Me[2]+=Me[0]+Me[1],Me[0]=Me[1]=0):(Me[2]+=Me[0]/2,Me[1]+=Me[0]/2,Me[0]=0),ne={a:Me[ze],b:Me[Oe],c:Me[De]},ge=(K.a-ne.a)*X.yaxis._m,le=(K.c-ne.c-K.b+ne.b)*X.xaxis._m);var Xe=e(X.x0+le,X.y0+ge);X.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Xe);var Be=e(-le,-ge);X.clipDefRelative.select("path").attr("transform",Be),X.aaxis.range=[ne.a,X.sum-ne.b-ne.c],X.baxis.range=[X.sum-ne.a-ne.c,ne.b],X.caxis.range=[X.sum-ne.a-ne.b,ne.c],X.drawAxes(!1),X._hasClipOnAxisFalse&&X.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,X),ee.emit("plotly_relayouting",se(ne))}function _e(){w.call("_guiRelayout",ee,se(ne))}this.dragOptions={element:J,gd:ee,plotinfo:{id:X.id,domain:ee._fullLayout[X.id].domain,xaxis:X.xaxis,yaxis:X.yaxis},subplot:X.id,prepFn:function(le,ge,Te){X.dragOptions.xaxes=[X.xaxis],X.dragOptions.yaxes=[X.yaxis],j=ee._fullLayout._invScaleX,V=ee._fullLayout._invScaleY;var Se=X.dragOptions.dragmode=ee._fullLayout.dragmode;p(Se)?X.dragOptions.minDrag=1:X.dragOptions.minDrag=void 0,Se==="zoom"?(X.dragOptions.moveFn=Ae,X.dragOptions.clickFn=oe,X.dragOptions.doneFn=fe,function(Me,ze,Oe){var De=J.getBoundingClientRect();Z=ze-De.left,Q=Oe-De.top,ee._fullLayout._calcInverseTransform(ee);var Xe=ee._fullLayout._invTransform,Be=y.apply3DTransform(Xe)(Z,Q);Z=Be[0],Q=Be[1],K={a:X.aaxis.range[0],b:X.baxis.range[1],c:X.caxis.range[1]},ne=K,$=X.aaxis.range[1]-K.a,H=v(X.graphDiv._fullLayout[X.id].bgcolor).getLuminance(),N="M0,"+X.h+"L"+X.w/2+", 0L"+X.w+","+X.h+"Z",U=!1,te=re.append("path").attr("class","zoombox").attr("transform",e(X.x0,X.y0)).style({fill:H>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",N),B=re.append("path").attr("class","zoombox-corners").attr("transform",e(X.x0,X.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),X.clearOutline(ee)}(0,ge,Te)):Se==="pan"?(X.dragOptions.moveFn=me,X.dragOptions.clickFn=oe,X.dragOptions.doneFn=_e,K={a:X.aaxis.range[0],b:X.baxis.range[1],c:X.caxis.range[1]},ne=K,X.clearOutline(ee)):(c(Se)||p(Se))&&x(le,ge,Te,X.dragOptions,Se)}},J.onmousemove=function(le){l.hover(ee,le,X.id),ee._fullLayout._lasthover=J,ee._fullLayout._hoversubplot=X.id},J.onmouseout=function(le){ee._dragging||h.unhover(ee,le)},h.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(m,G,W){var d=m("./lib/loggers"),v=m("./lib/noop"),w=m("./lib/push_unique"),y=m("./lib/is_plain_object"),e=m("./lib/dom").addStyleRule,t=m("./lib/extend"),n=m("./plots/attributes"),a=m("./plots/layout_attributes"),r=t.extendFlat,g=t.extendDeepAll;function u(f){var _=f.name,b=f.categories,T=f.meta;if(W.modules[_])d.log("Type "+_+" already registered");else{W.subplotsRegistry[f.basePlotModule.name]||function(z){var D=z.name;if(W.subplotsRegistry[D])return void d.log("Plot type "+D+" already registered.");for(var j in o(z),W.subplotsRegistry[D]=z,W.componentsRegistry)i(j,z.name)}(f.basePlotModule);for(var k={},L=0;L<b.length;L++)k[b[L]]=!0,W.allCategories[b[L]]=!0;for(var A in W.modules[_]={_module:f,categories:k},T&&Object.keys(T).length&&(W.modules[_].meta=T),W.allTypes.push(_),W.componentsRegistry)p(A,_);f.layoutAttributes&&r(W.traceLayoutAttributes,f.layoutAttributes);var I=f.basePlotModule,P=I.name;if(P==="mapbox"){var S=I.constants.styleRules;for(var E in S)e(".js-plotly-plot .plotly .mapboxgl-"+E,S[E])}P!=="geo"&&P!=="mapbox"||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function s(f){if(typeof f.name!="string")throw new Error("Component module *name* must be a string.");var _=f.name;for(var b in W.componentsRegistry[_]=f,f.layoutAttributes&&(f.layoutAttributes._isLinkedToArray&&w(W.layoutArrayContainers,_),o(f)),W.modules)p(_,b);for(var T in W.subplotsRegistry)i(_,T);for(var k in W.transformsRegistry)c(_,k);f.schema&&f.schema.layout&&g(a,f.schema.layout)}function h(f){if(typeof f.name!="string")throw new Error("Transform module *name* must be a string.");var _="Transform module "+f.name,b=typeof f.transform=="function",T=typeof f.calcTransform=="function";if(!b&&!T)throw new Error(_+" is missing a *transform* or *calcTransform* method.");for(var k in b&&T&&d.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(f.attributes)||d.log(_+" registered without an *attributes* object."),typeof f.supplyDefaults!="function"&&d.log(_+" registered without a *supplyDefaults* method."),W.transformsRegistry[f.name]=f,W.componentsRegistry)c(k,f.name)}function l(f){var _=f.name,b=_.split("-")[0],T=f.dictionary,k=f.format,L=T&&Object.keys(T).length,A=k&&Object.keys(k).length,I=W.localeRegistry,P=I[_];if(P||(I[_]=P={}),b!==_){var S=I[b];S||(I[b]=S={}),L&&S.dictionary===P.dictionary&&(S.dictionary=T),A&&S.format===P.format&&(S.format=k)}L&&(P.dictionary=T),A&&(P.format=k)}function o(f){if(f.layoutAttributes){var _=f.layoutAttributes._arrayAttrRegexps;if(_)for(var b=0;b<_.length;b++)w(W.layoutArrayRegexes,_[b])}}function p(f,_){var b=W.componentsRegistry[f].schema;if(b&&b.traces){var T=b.traces[_];T&&g(W.modules[_]._module.attributes,T)}}function c(f,_){var b=W.componentsRegistry[f].schema;if(b&&b.transforms){var T=b.transforms[_];T&&g(W.transformsRegistry[_].attributes,T)}}function i(f,_){var b=W.componentsRegistry[f].schema;if(b&&b.subplots){var T=W.subplotsRegistry[_],k=T.layoutAttributes,L=T.attr==="subplot"?T.name:T.attr;Array.isArray(L)&&(L=L[0]);var A=b.subplots[L];k&&A&&g(k,A)}}function x(f){return typeof f=="object"&&(f=f.type),f}W.modules={},W.allCategories={},W.allTypes=[],W.subplotsRegistry={},W.transformsRegistry={},W.componentsRegistry={},W.layoutArrayContainers=[],W.layoutArrayRegexes=[],W.traceLayoutAttributes={},W.localeRegistry={},W.apiMethodRegistry={},W.collectableSubplotTypes=null,W.register=function(f){if(W.collectableSubplotTypes=null,!f)throw new Error("No argument passed to Plotly.register.");f&&!Array.isArray(f)&&(f=[f]);for(var _=0;_<f.length;_++){var b=f[_];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":u(b);break;case"transform":h(b);break;case"component":s(b);break;case"locale":l(b);break;case"apiMethod":var T=b.name;W.apiMethodRegistry[T]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},W.getModule=function(f){var _=W.modules[x(f)];return!!_&&_._module},W.traceIs=function(f,_){if((f=x(f))==="various")return!1;var b=W.modules[f];return b||(f&&d.log("Unrecognized trace type "+f+"."),b=W.modules[n.type.dflt]),!!b.categories[_]},W.getTransformIndices=function(f,_){for(var b=[],T=f.transforms||[],k=0;k<T.length;k++)T[k].type===_&&b.push(k);return b},W.hasTransform=function(f,_){for(var b=f.transforms||[],T=0;T<b.length;T++)if(b[T].type===_)return!0;return!1},W.getComponentMethod=function(f,_){var b=W.componentsRegistry[f];return b&&b[_]||v},W.call=function(){var f=arguments[0],_=[].slice.call(arguments,1);return W.apiMethodRegistry[f].apply(null,_)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(m,G,W){var d=m("../registry"),v=m("../lib"),w=v.extendFlat,y=v.extendDeep;function e(t){var n;switch(t){case"themes__thumb":n={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":n={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:n={}}return n}G.exports=function(t,n){var a,r,g=t.data,u=t.layout,s=y([],g),h=y({},u,e(n.tileClass)),l=t._context||{};if(n.width&&(h.width=n.width),n.height&&(h.height=n.height),n.tileClass==="thumbnail"||n.tileClass==="themes__thumb"){h.annotations=[];var o=Object.keys(h);for(a=0;a<o.length;a++)r=o[a],["xaxis","yaxis","zaxis"].indexOf(r.slice(0,5))>-1&&(h[o[a]].title={text:""});for(a=0;a<s.length;a++){var p=s[a];p.showscale=!1,p.marker&&(p.marker.showscale=!1),d.traceIs(p,"pie-like")&&(p.textposition="none")}}if(Array.isArray(n.annotations))for(a=0;a<n.annotations.length;a++)h.annotations.push(n.annotations[a]);var c=Object.keys(h).filter(function(b){return b.match(/^scene\d*$/)});if(c.length){var i={};for(n.tileClass==="thumbnail"&&(i={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),a=0;a<c.length;a++){var x=h[c[a]];x.xaxis||(x.xaxis={}),x.yaxis||(x.yaxis={}),x.zaxis||(x.zaxis={}),w(x.xaxis,i),w(x.yaxis,i),w(x.zaxis,i),x._scene=null}}var f=document.createElement("div");n.tileClass&&(f.className=n.tileClass);var _={gd:f,td:f,layout:h,data:s,config:{staticPlot:n.staticPlot===void 0||n.staticPlot,plotGlPixelRatio:n.plotGlPixelRatio===void 0?2:n.plotGlPixelRatio,displaylogo:n.displaylogo||!1,showLink:n.showLink||!1,showTips:n.showTips||!1,mapboxAccessToken:l.mapboxAccessToken}};return n.setBackground!=="transparent"&&(_.config.setBackground=n.setBackground||"opaque"),_.gd.defaultLayout=e(n.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(m,G,W){var d=m("../lib"),v=m("../plot_api/to_image"),w=m("./filesaver"),y=m("./helpers");G.exports=function(e,t){var n;return d.isPlainObject(e)||(n=d.getGraphDiv(e)),(t=t||{}).format=t.format||"png",t.width=t.width||null,t.height=t.height||null,t.imageDataOnly=!0,new Promise(function(a,r){n&&n._snapshotInProgress&&r(new Error("Snapshotting already in progress.")),d.isIE()&&t.format!=="svg"&&r(new Error(y.MSG_IE_BAD_FORMAT)),n&&(n._snapshotInProgress=!0);var g=v(e,t),u=t.filename||e.fn||"newplot";u+="."+t.format.replace("-","."),g.then(function(s){return n&&(n._snapshotInProgress=!1),w(s,u,t.format)}).then(function(s){a(s)}).catch(function(s){n&&(n._snapshotInProgress=!1),r(s)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(m,G,W){var d=m("../lib"),v=m("./helpers");G.exports=function(w,y,e){var t=document.createElement("a"),n="download"in t;return new Promise(function(a,r){var g,u;if(d.isIE())return g=v.createBlob(w,"svg"),window.navigator.msSaveBlob(g,y),g=null,a(y);if(n)return g=v.createBlob(w,e),u=v.createObjectURL(g),t.href=u,t.download=y,document.body.appendChild(t),t.click(),document.body.removeChild(t),v.revokeObjectURL(u),g=null,a(y);if(d.isSafari()){var s=e==="svg"?",":";base64,";return v.octetStream(s+encodeURIComponent(w)),a(y)}r(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(m,G,W){var d=m("../registry");W.getDelay=function(w){return w._has&&(w._has("gl3d")||w._has("gl2d")||w._has("mapbox"))?500:0},W.getRedrawFunc=function(w){return function(){d.getComponentMethod("colorbar","draw")(w)}},W.encodeSVG=function(w){return"data:image/svg+xml,"+encodeURIComponent(w)},W.encodeJSON=function(w){return"data:application/json,"+encodeURIComponent(w)};var v=window.URL||window.webkitURL;W.createObjectURL=function(w){return v.createObjectURL(w)},W.revokeObjectURL=function(w){return v.revokeObjectURL(w)},W.createBlob=function(w,y){if(y==="svg")return new window.Blob([w],{type:"image/svg+xml;charset=utf-8"});if(y==="full-json")return new window.Blob([w],{type:"application/json;charset=utf-8"});var e=function(t){for(var n=t.length,a=new ArrayBuffer(n),r=new Uint8Array(a),g=0;g<n;g++)r[g]=t.charCodeAt(g);return a}(window.atob(w));return new window.Blob([e],{type:"image/"+y})},W.octetStream=function(w){document.location.href="data:application/octet-stream"+w},W.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,W.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(m,G,W){var d=m("./helpers"),v={getDelay:d.getDelay,getRedrawFunc:d.getRedrawFunc,clone:m("./cloneplot"),toSVG:m("./tosvg"),svgToImg:m("./svgtoimg"),toImage:m("./toimage"),downloadImage:m("./download")};G.exports=v},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(m,G,W){var d=m("../lib"),v=m("events").EventEmitter,w=m("./helpers");G.exports=function(y){var e=y.emitter||new v,t=new Promise(function(n,a){var r=window.Image,g=y.svg,u=y.format||"png";if(d.isIE()&&u!=="svg"){var s=new Error(w.MSG_IE_BAD_FORMAT);return a(s),y.promise?t:e.emit("error",s)}var h,l,o=y.canvas,p=y.scale||1,c=y.width||300,i=y.height||150,x=p*c,f=p*i,_=o.getContext("2d",{willReadFrequently:!0}),b=new r;u==="svg"||d.isSafari()?l=w.encodeSVG(g):(h=w.createBlob(g,"svg"),l=w.createObjectURL(h)),o.width=x,o.height=f,b.onload=function(){var T;switch(h=null,w.revokeObjectURL(l),u!=="svg"&&_.drawImage(b,0,0,x,f),u){case"jpeg":T=o.toDataURL("image/jpeg");break;case"png":T=o.toDataURL("image/png");break;case"webp":T=o.toDataURL("image/webp");break;case"svg":T=l;break;default:var k="Image format is not jpeg, png, svg or webp.";if(a(new Error(k)),!y.promise)return e.emit("error",k)}n(T),y.promise||e.emit("success",T)},b.onerror=function(T){if(h=null,w.revokeObjectURL(l),a(T),!y.promise)return e.emit("error",T)},b.src=l});return y.promise?t:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(m,G,W){var d=m("events").EventEmitter,v=m("../registry"),w=m("../lib"),y=m("./helpers"),e=m("./cloneplot"),t=m("./tosvg"),n=m("./svgtoimg");G.exports=function(a,r){var g=new d,u=e(a,{format:"png"}),s=u.gd;s.style.position="absolute",s.style.left="-5000px",document.body.appendChild(s);var h=y.getRedrawFunc(s);return v.call("_doPlot",s,u.data,u.layout,u.config).then(h).then(function(){var l=y.getDelay(s._fullLayout);setTimeout(function(){var o=t(s),p=document.createElement("canvas");p.id=w.randstr(),(g=n({format:r.format,width:s._fullLayout.width,height:s._fullLayout.height,canvas:p,emitter:g,svg:o})).clean=function(){s&&document.body.removeChild(s)}},l)}).catch(function(l){g.emit("error",l)}),g}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(m,G,W){var d=m("@plotly/d3"),v=m("../lib"),w=m("../components/drawing"),y=m("../components/color"),e=m("../constants/xmlns_namespaces"),t=/"/g,n=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");G.exports=function(a,r,g){var u,s=a._fullLayout,h=s._paper,l=s._toppaper,o=s.width,p=s.height;h.insert("rect",":first-child").call(w.setRect,0,0,o,p).call(y.fill,s.paper_bgcolor);var c=s._basePlotModules||[];for(u=0;u<c.length;u++){var i=c[u];i.toSVG&&i.toSVG(a)}if(l){var x=l.node().childNodes,f=Array.prototype.slice.call(x);for(u=0;u<f.length;u++){var _=f[u];_.childNodes.length&&h.node().appendChild(_)}}s._draggers&&s._draggers.remove(),h.node().style.background="",h.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var T=d.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){T.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&T.style("font-family",k.replace(t,"TOBESTRIPPED"))}else T.remove()}),h.selectAll(".gradient_filled,.pattern_filled").each(function(){var T=d.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&T.style("fill",k.replace(t,"TOBESTRIPPED"));var L=this.style.stroke;L&&L.indexOf("url(")!==-1&&T.style("stroke",L.replace(t,"TOBESTRIPPED"))}),r!=="pdf"&&r!=="eps"||h.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),h.node().setAttributeNS(e.xmlns,"xmlns",e.svg),h.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),r==="svg"&&g&&(h.attr("width",g*o),h.attr("height",g*p),h.attr("viewBox","0 0 "+o+" "+p));var b=new window.XMLSerializer().serializeToString(h.node());return b=function(T){var k=d.select("body").append("div").style({display:"none"}).html(""),L=T.replace(/(&[^;]*;)/gi,function(A){return A==="&lt;"?"&#60;":A==="&rt;"?"&#62;":A.indexOf("<")!==-1||A.indexOf(">")!==-1?"":k.html(A).text()});return k.remove(),L}(b),b=(b=b.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(n,"'"),v.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.hovertext,v,"htx");var e=w.marker;if(e){d.mergeArray(e.opacity,v,"mo",!0),d.mergeArray(e.color,v,"mc");var t=e.line;t&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"))}}},{"../../lib":515}],657:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../components/colorscale/attributes"),t=m("../../plots/font_attributes"),n=m("./constants"),a=m("../../components/drawing/attributes").pattern,r=m("../../lib/extend").extendFlat,g=t({editType:"calc",arrayOk:!0,colorEditType:"style"}),u=r({},d.marker.line.width,{dflt:0}),s=r({width:u,editType:"calc"},e("marker.line")),h=r({line:s,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});G.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),text:d.text,texttemplate:y({editType:"plot"},{keys:n.eventDataKeys}),hovertext:d.hovertext,hovertemplate:w({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},g,{}),insidetextfont:r({},g,{}),outsidetextfont:r({},g,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},d.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:h,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,color:d.selected.marker.color,editType:"style"},textfont:d.selected.textfont,editType:"style"},unselected:{marker:{opacity:d.unselected.marker.opacity,color:d.unselected.marker.color,editType:"style"},textfont:d.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("../../components/colorscale/helpers").hasColorscale,y=m("../../components/colorscale/calc"),e=m("./arrays_to_calcdata"),t=m("../scatter/calc_selection");G.exports=function(n,a){var r,g,u,s,h,l,o=d.getFromId(n,a.xaxis||"x"),p=d.getFromId(n,a.yaxis||"y"),c={msUTC:!(!a.base&&a.base!==0)};a.orientation==="h"?(r=o.makeCalcdata(a,"x",c),u=p.makeCalcdata(a,"y"),s=v(a,p,"y",u),h=!!a.yperiodalignment,l="y"):(r=p.makeCalcdata(a,"y",c),u=o.makeCalcdata(a,"x"),s=v(a,o,"x",u),h=!!a.xperiodalignment,l="x"),g=s.vals;for(var i=Math.min(g.length,r.length),x=new Array(i),f=0;f<i;f++)x[f]={p:g[f],s:r[f]},h&&(x[f].orig_p=u[f],x[f][l+"End"]=s.ends[f],x[f][l+"Start"]=s.starts[f]),a.ids&&(x[f].id=String(a.ids[f]));return w(a,"marker")&&y(n,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),w(a,"marker.line")&&y(n,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(x,a),t(x,a),x}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(m,G,W){G.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib").isArrayOrTypedArray,w=m("../../constants/numerical").BADNUM,y=m("../../registry"),e=m("../../plots/cartesian/axes"),t=m("../../plots/cartesian/constraints").getAxisGroup,n=m("./sieve.js");function a(i,x,f,_,b){if(_.length){var T,k,L,A;switch(function(I,P){var S,E;for(S=0;S<P.length;S++){var z,D=P[S],j=D[0].trace,V=j.type==="funnel"?j._base:j.base,Z=j.orientation==="h"?j.xcalendar:j.ycalendar,Q=I.type==="category"||I.type==="multicategory"?function(){return null}:I.d2c;if(v(V)){for(E=0;E<Math.min(V.length,D.length);E++)z=Q(V[E],0,Z),d(z)?(D[E].b=+z,D[E].hasB=1):D[E].b=0;for(;E<D.length;E++)D[E].b=0}else{z=Q(V,0,Z);var K=d(z);for(z=K?z:0,E=0;E<D.length;E++)D[E].b=z,K&&(D[E].hasB=1)}}}(f,_),b.mode){case"overlay":r(x,f,_,b);break;case"group":for(T=[],k=[],L=0;L<_.length;L++)(A=_[L])[0].trace.offset===void 0?k.push(A):T.push(A);k.length&&function(I,P,S,E,z){var D=new n(E,{posAxis:P,sepNegVal:!1,overlapNoMerge:!z.norm});(function(j,V,Z,Q){for(var K=j._fullLayout,$=Z.positions,ne=Z.distinctPositions,H=Z.minDiff,N=Z.traces,U=N.length,te=$.length!==ne.length,B=H*(1-Q.gap),X=t(K,V._id)+N[0][0].trace.orientation,J=K._alignmentOpts[X]||{},ee=0;ee<U;ee++){var re,se,oe=N[ee],de=oe[0].trace,ce=J[de.alignmentgroup]||{},ve=Object.keys(ce.offsetGroups||{}).length,Ae=(re=ve?B/ve:te?B/U:B)*(1-(Q.groupgap||0));se=ve?((2*de._offsetIndex+1-ve)*re-Ae)/2:te?((2*ee+1-U)*re-Ae)/2:-Ae/2;var fe=oe[0].t;fe.barwidth=Ae,fe.poffset=se,fe.bargroupwidth=B,fe.bardelta=H}Z.binWidth=N[0][0].t.barwidth/100,u(Z),s(V,Z),h(V,Z,te)})(I,P,D,z),function(j,V){for(var Z=j.traces,Q=0;Q<Z.length;Q++){var K=Z[Q];if(K[0].trace.base===void 0)for(var $=new n([K],{posAxis:V,sepNegVal:!0,overlapNoMerge:!0}),ne=0;ne<K.length;ne++){var H=K[ne];if(H.p!==w){var N=$.put(H.p,H.b+H.s);N&&(H.b=N)}}}}(D,P),z.norm?(o(D),p(S,D,z)):l(S,D)}(i,x,f,k,b),T.length&&r(x,f,T,b);break;case"stack":case"relative":for(T=[],k=[],L=0;L<_.length;L++)(A=_[L])[0].trace.base===void 0?k.push(A):T.push(A);k.length&&function(I,P,S,E,z){var D=new n(E,{posAxis:P,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});g(P,D,z),function(K,$,ne){var H,N,U,te,B,X,J=c(K),ee=$.traces;for(te=0;te<ee.length;te++)if(H=ee[te],(N=H[0].trace).type==="funnel")for(B=0;B<H.length;B++)(X=H[B]).s!==w&&$.put(X.p,-.5*X.s);for(te=0;te<ee.length;te++){H=ee[te],N=H[0].trace,U=N.type==="funnel";var re=[];for(B=0;B<H.length;B++)if((X=H[B]).s!==w){var se;se=U?X.s:X.s+X.b;var oe=$.put(X.p,se),de=oe+se;X.b=oe,X[J]=de,ne.norm||(re.push(de),X.hasB&&re.push(oe))}ne.norm||(N._extremes[K._id]=e.findExtremes(K,re,{tozero:!0,padded:!0}))}}(S,D,z);for(var j=0;j<E.length;j++)for(var V=E[j],Z=0;Z<V.length;Z++){var Q=V[Z];Q.s!==w&&Q.b+Q.s===D.get(Q.p,Q.s)&&(Q._outmost=!0)}z.norm&&p(S,D,z)}(0,x,f,k,b),T.length&&r(x,f,T,b)}(function(I,P){var S,E,z,D=c(P),j={},V=1/0,Z=-1/0;for(S=0;S<I.length;S++)for(z=I[S],E=0;E<z.length;E++){var Q=z[E].p;d(Q)&&(V=Math.min(V,Q),Z=Math.max(Z,Q))}var K=1e4/(Z-V),$=j.round=function(X){return String(Math.round(K*(X-V)))};for(S=0;S<I.length;S++){(z=I[S])[0].t.extents=j;var ne=z[0].t.poffset,H=Array.isArray(ne);for(E=0;E<z.length;E++){var N=z[E],U=N[D]-N.w/2;if(d(U)){var te=N[D]+N.w/2,B=$(N.p);j[B]?j[B]=[Math.min(U,j[B][0]),Math.max(te,j[B][1])]:j[B]=[U,te]}N.p0=N.p+(H?ne[E]:ne),N.p1=N.p0+N.w,N.s0=N.b,N.s1=N.s0+N.s}}})(_,x)}}function r(i,x,f,_){for(var b=0;b<f.length;b++){var T=f[b],k=new n([T],{posAxis:i,sepNegVal:!1,overlapNoMerge:!_.norm});g(i,k,_),_.norm?(o(k),p(x,k,_)):l(x,k)}}function g(i,x,f){for(var _=x.minDiff,b=x.traces,T=_*(1-f.gap),k=T*(1-(f.groupgap||0)),L=-k/2,A=0;A<b.length;A++){var I=b[A][0].t;I.barwidth=k,I.poffset=L,I.bargroupwidth=T,I.bardelta=_}x.binWidth=b[0][0].t.barwidth/100,u(x),s(i,x),h(i,x)}function u(i){var x,f,_=i.traces;for(x=0;x<_.length;x++){var b,T=_[x],k=T[0],L=k.trace,A=k.t,I=L._offset||L.offset,P=A.poffset;if(v(I)){for(b=Array.prototype.slice.call(I,0,T.length),f=0;f<b.length;f++)d(b[f])||(b[f]=P);for(f=b.length;f<T.length;f++)b.push(P);A.poffset=b}else I!==void 0&&(A.poffset=I);var S=L._width||L.width,E=A.barwidth;if(v(S)){var z=Array.prototype.slice.call(S,0,T.length);for(f=0;f<z.length;f++)d(z[f])||(z[f]=E);for(f=z.length;f<T.length;f++)z.push(E);if(A.barwidth=z,I===void 0){for(b=[],f=0;f<T.length;f++)b.push(P+(E-z[f])/2);A.poffset=b}}else S!==void 0&&(A.barwidth=S,I===void 0&&(A.poffset=P+(E-S)/2))}}function s(i,x){for(var f=x.traces,_=c(i),b=0;b<f.length;b++)for(var T=f[b],k=T[0].t,L=k.poffset,A=Array.isArray(L),I=k.barwidth,P=Array.isArray(I),S=0;S<T.length;S++){var E=T[S],z=E.w=P?I[S]:I;E[_]=E.p+(A?L[S]:L)+z/2}}function h(i,x,f){var _=x.traces,b=x.minDiff/2;e.minDtick(i,x.minDiff,x.distinctPositions[0],f);for(var T=0;T<_.length;T++){var k,L,A,I,P=_[T],S=P[0],E=S.trace,z=[];for(I=0;I<P.length;I++)L=(k=P[I]).p-b,A=k.p+b,z.push(L,A);if(E.width||E.offset){var D=S.t,j=D.poffset,V=D.barwidth,Z=Array.isArray(j),Q=Array.isArray(V);for(I=0;I<P.length;I++){k=P[I];var K=Z?j[I]:j,$=Q?V[I]:V;A=(L=k.p+K)+$,z.push(L,A)}}E._extremes[i._id]=e.findExtremes(i,z,{padded:!1})}}function l(i,x){for(var f=x.traces,_=c(i),b=0;b<f.length;b++){for(var T=f[b],k=T[0].trace,L=[],A=!1,I=0;I<T.length;I++){var P=T[I],S=P.b,E=S+P.s;P[_]=E,L.push(E),P.hasB&&L.push(S),P.hasB&&P.b||(A=!0)}k._extremes[i._id]=e.findExtremes(i,L,{tozero:A,padded:!0})}}function o(i){for(var x=i.traces,f=0;f<x.length;f++)for(var _=x[f],b=0;b<_.length;b++){var T=_[b];T.s!==w&&i.put(T.p,T.b+T.s)}}function p(i,x,f){var _=x.traces,b=c(i),T=f.norm==="fraction"?1:100,k=T/1e9,L=i.l2c(i.c2l(0)),A=f.mode==="stack"?T:L;function I(ne){return d(i.c2l(ne))&&(ne<L-k||ne>A+k||!d(L))}for(var P=0;P<_.length;P++){for(var S=_[P],E=S[0].trace,z=[],D=!1,j=!1,V=0;V<S.length;V++){var Z=S[V];if(Z.s!==w){var Q=Math.abs(T/x.get(Z.p,Z.s));Z.b*=Q,Z.s*=Q;var K=Z.b,$=K+Z.s;Z[b]=$,z.push($),j=j||I($),Z.hasB&&(z.push(K),j=j||I(K)),Z.hasB&&Z.b||(D=!0)}}E._extremes[i._id]=e.findExtremes(i,z,{tozero:D,padded:j})}}function c(i){return i._id.charAt(0)}G.exports={crossTraceCalc:function(i,x){for(var f=x.xaxis,_=x.yaxis,b=i._fullLayout,T=i._fullData,k=i.calcdata,L=[],A=[],I=0;I<T.length;I++){var P=T[I];if(P.visible===!0&&y.traceIs(P,"bar")&&P.xaxis===f._id&&P.yaxis===_._id&&(P.orientation==="h"?L.push(k[I]):A.push(k[I]),P._computePh))for(var S=i.calcdata[I],E=0;E<S.length;E++)typeof S[E].ph0=="function"&&(S[E].ph0=S[E].ph0()),typeof S[E].ph1=="function"&&(S[E].ph1=S[E].ph1())}var z={xCat:f.type==="category"||f.type==="multicategory",yCat:_.type==="category"||_.type==="multicategory",mode:b.barmode,norm:b.barnorm,gap:b.bargap,groupgap:b.bargroupgap};a(i,f,_,A,z),a(i,_,f,L,z)},setGroupPositions:a}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../../registry"),y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./style_defaults"),n=m("../../plots/cartesian/constraints").getAxisGroup,a=m("./attributes"),r=d.coerceFont;function g(s,h,l,o){var p=h.orientation,c=h[{v:"x",h:"y"}[p]+"axis"],i=n(l,c)+p,x=l._alignmentOpts||{},f=o("alignmentgroup"),_=x[i];_||(_=x[i]={});var b=_[f];b?b.traces.push(h):b=_[f]={traces:[h],alignmentIndex:Object.keys(_).length,offsetGroups:{}};var T=o("offsetgroup"),k=b.offsetGroups,L=k[T];T&&(L||(L=k[T]={offsetIndex:Object.keys(k).length}),h._offsetIndex=L.offsetIndex)}function u(s,h,l,o,p,c){var i=(c=c||{}).moduleHasSelected!==!1,x=c.moduleHasUnselected!==!1,f=c.moduleHasConstrain!==!1,_=c.moduleHasCliponaxis!==!1,b=c.moduleHasTextangle!==!1,T=c.moduleHasInsideanchor!==!1,k=!!c.hasPathbar,L=Array.isArray(p)||p==="auto",A=L||p==="inside",I=L||p==="outside";if(A||I){var P=r(o,"textfont",l.font),S=d.extendFlat({},P),E=!(s.textfont&&s.textfont.color);if(E&&delete S.color,r(o,"insidetextfont",S),k){var z=d.extendFlat({},P);E&&delete z.color,r(o,"pathbar.textfont",z)}I&&r(o,"outsidetextfont",P),i&&o("selected.textfont.color"),x&&o("unselected.textfont.color"),f&&o("constraintext"),_&&o("cliponaxis"),b&&o("textangle"),o("texttemplate")}A&&T&&o("insidetextanchor")}G.exports={supplyDefaults:function(s,h,l,o){function p(f,_){return d.coerce(s,h,a,f,_)}if(y(s,h,o,p)){e(s,h,o,p),p("xhoverformat"),p("yhoverformat"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var c=p("textposition");u(s,h,o,p,c,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),t(s,h,p,l,o);var i=(h.marker.line||{}).color,x=w.getComponentMethod("errorbars","supplyDefaults");x(s,h,i||v.defaultLine,{axis:"y"}),x(s,h,i||v.defaultLine,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(h,p)}else h.visible=!1},crossTraceDefaults:function(s,h){var l;function o(c){return d.coerce(l._input,l,a,c)}if(h.barmode==="group")for(var p=0;p<s.length;p++)(l=s[p]).type==="bar"&&(l._input,g(0,l,h,o))},handleGroupingDefaults:g,handleText:u}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(m,G,W){G.exports=function(d,v,w){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),w.orientation==="h"?(d.label=d.y,d.value=d.x):(d.label=d.x,d.value=d.y),d}},{}],663:[function(m,G,W){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../../lib").isArrayOrTypedArray;W.coerceString=function(y,e,t){if(typeof e=="string"){if(e||!y.noBlank)return e}else if((typeof e=="number"||e===!0)&&!y.strict)return String(e);return t!==void 0?t:y.dflt},W.coerceNumber=function(y,e,t){if(d(e)){e=+e;var n=y.min,a=y.max;if(!(n!==void 0&&e<n||a!==void 0&&e>a))return e}return t!==void 0?t:y.dflt},W.coerceColor=function(y,e,t){return v(e).isValid()?e:t!==void 0?t:y.dflt},W.coerceEnumerated=function(y,e,t){return y.coerceNumber&&(e=+e),y.values.indexOf(e)!==-1?e:t!==void 0?t:y.dflt},W.getValue=function(y,e){var t;return Array.isArray(y)?e<y.length&&(t=y[e]):t=y,t},W.getLineWidth=function(y,e){return 0<e.mlw?e.mlw:w(y.marker.line.width)?0:y.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(m,G,W){var d=m("../../components/fx"),v=m("../../registry"),w=m("../../components/color"),y=m("../../lib").fillText,e=m("./helpers").getLineWidth,t=m("../../plots/cartesian/axes").hoverLabelText,n=m("../../constants/numerical").BADNUM;function a(g,u,s,h,l){var o,p,c,i,x,f,_,b=g.cd,T=b[0].trace,k=b[0].t,L=h==="closest",A=T.type==="waterfall",I=g.maxHoverDistance,P=g.maxSpikeDistance;T.orientation==="h"?(o=s,p=u,c="y",i="x",x=H,f=$):(o=u,p=s,c="x",i="y",f=H,x=$);var S=T[c+"period"],E=L||S;function z(re){return j(re,-1)}function D(re){return j(re,1)}function j(re,se){var oe=re.w;return re[c]+se*oe/2}function V(re){return re[c+"End"]-re[c+"Start"]}var Z=L?z:S?function(re){return re.p-V(re)/2}:function(re){return Math.min(z(re),re.p-k.bardelta/2)},Q=L?D:S?function(re){return re.p+V(re)/2}:function(re){return Math.max(D(re),re.p+k.bardelta/2)};function K(re,se,oe){return l.finiteRange&&(oe=0),d.inbox(re-o,se-o,oe+Math.min(1,Math.abs(se-re)/_)-1)}function $(re){return K(Z(re),Q(re),I)}function ne(re){var se=re[i];if(A){var oe=Math.abs(re.rawS)||0;p>0?se+=oe:p<0&&(se-=oe)}return se}function H(re){var se=p,oe=re.b,de=ne(re);return d.inbox(oe-se,de-se,I+(de-se)/(de-oe)-1)}var N=g[c+"a"],U=g[i+"a"];_=Math.abs(N.r2c(N.range[1])-N.r2c(N.range[0]));var te=d.getDistanceFunction(h,x,f,function(re){return(x(re)+f(re))/2});if(d.getClosest(b,te,g),g.index!==!1&&b[g.index].p!==n){E||(Z=function(re){return Math.min(z(re),re.p-k.bargroupwidth/2)},Q=function(re){return Math.max(D(re),re.p+k.bargroupwidth/2)});var B=b[g.index],X=T.base?B.b+B.s:B.s;g[i+"0"]=g[i+"1"]=U.c2p(B[i],!0),g[i+"LabelVal"]=X;var J=k.extents[k.extents.round(B.p)];g[c+"0"]=N.c2p(L?Z(B):J[0],!0),g[c+"1"]=N.c2p(L?Q(B):J[1],!0);var ee=B.orig_p!==void 0;return g[c+"LabelVal"]=ee?B.orig_p:B.p,g.labelLabel=t(N,g[c+"LabelVal"],T[c+"hoverformat"]),g.valueLabel=t(U,g[i+"LabelVal"],T[i+"hoverformat"]),g.baseLabel=t(U,B.b,T[i+"hoverformat"]),g.spikeDistance=(function(re){var se=p,oe=re.b,de=ne(re);return d.inbox(oe-se,de-se,P+(de-se)/(de-oe)-1)}(B)+function(re){return K(z(re),D(re),P)}(B))/2,g[c+"Spike"]=N.c2p(B.p,!0),y(B,T,g),g.hovertemplate=T.hovertemplate,g}}function r(g,u){var s=u.mcc||g.marker.color,h=u.mlcc||g.marker.line.color,l=e(g,u);return w.opacity(s)?s:w.opacity(h)&&l?h:void 0}G.exports={hoverPoints:function(g,u,s,h,l){var o=a(g,u,s,h,l);if(o){var p=o.cd,c=p[0].trace,i=p[o.index];return o.color=r(c,i),v.getComponentMethod("errorbars","hoverInfo")(i,c,o),[o]}},hoverOnBars:a,getTraceColor:r}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc").crossTraceCalc,colorbar:m("../scatter/marker_colorbar"),arraysToCalcdata:m("./arrays_to_calcdata"),plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"bar",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(m,G,W){G.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(m,G,W){var d=m("../../registry"),v=m("../../plots/cartesian/axes"),w=m("../../lib"),y=m("./layout_attributes");G.exports=function(e,t,n){function a(c,i){return w.coerce(e,t,y,c,i)}for(var r=!1,g=!1,u=!1,s={},h=a("barmode"),l=0;l<n.length;l++){var o=n[l];if(d.traceIs(o,"bar")&&o.visible){if(r=!0,h==="group"){var p=o.xaxis+o.yaxis;s[p]&&(u=!0),s[p]=!0}o.visible&&o.type==="histogram"&&v.getFromId({_fullLayout:t},o[o.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(g=!0)}}r?(h!=="overlay"&&a("barnorm"),a("bargap",g&&!u?0:.2),a("bargroupgap")):delete t.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../lib/svg_text_utils"),e=m("../../components/color"),t=m("../../components/drawing"),n=m("../../registry"),a=m("../../plots/cartesian/axes").tickText,r=m("./uniform_text"),g=r.recordMinTextSize,u=r.clearMinTextSize,s=m("./style"),h=m("./helpers"),l=m("./constants"),o=m("./attributes"),p=o.text,c=o.textposition,i=m("../../components/fx/helpers").appendArrayPointValue,x=l.TEXTPAD;function f(P){return P.id}function _(P){if(P.ids)return f}function b(P,S){return P<S?1:-1}function T(P,S,E,z){var D;return!S.uniformtext.mode&&k(E)?(z&&(D=z()),P.transition().duration(E.duration).ease(E.easing).each("end",function(){D&&D()}).each("interrupt",function(){D&&D()})):P}function k(P){return P&&P.duration>0}function L(P){return P==="auto"?0:P}function A(P,S){var E=Math.PI/180*S,z=Math.abs(Math.sin(E)),D=Math.abs(Math.cos(E));return{x:P.width*D+P.height*z,y:P.width*z+P.height*D}}function I(P,S,E,z,D,j){var V=!!j.isHorizontal,Z=!!j.constrained,Q=j.angle||0,K=j.anchor||"end",$=K==="end",ne=K==="start",H=((j.leftToRight||0)+1)/2,N=1-H,U=D.width,te=D.height,B=Math.abs(S-P),X=Math.abs(z-E),J=B>2*x&&X>2*x?x:0;B-=2*J,X-=2*J;var ee=L(Q);Q!=="auto"||U<=B&&te<=X||!(U>B||te>X)||(U>X||te>B)&&U<te==B<X||(ee+=90);var re=A(D,ee),se=1;Z&&(se=Math.min(1,B/re.x,X/re.y));var oe=D.left*N+D.right*H,de=(D.top+D.bottom)/2,ce=(P+x)*N+(S-x)*H,ve=(E+z)/2,Ae=0,fe=0;if(ne||$){var me=(V?re.x:re.y)/2,_e=V?b(P,S):b(E,z);V?ne?(ce=P+_e*J,Ae=-_e*me):(ce=S-_e*J,Ae=_e*me):ne?(ve=E+_e*J,fe=-_e*me):(ve=z-_e*J,fe=_e*me)}return{textX:oe,textY:de,targetX:ce,targetY:ve,anchorX:Ae,anchorY:fe,scale:se,rotate:ee}}G.exports={plot:function(P,S,E,z,D,j){var V=S.xaxis,Z=S.yaxis,Q=P._fullLayout;D||(D={mode:Q.barmode,norm:Q.barmode,gap:Q.bargap,groupgap:Q.bargroupgap},u("bar",Q));var K=w.makeTraceGroups(z,E,"trace bars").each(function($){var ne=d.select(this),H=$[0].trace,N=H.type==="waterfall",U=H.type==="funnel",te=H.type==="bar"||U,B=0;N&&H.connector.visible&&H.connector.mode==="between"&&(B=H.connector.line.width/2);var X=H.orientation==="h",J=k(D),ee=w.ensureSingle(ne,"g","points"),re=_(H),se=ee.selectAll("g.point").data(w.identity,re);se.enter().append("g").classed("point",!0),se.exit().remove(),se.each(function(de,ce){var ve,Ae,fe=d.select(this),me=function(Be,Ie,Re,Ye){var Qe=[],lt=[],xt=Ye?Ie:Re,wt=Ye?Re:Ie;return Qe[0]=xt.c2p(Be.s0,!0),lt[0]=wt.c2p(Be.p0,!0),Qe[1]=xt.c2p(Be.s1,!0),lt[1]=wt.c2p(Be.p1,!0),Ye?[Qe,lt]:[lt,Qe]}(de,V,Z,X),_e=me[0][0],le=me[0][1],ge=me[1][0],Te=me[1][1],Se=(X?le-_e:Te-ge)==0;if(Se&&te&&h.getLineWidth(H,de)&&(Se=!1),Se||(Se=!(v(_e)&&v(le)&&v(ge)&&v(Te))),de.isBlank=Se,Se&&(X?le=_e:Te=ge),B&&!Se&&(X?(_e-=b(_e,le)*B,le+=b(_e,le)*B):(ge-=b(ge,Te)*B,Te+=b(ge,Te)*B)),H.type==="waterfall"){if(!Se){var Me=H[de.dir].marker;ve=Me.line.width,Ae=Me.color}}else ve=h.getLineWidth(H,de),Ae=de.mc||H.marker.color;function ze(Be){var Ie=d.round(ve/2%1,2);return D.gap===0&&D.groupgap===0?d.round(Math.round(Be)-Ie,2):Be}if(!P._context.staticPlot){var Oe=e.opacity(Ae)<1||ve>.01?ze:function(Be,Ie,Re){return Re&&Be===Ie?Be:Math.abs(Be-Ie)>=2?ze(Be):Be>Ie?Math.ceil(Be):Math.floor(Be)};_e=Oe(_e,le,X),le=Oe(le,_e,X),ge=Oe(ge,Te,!X),Te=Oe(Te,ge,!X)}var De=T(w.ensureSingle(fe,"path"),Q,D,j);if(De.style("vector-effect","non-scaling-stroke").attr("d",isNaN((le-_e)*(Te-ge))||Se&&P._context.staticPlot?"M0,0Z":"M"+_e+","+ge+"V"+Te+"H"+le+"V"+ge+"Z").call(t.setClipUrl,S.layerClipId,P),!Q.uniformtext.mode&&J){var Xe=t.makePointStyleFns(H);t.singlePointStyle(de,De,H,Xe,P)}(function(Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e){var vt,Nt=Ie.xaxis,qt=Ie.yaxis,Jt=Be._fullLayout;function Wt(Ht,pr,Mr){return w.ensureSingle(Ht,"text").text(pr).attr({class:"bartext bartext-"+vt,"text-anchor":"middle","data-notex":1}).call(t.font,Mr).call(y.convertToTspans,Be)}var ar=Ye[0].trace,Dt=ar.orientation==="h",Ne=function(Ht,pr,Mr,hr,Qt){var tr,rr=pr[0].trace;return tr=rr.texttemplate?function(fr,yr,Sr,Dr,Nr){var Wr=yr[0].trace,hn=w.castOption(Wr,Sr,"texttemplate");if(!hn)return"";var tn,Fn,an,xn,_n=Wr.type==="histogram",ti=Wr.type==="waterfall",jr=Wr.type==="funnel",nn=Wr.orientation==="h";nn?(tn="y",Fn=Nr,an="x",xn=Dr):(tn="x",Fn=Dr,an="y",xn=Nr);function vn(nr){return a(xn,xn.c2l(nr),!0).text}var en=yr[Sr],fn={};fn.label=en.p,fn.labelLabel=fn[tn+"Label"]=(Gn=en.p,a(Fn,Fn.c2l(Gn),!0).text);var Gn,Tn=w.castOption(Wr,en.i,"text");(Tn===0||Tn)&&(fn.text=Tn),fn.value=en.s,fn.valueLabel=fn[an+"Label"]=vn(en.s);var Cn={};i(Cn,Wr,en.i),(_n||Cn.x===void 0)&&(Cn.x=nn?fn.value:fn.label),(_n||Cn.y===void 0)&&(Cn.y=nn?fn.label:fn.value),(_n||Cn.xLabel===void 0)&&(Cn.xLabel=nn?fn.valueLabel:fn.labelLabel),(_n||Cn.yLabel===void 0)&&(Cn.yLabel=nn?fn.labelLabel:fn.valueLabel),ti&&(fn.delta=+en.rawS||en.s,fn.deltaLabel=vn(fn.delta),fn.final=en.v,fn.finalLabel=vn(fn.final),fn.initial=fn.final-fn.delta,fn.initialLabel=vn(fn.initial)),jr&&(fn.value=en.s,fn.valueLabel=vn(fn.value),fn.percentInitial=en.begR,fn.percentInitialLabel=w.formatPercent(en.begR),fn.percentPrevious=en.difR,fn.percentPreviousLabel=w.formatPercent(en.difR),fn.percentTotal=en.sumR,fn.percenTotalLabel=w.formatPercent(en.sumR));var oi=w.castOption(Wr,en.i,"customdata");return oi&&(fn.customdata=oi),w.texttemplateString(hn,fn,fr._d3locale,Cn,fn,Wr._meta||{})}(Ht,pr,Mr,hr,Qt):rr.textinfo?function(fr,yr,Sr,Dr){var Nr=fr[0].trace,Wr=Nr.orientation==="h",hn=Nr.type==="waterfall",tn=Nr.type==="funnel";function Fn(oi){return a(Wr?Sr:Dr,+oi,!0).text}var an,xn=Nr.textinfo,_n=fr[yr],ti=xn.split("+"),jr=[],nn=function(oi){return ti.indexOf(oi)!==-1};nn("label")&&jr.push((vn=fr[yr].p,a(Wr?Dr:Sr,vn,!0).text));var vn;if(nn("text")&&((an=w.castOption(Nr,_n.i,"text"))===0||an)&&jr.push(an),hn){var en=+_n.rawS||_n.s,fn=_n.v,Gn=fn-en;nn("initial")&&jr.push(Fn(Gn)),nn("delta")&&jr.push(Fn(en)),nn("final")&&jr.push(Fn(fn))}if(tn){nn("value")&&jr.push(Fn(_n.s));var Tn=0;nn("percent initial")&&Tn++,nn("percent previous")&&Tn++,nn("percent total")&&Tn++;var Cn=Tn>1;nn("percent initial")&&(an=w.formatPercent(_n.begR),Cn&&(an+=" of initial"),jr.push(an)),nn("percent previous")&&(an=w.formatPercent(_n.difR),Cn&&(an+=" of previous"),jr.push(an)),nn("percent total")&&(an=w.formatPercent(_n.sumR),Cn&&(an+=" of total"),jr.push(an))}return jr.join("<br>")}(pr,Mr,hr,Qt):h.getValue(rr.text,Mr),h.coerceString(p,tr)}(Jt,Ye,Qe,Nt,qt);vt=function(Ht,pr){var Mr=h.getValue(Ht.textposition,pr);return h.coerceEnumerated(c,Mr)}(ar,Qe);var qe=nt.mode==="stack"||nt.mode==="relative",pe=Ye[Qe],be=!qe||pe._outmost;if(!Ne||vt==="none"||(pe.isBlank||lt===xt||wt===bt)&&(vt==="auto"||vt==="inside"))return void Re.select("text").remove();var Fe=Jt.font,Ve=s.getBarColor(Ye[Qe],ar),Ke=s.getInsideTextFont(ar,Qe,Fe,Ve),Ge=s.getOutsideTextFont(ar,Qe,Fe),ct=Re.datum();Dt?Nt.type==="log"&&ct.s0<=0&&(lt=Nt.range[0]<Nt.range[1]?0:Nt._length):qt.type==="log"&&ct.s0<=0&&(wt=qt.range[0]<qt.range[1]?qt._length:0);var st,Mt,Ot,it,ht,jt=Math.abs(xt-lt)-2*x,kt=Math.abs(bt-wt)-2*x;if(vt==="outside"&&(be||pe.hasB||(vt="inside")),vt==="auto")if(be){vt="inside",ht=w.ensureUniformFontSize(Be,Ke),st=Wt(Re,Ne,ht),Mt=t.bBox(st.node()),Ot=Mt.width,it=Mt.height;var Pt=Ot<=jt&&it<=kt,Ee=Ot<=kt&&it<=jt,Ze=Dt?jt>=Ot*(kt/it):kt>=it*(jt/Ot);Ot>0&&it>0&&(Pt||Ee||Ze)?vt="inside":(vt="outside",st.remove(),st=null)}else vt="inside";if(!st){ht=w.ensureUniformFontSize(Be,vt==="outside"?Ge:Ke);var at=(st=Wt(Re,Ne,ht)).attr("transform");if(st.attr("transform",""),Mt=t.bBox(st.node()),Ot=Mt.width,it=Mt.height,st.attr("transform",at),Ot<=0||it<=0)return void st.remove()}var pt,St,Ut=ar.textangle;vt==="outside"?(St=ar.constraintext==="both"||ar.constraintext==="outside",pt=function(Ht,pr,Mr,hr,Qt,tr){var rr,fr=!!tr.isHorizontal,yr=!!tr.constrained,Sr=tr.angle||0,Dr=Qt.width,Nr=Qt.height,Wr=Math.abs(pr-Ht),hn=Math.abs(hr-Mr);rr=fr?hn>2*x?x:0:Wr>2*x?x:0;var tn=1;yr&&(tn=fr?Math.min(1,hn/Nr):Math.min(1,Wr/Dr));var Fn=L(Sr),an=A(Qt,Fn),xn=(fr?an.x:an.y)/2,_n=(Qt.left+Qt.right)/2,ti=(Qt.top+Qt.bottom)/2,jr=(Ht+pr)/2,nn=(Mr+hr)/2,vn=0,en=0,fn=fr?b(pr,Ht):b(Mr,hr);return fr?(jr=pr-fn*rr,vn=fn*xn):(nn=hr+fn*rr,en=-fn*xn),{textX:_n,textY:ti,targetX:jr,targetY:nn,anchorX:vn,anchorY:en,scale:tn,rotate:Fn}}(lt,xt,wt,bt,Mt,{isHorizontal:Dt,constrained:St,angle:Ut})):(St=ar.constraintext==="both"||ar.constraintext==="inside",pt=I(lt,xt,wt,bt,Mt,{isHorizontal:Dt,constrained:St,angle:Ut,anchor:ar.insidetextanchor})),pt.fontSize=ht.size,g(ar.type==="histogram"?"bar":ar.type,pt,Jt),pe.transform=pt;var Kt=T(st,Jt,nt,$e);w.setTransormAndDisplay(Kt,pt)})(P,S,fe,$,ce,_e,le,ge,Te,D,j),S.layerClipId&&t.hideOutsideRangePoint(de,fe.select("text"),V,Z,H.xcalendar,H.ycalendar)});var oe=H.cliponaxis===!1;t.setClipUrl(ne,oe?null:S.layerClipId,P)});n.getComponentMethod("errorbars","plot")(P,K,S,D)},toMoveInsideBar:I}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(m,G,W){function d(v,w,y,e,t){var n=w.c2p(e?v.s0:v.p0,!0),a=w.c2p(e?v.s1:v.p1,!0),r=y.c2p(e?v.p0:v.s0,!0),g=y.c2p(e?v.p1:v.s1,!0);return t?[(n+a)/2,(r+g)/2]:e?[a,(r+g)/2]:[(n+a)/2,g]}G.exports=function(v,w){var y,e=v.cd,t=v.xaxis,n=v.yaxis,a=e[0].trace,r=a.type==="funnel",g=a.orientation==="h",u=[];if(w===!1)for(y=0;y<e.length;y++)e[y].selected=0;else for(y=0;y<e.length;y++){var s=e[y],h="ct"in s?s.ct:d(s,t,n,g,r);w.contains(h,!1,y,v)?(u.push({pointNumber:y,x:t.c2d(s.x),y:n.c2d(s.y)}),s.selected=1):s.selected=0}return u}},{}],670:[function(m,G,W){G.exports=w;var d=m("../../lib").distinctVals,v=m("../../constants/numerical").BADNUM;function w(y,e){this.traces=y,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var t=1/0,n=[],a=0;a<y.length;a++){for(var r=y[a],g=0;g<r.length;g++){var u=r[g];u.p!==v&&n.push(u.p)}r[0]&&r[0].width1&&(t=Math.min(r[0].width1,t))}this.positions=n;var s=d(n);this.distinctPositions=s.vals,s.vals.length===1&&t!==1/0?this.minDiff=t:this.minDiff=Math.min(s.minDiff,t);var h=(e.posAxis||{}).type;h!=="category"&&h!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}w.prototype.put=function(y,e){var t=this.getLabel(y,e),n=this.bins[t]||0;return this.bins[t]=n+e,n},w.prototype.get=function(y,e){var t=this.getLabel(y,e);return this.bins[t]||0},w.prototype.getLabel=function(y,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?y:Math.round(y/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing"),y=m("../../lib"),e=m("../../registry"),t=m("./uniform_text").resizeText,n=m("./attributes"),a=n.textfont,r=n.insidetextfont,g=n.outsidetextfont,u=m("./helpers");function s(f,_,b){w.pointStyle(f.selectAll("path"),_,b),h(f,_,b)}function h(f,_,b){f.selectAll("text").each(function(T){var k=d.select(this),L=y.ensureUniformFontSize(b,l(k,T,_,b));w.font(k,L)})}function l(f,_,b,T){var k=T._fullLayout.font,L=b.textfont;if(f.classed("bartext-inside")){var A=x(_,b);L=p(b,_.i,k,A)}else f.classed("bartext-outside")&&(L=c(b,_.i,k));return L}function o(f,_,b){return i(a,f.textfont,_,b)}function p(f,_,b,T){var k=o(f,_,b);return(f._input.textfont===void 0||f._input.textfont.color===void 0||Array.isArray(f.textfont.color)&&f.textfont.color[_]===void 0)&&(k={color:v.contrast(T),family:k.family,size:k.size}),i(r,f.insidetextfont,_,k)}function c(f,_,b){var T=o(f,_,b);return i(g,f.outsidetextfont,_,T)}function i(f,_,b,T){_=_||{};var k=u.getValue(_.family,b),L=u.getValue(_.size,b),A=u.getValue(_.color,b);return{family:u.coerceString(f.family,k,T.family),size:u.coerceNumber(f.size,L,T.size),color:u.coerceColor(f.color,A,T.color)}}function x(f,_){return _.type==="waterfall"?_[f.dir].marker.color:f.mcc||f.mc||_.marker.color}G.exports={style:function(f){var _=d.select(f).selectAll("g.barlayer").selectAll("g.trace");t(f,_,"bar");var b=_.size(),T=f._fullLayout;_.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(T.barmode==="stack"&&b>1||T.bargap===0&&T.bargroupgap===0&&!k[0].trace.marker.line.width)&&d.select(this).attr("shape-rendering","crispEdges")}),_.selectAll("g.points").each(function(k){s(d.select(this),k[0].trace,f)}),e.getComponentMethod("errorbars","style")(_)},styleTextPoints:h,styleOnSelect:function(f,_,b){var T=_[0].trace;T.selectedpoints?function(k,L,A){w.selectedPointStyle(k.selectAll("path"),L),function(I,P,S){I.each(function(E){var z,D=d.select(this);if(E.selected){z=y.ensureUniformFontSize(S,l(D,E,P,S));var j=P.selected.textfont&&P.selected.textfont.color;j&&(z.color=j),w.font(D,z)}else w.selectedTextStyle(D,P)})}(k.selectAll("text"),L,A)}(b,T,f):(s(b,T,f),e.getComponentMethod("errorbars","style")(b))},getInsideTextFont:p,getOutsideTextFont:c,getBarColor:x,resizeText:t}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(m,G,W){var d=m("../../components/color"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../lib").coercePattern;G.exports=function(e,t,n,a,r){var g=n("marker.color",a),u=v(e,"marker");u&&w(e,t,r,n,{prefix:"marker.",cLetter:"c"}),n("marker.line.color",d.defaultLine),v(e,"marker.line")&&w(e,t,r,n,{prefix:"marker.line.",cLetter:"c"}),n("marker.line.width"),n("marker.opacity"),y(n,"marker.pattern",g,u),n("selected.marker.color"),n("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib");function w(y){return"_"+y+"Text_minsize"}G.exports={recordMinTextSize:function(y,e,t){if(t.uniformtext.mode){var n=w(y),a=t.uniformtext.minsize,r=e.scale*e.fontSize;e.hide=r<a,t[n]=t[n]||1/0,e.hide||(t[n]=Math.min(t[n],Math.max(r,a)))}},clearMinTextSize:function(y,e){e[w(y)]=void 0},resizeText:function(y,e,t){var n=y._fullLayout,a=n["_"+t+"Text_minsize"];if(a){var r,g=n.uniformtext.mode==="hide";switch(t){case"funnelarea":case"pie":case"sunburst":r="g.slice";break;case"treemap":case"icicle":r="g.slice, g.pathbar";break;default:r="g.points > g.point"}e.selectAll(r).each(function(u){var s=u.transform;if(s){s.scale=g&&s.hide?0:a/s.fontSize;var h=d.select(this).select("text");v.setTransormAndDisplay(h,s)}})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../lib/extend").extendFlat,w=m("../scatterpolar/attributes"),y=m("../bar/attributes");G.exports={r:w.r,theta:w.theta,r0:w.r0,dr:w.dr,theta0:w.theta0,dtheta:w.dtheta,thetaunit:w.thetaunit,base:v({},y.base,{}),offset:v({},y.offset,{}),width:v({},y.width,{}),text:v({},y.text,{}),hovertext:v({},y.hovertext,{}),marker:y.marker,hoverinfo:w.hoverinfo,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(m,G,W){var d=m("../../components/colorscale/helpers").hasColorscale,v=m("../../components/colorscale/calc"),w=m("../bar/arrays_to_calcdata"),y=m("../bar/cross_trace_calc").setGroupPositions,e=m("../scatter/calc_selection"),t=m("../../registry").traceIs,n=m("../../lib").extendFlat;G.exports={calc:function(a,r){for(var g=a._fullLayout,u=r.subplot,s=g[u].radialaxis,h=g[u].angularaxis,l=s.makeCalcdata(r,"r"),o=h.makeCalcdata(r,"theta"),p=r._length,c=new Array(p),i=l,x=o,f=0;f<p;f++)c[f]={p:x[f],s:i[f]};function _(b){var T=r[b];T!==void 0&&(r["_"+b]=Array.isArray(T)?h.makeCalcdata(r,b):h.d2c(T,r.thetaunit))}return h.type==="linear"&&(_("width"),_("offset")),d(r,"marker")&&v(a,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"}),d(r,"marker.line")&&v(a,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"}),w(c,r),e(c,r),c},crossTraceCalc:function(a,r,g){for(var u=a.calcdata,s=[],h=0;h<u.length;h++){var l=u[h],o=l[0].trace;o.visible===!0&&t(o,"bar")&&o.subplot===g&&s.push(l)}var p=n({},r.radialaxis,{_id:"x"}),c=r.angularaxis;y(a,c,p,s,{mode:r.barmode,norm:r.barnorm,gap:r.bargap,groupgap:r.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(m,G,W){var d=m("../../lib"),v=m("../scatterpolar/defaults").handleRThetaDefaults,w=m("../bar/style_defaults"),y=m("./attributes");G.exports=function(e,t,n,a){function r(g,u){return d.coerce(e,t,y,g,u)}v(e,t,a,r)?(r("thetaunit"),r("base"),r("offset"),r("width"),r("text"),r("hovertext"),r("hovertemplate"),w(e,t,r,n,a),d.coerceSelectionMarkerOpacity(t,r)):t.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(m,G,W){var d=m("../../components/fx"),v=m("../../lib"),w=m("../bar/hover").getTraceColor,y=v.fillText,e=m("../scatterpolar/hover").makeHoverPointText,t=m("../../plots/polar/helpers").isPtInsidePolygon;G.exports=function(n,a,r){var g=n.cd,u=g[0].trace,s=n.subplot,h=s.radialAxis,l=s.angularAxis,o=s.vangles,p=o?t:v.isPtInsideSector,c=n.maxHoverDistance,i=l._period||2*Math.PI,x=Math.abs(h.g2p(Math.sqrt(a*a+r*r))),f=Math.atan2(r,a);if(h.range[0]>h.range[1]&&(f+=Math.PI),d.getClosest(g,function(T){return p(x,f,[T.rp0,T.rp1],[T.thetag0,T.thetag1],o)?c+Math.min(1,Math.abs(T.thetag1-T.thetag0)/i)-1+(T.rp1-x)/(T.rp1-T.rp0)-1:1/0},n),n.index!==!1){var _=g[n.index];n.x0=n.x1=_.ct[0],n.y0=n.y1=_.ct[1];var b=v.extendFlat({},_,{r:_.s,theta:_.p});return y(_,u,n),e(b,u,s,n),n.hovertemplate=u.hovertemplate,n.color=w(u,_),n.xLabelVal=n.yLabelVal=void 0,_.s<0&&(n.idealAlign="left"),[n]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(m,G,W){G.exports={moduleType:"trace",name:"barpolar",basePlotModule:m("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("../scatterpolar/format_labels"),style:m("../bar/style").style,styleOnSelect:m("../bar/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(m,G,W){G.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t,n={};function a(u,s){return d.coerce(w[t]||{},y[t],v,u,s)}for(var r=0;r<e.length;r++){var g=e[r];g.type==="barpolar"&&g.visible===!0&&(n[t=g.subplot]||(a("barmode"),a("bargap"),n[t]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(m,G,W){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../components/drawing"),e=m("../../plots/polar/helpers");G.exports=function(t,n,a){var r=n.xaxis,g=n.yaxis,u=n.radialAxis,s=n.angularAxis,h=function(o){var p=o.cxx,c=o.cyy;return o.vangles?function(i,x,f,_){var b,T;w.angleDelta(f,_)>0?(b=f,T=_):(b=_,T=f);var k=[e.findEnclosingVertexAngles(b,o.vangles)[0],(b+T)/2,e.findEnclosingVertexAngles(T,o.vangles)[1]];return e.pathPolygonAnnulus(i,x,b,T,k,p,c)}:function(i,x,f,_){return w.pathAnnulus(i,x,f,_,p,c)}}(n),l=n.layers.frontplot.select("g.barlayer");w.makeTraceGroups(l,a,"trace bars").each(function(){var o=d.select(this),p=w.ensureSingle(o,"g","points").selectAll("g.point").data(w.identity);p.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),p.exit().remove(),p.each(function(c){var i,x=d.select(this),f=c.rp0=u.c2p(c.s0),_=c.rp1=u.c2p(c.s1),b=c.thetag0=s.c2g(c.p0),T=c.thetag1=s.c2g(c.p1);if(v(f)&&v(_)&&v(b)&&v(T)&&f!==_&&b!==T){var k=u.c2g(c.s1),L=(b+T)/2;c.ct=[r.c2p(k*Math.cos(L)),g.c2p(k*Math.sin(L))],i=h(f,_,b,T)}else i="M0,0Z";w.ensureSingle(x,"path").attr("d",i)}),y.setClipUrl(o,n._hasClipOnAxisFalse?n.clipIds.forTraces:null,t)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../bar/attributes"),w=m("../../components/color/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../lib/extend").extendFlat,n=d.marker,a=n.line;G.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:t({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:t({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:t({},n.angle,{arrayOk:!1,editType:"calc"}),size:t({},n.size,{arrayOk:!1,editType:"calc"}),color:t({},n.color,{arrayOk:!1,editType:"style"}),line:{color:t({},a.color,{arrayOk:!1,dflt:w.defaultLine,editType:"style"}),width:t({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup,selected:{marker:d.selected.marker,editType:"style"},unselected:{marker:d.unselected.marker,editType:"style"},text:t({},d.text,{}),hovertext:t({},d.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../plots/cartesian/axes"),w=m("../../plots/cartesian/align_period"),y=m("../../lib"),e=m("../../constants/numerical").BADNUM,t=y._;G.exports=function(p,c){var i,x,f,_,b,T,k,L=p._fullLayout,A=v.getFromId(p,c.xaxis||"x"),I=v.getFromId(p,c.yaxis||"y"),P=[],S=c.type==="violin"?"_numViolins":"_numBoxes";c.orientation==="h"?(f=A,_="x",b=I,T="y",k=!!c.yperiodalignment):(f=I,_="y",b=A,T="x",k=!!c.xperiodalignment);var E,z,D,j,V,Z,Q=function(Re,Ye,Qe,lt){var xt,wt=Ye+"0"in Re,bt="d"+Ye in Re;if(Ye in Re||wt&&bt){var nt=Qe.makeCalcdata(Re,Ye);return[w(Re,Qe,Ye,nt).vals,nt]}xt=wt?Re[Ye+"0"]:"name"in Re&&(Qe.type==="category"||d(Re.name)&&["linear","log"].indexOf(Qe.type)!==-1||y.isDateTime(Re.name)&&Qe.type==="date")?Re.name:lt;for(var $e=Qe.type==="multicategory"?Qe.r2c_just_indices(xt):Qe.d2c(xt,0,Re[Ye+"calendar"]),vt=Re._length,Nt=new Array(vt),qt=0;qt<vt;qt++)Nt[qt]=$e;return[Nt]}(c,T,b,L[S]),K=Q[0],$=Q[1],ne=y.distinctVals(K,b),H=ne.vals,N=ne.minDiff/2,U=(c.boxpoints||c.points)==="all"?y.identity:function(Re){return Re.v<E.lf||Re.v>E.uf};if(c._hasPreCompStats){var te=c[_],B=function(Re){return f.d2c((c[Re]||[])[i])},X=1/0,J=-1/0;for(i=0;i<c._length;i++){var ee=K[i];if(d(ee)){if((E={}).pos=E[T]=ee,k&&$&&(E.orig_p=$[i]),E.q1=B("q1"),E.med=B("median"),E.q3=B("q3"),z=[],te&&y.isArrayOrTypedArray(te[i]))for(x=0;x<te[i].length;x++)(Z=f.d2c(te[i][x]))!==e&&(a(V={v:Z,i:[i,x]},c,[i,x]),z.push(V));if(E.pts=z.sort(r),j=(D=E[_]=z.map(g)).length,E.med!==e&&E.q1!==e&&E.q3!==e&&E.med>=E.q1&&E.q3>=E.med){var re=B("lowerfence");E.lf=re!==e&&re<=E.q1?re:u(E,D,j);var se=B("upperfence");E.uf=se!==e&&se>=E.q3?se:s(E,D,j);var oe=B("mean");E.mean=oe!==e?oe:j?y.mean(D,j):(E.q1+E.q3)/2;var de=B("sd");E.sd=oe!==e&&de>=0?de:j?y.stdev(D,j,E.mean):E.q3-E.q1,E.lo=h(E),E.uo=l(E);var ce=B("notchspan");ce=ce!==e&&ce>0?ce:o(E,j),E.ln=E.med-ce,E.un=E.med+ce;var ve=E.lf,Ae=E.uf;c.boxpoints&&D.length&&(ve=Math.min(ve,D[0]),Ae=Math.max(Ae,D[j-1])),c.notched&&(ve=Math.min(ve,E.ln),Ae=Math.max(Ae,E.un)),E.min=ve,E.max=Ae}else{var fe;y.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+E.q1,"median = "+E.med,"q3 = "+E.q3].join(`
`)),fe=E.med!==e?E.med:E.q1!==e?E.q3!==e?(E.q1+E.q3)/2:E.q1:E.q3!==e?E.q3:0,E.med=fe,E.q1=E.q3=fe,E.lf=E.uf=fe,E.mean=E.sd=fe,E.ln=E.un=fe,E.min=E.max=fe}X=Math.min(X,E.min),J=Math.max(J,E.max),E.pts2=z.filter(U),P.push(E)}}c._extremes[f._id]=v.findExtremes(f,[X,J],{padded:!0})}else{var me=f.makeCalcdata(c,_),_e=function(Re,Ye){for(var Qe=Re.length,lt=new Array(Qe+1),xt=0;xt<Qe;xt++)lt[xt]=Re[xt]-Ye;return lt[Qe]=Re[Qe-1]+Ye,lt}(H,N),le=H.length,ge=function(Re){for(var Ye=new Array(Re),Qe=0;Qe<Re;Qe++)Ye[Qe]=[];return Ye}(le);for(i=0;i<c._length;i++)if(Z=me[i],d(Z)){var Te=y.findBin(K[i],_e);Te>=0&&Te<le&&(a(V={v:Z,i},c,i),ge[Te].push(V))}var Se=1/0,Me=-1/0,ze=c.quartilemethod,Oe=ze==="exclusive",De=ze==="inclusive";for(i=0;i<le;i++)if(ge[i].length>0){var Xe,Be;(E={}).pos=E[T]=H[i],z=E.pts=ge[i].sort(r),j=(D=E[_]=z.map(g)).length,E.min=D[0],E.max=D[j-1],E.mean=y.mean(D,j),E.sd=y.stdev(D,j,E.mean),E.med=y.interp(D,.5),j%2&&(Oe||De)?(Oe?(Xe=D.slice(0,j/2),Be=D.slice(j/2+1)):De&&(Xe=D.slice(0,j/2+1),Be=D.slice(j/2)),E.q1=y.interp(Xe,.5),E.q3=y.interp(Be,.5)):(E.q1=y.interp(D,.25),E.q3=y.interp(D,.75)),E.lf=u(E,D,j),E.uf=s(E,D,j),E.lo=h(E),E.uo=l(E);var Ie=o(E,j);E.ln=E.med-Ie,E.un=E.med+Ie,Se=Math.min(Se,E.ln),Me=Math.max(Me,E.un),E.pts2=z.filter(U),P.push(E)}c._extremes[f._id]=v.findExtremes(f,c.notched?me.concat([Se,Me]):me,{padded:!0})}return function(Re,Ye){if(y.isArrayOrTypedArray(Ye.selectedpoints))for(var Qe=0;Qe<Re.length;Qe++){for(var lt=Re[Qe].pts||[],xt={},wt=0;wt<lt.length;wt++)xt[lt[wt].i]=wt;y.tagSelected(lt,Ye,xt)}}(P,c),P.length>0?(P[0].t={num:L[S],dPos:N,posLetter:T,valLetter:_,labels:{med:t(p,"median:"),min:t(p,"min:"),q1:t(p,"q1:"),q3:t(p,"q3:"),max:t(p,"max:"),mean:c.boxmean==="sd"?t(p,"mean \xB1 \u03C3:"):t(p,"mean:"),lf:t(p,"lower fence:"),uf:t(p,"upper fence:")}},L[S]++,P):[{t:{empty:!0}}]};var n={text:"tx",hovertext:"htx"};function a(p,c,i){for(var x in n)y.isArrayOrTypedArray(c[x])&&(Array.isArray(i)?y.isArrayOrTypedArray(c[x][i[0]])&&(p[n[x]]=c[x][i[0]][i[1]]):p[n[x]]=c[x][i])}function r(p,c){return p.v-c.v}function g(p){return p.v}function u(p,c,i){return i===0?p.q1:Math.min(p.q1,c[Math.min(y.findBin(2.5*p.q1-1.5*p.q3,c,!0)+1,i-1)])}function s(p,c,i){return i===0?p.q3:Math.max(p.q3,c[Math.max(y.findBin(2.5*p.q3-1.5*p.q1,c),0)])}function h(p){return 4*p.q1-3*p.q3}function l(p){return 4*p.q3-3*p.q1}function o(p,c){return c===0?0:1.57*(p.q3-p.q1)/Math.sqrt(c)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../plots/cartesian/constraints").getAxisGroup,y=["v","h"];function e(t,n,a,r){var g,u,s,h=n.calcdata,l=n._fullLayout,o=r._id,p=o.charAt(0),c=[],i=0;for(g=0;g<a.length;g++)for(s=h[a[g]],u=0;u<s.length;u++)c.push(r.c2l(s[u].pos,!0)),i+=(s[u].pts2||[]).length;if(c.length){var x=v.distinctVals(c);r.type!=="category"&&r.type!=="multicategory"||(x.minDiff=1);var f=x.minDiff/2;d.minDtick(r,x.minDiff,x.vals[0],!0);var _=l[t==="violin"?"_numViolins":"_numBoxes"],b=l[t+"mode"]==="group"&&_>1,T=1-l[t+"gap"],k=1-l[t+"groupgap"];for(g=0;g<a.length;g++){var L,A,I,P,S,E,z=(s=h[a[g]])[0].trace,D=s[0].t,j=z.width,V=z.side;if(j)L=A=P=j/2,I=0;else if(L=f,b){var Z=w(l,r._id)+z.orientation,Q=(l._alignmentOpts[Z]||{})[z.alignmentgroup]||{},K=Object.keys(Q.offsetGroups||{}).length,$=K||_;A=L*T*k/$,I=2*L*(((K?z._offsetIndex:D.num)+.5)/$-.5)*T,P=L*T/$}else A=L*T*k,I=0,P=L;D.dPos=L,D.bPos=I,D.bdPos=A,D.wHover=P;var ne,H,N,U,te,B,X=I+A,J=Boolean(j);if(V==="positive"?(S=L*(j?1:.5),ne=X,E=ne=I):V==="negative"?(S=ne=I,E=L*(j?1:.5),H=X):(S=E=L,ne=H=X),(z.boxpoints||z.points)&&i>0){var ee=z.pointpos,re=z.jitter,se=z.marker.size/2,oe=0;ee+re>=0&&((oe=X*(ee+re))>S?(J=!0,te=se,N=oe):oe>ne&&(te=se,N=S)),oe<=S&&(N=S);var de=0;ee-re<=0&&((de=-X*(ee-re))>E?(J=!0,B=se,U=de):de>H&&(B=se,U=E)),de<=E&&(U=E)}else N=S,U=E;var ce=new Array(s.length);for(u=0;u<s.length;u++)ce[u]=s[u].pos;z._extremes[o]=d.findExtremes(r,ce,{padded:J,vpadminus:U,vpadplus:N,vpadLinearized:!0,ppadminus:{x:B,y:te}[p],ppadplus:{x:te,y:B}[p]})}}}G.exports={crossTraceCalc:function(t,n){for(var a=t.calcdata,r=n.xaxis,g=n.yaxis,u=0;u<y.length;u++){for(var s=y[u],h=s==="h"?g:r,l=[],o=0;o<a.length;o++){var p=a[o],c=p[0].t,i=p[0].trace;i.visible!==!0||i.type!=="box"&&i.type!=="candlestick"||c.empty||(i.orientation||"v")!==s||i.xaxis!==r._id||i.yaxis!==g._id||l.push(o)}e("box",t,l,h)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=m("../../components/color"),y=m("../scatter/period_defaults"),e=m("../bar/defaults").handleGroupingDefaults,t=m("../../plots/cartesian/axis_autotype"),n=m("./attributes");function a(g,u,s,h){function l(V){var Z=0;return V&&V.length&&(Z+=1,d.isArrayOrTypedArray(V[0])&&V[0].length&&(Z+=1)),Z}function o(V){return d.validate(g[V],n[V])}var p,c=s("y"),i=s("x");if(u.type==="box"){var x=s("q1"),f=s("median"),_=s("q3");u._hasPreCompStats=x&&x.length&&f&&f.length&&_&&_.length,p=Math.min(d.minRowLength(x),d.minRowLength(f),d.minRowLength(_))}var b,T,k=l(c),L=l(i),A=k&&d.minRowLength(c),I=L&&d.minRowLength(i),P=h.calendar,S={autotypenumbers:h.autotypenumbers};if(u._hasPreCompStats)switch(String(L)+String(k)){case"00":var E=o("x0")||o("dx");b=(o("y0")||o("dy"))&&!E?"h":"v",T=p;break;case"10":b="v",T=Math.min(p,I);break;case"20":b="h",T=Math.min(p,i.length);break;case"01":b="h",T=Math.min(p,A);break;case"02":b="v",T=Math.min(p,c.length);break;case"12":b="v",T=Math.min(p,I,c.length);break;case"21":b="h",T=Math.min(p,i.length,A);break;case"11":T=0;break;case"22":var z,D=!1;for(z=0;z<i.length;z++)if(t(i[z],P,S)==="category"){D=!0;break}if(D)b="v",T=Math.min(p,I,c.length);else{for(z=0;z<c.length;z++)if(t(c[z],P,S)==="category"){D=!0;break}D?(b="h",T=Math.min(p,i.length,A)):(b="v",T=Math.min(p,I,c.length))}}else k>0?(b="v",T=L>0?Math.min(I,A):Math.min(A)):L>0?(b="h",T=Math.min(I)):T=0;if(T){u._length=T;var j=s("orientation",b);u._hasPreCompStats?j==="v"&&L===0?(s("x0",0),s("dx",1)):j==="h"&&k===0&&(s("y0",0),s("dy",1)):j==="v"&&L===0?s("x0"):j==="h"&&k===0&&s("y0"),v.getComponentMethod("calendars","handleTraceDefaults")(g,u,["x","y"],h)}else u.visible=!1}function r(g,u,s,h){var l=h.prefix,o=d.coerce2(g,u,n,"marker.outliercolor"),p=s("marker.line.outliercolor"),c="outliers";u._hasPreCompStats?c="all":(o||p)&&(c="suspectedoutliers");var i=s(l+"points",c);i?(s("jitter",i==="all"?.3:0),s("pointpos",i==="all"?-1.5:0),s("marker.symbol"),s("marker.opacity"),s("marker.size"),s("marker.angle"),s("marker.color",u.line.color),s("marker.line.color"),s("marker.line.width"),i==="suspectedoutliers"&&(s("marker.line.outliercolor",u.marker.color),s("marker.line.outlierwidth")),s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size"),s("text"),s("hovertext")):delete u.marker;var x=s("hoveron");x!=="all"&&x.indexOf("points")===-1||s("hovertemplate"),d.coerceSelectionMarkerOpacity(u,s)}G.exports={supplyDefaults:function(g,u,s,h){function l(_,b){return d.coerce(g,u,n,_,b)}if(a(g,u,l,h),u.visible!==!1){y(g,u,h,l),l("xhoverformat"),l("yhoverformat");var o=u._hasPreCompStats;o&&(l("lowerfence"),l("upperfence")),l("line.color",(g.marker||{}).color||s),l("line.width"),l("fillcolor",w.addOpacity(u.line.color,.5));var p=!1;if(o){var c=l("mean"),i=l("sd");c&&c.length&&(p=!0,i&&i.length&&(p="sd"))}l("boxmean",p),l("whiskerwidth"),l("width"),l("quartilemethod");var x=!1;if(o){var f=l("notchspan");f&&f.length&&(x=!0)}else d.validate(g.notchwidth,n.notchwidth)&&(x=!0);l("notched",x)&&l("notchwidth"),r(g,u,l,{prefix:"box"})}},crossTraceDefaults:function(g,u){var s,h;function l(c){return d.coerce(h._input,h,n,c)}for(var o=0;o<g.length;o++){var p=(h=g[o]).type;p!=="box"&&p!=="violin"||(s=h._input,u[p+"mode"]==="group"&&e(s,h,u,l))}},handleSampleDefaults:a,handlePointsDefaults:r}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(m,G,W){G.exports=function(d,v){return v.hoverOnBox&&(d.hoverOnBox=v.hoverOnBox),"xVal"in v&&(d.x=v.xVal),"yVal"in v&&(d.y=v.yVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],687:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../components/fx"),y=m("../../components/color"),e=v.fillText;function t(a,r,g,u){var s,h,l,o,p,c,i,x,f,_,b,T,k,L,A=a.cd,I=a.xa,P=a.ya,S=A[0].trace,E=A[0].t,z=S.type==="violin",D=E.bdPos,j=E.wHover,V=function(fe){return l.c2l(fe.pos)+E.bPos-l.c2l(c)};z&&S.side!=="both"?(S.side==="positive"&&(f=function(fe){var me=V(fe);return w.inbox(me,me+j,_)},T=D,k=0),S.side==="negative"&&(f=function(fe){var me=V(fe);return w.inbox(me-j,me,_)},T=0,k=D)):(f=function(fe){var me=V(fe);return w.inbox(me-j,me+j,_)},T=k=D),L=z?function(fe){return w.inbox(fe.span[0]-p,fe.span[1]-p,_)}:function(fe){return w.inbox(fe.min-p,fe.max-p,_)},S.orientation==="h"?(p=r,c=g,i=L,x=f,s="y",l=P,h="x",o=I):(p=g,c=r,i=f,x=L,s="x",l=I,h="y",o=P);var Z=Math.min(1,D/Math.abs(l.r2c(l.range[1])-l.r2c(l.range[0])));function Q(fe){return(i(fe)+x(fe))/2}_=a.maxHoverDistance-Z,b=a.maxSpikeDistance-Z;var K=w.getDistanceFunction(u,i,x,Q);if(w.getClosest(A,K,a),a.index===!1)return[];var $=A[a.index],ne=S.line.color,H=(S.marker||{}).color;y.opacity(ne)&&S.line.width?a.color=ne:y.opacity(H)&&S.boxpoints?a.color=H:a.color=S.fillcolor,a[s+"0"]=l.c2p($.pos+E.bPos-k,!0),a[s+"1"]=l.c2p($.pos+E.bPos+T,!0),a[s+"LabelVal"]=$.orig_p!==void 0?$.orig_p:$.pos;var N=s+"Spike";a.spikeDistance=Q($)*b/_,a[N]=l.c2p($.pos,!0);var U=S.boxmean||(S.meanline||{}).visible,te=S.boxpoints||S.points,B=te&&U?["max","uf","q3","med","mean","q1","lf","min"]:te&&!U?["max","uf","q3","med","q1","lf","min"]:!te&&U?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],X=o.range[1]<o.range[0];S.orientation===(X?"v":"h")&&B.reverse();for(var J=a.spikeDistance,ee=a[N],re=[],se=0;se<B.length;se++){var oe=B[se];if(oe in $){var de=$[oe],ce=o.c2p(de,!0),ve=v.extendFlat({},a);ve.attr=oe,ve[h+"0"]=ve[h+"1"]=ce,ve[h+"LabelVal"]=de,ve[h+"Label"]=(E.labels?E.labels[oe]+" ":"")+d.hoverLabelText(o,de,S[h+"hoverformat"]),ve.hoverOnBox=!0,oe==="mean"&&"sd"in $&&S.boxmean==="sd"&&(ve[h+"err"]=$.sd),ve.hovertemplate=!1,re.push(ve)}}a.name="",a.spikeDistance=void 0,a[N]=void 0;for(var Ae=0;Ae<re.length;Ae++)re[Ae].attr!=="med"?(re[Ae].name="",re[Ae].spikeDistance=void 0,re[Ae][N]=void 0):(re[Ae].spikeDistance=J,re[Ae][N]=ee);return re}function n(a,r,g){for(var u,s,h,l=a.cd,o=a.xa,p=a.ya,c=l[0].trace,i=o.c2p(r),x=p.c2p(g),f=w.quadrature(function(z){var D=Math.max(3,z.mrc||0);return Math.max(Math.abs(o.c2p(z.x)-i)-D,1-3/D)},function(z){var D=Math.max(3,z.mrc||0);return Math.max(Math.abs(p.c2p(z.y)-x)-D,1-3/D)}),_=!1,b=0;b<l.length;b++){s=l[b];for(var T=0;T<(s.pts||[]).length;T++){var k=f(h=s.pts[T]);k<=a.distance&&(a.distance=k,_=[b,T])}}if(!_)return!1;h=(s=l[_[0]]).pts[_[1]];var L=o.c2p(h.x,!0),A=p.c2p(h.y,!0),I=h.mrc||1;u=v.extendFlat({},a,{index:h.i,color:(c.marker||{}).color,name:c.name,x0:L-I,x1:L+I,y0:A-I,y1:A+I,spikeDistance:a.distance,hovertemplate:c.hovertemplate});var P,S=s.orig_p,E=S!==void 0?S:s.pos;return c.orientation==="h"?(P=p,u.xLabelVal=h.x,u.yLabelVal=E):(P=o,u.xLabelVal=E,u.yLabelVal=h.y),u[P._id.charAt(0)+"Spike"]=P.c2p(s.pos,!0),e(h,c,u),u}G.exports={hoverPoints:function(a,r,g,u){var s,h=a.cd[0].trace.hoveron,l=[];return h.indexOf("boxes")!==-1&&(l=l.concat(t(a,r,g,u))),h.indexOf("points")!==-1&&(s=n(a,r,g)),u==="closest"?s?[s]:l:(s&&l.push(s),l)},hoverOnBoxes:t,hoverOnPoints:n}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults").supplyLayoutDefaults,calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"box",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(m,G,W){G.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("./layout_attributes");function y(e,t,n,a,r){for(var g=r+"Layout",u=!1,s=0;s<n.length;s++){var h=n[s];if(d.traceIs(h,g)){u=!0;break}}u&&(a(r+"mode"),a(r+"gap"),a(r+"groupgap"))}G.exports={supplyLayoutDefaults:function(e,t,n){y(0,0,n,function(a,r){return v.coerce(e,t,w,a,r)},"box")},_supply:y}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing");function y(n,a,r,g){var u,s,h=r.orientation==="h",l=a.val,o=a.pos,p=!!o.rangebreaks,c=g.bPos,i=g.wdPos||0,x=g.bPosPxOffset||0,f=r.whiskerwidth||0,_=r.notched||!1,b=_?1-2*r.notchwidth:1;Array.isArray(g.bdPos)?(u=g.bdPos[0],s=g.bdPos[1]):(u=g.bdPos,s=g.bdPos);var T=n.selectAll("path.box").data(r.type!=="violin"||r.box.visible?v.identity:[]);T.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),T.exit().remove(),T.each(function(k){if(k.empty)return"M0,0Z";var L=o.c2l(k.pos+c,!0),A=o.l2p(L-u)+x,I=o.l2p(L+s)+x,P=p?(A+I)/2:o.l2p(L)+x,S=r.whiskerwidth,E=p?A*S+(1-S)*P:o.l2p(L-i)+x,z=p?I*S+(1-S)*P:o.l2p(L+i)+x,D=o.l2p(L-u*b)+x,j=o.l2p(L+s*b)+x,V=l.c2p(k.q1,!0),Z=l.c2p(k.q3,!0),Q=v.constrain(l.c2p(k.med,!0),Math.min(V,Z)+1,Math.max(V,Z)-1),K=k.lf===void 0||r.boxpoints===!1,$=l.c2p(K?k.min:k.lf,!0),ne=l.c2p(K?k.max:k.uf,!0),H=l.c2p(k.ln,!0),N=l.c2p(k.un,!0);h?d.select(this).attr("d","M"+Q+","+D+"V"+j+"M"+V+","+A+"V"+I+(_?"H"+H+"L"+Q+","+j+"L"+N+","+I:"")+"H"+Z+"V"+A+(_?"H"+N+"L"+Q+","+D+"L"+H+","+A:"")+"ZM"+V+","+P+"H"+$+"M"+Z+","+P+"H"+ne+(f===0?"":"M"+$+","+E+"V"+z+"M"+ne+","+E+"V"+z)):d.select(this).attr("d","M"+D+","+Q+"H"+j+"M"+A+","+V+"H"+I+(_?"V"+H+"L"+j+","+Q+"L"+I+","+N:"")+"V"+Z+"H"+A+(_?"V"+N+"L"+D+","+Q+"L"+A+","+H:"")+"ZM"+P+","+V+"V"+$+"M"+P+","+Z+"V"+ne+(f===0?"":"M"+E+","+$+"H"+z+"M"+E+","+ne+"H"+z))})}function e(n,a,r,g){var u=a.x,s=a.y,h=g.bdPos,l=g.bPos,o=r.boxpoints||r.points;v.seedPseudoRandom();var p=n.selectAll("g.points").data(o?function(i){return i.forEach(function(x){x.t=g,x.trace=r}),i}:[]);p.enter().append("g").attr("class","points"),p.exit().remove();var c=p.selectAll("path").data(function(i){var x,f,_=i.pts2,b=Math.max((i.max-i.min)/10,i.q3-i.q1),T=1e-9*b,k=.01*b,L=[],A=0;if(r.jitter){if(b===0)for(A=1,L=new Array(_.length),x=0;x<_.length;x++)L[x]=1;else for(x=0;x<_.length;x++){var I=Math.max(0,x-5),P=_[I].v,S=Math.min(_.length-1,x+5),E=_[S].v;o!=="all"&&(_[x].v<i.lf?E=Math.min(E,i.lf):P=Math.max(P,i.uf));var z=Math.sqrt(k*(S-I)/(E-P+T))||0;z=v.constrain(Math.abs(z),0,1),L.push(z),A=Math.max(z,A)}f=2*r.jitter/(A||1)}for(x=0;x<_.length;x++){var D=_[x],j=D.v,V=r.jitter?f*L[x]*(v.pseudoRandom()-.5):0,Z=i.pos+l+h*(r.pointpos+V);r.orientation==="h"?(D.y=Z,D.x=j):(D.x=Z,D.y=j),o==="suspectedoutliers"&&j<i.uo&&j>i.lo&&(D.so=!0)}return _});c.enter().append("path").classed("point",!0),c.exit().remove(),c.call(w.translatePoints,u,s)}function t(n,a,r,g){var u,s,h=a.val,l=a.pos,o=!!l.rangebreaks,p=g.bPos,c=g.bPosPxOffset||0,i=r.boxmean||(r.meanline||{}).visible;Array.isArray(g.bdPos)?(u=g.bdPos[0],s=g.bdPos[1]):(u=g.bdPos,s=g.bdPos);var x=n.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?v.identity:[]);x.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),x.exit().remove(),x.each(function(f){var _=l.c2l(f.pos+p,!0),b=l.l2p(_-u)+c,T=l.l2p(_+s)+c,k=o?(b+T)/2:l.l2p(_)+c,L=h.c2p(f.mean,!0),A=h.c2p(f.mean-f.sd,!0),I=h.c2p(f.mean+f.sd,!0);r.orientation==="h"?d.select(this).attr("d","M"+L+","+b+"V"+T+(i==="sd"?"m0,0L"+A+","+k+"L"+L+","+b+"L"+I+","+k+"Z":"")):d.select(this).attr("d","M"+b+","+L+"H"+T+(i==="sd"?"m0,0L"+k+","+A+"L"+b+","+L+"L"+k+","+I+"Z":""))})}G.exports={plot:function(n,a,r,g){var u=a.xaxis,s=a.yaxis;v.makeTraceGroups(g,r,"trace boxes").each(function(h){var l,o,p=d.select(this),c=h[0],i=c.t,x=c.trace;i.wdPos=i.bdPos*x.whiskerwidth,x.visible!==!0||i.empty?p.remove():(x.orientation==="h"?(l=s,o=u):(l=u,o=s),y(p,{pos:l,val:o},x,i),e(p,{x:u,y:s},x,i),t(p,{pos:l,val:o},x,i))})},plotBoxAndWhiskers:y,plotPoints:e,plotBoxMean:t}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(m,G,W){G.exports=function(d,v){var w,y,e=d.cd,t=d.xaxis,n=d.yaxis,a=[];if(v===!1)for(w=0;w<e.length;w++)for(y=0;y<(e[w].pts||[]).length;y++)e[w].pts[y].selected=0;else for(w=0;w<e.length;w++)for(y=0;y<(e[w].pts||[]).length;y++){var r=e[w].pts[y],g=t.c2p(r.x),u=n.c2p(r.y);v.contains([g,u],null,r.i,d)?(a.push({pointNumber:r.i,x:t.c2d(r.x),y:n.c2d(r.y)}),r.selected=1):r.selected=0}return a}},{}],693:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing");G.exports={style:function(y,e,t){var n=t||d.select(y).selectAll("g.trace.boxes");n.style("opacity",function(a){return a[0].trace.opacity}),n.each(function(a){var r=d.select(this),g=a[0].trace,u=g.line.width;function s(o,p,c,i){o.style("stroke-width",p+"px").call(v.stroke,c).call(v.fill,i)}var h=r.selectAll("path.box");if(g.type==="candlestick")h.each(function(o){if(!o.empty){var p=d.select(this),c=g[o.dir];s(p,c.line.width,c.line.color,c.fillcolor),p.style("opacity",g.selectedpoints&&!o.selected?.3:1)}});else{s(h,u,g.line.color,g.fillcolor),r.selectAll("path.mean").style({"stroke-width":u,"stroke-dasharray":2*u+"px,"+u+"px"}).call(v.stroke,g.line.color);var l=r.selectAll("path.point");w.pointStyle(l,g,y)}})},styleOnSelect:function(y,e,t){var n=e[0].trace,a=t.selectAll("path.point");n.selectedpoints?w.selectedPointStyle(a,n):w.pointStyle(a,n,y)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(m,G,W){var d=m("../../lib").extendFlat,v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../ohlc/attributes"),y=m("../box/attributes");function e(t){return{line:{color:d({},y.line.color,{dflt:t}),width:y.line.width,editType:"style"},fillcolor:y.fillcolor,editType:"style"}}G.exports={xperiod:w.xperiod,xperiod0:w.xperiod0,xperiodalignment:w.xperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),x:w.x,open:w.open,high:w.high,low:w.low,close:w.close,line:{width:d({},y.line.width,{}),editType:"style"},increasing:e(w.increasing.line.color.dflt),decreasing:e(w.decreasing.line.color.dflt),text:w.text,hovertext:w.hovertext,whiskerwidth:d({},y.whiskerwidth,{dflt:0}),hoverlabel:w.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/cartesian/align_period"),y=m("../ohlc/calc").calcCommon;function e(t,n,a,r){return{min:a,q1:Math.min(t,r),med:r,q3:Math.max(t,r),max:n}}G.exports=function(t,n){var a=t._fullLayout,r=v.getFromId(t,n.xaxis),g=v.getFromId(t,n.yaxis),u=r.makeCalcdata(n,"x"),s=w(n,r,"x",u).vals,h=y(t,n,u,s,g,e);return h.length?(d.extendFlat(h[0].t,{num:a._numBoxes,dPos:d.distinctVals(s).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,h):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../ohlc/ohlc_defaults"),y=m("../scatter/period_defaults"),e=m("./attributes");function t(n,a,r,g){var u=r(g+".line.color");r(g+".line.width",a.line.width),r(g+".fillcolor",v.addOpacity(u,.5))}G.exports=function(n,a,r,g){function u(s,h){return d.coerce(n,a,e,s,h)}w(n,a,u,g)?(y(n,a,g,u,{x:!0}),u("xhoverformat"),u("yhoverformat"),u("line.width"),t(n,a,u,"increasing"),t(n,a,u,"decreasing"),u("text"),u("hovertext"),u("whiskerwidth"),g._requestRangeslider[a.xaxis]=!0):a.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(m,G,W){G.exports={moduleType:"trace",name:"candlestick",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:m("./attributes"),layoutAttributes:m("../box/layout_attributes"),supplyLayoutDefaults:m("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:m("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("../box/plot").plot,layerName:"boxlayer",style:m("../box/style").style,hoverPoints:m("../ohlc/hover").hoverPoints,selectPoints:m("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(m,G,W){var d=m("./axis_defaults"),v=m("../../plot_api/plot_template");G.exports=function(w,y,e,t,n){t("a")||(t("da"),t("a0")),t("b")||(t("db"),t("b0")),function(a,r,g,u){["aaxis","baxis"].forEach(function(s){var h=s.charAt(0),l=a[s]||{},o=v.newContainer(r,s),p={noTicklabelstep:!0,tickfont:"x",id:h+"axis",letter:h,font:r.font,name:s,data:a[h],calendar:r.calendar,dfltColor:u,bgColor:g.paper_bgcolor,autotypenumbersDflt:g.autotypenumbers,fullLayout:g};d(l,o,p),o._categories=o._categories||[],a[s]||l.type==="-"||(a[s]={type:l.type})})}(w,y,e,n)}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v){return function w(y,e){if(!d(y)||e>=10)return null;for(var t=1/0,n=-1/0,a=y.length,r=0;r<a;r++){var g=y[r];if(d(g)){var u=w(g,e+1);u&&(t=Math.min(u[0],t),n=Math.max(u[1],n))}else t=Math.min(g,t),n=Math.max(g,n)}return[t,n]}(v,0)}},{"../../lib":515}],700:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("./axis_attributes"),w=m("../../components/color/attributes"),y=d({editType:"calc"});y.family.dflt='"Open Sans", verdana, arial, sans-serif',y.size.dflt=12,y.color.dflt=w.defaultLine,G.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:v,baxis:v,font:y,color:{valType:"color",dflt:w.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y,e){var t,n,a,r,g,u,s,h,l,o,p,c,i,x=d(y)?"a":"b",f=(x==="a"?v.aaxis:v.baxis).smoothing,_=x==="a"?v.a2i:v.b2j,b=x==="a"?y:e,T=x==="a"?e:y,k=x==="a"?w.a.length:w.b.length,L=x==="a"?w.b.length:w.a.length,A=Math.floor(x==="a"?v.b2j(T):v.a2i(T)),I=x==="a"?function(ne){return v.evalxy([],ne,A)}:function(ne){return v.evalxy([],A,ne)};f&&(a=Math.max(0,Math.min(L-2,A)),r=A-a,n=x==="a"?function(ne,H){return v.dxydi([],ne,a,H,r)}:function(ne,H){return v.dxydj([],a,ne,r,H)});var P=_(b[0]),S=_(b[1]),E=P<S?1:-1,z=1e-8*(S-P),D=E>0?Math.floor:Math.ceil,j=E>0?Math.ceil:Math.floor,V=E>0?Math.min:Math.max,Z=E>0?Math.max:Math.min,Q=D(P+z),K=j(S-z),$=[[s=I(P)]];for(t=Q;t*E<K*E;t+=E)g=[],p=Z(P,t),i=(c=V(S,t+E))-p,u=Math.max(0,Math.min(k-2,Math.floor(.5*(p+c)))),h=I(c),f&&(l=n(u,p-u),o=n(u,c-u),g.push([s[0]+l[0]/3*i,s[1]+l[1]/3*i]),g.push([h[0]-o[0]/3*i,h[1]-o[1]/3*i])),g.push(h),$.push(g),s=h;return $}},{"../../lib":515}],702:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../../components/color/attributes"),w=m("../../plots/cartesian/layout_attributes"),y=m("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=m("../../plot_api/edit_types").overrideAll,t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat;G.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:d({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:w.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:d({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:y("tick label")},tickformatstops:e(w.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},t,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},t,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:v.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:d({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(m,G,W){var d=m("./attributes"),v=m("../../components/color").addOpacity,w=m("../../registry"),y=m("../../lib"),e=m("../../plots/cartesian/tick_value_defaults"),t=m("../../plots/cartesian/tick_label_defaults"),n=m("../../plots/cartesian/prefix_suffix_defaults"),a=m("../../plots/cartesian/category_order_defaults"),r=m("../../plots/cartesian/set_convert"),g=m("../../plots/cartesian/axis_autotype");G.exports=function(u,s,h){var l=h.letter,o=h.font||{},p=d[l+"axis"];function c(E,z){return y.coerce(u,s,p,E,z)}function i(E,z){return y.coerce2(u,s,p,E,z)}h.name&&(s._name=h.name,s._id=h.name),c("autotypenumbers",h.autotypenumbersDflt);var x=c("type");x==="-"&&(h.data&&function(E,z){if(E.type==="-"){var D=E._id.charAt(0),j=E[D+"calendar"];E.type=g(z,j,{autotypenumbers:E.autotypenumbers})}}(s,h.data),s.type==="-"?s.type="linear":x=u.type=s.type),c("smoothing"),c("cheatertype"),c("showticklabels"),c("labelprefix",l+" = "),c("labelsuffix"),c("showtickprefix"),c("showticksuffix"),c("separatethousands"),c("tickformat"),c("exponentformat"),c("minexponent"),c("showexponent"),c("categoryorder"),c("tickmode"),c("tickvals"),c("ticktext"),c("tick0"),c("dtick"),s.tickmode==="array"&&(c("arraytick0"),c("arraydtick")),c("labelpadding"),s._hovertitle=l,x==="date"&&w.getComponentMethod("calendars","handleDefaults")(u,s,"calendar",h.calendar),r(s,h.fullLayout),s.c2p=y.identity;var f=c("color",h.dfltColor),_=f===u.color?f:o.color;c("title.text")&&(y.coerceFont(c,"title.font",{family:o.family,size:y.bigFont(o.size),color:_}),c("title.offset")),c("tickangle"),c("autorange",!s.isValidRange(u.range))&&c("rangemode"),c("range"),s.cleanRange(),c("fixedrange"),e(u,s,c,x),n(u,s,c,x,h),t(u,s,c,x,h),a(u,s,c,{data:h.data,dataAttr:l});var b=i("gridcolor",v(f,.3)),T=i("gridwidth"),k=i("griddash"),L=c("showgrid");L||(delete s.gridcolor,delete s.gridwidth,delete s.griddash);var A=i("startlinecolor",f),I=i("startlinewidth",T);c("startline",s.showgrid||!!A||!!I)||(delete s.startlinecolor,delete s.startlinewidth);var P=i("endlinecolor",f),S=i("endlinewidth",T);return c("endline",s.showgrid||!!P||!!S)||(delete s.endlinecolor,delete s.endlinewidth),L?(c("minorgridcount"),c("minorgridwidth",T),c("minorgriddash",k),c("minorgridcolor",v(b,.06)),s.minorgridcount||(delete s.minorgridwidth,delete s.minorgriddash,delete s.minorgridcolor)):(delete s.gridcolor,delete s.gridwidth,delete s.griddash),s.showticklabels==="none"&&(delete s.tickfont,delete s.tickangle,delete s.showexponent,delete s.exponentformat,delete s.minexponent,delete s.tickformat,delete s.showticksuffix,delete s.showtickprefix),s.showticksuffix||delete s.ticksuffix,s.showtickprefix||delete s.tickprefix,c("tickmode"),s}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib").isArray1D,w=m("./cheater_basis"),y=m("./array_minmax"),e=m("./calc_gridlines"),t=m("./calc_labels"),n=m("./calc_clippath"),a=m("../heatmap/clean_2d_array"),r=m("./smooth_fill_2d_array"),g=m("../heatmap/convert_column_xyz"),u=m("./set_convert");G.exports=function(s,h){var l=d.getFromId(s,h.xaxis),o=d.getFromId(s,h.yaxis),p=h.aaxis,c=h.baxis,i=h.x,x=h.y,f=[];i&&v(i)&&f.push("x"),x&&v(x)&&f.push("y"),f.length&&g(h,p,c,"a","b",f);var _=h._a=h._a||h.a,b=h._b=h._b||h.b;i=h._x||h.x,x=h._y||h.y;var T={};if(h._cheater){var k=p.cheatertype==="index"?_.length:_,L=c.cheatertype==="index"?b.length:b;i=w(k,L,h.cheaterslope)}h._x=i=a(i),h._y=x=a(x),r(i,_,b),r(x,_,b),u(h),h.setScale();var A=y(i),I=y(x),P=.5*(A[1]-A[0]),S=.5*(A[1]+A[0]),E=.5*(I[1]-I[0]),z=.5*(I[1]+I[0]);return A=[S-1.3*P,S+1.3*P],I=[z-1.3*E,z+1.3*E],h._extremes[l._id]=d.findExtremes(l,A,{padded:!0}),h._extremes[o._id]=d.findExtremes(o,I,{padded:!0}),e(h,"a","b"),e(h,"b","a"),t(h,p),t(h,c),T.clipsegments=n(h._xctrl,h._yctrl,p,c),T.x=i,T.y=x,T.a=_,T.b=b,[T]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(m,G,W){G.exports=function(d,v,w,y){var e,t,n,a=[],r=!!w.smoothing,g=!!y.smoothing,u=d[0].length-1,s=d.length-1;for(e=0,t=[],n=[];e<=u;e++)t[e]=d[0][e],n[e]=v[0][e];for(a.push({x:t,y:n,bicubic:r}),e=0,t=[],n=[];e<=s;e++)t[e]=d[e][u],n[e]=v[e][u];for(a.push({x:t,y:n,bicubic:g}),e=u,t=[],n=[];e>=0;e--)t[u-e]=d[s][e],n[u-e]=v[s][e];for(a.push({x:t,y:n,bicubic:r}),e=s,t=[],n=[];e>=0;e--)t[s-e]=d[e][0],n[s-e]=v[e][0];return a.push({x:t,y:n,bicubic:g}),a}},{}],706:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib/extend").extendFlat;G.exports=function(w,y,e){var t,n,a,r,g,u,s,h,l,o,p,c,i,x,f=w["_"+y],_=w[y+"axis"],b=_._gridlines=[],T=_._minorgridlines=[],k=_._boundarylines=[],L=w["_"+e],A=w[e+"axis"];_.tickmode==="array"&&(_.tickvals=f.slice());var I=w._xctrl,P=w._yctrl,S=I[0].length,E=I.length,z=w._a.length,D=w._b.length;d.prepTicks(_),_.tickmode==="array"&&delete _.tickvals;var j=_.smoothing?3:1;function V(Q){var K,$,ne,H,N,U,te,B,X,J,ee,re,se=[],oe=[],de={};if(y==="b")for($=w.b2j(Q),ne=Math.floor(Math.max(0,Math.min(D-2,$))),H=$-ne,de.length=D,de.crossLength=z,de.xy=function(ce){return w.evalxy([],ce,$)},de.dxy=function(ce,ve){return w.dxydi([],ce,ne,ve,H)},K=0;K<z;K++)U=Math.min(z-2,K),te=K-U,B=w.evalxy([],K,$),A.smoothing&&K>0&&(X=w.dxydi([],K-1,ne,0,H),se.push(N[0]+X[0]/3),oe.push(N[1]+X[1]/3),J=w.dxydi([],K-1,ne,1,H),se.push(B[0]-J[0]/3),oe.push(B[1]-J[1]/3)),se.push(B[0]),oe.push(B[1]),N=B;else for(K=w.a2i(Q),U=Math.floor(Math.max(0,Math.min(z-2,K))),te=K-U,de.length=z,de.crossLength=D,de.xy=function(ce){return w.evalxy([],K,ce)},de.dxy=function(ce,ve){return w.dxydj([],U,ce,te,ve)},$=0;$<D;$++)ne=Math.min(D-2,$),H=$-ne,B=w.evalxy([],K,$),A.smoothing&&$>0&&(ee=w.dxydj([],U,$-1,te,0),se.push(N[0]+ee[0]/3),oe.push(N[1]+ee[1]/3),re=w.dxydj([],U,$-1,te,1),se.push(B[0]-re[0]/3),oe.push(B[1]-re[1]/3)),se.push(B[0]),oe.push(B[1]),N=B;return de.axisLetter=y,de.axis=_,de.crossAxis=A,de.value=Q,de.constvar=e,de.index=h,de.x=se,de.y=oe,de.smoothing=A.smoothing,de}function Z(Q){var K,$,ne,H,N,U=[],te=[],B={};if(B.length=f.length,B.crossLength=L.length,y==="b")for(ne=Math.max(0,Math.min(D-2,Q)),N=Math.min(1,Math.max(0,Q-ne)),B.xy=function(X){return w.evalxy([],X,Q)},B.dxy=function(X,J){return w.dxydi([],X,ne,J,N)},K=0;K<S;K++)U[K]=I[Q*j][K],te[K]=P[Q*j][K];else for($=Math.max(0,Math.min(z-2,Q)),H=Math.min(1,Math.max(0,Q-$)),B.xy=function(X){return w.evalxy([],Q,X)},B.dxy=function(X,J){return w.dxydj([],$,X,H,J)},K=0;K<E;K++)U[K]=I[K][Q*j],te[K]=P[K][Q*j];return B.axisLetter=y,B.axis=_,B.crossAxis=A,B.value=f[Q],B.constvar=e,B.index=Q,B.x=U,B.y=te,B.smoothing=A.smoothing,B}if(_.tickmode==="array"){for(r=5e-15,u=(g=[Math.floor((f.length-1-_.arraytick0)/_.arraydtick*(1+r)),Math.ceil(-_.arraytick0/_.arraydtick/(1+r))].sort(function(Q,K){return Q-K}))[0]-1,s=g[1]+1,h=u;h<s;h++)(n=_.arraytick0+_.arraydtick*h)<0||n>f.length-1||b.push(v(Z(n),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=u;h<s;h++)if(a=_.arraytick0+_.arraydtick*h,p=Math.min(a+_.arraydtick,f.length-1),!(a<0||a>f.length-1||p<0||p>f.length-1))for(c=f[a],i=f[p],t=0;t<_.minorgridcount;t++)(x=p-a)<=0||(o=c+(i-c)*(t+1)/(_.minorgridcount+1)*(_.arraydtick/x))<f[0]||o>f[f.length-1]||T.push(v(V(o),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&k.push(v(Z(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&k.push(v(Z(f.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(r=5e-15,u=(g=[Math.floor((f[f.length-1]-_.tick0)/_.dtick*(1+r)),Math.ceil((f[0]-_.tick0)/_.dtick/(1+r))].sort(function(Q,K){return Q-K}))[0],s=g[1],h=u;h<=s;h++)l=_.tick0+_.dtick*h,b.push(v(V(l),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=u-1;h<s+1;h++)for(l=_.tick0+_.dtick*h,t=0;t<_.minorgridcount;t++)(o=l+_.dtick*(t+1)/(_.minorgridcount+1))<f[0]||o>f[f.length-1]||T.push(v(V(o),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&k.push(v(V(f[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&k.push(v(V(f[f.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib/extend").extendFlat;G.exports=function(w,y){var e,t,n,a=y._labels=[],r=y._gridlines;for(e=0;e<r.length;e++)n=r[e],["start","both"].indexOf(y.showticklabels)!==-1&&(t=d.tickText(y,n.value),v(t,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:n.xy(0),dxy:n.dxy(0,0),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),a.push(t)),["end","both"].indexOf(y.showticklabels)!==-1&&(t=d.tickText(y,n.value),v(t,{endAnchor:!1,xy:n.xy(n.crossLength-1),dxy:n.dxy(n.crossLength-2,1),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),a.push(t))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(m,G,W){G.exports=function(d,v,w,y){var e=d[0]-v[0],t=d[1]-v[1],n=w[0]-v[0],a=w[1]-v[1],r=Math.pow(e*e+t*t,.25),g=Math.pow(n*n+a*a,.25),u=(g*g*e-r*r*n)*y,s=(g*g*t-r*r*a)*y,h=g*(r+g)*3,l=r*(r+g)*3;return[[v[0]+(h&&u/h),v[1]+(h&&s/h)],[v[0]-(l&&u/l),v[1]-(l&&s/l)]]}},{}],709:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y){var e,t,n,a,r,g,u=[],s=d(v)?v.length:v,h=d(w)?w.length:w,l=d(v)?v:null,o=d(w)?w:null;l&&(n=(l.length-1)/(l[l.length-1]-l[0])/(s-1)),o&&(a=(o.length-1)/(o[o.length-1]-o[0])/(h-1));var p=1/0,c=-1/0;for(t=0;t<h;t++)for(u[t]=[],r=o?(o[t]-o[0])*a:t/(h-1),e=0;e<s;e++)g=(l?(l[e]-l[0])*n:e/(s-1))-r*y,p=Math.min(g,p),c=Math.max(g,c),u[t][e]=g;var i=1/(c-p),x=-p*i;for(t=0;t<h;t++)for(e=0;e<s;e++)u[t][e]=i*u[t][e]+x;return u}},{"../../lib":515}],710:[function(m,G,W){var d=m("./catmull_rom"),v=m("../../lib").ensureArray;function w(y,e,t){var n=-.5*t[0]+1.5*e[0],a=-.5*t[1]+1.5*e[1];return[(2*n+y[0])/3,(2*a+y[1])/3]}G.exports=function(y,e,t,n,a,r){var g,u,s,h,l,o,p,c,i,x,f=t[0].length,_=t.length,b=a?3*f-2:f,T=r?3*_-2:_;for(y=v(y,T),e=v(e,T),s=0;s<T;s++)y[s]=v(y[s],b),e[s]=v(e[s],b);for(u=0,h=0;u<_;u++,h+=r?3:1)for(l=y[h],o=e[h],p=t[u],c=n[u],g=0,s=0;g<f;g++,s+=a?3:1)l[s]=p[g],o[s]=c[g];if(a)for(u=0,h=0;u<_;u++,h+=r?3:1){for(g=1,s=3;g<f-1;g++,s+=3)i=d([t[u][g-1],n[u][g-1]],[t[u][g],n[u][g]],[t[u][g+1],n[u][g+1]],a),y[h][s-1]=i[0][0],e[h][s-1]=i[0][1],y[h][s+1]=i[1][0],e[h][s+1]=i[1][1];x=w([y[h][0],e[h][0]],[y[h][2],e[h][2]],[y[h][3],e[h][3]]),y[h][1]=x[0],e[h][1]=x[1],x=w([y[h][b-1],e[h][b-1]],[y[h][b-3],e[h][b-3]],[y[h][b-4],e[h][b-4]]),y[h][b-2]=x[0],e[h][b-2]=x[1]}if(r)for(s=0;s<b;s++){for(h=3;h<T-3;h+=3)i=d([y[h-3][s],e[h-3][s]],[y[h][s],e[h][s]],[y[h+3][s],e[h+3][s]],r),y[h-1][s]=i[0][0],e[h-1][s]=i[0][1],y[h+1][s]=i[1][0],e[h+1][s]=i[1][1];x=w([y[0][s],e[0][s]],[y[2][s],e[2][s]],[y[3][s],e[3][s]]),y[1][s]=x[0],e[1][s]=x[1],x=w([y[T-1][s],e[T-1][s]],[y[T-3][s],e[T-3][s]],[y[T-4][s],e[T-4][s]]),y[T-2][s]=x[0],e[T-2][s]=x[1]}if(a&&r)for(h=1;h<T;h+=(h+1)%3==0?2:1){for(s=3;s<b-3;s+=3)i=d([y[h][s-3],e[h][s-3]],[y[h][s],e[h][s]],[y[h][s+3],e[h][s+3]],a),y[h][s-1]=.5*(y[h][s-1]+i[0][0]),e[h][s-1]=.5*(e[h][s-1]+i[0][1]),y[h][s+1]=.5*(y[h][s+1]+i[1][0]),e[h][s+1]=.5*(e[h][s+1]+i[1][1]);x=w([y[h][0],e[h][0]],[y[h][2],e[h][2]],[y[h][3],e[h][3]]),y[h][1]=.5*(y[h][1]+x[0]),e[h][1]=.5*(e[h][1]+x[1]),x=w([y[h][b-1],e[h][b-1]],[y[h][b-3],e[h][b-3]],[y[h][b-4],e[h][b-4]]),y[h][b-2]=.5*(y[h][b-2]+x[0]),e[h][b-2]=.5*(e[h][b-2]+x[1])}return[y,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(m,G,W){G.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(m,G,W){G.exports=function(d,v,w){return v&&w?function(y,e,t,n,a){var r,g,u,s,h,l;y||(y=[]),e*=3,t*=3;var o=n*n,p=1-n,c=p*p,i=p*n*2,x=-3*c,f=3*(c-i),_=3*(i-o),b=3*o,T=a*a,k=T*a,L=1-a,A=L*L,I=A*L;for(l=0;l<d.length;l++)r=x*(h=d[l])[t][e]+f*h[t][e+1]+_*h[t][e+2]+b*h[t][e+3],g=x*h[t+1][e]+f*h[t+1][e+1]+_*h[t+1][e+2]+b*h[t+1][e+3],u=x*h[t+2][e]+f*h[t+2][e+1]+_*h[t+2][e+2]+b*h[t+2][e+3],s=x*h[t+3][e]+f*h[t+3][e+1]+_*h[t+3][e+2]+b*h[t+3][e+3],y[l]=I*r+3*(A*a*g+L*T*u)+k*s;return y}:v?function(y,e,t,n,a){var r,g,u,s;y||(y=[]),e*=3;var h=n*n,l=1-n,o=l*l,p=l*n*2,c=-3*o,i=3*(o-p),x=3*(p-h),f=3*h,_=1-a;for(u=0;u<d.length;u++)r=c*(s=d[u])[t][e]+i*s[t][e+1]+x*s[t][e+2]+f*s[t][e+3],g=c*s[t+1][e]+i*s[t+1][e+1]+x*s[t+1][e+2]+f*s[t+1][e+3],y[u]=_*r+a*g;return y}:w?function(y,e,t,n,a){var r,g,u,s,h,l;y||(y=[]),t*=3;var o=a*a,p=o*a,c=1-a,i=c*c,x=i*c;for(h=0;h<d.length;h++)r=(l=d[h])[t][e+1]-l[t][e],g=l[t+1][e+1]-l[t+1][e],u=l[t+2][e+1]-l[t+2][e],s=l[t+3][e+1]-l[t+3][e],y[h]=x*r+3*(i*a*g+c*o*u)+p*s;return y}:function(y,e,t,n,a){var r,g,u,s;y||(y=[]);var h=1-a;for(u=0;u<d.length;u++)r=(s=d[u])[t][e+1]-s[t][e],g=s[t+1][e+1]-s[t+1][e],y[u]=h*r+a*g;return y}}},{}],713:[function(m,G,W){G.exports=function(d,v,w){return v&&w?function(y,e,t,n,a){var r,g,u,s,h,l;y||(y=[]),e*=3,t*=3;var o=n*n,p=o*n,c=1-n,i=c*c,x=i*c,f=a*a,_=1-a,b=_*_,T=_*a*2,k=-3*b,L=3*(b-T),A=3*(T-f),I=3*f;for(l=0;l<d.length;l++)r=k*(h=d[l])[t][e]+L*h[t+1][e]+A*h[t+2][e]+I*h[t+3][e],g=k*h[t][e+1]+L*h[t+1][e+1]+A*h[t+2][e+1]+I*h[t+3][e+1],u=k*h[t][e+2]+L*h[t+1][e+2]+A*h[t+2][e+2]+I*h[t+3][e+2],s=k*h[t][e+3]+L*h[t+1][e+3]+A*h[t+2][e+3]+I*h[t+3][e+3],y[l]=x*r+3*(i*n*g+c*o*u)+p*s;return y}:v?function(y,e,t,n,a){var r,g,u,s,h,l;y||(y=[]),e*=3;var o=a*a,p=o*a,c=1-a,i=c*c,x=i*c;for(h=0;h<d.length;h++)r=(l=d[h])[t+1][e]-l[t][e],g=l[t+1][e+1]-l[t][e+1],u=l[t+1][e+2]-l[t][e+2],s=l[t+1][e+3]-l[t][e+3],y[h]=x*r+3*(i*a*g+c*o*u)+p*s;return y}:w?function(y,e,t,n,a){var r,g,u,s;y||(y=[]),t*=3;var h=1-n,l=a*a,o=1-a,p=o*o,c=o*a*2,i=-3*p,x=3*(p-c),f=3*(c-l),_=3*l;for(u=0;u<d.length;u++)r=i*(s=d[u])[t][e]+x*s[t+1][e]+f*s[t+2][e]+_*s[t+3][e],g=i*s[t][e+1]+x*s[t+1][e+1]+f*s[t+2][e+1]+_*s[t+3][e+1],y[u]=h*r+n*g;return y}:function(y,e,t,n,a){var r,g,u,s;y||(y=[]);var h=1-n;for(u=0;u<d.length;u++)r=(s=d[u])[t+1][e]-s[t][e],g=s[t+1][e+1]-s[t][e+1],y[u]=h*r+n*g;return y}}},{}],714:[function(m,G,W){G.exports=function(d,v,w,y,e){var t=v-2,n=w-2;return y&&e?function(a,r,g){var u,s,h,l,o,p;a||(a=[]);var c=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-c)),f=Math.max(0,Math.min(1,g-i));c*=3,i*=3;var _=x*x,b=_*x,T=1-x,k=T*T,L=k*T,A=f*f,I=A*f,P=1-f,S=P*P,E=S*P;for(p=0;p<d.length;p++)u=L*(o=d[p])[i][c]+3*(k*x*o[i][c+1]+T*_*o[i][c+2])+b*o[i][c+3],s=L*o[i+1][c]+3*(k*x*o[i+1][c+1]+T*_*o[i+1][c+2])+b*o[i+1][c+3],h=L*o[i+2][c]+3*(k*x*o[i+2][c+1]+T*_*o[i+2][c+2])+b*o[i+2][c+3],l=L*o[i+3][c]+3*(k*x*o[i+3][c+1]+T*_*o[i+3][c+2])+b*o[i+3][c+3],a[p]=E*u+3*(S*f*s+P*A*h)+I*l;return a}:y?function(a,r,g){a||(a=[]);var u,s,h,l,o,p,c=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-c)),f=Math.max(0,Math.min(1,g-i));c*=3;var _=x*x,b=_*x,T=1-x,k=T*T,L=k*T,A=1-f;for(o=0;o<d.length;o++)u=A*(p=d[o])[i][c]+f*p[i+1][c],s=A*p[i][c+1]+f*p[i+1][c+1],h=A*p[i][c+2]+f*p[i+1][c+1],l=A*p[i][c+3]+f*p[i+1][c+1],a[o]=L*u+3*(k*x*s+T*_*h)+b*l;return a}:e?function(a,r,g){a||(a=[]);var u,s,h,l,o,p,c=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-c)),f=Math.max(0,Math.min(1,g-i));i*=3;var _=f*f,b=_*f,T=1-f,k=T*T,L=k*T,A=1-x;for(o=0;o<d.length;o++)u=A*(p=d[o])[i][c]+x*p[i][c+1],s=A*p[i+1][c]+x*p[i+1][c+1],h=A*p[i+2][c]+x*p[i+2][c+1],l=A*p[i+3][c]+x*p[i+3][c+1],a[o]=L*u+3*(k*f*s+T*_*h)+b*l;return a}:function(a,r,g){a||(a=[]);var u,s,h,l,o=Math.max(0,Math.min(Math.floor(r),t)),p=Math.max(0,Math.min(Math.floor(g),n)),c=Math.max(0,Math.min(1,r-o)),i=Math.max(0,Math.min(1,g-p)),x=1-i,f=1-c;for(h=0;h<d.length;h++)u=f*(l=d[h])[p][o]+c*l[p][o+1],s=f*l[p+1][o]+c*l[p+1][o+1],a[h]=x*u+i*s;return a}}},{}],715:[function(m,G,W){var d=m("../../lib"),v=m("./xy_defaults"),w=m("./ab_defaults"),y=m("./attributes"),e=m("../../components/color/attributes");G.exports=function(t,n,a,r){function g(s,h){return d.coerce(t,n,y,s,h)}n._clipPathId="clip"+n.uid+"carpet";var u=g("color",e.defaultLine);d.coerceFont(g,"font"),g("carpet"),w(t,n,r,g,u),n.a&&n.b?(n.a.length<3&&(n.aaxis.smoothing=0),n.b.length<3&&(n.baxis.smoothing=0),v(t,n,g)||(n.visible=!1),n._cheater&&g("cheaterslope")):n.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),plot:m("./plot"),calc:m("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(m,G,W){G.exports=function(d,v){for(var w,y=d._fullData.length,e=0;e<y;e++){var t=d._fullData[e];if(t.index!==v.index&&t.type==="carpet"&&(w||(w=t),t.carpet===v.carpet))return t}return w}},{}],718:[function(m,G,W){G.exports=function(d,v,w){if(d.length===0)return"";var y,e=[],t=w?3:1;for(y=0;y<d.length;y+=t)e.push(d[y]+","+v[y]),w&&y<d.length-t&&(e.push("C"),e.push([d[y+1]+","+v[y+1],d[y+2]+","+v[y+2]+" "].join(" ")));return e.join(w?"":"L")}},{}],719:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y){var e;for(d(v)?v.length>w.length&&(v=v.slice(0,w.length)):v=[],e=0;e<w.length;e++)v[e]=y(w[e]);return v}},{"../../lib":515}],720:[function(m,G,W){G.exports=function(d,v,w,y,e,t){var n=e[0]*d.dpdx(v),a=e[1]*d.dpdy(w),r=1,g=1;if(t){var u=Math.sqrt(e[0]*e[0]+e[1]*e[1]),s=Math.sqrt(t[0]*t[0]+t[1]*t[1]),h=(e[0]*t[0]+e[1]*t[1])/u/s;g=Math.max(0,h)}var l=180*Math.atan2(a,n)/Math.PI;return l<-90?(l+=180,r=-r):l>90&&(l-=180,r=-r),{angle:l,flip:r,p:d.c2p(y,v,w),offsetMultplier:g}}},{}],721:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("./map_1d_array"),y=m("./makepath"),e=m("./orient_text"),t=m("../../lib/svg_text_utils"),n=m("../../lib"),a=n.strRotate,r=n.strTranslate,g=m("../../constants/alignment");function u(p,c,i,x,f,_){var b="const-"+f+"-lines",T=i.selectAll("."+b).data(_);T.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),T.each(function(k){var L=k,A=L.x,I=L.y,P=w([],A,p.c2p),S=w([],I,c.c2p),E="M"+y(P,S,L.smoothing);d.select(this).attr("d",E).style("stroke-width",L.width).style("stroke",L.color).style("stroke-dasharray",v.dashStyle(L.dash,L.width)).style("fill","none")}),T.exit().remove()}function s(p,c,i,x,f,_,b,T){var k=_.selectAll("text."+T).data(b);k.enter().append("text").classed(T,!0);var L=0,A={};return k.each(function(I,P){var S;if(I.axis.tickangle==="auto")S=e(x,c,i,I.xy,I.dxy);else{var E=(I.axis.tickangle+180)*Math.PI/180;S=e(x,c,i,I.xy,[Math.cos(E),Math.sin(E)])}P||(A={angle:S.angle,flip:S.flip});var z=(I.endAnchor?-1:1)*S.flip,D=d.select(this).attr({"text-anchor":z>0?"start":"end","data-notex":1}).call(v.font,I.font).text(I.text).call(t.convertToTspans,p),j=v.bBox(this);D.attr("transform",r(S.p[0],S.p[1])+a(S.angle)+r(I.axis.labelpadding*z,.3*j.height)),L=Math.max(L,j.width+I.axis.labelpadding)}),k.exit().remove(),A.maxExtent=L,A}G.exports=function(p,c,i,x){var f=c.xaxis,_=c.yaxis,b=p._fullLayout._clips;n.makeTraceGroups(x,i,"trace").each(function(T){var k=d.select(this),L=T[0],A=L.trace,I=A.aaxis,P=A.baxis,S=n.ensureSingle(k,"g","minorlayer"),E=n.ensureSingle(k,"g","majorlayer"),z=n.ensureSingle(k,"g","boundarylayer"),D=n.ensureSingle(k,"g","labellayer");k.style("opacity",A.opacity),u(f,_,E,I,"a",I._gridlines),u(f,_,E,P,"b",P._gridlines),u(f,_,S,I,"a",I._minorgridlines),u(f,_,S,P,"b",P._minorgridlines),u(f,_,z,I,"a-boundary",I._boundarylines),u(f,_,z,P,"b-boundary",P._boundarylines);var j=s(p,f,_,A,L,D,I._labels,"a-label"),V=s(p,f,_,A,L,D,P._labels,"b-label");(function(Z,Q,K,$,ne,H,N,U){var te,B,X,J,ee=n.aggNums(Math.min,null,K.a),re=n.aggNums(Math.max,null,K.a),se=n.aggNums(Math.min,null,K.b),oe=n.aggNums(Math.max,null,K.b);te=.5*(ee+re),B=se,X=K.ab2xy(te,B,!0),J=K.dxyda_rough(te,B),N.angle===void 0&&n.extendFlat(N,e(K,ne,H,X,K.dxydb_rough(te,B))),o(Z,Q,K,$,X,J,K.aaxis,ne,H,N,"a-title"),te=ee,B=.5*(se+oe),X=K.ab2xy(te,B,!0),J=K.dxydb_rough(te,B),U.angle===void 0&&n.extendFlat(U,e(K,ne,H,X,K.dxyda_rough(te,B))),o(Z,Q,K,$,X,J,K.baxis,ne,H,U,"b-title")})(p,D,A,L,f,_,j,V),function(Z,Q,K,$,ne){var H,N,U,te,B=K.select("#"+Z._clipPathId);B.size()||(B=K.append("clipPath").classed("carpetclip",!0));var X=n.ensureSingle(B,"path","carpetboundary"),J=Q.clipsegments,ee=[];for(te=0;te<J.length;te++)H=J[te],N=w([],H.x,$.c2p),U=w([],H.y,ne.c2p),ee.push(y(N,U,H.bicubic));var re="M"+ee.join("L")+"Z";B.attr("id",Z._clipPathId),X.attr("d",re)}(A,L,b,f,_)})};var h=g.LINE_SPACING,l=(1-g.MID_SHIFT)/h+1;function o(p,c,i,x,f,_,b,T,k,L,A){var I=[];b.title.text&&I.push(b.title.text);var P=c.selectAll("text."+A).data(I),S=L.maxExtent;P.enter().append("text").classed(A,!0),P.each(function(){var E=e(i,T,k,f,_);["start","both"].indexOf(b.showticklabels)===-1&&(S=0);var z=b.title.font.size;S+=z+b.title.offset;var D=(L.angle+(L.flip<0?180:0)-E.angle+450)%360,j=D>90&&D<270,V=d.select(this);V.text(b.title.text).call(t.convertToTspans,p),j&&(S=(-t.lineCount(V)+l)*h*z-S),V.attr("transform",r(E.p[0],E.p[1])+a(E.angle)+r(0,S)).attr("text-anchor","middle").call(v.font,b.title.font)}),P.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(m,G,W){var d=m("./constants"),v=m("../../lib/search").findBin,w=m("./compute_control_points"),y=m("./create_spline_evaluator"),e=m("./create_i_derivative_evaluator"),t=m("./create_j_derivative_evaluator");G.exports=function(n){var a=n._a,r=n._b,g=a.length,u=r.length,s=n.aaxis,h=n.baxis,l=a[0],o=a[g-1],p=r[0],c=r[u-1],i=a[a.length-1]-a[0],x=r[r.length-1]-r[0],f=i*d.RELATIVE_CULL_TOLERANCE,_=x*d.RELATIVE_CULL_TOLERANCE;l-=f,o+=f,p-=_,c+=_,n.isVisible=function(b,T){return b>l&&b<o&&T>p&&T<c},n.isOccluded=function(b,T){return b<l||b>o||T<p||T>c},n.setScale=function(){var b=n._x,T=n._y,k=w(n._xctrl,n._yctrl,b,T,s.smoothing,h.smoothing);n._xctrl=k[0],n._yctrl=k[1],n.evalxy=y([n._xctrl,n._yctrl],g,u,s.smoothing,h.smoothing),n.dxydi=e([n._xctrl,n._yctrl],s.smoothing,h.smoothing),n.dxydj=t([n._xctrl,n._yctrl],s.smoothing,h.smoothing)},n.i2a=function(b){var T=Math.max(0,Math.floor(b[0]),g-2),k=b[0]-T;return(1-k)*a[T]+k*a[T+1]},n.j2b=function(b){var T=Math.max(0,Math.floor(b[1]),g-2),k=b[1]-T;return(1-k)*r[T]+k*r[T+1]},n.ij2ab=function(b){return[n.i2a(b[0]),n.j2b(b[1])]},n.a2i=function(b){var T=Math.max(0,Math.min(v(b,a),g-2)),k=a[T],L=a[T+1];return Math.max(0,Math.min(g-1,T+(b-k)/(L-k)))},n.b2j=function(b){var T=Math.max(0,Math.min(v(b,r),u-2)),k=r[T],L=r[T+1];return Math.max(0,Math.min(u-1,T+(b-k)/(L-k)))},n.ab2ij=function(b){return[n.a2i(b[0]),n.b2j(b[1])]},n.i2c=function(b,T){return n.evalxy([],b,T)},n.ab2xy=function(b,T,k){if(!k&&(b<a[0]||b>a[g-1]|T<r[0]||T>r[u-1]))return[!1,!1];var L=n.a2i(b),A=n.b2j(T),I=n.evalxy([],L,A);if(k){var P,S,E,z,D=0,j=0,V=[];b<a[0]?(P=0,S=0,D=(b-a[0])/(a[1]-a[0])):b>a[g-1]?(P=g-2,S=1,D=(b-a[g-1])/(a[g-1]-a[g-2])):S=L-(P=Math.max(0,Math.min(g-2,Math.floor(L)))),T<r[0]?(E=0,z=0,j=(T-r[0])/(r[1]-r[0])):T>r[u-1]?(E=u-2,z=1,j=(T-r[u-1])/(r[u-1]-r[u-2])):z=A-(E=Math.max(0,Math.min(u-2,Math.floor(A)))),D&&(n.dxydi(V,P,E,S,z),I[0]+=V[0]*D,I[1]+=V[1]*D),j&&(n.dxydj(V,P,E,S,z),I[0]+=V[0]*j,I[1]+=V[1]*j)}return I},n.c2p=function(b,T,k){return[T.c2p(b[0]),k.c2p(b[1])]},n.p2x=function(b,T,k){return[T.p2c(b[0]),k.p2c(b[1])]},n.dadi=function(b){var T=Math.max(0,Math.min(a.length-2,b));return a[T+1]-a[T]},n.dbdj=function(b){var T=Math.max(0,Math.min(r.length-2,b));return r[T+1]-r[T]},n.dxyda=function(b,T,k,L){var A=n.dxydi(null,b,T,k,L),I=n.dadi(b,k);return[A[0]/I,A[1]/I]},n.dxydb=function(b,T,k,L){var A=n.dxydj(null,b,T,k,L),I=n.dbdj(T,L);return[A[0]/I,A[1]/I]},n.dxyda_rough=function(b,T,k){var L=i*(k||.1),A=n.ab2xy(b+L,T,!0),I=n.ab2xy(b-L,T,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},n.dxydb_rough=function(b,T,k){var L=x*(k||.1),A=n.ab2xy(b,T+L,!0),I=n.ab2xy(b,T-L,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},n.dpdx=function(b){return b._m},n.dpdy=function(b){return b._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w,y){var e,t,n,a=[],r=[],g=v[0].length,u=v.length;function s(Q,K){var $,ne=0,H=0;return Q>0&&($=v[K][Q-1])!==void 0&&(H++,ne+=$),Q<g-1&&($=v[K][Q+1])!==void 0&&(H++,ne+=$),K>0&&($=v[K-1][Q])!==void 0&&(H++,ne+=$),K<u-1&&($=v[K+1][Q])!==void 0&&(H++,ne+=$),ne/Math.max(1,H)}var h,l,o,p,c,i,x,f,_,b,T,k=0;for(e=0;e<g;e++)for(t=0;t<u;t++)v[t][e]===void 0&&(a.push(e),r.push(t),v[t][e]=s(e,t)),k=Math.max(k,Math.abs(v[t][e]));if(!a.length)return v;var L=0,A=0,I=a.length;do{for(L=0,n=0;n<I;n++){e=a[n],t=r[n];var P,S,E,z,D,j,V=0,Z=0;e===0?(E=w[D=Math.min(g-1,2)],z=w[1],P=v[t][D],Z+=(S=v[t][1])+(S-P)*(w[0]-z)/(z-E),V++):e===g-1&&(E=w[D=Math.max(0,g-3)],z=w[g-2],P=v[t][D],Z+=(S=v[t][g-2])+(S-P)*(w[g-1]-z)/(z-E),V++),(e===0||e===g-1)&&t>0&&t<u-1&&(h=y[t+1]-y[t],Z+=((l=y[t]-y[t-1])*v[t+1][e]+h*v[t-1][e])/(l+h),V++),t===0?(E=y[j=Math.min(u-1,2)],z=y[1],P=v[j][e],Z+=(S=v[1][e])+(S-P)*(y[0]-z)/(z-E),V++):t===u-1&&(E=y[j=Math.max(0,u-3)],z=y[u-2],P=v[j][e],Z+=(S=v[u-2][e])+(S-P)*(y[u-1]-z)/(z-E),V++),(t===0||t===u-1)&&e>0&&e<g-1&&(h=w[e+1]-w[e],Z+=((l=w[e]-w[e-1])*v[t][e+1]+h*v[t][e-1])/(l+h),V++),V?Z/=V:(o=w[e+1]-w[e],p=w[e]-w[e-1],f=(c=y[t+1]-y[t])*(i=y[t]-y[t-1])*(c+i),Z=((x=o*p*(o+p))*(i*v[t+1][e]+c*v[t-1][e])+f*(p*v[t][e+1]+o*v[t][e-1]))/(f*(p+o)+x*(i+c))),L+=(b=(_=Z-v[t][e])/k)*b,T=V?0:.85,v[t][e]+=_*(1+T)}L=Math.sqrt(L)}while(A++<100&&L>1e-5);return d.log("Smoother converged to",L,"after",A,"iterations"),v}},{"../../lib":515}],724:[function(m,G,W){var d=m("../../lib").isArray1D;G.exports=function(v,w,y){var e=y("x"),t=e&&e.length,n=y("y"),a=n&&n.length;if(!t&&!a)return!1;if(w._cheater=!e,t&&!d(e)||a&&!d(n))w._length=null;else{var r=t?e.length:1/0;a&&(r=Math.min(r,n.length)),w.a&&w.a.length&&(r=Math.min(r,w.a.length)),w.b&&w.b.length&&(r=Math.min(r,w.b.length)),w._length=r}return!0}},{"../../lib":515}],725:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../scattergeo/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../plots/attributes"),e=m("../../components/color/attributes").defaultLine,t=m("../../lib/extend").extendFlat,n=v.marker.line;G.exports=t({locations:{valType:"data_array",editType:"calc"},locationmode:v.locationmode,z:{valType:"data_array",editType:"calc"},geojson:t({},v.geojson,{}),featureidkey:v.featureidkey,text:t({},v.text,{}),hovertext:t({},v.hovertext,{}),marker:{line:{color:t({},n.color,{dflt:e}),width:t({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:v.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:v.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:t({},y.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:d(),showlegend:t({},y.showlegend,{dflt:!1})},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../../components/colorscale/calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection");function t(n){return n&&typeof n=="string"}G.exports=function(n,a){var r,g=a._length,u=new Array(g);r=a.geojson?function(p){return t(p)||d(p)}:t;for(var s=0;s<g;s++){var h=u[s]={},l=a.locations[s],o=a.z[s];r(l)&&d(o)?(h.loc=l,h.z=o):(h.loc=null,h.z=v),h.index=s}return y(u,a),w(n,a,{vals:a.z,containerStr:"",cLetter:"z"}),e(u,a),u}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function a(h,l){return d.coerce(y,e,w,h,l)}var r=a("locations"),g=a("z");if(r&&r.length&&d.isArrayOrTypedArray(g)&&g.length){e._length=Math.min(r.length,g.length);var u,s=a("geojson");(typeof s=="string"&&s!==""||d.isPlainObject(s))&&(u="geojson-id"),a("locationmode",u)==="geojson-id"&&a("featureidkey"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),v(y,e,n,a,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(e,a)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(m,G,W){G.exports=function(d,v,w,y,e){d.location=v.location,d.z=v.z;var t=y[e];return t.fIn&&t.fIn.properties&&(d.properties=t.fIn.properties),d.ct=t.ct,d}},{}],729:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("./attributes"),w=m("../../lib").fillText;G.exports=function(y,e,t){var n,a,r,g,u=y.cd,s=u[0].trace,h=y.subplot,l=[e,t],o=[e+360,t];for(a=0;a<u.length;a++)if(g=!1,(n=u[a])._polygons){for(r=0;r<n._polygons.length;r++)n._polygons[r].contains(l)&&(g=!g),n._polygons[r].contains(o)&&(g=!g);if(g)break}if(g&&n)return y.x0=y.x1=y.xa.c2p(n.ct),y.y0=y.y1=y.ya.c2p(n.ct),y.index=n.index,y.location=n.loc,y.z=n.z,y.zLabel=d.tickText(h.mockAxis,h.mockAxis.c2l(n.z),"hover").text,y.hovertemplate=n.hovertemplate,function(p,c,i){if(!c.hovertemplate){var x=i.hi||c.hoverinfo,f=String(i.loc),_=x==="all"?v.hoverinfo.flags:x.split("+"),b=_.indexOf("name")!==-1,T=_.indexOf("location")!==-1,k=_.indexOf("z")!==-1,L=_.indexOf("text")!==-1,A=[];!b&&T?p.nameOverride=f:(b&&(p.nameOverride=c.name),T&&A.push(f)),k&&A.push(p.zLabel),L&&w(i,c,A),p.extraText=A.join("<br>")}}(y,s,n),[y]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("./calc"),calcGeoJSON:m("./plot").calcGeoJSON,plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"choropleth",basePlotModule:m("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../lib/geo_location_utils"),y=m("../../lib/topojson_utils").getTopojsonFeatures,e=m("../../plots/cartesian/autorange").findExtremes,t=m("./style").style;G.exports={calcGeoJSON:function(n,a){for(var r=n[0].trace,g=a[r.geo],u=g._subplot,s=r.locationmode,h=r._length,l=s==="geojson-id"?w.extractTraceFeature(n):y(r,u.topojson),o=[],p=[],c=0;c<h;c++){var i=n[c],x=s==="geojson-id"?i.fOut:w.locationToFeature(s,i.loc,l);if(x){i.geojson=x,i.ct=x.properties.ct,i._polygons=w.feature2polygons(x);var f=w.computeBbox(x);o.push(f[0],f[2]),p.push(f[1],f[3])}else i.geojson=null}if(g.fitbounds==="geojson"&&s==="geojson-id"){var _=w.computeBbox(w.getTraceGeojson(r));o=[_[0],_[2]],p=[_[1],_[3]]}var b={padded:!0};r._extremes.lon=e(g.lonaxis._ax,o,b),r._extremes.lat=e(g.lataxis._ax,p,b)},plot:function(n,a,r){var g=a.layers.backplot.select(".choroplethlayer");v.makeTraceGroups(g,r,"trace choropleth").each(function(u){var s=d.select(this).selectAll("path.choroplethlocation").data(v.identity);s.enter().append("path").classed("choroplethlocation",!0),s.exit().remove(),t(n,u)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(m,G,W){G.exports=function(d,v){var w,y,e,t,n,a=d.cd,r=d.xaxis,g=d.yaxis,u=[];if(v===!1)for(w=0;w<a.length;w++)a[w].selected=0;else for(w=0;w<a.length;w++)(e=(y=a[w]).ct)&&(t=r.c2p(e),n=g.c2p(e),v.contains([t,n],null,w,d)?(u.push({pointNumber:w,lon:e[0],lat:e[1]}),y.selected=1):y.selected=0);return u}},{}],733:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing"),y=m("../../components/colorscale");function e(t,n){var a=n[0].trace,r=n[0].node3.selectAll(".choroplethlocation"),g=a.marker||{},u=g.line||{},s=y.makeColorScaleFuncFromTrace(a);r.each(function(h){d.select(this).attr("fill",s(h.z)).call(v.stroke,h.mlc||u.color).call(w.dashLine,"",h.mlw||u.width||0).style("opacity",g.opacity)}),w.selectedPointStyle(r,a)}G.exports={style:function(t,n){n&&e(t,n)},styleOnSelect:function(t,n){var a=n[0].node3,r=n[0].trace;r.selectedpoints?w.selectedPointStyle(a.selectAll(".choroplethlocation"),r):e(0,n)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(m,G,W){var d=m("../choropleth/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/attributes"),e=m("../../lib/extend").extendFlat;G.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},d.featureidkey,{}),below:{valType:"string",editType:"plot"},text:d.text,hovertext:d.hovertext,marker:{line:{color:e({},d.marker.line.color,{editType:"plot"}),width:e({},d.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},d.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},d.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},d.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:d.hoverinfo,hovertemplate:w({},{keys:["properties"]}),showlegend:e({},y.showlegend,{dflt:!1})},v("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../components/colorscale"),y=m("../../components/drawing"),e=m("../../lib/geojson_utils").makeBlank,t=m("../../lib/geo_location_utils");function n(a){var r,g=a[0].trace,u=g._opts;if(g.selectedpoints){for(var s=y.makeSelectedPointStyleFns(g),h=0;h<a.length;h++){var l=a[h];l.fOut&&(l.fOut.properties.mo2=s.selectedOpacityFn(l))}r={type:"identity",property:"mo2"}}else r=v.isArrayOrTypedArray(g.marker.opacity)?{type:"identity",property:"mo"}:g.marker.opacity;return v.extendFlat(u.fill.paint,{"fill-opacity":r}),v.extendFlat(u.line.paint,{"line-opacity":r}),u}G.exports={convert:function(a){var r=a[0].trace,g=r.visible===!0&&r._length!==0,u={layout:{visibility:"none"},paint:{}},s={layout:{visibility:"none"},paint:{}},h=r._opts={fill:u,line:s,geojson:e()};if(!g)return h;var l=t.extractTraceFeature(a);if(!l)return h;var o,p,c,i=w.makeColorScaleFuncFromTrace(r),x=r.marker,f=x.line||{};v.isArrayOrTypedArray(x.opacity)&&(o=function(A){var I=A.mo;return d(I)?+v.constrain(I,0,1):0}),v.isArrayOrTypedArray(f.color)&&(p=function(A){return A.mlc}),v.isArrayOrTypedArray(f.width)&&(c=function(A){return A.mlw});for(var _=0;_<a.length;_++){var b=a[_],T=b.fOut;if(T){var k=T.properties;k.fc=i(b.z),o&&(k.mo=o(b)),p&&(k.mlc=p(b)),c&&(k.mlw=c(b)),b.ct=k.ct,b._polygons=t.feature2polygons(T)}}var L=o?{type:"identity",property:"mo"}:x.opacity;return v.extendFlat(u.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),v.extendFlat(s.paint,{"line-color":p?{type:"identity",property:"mlc"}:f.color,"line-width":c?{type:"identity",property:"mlw"}:f.width,"line-opacity":L}),u.layout.visibility="visible",s.layout.visibility="visible",h.geojson={type:"FeatureCollection",features:l},n(a),h},convertOnSelect:n}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function a(s,h){return d.coerce(y,e,w,s,h)}var r=a("locations"),g=a("z"),u=a("geojson");d.isArrayOrTypedArray(r)&&r.length&&d.isArrayOrTypedArray(g)&&g.length&&(typeof u=="string"&&u!==""||d.isPlainObject(u))?(a("featureidkey"),e._length=Math.min(r.length,g.length),a("below"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),v(y,e,n,a,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(e,a)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("../choropleth/calc"),plot:m("./plot"),hoverPoints:m("../choropleth/hover"),eventData:m("../choropleth/event_data"),selectPoints:m("../choropleth/select"),styleOnSelect:function(d,v){v&&v[0].trace._glTrace.updateOnSelect(v)},getBelow:function(d,v){for(var w=v.getMapLayers(),y=w.length-2;y>=0;y--){var e=w[y].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var t=y+1;t<w.length;t++)if(typeof(e=w[t].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(m,G,W){var d=m("./convert").convert,v=m("./convert").convertOnSelect,w=m("../../plots/mapbox/constants").traceLayerPrefix;function y(t,n){this.type="choroplethmapbox",this.subplot=t,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",w+n+"-fill"],["line",w+n+"-line"]],this.below=null}var e=y.prototype;e.update=function(t){this._update(d(t)),t[0].trace._glTrace=this},e.updateOnSelect=function(t){this._update(v(t))},e._update=function(t){var n=this.subplot,a=this.layerList,r=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(t.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(t,r),this.below=r);for(var g=0;g<a.length;g++){var u=a[g],s=u[0],h=u[1],l=t[s];n.setOptions(h,"setLayoutProperty",l.layout),l.layout.visibility==="visible"&&n.setOptions(h,"setPaintProperty",l.paint)}},e._addLayers=function(t,n){for(var a=this.subplot,r=this.layerList,g=this.sourceId,u=0;u<r.length;u++){var s=r[u],h=s[0],l=t[h];a.addLayer({type:h,id:s[1],source:g,layout:l.layout,paint:l.paint},n)}},e._removeLayers=function(){for(var t=this.subplot.map,n=this.layerList,a=n.length-1;a>=0;a--)t.removeLayer(n[a][1])},e.dispose=function(){var t=this.subplot.map;this._removeLayers(),t.removeSource(this.sourceId)},G.exports=function(t,n){var a=n[0].trace,r=new y(t,a.uid),g=r.sourceId,u=d(n),s=r.below=t.belowLookup["trace-"+a.uid];return t.map.addSource(g,{type:"geojson",data:u.geojson}),r._addLayers(u,s),n[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:w({editType:"calc"},{keys:["norm"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:t({},e.showlegend,{dflt:!1})};t(n,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){n[a]=y[a]}),n.hoverinfo=t({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,G.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(m,G,W){var d=m("../../components/colorscale/calc");G.exports=function(v,w){for(var y=w.u,e=w.v,t=w.w,n=Math.min(w.x.length,w.y.length,w.z.length,y.length,e.length,t.length),a=-1/0,r=1/0,g=0;g<n;g++){var u=y[g],s=e[g],h=t[g],l=Math.sqrt(u*u+s*s+h*h);a=Math.max(a,l),r=Math.min(r,l)}w._len=n,w._normMax=a,d(v,w,{vals:[r,a],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(m,G,W){var d=m("../../../stackgl_modules").gl_cone3d,v=m("../../../stackgl_modules").gl_cone3d.createConeMesh,w=m("../../lib").simpleMap,y=m("../../lib/gl_format_color").parseColorScale,e=m("../../components/colorscale").extractOpts,t=m("../../plots/gl3d/zip3");function n(h,l){this.scene=h,this.uid=l,this.mesh=null,this.data=null}var a=n.prototype;a.handlePick=function(h){if(h.object===this.mesh){var l=h.index=h.data.index,o=this.data.x[l],p=this.data.y[l],c=this.data.z[l],i=this.data.u[l],x=this.data.v[l],f=this.data.w[l];h.traceCoordinate=[o,p,c,i,x,f,Math.sqrt(i*i+x*x+f*f)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[l]!==void 0?h.textLabel=_[l]:_&&(h.textLabel=_),!0}};var r={xaxis:0,yaxis:1,zaxis:2},g={tip:1,tail:0,cm:.25,center:.5},u={tip:1,tail:1,cm:.75,center:.5};function s(h,l){var o=h.fullSceneLayout,p=h.dataScale,c={};function i(b,T){var k=o[T],L=p[r[T]];return w(b,function(A){return k.d2l(A)*L})}c.vectors=t(i(l.u,"xaxis"),i(l.v,"yaxis"),i(l.w,"zaxis"),l._len),c.positions=t(i(l.x,"xaxis"),i(l.y,"yaxis"),i(l.z,"zaxis"),l._len);var x=e(l);c.colormap=y(l),c.vertexIntensityBounds=[x.min/l._normMax,x.max/l._normMax],c.coneOffset=g[l.anchor],l.sizemode==="scaled"?c.coneSize=l.sizeref||.5:c.coneSize=l.sizeref&&l._normMax?l.sizeref/l._normMax:.5;var f=d(c),_=l.lightposition;return f.lightPosition=[_.x,_.y,_.z],f.ambient=l.lighting.ambient,f.diffuse=l.lighting.diffuse,f.specular=l.lighting.specular,f.roughness=l.lighting.roughness,f.fresnel=l.lighting.fresnel,f.opacity=l.opacity,l._pad=u[l.anchor]*f.vectorScale*f.coneScale*l._normMax,f}a.update=function(h){this.data=h;var l=s(this.scene,h);this.mesh.update(l)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(h,l){var o=h.glplot.gl,p=s(h,l),c=v(o,p),i=new n(h,l.uid);return i.mesh=c,i.data=l,c._trace=i,h.glplot.add(c),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function a(o,p){return d.coerce(y,e,w,o,p)}var r=a("u"),g=a("v"),u=a("w"),s=a("x"),h=a("y"),l=a("z");r&&r.length&&g&&g.length&&u&&u.length&&s&&s.length&&h&&h.length&&l&&l.length?(a("sizeref"),a("sizemode"),a("anchor"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),v(y,e,n,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(m,G,W){G.exports={moduleType:"trace",name:"cone",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:m("./calc"),plot:m("./convert"),eventData:function(d,v){return d.norm=v.traceCoordinate[6],d},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(m,G,W){var d=m("../heatmap/attributes"),v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes"),y=w.axisHoverFormat,e=w.descriptionOnlyNumbers,t=m("../../components/colorscale/attributes"),n=m("../../components/drawing/attributes").dash,a=m("../../plots/font_attributes"),r=m("../../lib/extend").extendFlat,g=m("../../constants/filter_ops"),u=g.COMPARISON_OPS2,s=g.INTERVAL_OPS,h=v.line;G.exports=r({z:d.z,x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,text:d.text,hovertext:d.hovertext,transpose:d.transpose,xtype:d.xtype,ytype:d.ytype,xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:d.hovertemplate,texttemplate:r({},d.texttemplate,{}),textfont:r({},d.textfont,{}),hoverongaps:d.hoverongaps,connectgaps:r({},d.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(u).concat(s),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r({},h.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:r({},h.smoothing,{}),editType:"plot"}},t("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(m,G,W){var d=m("../../components/colorscale"),v=m("../heatmap/calc"),w=m("./set_contours"),y=m("./end_plus");G.exports=function(e,t){var n=v(e,t),a=n[0].z;w(t,a);var r,g=t.contours,u=d.extractOpts(t);if(g.coloring==="heatmap"&&u.auto&&t.autocontour===!1){var s=g.start,h=y(g),l=g.size||1,o=Math.floor((h-s)/l)+1;isFinite(l)||(l=1,o=1);var p=s-l/2;r=[p,p+o*l]}else r=a;return d.calc(e,t,{vals:r,cLetter:"z"}),n}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(m,G,W){G.exports=function(d,v){var w,y=d[0],e=y.z;switch(v.type){case"levels":var t=Math.min(e[0][0],e[0][1]);for(w=0;w<d.length;w++){var n=d[w];n.prefixBoundary=!n.edgepaths.length&&(t>n.level||n.starts.length&&t===n.level)}break;case"constraint":if(y.prefixBoundary=!1,y.edgepaths.length)return;var a=y.x.length,r=y.y.length,g=-1/0,u=1/0;for(w=0;w<r;w++)u=Math.min(u,e[w][0]),u=Math.min(u,e[w][a-1]),g=Math.max(g,e[w][0]),g=Math.max(g,e[w][a-1]);for(w=1;w<a-1;w++)u=Math.min(u,e[0][w]),u=Math.min(u,e[r-1][w]),g=Math.max(g,e[0][w]),g=Math.max(g,e[r-1][w]);var s,h,l=v.value;switch(v._operation){case">":l>g&&(y.prefixBoundary=!0);break;case"<":(l<u||y.starts.length&&l===u)&&(y.prefixBoundary=!0);break;case"[]":s=Math.min(l[0],l[1]),((h=Math.max(l[0],l[1]))<u||s>g||y.starts.length&&h===u)&&(y.prefixBoundary=!0);break;case"][":s=Math.min(l[0],l[1]),h=Math.max(l[0],l[1]),s<u&&h>g&&(y.prefixBoundary=!0)}}}},{}],747:[function(m,G,W){var d=m("../../components/colorscale"),v=m("./make_color_map"),w=m("./end_plus");G.exports={min:"zmin",max:"zmax",calc:function(y,e,t){var n=e.contours,a=e.line,r=n.size||1,g=n.coloring,u=v(e,{isColorbar:!0});if(g==="heatmap"){var s=d.extractOpts(e);t._fillgradient=s.reversescale?d.flipScale(s.colorscale):s.colorscale,t._zrange=[s.min,s.max]}else g==="fill"&&(t._fillcolor=u);t._line={color:g==="lines"?u:a.color,width:n.showlines!==!1?a.width:0,dash:a.dash},t._levels={start:n.start,end:w(n),size:r}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(m,G,W){G.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(m,G,W){var d=m("fast-isnumeric"),v=m("./label_defaults"),w=m("../../components/color"),y=w.addOpacity,e=w.opacity,t=m("../../constants/filter_ops"),n=t.CONSTRAINT_REDUCTION,a=t.COMPARISON_OPS2;G.exports=function(r,g,u,s,h,l){var o,p,c,i=g.contours,x=u("contours.operation");i._operation=n[x],function(f,_){var b;a.indexOf(_.operation)===-1?(f("contours.value",[0,1]),Array.isArray(_.value)?_.value.length>2?_.value=_.value.slice(2):_.length===0?_.value=[0,1]:_.length<2?(b=parseFloat(_.value[0]),_.value=[b,b+1]):_.value=[parseFloat(_.value[0]),parseFloat(_.value[1])]:d(_.value)&&(b=parseFloat(_.value),_.value=[b,b+1])):(f("contours.value",0),d(_.value)||(Array.isArray(_.value)?_.value=parseFloat(_.value[0]):_.value=0))}(u,i),x==="="?o=i.showlines=!0:(o=u("contours.showlines"),c=u("fillcolor",y((r.line||{}).color||h,.5))),o&&(p=u("line.color",c&&e(c)?y(g.fillcolor,1):h),u("line.width",2),u("line.dash")),u("line.smoothing"),v(u,s,p,l)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(m,G,W){var d=m("../../constants/filter_ops"),v=m("fast-isnumeric");function w(t,n){var a,r=Array.isArray(n);function g(u){return v(u)?+u:null}return d.COMPARISON_OPS2.indexOf(t)!==-1?a=g(r?n[0]:n):d.INTERVAL_OPS.indexOf(t)!==-1?a=r?[g(n[0]),g(n[1])]:[g(n),g(n)]:d.SET_OPS.indexOf(t)!==-1&&(a=r?n.map(g):[g(n)]),a}function y(t){return function(n){n=w(t,n);var a=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return{start:a,end:r,size:r-a}}}function e(t){return function(n){return{start:n=w(t,n),end:1/0,size:1/0}}}G.exports={"[]":y("[]"),"][":y("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(m,G,W){G.exports=function(d,v,w,y){var e=y("contours.start"),t=y("contours.end"),n=e===!1||t===!1,a=w("contours.size");!(n?v.autocontour=!0:w("autocontour",!1))&&a||w("ncontours")}},{}],752:[function(m,G,W){var d=m("../../lib");function v(w){return d.extendFlat({},w,{edgepaths:d.extendDeep([],w.edgepaths),paths:d.extendDeep([],w.paths),starts:d.extendDeep([],w.starts)})}G.exports=function(w,y){var e,t,n,a=function(u){return u.reverse()},r=function(u){return u};switch(y){case"=":case"<":return w;case">":for(w.length!==1&&d.warn("Contour data invalid for the specified inequality operation."),t=w[0],e=0;e<t.edgepaths.length;e++)t.edgepaths[e]=a(t.edgepaths[e]);for(e=0;e<t.paths.length;e++)t.paths[e]=a(t.paths[e]);for(e=0;e<t.starts.length;e++)t.starts[e]=a(t.starts[e]);return w;case"][":var g=a;a=r,r=g;case"[]":for(w.length!==2&&d.warn("Contour data invalid for the specified inequality range operation."),t=v(w[0]),n=v(w[1]),e=0;e<t.edgepaths.length;e++)t.edgepaths[e]=a(t.edgepaths[e]);for(e=0;e<t.paths.length;e++)t.paths[e]=a(t.paths[e]);for(e=0;e<t.starts.length;e++)t.starts[e]=a(t.starts[e]);for(;n.edgepaths.length;)t.edgepaths.push(r(n.edgepaths.shift()));for(;n.paths.length;)t.paths.push(r(n.paths.shift()));for(;n.starts.length;)t.starts.push(r(n.starts.shift()));return[t]}}},{"../../lib":515}],753:[function(m,G,W){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("../scatter/period_defaults"),y=m("./constraint_defaults"),e=m("./contours_defaults"),t=m("./style_defaults"),n=m("../heatmap/label_defaults"),a=m("./attributes");G.exports=function(r,g,u,s){function h(o,p){return d.coerce(r,g,a,o,p)}if(v(r,g,h,s)){w(r,g,s,h),h("xhoverformat"),h("yhoverformat"),h("text"),h("hovertext"),h("hoverongaps"),h("hovertemplate");var l=h("contours.type")==="constraint";h("connectgaps",d.isArray1D(g.z)),l?y(r,g,h,s,u):(e(r,g,h,function(o){return d.coerce2(r,g,a,o)}),t(r,g,h,s)),g.contours&&g.contours.coloring==="heatmap"&&n(h,s)}else g.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(m,G,W){var d=m("../../lib"),v=m("./constraint_mapping"),w=m("./end_plus");G.exports=function(y,e,t){for(var n=y.type==="constraint"?v[y._operation](y.value):y,a=n.size,r=[],g=w(n),u=t.trace._carpetTrace,s=u?{xaxis:u.aaxis,yaxis:u.baxis,x:t.a,y:t.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:t.x,y:t.y},h=n.start;h<g;h+=a)if(r.push(d.extendFlat({level:h,crossings:{},starts:[],edgepaths:[],paths:[],z:t.z,smoothing:t.trace.line.smoothing},s)),r.length>1e3){d.warn("Too many contours, clipping at 1000",y);break}return r}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(m,G,W){G.exports=function(d){return d.end+d.size/1e6}},{}],756:[function(m,G,W){var d=m("../../lib"),v=m("./constants");function w(t,n,a,r){return Math.abs(t[0]-n[0])<a&&Math.abs(t[1]-n[1])<r}function y(t,n,a,r,g){var u,s=n.join(","),h=t.crossings[s],l=function(X,J,ee){var re=0,se=0;return X>20&&J?X===208||X===1114?re=ee[0]===0?1:-1:se=ee[1]===0?1:-1:v.BOTTOMSTART.indexOf(X)!==-1?se=1:v.LEFTSTART.indexOf(X)!==-1?re=1:v.TOPSTART.indexOf(X)!==-1?se=-1:re=-1,[re,se]}(h,a,n),o=[e(t,n,[-l[0],-l[1]])],p=t.z.length,c=t.z[0].length,i=n.slice(),x=l.slice();for(u=0;u<1e4;u++){if(h>20?(h=v.CHOOSESADDLE[h][(l[0]||l[1])<0?0:1],t.crossings[s]=v.SADDLEREMAINDER[h]):delete t.crossings[s],!(l=v.NEWDELTA[h])){d.log("Found bad marching index:",h,n,t.level);break}o.push(e(t,n,l)),n[0]+=l[0],n[1]+=l[1],s=n.join(","),w(o[o.length-1],o[o.length-2],r,g)&&o.pop();var f=l[0]&&(n[0]<0||n[0]>c-2)||l[1]&&(n[1]<0||n[1]>p-2);if(n[0]===i[0]&&n[1]===i[1]&&l[0]===x[0]&&l[1]===x[1]||a&&f)break;h=t.crossings[s]}u===1e4&&d.log("Infinite loop in contour?");var _,b,T,k,L,A,I,P,S,E,z,D,j,V,Z,Q=w(o[0],o[o.length-1],r,g),K=0,$=.2*t.smoothing,ne=[],H=0;for(u=1;u<o.length;u++)D=o[u],j=o[u-1],V=void 0,Z=void 0,V=D[2]-j[2],Z=D[3]-j[3],K+=I=Math.sqrt(V*V+Z*Z),ne.push(I);var N=K/ne.length*$;function U(X){return o[X%o.length]}for(u=o.length-2;u>=H;u--)if((_=ne[u])<N){for(T=0,b=u-1;b>=H&&_+ne[b]<N;b--)_+=ne[b];if(Q&&u===o.length-2)for(T=0;T<b&&_+ne[T]<N;T++)_+=ne[T];L=u-b+T+1,A=Math.floor((u+b+T+2)/2),k=Q||u!==o.length-2?Q||b!==-1?L%2?U(A):[(U(A)[0]+U(A+1)[0])/2,(U(A)[1]+U(A+1)[1])/2]:o[0]:o[o.length-1],o.splice(b+1,u-b+1,k),u=b+1,T&&(H=T),Q&&(u===o.length-2?o[T]=o[o.length-1]:u===0&&(o[o.length-1]=o[0]))}for(o.splice(0,H),u=0;u<o.length;u++)o[u].length=2;if(!(o.length<2))if(Q)o.pop(),t.paths.push(o);else{a||d.log("Unclosed interior contour?",t.level,i.join(","),o.join("L"));var te=!1;for(P=0;P<t.edgepaths.length;P++)if(E=t.edgepaths[P],!te&&w(E[0],o[o.length-1],r,g)){o.pop(),te=!0;var B=!1;for(S=0;S<t.edgepaths.length;S++)if(w((z=t.edgepaths[S])[z.length-1],o[0],r,g)){B=!0,o.shift(),t.edgepaths.splice(P,1),S===P?t.paths.push(o.concat(z)):(S>P&&S--,t.edgepaths[S]=z.concat(o,E));break}B||(t.edgepaths[P]=o.concat(E))}for(P=0;P<t.edgepaths.length&&!te;P++)w((E=t.edgepaths[P])[E.length-1],o[0],r,g)&&(o.shift(),t.edgepaths[P]=E.concat(o),te=!0);te||t.edgepaths.push(o)}}function e(t,n,a){var r=n[0]+Math.max(a[0],0),g=n[1]+Math.max(a[1],0),u=t.z[g][r],s=t.xaxis,h=t.yaxis;if(a[1]){var l=(t.level-u)/(t.z[g][r+1]-u),o=(l!==1?(1-l)*s.c2l(t.x[r]):0)+(l!==0?l*s.c2l(t.x[r+1]):0);return[s.c2p(s.l2c(o),!0),h.c2p(t.y[g],!0),r+l,g]}var p=(t.level-u)/(t.z[g+1][r]-u),c=(p!==1?(1-p)*h.c2l(t.y[g]):0)+(p!==0?p*h.c2l(t.y[g+1]):0);return[s.c2p(t.x[r],!0),h.c2p(h.l2c(c),!0),r,g+p]}G.exports=function(t,n,a){var r,g,u,s;for(n=n||.01,a=a||.01,g=0;g<t.length;g++){for(u=t[g],s=0;s<u.starts.length;s++)y(u,u.starts[s],"edge",n,a);for(r=0;Object.keys(u.crossings).length&&r<1e4;)r++,y(u,Object.keys(u.crossings)[0].split(",").map(Number),void 0,n,a);r===1e4&&d.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(m,G,W){var d=m("../../components/color"),v=m("../heatmap/hover");G.exports=function(w,y,e,t,n){n||(n={}),n.isContour=!0;var a=v(w,y,e,t,n);return a&&a.forEach(function(r){var g=r.trace;g.contours.type==="constraint"&&(g.fillcolor&&d.opacity(g.fillcolor)?r.color=d.addOpacity(g.fillcolor,1):g.contours.showlines&&d.opacity(g.line.color)&&(r.color=d.addOpacity(g.line.color,1)))}),a}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot").plot,style:m("./style"),colorbar:m("./colorbar"),hoverPoints:m("./hover"),moduleType:"trace",name:"contour",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w,y,e){if(e||(e={}),v("contours.showlabels")){var t=w.font;d.coerceFont(v,"contours.labelfont",{family:t.family,size:t.size,color:y}),v("contours.labelformat")}e.hasHover!==!1&&v("zhoverformat")}},{"../../lib":515}],760:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/colorscale"),w=m("./end_plus");G.exports=function(y){var e=y.contours,t=e.start,n=w(e),a=e.size||1,r=Math.floor((n-t)/a)+1,g=e.coloring==="lines"?0:1,u=v.extractOpts(y);isFinite(a)||(a=1,r=1);var s,h,l=u.reversescale?v.flipScale(u.colorscale):u.colorscale,o=l.length,p=new Array(o),c=new Array(o);if(e.coloring==="heatmap"){var i=u.min,x=u.max;for(h=0;h<o;h++)s=l[h],p[h]=s[0]*(x-i)+i,c[h]=s[1];var f=d.extent([i,x,e.start,e.start+a*(r-1)]),_=f[i<x?0:1],b=f[i<x?1:0];_!==i&&(p.splice(0,0,_),c.splice(0,0,c[0])),b!==x&&(p.push(b),c.push(c[c.length-1]))}else for(h=0;h<o;h++)s=l[h],p[h]=(s[0]*(r+g-1)-g/2)*a+t,c[h]=s[1];return v.makeColorScaleFunc({domain:p,range:c},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(m,G,W){var d=m("./constants");function v(w,y){var e=(y[0][0]>w?0:1)+(y[0][1]>w?0:2)+(y[1][1]>w?0:4)+(y[1][0]>w?0:8);return e===5||e===10?w>(y[0][0]+y[0][1]+y[1][0]+y[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}G.exports=function(w){var y,e,t,n,a,r,g,u,s,h=w[0].z,l=h.length,o=h[0].length,p=l===2||o===2;for(e=0;e<l-1;e++)for(n=[],e===0&&(n=n.concat(d.BOTTOMSTART)),e===l-2&&(n=n.concat(d.TOPSTART)),y=0;y<o-1;y++)for(t=n.slice(),y===0&&(t=t.concat(d.LEFTSTART)),y===o-2&&(t=t.concat(d.RIGHTSTART)),a=y+","+e,r=[[h[e][y],h[e][y+1]],[h[e+1][y],h[e+1][y+1]]],s=0;s<w.length;s++)(g=v((u=w[s]).level,r))&&(u.crossings[a]=g,t.indexOf(g)!==-1&&(u.starts.push([y,e]),p&&t.indexOf(g,t.indexOf(g)+1)!==-1&&u.starts.push([y,e])))}},{"./constants":748}],762:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../components/colorscale"),e=m("../../lib/svg_text_utils"),t=m("../../plots/cartesian/axes"),n=m("../../plots/cartesian/set_convert"),a=m("../heatmap/plot"),r=m("./make_crossings"),g=m("./find_all_paths"),u=m("./empty_pathinfo"),s=m("./convert_to_constraints"),h=m("./close_boundaries"),l=m("./constants"),o=l.LABELOPTIMIZER;function p(x,f){var _,b,T,k,L,A,I,P="",S=0,E=x.edgepaths.map(function(Q,K){return K}),z=!0;function D(Q){return Math.abs(Q[1]-f[2][1])<.01}function j(Q){return Math.abs(Q[0]-f[0][0])<.01}function V(Q){return Math.abs(Q[0]-f[2][0])<.01}for(;E.length;){for(A=w.smoothopen(x.edgepaths[S],x.smoothing),P+=z?A:A.replace(/^M/,"L"),E.splice(E.indexOf(S),1),_=x.edgepaths[S][x.edgepaths[S].length-1],k=-1,T=0;T<4;T++){if(!_){v.log("Missing end?",S,x);break}for(I=_,Math.abs(I[1]-f[0][1])<.01&&!V(_)?b=f[1]:j(_)?b=f[0]:D(_)?b=f[3]:V(_)&&(b=f[2]),L=0;L<x.edgepaths.length;L++){var Z=x.edgepaths[L][0];Math.abs(_[0]-b[0])<.01?Math.abs(_[0]-Z[0])<.01&&(Z[1]-_[1])*(b[1]-Z[1])>=0&&(b=Z,k=L):Math.abs(_[1]-b[1])<.01?Math.abs(_[1]-Z[1])<.01&&(Z[0]-_[0])*(b[0]-Z[0])>=0&&(b=Z,k=L):v.log("endpt to newendpt is not vert. or horz.",_,b,Z)}if(_=b,k>=0)break;P+="L"+b}if(k===x.edgepaths.length){v.log("unclosed perimeter path");break}S=k,(z=E.indexOf(S)===-1)&&(S=E[0],P+="Z")}for(S=0;S<x.paths.length;S++)P+=w.smoothclosed(x.paths[S],x.smoothing);return P}function c(x,f,_,b){var T=f.width/2,k=f.height/2,L=x.x,A=x.y,I=x.theta,P=Math.cos(I)*T,S=Math.sin(I)*T,E=(L>b.center?b.right-L:L-b.left)/(P+Math.abs(Math.sin(I)*k)),z=(A>b.middle?b.bottom-A:A-b.top)/(Math.abs(S)+Math.cos(I)*k);if(E<1||z<1)return 1/0;var D=o.EDGECOST*(1/(E-1)+1/(z-1));D+=o.ANGLECOST*I*I;for(var j=L-P,V=A-S,Z=L+P,Q=A+S,K=0;K<_.length;K++){var $=_[K],ne=Math.cos($.theta)*$.width/2,H=Math.sin($.theta)*$.width/2,N=2*v.segmentDistance(j,V,Z,Q,$.x-ne,$.y-H,$.x+ne,$.y+H)/(f.height+$.height),U=$.level===f.level,te=U?o.SAMELEVELDISTANCE:1;if(N<=te)return 1/0;D+=o.NEIGHBORCOST*(U?o.SAMELEVELFACTOR:1)/(N-te)}return D}function i(x){var f,_,b=x.trace._emptypoints,T=[],k=x.z.length,L=x.z[0].length,A=[];for(f=0;f<L;f++)A.push(1);for(f=0;f<k;f++)T.push(A.slice());for(f=0;f<b.length;f++)T[(_=b[f])[0]][_[1]]=0;return x.zmask=T,T}W.plot=function(x,f,_,b){var T=f.xaxis,k=f.yaxis;v.makeTraceGroups(b,_,"contour").each(function(L){var A=d.select(this),I=L[0],P=I.trace,S=I.x,E=I.y,z=P.contours,D=u(z,f,I),j=v.ensureSingle(A,"g","heatmapcoloring"),V=[];z.coloring==="heatmap"&&(V=[L]),a(x,f,V,j),r(D),g(D);var Z=T.c2p(S[0],!0),Q=T.c2p(S[S.length-1],!0),K=k.c2p(E[0],!0),$=k.c2p(E[E.length-1],!0),ne=[[Z,$],[Q,$],[Q,K],[Z,K]],H=D;z.type==="constraint"&&(H=s(D,z._operation)),function(N,U,te){var B=v.ensureSingle(N,"g","contourbg").selectAll("path").data(te.coloring==="fill"?[0]:[]);B.enter().append("path"),B.exit().remove(),B.attr("d","M"+U.join("L")+"Z").style("stroke","none")}(A,ne,z),function(N,U,te,B){var X=B.coloring==="fill"||B.type==="constraint"&&B._operation!=="=",J="M"+te.join("L")+"Z";X&&h(U,B);var ee=v.ensureSingle(N,"g","contourfill").selectAll("path").data(X?U:[]);ee.enter().append("path"),ee.exit().remove(),ee.each(function(re){var se=(re.prefixBoundary?J:"")+p(re,te);se?d.select(this).attr("d",se).style("stroke","none"):d.select(this).remove()})}(A,H,ne,z),function(N,U,te,B,X){var J=v.ensureSingle(N,"g","contourlines"),ee=X.showlines!==!1,re=X.showlabels,se=ee&&re,oe=W.createLines(J,ee||re,U),de=W.createLineClip(J,se,te,B.trace.uid),ce=N.selectAll("g.contourlabels").data(re?[0]:[]);if(ce.exit().remove(),ce.enter().append("g").classed("contourlabels",!0),re){var ve=[],Ae=[];v.clearLocationCache();var fe=W.labelFormatter(te,B),me=w.tester.append("text").attr("data-notex",1).call(w.font,X.labelfont),_e=U[0].xaxis,le=U[0].yaxis,ge=_e._length,Te=le._length,Se=_e.range,Me=le.range,ze=v.aggNums(Math.min,null,B.x),Oe=v.aggNums(Math.max,null,B.x),De=v.aggNums(Math.min,null,B.y),Xe=v.aggNums(Math.max,null,B.y),Be=Math.max(_e.c2p(ze,!0),0),Ie=Math.min(_e.c2p(Oe,!0),ge),Re=Math.max(le.c2p(Xe,!0),0),Ye=Math.min(le.c2p(De,!0),Te),Qe={};Se[0]<Se[1]?(Qe.left=Be,Qe.right=Ie):(Qe.left=Ie,Qe.right=Be),Me[0]<Me[1]?(Qe.top=Re,Qe.bottom=Ye):(Qe.top=Ye,Qe.bottom=Re),Qe.middle=(Qe.top+Qe.bottom)/2,Qe.center=(Qe.left+Qe.right)/2,ve.push([[Qe.left,Qe.top],[Qe.right,Qe.top],[Qe.right,Qe.bottom],[Qe.left,Qe.bottom]]);var lt=Math.sqrt(ge*ge+Te*Te),xt=l.LABELDISTANCE*lt/Math.max(1,U.length/l.LABELINCREASE);oe.each(function(wt){var bt=W.calcTextOpts(wt.level,fe,me,te);d.select(this).selectAll("path").each(function(){var nt=v.getVisibleSegment(this,Qe,bt.height/2);if(nt&&!(nt.len<(bt.width+bt.height)*l.LABELMIN))for(var $e=Math.min(Math.ceil(nt.len/xt),l.LABELMAX),vt=0;vt<$e;vt++){var Nt=W.findBestTextLocation(this,nt,bt,Ae,Qe);if(!Nt)break;W.addLabelData(Nt,bt,Ae,ve)}})}),me.remove(),W.drawLabels(ce,Ae,te,de,se?ve:null)}re&&!ee&&oe.remove()}(A,D,x,I,z),function(N,U,te,B,X){var J=B.trace,ee=te._fullLayout._clips,re="clip"+J.uid,se=ee.selectAll("#"+re).data(J.connectgaps?[]:[0]);if(se.enter().append("clipPath").classed("contourclip",!0).attr("id",re),se.exit().remove(),J.connectgaps===!1){var oe={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:U.xaxis,yaxis:U.yaxis,x:B.x,y:B.y,z:i(B),smoothing:0};r([oe]),g([oe]),h([oe],{type:"levels"}),v.ensureSingle(se,"path","").attr("d",(oe.prefixBoundary?"M"+X.join("L")+"Z":"")+p(oe,X))}else re=null;w.setClipUrl(N,re,te)}(A,f,x,I,ne)})},W.createLines=function(x,f,_){var b=_[0].smoothing,T=x.selectAll("g.contourlevel").data(f?_:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlevel",!0),f){var k=T.selectAll("path.openline").data(function(A){return A.pedgepaths||A.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(A){return w.smoothopen(A,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=T.selectAll("path.closedline").data(function(A){return A.ppaths||A.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(A){return w.smoothclosed(A,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return T},W.createLineClip=function(x,f,_,b){var T=f?"clipline"+b:null,k=_._fullLayout._clips.selectAll("#"+T).data(f?[0]:[]);return k.exit().remove(),k.enter().append("clipPath").classed("contourlineclip",!0).attr("id",T),w.setClipUrl(x,T,_),k},W.labelFormatter=function(x,f){var _=x._fullLayout,b=f.trace,T=b.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(T.labelformat)k.tickformat=T.labelformat,n(k,_);else{var L=y.extractOpts(b);if(L&&L.colorbar&&L.colorbar._axis)k=L.colorbar._axis;else{if(T.type==="constraint"){var A=T.value;Array.isArray(A)?k.range=[A[0],A[A.length-1]]:k.range=[A,A]}else k.range=[T.start,T.end],k.nticks=(T.end-T.start)/T.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,_),t.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return t.tickText(k,I).text}},W.calcTextOpts=function(x,f,_,b){var T=f(x);_.text(T).call(e.convertToTspans,b);var k=_.node(),L=w.bBox(k,!0);return{text:T,width:L.width,height:L.height,fontSize:+k.style["font-size"].replace("px",""),level:x,dy:(L.top+L.bottom)/2}},W.findBestTextLocation=function(x,f,_,b,T){var k,L,A,I,P,S=_.width;f.isClosed?(L=f.len/o.INITIALSEARCHPOINTS,k=f.min+L/2,A=f.max):(L=(f.len-S)/(o.INITIALSEARCHPOINTS+1),k=f.min+L+S/2,A=f.max-(L+S)/2);for(var E=1/0,z=0;z<o.ITERATIONS;z++){for(var D=k;D<A;D+=L){var j=v.getTextLocation(x,f.total,D,S),V=c(j,_,b,T);V<E&&(E=V,P=j,I=D)}if(E>2*o.MAXCOST)break;z&&(L/=2),A=(k=I-L/2)+1.5*L}if(E<=o.MAXCOST)return P},W.addLabelData=function(x,f,_,b){var T=f.fontSize,k=f.width+T/3,L=Math.max(0,f.height-T/3),A=x.x,I=x.y,P=x.theta,S=Math.sin(P),E=Math.cos(P),z=function(j,V){return[A+j*E-V*S,I+j*S+V*E]},D=[z(-k/2,-L/2),z(-k/2,L/2),z(k/2,L/2),z(k/2,-L/2)];_.push({text:f.text,x:A,y:I,dy:f.dy,theta:P,level:f.level,width:k,height:L}),b.push(D)},W.drawLabels=function(x,f,_,b,T){var k=x.selectAll("text").data(f,function(I){return I.text+","+I.x+","+I.y+","+I.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(I){var P=I.x+Math.sin(I.theta)*I.dy,S=I.y-Math.cos(I.theta)*I.dy;d.select(this).text(I.text).attr({x:P,y:S,transform:"rotate("+180*I.theta/Math.PI+" "+P+" "+S+")"}).call(e.convertToTspans,_)}),T){for(var L="",A=0;A<T.length;A++)L+="M"+T[A].join("L")+"Z";v.ensureSingle(b,"path","").attr("d",L)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib");function w(y,e,t){var n={type:"linear",range:[y,e]};return d.autoTicks(n,(e-y)/(t||15)),n}G.exports=function(y,e){var t=y.contours;if(y.autocontour){var n=y.zmin,a=y.zmax;(y.zauto||n===void 0)&&(n=v.aggNums(Math.min,null,e)),(y.zauto||a===void 0)&&(a=v.aggNums(Math.max,null,e));var r=w(n,a,y.ncontours);t.size=r.dtick,t.start=d.tickFirst(r),r.range.reverse(),t.end=d.tickFirst(r),t.start===n&&(t.start+=t.size),t.end===a&&(t.end-=t.size),t.start>t.end&&(t.start=t.end=(t.start+t.end)/2),y._input.contours||(y._input.contours={}),v.extendFlat(y._input.contours,{start:t.start,end:t.end,size:t.size}),y._input.autocontour=!0}else if(t.type!=="constraint"){var g,u=t.start,s=t.end,h=y._input.contours;u>s&&(t.start=h.start=s,s=t.end=h.end=u,u=t.start),!(t.size>0)&&(g=u===s?1:w(u,s,y.ncontours).dtick,h.size=t.size=g)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../heatmap/style"),y=m("./make_color_map");G.exports=function(e){var t=d.select(e).selectAll("g.contour");t.style("opacity",function(n){return n[0].trace.opacity}),t.each(function(n){var a=d.select(this),r=n[0].trace,g=r.contours,u=r.line,s=g.size||1,h=g.start,l=g.type==="constraint",o=!l&&g.coloring==="lines",p=!l&&g.coloring==="fill",c=o||p?y(r):null;a.selectAll("g.contourlevel").each(function(f){d.select(this).selectAll("path").call(v.lineGroupStyle,u.width,o?c(f.level):u.color,u.dash)});var i=g.labelfont;if(a.selectAll("g.contourlabels text").each(function(f){v.font(d.select(this),{family:i.family,size:i.size,color:i.color||(o?c(f.level):u.color)})}),l)a.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(p){var x;a.selectAll("g.contourfill path").style("fill",function(f){return x===void 0&&(x=f.level),c(f.level+.5*s)}),x===void 0&&(x=h),a.selectAll("g.contourbg path").style("fill",c(x-.5*s))}}),w(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(m,G,W){var d=m("../../components/colorscale/defaults"),v=m("./label_defaults");G.exports=function(w,y,e,t,n){var a,r=e("contours.coloring"),g="";r==="fill"&&(a=e("contours.showlines")),a!==!1&&(r!=="lines"&&(g=e("line.color","#000")),e("line.width",.5),e("line.dash")),r!=="none"&&(w.showlegend!==!0&&(y.showlegend=!1),y._dfltShowLegend=!1,d(w,y,t,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),v(e,t,g,n)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(m,G,W){var d=m("../heatmap/attributes"),v=m("../contour/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../lib/extend").extendFlat,e=v.contours;G.exports=y({carpet:{valType:"string",editType:"calc"},z:d.z,a:d.x,a0:d.x0,da:d.dx,b:d.y,b0:d.y0,db:d.dy,text:d.text,hovertext:d.hovertext,transpose:d.transpose,atype:d.xtype,btype:d.ytype,fillcolor:v.fillcolor,autocontour:v.autocontour,ncontours:v.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:v.line.color,width:v.line.width,dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},transforms:void 0},w("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(m,G,W){var d=m("../../components/colorscale/calc"),v=m("../../lib"),w=m("../heatmap/convert_column_xyz"),y=m("../heatmap/clean_2d_array"),e=m("../heatmap/interp2d"),t=m("../heatmap/find_empties"),n=m("../heatmap/make_bound_array"),a=m("./defaults"),r=m("../carpet/lookup_carpetid"),g=m("../contour/set_contours");G.exports=function(u,s){var h=s._carpetTrace=r(u,s);if(h&&h.visible&&h.visible!=="legendonly"){if(!s.a||!s.b){var l=u.data[h.index],o=u.data[s.index];o.a||(o.a=l.a),o.b||(o.b=l.b),a(o,s,s._defaultColor,u._fullLayout)}var p=function(c,i){var x,f,_,b,T,k,L,A=i._carpetTrace,I=A.aaxis,P=A.baxis;I._minDtick=0,P._minDtick=0,v.isArray1D(i.z)&&w(i,I,P,"a","b",["z"]),x=i._a=i._a||i.a,b=i._b=i._b||i.b,x=x?I.makeCalcdata(i,"_a"):[],b=b?P.makeCalcdata(i,"_b"):[],f=i.a0||0,_=i.da||1,T=i.b0||0,k=i.db||1,L=i._z=y(i._z||i.z,i.transpose),i._emptypoints=t(L),e(L,i._emptypoints);var S=v.maxRowLength(L),E=i.xtype==="scaled"?"":x,z=n(i,E,f,_,S,I),D=i.ytype==="scaled"?"":b,j=n(i,D,T,k,L.length,P),V={a:z,b:j,z:L};return i.contours.type==="levels"&&i.contours.coloring!=="none"&&d(c,i,{vals:L,containerStr:"",cLetter:"z"}),[V]}(u,s);return g(s,s._z),p}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(m,G,W){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("./attributes"),y=m("../contour/constraint_defaults"),e=m("../contour/contours_defaults"),t=m("../contour/style_defaults");G.exports=function(n,a,r,g){function u(s,h){return d.coerce(n,a,w,s,h)}if(u("carpet"),n.a&&n.b){if(!v(n,a,u,g,"a","b"))return void(a.visible=!1);u("text"),u("contours.type")==="constraint"?y(n,a,u,g,r,{hasHover:!1}):(e(n,a,u,function(s){return d.coerce2(n,a,w,s)}),t(n,a,u,g,{hasHover:!1}))}else a._defaultColor=r,a._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../contour/colorbar"),calc:m("./calc"),plot:m("./plot"),style:m("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(m,G,W){var d=m("@plotly/d3"),v=m("../carpet/map_1d_array"),w=m("../carpet/makepath"),y=m("../../components/drawing"),e=m("../../lib"),t=m("../contour/make_crossings"),n=m("../contour/find_all_paths"),a=m("../contour/plot"),r=m("../contour/constants"),g=m("../contour/convert_to_constraints"),u=m("../contour/empty_pathinfo"),s=m("../contour/close_boundaries"),h=m("../carpet/lookup_carpetid"),l=m("../carpet/axis_aligned_line");function o(i,x,f){var _=i.getPointAtLength(x),b=i.getPointAtLength(f),T=b.x-_.x,k=b.y-_.y,L=Math.sqrt(T*T+k*k);return[T/L,k/L]}function p(i){var x=Math.sqrt(i[0]*i[0]+i[1]*i[1]);return[i[0]/x,i[1]/x]}function c(i,x){var f=Math.abs(i[0]*x[0]+i[1]*x[1]);return Math.sqrt(1-f*f)/f}G.exports=function(i,x,f,_){var b=x.xaxis,T=x.yaxis;e.makeTraceGroups(_,f,"contour").each(function(k){var L=d.select(this),A=k[0],I=A.trace,P=I._carpetTrace=h(i,I),S=i.calcdata[P.index][0];if(P.visible&&P.visible!=="legendonly"){var E=A.a,z=A.b,D=I.contours,j=u(D,x,A),V=D.type==="constraint",Z=D._operation,Q=V?Z==="="?"lines":"fill":D.coloring,K=[[E[0],z[z.length-1]],[E[E.length-1],z[z.length-1]],[E[E.length-1],z[0]],[E[0],z[0]]];t(j);var $=1e-8*(E[E.length-1]-E[0]),ne=1e-8*(z[z.length-1]-z[0]);n(j,$,ne);var H,N,U,te,B=j;D.type==="constraint"&&(B=g(j,Z)),function(re,se){var oe,de,ce,ve,Ae,fe,me,_e,le;for(oe=0;oe<re.length;oe++){for(ve=re[oe],Ae=ve.pedgepaths=[],fe=ve.ppaths=[],de=0;de<ve.edgepaths.length;de++){for(le=ve.edgepaths[de],me=[],ce=0;ce<le.length;ce++)me[ce]=se(le[ce]);Ae.push(me)}for(de=0;de<ve.paths.length;de++){for(le=ve.paths[de],_e=[],ce=0;ce<le.length;ce++)_e[ce]=se(le[ce]);fe.push(_e)}}}(j,ee);var X=[];for(te=S.clipsegments.length-1;te>=0;te--)H=S.clipsegments[te],N=v([],H.x,b.c2p),U=v([],H.y,T.c2p),N.reverse(),U.reverse(),X.push(w(N,U,H.bicubic));var J="M"+X.join("L")+"Z";(function(re,se,oe,de,ce,ve){var Ae,fe,me,_e,le=e.ensureSingle(re,"g","contourbg").selectAll("path").data(ve!=="fill"||ce?[]:[0]);le.enter().append("path"),le.exit().remove();var ge=[];for(_e=0;_e<se.length;_e++)Ae=se[_e],fe=v([],Ae.x,oe.c2p),me=v([],Ae.y,de.c2p),ge.push(w(fe,me,Ae.bicubic));le.attr("d","M"+ge.join("L")+"Z").style("stroke","none")})(L,S.clipsegments,b,T,V,Q),function(re,se,oe,de,ce,ve,Ae,fe,me,_e,le){var ge=_e==="fill";ge&&s(ce,re.contours);var Te=e.ensureSingle(se,"g","contourfill").selectAll("path").data(ge?ce:[]);Te.enter().append("path"),Te.exit().remove(),Te.each(function(Se){var Me=(Se.prefixBoundary?le:"")+function(ze,Oe,De,Xe,Be,Ie,Re,Ye){var Qe,lt,xt,wt,bt,nt,$e,vt="",Nt=Oe.edgepaths.map(function(Ve,Ke){return Ke}),qt=!0,Jt=1e-4*Math.abs(De[0][0]-De[2][0]),Wt=1e-4*Math.abs(De[0][1]-De[2][1]);function ar(Ve){return Math.abs(Ve[1]-De[0][1])<Wt}function Dt(Ve){return Math.abs(Ve[1]-De[2][1])<Wt}function Ne(Ve){return Math.abs(Ve[0]-De[0][0])<Jt}function qe(Ve){return Math.abs(Ve[0]-De[2][0])<Jt}function pe(Ve,Ke){var Ge,ct,st,Mt,Ot="";for(ar(Ve)&&!qe(Ve)||Dt(Ve)&&!Ne(Ve)?(Mt=Be.aaxis,st=l(Be,Ie,[Ve[0],Ke[0]],.5*(Ve[1]+Ke[1]))):(Mt=Be.baxis,st=l(Be,Ie,.5*(Ve[0]+Ke[0]),[Ve[1],Ke[1]])),Ge=1;Ge<st.length;Ge++)for(Ot+=Mt.smoothing?"C":"L",ct=0;ct<st[Ge].length;ct++){var it=st[Ge][ct];Ot+=[Re.c2p(it[0]),Ye.c2p(it[1])]+" "}return Ot}for(Qe=0,lt=null;Nt.length;){var be=Oe.edgepaths[Qe][0];for(lt&&(vt+=pe(lt,be)),$e=y.smoothopen(Oe.edgepaths[Qe].map(Xe),Oe.smoothing),vt+=qt?$e:$e.replace(/^M/,"L"),Nt.splice(Nt.indexOf(Qe),1),lt=Oe.edgepaths[Qe][Oe.edgepaths[Qe].length-1],bt=-1,wt=0;wt<4;wt++){if(!lt){e.log("Missing end?",Qe,Oe);break}for(ar(lt)&&!qe(lt)?xt=De[1]:Ne(lt)?xt=De[0]:Dt(lt)?xt=De[3]:qe(lt)&&(xt=De[2]),nt=0;nt<Oe.edgepaths.length;nt++){var Fe=Oe.edgepaths[nt][0];Math.abs(lt[0]-xt[0])<Jt?Math.abs(lt[0]-Fe[0])<Jt&&(Fe[1]-lt[1])*(xt[1]-Fe[1])>=0&&(xt=Fe,bt=nt):Math.abs(lt[1]-xt[1])<Wt?Math.abs(lt[1]-Fe[1])<Wt&&(Fe[0]-lt[0])*(xt[0]-Fe[0])>=0&&(xt=Fe,bt=nt):e.log("endpt to newendpt is not vert. or horz.",lt,xt,Fe)}if(bt>=0)break;vt+=pe(lt,xt),lt=xt}if(bt===Oe.edgepaths.length){e.log("unclosed perimeter path");break}Qe=bt,(qt=Nt.indexOf(Qe)===-1)&&(Qe=Nt[0],vt+=pe(lt,xt)+"Z",lt=null)}for(Qe=0;Qe<Oe.paths.length;Qe++)vt+=y.smoothclosed(Oe.paths[Qe].map(Xe),Oe.smoothing);return vt}(0,Se,ve,Ae,fe,me,oe,de);Me?d.select(this).attr("d",Me).style("stroke","none"):d.select(this).remove()})}(I,L,b,T,B,K,ee,P,S,Q,J),function(re,se,oe,de,ce,ve,Ae){var fe=e.ensureSingle(re,"g","contourlines"),me=ce.showlines!==!1,_e=ce.showlabels,le=me&&_e,ge=a.createLines(fe,me||_e,se),Te=a.createLineClip(fe,le,oe,de.trace.uid),Se=re.selectAll("g.contourlabels").data(_e?[0]:[]);if(Se.exit().remove(),Se.enter().append("g").classed("contourlabels",!0),_e){var Me=ve.xaxis,ze=ve.yaxis,Oe=Me._length,De=ze._length,Xe=[[[0,0],[Oe,0],[Oe,De],[0,De]]],Be=[];e.clearLocationCache();var Ie=a.labelFormatter(oe,de),Re=y.tester.append("text").attr("data-notex",1).call(y.font,ce.labelfont),Ye={left:0,right:Oe,center:Oe/2,top:0,bottom:De,middle:De/2},Qe=Math.sqrt(Oe*Oe+De*De),lt=r.LABELDISTANCE*Qe/Math.max(1,se.length/r.LABELINCREASE);ge.each(function(xt){var wt=a.calcTextOpts(xt.level,Ie,Re,oe);d.select(this).selectAll("path").each(function(bt){var nt=e.getVisibleSegment(this,Ye,wt.height/2);if(nt&&(function(qt,Jt,Wt,ar,Dt,Ne){for(var qe,pe=0;pe<Wt.pedgepaths.length;pe++)Jt===Wt.pedgepaths[pe]&&(qe=Wt.edgepaths[pe]);if(!qe)return;var be=Dt.a[0],Fe=Dt.a[Dt.a.length-1],Ve=Dt.b[0],Ke=Dt.b[Dt.b.length-1];function Ge(it,ht){var jt,kt=0;return(Math.abs(it[0]-be)<.1||Math.abs(it[0]-Fe)<.1)&&(jt=p(Dt.dxydb_rough(it[0],it[1],.1)),kt=Math.max(kt,Ne*c(ht,jt)/2)),(Math.abs(it[1]-Ve)<.1||Math.abs(it[1]-Ke)<.1)&&(jt=p(Dt.dxyda_rough(it[0],it[1],.1)),kt=Math.max(kt,Ne*c(ht,jt)/2)),kt}var ct=o(qt,0,1),st=o(qt,ar.total,ar.total-1),Mt=Ge(qe[0],ct),Ot=ar.total-Ge(qe[qe.length-1],st);ar.min<Mt&&(ar.min=Mt),ar.max>Ot&&(ar.max=Ot),ar.len=ar.max-ar.min}(this,bt,xt,nt,Ae,wt.height),!(nt.len<(wt.width+wt.height)*r.LABELMIN)))for(var $e=Math.min(Math.ceil(nt.len/lt),r.LABELMAX),vt=0;vt<$e;vt++){var Nt=a.findBestTextLocation(this,nt,wt,Be,Ye);if(!Nt)break;a.addLabelData(Nt,wt,Be,Xe)}})}),Re.remove(),a.drawLabels(Se,Be,oe,Te,le?Xe:null)}_e&&!me&&ge.remove()}(L,j,i,A,D,x,P),y.setClipUrl(L,P._clipPathId,i)}function ee(re){var se=P.ab2xy(re[0],re[1],!0);return[b.c2p(se[0]),T.c2p(se[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../plots/attributes"),y=m("../scattermapbox/attributes"),e=m("../../lib/extend").extendFlat;G.exports=e({lon:y.lon,lat:y.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:y.text,hovertext:y.hovertext,hoverinfo:e({},w.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:v(),showlegend:e({},w.showlegend,{dflt:!1})},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib").isArrayOrTypedArray,w=m("../../constants/numerical").BADNUM,y=m("../../components/colorscale/calc"),e=m("../../lib")._;G.exports=function(t,n){for(var a=n._length,r=new Array(a),g=n.z,u=v(g)&&g.length,s=0;s<a;s++){var h=r[s]={},l=n.lon[s],o=n.lat[s];if(h.lonlat=d(l)&&d(o)?[+l,+o]:[w,w],u){var p=g[s];h.z=d(p)?p:w}}return y(t,n,{vals:u?g:[0,1],containerStr:"",cLetter:"z"}),a&&(r[0].t={labels:{lat:e(t,"lat:")+" ",lon:e(t,"lon:")+" "}}),r}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../components/color"),y=m("../../components/colorscale"),e=m("../../constants/numerical").BADNUM,t=m("../../lib/geojson_utils").makeBlank;G.exports=function(n){var a=n[0].trace,r=a.visible===!0&&a._length!==0,g=a._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:t()};if(!r)return g;var u,s=[],h=a.z,l=a.radius,o=v.isArrayOrTypedArray(h)&&h.length,p=v.isArrayOrTypedArray(l);for(u=0;u<n.length;u++){var c=n[u],i=c.lonlat;if(i[0]!==e){var x={};if(o){var f=c.z;x.z=f!==e?f:0}p&&(x.r=d(l[u])&&l[u]>0?+l[u]:0),s.push({type:"Feature",geometry:{type:"Point",coordinates:i},properties:x})}}var _=y.extractOpts(a),b=_.reversescale?y.flipScale(_.colorscale):_.colorscale,T=b[0][1],k=["interpolate",["linear"],["heatmap-density"],0,w.opacity(T)<1?T:w.addOpacity(T,0)];for(u=1;u<b.length;u++)k.push(b[u][0],b[u][1]);var L=["interpolate",["linear"],["get","z"],_.min,0,_.max,1];return v.extendFlat(g.heatmap.paint,{"heatmap-weight":o?L:1/(_.max-_.min),"heatmap-color":k,"heatmap-radius":p?{type:"identity",property:"r"}:a.radius,"heatmap-opacity":a.opacity}),g.geojson={type:"FeatureCollection",features:s},g.heatmap.layout.visibility="visible",g}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function a(s,h){return d.coerce(y,e,w,s,h)}var r=a("lon")||[],g=a("lat")||[],u=Math.min(r.length,g.length);u?(e._length=u,a("z"),a("radius"),a("below"),a("text"),a("hovertext"),a("hovertemplate"),v(y,e,n,a,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(m,G,W){G.exports=function(d,v){return d.lon=v.lon,d.lat=v.lat,d.z=v.z,d}},{}],776:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../scattermapbox/hover").hoverPoints,w=m("../scattermapbox/hover").getExtraText;G.exports=function(y,e,t){var n=v(y,e,t);if(n){var a=n[0],r=a.cd,g=r[0].trace,u=r[a.index];if(delete a.color,"z"in u){var s=a.subplot.mockAxis;a.z=u.z,a.zLabel=d.tickText(s,s.c2l(u.z),"hover").text}return a.extraText=w(g,u,r[0].t.labels),[a]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),formatLabels:m("../scattermapbox/format_labels"),calc:m("./calc"),plot:m("./plot"),hoverPoints:m("./hover"),eventData:m("./event_data"),getBelow:function(d,v){for(var w=v.getMapLayers(),y=0;y<w.length;y++){var e=w[y],t=e.id;if(e.type==="symbol"&&typeof t=="string"&&t.indexOf("plotly-")===-1)return t}},moduleType:"trace",name:"densitymapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(m,G,W){var d=m("./convert"),v=m("../../plots/mapbox/constants").traceLayerPrefix;function w(e,t){this.type="densitymapbox",this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["heatmap",v+t+"-heatmap"]],this.below=null}var y=w.prototype;y.update=function(e){var t=this.subplot,n=this.layerList,a=d(e),r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(a.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(a,r),this.below=r);for(var g=0;g<n.length;g++){var u=n[g],s=u[0],h=u[1],l=a[s];t.setOptions(h,"setLayoutProperty",l.layout),l.layout.visibility==="visible"&&t.setOptions(h,"setPaintProperty",l.paint)}},y._addLayers=function(e,t){for(var n=this.subplot,a=this.layerList,r=this.sourceId,g=0;g<a.length;g++){var u=a[g],s=u[0],h=e[s];n.addLayer({type:s,id:u[1],source:r,layout:h.layout,paint:h.paint},t)}},y._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,n=t.length-1;n>=0;n--)e.removeLayer(t[n][1])},y.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},G.exports=function(e,t){var n=t[0].trace,a=new w(e,n.uid),r=a.sourceId,g=d(t),u=a.below=e.belowLookup["trace-"+n.uid];return e.map.addSource(r,{type:"geojson",data:g.geojson}),a._addLayers(g,u),a}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.hovertext,v,"htx");var e=w.marker;if(e){d.mergeArray(e.opacity,v,"mo"),d.mergeArray(e.color,v,"mc");var t=e.line;t&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"))}}},{"../../lib":515}],780:[function(m,G,W){var d,v=m("../bar/attributes"),w=m("../scatter/attributes").line,y=m("../../plots/attributes"),e=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../plots/template_attributes").texttemplateAttrs,a=m("./constants"),r=m("../../lib/extend").extendFlat,g=m("../../components/color");G.exports={x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:v.hovertext,hovertemplate:t({},{keys:a.eventDataKeys}),hoverinfo:r({},y.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),text:v.text,textposition:v.textposition,insidetextanchor:r({},v.insidetextanchor,{dflt:"middle"}),textangle:r({},v.textangle,{dflt:0}),textfont:v.textfont,insidetextfont:v.insidetextfont,outsidetextfont:v.outsidetextfont,constraintext:v.constraintext,cliponaxis:v.cliponaxis,orientation:r({},v.orientation,{}),offset:r({},v.offset,{arrayOk:!1}),width:r({},v.width,{arrayOk:!1}),marker:(d=r({},v.marker),delete d.pattern,d),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},w.color,{dflt:g.defaultLine}),width:r({},w.width,{dflt:0,editType:"plot"}),dash:w.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("./arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../../constants/numerical").BADNUM;function t(n){return n===e?0:n}G.exports=function(n,a){var r,g,u,s,h,l,o,p,c=d.getFromId(n,a.xaxis||"x"),i=d.getFromId(n,a.yaxis||"y");a.orientation==="h"?(r=c.makeCalcdata(a,"x"),u=i.makeCalcdata(a,"y"),s=v(a,i,"y",u),h=!!a.yperiodalignment,l="y"):(r=i.makeCalcdata(a,"y"),u=c.makeCalcdata(a,"x"),s=v(a,c,"x",u),h=!!a.xperiodalignment,l="x"),g=s.vals;var x,f=Math.min(g.length,r.length),_=new Array(f);for(a._base=[],o=0;o<f;o++){r[o]<0&&(r[o]=e);var b=!1;r[o]!==e&&o+1<f&&r[o+1]!==e&&(b=!0),p=_[o]={p:g[o],s:r[o],cNext:b},a._base[o]=-.5*p.s,h&&(_[o].orig_p=u[o],_[o][l+"End"]=s.ends[o],_[o][l+"Start"]=s.starts[o]),a.ids&&(p.id=String(a.ids[o])),o===0&&(_[0].vTotal=0),_[0].vTotal+=t(p.s),p.begR=t(p.s)/t(_[0].s)}for(o=0;o<f;o++)(p=_[o]).s!==e&&(p.sumR=p.s/_[0].vTotal,p.difR=x!==void 0?p.s/x:1,x=p.s);return w(_,a),y(_,a),_}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(m,G,W){G.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(m,G,W){var d=m("../bar/cross_trace_calc").setGroupPositions;G.exports=function(v,w){var y,e,t=v._fullLayout,n=v._fullData,a=v.calcdata,r=w.xaxis,g=w.yaxis,u=[],s=[],h=[];for(e=0;e<n.length;e++){var l=n[e],o=l.orientation==="h";l.visible===!0&&l.xaxis===r._id&&l.yaxis===g._id&&l.type==="funnel"&&(y=a[e],o?h.push(y):s.push(y),u.push(y))}var p={mode:t.funnelmode,norm:t.funnelnorm,gap:t.funnelgap,groupgap:t.funnelgroupgap};for(d(v,r,g,s,p),d(v,g,r,h,p),e=0;e<u.length;e++){y=u[e];for(var c=0;c<y.length;c++)c+1<y.length&&(y[c].nextP0=y[c+1].p0,y[c].nextS0=y[c+1].s0,y[c].nextP1=y[c+1].p1,y[c].nextS1=y[c+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(m,G,W){var d=m("../../lib"),v=m("../bar/defaults").handleGroupingDefaults,w=m("../bar/defaults").handleText,y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./attributes"),n=m("../../components/color");G.exports={supplyDefaults:function(a,r,g,u){function s(p,c){return d.coerce(a,r,t,p,c)}if(y(a,r,u,s)){e(a,r,u,s),s("xhoverformat"),s("yhoverformat"),s("orientation",r.y&&!r.x?"v":"h"),s("offset"),s("width");var h=s("text");s("hovertext"),s("hovertemplate");var l=s("textposition");w(a,r,u,s,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r.textposition==="none"||r.texttemplate||s("textinfo",Array.isArray(h)?"text+value":"value");var o=s("marker.color",g);s("marker.line.color",n.defaultLine),s("marker.line.width"),s("connector.visible")&&(s("connector.fillcolor",function(p){var c=d.isArrayOrTypedArray(p)?"#000":p;return n.addOpacity(c,.5*n.opacity(c))}(o)),s("connector.line.width")&&(s("connector.line.color"),s("connector.line.dash")))}else r.visible=!1},crossTraceDefaults:function(a,r){var g,u;function s(l){return d.coerce(u._input,u,t,l)}if(r.funnelmode==="group")for(var h=0;h<a.length;h++)g=(u=a[h])._input,v(g,u,r,s)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(m,G,W){G.exports=function(d,v){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"percentInitial"in v&&(d.percentInitial=v.percentInitial),"percentPrevious"in v&&(d.percentPrevious=v.percentPrevious),"percentTotal"in v&&(d.percentTotal=v.percentTotal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],786:[function(m,G,W){var d=m("../../components/color").opacity,v=m("../bar/hover").hoverOnBars,w=m("../../lib").formatPercent;G.exports=function(y,e,t,n,a){var r=v(y,e,t,n,a);if(r){var g=r.cd,u=g[0].trace,s=u.orientation==="h",h=g[r.index];r[(s?"x":"y")+"LabelVal"]=h.s,r.percentInitial=h.begR,r.percentInitialLabel=w(h.begR,1),r.percentPrevious=h.difR,r.percentPreviousLabel=w(h.difR,1),r.percentTotal=h.sumR,r.percentTotalLabel=w(h.sumR,1);var l=h.hi||u.hoverinfo,o=[];if(l&&l!=="none"&&l!=="skip"){var p=l==="all",c=l.split("+"),i=function(x){return p||c.indexOf(x)!==-1};i("percent initial")&&o.push(r.percentInitialLabel+" of initial"),i("percent previous")&&o.push(r.percentPreviousLabel+" of previous"),i("percent total")&&o.push(r.percentTotalLabel+" of total")}return r.extraText=o.join("<br>"),r.color=function(x,f){var _=x.marker,b=f.mc||_.color,T=f.mlc||_.line.color,k=f.mlw||_.line.width;if(d(b))return b;if(d(T)&&k)return T}(u,h),[r]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style").style,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(m,G,W){G.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t=!1;function n(g,u){return d.coerce(w,y,v,g,u)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="funnel"){t=!0;break}}t&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../constants/numerical").BADNUM,e=m("../bar/plot"),t=m("../bar/uniform_text").clearMinTextSize;function n(a,r,g,u){var s=[],h=[],l=u?r:g,o=u?g:r;return s[0]=l.c2p(a.s0,!0),h[0]=o.c2p(a.p0,!0),s[1]=l.c2p(a.s1,!0),h[1]=o.c2p(a.p1,!0),s[2]=l.c2p(a.nextS0,!0),h[2]=o.c2p(a.nextP0,!0),s[3]=l.c2p(a.nextS1,!0),h[3]=o.c2p(a.nextP1,!0),u?[s,h]:[h,s]}G.exports=function(a,r,g,u){var s=a._fullLayout;t("funnel",s),function(h,l,o,p){var c=l.xaxis,i=l.yaxis;v.makeTraceGroups(p,o,"trace bars").each(function(x){var f=d.select(this),_=x[0].trace,b=v.ensureSingle(f,"g","regions");if(_.connector&&_.connector.visible){var T=_.orientation==="h",k=b.selectAll("g.region").data(v.identity);k.enter().append("g").classed("region",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=n(A,c,i,T),S=P[0],E=P[1],z="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&S[2]!==y&&E[2]!==y&&S[3]!==y&&E[3]!==y&&(z+=T?"M"+S[0]+","+E[1]+"L"+S[2]+","+E[2]+"H"+S[3]+"L"+S[1]+","+E[1]+"Z":"M"+S[1]+","+E[1]+"L"+S[2]+","+E[3]+"V"+E[2]+"L"+S[1]+","+E[0]+"Z"),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,l.layerClipId,h)}})}else b.remove()})}(a,r,g,u),function(h,l,o,p){var c=l.xaxis,i=l.yaxis;v.makeTraceGroups(p,o,"trace bars").each(function(x){var f=d.select(this),_=x[0].trace,b=v.ensureSingle(f,"g","lines");if(_.connector&&_.connector.visible&&_.connector.line.width){var T=_.orientation==="h",k=b.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=n(A,c,i,T),S=P[0],E=P[1],z="";S[3]!==void 0&&E[3]!==void 0&&(T?(z+="M"+S[0]+","+E[1]+"L"+S[2]+","+E[2],z+="M"+S[1]+","+E[1]+"L"+S[3]+","+E[2]):(z+="M"+S[1]+","+E[1]+"L"+S[2]+","+E[3],z+="M"+S[1]+","+E[0]+"L"+S[2]+","+E[2])),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,l.layerClipId,h)}})}else b.remove()})}(a,r,g,u),e.plot(a,r,g,u,{mode:s.funnelmode,norm:s.funnelmode,gap:s.funnelgap,groupgap:s.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../../constants/interactions").DESELECTDIM,e=m("../bar/style"),t=m("../bar/uniform_text").resizeText,n=e.styleTextPoints;G.exports={style:function(a,r,g){var u=g||d.select(a).selectAll("g.funnellayer").selectAll("g.trace");t(a,u,"funnel"),u.style("opacity",function(s){return s[0].trace.opacity}),u.each(function(s){var h=d.select(this),l=s[0].trace;h.selectAll(".point > path").each(function(o){if(!o.isBlank){var p=l.marker;d.select(this).call(w.fill,o.mc||p.color).call(w.stroke,o.mlc||p.line.color).call(v.dashLine,p.line.dash,o.mlw||p.line.width).style("opacity",l.selectedpoints&&!o.selected?y:1)}}),n(h,l,a),h.selectAll(".regions").each(function(){d.select(this).selectAll("path").style("stroke-width",0).call(w.fill,l.connector.fillcolor)}),h.selectAll(".lines").each(function(){var o=l.connector.line;v.lineGroupStyle(d.select(this).selectAll("path"),o.width,o.color,o.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(m,G,W){var d=m("../pie/attributes"),v=m("../../plots/attributes"),w=m("../../plots/domain").attributes,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/template_attributes").texttemplateAttrs,t=m("../../lib/extend").extendFlat;G.exports={labels:d.labels,label0:d.label0,dlabel:d.dlabel,values:d.values,marker:{colors:d.marker.colors,line:{color:t({},d.marker.line.color,{dflt:null}),width:t({},d.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:d.text,hovertext:d.hovertext,scalegroup:t({},d.scalegroup,{}),textinfo:t({},d.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:t({},v.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:y({},{keys:["label","color","value","text","percent"]}),textposition:t({},d.textposition,{values:["inside","none"],dflt:"inside"}),textfont:d.textfont,insidetextfont:d.insidetextfont,title:{text:d.title.text,font:d.title.font,position:t({},d.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:w({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(m,G,W){var d=m("../../plots/plots");W.name="funnelarea",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],794:[function(m,G,W){var d=m("../pie/calc");G.exports={calc:function(v,w){return d.calc(v,w)},crossTraceCalc:function(v){d.crossTraceCalc(v,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../bar/defaults").handleText,e=m("../pie/defaults").handleLabelsAndValues;G.exports=function(t,n,a,r){function g(x,f){return d.coerce(t,n,v,x,f)}var u=g("labels"),s=g("values"),h=e(u,s),l=h.len;if(n._hasLabels=h.hasLabels,n._hasValues=h.hasValues,!n._hasLabels&&n._hasValues&&(g("label0"),g("dlabel")),l){n._length=l,g("marker.line.width")&&g("marker.line.color",r.paper_bgcolor),g("marker.colors"),g("scalegroup");var o,p=g("text"),c=g("texttemplate");if(c||(o=g("textinfo",Array.isArray(p)?"text+percent":"percent")),g("hovertext"),g("hovertemplate"),c||o&&o!=="none"){var i=g("textposition");y(t,n,r,g,i,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}w(n,r,g),g("title.text")&&(g("title.position"),d.coerceFont(g,"title.font",r.font)),g("aspectratio"),g("baseratio")}else n.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(m,G,W){G.exports={moduleType:"trace",name:"funnelarea",basePlotModule:m("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style"),styleOne:m("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(m,G,W){var d=m("../pie/layout_attributes").hiddenlabels;G.exports={hiddenlabels:d,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("hiddenlabels"),e("funnelareacolorway",y.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../lib"),y=w.strScale,e=w.strTranslate,t=m("../../lib/svg_text_utils"),n=m("../bar/plot").toMoveInsideBar,a=m("../bar/uniform_text"),r=a.recordMinTextSize,g=a.clearMinTextSize,u=m("../pie/helpers"),s=m("../pie/plot"),h=s.attachFxHandlers,l=s.determineInsideTextFont,o=s.layoutAreas,p=s.prerenderTitles,c=s.positionTitleOutside,i=s.formatSliceLabel;function x(f,_){return"l"+(_[0]-f[0])+","+(_[1]-f[1])}G.exports=function(f,_){var b=f._context.staticPlot,T=f._fullLayout;g("funnelarea",T),p(_,f),o(_,T._size),w.makeTraceGroups(T._funnelarealayer,_,"trace").each(function(k){var L=d.select(this),A=k[0],I=A.trace;(function(P){if(!P.length)return;var S=P[0],E=S.trace,z=E.aspectratio,D=E.baseratio;D>.999&&(D=.999);var j,V=Math.pow(D,2),Z=S.vTotal,Q=Z,K=Z*V/(1-V)/Z;function $(){var _e,le={x:_e=Math.sqrt(K),y:-_e};return[le.x,le.y]}var ne,H,N=[];for(N.push($()),ne=P.length-1;ne>-1;ne--)if(!(H=P[ne]).hidden){var U=H.v/Q;K+=U,N.push($())}var te=1/0,B=-1/0;for(ne=0;ne<N.length;ne++)j=N[ne],te=Math.min(te,j[1]),B=Math.max(B,j[1]);for(ne=0;ne<N.length;ne++)N[ne][1]-=(B+te)/2;var X=N[N.length-1][0],J=S.r,ee=(B-te)/2,re=J/X,se=J/ee*z;for(S.r=se*ee,ne=0;ne<N.length;ne++)N[ne][0]*=re,N[ne][1]*=se;var oe=[-(j=N[0])[0],j[1]],de=[j[0],j[1]],ce=0;for(ne=P.length-1;ne>-1;ne--)if(!(H=P[ne]).hidden){var ve=N[ce+=1][0],Ae=N[ce][1];H.TL=[-ve,Ae],H.TR=[ve,Ae],H.BL=oe,H.BR=de,H.pxmid=(fe=H.TR,me=H.BR,[.5*(fe[0]+me[0]),.5*(fe[1]+me[1])]),oe=H.TL,de=H.TR}var fe,me})(k),L.each(function(){var P=d.select(this).selectAll("g.slice").data(k);P.enter().append("g").classed("slice",!0),P.exit().remove(),P.each(function(E,z){if(E.hidden)d.select(this).selectAll("path,g").remove();else{E.pointNumber=E.i,E.curveNumber=I.index;var D=A.cx,j=A.cy,V=d.select(this),Z=V.selectAll("path.surface").data([E]);Z.enter().append("path").classed("surface",!0).style({"pointer-events":b?"none":"all"}),V.call(h,f,k);var Q="M"+(D+E.TR[0])+","+(j+E.TR[1])+x(E.TR,E.BR)+x(E.BR,E.BL)+x(E.BL,E.TL)+"Z";Z.attr("d",Q),i(f,E,A);var K=u.castOption(I.textposition,E.pts),$=V.selectAll("g.slicetext").data(E.text&&K!=="none"?[0]:[]);$.enter().append("g").classed("slicetext",!0),$.exit().remove(),$.each(function(){var ne=w.ensureSingle(d.select(this),"text","",function(ee){ee.attr("data-notex",1)}),H=w.ensureUniformFontSize(f,l(I,E,T.font));ne.text(E.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(v.font,H).call(t.convertToTspans,f);var N,U,te,B=v.bBox(ne.node()),X=Math.min(E.BL[1],E.BR[1])+j,J=Math.max(E.TL[1],E.TR[1])+j;U=Math.max(E.TL[0],E.BL[0])+D,te=Math.min(E.TR[0],E.BR[0])+D,(N=n(U,te,X,J,B,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=H.size,r(I.type,N,T),k[z].transform=N,w.setTransormAndDisplay(ne,N)})}});var S=d.select(this).selectAll("g.titletext").data(I.title.text?[0]:[]);S.enter().append("g").classed("titletext",!0),S.exit().remove(),S.each(function(){var E=w.ensureSingle(d.select(this),"text","",function(j){j.attr("data-notex",1)}),z=I.title.text;I._meta&&(z=w.templateString(z,I._meta)),E.text(z).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(v.font,I.title.font).call(t.convertToTspans,f);var D=c(A,T._size);E.attr("transform",e(D.x,D.y)+y(Math.min(1,D.scale))+e(D.tx,D.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(m,G,W){var d=m("@plotly/d3"),v=m("../pie/style_one"),w=m("../bar/uniform_text").resizeText;G.exports=function(y){var e=y._fullLayout._funnelarealayer.selectAll(".trace");w(y,e,"funnelarea"),e.each(function(t){var n=t[0].trace,a=d.select(this);a.style({opacity:n.opacity}),a.selectAll("path.surface").each(function(r){d.select(this).call(v,r,n)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../../plots/attributes"),w=m("../../plots/font_attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("../../components/colorscale/attributes"),a=m("../../lib/extend").extendFlat;G.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},d.x,{impliedEdits:{xtype:"array"}}),x0:a({},d.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},d.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},d.y,{impliedEdits:{ytype:"array"}}),y0:a({},d.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},d.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},d.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},d.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},d.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},d.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},d.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},d.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:e(),texttemplate:t({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:w({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},v.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../histogram2d/calc"),t=m("../../components/colorscale/calc"),n=m("./convert_column_xyz"),a=m("./clean_2d_array"),r=m("./interp2d"),g=m("./find_empties"),u=m("./make_bound_array"),s=m("../../constants/numerical").BADNUM;function h(l){for(var o=[],p=l.length,c=0;c<p;c++){var i=l[c];i!==s&&o.push(i)}return o}G.exports=function(l,o){var p,c,i,x,f,_,b,T,k,L,A,I=w.getFromId(l,o.xaxis||"x"),P=w.getFromId(l,o.yaxis||"y"),S=d.traceIs(o,"contour"),E=d.traceIs(o,"histogram"),z=d.traceIs(o,"gl2d"),D=S?"best":o.zsmooth;if(I._minDtick=0,P._minDtick=0,E)x=(A=e(l,o)).orig_x,p=A.x,c=A.x0,i=A.dx,T=A.orig_y,f=A.y,_=A.y0,b=A.dy,k=A.z;else{var j=o.z;v.isArray1D(j)?(n(o,I,P,"x","y",["z"]),p=o._x,f=o._y,j=o._z):(x=o.x?I.makeCalcdata(o,"x"):[],T=o.y?P.makeCalcdata(o,"y"):[],p=y(o,I,"x",x).vals,f=y(o,P,"y",T).vals,o._x=p,o._y=f),c=o.x0,i=o.dx,_=o.y0,b=o.dy,k=a(j,o,I,P)}function V(J){D=o._input.zsmooth=o.zsmooth=!1,v.warn('cannot use zsmooth: "fast": '+J)}if((I.rangebreaks||P.rangebreaks)&&(k=function(J,ee,re){for(var se=[],oe=-1,de=0;de<re.length;de++)if(ee[de]!==s){oe++,se[oe]=[];for(var ce=0;ce<re[de].length;ce++)J[ce]!==s&&se[oe].push(re[de][ce])}return se}(p,f,k),E||(p=h(p),f=h(f),o._x=p,o._y=f)),E||!S&&!o.connectgaps||(o._emptypoints=g(k),r(k,o._emptypoints)),D==="fast"){if(I.type==="log"||P.type==="log")V("log axis found");else if(!E){if(p.length){var Z=(p[p.length-1]-p[0])/(p.length-1),Q=Math.abs(Z/100);for(L=0;L<p.length-1;L++)if(Math.abs(p[L+1]-p[L]-Z)>Q){V("x scale is not linear");break}}if(f.length&&D==="fast"){var K=(f[f.length-1]-f[0])/(f.length-1),$=Math.abs(K/100);for(L=0;L<f.length-1;L++)if(Math.abs(f[L+1]-f[L]-K)>$){V("y scale is not linear");break}}}}var ne=v.maxRowLength(k),H=o.xtype==="scaled"?"":p,N=u(o,H,c,i,ne,I),U=o.ytype==="scaled"?"":f,te=u(o,U,_,b,k.length,P);z||(o._extremes[I._id]=w.findExtremes(I,N),o._extremes[P._id]=w.findExtremes(P,te));var B={x:N,y:te,z:k,text:o._text||o.text,hovertext:o._hovertext||o.hovertext};if(o.xperiodalignment&&x&&(B.orig_x=x),o.yperiodalignment&&T&&(B.orig_y=T),H&&H.length===N.length-1&&(B.xCenter=H),U&&U.length===te.length-1&&(B.yCenter=U),E&&(B.xRanges=A.xRanges,B.yRanges=A.yRanges,B.pts=A.pts),S||t(l,o,{vals:k,cLetter:"z"}),S&&o.contours&&o.contours.coloring==="heatmap"){var X={type:o.type==="contour"?"heatmap":"histogram2d",xcalendar:o.xcalendar,ycalendar:o.ycalendar};B.xfill=u(X,H,c,i,ne,I),B.yfill=u(X,U,_,b,k.length,P)}return[B]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM;G.exports=function(y,e,t,n){var a,r,g,u,s,h;function l(f){if(d(f))return+f}if(e&&e.transpose){for(a=0,s=0;s<y.length;s++)a=Math.max(a,y[s].length);if(a===0)return!1;g=function(f){return f.length},u=function(f,_,b){return(f[b]||[])[_]}}else a=y.length,g=function(f,_){return f[_].length},u=function(f,_,b){return(f[_]||[])[b]};var o=function(f,_,b){return _===w||b===w?w:u(f,_,b)};function p(f){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&f&&f.type==="category"&&e["_"+f._id.charAt(0)].length){var _=f._id.charAt(0),b={},T=e["_"+_+"CategoryMap"]||e[_];for(s=0;s<T.length;s++)b[T[s]]=s;return function(k){var L=b[f._categories[k]];return L+1?L:w}}return v.identity}var c=p(t),i=p(n);n&&n.type==="category"&&(a=n._categories.length);var x=new Array(a);for(s=0;s<a;s++)for(r=t&&t.type==="category"?t._categories.length:g(y,s),x[s]=new Array(r),h=0;h<r;h++)x[s][h]=l(o(y,i(s),c(h)));return x}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(m,G,W){G.exports={min:"zmin",max:"zmax"}},{}],805:[function(m,G,W){var d=m("../../lib"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/cartesian/align_period");G.exports=function(y,e,t,n,a,r){var g=y._length,u=e.makeCalcdata(y,n),s=t.makeCalcdata(y,a);u=w(y,e,n,u).vals,s=w(y,t,a,s).vals;var h,l,o,p,c=y.text,i=c!==void 0&&d.isArray1D(c),x=y.hovertext,f=x!==void 0&&d.isArray1D(x),_=d.distinctVals(u),b=_.vals,T=d.distinctVals(s),k=T.vals,L=[],A=k.length,I=b.length;for(h=0;h<r.length;h++)L[h]=d.init2dArray(A,I);i&&(o=d.init2dArray(A,I)),f&&(p=d.init2dArray(A,I));var P=d.init2dArray(A,I);for(h=0;h<g;h++)if(u[h]!==v&&s[h]!==v){var S=d.findBin(u[h]+_.minDiff/2,b),E=d.findBin(s[h]+T.minDiff/2,k);for(l=0;l<r.length;l++){var z=y[r[l]];L[l][E][S]=z[h],P[E][S]=h}i&&(o[E][S]=c[h]),f&&(p[E][S]=x[h])}for(y["_"+n]=b,y["_"+a]=k,l=0;l<r.length;l++)y["_"+r[l]]=L[l];i&&(y._text=o),f&&(y._hovertext=p),e&&e.type==="category"&&(y["_"+n+"CategoryMap"]=b.map(function(D){return e._categories[D]})),t&&t.type==="category"&&(y["_"+a+"CategoryMap"]=k.map(function(D){return t._categories[D]})),y._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(m,G,W){var d=m("../../lib"),v=m("./xyz_defaults"),w=m("./label_defaults"),y=m("../scatter/period_defaults"),e=m("./style_defaults"),t=m("../../components/colorscale/defaults"),n=m("./attributes");G.exports=function(a,r,g,u){function s(h,l){return d.coerce(a,r,n,h,l)}v(a,r,s,u)?(y(a,r,u,s),s("xhoverformat"),s("yhoverformat"),s("text"),s("hovertext"),s("hovertemplate"),w(s,u),e(a,r,s,u),s("hoverongaps"),s("connectgaps",d.isArray1D(r.z)&&r.zsmooth!==!1),t(a,r,u,s,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(m,G,W){var d=m("../../lib").maxRowLength;G.exports=function(v){var w,y,e,t,n,a,r,g,u=[],s={},h=[],l=v[0],o=[],p=[0,0,0],c=d(v);for(y=0;y<v.length;y++)for(w=o,o=l,l=v[y+1]||[],e=0;e<c;e++)o[e]===void 0&&((a=(o[e-1]!==void 0?1:0)+(o[e+1]!==void 0?1:0)+(w[e]!==void 0?1:0)+(l[e]!==void 0?1:0))?(y===0&&a++,e===0&&a++,y===v.length-1&&a++,e===o.length-1&&a++,a<4&&(s[[y,e]]=[y,e,a]),u.push([y,e,a])):h.push([y,e]));for(;h.length;){for(r={},g=!1,n=h.length-1;n>=0;n--)(a=((s[[(y=(t=h[n])[0])-1,e=t[1]]]||p)[2]+(s[[y+1,e]]||p)[2]+(s[[y,e-1]]||p)[2]+(s[[y,e+1]]||p)[2])/20)&&(r[t]=[y,e,a],h.splice(n,1),g=!0);if(!g)throw"findEmpties iterated with no new neighbors";for(t in r)s[t]=r[t],u.push(r[t])}return u.sort(function(i,x){return x[2]-i[2]})}},{"../../lib":515}],808:[function(m,G,W){var d=m("../../components/fx"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../components/colorscale").extractOpts;G.exports=function(e,t,n,a,r){r||(r={});var g,u,s,h,l=r.isContour,o=e.cd[0],p=o.trace,c=e.xa,i=e.ya,x=o.x,f=o.y,_=o.z,b=o.xCenter,T=o.yCenter,k=o.zmask,L=p.zhoverformat,A=x,I=f;if(e.index!==!1){try{s=Math.round(e.index[1]),h=Math.round(e.index[0])}catch{return void v.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(s<0||s>=_[0].length||h<0||h>_.length)return}else{if(d.inbox(t-x[0],t-x[x.length-1],0)>0||d.inbox(n-f[0],n-f[f.length-1],0)>0)return;if(l){var P;for(A=[2*x[0]-x[1]],P=1;P<x.length;P++)A.push((x[P]+x[P-1])/2);for(A.push([2*x[x.length-1]-x[x.length-2]]),I=[2*f[0]-f[1]],P=1;P<f.length;P++)I.push((f[P]+f[P-1])/2);I.push([2*f[f.length-1]-f[f.length-2]])}s=Math.max(0,Math.min(A.length-2,v.findBin(t,A))),h=Math.max(0,Math.min(I.length-2,v.findBin(n,I)))}var S,E,z=c.c2p(x[s]),D=c.c2p(x[s+1]),j=i.c2p(f[h]),V=i.c2p(f[h+1]);l?(S=o.orig_x||x,E=o.orig_y||f,D=z,g=S[s],V=j,u=E[h]):(S=o.orig_x||b||x,E=o.orig_y||T||f,g=b?S[s]:(S[s]+S[s+1])/2,u=T?E[h]:(E[h]+E[h+1])/2,c&&c.type==="category"&&(g=x[s]),i&&i.type==="category"&&(u=f[h]),p.zsmooth&&(z=D=c.c2p(g),j=V=i.c2p(u)));var Z=_[h][s];if(k&&!k[h][s]&&(Z=void 0),Z!==void 0||p.hoverongaps){var Q;Array.isArray(o.hovertext)&&Array.isArray(o.hovertext[h])?Q=o.hovertext[h][s]:Array.isArray(o.text)&&Array.isArray(o.text[h])&&(Q=o.text[h][s]);var K=y(p),$={type:"linear",range:[K.min,K.max],hoverformat:L,_separators:c._separators,_numFormat:c._numFormat},ne=w.tickText($,Z,"hover").text;return[v.extendFlat(e,{index:p._after2before?p._after2before[h][s]:[h,s],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:z,x1:D,y0:j,y1:V,xLabelVal:g,yLabelVal:u,zLabelVal:Z,zLabel:ne,text:Q})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),colorbar:m("./colorbar"),style:m("./style"),hoverPoints:m("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(m,G,W){var d=m("../../lib"),v=[[-1,0],[1,0],[0,-1],[0,1]];function w(e){return .5-.25*Math.min(1,.5*e)}function y(e,t,n){var a,r,g,u,s,h,l,o,p,c,i,x,f,_=0;for(u=0;u<t.length;u++){for(r=(a=t[u])[0],g=a[1],i=e[r][g],c=0,p=0,s=0;s<4;s++)(l=e[r+(h=v[s])[0]])&&(o=l[g+h[1]])!==void 0&&(c===0?x=f=o:(x=Math.min(x,o),f=Math.max(f,o)),p++,c+=o);if(p===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[r][g]=c/p,i===void 0?p<4&&(_=1):(e[r][g]=(1+n)*e[r][g]-n*i,f>x&&(_=Math.max(_,Math.abs(e[r][g]-i)/(f-x))))}return _}G.exports=function(e,t){var n,a=1;for(y(e,t),n=0;n<t.length&&!(t[n][2]<4);n++);for(t=t.slice(n),n=0;n<100&&a>.01;n++)a=y(e,t,w(a));return a>.01&&d.log("interp2d didn't converge quickly",a),e}},{"../../lib":515}],811:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){v("texttemplate");var y=d.extendFlat({},w.font,{color:"auto",size:"auto"});d.coerceFont(v,"textfont",y)}},{"../../lib":515}],812:[function(m,G,W){var d=m("../../registry"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t,n,a){var r,g,u,s=[],h=d.traceIs(w,"contour"),l=d.traceIs(w,"histogram"),o=d.traceIs(w,"gl2d");if(v(y)&&y.length>1&&!l&&a.type!=="category"){var p=y.length;if(!(p<=n))return h?y.slice(0,n):y.slice(0,n+1);if(h||o)s=y.slice(0,n);else if(n===1)s=[y[0]-.5,y[0]+.5];else{for(s=[1.5*y[0]-.5*y[1]],u=1;u<p;u++)s.push(.5*(y[u-1]+y[u]));s.push(1.5*y[p-1]-.5*y[p-2])}if(p<n){var c=s[s.length-1],i=c-s[s.length-2];for(u=p;u<n;u++)c+=i,s.push(c)}}else{var x=w[a._id.charAt(0)+"calendar"];for(l?r=a.r2c(e,0,x):v(y)&&y.length===1?r=y[0]:e===void 0?r=0:r=(a.type==="log"?a.d2c:a.r2c)(e,0,x),g=t||1,u=h||o?0:-.5;u<n;u++)s.push(r+g*u)}return s}},{"../../lib":515,"../../registry":647}],813:[function(m,G,W){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../components/drawing"),e=m("../../plots/cartesian/axes"),t=m("../../lib"),n=m("../../lib/svg_text_utils"),a=m("../scatter/format_labels"),r=m("../../components/color"),g=m("../../components/colorscale").extractOpts,u=m("../../components/colorscale").makeColorScaleFuncFromTrace,s=m("../../constants/xmlns_namespaces"),h=m("../../constants/alignment").LINE_SPACING;function l(x){return x.selectAll("g.heatmap-label")}function o(x){l(x).remove()}function p(x,f){var _=f.length-2,b=t.constrain(t.findBin(x,f),0,_),T=f[b],k=f[b+1],L=t.constrain(b+(x-T)/(k-T)-.5,0,_),A=Math.round(L),I=Math.abs(L-A);return L&&L!==_&&I?{bin0:A,frac:I,bin1:Math.round(A+I/(L-A))}:{bin0:A,bin1:A,frac:0}}function c(x,f){var _=f.length-1,b=t.constrain(t.findBin(x,f),0,_),T=f[b],k=(x-T)/(f[b+1]-T)||0;return k<=0?{bin0:b,bin1:b,frac:0}:k<.5?{bin0:b,bin1:b+1,frac:k}:{bin0:b+1,bin1:b,frac:1-k}}function i(x,f,_){x[f]=_[0],x[f+1]=_[1],x[f+2]=_[2],x[f+3]=Math.round(255*_[3])}G.exports=function(x,f,_,b){var T=f.xaxis,k=f.yaxis;t.makeTraceGroups(b,_,"hm").each(function(L){var A,I,P,S,E,z,D,j,V=d.select(this),Z=L[0],Q=Z.trace,K=Q.xgap||0,$=Q.ygap||0,ne=Z.z,H=Z.x,N=Z.y,U=Z.xCenter,te=Z.yCenter,B=w.traceIs(Q,"contour"),X=B?"best":Q.zsmooth,J=ne.length,ee=t.maxRowLength(ne),re=!1,se=!1;for(z=0;A===void 0&&z<H.length-1;)A=T.c2p(H[z]),z++;for(z=H.length-1;I===void 0&&z>0;)I=T.c2p(H[z]),z--;for(I<A&&(P=I,I=A,A=P,re=!0),z=0;S===void 0&&z<N.length-1;)S=k.c2p(N[z]),z++;for(z=N.length-1;E===void 0&&z>0;)E=k.c2p(N[z]),z--;if(E<S&&(P=S,S=E,E=P,se=!0),B&&(U=H,te=N,H=Z.xfill,N=Z.yfill),X!=="fast"){var oe=X==="best"?0:.5;A=Math.max(-oe*T._length,A),I=Math.min((1+oe)*T._length,I),S=Math.max(-oe*k._length,S),E=Math.min((1+oe)*k._length,E)}var de,ce,ve=Math.round(I-A),Ae=Math.round(E-S);if(ve<=0||Ae<=0)return V.selectAll("image").data([]).exit().remove(),void o(V);X==="fast"?(de=ee,ce=J):(de=ve,ce=Ae);var fe=document.createElement("canvas");fe.width=de,fe.height=ce;var me,_e,le=fe.getContext("2d"),ge=u(Q,{noNumericCheck:!0,returnArray:!0});X==="fast"?(me=re?function(an){return ee-1-an}:t.identity,_e=se?function(an){return J-1-an}:t.identity):(me=function(an){return t.constrain(Math.round(T.c2p(H[an])-A),0,ve)},_e=function(an){return t.constrain(Math.round(k.c2p(N[an])-S),0,Ae)});var Te,Se,Me,ze,Oe=_e(0),De=[Oe,Oe],Xe=re?0:1,Be=se?0:1,Ie=0,Re=0,Ye=0,Qe=0;function lt(an,xn){if(an!==void 0){var _n=ge(an);return _n[0]=Math.round(_n[0]),_n[1]=Math.round(_n[1]),_n[2]=Math.round(_n[2]),Ie+=xn,Re+=_n[0]*xn,Ye+=_n[1]*xn,Qe+=_n[2]*xn,_n}return[0,0,0,0]}function xt(an,xn,_n,ti){var jr=an[_n.bin0];if(jr===void 0)return lt(void 0,1);var nn,vn=an[_n.bin1],en=xn[_n.bin0],fn=xn[_n.bin1],Gn=vn-jr||0,Tn=en-jr||0;return nn=vn===void 0?fn===void 0?0:en===void 0?2*(fn-jr):2*(2*fn-en-jr)/3:fn===void 0?en===void 0?0:2*(2*jr-vn-en)/3:en===void 0?2*(2*fn-vn-jr)/3:fn+jr-vn-en,lt(jr+_n.frac*Gn+ti.frac*(Tn+_n.frac*nn))}if(X){var wt,bt=0;try{wt=new Uint8Array(ve*Ae*4)}catch{wt=new Array(ve*Ae*4)}if(X==="best"){var nt,$e,vt,Nt=U||H,qt=te||N,Jt=new Array(Nt.length),Wt=new Array(qt.length),ar=new Array(ve),Dt=U?c:p,Ne=te?c:p;for(z=0;z<Nt.length;z++)Jt[z]=Math.round(T.c2p(Nt[z])-A);for(z=0;z<qt.length;z++)Wt[z]=Math.round(k.c2p(qt[z])-S);for(z=0;z<ve;z++)ar[z]=Dt(z,Jt);for(D=0;D<Ae;D++)for($e=ne[(nt=Ne(D,Wt)).bin0],vt=ne[nt.bin1],z=0;z<ve;z++,bt+=4)i(wt,bt,ze=xt($e,vt,ar[z],nt))}else for(D=0;D<J;D++)for(Me=ne[D],De=_e(D),z=0;z<ve;z++)ze=lt(Me[z],1),i(wt,bt=4*(De*ve+me(z)),ze);var qe=le.createImageData(ve,Ae);try{qe.data.set(wt)}catch{var pe=qe.data,be=pe.length;for(D=0;D<be;D++)pe[D]=wt[D]}le.putImageData(qe,0,0)}else{var Fe=Math.floor(K/2),Ve=Math.floor($/2);for(D=0;D<J;D++)if(Me=ne[D],De.reverse(),De[Be]=_e(D+1),De[0]!==De[1]&&De[0]!==void 0&&De[1]!==void 0)for(Te=[Se=me(0),Se],z=0;z<ee;z++)Te.reverse(),Te[Xe]=me(z+1),Te[0]!==Te[1]&&Te[0]!==void 0&&Te[1]!==void 0&&(ze=lt(Me[z],(Te[1]-Te[0])*(De[1]-De[0])),le.fillStyle="rgba("+ze.join(",")+")",le.fillRect(Te[0]+Fe,De[0]+Ve,Te[1]-Te[0]-K,De[1]-De[0]-$))}Re=Math.round(Re/Ie),Ye=Math.round(Ye/Ie),Qe=Math.round(Qe/Ie);var Ke=v("rgb("+Re+","+Ye+","+Qe+")");x._hmpixcount=(x._hmpixcount||0)+Ie,x._hmlumcount=(x._hmlumcount||0)+Ie*Ke.getLuminance();var Ge=V.selectAll("image").data(L);Ge.enter().append("svg:image").attr({xmlns:s.svg,preserveAspectRatio:"none"}),Ge.attr({height:Ae,width:ve,x:A,y:S,"xlink:href":fe.toDataURL("image/png")}),o(V);var ct=Q.texttemplate;if(ct){var st=g(Q),Mt={type:"linear",range:[st.min,st.max],_separators:T._separators,_numFormat:T._numFormat},Ot=Q.type==="histogram2dcontour",it=Q.type==="contour",ht=it?J-1:J,jt=it?1:0,kt=it?ee-1:ee,Pt=[];for(z=it?1:0;z<ht;z++){var Ee;if(it)Ee=Z.y[z];else if(Ot){if(z===0||z===J-1)continue;Ee=Z.y[z]}else if(Z.yCenter)Ee=Z.yCenter[z];else{if(z+1===J&&Z.y[z+1]===void 0)continue;Ee=(Z.y[z]+Z.y[z+1])/2}var Ze=Math.round(k.c2p(Ee));if(!(0>Ze||Ze>k._length))for(D=jt;D<kt;D++){var at;if(it)at=Z.x[D];else if(Ot){if(D===0||D===ee-1)continue;at=Z.x[D]}else if(Z.xCenter)at=Z.xCenter[D];else{if(D+1===ee&&Z.x[D+1]===void 0)continue;at=(Z.x[D]+Z.x[D+1])/2}var pt=Math.round(T.c2p(at));if(!(0>pt||pt>T._length)){var St=a({x:at,y:Ee},Q,x._fullLayout);St.x=at,St.y=Ee;var Ut=Z.z[z][D];Ut===void 0?(St.z="",St.zLabel=""):(St.z=Ut,St.zLabel=e.tickText(Mt,Ut,"hover").text);var Kt=Z.text&&Z.text[z]&&Z.text[z][D];Kt!==void 0&&Kt!==!1||(Kt=""),St.text=Kt;var Ht=t.texttemplateString(ct,St,x._fullLayout._d3locale,St,Q._meta||{});if(Ht){var pr=Ht.split("<br>"),Mr=pr.length,hr=0;for(j=0;j<Mr;j++)hr=Math.max(hr,pr[j].length);Pt.push({l:Mr,c:hr,t:Ht,x:pt,y:Ze,z:Ut})}}}}var Qt=Q.textfont,tr=Qt.family,rr=Qt.size,fr=x._fullLayout.font.size;if(!rr||rr==="auto"){var yr=1/0,Sr=1/0,Dr=0,Nr=0;for(j=0;j<Pt.length;j++){var Wr=Pt[j];if(Dr=Math.max(Dr,Wr.l),Nr=Math.max(Nr,Wr.c),j<Pt.length-1){var hn=Pt[j+1],tn=Math.abs(hn.x-Wr.x),Fn=Math.abs(hn.y-Wr.y);tn&&(yr=Math.min(yr,tn)),Fn&&(Sr=Math.min(Sr,Fn))}}isFinite(yr)&&isFinite(Sr)?(yr-=K,Sr-=$,yr/=Nr,Sr/=Dr,yr/=h/2,Sr/=h,rr=Math.min(Math.floor(yr),Math.floor(Sr),fr)):rr=fr}if(rr<=0||!isFinite(rr))return;l(V).data(Pt).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(an){var xn=d.select(this),_n=Qt.color;_n&&_n!=="auto"||(_n=r.contrast("rgba("+ge(an.z).join()+")")),xn.attr("data-notex",1).call(n.positionText,function(ti){return ti.x}(an),function(ti){return ti.y-rr*(ti.l*h/2-1)}(an)).call(y.font,tr,rr,_n).text(an.t).call(n.convertToTspans,x)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(m,G,W){var d=m("@plotly/d3");G.exports=function(v){d.select(v).selectAll(".hm image").style("opacity",function(w){return w.trace.opacity})}},{"@plotly/d3":58}],815:[function(m,G,W){G.exports=function(d,v,w){w("zsmooth")===!1&&(w("xgap"),w("ygap")),w("zhoverformat")}},{}],816:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../registry");function y(e,t){var n=t(e);return(n?t(e+"type","array"):"scaled")==="scaled"&&(t(e+"0"),t("d"+e)),n}G.exports=function(e,t,n,a,r,g){var u,s,h=n("z");if(r=r||"x",g=g||"y",h===void 0||!h.length)return 0;if(v.isArray1D(e.z)){u=n(r),s=n(g);var l=v.minRowLength(u),o=v.minRowLength(s);if(l===0||o===0)return 0;t._length=Math.min(l,o,h.length)}else{if(u=y(r,n),s=y(g,n),!function(p){for(var c,i=!0,x=!1,f=!1,_=0;_<p.length;_++){if(c=p[_],!v.isArrayOrTypedArray(c)){i=!1;break}c.length>0&&(x=!0);for(var b=0;b<c.length;b++)if(d(c[b])){f=!0;break}}return i&&x&&f}(h))return 0;n("transpose"),t._length=null}return e.type==="heatmapgl"||w.getComponentMethod("calendars","handleTraceDefaults")(e,t,[r,g],a),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(m,G,W){for(var d=m("../heatmap/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],t={},n=0;n<e.length;n++){var a=e[n];t[a]=d[a]}t.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},w(t,v("",{cLetter:"z",autoColorDflt:!1})),G.exports=y(t,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(m,G,W){var d=m("../../../stackgl_modules").gl_heatmap2d,v=m("../../plots/cartesian/axes"),w=m("../../lib/str2rgbarray");function y(t,n){this.scene=t,this.uid=n,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=d(t.glplot,this.options),this.heatmap._trace=this}var e=y.prototype;e.handlePick=function(t){var n=this.options,a=n.shape,r=t.pointId,g=r%a[0],u=Math.floor(r/a[0]),s=r;return{trace:this,dataCoord:t.dataCoord,traceCoord:[n.x[g],n.y[u],n.z[s]],textLabel:this.textLabels[r],name:this.name,pointIndex:[u,g],hoverinfo:this.hoverinfo}},e.update=function(t,n){var a=n[0];this.index=t.index,this.name=t.name,this.hoverinfo=t.hoverinfo;var r=a.z;this.options.z=[].concat.apply([],r);var g=r[0].length,u=r.length;this.options.shape=[g,u],this.options.x=a.x,this.options.y=a.y,this.options.zsmooth=t.zsmooth;var s=function(c){for(var i=c.colorscale,x=c.zmin,f=c.zmax,_=i.length,b=new Array(_),T=new Array(4*_),k=0;k<_;k++){var L=i[k],A=w(L[1]);b[k]=x+L[0]*(f-x);for(var I=0;I<4;I++)T[4*k+I]=A[I]}return{colorLevels:b,colorValues:T}}(t);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],t.text),this.heatmap.update(this.options);var h,l,o=this.scene.xaxis,p=this.scene.yaxis;t.zsmooth===!1&&(h={ppad:a.x[1]-a.x[0]},l={ppad:a.y[1]-a.y[0]}),t._extremes[o._id]=v.findExtremes(o,a.x,h),t._extremes[p._id]=v.findExtremes(p,a.y,l)},e.dispose=function(){this.heatmap.dispose()},G.exports=function(t,n,a){var r=new y(t,n.uid);return r.update(n,a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(m,G,W){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("../../components/colorscale/defaults"),y=m("./attributes");G.exports=function(e,t,n,a){function r(g,u){return d.coerce(e,t,y,g,u)}v(e,t,r,a)?(r("text"),r("zsmooth"),w(e,t,a,r,{prefix:"",cLetter:"z"})):t.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("../heatmap/calc"),plot:m("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:m("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(m,G,W){var d=m("../bar/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../plots/font_attributes"),t=m("./bin_attributes"),n=m("./constants"),a=m("../../lib/extend").extendFlat;G.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:v("x"),yhoverformat:v("y"),text:a({},d.text,{}),hovertext:a({},d.hovertext,{}),orientation:d.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:t("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:t("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:w({},{keys:n.eventDataKeys}),texttemplate:y({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:a({},d.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:d.insidetextanchor,textangle:d.textangle,cliponaxis:d.cliponaxis,constraintext:d.constraintext,marker:d.marker,offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,_deprecated:{bardir:d._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(m,G,W){G.exports=function(d,v){for(var w=d.length,y=0,e=0;e<w;e++)v[e]?(d[e]/=v[e],y+=d[e]):d[e]=null;return y}},{}],823:[function(m,G,W){G.exports=function(d,v){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(m,G,W){var d=m("fast-isnumeric");G.exports={count:function(v,w,y){return y[v]++,1},sum:function(v,w,y,e){var t=e[w];return d(t)?(t=Number(t),y[v]+=t,t):0},avg:function(v,w,y,e,t){var n=e[w];return d(n)&&(n=Number(n),y[v]+=n,t[v]++),0},min:function(v,w,y,e){var t=e[w];if(d(t)){if(t=Number(t),!d(y[v]))return y[v]=t,t;if(y[v]>t){var n=t-y[v];return y[v]=t,n}}return 0},max:function(v,w,y,e){var t=e[w];if(d(t)){if(t=Number(t),!d(y[v]))return y[v]=t,t;if(y[v]<t){var n=t-y[v];return y[v]=t,n}}return 0}}},{"fast-isnumeric":190}],825:[function(m,G,W){var d=m("../../constants/numerical"),v=d.ONEAVGYEAR,w=d.ONEAVGMONTH,y=d.ONEDAY,e=d.ONEHOUR,t=d.ONEMIN,n=d.ONESEC,a=m("../../plots/cartesian/axes").tickIncrement;function r(h,l,o,p){if(h*l<=0)return 1/0;for(var c=Math.abs(l-h),i=o.type==="date",x=g(c,i),f=0;f<10;f++){var _=g(80*x,i);if(x===_||!u(_,h,l,i,o,p))break;x=_}return x}function g(h,l){return l&&h>n?h>y?h>1.1*v?v:h>1.1*w?w:y:h>e?e:h>t?t:n:Math.pow(10,Math.floor(Math.log(h)/Math.LN10))}function u(h,l,o,p,c,i){if(p&&h>y){var x=s(l,c,i),f=s(o,c,i),_=h===v?0:1;return x[_]!==f[_]}return Math.floor(o/h)-Math.floor(l/h)>.1}function s(h,l,o){var p=l.c2d(h,v,o).split("-");return p[0]===""&&(p.unshift(),p[0]="-"+p[0]),p}G.exports=function(h,l,o,p,c){var i,x,f=-1.1*l,_=-.1*l,b=h-_,T=o[0],k=o[1],L=Math.min(r(T+_,T+b,p,c),r(k+_,k+b,p,c)),A=Math.min(r(T+f,T+_,p,c),r(k+f,k+_,p,c));if(L>A&&A<Math.abs(k-T)/4e3?(i=L,x=!1):(i=Math.min(L,A),x=!0),p.type==="date"&&i>y){var I=i===v?1:6,P=i===v?"M12":"M1";return function(S,E){var z=p.c2d(S,v,c),D=z.indexOf("-",I);D>0&&(z=z.substr(0,D));var j=p.d2c(z,0,c);if(j<S){var V=a(j,P,!1,c);(j+V)/2<S+h&&(j=V)}return E&&x?a(j,P,!0,c):j}}return function(S,E){var z=i*Math.round(S/i);return z+i/10<S&&z+.9*i<S+h&&(z+=i),E&&x&&(z-=i),z}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../registry"),y=m("../../plots/cartesian/axes"),e=m("../bar/arrays_to_calcdata"),t=m("./bin_functions"),n=m("./norm_functions"),a=m("./average"),r=m("./bin_label_vals");function g(u,s,h,l,o){var p,c,i,x,f,_,b,T=l+"bins",k=u._fullLayout,L=s["_"+l+"bingroup"],A=k._histogramBinOpts[L],I=k.barmode==="overlay",P=function(ce){return h.r2c(ce,0,x)},S=function(ce){return h.c2r(ce,0,x)},E=h.type==="date"?function(ce){return ce||ce===0?v.cleanDate(ce,null,x):null}:function(ce){return d(ce)?Number(ce):null};function z(ce,ve,Ae){ve[ce+"Found"]?(ve[ce]=E(ve[ce]),ve[ce]===null&&(ve[ce]=Ae[ce])):(_[ce]=ve[ce]=Ae[ce],v.nestedProperty(c[0],T+"."+ce).set(Ae[ce]))}if(s["_"+l+"autoBinFinished"])delete s["_"+l+"autoBinFinished"];else{c=A.traces;var D=[],j=!0,V=!1,Z=!1;for(p=0;p<c.length;p++)if((i=c[p]).visible){var Q=A.dirs[p];f=i["_"+Q+"pos0"]=h.makeCalcdata(i,Q),D=v.concat(D,f),delete i["_"+l+"autoBinFinished"],s.visible===!0&&(j?j=!1:(delete i._autoBin,i["_"+l+"autoBinFinished"]=1),w.traceIs(i,"2dMap")&&(V=!0),i.type==="histogram2dcontour"&&(Z=!0))}x=c[0][l+"calendar"];var K=y.autoBin(D,h,A.nbins,V,x,A.sizeFound&&A.size),$=c[0]._autoBin={};if(_=$[A.dirs[0]]={},Z&&(A.size||(K.start=S(y.tickIncrement(P(K.start),K.size,!0,x))),A.end===void 0&&(K.end=S(y.tickIncrement(P(K.end),K.size,!1,x)))),I&&!w.traceIs(s,"2dMap")&&K._dataSpan===0&&h.type!=="category"&&h.type!=="multicategory"){if(o)return[K,f,!0];K=function(ce,ve,Ae,fe,me){var _e,le,ge,Te=ce._fullLayout,Se=function(xt,wt){for(var bt=wt.xaxis,nt=wt.yaxis,$e=wt.orientation,vt=[],Nt=xt._fullData,qt=0;qt<Nt.length;qt++){var Jt=Nt[qt];Jt.type==="histogram"&&Jt.visible===!0&&Jt.orientation===$e&&Jt.xaxis===bt&&Jt.yaxis===nt&&vt.push(Jt)}return vt}(ce,ve),Me=!1,ze=1/0,Oe=[ve];for(_e=0;_e<Se.length;_e++)if((le=Se[_e])===ve)Me=!0;else if(Me){var De=g(ce,le,Ae,fe,!0),Xe=De[0],Be=De[2];le["_"+fe+"autoBinFinished"]=1,le["_"+fe+"pos0"]=De[1],Be?Oe.push(le):ze=Math.min(ze,Xe.size)}else ge=Te._histogramBinOpts[le["_"+fe+"bingroup"]],ze=Math.min(ze,ge.size||le[me].size);var Ie=new Array(Oe.length);for(_e=0;_e<Oe.length;_e++)for(var Re=Oe[_e]["_"+fe+"pos0"],Ye=0;Ye<Re.length;Ye++)if(Re[Ye]!==void 0){Ie[_e]=Re[Ye];break}for(isFinite(ze)||(ze=v.distinctVals(Ie).minDiff),_e=0;_e<Oe.length;_e++){var Qe=(le=Oe[_e])[fe+"calendar"],lt={start:Ae.c2r(Ie[_e]-ze/2,0,Qe),end:Ae.c2r(Ie[_e]+ze/2,0,Qe),size:ze};le._input[me]=le[me]=lt,(ge=Te._histogramBinOpts[le["_"+fe+"bingroup"]])&&v.extendFlat(ge,lt)}return ve[me]}(u,s,h,l,T)}(b=i.cumulative||{}).enabled&&b.currentbin!=="include"&&(b.direction==="decreasing"?K.start=S(y.tickIncrement(P(K.start),K.size,!0,x)):K.end=S(y.tickIncrement(P(K.end),K.size,!1,x))),A.size=K.size,A.sizeFound||(_.size=K.size,v.nestedProperty(c[0],T+".size").set(K.size)),z("start",A,K),z("end",A,K)}f=s["_"+l+"pos0"],delete s["_"+l+"pos0"];var ne=s._input[T]||{},H=v.extendFlat({},A),N=A.start,U=h.r2l(ne.start),te=U!==void 0;if((A.startFound||te)&&U!==h.r2l(N)){var B=te?U:v.aggNums(Math.min,null,f),X={type:h.type==="category"||h.type==="multicategory"?"linear":h.type,r2l:h.r2l,dtick:A.size,tick0:N,calendar:x,range:[B,y.tickIncrement(B,A.size,!1,x)].map(h.l2r)},J=y.tickFirst(X);J>h.r2l(B)&&(J=y.tickIncrement(J,A.size,!0,x)),H.start=h.l2r(J),te||v.nestedProperty(s,T+".start").set(H.start)}var ee=A.end,re=h.r2l(ne.end),se=re!==void 0;if((A.endFound||se)&&re!==h.r2l(ee)){var oe=se?re:v.aggNums(Math.max,null,f);H.end=h.l2r(oe),se||v.nestedProperty(s,T+".start").set(H.end)}var de="autobin"+l;return s._input[de]===!1&&(s._input[T]=v.extendFlat({},s[T]||{}),delete s._input[de],delete s[de]),[H,f]}G.exports={calc:function(u,s){var h,l,o,p,c=[],i=[],x=s.orientation==="h",f=y.getFromId(u,x?s.yaxis:s.xaxis),_=x?"y":"x",b={x:"y",y:"x"}[_],T=s[_+"calendar"],k=s.cumulative,L=g(u,s,f,_),A=L[0],I=L[1],P=typeof A.size=="string",S=[],E=P?S:A,z=[],D=[],j=[],V=0,Z=s.histnorm,Q=s.histfunc,K=Z.indexOf("density")!==-1;k.enabled&&K&&(Z=Z.replace(/ ?density$/,""),K=!1);var $,ne=Q==="max"||Q==="min"?null:0,H=t.count,N=n[Z],U=!1,te=function(le){return f.r2c(le,0,T)};for(v.isArrayOrTypedArray(s[b])&&Q!=="count"&&($=s[b],U=Q==="avg",H=t[Q]),h=te(A.start),o=te(A.end)+(h-y.tickIncrement(h,A.size,!1,T))/1e6;h<o&&c.length<1e6&&(l=y.tickIncrement(h,A.size,!1,T),c.push((h+l)/2),i.push(ne),j.push([]),S.push(h),K&&z.push(1/(l-h)),U&&D.push(0),!(l<=h));)h=l;S.push(h),P||f.type!=="date"||(E={start:te(E.start),end:te(E.end),size:E.size}),u._fullLayout._roundFnOpts||(u._fullLayout._roundFnOpts={});var B=s["_"+_+"bingroup"],X={leftGap:1/0,rightGap:1/0};B&&(u._fullLayout._roundFnOpts[B]||(u._fullLayout._roundFnOpts[B]=X),X=u._fullLayout._roundFnOpts[B]);var J,ee=i.length,re=!0,se=X.leftGap,oe=X.rightGap,de={};for(h=0;h<I.length;h++){var ce=I[h];(p=v.findBin(ce,E))>=0&&p<ee&&(V+=H(p,h,i,$,D),re&&j[p].length&&ce!==I[j[p][0]]&&(re=!1),j[p].push(h),de[h]=p,se=Math.min(se,ce-S[p]),oe=Math.min(oe,S[p+1]-ce))}X.leftGap=se,X.rightGap=oe,re||(J=function(le,ge){return function(){var Te=u._fullLayout._roundFnOpts[B];return r(Te.leftGap,Te.rightGap,S,f,T)(le,ge)}}),U&&(V=a(i,D)),N&&N(i,V,z),k.enabled&&function(le,ge,Te){var Se,Me,ze;function Oe(Xe){ze=le[Xe],le[Xe]/=2}function De(Xe){Me=le[Xe],le[Xe]=ze+Me/2,ze+=Me}if(Te==="half")if(ge==="increasing")for(Oe(0),Se=1;Se<le.length;Se++)De(Se);else for(Oe(le.length-1),Se=le.length-2;Se>=0;Se--)De(Se);else if(ge==="increasing"){for(Se=1;Se<le.length;Se++)le[Se]+=le[Se-1];Te==="exclude"&&(le.unshift(0),le.pop())}else{for(Se=le.length-2;Se>=0;Se--)le[Se]+=le[Se+1];Te==="exclude"&&(le.push(0),le.shift())}}(i,k.direction,k.currentbin);var ve=Math.min(c.length,i.length),Ae=[],fe=0,me=ve-1;for(h=0;h<ve;h++)if(i[h]){fe=h;break}for(h=ve-1;h>=fe;h--)if(i[h]){me=h;break}for(h=fe;h<=me;h++)if(d(c[h])&&d(i[h])){var _e={p:c[h],s:i[h],b:0};k.enabled||(_e.pts=j[h],re?_e.ph0=_e.ph1=j[h].length?I[j[h][0]]:c[h]:(s._computePh=!0,_e.ph0=J(S[h]),_e.ph1=J(S[h+1],!0))),Ae.push(_e)}return Ae.length===1&&(Ae[0].width1=y.tickIncrement(Ae[0].p,A.size,!1,T)-Ae[0].p),e(Ae,s),v.isArrayOrTypedArray(s.selectedpoints)&&v.tagSelected(Ae,s,de),Ae},calcAllAutoBins:g}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(m,G,W){G.exports={eventDataKeys:["binNumber"]}},{}],828:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axis_ids"),w=m("../../registry").traceIs,y=m("../bar/defaults").handleGroupingDefaults,e=d.nestedProperty,t=m("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];G.exports=function(r,g){var u,s,h,l,o,p,c,i=g._histogramBinOpts={},x=[],f={},_=[];function b(K,$){return d.coerce(u._input,u,u._module.attributes,K,$)}function T(K){return K.orientation==="v"?"x":"y"}function k(K,$,ne){var H=K.uid+"__"+ne;$||($=H);var N=function(X,J){return v.getFromTrace({_fullLayout:g},X,J).type}(K,ne),U=K[ne+"calendar"]||"",te=i[$],B=!0;te&&(N===te.axType&&U===te.calendar?(B=!1,te.traces.push(K),te.dirs.push(ne)):($=H,N!==te.axType&&d.warn(["Attempted to group the bins of trace",K.index,"set on a","type:"+N,"axis","with bins on","type:"+te.axType,"axis."].join(" ")),U!==te.calendar&&d.warn(["Attempted to group the bins of trace",K.index,"set with a",U,"calendar","with bins",te.calendar?"on a "+te.calendar+" calendar":"w/o a set calendar"].join(" ")))),B&&(i[$]={traces:[K],dirs:[ne],axType:N,calendar:K[ne+"calendar"]||""}),K["_"+ne+"bingroup"]=$}for(o=0;o<r.length;o++)u=r[o],w(u,"histogram")&&(x.push(u),delete u._xautoBinFinished,delete u._yautoBinFinished,w(u,"2dMap")||y(u._input,u,g,b));var L=g._alignmentOpts||{};for(o=0;o<x.length;o++){if(u=x[o],h="",!w(u,"2dMap")){if(l=T(u),g.barmode==="group"&&u.alignmentgroup){var A=u[l+"axis"],I=t(g,A)+u.orientation;(L[I]||{})[u.alignmentgroup]&&(h=I)}h||g.barmode==="overlay"||(h=t(g,u.xaxis)+t(g,u.yaxis)+T(u))}h?(f[h]||(f[h]=[]),f[h].push(u)):_.push(u)}for(h in f)if((s=f[h]).length!==1){var P=!1;for(s.length&&(u=s[0],P=b("bingroup")),h=P||h,o=0;o<s.length;o++){var S=(u=s[o])._input.bingroup;S&&S!==h&&d.warn(["Trace",u.index,"must match","within bingroup",h+".","Ignoring its bingroup:",S,"setting."].join(" ")),u.bingroup=h,k(u,h,T(u))}}else _.push(s[0]);for(o=0;o<_.length;o++){u=_[o];var E=b("bingroup");if(w(u,"2dMap"))for(c=0;c<2;c++){var z=b((l=a[c])+"bingroup",E?E+"__"+l:null);k(u,z,l)}else k(u,E,T(u))}for(h in i){var D=i[h];for(s=D.traces,p=0;p<n.length;p++){var j,V,Z=n[p],Q=Z.name;if(Q!=="nbins"||!D.sizeFound){for(o=0;o<s.length;o++){if(u=s[o],l=D.dirs[o],j=Z.aStr[l],e(u._input,j).get()!==void 0){D[Q]=b(j),D[Q+"Found"]=!0;break}(V=(u._autoBin||{})[l]||{})[Q]&&e(u,j).set(V[Q])}if(Q==="start"||Q==="end")for(;o<s.length;o++)(u=s[o])["_"+l+"bingroup"]&&b(j,(V=(u._autoBin||{})[l]||{})[Q]);Q!=="nbins"||D.sizeFound||D.nbinsFound||(u=s[0],D[Q]=b(j))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/color"),y=m("../bar/defaults").handleText,e=m("../bar/style_defaults"),t=m("./attributes");G.exports=function(n,a,r,g){function u(_,b){return v.coerce(n,a,t,_,b)}var s=u("x"),h=u("y");u("cumulative.enabled")&&(u("cumulative.direction"),u("cumulative.currentbin")),u("text");var l=u("textposition");y(n,a,g,u,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat");var o=u("orientation",h&&!s?"h":"v"),p=o==="v"?"x":"y",c=o==="v"?"y":"x",i=s&&h?Math.min(v.minRowLength(s)&&v.minRowLength(h)):v.minRowLength(a[p]||[]);if(i){a._length=i,d.getComponentMethod("calendars","handleTraceDefaults")(n,a,["x","y"],g),a[c]&&u("histfunc"),u("histnorm"),u("autobin"+p),e(n,a,u,r,g),v.coerceSelectionMarkerOpacity(a,u);var x=(a.marker.line||{}).color,f=d.getComponentMethod("errorbars","supplyDefaults");f(n,a,x||w.defaultLine,{axis:"y"}),f(n,a,x||w.defaultLine,{axis:"x",inherit:"y"})}else a.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(m,G,W){G.exports=function(d,v,w,y,e){if(d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"zLabelVal"in v&&(d.z=v.zLabelVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),!(w.cumulative||{}).enabled){var t,n=Array.isArray(e)?y[0].pts[e[0]][e[1]]:y[e].pts;if(d.pointNumbers=n,d.binNumber=d.pointNumber,delete d.pointNumber,delete d.pointIndex,w._indexToPoints){t=[];for(var a=0;a<n.length;a++)t=t.concat(w._indexToPoints[n[a]])}else t=n;d.pointIndices=t}return d}},{}],831:[function(m,G,W){var d=m("../bar/hover").hoverPoints,v=m("../../plots/cartesian/axes").hoverLabelText;G.exports=function(w,y,e,t,n){var a=d(w,y,e,t,n);if(a){var r=(w=a[0]).cd[w.index],g=w.cd[0].trace;if(!g.cumulative.enabled){var u=g.orientation==="h"?"y":"x";w[u+"Label"]=v(w[u+"a"],[r.ph0,r.ph1],g[u+"hoverformat"])}return a}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("../bar/layout_attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),supplyLayoutDefaults:m("../bar/layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("../bar/cross_trace_calc").crossTraceCalc,plot:m("../bar/plot").plot,layerName:"barlayer",style:m("../bar/style").style,styleOnSelect:m("../bar/style").styleOnSelect,colorbar:m("../scatter/marker_colorbar"),hoverPoints:m("./hover"),selectPoints:m("../bar/select"),eventData:m("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(m,G,W){G.exports={percent:function(d,v){for(var w=d.length,y=100/v,e=0;e<w;e++)d[e]*=y},probability:function(d,v){for(var w=d.length,y=0;y<w;y++)d[y]/=v},density:function(d,v,w,y){var e=d.length;y=y||1;for(var t=0;t<e;t++)d[t]*=w[t]*y},"probability density":function(d,v,w,y){var e=d.length;y&&(v/=y);for(var t=0;t<e;t++)d[t]*=w[t]/v}}},{}],834:[function(m,G,W){var d=m("../histogram/attributes"),v=m("../histogram/bin_attributes"),w=m("../heatmap/attributes"),y=m("../../plots/attributes"),e=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../plots/template_attributes").texttemplateAttrs,a=m("../../components/colorscale/attributes"),r=m("../../lib/extend").extendFlat;G.exports=r({x:d.x,y:d.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:v("x"),nbinsy:d.nbinsy,ybins:v("y"),autobinx:d.autobinx,autobiny:d.autobiny,bingroup:r({},d.bingroup,{}),xbingroup:r({},d.bingroup,{}),ybingroup:r({},d.bingroup,{}),xgap:w.xgap,ygap:w.ygap,zsmooth:w.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:t({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:w.textfont,showlegend:r({},y.showlegend,{dflt:!1})},a("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../histogram/bin_functions"),y=m("../histogram/norm_functions"),e=m("../histogram/average"),t=m("../histogram/bin_label_vals"),n=m("../histogram/calc").calcAllAutoBins;function a(u,s,h,l){var o,p=new Array(u);if(l)for(o=0;o<u;o++)p[o]=1/(s[o+1]-s[o]);else{var c=1/h;for(o=0;o<u;o++)p[o]=c}return p}function r(u,s){return{start:u(s.start),end:u(s.end),size:s.size}}function g(u,s,h,l,o,p){var c,i=u.length-1,x=new Array(i),f=t(h,l,u,o,p);for(c=0;c<i;c++){var _=(s||[])[c];x[c]=_===void 0?[f(u[c]),f(u[c+1],!0)]:[_,_]}return x}G.exports=function(u,s){var h,l,o,p,c=v.getFromId(u,s.xaxis),i=v.getFromId(u,s.yaxis),x=s.xcalendar,f=s.ycalendar,_=function(nt){return c.r2c(nt,0,x)},b=function(nt){return i.r2c(nt,0,f)},T=n(u,s,c,"x"),k=T[0],L=T[1],A=n(u,s,i,"y"),I=A[0],P=A[1],S=s._length;L.length>S&&L.splice(S,L.length-S),P.length>S&&P.splice(S,P.length-S);var E=[],z=[],D=[],j=typeof k.size=="string",V=typeof I.size=="string",Z=[],Q=[],K=j?Z:k,$=V?Q:I,ne=0,H=[],N=[],U=s.histnorm,te=s.histfunc,B=U.indexOf("density")!==-1,X=te==="max"||te==="min"?null:0,J=w.count,ee=y[U],re=!1,se=[],oe=[],de="z"in s?s.z:"marker"in s&&Array.isArray(s.marker.color)?s.marker.color:"";de&&te!=="count"&&(re=te==="avg",J=w[te]);var ce=k.size,ve=_(k.start),Ae=_(k.end)+(ve-v.tickIncrement(ve,ce,!1,x))/1e6;for(h=ve;h<Ae;h=v.tickIncrement(h,ce,!1,x))z.push(X),Z.push(h),re&&D.push(0);Z.push(h);var fe,me=z.length,_e=(h-ve)/me,le=(fe=ve+_e/2,c.c2r(fe,0,x)),ge=I.size,Te=b(I.start),Se=b(I.end)+(Te-v.tickIncrement(Te,ge,!1,f))/1e6;for(h=Te;h<Se;h=v.tickIncrement(h,ge,!1,f)){E.push(z.slice()),Q.push(h);var Me=new Array(me);for(l=0;l<me;l++)Me[l]=[];N.push(Me),re&&H.push(D.slice())}Q.push(h);var ze=E.length,Oe=(h-Te)/ze,De=function(nt){return i.c2r(nt,0,f)}(Te+Oe/2);B&&(se=a(z.length,K,_e,j),oe=a(E.length,$,Oe,V)),j||c.type!=="date"||(K=r(_,K)),V||i.type!=="date"||($=r(b,$));var Xe=!0,Be=!0,Ie=new Array(me),Re=new Array(ze),Ye=1/0,Qe=1/0,lt=1/0,xt=1/0;for(h=0;h<S;h++){var wt=L[h],bt=P[h];o=d.findBin(wt,K),p=d.findBin(bt,$),o>=0&&o<me&&p>=0&&p<ze&&(ne+=J(o,h,E[p],de,H[p]),N[p][o].push(h),Xe&&(Ie[o]===void 0?Ie[o]=wt:Ie[o]!==wt&&(Xe=!1)),Be&&(Re[p]===void 0?Re[p]=bt:Re[p]!==bt&&(Be=!1)),Ye=Math.min(Ye,wt-Z[o]),Qe=Math.min(Qe,Z[o+1]-wt),lt=Math.min(lt,bt-Q[p]),xt=Math.min(xt,Q[p+1]-bt))}if(re)for(p=0;p<ze;p++)ne+=e(E[p],H[p]);if(ee)for(p=0;p<ze;p++)ee(E[p],ne,se,oe[p]);return{x:L,xRanges:g(Z,Xe&&Ie,Ye,Qe,c,x),x0:le,dx:_e,y:P,yRanges:g(Q,Be&&Re,lt,xt,i,f),y0:De,dy:Oe,z:E,pts:N}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(m,G,W){var d=m("../../lib"),v=m("./sample_defaults"),w=m("../heatmap/style_defaults"),y=m("../../components/colorscale/defaults"),e=m("../heatmap/label_defaults"),t=m("./attributes");G.exports=function(n,a,r,g){function u(s,h){return d.coerce(n,a,t,s,h)}v(n,a,u,g),a.visible!==!1&&(w(n,a,u,g),y(n,a,g,u,{prefix:"",cLetter:"z"}),u("hovertemplate"),e(u,g),u("xhoverformat"),u("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(m,G,W){var d=m("../heatmap/hover"),v=m("../../plots/cartesian/axes").hoverLabelText;G.exports=function(w,y,e,t,n){var a=d(w,y,e,t,n);if(a){var r=(w=a[0]).index,g=r[0],u=r[1],s=w.cd[0],h=s.trace,l=s.xRanges[u],o=s.yRanges[g];return w.xLabel=v(w.xa,[l[0],l[1]],h.xhoverformat),w.yLabel=v(w.ya,[o[0],o[1]],h.yhoverformat),a}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../histogram/cross_trace_defaults"),calc:m("../heatmap/calc"),plot:m("../heatmap/plot"),layerName:"heatmaplayer",colorbar:m("../heatmap/colorbar"),style:m("../heatmap/style"),hoverPoints:m("./hover"),eventData:m("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(m,G,W){var d=m("../../registry"),v=m("../../lib");G.exports=function(w,y,e,t){var n=e("x"),a=e("y"),r=v.minRowLength(n),g=v.minRowLength(a);r&&g?(y._length=Math.min(r,g),d.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x","y"],t),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):y.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(m,G,W){var d=m("../histogram2d/attributes"),v=m("../contour/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../lib/extend").extendFlat;G.exports=e({x:d.x,y:d.y,z:d.z,marker:d.marker,histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:d.xbins,nbinsy:d.nbinsy,ybins:d.ybins,autobinx:d.autobinx,autobiny:d.autobiny,bingroup:d.bingroup,xbingroup:d.xbingroup,ybingroup:d.ybingroup,autocontour:v.autocontour,ncontours:v.ncontours,contours:v.contours,line:{color:v.line.color,width:e({},v.line.width,{dflt:.5}),dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:d.hovertemplate,texttemplate:v.texttemplate,textfont:v.textfont},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(m,G,W){var d=m("../../lib"),v=m("../histogram2d/sample_defaults"),w=m("../contour/contours_defaults"),y=m("../contour/style_defaults"),e=m("../heatmap/label_defaults"),t=m("./attributes");G.exports=function(n,a,r,g){function u(s,h){return d.coerce(n,a,t,s,h)}v(n,a,u,g),a.visible!==!1&&(w(n,a,u,function(s){return d.coerce2(n,a,t,s)}),y(n,a,u,g),u("xhoverformat"),u("yhoverformat"),u("hovertemplate"),a.contours&&a.contours.coloring==="heatmap"&&e(u,g))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../histogram/cross_trace_defaults"),calc:m("../contour/calc"),plot:m("../contour/plot").plot,layerName:"contourlayer",style:m("../contour/style"),colorbar:m("../contour/colorbar"),hoverPoints:m("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../components/colorscale/attributes"),y=m("../../plots/domain").attributes,e=m("../pie/attributes"),t=m("../sunburst/attributes"),n=m("../treemap/attributes"),a=m("../treemap/constants"),r=m("../../lib/extend").extendFlat;G.exports={labels:t.labels,parents:t.parents,values:t.values,branchvalues:t.branchvalues,count:t.count,level:t.level,maxdepth:t.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:r({colors:t.marker.colors,line:t.marker.line,editType:"calc"},w("marker",{colorAttr:"colors",anim:!1})),leaf:t.leaf,pathbar:n.pathbar,text:e.text,textinfo:t.textinfo,texttemplate:v({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:t.hoverinfo,hovertemplate:d({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:t.root,domain:y({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(m,G,W){var d=m("../../plots/plots");W.name="icicle",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],845:[function(m,G,W){var d=m("../sunburst/calc");W.calc=function(v,w){return d.calc(v,w)},W.crossTraceCalc=function(v){return d._runCrossTraceCalc("icicle",v)}},{"../sunburst/calc":1060}],846:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText,t=m("../bar/constants").TEXTPAD,n=m("../../components/colorscale"),a=n.hasColorscale,r=n.handleDefaults;G.exports=function(g,u,s,h){function l(_,b){return d.coerce(g,u,v,_,b)}var o=l("labels"),p=l("parents");if(o&&o.length&&p&&p.length){var c=l("values");c&&c.length?l("branchvalues"):l("count"),l("level"),l("maxdepth"),l("tiling.orientation"),l("tiling.flip"),l("tiling.pad");var i=l("text");l("texttemplate"),u.texttemplate||l("textinfo",Array.isArray(i)?"text+label":"label"),l("hovertext"),l("hovertemplate");var x=l("pathbar.visible");e(g,u,h,l,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition"),l("marker.line.width")&&l("marker.line.color",h.paper_bgcolor),l("marker.colors");var f=u._hasColorscale=a(g,"marker","colors")||(g.marker||{}).coloraxis;f&&r(g,u,h,l,{prefix:"marker.",cLetter:"c"}),l("leaf.opacity",f?1:.7),u._hovered={marker:{line:{width:2,color:w.contrast(h.paper_bgcolor)}}},x&&(l("pathbar.thickness",u.pathbar.textfont.size+2*t),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),y(u,h,l),u._length=null}else u.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("../treemap/constants"),a=m("../sunburst/helpers"),r=m("../sunburst/fx"),g=m("../sunburst/plot").formatSliceLabel;G.exports=function(u,s,h,l,o){var p=o.width,c=o.height,i=o.viewX,x=o.viewY,f=o.pathSlice,_=o.toMoveInsideSlice,b=o.strTransform,T=o.hasTransition,k=o.handleSlicesExit,L=o.makeUpdateSliceInterpolator,A=o.makeUpdateTextInterpolator,I=o.prevEntry,P=u._context.staticPlot,S=u._fullLayout,E=s[0].trace,z=E.textposition.indexOf("left")!==-1,D=E.textposition.indexOf("right")!==-1,j=E.textposition.indexOf("bottom")!==-1,V=e(h,[p,c],{flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,orientation:E.tiling.orientation,pad:{inner:E.tiling.pad},maxDepth:E._maxDepth}).descendants(),Z=1/0,Q=-1/0;V.forEach(function(N){var U=N.depth;U>=E._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(Z=Math.min(Z,U),Q=Math.max(Q,U))}),l=l.data(V,a.getPtId),E._maxVisibleLayers=isFinite(Q)?Q-Z+1:0,l.enter().append("g").classed("slice",!0),k(l,!1,{},[p,c],f),l.order();var K=null;if(T&&I){var $=a.getPtId(I);l.each(function(N){K===null&&a.getPtId(N)===$&&(K={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var ne=function(){return K||{x0:0,x1:p,y0:0,y1:c}},H=l;return T&&(H=H.transition().each("end",function(){var N=d.select(this);a.setSliceCursor(N,u,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),H.each(function(N){N._x0=i(N.x0),N._x1=i(N.x1),N._y0=x(N.y0),N._y1=x(N.y1),N._hoverX=i(N.x1-E.tiling.pad),N._hoverY=x(j?N.y1-E.tiling.pad/2:N.y0+E.tiling.pad/2);var U=d.select(this),te=v.ensureSingle(U,"path","surface",function(ee){ee.style("pointer-events",P?"none":"all")});T?te.transition().attrTween("d",function(ee){var re=L(ee,!1,ne(),[p,c],{orientation:E.tiling.orientation,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1});return function(se){return f(re(se))}}):te.attr("d",f),U.call(r,h,u,s,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,u,{isTransitioning:u._transitioning}),te.call(t,N,E,{hovered:!1}),N.x0===N.x1||N.y0===N.y1?N._text="":N._text=g(N,h,E,s,S)||"";var B=v.ensureSingle(U,"g","slicetext"),X=v.ensureSingle(B,"text","",function(ee){ee.attr("data-notex",1)}),J=v.ensureUniformFontSize(u,a.determineTextFont(E,N,S.font));X.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":z?"start":"middle").call(w.font,J).call(y.convertToTspans,u),N.textBB=w.bBox(X.node()),N.transform=_(N,{fontSize:J.size}),N.transform.fontSize=J.size,T?X.transition().attrTween("transform",function(ee){var re=A(ee,!1,ne(),[p,c]);return function(se){return b(re(se))}}):X.attr("transform",b(N))}),K}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(m,G,W){G.exports={moduleType:"trace",name:"icicle",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(m,G,W){G.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("iciclecolorway",y.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(m,G,W){var d=m("d3-hierarchy"),v=m("../treemap/flip_tree");G.exports=function(w,y,e){var t=e.flipX,n=e.flipY,a=e.orientation==="h",r=e.maxDepth,g=y[0],u=y[1];r&&(g=(w.height+1)*y[0]/Math.min(w.height+1,r),u=(w.height+1)*y[1]/Math.min(w.height+1,r));var s=d.partition().padding(e.pad.inner).size(a?[y[1],g]:[y[0],u])(w);return(a||t||n)&&v(s,y,{swapXY:a,flipX:t,flipY:n}),s}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(m,G,W){var d=m("../treemap/draw"),v=m("./draw_descendants");G.exports=function(w,y,e,t){return d(w,y,e,t,{type:"icicle",drawDescendants:v})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../bar/uniform_text").resizeText;function e(t,n,a){var r=n.data.data,g=!n.children,u=r.i,s=w.castOption(a,u,"marker.line.color")||v.defaultLine,h=w.castOption(a,u,"marker.line.width")||0;t.style("stroke-width",h).call(v.fill,r.color).call(v.stroke,s).style("opacity",g?a.leaf.opacity:null)}G.exports={style:function(t){var n=t._fullLayout._iciclelayer.selectAll(".trace");y(t,n,"icicle"),n.each(function(a){var r=d.select(this),g=a[0].trace;r.style("opacity",g.opacity),r.selectAll("path.surface").each(function(u){d.select(this).call(e,u,g)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(m,G,W){for(var d=m("../../plots/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],t=[],n=[],a=0;a<e.length;a++){var r=y[e[a]];t.push("For the `"+e[a]+"` colormodel, it is ["+(r.zminDflt||r.min).join(", ")+"]."),n.push("For the `"+e[a]+"` colormodel, it is ["+(r.zmaxDflt||r.max).join(", ")+"].")}G.exports=w({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:w({},d.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:v({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(m,G,W){var d=m("../../lib"),v=m("./constants"),w=m("fast-isnumeric"),y=m("../../plots/cartesian/axes"),e=m("../../lib").maxRowLength,t=m("./helpers").getImageSize;function n(r,g,u,s){return function(h){return d.constrain((h-r)*g,u,s)}}function a(r,g){return function(u){return d.constrain(u,r,g)}}G.exports=function(r,g){var u,s;if(g._hasZ)u=g.z.length,s=e(g.z);else if(g._hasSource){var h=t(g.source);u=h.height,s=h.width}var l,o=y.getFromId(r,g.xaxis||"x"),p=y.getFromId(r,g.yaxis||"y"),c=o.d2c(g.x0)-g.dx/2,i=p.d2c(g.y0)-g.dy/2,x=[c,c+s*g.dx],f=[i,i+u*g.dy];if(o&&o.type==="log")for(l=0;l<s;l++)x.push(c+l*g.dx);if(p&&p.type==="log")for(l=0;l<u;l++)f.push(i+l*g.dy);return g._extremes[o._id]=y.findExtremes(o,x),g._extremes[p._id]=y.findExtremes(p,f),g._scaler=function(_){var b=v.colormodel[_.colormodel],T=(b.colormodel||_.colormodel).length;_._sArray=[];for(var k=0;k<T;k++)b.min[k]!==_.zmin[k]||b.max[k]!==_.zmax[k]?_._sArray.push(n(_.zmin[k],(b.max[k]-b.min[k])/(_.zmax[k]-_.zmin[k]),b.min[k],b.max[k])):_._sArray.push(a(b.min[k],b.max[k]));return function(L){for(var A=L.slice(0,T),I=0;I<T;I++){var P=A[I];if(!w(P))return!1;A[I]=_._sArray[I](P)}return A}}(g),[{x0:c,y0:i,z:g.z,w:s,h:u}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(m,G,W){G.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(d){return d.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(d){return d.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(d){return d.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(d){var v=d.slice(0,3);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(d){var v=d.slice(0,4);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("./constants"),y=m("../../snapshot/helpers").IMAGE_URL_PREFIX;G.exports=function(e,t){function n(g,u){return d.coerce(e,t,v,g,u)}n("source"),t.source&&!t.source.match(y)&&delete t.source,t._hasSource=!!t.source;var a,r=n("z");t._hasZ=!(r===void 0||!r.length||!r[0]||!r[0].length),t._hasZ||t._hasSource?(n("x0"),n("y0"),n("dx"),n("dy"),t._hasZ?(n("colormodel","rgb"),n("zmin",(a=w.colormodel[t.colormodel]).zminDflt||a.min),n("zmax",a.zmaxDflt||a.max)):t._hasSource&&(t.colormodel="rgba256",a=w.colormodel[t.colormodel],t.zmin=a.zminDflt,t.zmax=a.zmaxDflt),n("zsmooth"),n("text"),n("hovertext"),n("hovertemplate"),t._length=null):t.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(m,G,W){G.exports=function(d,v){return"xVal"in v&&(d.x=v.xVal),"yVal"in v&&(d.y=v.yVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d.color=v.color,d.colormodel=v.trace.colormodel,d.z||(d.z=v.color),d}},{}],859:[function(m,G,W){var d=m("probe-image-size/sync"),v=m("../../snapshot/helpers").IMAGE_URL_PREFIX,w=m("buffer/").Buffer;W.getImageSize=function(y){var e=y.replace(v,""),t=new w(e,"base64");return d(t)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(m,G,W){var d=m("../../components/fx"),v=m("../../lib"),w=m("./constants");G.exports=function(y,e,t){var n=y.cd[0],a=n.trace,r=y.xa,g=y.ya;if(!(d.inbox(e-n.x0,e-(n.x0+n.w*a.dx),0)>0||d.inbox(t-n.y0,t-(n.y0+n.h*a.dy),0)>0)){var u,s=Math.floor((e-n.x0)/a.dx),h=Math.floor(Math.abs(t-n.y0)/a.dy);if(a._hasZ?u=n.z[h][s]:a._hasSource&&(u=a._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(s,h,1,1).data),u){var l,o=n.hi||a.hoverinfo;if(o){var p=o.split("+");p.indexOf("all")!==-1&&(p=["color"]),p.indexOf("color")!==-1&&(l=!0)}var c,i=w.colormodel[a.colormodel],x=i.colormodel||a.colormodel,f=x.length,_=a._scaler(u),b=i.suffix,T=[];(a.hovertemplate||l)&&(T.push("["+[_[0]+b[0],_[1]+b[1],_[2]+b[2]].join(", ")),f===4&&T.push(", "+_[3]+b[3]),T.push("]"),T=T.join(""),y.extraText=x.toUpperCase()+": "+T),Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[h])?c=a.hovertext[h][s]:Array.isArray(a.text)&&Array.isArray(a.text[h])&&(c=a.text[h][s]);var k=g.c2p(n.y0+(h+.5)*a.dy),L=n.x0+(s+.5)*a.dx,A=n.y0+(h+.5)*a.dy,I="["+u.slice(0,a.colormodel.length).join(", ")+"]";return[v.extendFlat(y,{index:[h,s],x0:r.c2p(n.x0+s*a.dx),x1:r.c2p(n.x0+(s+1)*a.dx),y0:k,y1:k,color:_,xVal:L,xLabelVal:L,yVal:A,yLabelVal:A,zLabelVal:I,text:c,hovertemplateLabels:{zLabel:I,colorLabel:T,"color[0]Label":_[0]+b[0],"color[1]Label":_[1]+b[1],"color[2]Label":_[2]+b[2],"color[3]Label":_[3]+b[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),style:m("./style"),hoverPoints:m("./hover"),eventData:m("./event_data"),moduleType:"trace",name:"image",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=v.strTranslate,y=m("../../constants/xmlns_namespaces"),e=m("./constants"),t=v.isIOS()||v.isSafari()||v.isIE();G.exports=function(n,a,r,g){var u=a.xaxis,s=a.yaxis,h=!(t||n._context._exportedPlot);v.makeTraceGroups(g,r,"im").each(function(l){var o=d.select(this),p=l[0],c=p.trace,i=(c.zsmooth==="fast"||c.zsmooth===!1&&h)&&!c._hasZ&&c._hasSource&&u.type==="linear"&&s.type==="linear";c._realImage=i;var x,f,_,b,T,k,L=p.z,A=p.x0,I=p.y0,P=p.w,S=p.h,E=c.dx,z=c.dy;for(k=0;x===void 0&&k<P;)x=u.c2p(A+k*E),k++;for(k=P;f===void 0&&k>0;)f=u.c2p(A+k*E),k--;for(k=0;b===void 0&&k<S;)b=s.c2p(I+k*z),k++;for(k=S;T===void 0&&k>0;)T=s.c2p(I+k*z),k--;f<x&&(_=f,f=x,x=_),T<b&&(_=b,b=T,T=_),!i&&(x=Math.max(-.5*u._length,x),f=Math.min(1.5*u._length,f),b=Math.max(-.5*s._length,b),T=Math.min(1.5*s._length,T));var D=Math.round(f-x),j=Math.round(T-b);if(D<=0||j<=0)o.selectAll("image").data([]).exit().remove();else{var V=o.selectAll("image").data([l]);V.enter().append("svg:image").attr({xmlns:y.svg,preserveAspectRatio:"none"}),V.exit().remove();var Z=c.zsmooth===!1?e.pixelatedStyle:"";if(i){var Q=v.simpleMap(u.range,u.r2l),K=v.simpleMap(s.range,s.r2l),$=Q[1]<Q[0],ne=K[1]>K[0];if($||ne){var H=x+D/2,N=b+j/2;Z+="transform:"+w(H+"px",N+"px")+"scale("+($?-1:1)+","+(ne?-1:1)+")"+w(-H+"px",-N+"px")+";"}}V.attr("style",Z);var U=new Promise(function(B){if(c._hasZ)B();else if(c._hasSource)if(c._canvas&&c._canvas.el.width===P&&c._canvas.el.height===S&&c._canvas.source===c.source)B();else{var X=document.createElement("canvas");X.width=P,X.height=S;var J=X.getContext("2d",{willReadFrequently:!0});c._image=c._image||new Image;var ee=c._image;ee.onload=function(){J.drawImage(ee,0,0),c._canvas={el:X,source:c.source},B()},ee.setAttribute("src",c.source)}}).then(function(){var B;if(c._hasZ)B=te(function(J,ee){return L[ee][J]}).toDataURL("image/png");else if(c._hasSource)if(i)B=c.source;else{var X=c._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,P,S).data;B=te(function(J,ee){var re=4*(ee*P+J);return[X[re],X[re+1],X[re+2],X[re+3]]}).toDataURL("image/png")}V.attr({"xlink:href":B,height:j,width:D,x,y:b})});n._promises.push(U)}function te(B){var X=document.createElement("canvas");X.width=D,X.height=j;var J,ee=X.getContext("2d",{willReadFrequently:!0}),re=function(le){return v.constrain(Math.round(u.c2p(A+le*E)-x),0,D)},se=function(le){return v.constrain(Math.round(s.c2p(I+le*z)-b),0,j)},oe=e.colormodel[c.colormodel],de=oe.colormodel||c.colormodel,ce=oe.fmt;for(k=0;k<p.w;k++){var ve=re(k),Ae=re(k+1);if(Ae!==ve&&!isNaN(Ae)&&!isNaN(ve))for(var fe=0;fe<p.h;fe++){var me=se(fe),_e=se(fe+1);_e===me||isNaN(_e)||isNaN(me)||!B(k,fe)||(J=c._scaler(B(k,fe)),ee.fillStyle=J?de+"("+ce(J).join(",")+")":"rgba(0,0,0,0)",ee.fillRect(ve,me,Ae-ve,_e-me))}}return X}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(m,G,W){var d=m("@plotly/d3");G.exports=function(v){d.select(v).selectAll(".im image").style("opacity",function(w){return w[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(m,G,W){var d=m("../../lib/extend").extendFlat,v=m("../../lib/extend").extendDeep,w=m("../../plot_api/edit_types").overrideAll,y=m("../../plots/font_attributes"),e=m("../../components/color/attributes"),t=m("../../plots/domain").attributes,n=m("../../plots/cartesian/layout_attributes"),a=m("../../plot_api/plot_template").templatedArray,r=m("../../constants/delta.js"),g=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,u=y({editType:"plot",colorEditType:"plot"}),s={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},h={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},l=a("step",v({},s,{range:h}));G.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:t({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:d({},u,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:g("value")},font:d({},u,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:g("value")},increasing:{symbol:{valType:"string",dflt:r.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:r.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:d({},u,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:v({},s,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:w({range:h,visible:d({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:d({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:y({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:l,threshold:{line:{color:d({},s.line.color,{}),width:d({},s.line.width,{dflt:1}),editType:"plot"},thickness:d({},s.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(m,G,W){var d=m("../../plots/plots");W.name="indicator",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],866:[function(m,G,W){G.exports={calc:function(d,v){var w=[],y=v.value;typeof v._lastValue!="number"&&(v._lastValue=v.value);var e=v._lastValue,t=e;return v._hasDelta&&typeof v.delta.reference=="number"&&(t=v.delta.reference),w[0]={y,lastY:e,delta:y-t,relativeDelta:(y-t)/t},w}}},{}],867:[function(m,G,W){G.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../../plot_api/plot_template"),e=m("../../plots/array_container_defaults"),t=m("./constants.js"),n=m("../../plots/cartesian/tick_value_defaults"),a=m("../../plots/cartesian/tick_mark_defaults"),r=m("../../plots/cartesian/tick_label_defaults"),g=m("../../plots/cartesian/prefix_suffix_defaults");function u(s,h){function l(o,p){return d.coerce(s,h,v.gauge.steps,o,p)}l("color"),l("line.color"),l("line.width"),l("range"),l("thickness")}G.exports={supplyDefaults:function(s,h,l,o){function p(P,S){return d.coerce(s,h,v,P,S)}w(h,o,p),p("mode"),h._hasNumber=h.mode.indexOf("number")!==-1,h._hasDelta=h.mode.indexOf("delta")!==-1,h._hasGauge=h.mode.indexOf("gauge")!==-1;var c=p("value");h._range=[0,typeof c=="number"?1.5*c:1];var i,x,f,_,b,T,k=new Array(2);function L(P,S){return d.coerce(f,_,v.gauge,P,S)}function A(P,S){return d.coerce(b,T,v.gauge.axis,P,S)}if(h._hasNumber&&(p("number.valueformat"),p("number.font.color",o.font.color),p("number.font.family",o.font.family),p("number.font.size"),h.number.font.size===void 0&&(h.number.font.size=t.defaultNumberFontSize,k[0]=!0),p("number.prefix"),p("number.suffix"),i=h.number.font.size),h._hasDelta&&(p("delta.font.color",o.font.color),p("delta.font.family",o.font.family),p("delta.font.size"),h.delta.font.size===void 0&&(h.delta.font.size=(h._hasNumber?.5:1)*(i||t.defaultNumberFontSize),k[1]=!0),p("delta.reference",h.value),p("delta.relative"),p("delta.valueformat",h.delta.relative?"2%":""),p("delta.increasing.symbol"),p("delta.increasing.color"),p("delta.decreasing.symbol"),p("delta.decreasing.color"),p("delta.position"),p("delta.prefix"),p("delta.suffix"),x=h.delta.font.size),h._scaleNumbers=(!h._hasNumber||k[0])&&(!h._hasDelta||k[1])||!1,p("title.font.color",o.font.color),p("title.font.family",o.font.family),p("title.font.size",.25*(i||x||t.defaultNumberFontSize)),p("title.text"),h._hasGauge){(f=s.gauge)||(f={}),_=y.newContainer(h,"gauge"),L("shape"),(h._isBullet=h.gauge.shape==="bullet")||p("title.align","center"),(h._isAngular=h.gauge.shape==="angular")||p("align","center"),L("bgcolor",o.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width"),L("bar.thickness",t.valueThickness*(h.gauge.shape==="bullet"?.5:1)),e(f,_,{name:"steps",handleItemDefaults:u}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},f&&(b=f.axis||{}),T=y.newContainer(_,"axis"),A("visible"),h._range=A("range",h._range);var I={outerTicks:!0};n(b,T,A,"linear"),g(b,T,A,"linear",I),r(b,T,A,"linear",I),a(b,T,A,I)}else p("title.align","center"),p("align","center"),h._isAngular=h._isBullet=!1;h._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(m,G,W){G.exports={moduleType:"trace",name:"indicator",basePlotModule:m("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,calc:m("./calc").calc,plot:m("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolate,w=m("d3-interpolate").interpolateNumber,y=m("../../lib"),e=y.strScale,t=y.strTranslate,n=y.rad2deg,a=m("../../constants/alignment").MID_SHIFT,r=m("../../components/drawing"),g=m("./constants"),u=m("../../lib/svg_text_utils"),s=m("../../plots/cartesian/axes"),h=m("../../plots/cartesian/axis_defaults"),l=m("../../plots/cartesian/position_defaults"),o=m("../../plots/cartesian/layout_attributes"),p=m("../../components/color"),c={left:"start",center:"middle",right:"end"},i={left:0,center:.5,right:1},x=/[yzafpn\xb5mkMGTPEZY]/;function f(A){return A&&A.duration>0}function _(A){A.each(function(I){p.stroke(d.select(this),I.line.color)}).each(function(I){p.fill(d.select(this),I.color)}).style("stroke-width",function(I){return I.line.width})}function b(A,I,P){var S=A._fullLayout,E=y.extendFlat({type:"linear",ticks:"outside",range:P,showline:!0},I),z={type:"linear",_id:"x"+I._id},D={letter:"x",font:S.font,noHover:!0,noTickson:!0};function j(V,Z){return y.coerce(E,z,o,V,Z)}return h(E,z,j,D,S),l(E,z,j,D),z}function T(A,I,P){return[Math.min(I/A.width,P/A.height),A,I+"x"+P]}function k(A,I,P,S){var E=document.createElementNS("http://www.w3.org/2000/svg","text"),z=d.select(E);return z.text(A).attr("x",0).attr("y",0).attr("text-anchor",P).attr("data-unformatted",A).call(u.convertToTspans,S).call(r.font,I),r.bBox(z.node())}function L(A,I,P,S,E,z){var D="_cache"+I;A[D]&&A[D].key===E||(A[D]={key:E,value:P});var j=y.aggNums(z,null,[A[D].value,S],2);return A[D].value=j,j}G.exports=function(A,I,P,S){var E,z=A._fullLayout;f(P)&&S&&(E=S()),y.makeTraceGroups(z._indicatorlayer,I,"trace").each(function(D){var j,V,Z,Q,K,$=D[0].trace,ne=d.select(this),H=$._hasGauge,N=$._isAngular,U=$._isBullet,te=$.domain,B={w:z._size.w*(te.x[1]-te.x[0]),h:z._size.h*(te.y[1]-te.y[0]),l:z._size.l+z._size.w*te.x[0],r:z._size.r+z._size.w*(1-te.x[1]),t:z._size.t+z._size.h*(1-te.y[1]),b:z._size.b+z._size.h*te.y[0]},X=B.l+B.w/2,J=B.t+B.h/2,ee=Math.min(B.w/2,B.h),re=g.innerRadius*ee,se=$.align||"center";if(V=J,H){if(N&&(j=X,V=J+ee/2,Z=function(_e){return function(le,ge){var Te=Math.sqrt(le.width/2*(le.width/2)+le.height*le.height);return[ge/Te,le,ge]}(_e,.9*re)}),U){var oe=g.bulletPadding,de=1-g.bulletNumberDomainSize+oe;j=B.l+(de+(1-de)*i[se])*B.w,Z=function(_e){return T(_e,(g.bulletNumberDomainSize-oe)*B.w,B.h)}}}else j=B.l+i[se]*B.w,Z=function(_e){return T(_e,B.w,B.h)};(function(_e,le,ge,Te){var Se,Me,ze,Oe=ge[0].trace,De=Te.numbersX,Xe=Te.numbersY,Be=Oe.align||"center",Ie=c[Be],Re=Te.transitionOpts,Ye=Te.onComplete,Qe=y.ensureSingle(le,"g","numbers"),lt=[];Oe._hasNumber&&lt.push("number"),Oe._hasDelta&&(lt.push("delta"),Oe.delta.position==="left"&&lt.reverse());var xt=Qe.selectAll("text").data(lt);function wt(Wt,ar,Dt,Ne){if(!Wt.match("s")||Dt>=0==Ne>=0||ar(Dt).slice(-1).match(x)||ar(Ne).slice(-1).match(x))return ar;var qe=Wt.slice().replace("s","f").replace(/\d+/,function(be){return parseInt(be)-1}),pe=b(_e,{tickformat:qe});return function(be){return Math.abs(be)<1?s.tickText(pe,be).text:ar(be)}}xt.enter().append("text"),xt.attr("text-anchor",function(){return Ie}).attr("class",function(Wt){return Wt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),xt.exit().remove();var bt,nt=Oe.mode+Oe.align;if(Oe._hasDelta&&(bt=function(){var Wt=b(_e,{tickformat:Oe.delta.valueformat},Oe._range);Wt.setScale(),s.prepTicks(Wt);var ar=function(Ke){return s.tickText(Wt,Ke).text},Dt=Oe.delta.suffix,Ne=Oe.delta.prefix,qe=function(Ke){return Oe.delta.relative?Ke.relativeDelta:Ke.delta},pe=function(Ke,Ge){return Ke===0||typeof Ke!="number"||isNaN(Ke)?"-":(Ke>0?Oe.delta.increasing.symbol:Oe.delta.decreasing.symbol)+Ne+Ge(Ke)+Dt},be=function(Ke){return Ke.delta>=0?Oe.delta.increasing.color:Oe.delta.decreasing.color};Oe._deltaLastValue===void 0&&(Oe._deltaLastValue=qe(ge[0]));var Fe=Qe.select("text.delta");function Ve(){Fe.text(pe(qe(ge[0]),ar)).call(p.fill,be(ge[0])).call(u.convertToTspans,_e)}return Fe.call(r.font,Oe.delta.font).call(p.fill,be({delta:Oe._deltaLastValue})),f(Re)?Fe.transition().duration(Re.duration).ease(Re.easing).tween("text",function(){var Ke=d.select(this),Ge=qe(ge[0]),ct=Oe._deltaLastValue,st=wt(Oe.delta.valueformat,ar,ct,Ge),Mt=w(ct,Ge);return Oe._deltaLastValue=Ge,function(Ot){Ke.text(pe(Mt(Ot),st)),Ke.call(p.fill,be({delta:Mt(Ot)}))}}).each("end",function(){Ve(),Ye&&Ye()}).each("interrupt",function(){Ve(),Ye&&Ye()}):Ve(),Me=k(pe(qe(ge[0]),ar),Oe.delta.font,Ie,_e),Fe}(),nt+=Oe.delta.position+Oe.delta.font.size+Oe.delta.font.family+Oe.delta.valueformat,nt+=Oe.delta.increasing.symbol+Oe.delta.decreasing.symbol,ze=Me),Oe._hasNumber&&(function(){var Wt=b(_e,{tickformat:Oe.number.valueformat},Oe._range);Wt.setScale(),s.prepTicks(Wt);var ar=function(be){return s.tickText(Wt,be).text},Dt=Oe.number.suffix,Ne=Oe.number.prefix,qe=Qe.select("text.number");function pe(){var be=typeof ge[0].y=="number"?Ne+ar(ge[0].y)+Dt:"-";qe.text(be).call(r.font,Oe.number.font).call(u.convertToTspans,_e)}f(Re)?qe.transition().duration(Re.duration).ease(Re.easing).each("end",function(){pe(),Ye&&Ye()}).each("interrupt",function(){pe(),Ye&&Ye()}).attrTween("text",function(){var be=d.select(this),Fe=w(ge[0].lastY,ge[0].y);Oe._lastValue=ge[0].y;var Ve=wt(Oe.number.valueformat,ar,ge[0].lastY,ge[0].y);return function(Ke){be.text(Ne+Ve(Fe(Ke))+Dt)}}):pe(),Se=k(Ne+ar(ge[0].y)+Dt,Oe.number.font,Ie,_e)}(),nt+=Oe.number.font.size+Oe.number.font.family+Oe.number.valueformat+Oe.number.suffix+Oe.number.prefix,ze=Se),Oe._hasDelta&&Oe._hasNumber){var $e,vt,Nt=[(Se.left+Se.right)/2,(Se.top+Se.bottom)/2],qt=[(Me.left+Me.right)/2,(Me.top+Me.bottom)/2],Jt=.75*Oe.delta.font.size;Oe.delta.position==="left"&&($e=L(Oe,"deltaPos",0,-1*(Se.width*i[Oe.align]+Me.width*(1-i[Oe.align])+Jt),nt,Math.min),vt=Nt[1]-qt[1],ze={width:Se.width+Me.width+Jt,height:Math.max(Se.height,Me.height),left:Me.left+$e,right:Se.right,top:Math.min(Se.top,Me.top+vt),bottom:Math.max(Se.bottom,Me.bottom+vt)}),Oe.delta.position==="right"&&($e=L(Oe,"deltaPos",0,Se.width*(1-i[Oe.align])+Me.width*i[Oe.align]+Jt,nt,Math.max),vt=Nt[1]-qt[1],ze={width:Se.width+Me.width+Jt,height:Math.max(Se.height,Me.height),left:Se.left,right:Me.right+$e,top:Math.min(Se.top,Me.top+vt),bottom:Math.max(Se.bottom,Me.bottom+vt)}),Oe.delta.position==="bottom"&&($e=null,vt=Me.height,ze={width:Math.max(Se.width,Me.width),height:Se.height+Me.height,left:Math.min(Se.left,Me.left),right:Math.max(Se.right,Me.right),top:Se.bottom-Se.height,bottom:Se.bottom+Me.height}),Oe.delta.position==="top"&&($e=null,vt=Se.top,ze={width:Math.max(Se.width,Me.width),height:Se.height+Me.height,left:Math.min(Se.left,Me.left),right:Math.max(Se.right,Me.right),top:Se.bottom-Se.height-Me.height,bottom:Se.bottom}),bt.attr({dx:$e,dy:vt})}(Oe._hasNumber||Oe._hasDelta)&&Qe.attr("transform",function(){var Wt=Te.numbersScaler(ze);nt+=Wt[2];var ar,Dt=L(Oe,"numbersScale",1,Wt[0],nt,Math.min);Oe._scaleNumbers||(Dt=1),ar=Oe._isAngular?Xe-Dt*ze.bottom:Xe-Dt*(ze.top+ze.bottom)/2,Oe._numbersTop=Dt*ze.top+ar;var Ne=ze[Be];Be==="center"&&(Ne=(ze.left+ze.right)/2);var qe=De-Dt*Ne;return qe=L(Oe,"numbersTranslate",0,qe,nt,Math.max),t(qe,ar)+e(Dt)})})(A,ne,D,{numbersX:j,numbersY:V,numbersScaler:Z,transitionOpts:P,onComplete:E}),H&&(Q={range:$.gauge.axis.range,color:$.gauge.bgcolor,line:{color:$.gauge.bordercolor,width:0},thickness:1},K={range:$.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:$.gauge.bordercolor,width:$.gauge.borderwidth},thickness:1});var ce=ne.selectAll("g.angular").data(N?D:[]);ce.exit().remove();var ve=ne.selectAll("g.angularaxis").data(N?D:[]);ve.exit().remove(),N&&function(_e,le,ge,Te){var Se,Me,ze,Oe,De=ge[0].trace,Xe=Te.size,Be=Te.radius,Ie=Te.innerRadius,Re=Te.gaugeBg,Ye=Te.gaugeOutline,Qe=[Xe.l+Xe.w/2,Xe.t+Xe.h/2+Be/2],lt=Te.gauge,xt=Te.layer,wt=Te.transitionOpts,bt=Te.onComplete,nt=Math.PI/2;function $e(Ot){var it=De.gauge.axis.range[0],ht=(Ot-it)/(De.gauge.axis.range[1]-it)*Math.PI-nt;return ht<-nt?-nt:ht>nt?nt:ht}function vt(Ot){return d.svg.arc().innerRadius((Ie+Be)/2-Ot/2*(Be-Ie)).outerRadius((Ie+Be)/2+Ot/2*(Be-Ie)).startAngle(-nt)}function Nt(Ot){Ot.attr("d",function(it){return vt(it.thickness).startAngle($e(it.range[0])).endAngle($e(it.range[1]))()})}lt.enter().append("g").classed("angular",!0),lt.attr("transform",t(Qe[0],Qe[1])),xt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),xt.selectAll("g.xangularaxistick,path,text").remove(),(Se=b(_e,De.gauge.axis)).type="linear",Se.range=De.gauge.axis.range,Se._id="xangularaxis",Se.ticklabeloverflow="allow",Se.setScale();var qt=function(Ot){return(Se.range[0]-Ot.x)/(Se.range[1]-Se.range[0])*Math.PI+Math.PI},Jt={},Wt=s.makeLabelFns(Se,0).labelStandoff;Jt.xFn=function(Ot){var it=qt(Ot);return Math.cos(it)*Wt},Jt.yFn=function(Ot){var it=qt(Ot),ht=Math.sin(it)>0?.2:1;return-Math.sin(it)*(Wt+Ot.fontSize*ht)+Math.abs(Math.cos(it))*(Ot.fontSize*a)},Jt.anchorFn=function(Ot){var it=qt(Ot),ht=Math.cos(it);return Math.abs(ht)<.1?"middle":ht>0?"start":"end"},Jt.heightFn=function(Ot,it,ht){var jt=qt(Ot);return-.5*(1+Math.sin(jt))*ht};var ar=function(Ot){return t(Qe[0]+Be*Math.cos(Ot),Qe[1]-Be*Math.sin(Ot))};if(ze=function(Ot){return ar(qt(Ot))},Me=s.calcTicks(Se),Oe=s.getTickSigns(Se)[2],Se.visible){Oe=Se.ticks==="inside"?-1:1;var Dt=(Se.linewidth||1)/2;s.drawTicks(_e,Se,{vals:Me,layer:xt,path:"M"+Oe*Dt+",0h"+Oe*Se.ticklen,transFn:function(Ot){var it=qt(Ot);return ar(it)+"rotate("+-n(it)+")"}}),s.drawLabels(_e,Se,{vals:Me,layer:xt,transFn:ze,labelFns:Jt})}var Ne=[Re].concat(De.gauge.steps),qe=lt.selectAll("g.bg-arc").data(Ne);qe.enter().append("g").classed("bg-arc",!0).append("path"),qe.select("path").call(Nt).call(_),qe.exit().remove();var pe=vt(De.gauge.bar.thickness),be=lt.selectAll("g.value-arc").data([De.gauge.bar]);be.enter().append("g").classed("value-arc",!0).append("path");var Fe=be.select("path");f(wt)?(Fe.transition().duration(wt.duration).ease(wt.easing).each("end",function(){bt&&bt()}).each("interrupt",function(){bt&&bt()}).attrTween("d",(Ve=pe,Ke=$e(ge[0].lastY),Ge=$e(ge[0].y),function(){var Ot=v(Ke,Ge);return function(it){return Ve.endAngle(Ot(it))()}})),De._lastValue=ge[0].y):Fe.attr("d",typeof ge[0].y=="number"?pe.endAngle($e(ge[0].y)):"M0,0Z");var Ve,Ke,Ge;Fe.call(_),be.exit().remove(),Ne=[];var ct=De.gauge.threshold.value;(ct||ct===0)&&Ne.push({range:[ct,ct],color:De.gauge.threshold.color,line:{color:De.gauge.threshold.line.color,width:De.gauge.threshold.line.width},thickness:De.gauge.threshold.thickness});var st=lt.selectAll("g.threshold-arc").data(Ne);st.enter().append("g").classed("threshold-arc",!0).append("path"),st.select("path").call(Nt).call(_),st.exit().remove();var Mt=lt.selectAll("g.gauge-outline").data([Ye]);Mt.enter().append("g").classed("gauge-outline",!0).append("path"),Mt.select("path").call(Nt).call(_),Mt.exit().remove()}(A,0,D,{radius:ee,innerRadius:re,gauge:ce,layer:ve,size:B,gaugeBg:Q,gaugeOutline:K,transitionOpts:P,onComplete:E});var Ae=ne.selectAll("g.bullet").data(U?D:[]);Ae.exit().remove();var fe=ne.selectAll("g.bulletaxis").data(U?D:[]);fe.exit().remove(),U&&function(_e,le,ge,Te){var Se,Me,ze,Oe,De,Xe=ge[0].trace,Be=Te.gauge,Ie=Te.layer,Re=Te.gaugeBg,Ye=Te.gaugeOutline,Qe=Te.size,lt=Xe.domain,xt=Te.transitionOpts,wt=Te.onComplete;Be.enter().append("g").classed("bullet",!0),Be.attr("transform",t(Qe.l,Qe.t)),Ie.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Ie.selectAll("g.xbulletaxistick,path,text").remove();var bt=Qe.h,nt=Xe.gauge.bar.thickness*bt,$e=lt.x[0],vt=lt.x[0]+(lt.x[1]-lt.x[0])*(Xe._hasNumber||Xe._hasDelta?1-g.bulletNumberDomainSize:1);(Se=b(_e,Xe.gauge.axis))._id="xbulletaxis",Se.domain=[$e,vt],Se.setScale(),Me=s.calcTicks(Se),ze=s.makeTransTickFn(Se),Oe=s.getTickSigns(Se)[2],De=Qe.t+Qe.h,Se.visible&&(s.drawTicks(_e,Se,{vals:Se.ticks==="inside"?s.clipEnds(Se,Me):Me,layer:Ie,path:s.makeTickPath(Se,De,Oe),transFn:ze}),s.drawLabels(_e,Se,{vals:Me,layer:Ie,transFn:ze,labelFns:s.makeLabelFns(Se,De)}));function Nt(qe){qe.attr("width",function(pe){return Math.max(0,Se.c2p(pe.range[1])-Se.c2p(pe.range[0]))}).attr("x",function(pe){return Se.c2p(pe.range[0])}).attr("y",function(pe){return .5*(1-pe.thickness)*bt}).attr("height",function(pe){return pe.thickness*bt})}var qt=[Re].concat(Xe.gauge.steps),Jt=Be.selectAll("g.bg-bullet").data(qt);Jt.enter().append("g").classed("bg-bullet",!0).append("rect"),Jt.select("rect").call(Nt).call(_),Jt.exit().remove();var Wt=Be.selectAll("g.value-bullet").data([Xe.gauge.bar]);Wt.enter().append("g").classed("value-bullet",!0).append("rect"),Wt.select("rect").attr("height",nt).attr("y",(bt-nt)/2).call(_),f(xt)?Wt.select("rect").transition().duration(xt.duration).ease(xt.easing).each("end",function(){wt&&wt()}).each("interrupt",function(){wt&&wt()}).attr("width",Math.max(0,Se.c2p(Math.min(Xe.gauge.axis.range[1],ge[0].y)))):Wt.select("rect").attr("width",typeof ge[0].y=="number"?Math.max(0,Se.c2p(Math.min(Xe.gauge.axis.range[1],ge[0].y))):0),Wt.exit().remove();var ar=ge.filter(function(){return Xe.gauge.threshold.value||Xe.gauge.threshold.value===0}),Dt=Be.selectAll("g.threshold-bullet").data(ar);Dt.enter().append("g").classed("threshold-bullet",!0).append("line"),Dt.select("line").attr("x1",Se.c2p(Xe.gauge.threshold.value)).attr("x2",Se.c2p(Xe.gauge.threshold.value)).attr("y1",(1-Xe.gauge.threshold.thickness)/2*bt).attr("y2",(1-(1-Xe.gauge.threshold.thickness)/2)*bt).call(p.stroke,Xe.gauge.threshold.line.color).style("stroke-width",Xe.gauge.threshold.line.width),Dt.exit().remove();var Ne=Be.selectAll("g.gauge-outline").data([Ye]);Ne.enter().append("g").classed("gauge-outline",!0).append("rect"),Ne.select("rect").call(Nt).call(_),Ne.exit().remove()}(A,0,D,{gauge:Ae,layer:fe,size:B,gaugeBg:Q,gaugeOutline:K,transitionOpts:P,onComplete:E});var me=ne.selectAll("text.title").data(D);me.exit().remove(),me.enter().append("text").classed("title",!0),me.attr("text-anchor",function(){return U?c.right:c[$.title.align]}).text($.title.text).call(r.font,$.title.font).call(u.convertToTspans,A),me.attr("transform",function(){var _e,le=B.l+B.w*i[$.title.align],ge=g.titlePadding,Te=r.bBox(me.node());return H?(N&&($.gauge.axis.visible?_e=r.bBox(ve.node()).top-ge-Te.bottom:_e=B.t+B.h/2-ee/2-Te.bottom-ge),U&&(_e=V-(Te.top+Te.bottom)/2,le=B.l-g.bulletPadding*B.w)):_e=$._numbersTop-ge-Te.bottom,t(le,_e)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll,a=G.exports=n(t({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:w(),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),valuehoverformat:v("value",1),showlegend:t({},e.showlegend,{dflt:!1})},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,lightposition:y.lightposition,lighting:y.lighting,flatshading:y.flatshading,contour:y.contour,hoverinfo:t({},e.hoverinfo)}),"calc","nested");a.flatshading.dflt=!0,a.lighting.facenormalsepsilon.dflt=0,a.x.editType=a.y.editType=a.z.editType=a.value.editType="calc+clearAxisTypes",a.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(m,G,W){var d=m("../../components/colorscale/calc"),v=m("../streamtube/calc").processGrid,w=m("../streamtube/calc").filter;G.exports=function(y,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=w(e.x,e._len),e._y=w(e.y,e._len),e._z=w(e.z,e._len),e._value=w(e.value,e._len);var t=v(e);e._gridFill=t.fill,e._Xs=t.Xs,e._Ys=t.Ys,e._Zs=t.Zs,e._len=t.len;for(var n=1/0,a=-1/0,r=0;r<e._len;r++){var g=e._value[r];n=Math.min(n,g),a=Math.max(a,g)}e._minValues=n,e._maxValues=a,e._vMin=e.isomin===void 0||e.isomin===null?n:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?a:e.isomax,d(y,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(m,G,W){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../lib/gl_format_color").parseColorScale,w=m("../../lib/str2rgbarray"),y=m("../../components/colorscale").extractOpts,e=m("../../plots/gl3d/zip3"),t=function(u,s){for(var h=s.length-1;h>0;h--){var l=Math.min(s[h],s[h-1]),o=Math.max(s[h],s[h-1]);if(o>l&&l<u&&u<=o)return{id:h,distRatio:(o-u)/(o-l)}}return{id:0,distRatio:0}};function n(u,s,h){this.scene=u,this.uid=h,this.mesh=s,this.name="",this.data=null,this.showContour=!1}var a=n.prototype;a.handlePick=function(u){if(u.object===this.mesh){var s=u.data.index,h=this.data._meshX[s],l=this.data._meshY[s],o=this.data._meshZ[s],p=this.data._Ys.length,c=this.data._Zs.length,i=t(h,this.data._Xs).id,x=t(l,this.data._Ys).id,f=t(o,this.data._Zs).id,_=u.index=f+c*x+c*p*i;u.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&b[_]!==void 0?u.textLabel=b[_]:b&&(u.textLabel=b),!0}},a.update=function(u){var s=this.scene,h=s.fullSceneLayout;function l(c,i,x,f){return i.map(function(_){return c.d2l(_,0,f)*x})}this.data=g(u);var o={positions:e(l(h.xaxis,u._meshX,s.dataScale[0],u.xcalendar),l(h.yaxis,u._meshY,s.dataScale[1],u.ycalendar),l(h.zaxis,u._meshZ,s.dataScale[2],u.zcalendar)),cells:e(u._meshI,u._meshJ,u._meshK),lightPosition:[u.lightposition.x,u.lightposition.y,u.lightposition.z],ambient:u.lighting.ambient,diffuse:u.lighting.diffuse,specular:u.lighting.specular,roughness:u.lighting.roughness,fresnel:u.lighting.fresnel,vertexNormalsEpsilon:u.lighting.vertexnormalsepsilon,faceNormalsEpsilon:u.lighting.facenormalsepsilon,opacity:u.opacity,contourEnable:u.contour.show,contourColor:w(u.contour.color).slice(0,3),contourWidth:u.contour.width,useFacetNormals:u.flatshading},p=y(u);o.vertexIntensity=u._meshIntensity,o.vertexIntensityBounds=[p.min,p.max],o.colormap=v(u),this.mesh.update(o)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var r=["xyz","xzy","yxz","yzx","zxy","zyx"];function g(u){u._meshI=[],u._meshJ=[],u._meshK=[];var s,h,l,o,p,c,i,x=u.surface.show,f=u.spaceframe.show,_=u.surface.fill,b=u.spaceframe.fill,T=!1,k=!1,L=0,A=u._Xs,I=u._Ys,P=u._Zs,S=A.length,E=I.length,z=P.length,D=r.indexOf(u._gridFill.replace(/-/g,"").replace(/\+/g,"")),j=function(Be,Ie,Re){switch(D){case 5:return Re+z*Ie+z*E*Be;case 4:return Re+z*Be+z*S*Ie;case 3:return Ie+E*Re+E*z*Be;case 2:return Ie+E*Be+E*S*Re;case 1:return Be+S*Re+S*z*Ie;default:return Be+S*Ie+S*E*Re}},V=u._minValues,Z=u._maxValues,Q=u._vMin,K=u._vMax;function $(Be,Ie,Re){for(var Ye=c.length,Qe=h;Qe<Ye;Qe++)if(Be===l[Qe]&&Ie===o[Qe]&&Re===p[Qe])return Qe;return-1}function ne(){h=s}function H(){l=[],o=[],p=[],c=[],s=0,ne()}function N(Be,Ie,Re,Ye){return l.push(Be),o.push(Ie),p.push(Re),c.push(Ye),++s-1}function U(Be,Ie,Re){for(var Ye=[],Qe=0;Qe<Be.length;Qe++)Ye[Qe]=Be[Qe]*(1-Re)+Re*Ie[Qe];return Ye}function te(Be){i=Be}function B(Be,Ie){return Be==="all"||Be===null||Be.indexOf(Ie)>-1}function X(Be,Ie){return Be===null?Ie:Be}function J(Be,Ie,Re){ne();var Ye,Qe,lt,xt=[Ie],wt=[Re];if(i>=1)xt=[Ie],wt=[Re];else if(i>0){var bt=function(Dt,Ne){var qe=Dt[0],pe=Dt[1],be=Dt[2],Fe=function(it,ht,jt){for(var kt=[],Pt=0;Pt<it.length;Pt++)kt[Pt]=(it[Pt]+ht[Pt]+jt[Pt])/3;return kt}(qe,pe,be),Ve=Math.sqrt(1-i),Ke=U(Fe,qe,Ve),Ge=U(Fe,pe,Ve),ct=U(Fe,be,Ve),st=Ne[0],Mt=Ne[1],Ot=Ne[2];return{xyzv:[[qe,pe,Ge],[Ge,Ke,qe],[pe,be,ct],[ct,Ge,pe],[be,qe,Ke],[Ke,ct,be]],abc:[[st,Mt,-1],[-1,-1,st],[Mt,Ot,-1],[-1,-1,Mt],[Ot,st,-1],[-1,-1,Ot]]}}(Ie,Re);xt=bt.xyzv,wt=bt.abc}for(var nt=0;nt<xt.length;nt++){Ie=xt[nt],Re=wt[nt];for(var $e=[],vt=0;vt<3;vt++){var Nt=Ie[vt][0],qt=Ie[vt][1],Jt=Ie[vt][2],Wt=Ie[vt][3],ar=Re[vt]>-1?Re[vt]:$(Nt,qt,Jt);$e[vt]=ar>-1?ar:N(Nt,qt,Jt,X(Be,Wt))}Ye=$e[0],Qe=$e[1],lt=$e[2],u._meshI.push(Ye),u._meshJ.push(Qe),u._meshK.push(lt),++L}}function ee(Be,Ie,Re,Ye){var Qe=Be[3];Qe<Re&&(Qe=Re),Qe>Ye&&(Qe=Ye);for(var lt=(Be[3]-Qe)/(Be[3]-Ie[3]+1e-9),xt=[],wt=0;wt<4;wt++)xt[wt]=(1-lt)*Be[wt]+lt*Ie[wt];return xt}function re(Be,Ie,Re){return Be>=Ie&&Be<=Re}function se(Be){var Ie=.001*(K-Q);return Be>=Q-Ie&&Be<=K+Ie}function oe(Be){for(var Ie=[],Re=0;Re<4;Re++){var Ye=Be[Re];Ie.push([u._x[Ye],u._y[Ye],u._z[Ye],u._value[Ye]])}return Ie}function de(Be,Ie,Re,Ye,Qe,lt){lt||(lt=1),Re=[-1,-1,-1];var xt=!1,wt=[re(Ie[0][3],Ye,Qe),re(Ie[1][3],Ye,Qe),re(Ie[2][3],Ye,Qe)];if(!wt[0]&&!wt[1]&&!wt[2])return!1;var bt=function($e,vt,Nt){return se(vt[0][3])&&se(vt[1][3])&&se(vt[2][3])?(J($e,vt,Nt),!0):lt<3&&de($e,vt,Nt,Q,K,++lt)};if(wt[0]&&wt[1]&&wt[2])return bt(Be,Ie,Re)||xt;var nt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function($e){if(wt[$e[0]]&&wt[$e[1]]&&!wt[$e[2]]){var vt=Ie[$e[0]],Nt=Ie[$e[1]],qt=Ie[$e[2]],Jt=ee(qt,vt,Ye,Qe),Wt=ee(qt,Nt,Ye,Qe);xt=bt(Be,[Wt,Jt,vt],[-1,-1,Re[$e[0]]])||xt,xt=bt(Be,[vt,Nt,Wt],[Re[$e[0]],Re[$e[1]],-1])||xt,nt=!0}}),nt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function($e){if(wt[$e[0]]&&!wt[$e[1]]&&!wt[$e[2]]){var vt=Ie[$e[0]],Nt=Ie[$e[1]],qt=Ie[$e[2]],Jt=ee(Nt,vt,Ye,Qe),Wt=ee(qt,vt,Ye,Qe);xt=bt(Be,[Wt,Jt,vt],[-1,-1,Re[$e[0]]])||xt,nt=!0}}),xt}function ce(Be,Ie,Re,Ye){var Qe=!1,lt=oe(Ie),xt=[re(lt[0][3],Re,Ye),re(lt[1][3],Re,Ye),re(lt[2][3],Re,Ye),re(lt[3][3],Re,Ye)];if(!(xt[0]||xt[1]||xt[2]||xt[3]))return Qe;if(xt[0]&&xt[1]&&xt[2]&&xt[3])return k&&(Qe=function(bt,nt,$e){var vt=function(Nt,qt,Jt){J(bt,[nt[Nt],nt[qt],nt[Jt]],[$e[Nt],$e[qt],$e[Jt]])};vt(0,1,2),vt(3,0,1),vt(2,3,0),vt(1,2,3)}(Be,lt,Ie)||Qe),Qe;var wt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(bt){if(xt[bt[0]]&&xt[bt[1]]&&xt[bt[2]]&&!xt[bt[3]]){var nt=lt[bt[0]],$e=lt[bt[1]],vt=lt[bt[2]],Nt=lt[bt[3]];if(k)Qe=J(Be,[nt,$e,vt],[Ie[bt[0]],Ie[bt[1]],Ie[bt[2]]])||Qe;else{var qt=ee(Nt,nt,Re,Ye),Jt=ee(Nt,$e,Re,Ye),Wt=ee(Nt,vt,Re,Ye);Qe=J(null,[qt,Jt,Wt],[-1,-1,-1])||Qe}wt=!0}}),wt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(bt){if(xt[bt[0]]&&xt[bt[1]]&&!xt[bt[2]]&&!xt[bt[3]]){var nt=lt[bt[0]],$e=lt[bt[1]],vt=lt[bt[2]],Nt=lt[bt[3]],qt=ee(vt,nt,Re,Ye),Jt=ee(vt,$e,Re,Ye),Wt=ee(Nt,$e,Re,Ye),ar=ee(Nt,nt,Re,Ye);k?(Qe=J(Be,[nt,ar,qt],[Ie[bt[0]],-1,-1])||Qe,Qe=J(Be,[$e,Jt,Wt],[Ie[bt[1]],-1,-1])||Qe):Qe=function(Dt,Ne,qe){var pe=function(be,Fe,Ve){J(Dt,[Ne[be],Ne[Fe],Ne[Ve]],[qe[be],qe[Fe],qe[Ve]])};pe(0,1,2),pe(2,3,0)}(null,[qt,Jt,Wt,ar],[-1,-1,-1,-1])||Qe,wt=!0}}),wt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(bt){if(xt[bt[0]]&&!xt[bt[1]]&&!xt[bt[2]]&&!xt[bt[3]]){var nt=lt[bt[0]],$e=lt[bt[1]],vt=lt[bt[2]],Nt=lt[bt[3]],qt=ee($e,nt,Re,Ye),Jt=ee(vt,nt,Re,Ye),Wt=ee(Nt,nt,Re,Ye);k?(Qe=J(Be,[nt,qt,Jt],[Ie[bt[0]],-1,-1])||Qe,Qe=J(Be,[nt,Jt,Wt],[Ie[bt[0]],-1,-1])||Qe,Qe=J(Be,[nt,Wt,qt],[Ie[bt[0]],-1,-1])||Qe):Qe=J(null,[qt,Jt,Wt],[-1,-1,-1])||Qe,wt=!0}})),Qe}function ve(Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e){var vt=!1;return T&&(B(Be,"A")&&(vt=ce(null,[Ie,Re,Ye,lt],nt,$e)||vt),B(Be,"B")&&(vt=ce(null,[Re,Ye,Qe,bt],nt,$e)||vt),B(Be,"C")&&(vt=ce(null,[Re,lt,xt,bt],nt,$e)||vt),B(Be,"D")&&(vt=ce(null,[Ye,lt,wt,bt],nt,$e)||vt),B(Be,"E")&&(vt=ce(null,[Re,Ye,lt,bt],nt,$e)||vt)),k&&(vt=ce(Be,[Re,Ye,lt,bt],nt,$e)||vt),vt}function Ae(Be,Ie,Re,Ye,Qe,lt,xt,wt){return[wt[0]===!0||de(Be,oe([Ie,Re,Ye]),[Ie,Re,Ye],lt,xt),wt[1]===!0||de(Be,oe([Ye,Qe,Ie]),[Ye,Qe,Ie],lt,xt)]}function fe(Be,Ie,Re,Ye,Qe,lt,xt,wt,bt){return wt?Ae(Be,Ie,Re,Qe,Ye,lt,xt,bt):Ae(Be,Re,Qe,Ye,Ie,lt,xt,bt)}function me(Be,Ie,Re,Ye,Qe,lt,xt){var wt,bt,nt,$e,vt=!1,Nt=function(){vt=de(Be,[wt,bt,nt],[-1,-1,-1],Qe,lt)||vt,vt=de(Be,[nt,$e,wt],[-1,-1,-1],Qe,lt)||vt},qt=xt[0],Jt=xt[1],Wt=xt[2];return qt&&(wt=U(oe([j(Ie,Re-0,Ye-0)])[0],oe([j(Ie-1,Re-0,Ye-0)])[0],qt),bt=U(oe([j(Ie,Re-0,Ye-1)])[0],oe([j(Ie-1,Re-0,Ye-1)])[0],qt),nt=U(oe([j(Ie,Re-1,Ye-1)])[0],oe([j(Ie-1,Re-1,Ye-1)])[0],qt),$e=U(oe([j(Ie,Re-1,Ye-0)])[0],oe([j(Ie-1,Re-1,Ye-0)])[0],qt),Nt()),Jt&&(wt=U(oe([j(Ie-0,Re,Ye-0)])[0],oe([j(Ie-0,Re-1,Ye-0)])[0],Jt),bt=U(oe([j(Ie-0,Re,Ye-1)])[0],oe([j(Ie-0,Re-1,Ye-1)])[0],Jt),nt=U(oe([j(Ie-1,Re,Ye-1)])[0],oe([j(Ie-1,Re-1,Ye-1)])[0],Jt),$e=U(oe([j(Ie-1,Re,Ye-0)])[0],oe([j(Ie-1,Re-1,Ye-0)])[0],Jt),Nt()),Wt&&(wt=U(oe([j(Ie-0,Re-0,Ye)])[0],oe([j(Ie-0,Re-0,Ye-1)])[0],Wt),bt=U(oe([j(Ie-0,Re-1,Ye)])[0],oe([j(Ie-0,Re-1,Ye-1)])[0],Wt),nt=U(oe([j(Ie-1,Re-1,Ye)])[0],oe([j(Ie-1,Re-1,Ye-1)])[0],Wt),$e=U(oe([j(Ie-1,Re-0,Ye)])[0],oe([j(Ie-1,Re-0,Ye-1)])[0],Wt),Nt()),vt}function _e(Be,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e,vt){var Nt=Be;return vt?(T&&Be==="even"&&(Nt=null),ve(Nt,Ie,Re,Ye,Qe,lt,xt,wt,bt,nt,$e)):(T&&Be==="odd"&&(Nt=null),ve(Nt,bt,wt,xt,lt,Qe,Ye,Re,Ie,nt,$e))}function le(Be,Ie,Re,Ye,Qe){for(var lt=[],xt=0,wt=0;wt<Ie.length;wt++)for(var bt=Ie[wt],nt=1;nt<z;nt++)for(var $e=1;$e<E;$e++)lt.push(fe(Be,j(bt,$e-1,nt-1),j(bt,$e-1,nt),j(bt,$e,nt-1),j(bt,$e,nt),Re,Ye,(bt+$e+nt)%2,Qe&&Qe[xt]?Qe[xt]:[])),xt++;return lt}function ge(Be,Ie,Re,Ye,Qe){for(var lt=[],xt=0,wt=0;wt<Ie.length;wt++)for(var bt=Ie[wt],nt=1;nt<S;nt++)for(var $e=1;$e<z;$e++)lt.push(fe(Be,j(nt-1,bt,$e-1),j(nt,bt,$e-1),j(nt-1,bt,$e),j(nt,bt,$e),Re,Ye,(nt+bt+$e)%2,Qe&&Qe[xt]?Qe[xt]:[])),xt++;return lt}function Te(Be,Ie,Re,Ye,Qe){for(var lt=[],xt=0,wt=0;wt<Ie.length;wt++)for(var bt=Ie[wt],nt=1;nt<E;nt++)for(var $e=1;$e<S;$e++)lt.push(fe(Be,j($e-1,nt-1,bt),j($e-1,nt,bt),j($e,nt-1,bt),j($e,nt,bt),Re,Ye,($e+nt+bt)%2,Qe&&Qe[xt]?Qe[xt]:[])),xt++;return lt}function Se(Be,Ie,Re){for(var Ye=1;Ye<z;Ye++)for(var Qe=1;Qe<E;Qe++)for(var lt=1;lt<S;lt++)_e(Be,j(lt-1,Qe-1,Ye-1),j(lt-1,Qe-1,Ye),j(lt-1,Qe,Ye-1),j(lt-1,Qe,Ye),j(lt,Qe-1,Ye-1),j(lt,Qe-1,Ye),j(lt,Qe,Ye-1),j(lt,Qe,Ye),Ie,Re,(lt+Qe+Ye)%2)}function Me(Be,Ie,Re){T=!0,Se(Be,Ie,Re),T=!1}function ze(Be,Ie,Re,Ye,Qe,lt){for(var xt=[],wt=0,bt=0;bt<Ie.length;bt++)for(var nt=Ie[bt],$e=1;$e<z;$e++)for(var vt=1;vt<E;vt++)xt.push(me(Be,nt,vt,$e,Re,Ye,Qe[bt],lt&&lt[wt]&&lt[wt])),wt++;return xt}function Oe(Be,Ie,Re,Ye,Qe,lt){for(var xt=[],wt=0,bt=0;bt<Ie.length;bt++)for(var nt=Ie[bt],$e=1;$e<S;$e++)for(var vt=1;vt<z;vt++)xt.push(me(Be,$e,nt,vt,Re,Ye,Qe[bt],lt&&lt[wt]&&lt[wt])),wt++;return xt}function De(Be,Ie,Re,Ye,Qe,lt){for(var xt=[],wt=0,bt=0;bt<Ie.length;bt++)for(var nt=Ie[bt],$e=1;$e<E;$e++)for(var vt=1;vt<S;vt++)xt.push(me(Be,vt,$e,nt,Re,Ye,Qe[bt],lt&&lt[wt]&&lt[wt])),wt++;return xt}function Xe(Be,Ie){for(var Re=[],Ye=Be;Ye<Ie;Ye++)Re.push(Ye);return Re}return function(){if(H(),function(){for(var wt=0;wt<S;wt++)for(var bt=0;bt<E;bt++)for(var nt=0;nt<z;nt++){var $e=j(wt,bt,nt);N(u._x[$e],u._y[$e],u._z[$e],u._value[$e])}}(),f&&b&&(te(b),k=!0,Se(null,Q,K),k=!1),x&&_){te(_);for(var Be=u.surface.pattern,Ie=u.surface.count,Re=0;Re<Ie;Re++){var Ye=Ie===1?.5:Re/(Ie-1),Qe=(1-Ye)*Q+Ye*K,lt=Math.abs(Qe-V)>Math.abs(Qe-Z)?[V,Qe]:[Qe,Z];Me(Be,lt[0],lt[1])}}var xt=[[Math.min(Q,Z),Math.max(Q,Z)],[Math.min(V,K),Math.max(V,K)]];["x","y","z"].forEach(function(wt){for(var bt=[],nt=0;nt<xt.length;nt++){var $e=0,vt=xt[nt][0],Nt=xt[nt][1],qt=u.slices[wt];if(qt.show&&qt.fill){te(qt.fill);var Jt=[],Wt=[],ar=[];if(qt.locations.length)for(var Dt=0;Dt<qt.locations.length;Dt++){var Ne=t(qt.locations[Dt],wt==="x"?A:wt==="y"?I:P);Ne.distRatio===0?Jt.push(Ne.id):Ne.id>0&&(Wt.push(Ne.id),wt==="x"?ar.push([Ne.distRatio,0,0]):wt==="y"?ar.push([0,Ne.distRatio,0]):ar.push([0,0,Ne.distRatio]))}else Jt=Xe(1,wt==="x"?S-1:wt==="y"?E-1:z-1);Wt.length>0&&(bt[$e]=wt==="x"?ze(null,Wt,vt,Nt,ar,bt[$e]):wt==="y"?Oe(null,Wt,vt,Nt,ar,bt[$e]):De(null,Wt,vt,Nt,ar,bt[$e]),$e++),Jt.length>0&&(bt[$e]=wt==="x"?le(null,Jt,vt,Nt,bt[$e]):wt==="y"?ge(null,Jt,vt,Nt,bt[$e]):Te(null,Jt,vt,Nt,bt[$e]),$e++)}var qe=u.caps[wt];qe.show&&qe.fill&&(te(qe.fill),bt[$e]=wt==="x"?le(null,[0,S-1],vt,Nt,bt[$e]):wt==="y"?ge(null,[0,E-1],vt,Nt,bt[$e]):Te(null,[0,z-1],vt,Nt,bt[$e]),$e++)}}),L===0&&H(),u._meshX=l,u._meshY=o,u._meshZ=p,u._meshIntensity=c,u._Xs=A,u._Ys=I,u._Zs=P}(),u}G.exports={findNearestOnAxis:t,generateIsoMeshes:g,createIsosurfaceTrace:function(u,s){var h=u.glplot.gl,l=d({gl:h}),o=new n(u,l,s.uid);return l._trace=o,o.update(s),u.glplot.add(l),o}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=m("./attributes"),y=m("../../components/colorscale/defaults");function e(t,n,a,r,g){var u=g("isomin"),s=g("isomax");s!=null&&u!=null&&u>s&&(n.isomin=null,n.isomax=null);var h=g("x"),l=g("y"),o=g("z"),p=g("value");h&&h.length&&l&&l.length&&o&&o.length&&p&&p.length?(v.getComponentMethod("calendars","handleTraceDefaults")(t,n,["x","y","z"],r),g("valuehoverformat"),["x","y","z"].forEach(function(c){g(c+"hoverformat");var i="caps."+c;g(i+".show")&&g(i+".fill");var x="slices."+c;g(x+".show")&&(g(x+".fill"),g(x+".locations"))}),g("spaceframe.show")&&g("spaceframe.fill"),g("surface.show")&&(g("surface.count"),g("surface.fill"),g("surface.pattern")),g("contour.show")&&(g("contour.color"),g("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(c){g(c)}),y(t,n,r,g,{prefix:"",cLetter:"c"}),n._length=null):n.visible=!1}G.exports={supplyDefaults:function(t,n,a,r){e(t,n,a,r,function(g,u){return d.coerce(t,n,w,g,u)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,calc:m("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../surface/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat;G.exports=t({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:w({editType:"calc"}),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},d("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:t({},y.contours.x.show,{}),color:y.contours.x.color,width:y.contours.x.width,editType:"calc"},lightposition:{x:t({},y.lightposition.x,{dflt:1e5}),y:t({},y.lightposition.y,{dflt:1e5}),z:t({},y.lightposition.z,{dflt:0}),editType:"calc"},lighting:t({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},y.lighting),hoverinfo:t({},e.hoverinfo,{editType:"calc"}),showlegend:t({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(m,G,W){var d=m("../../components/colorscale/calc");G.exports=function(v,w){w.intensity&&d(v,w,{vals:w.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(m,G,W){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../../stackgl_modules").delaunay_triangulate,w=m("../../../stackgl_modules").alpha_shape,y=m("../../../stackgl_modules").convex_hull,e=m("../../lib/gl_format_color").parseColorScale,t=m("../../lib/str2rgbarray"),n=m("../../components/colorscale").extractOpts,a=m("../../plots/gl3d/zip3");function r(o,p,c){this.scene=o,this.uid=c,this.mesh=p,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var g=r.prototype;function u(o){for(var p=[],c=o.length,i=0;i<c;i++)p[i]=t(o[i]);return p}function s(o,p,c,i){for(var x=[],f=p.length,_=0;_<f;_++)x[_]=o.d2l(p[_],0,i)*c;return x}function h(o){for(var p=[],c=o.length,i=0;i<c;i++)p[i]=Math.round(o[i]);return p}function l(o,p){for(var c=o.length,i=0;i<c;i++)if(o[i]<=-.5||o[i]>=p-.5)return!1;return!0}g.handlePick=function(o){if(o.object===this.mesh){var p=o.index=o.data.index;o.data._cellCenter?o.traceCoordinate=o.data.dataCoordinate:o.traceCoordinate=[this.data.x[p],this.data.y[p],this.data.z[p]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&&c[p]!==void 0?o.textLabel=c[p]:c&&(o.textLabel=c),!0}},g.update=function(o){var p=this.scene,c=p.fullSceneLayout;this.data=o;var i,x=o.x.length,f=a(s(c.xaxis,o.x,p.dataScale[0],o.xcalendar),s(c.yaxis,o.y,p.dataScale[1],o.ycalendar),s(c.zaxis,o.z,p.dataScale[2],o.zcalendar));if(o.i&&o.j&&o.k){if(o.i.length!==o.j.length||o.j.length!==o.k.length||!l(o.i,x)||!l(o.j,x)||!l(o.k,x))return;i=a(h(o.i),h(o.j),h(o.k))}else i=o.alphahull===0?y(f):o.alphahull>0?w(o.alphahull,f):function(k,L){for(var A=["x","y","z"].indexOf(k),I=[],P=L.length,S=0;S<P;S++)I[S]=[L[S][(A+1)%3],L[S][(A+2)%3]];return v(I)}(o.delaunayaxis,f);var _={positions:f,cells:i,lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,contourEnable:o.contour.show,contourColor:t(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading};if(o.intensity){var b=n(o);this.color="#fff";var T=o.intensitymode;_[T+"Intensity"]=o.intensity,_[T+"IntensityBounds"]=[b.min,b.max],_.colormap=e(o)}else o.vertexcolor?(this.color=o.vertexcolor[0],_.vertexColors=u(o.vertexcolor)):o.facecolor?(this.color=o.facecolor[0],_.cellColors=u(o.facecolor)):(this.color=o.color,_.meshColor=t(o.color));this.mesh.update(_)},g.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(o,p){var c=o.glplot.gl,i=d({gl:c}),x=new r(o,i,p.uid);return i._trace=x,x.update(p),o.glplot.add(i),x}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/colorscale/defaults"),y=m("./attributes");G.exports=function(e,t,n,a){function r(u,s){return v.coerce(e,t,y,u,s)}function g(u){var s=u.map(function(h){var l=r(h);return l&&v.isArrayOrTypedArray(l)?l:null});return s.every(function(h){return h&&h.length===s[0].length})&&s}g(["x","y","z"])?(g(["i","j","k"]),(!t.i||t.j&&t.k)&&(!t.j||t.k&&t.i)&&(!t.k||t.i&&t.j)?(d.getComponentMethod("calendars","handleTraceDefaults")(e,t,["x","y","z"],a),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(u){r(u)}),r("contour.show")&&(r("contour.color"),r("contour.width")),"intensity"in e?(r("intensity"),r("intensitymode"),w(e,t,a,r,{prefix:"",cLetter:"c"})):(t.showscale=!1,"facecolor"in e?r("facecolor"):"vertexcolor"in e?r("vertexcolor"):r("color",n)),r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),t._length=null):t.visible=!1):t.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(m,G,W){var d=m("../../lib").extendFlat,v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../components/drawing/attributes").dash,e=m("../../components/fx/attributes"),t=m("../../constants/delta.js"),n=t.INCREASING.COLOR,a=t.DECREASING.COLOR,r=v.line;function g(u){return{line:{color:d({},r.color,{dflt:u}),width:r.width,dash:y,editType:"style"},editType:"style"}}G.exports={xperiod:v.xperiod,xperiod0:v.xperiod0,xperiodalignment:v.xperiodalignment,xhoverformat:w("x"),yhoverformat:w("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:d({},r.width,{}),dash:d({},y,{}),editType:"style"},increasing:g(n),decreasing:g(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:d({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(m,G,W){var d=m("../../lib"),v=d._,w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../../constants/numerical").BADNUM;function t(a,r,g,u){return{o:a,h:r,l:g,c:u}}function n(a,r,g,u,s,h){for(var l=s.makeCalcdata(r,"open"),o=s.makeCalcdata(r,"high"),p=s.makeCalcdata(r,"low"),c=s.makeCalcdata(r,"close"),i=Array.isArray(r.text),x=Array.isArray(r.hovertext),f=!0,_=null,b=!!r.xperiodalignment,T=[],k=0;k<u.length;k++){var L=u[k],A=l[k],I=o[k],P=p[k],S=c[k];if(L!==e&&A!==e&&I!==e&&P!==e&&S!==e){S===A?_!==null&&S!==_&&(f=S>_):f=S>A,_=S;var E=h(A,I,P,S);E.pos=L,E.yc=(A+S)/2,E.i=k,E.dir=f?"increasing":"decreasing",E.x=E.pos,E.y=[P,I],b&&(E.orig_p=g[k]),i&&(E.tx=r.text[k]),x&&(E.htx=r.hovertext[k]),T.push(E)}else T.push({pos:L,empty:!0})}return r._extremes[s._id]=w.findExtremes(s,d.concat(p,o),{padded:!0}),T.length&&(T[0].t={labels:{open:v(a,"open:")+" ",high:v(a,"high:")+" ",low:v(a,"low:")+" ",close:v(a,"close:")+" "}}),T}G.exports={calc:function(a,r){var g=w.getFromId(a,r.xaxis),u=w.getFromId(a,r.yaxis),s=function(c,i,x){var f=x._minDiff;if(!f){var _,b=c._fullData,T=[];for(f=1/0,_=0;_<b.length;_++){var k=b[_];if(k.type==="ohlc"&&k.visible===!0&&k.xaxis===i._id){T.push(k);var L=i.makeCalcdata(k,"x");k._origX=L;var A=y(x,i,"x",L).vals;k._xcalc=A;var I=d.distinctVals(A).minDiff;I&&isFinite(I)&&(f=Math.min(f,I))}}for(f===1/0&&(f=1),_=0;_<T.length;_++)T[_]._minDiff=f}return f*x.tickwidth}(a,g,r),h=r._minDiff;r._minDiff=null;var l=r._origX;r._origX=null;var o=r._xcalc;r._xcalc=null;var p=n(a,r,l,o,u,t);return r._extremes[g._id]=w.findExtremes(g,o,{vpad:h/2}),p.length?(d.extendFlat(p[0].t,{wHover:h/2,tickLen:s}),p):[{t:{empty:!0}}]},calcCommon:n}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(m,G,W){var d=m("../../lib"),v=m("./ohlc_defaults"),w=m("../scatter/period_defaults"),y=m("./attributes");function e(t,n,a,r){a(r+".line.color"),a(r+".line.width",n.line.width),a(r+".line.dash",n.line.dash)}G.exports=function(t,n,a,r){function g(u,s){return d.coerce(t,n,y,u,s)}v(t,n,g,r)?(w(t,n,r,g,{x:!0}),g("xhoverformat"),g("yhoverformat"),g("line.width"),g("line.dash"),e(t,n,g,"increasing"),e(t,n,g,"decreasing"),g("text"),g("hovertext"),g("tickwidth"),r._requestRangeslider[n.xaxis]=!0):n.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../components/fx"),y=m("../../components/color"),e=m("../../lib").fillText,t=m("../../constants/delta.js"),n={increasing:t.INCREASING.SYMBOL,decreasing:t.DECREASING.SYMBOL};function a(u,s,h,l){var o,p,c=u.cd,i=u.xa,x=c[0].trace,f=c[0].t,_=x.type,b=_==="ohlc"?"l":"min",T=_==="ohlc"?"h":"max",k=f.bPos||0,L=f.bdPos||f.tickLen,A=f.wHover,I=Math.min(1,L/Math.abs(i.r2c(i.range[1])-i.r2c(i.range[0])));function P(Z){var Q=function(K){return K.pos+k-s}(Z);return w.inbox(Q-A,Q+A,o)}function S(Z){var Q=Z[b],K=Z[T];return Q===K||w.inbox(Q-h,K-h,o)}function E(Z){return(P(Z)+S(Z))/2}o=u.maxHoverDistance-I,p=u.maxSpikeDistance-I;var z=w.getDistanceFunction(l,P,S,E);if(w.getClosest(c,z,u),u.index===!1)return null;var D=c[u.index];if(D.empty)return null;var j=x[D.dir],V=j.line.color;return y.opacity(V)&&j.line.width?u.color=V:u.color=j.fillcolor,u.x0=i.c2p(D.pos+k-L,!0),u.x1=i.c2p(D.pos+k+L,!0),u.xLabelVal=D.orig_p!==void 0?D.orig_p:D.pos,u.spikeDistance=E(D)*p/o,u.xSpike=i.c2p(D.pos,!0),u}function r(u,s,h,l){var o=u.cd,p=u.ya,c=o[0].trace,i=o[0].t,x=[],f=a(u,s,h,l);if(!f)return[];var _=o[f.index].hi||c.hoverinfo,b=_.split("+");if(!(_==="all"||b.indexOf("y")!==-1))return[];for(var T=["high","open","close","low"],k={},L=0;L<T.length;L++){var A,I=T[L],P=c[I][f.index],S=p.c2p(P,!0);P in k?(A=k[P]).yLabel+="<br>"+i.labels[I]+d.hoverLabelText(p,P,c.yhoverformat):((A=v.extendFlat({},f)).y0=A.y1=S,A.yLabelVal=P,A.yLabel=i.labels[I]+d.hoverLabelText(p,P,c.yhoverformat),A.name="",x.push(A),k[P]=A)}return x}function g(u,s,h,l){var o=u.cd,p=u.ya,c=o[0].trace,i=o[0].t,x=a(u,s,h,l);if(!x)return[];var f=o[x.index],_=x.index=f.i,b=f.dir;function T(E){return i.labels[E]+d.hoverLabelText(p,c[E][_],c.yhoverformat)}var k=f.hi||c.hoverinfo,L=k.split("+"),A=k==="all",I=A||L.indexOf("y")!==-1,P=A||L.indexOf("text")!==-1,S=I?[T("open"),T("high"),T("low"),T("close")+"  "+n[b]]:[];return P&&e(f,c,S),x.extraText=S.join("<br>"),x.y0=x.y1=p.c2p(f.yc,!0),[x]}G.exports={hoverPoints:function(u,s,h,l){return u.cd[0].trace.hoverlabel.split?r(u,s,h,l):g(u,s,h,l)},hoverSplit:r,hoverOnPoints:g}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(m,G,W){G.exports={moduleType:"trace",name:"ohlc",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc").calc,plot:m("./plot"),style:m("./style"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(m,G,W){var d=m("../../registry"),v=m("../../lib");G.exports=function(w,y,e,t){var n=e("x"),a=e("open"),r=e("high"),g=e("low"),u=e("close");if(e("hoverlabel.split"),d.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x"],t),a&&r&&g&&u){var s=Math.min(a.length,r.length,g.length,u.length);return n&&(s=Math.min(s,v.minRowLength(n))),y._length=s,s}}},{"../../lib":515,"../../registry":647}],887:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib");G.exports=function(w,y,e,t){var n=y.yaxis,a=y.xaxis,r=!!a.rangebreaks;v.makeTraceGroups(t,e,"trace ohlc").each(function(g){var u=d.select(this),s=g[0],h=s.t;if(s.trace.visible!==!0||h.empty)u.remove();else{var l=h.tickLen,o=u.selectAll("path").data(v.identity);o.enter().append("path"),o.exit().remove(),o.attr("d",function(p){if(p.empty)return"M0,0Z";var c=a.c2p(p.pos-l,!0),i=a.c2p(p.pos+l,!0),x=r?(c+i)/2:a.c2p(p.pos,!0);return"M"+c+","+n.c2p(p.o,!0)+"H"+x+"M"+x+","+n.c2p(p.h,!0)+"V"+n.c2p(p.l,!0)+"M"+i+","+n.c2p(p.c,!0)+"H"+x})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(m,G,W){G.exports=function(d,v){var w,y=d.cd,e=d.xaxis,t=d.yaxis,n=[],a=y[0].t.bPos||0;if(v===!1)for(w=0;w<y.length;w++)y[w].selected=0;else for(w=0;w<y.length;w++){var r=y[w];v.contains([e.c2p(r.pos+a),t.c2p(r.yc)],null,r.i,d)?(n.push({pointNumber:r.i,x:e.c2d(r.pos),y:t.c2d(r.yc)}),r.selected=1):r.selected=0}return n}},{}],889:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color");G.exports=function(y,e,t){var n=t||d.select(y).selectAll("g.ohlclayer").selectAll("g.trace");n.style("opacity",function(a){return a[0].trace.opacity}),n.each(function(a){var r=a[0].trace;d.select(this).selectAll("path").each(function(g){if(!g.empty){var u=r[g.dir].line;d.select(this).style("fill","none").call(w.stroke,u.color).call(v.dashLine,u.dash,u.width).style("opacity",r.selectedpoints&&!g.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(m,G,W){var d=m("../../lib/extend").extendFlat,v=m("../../plots/attributes"),w=m("../../plots/font_attributes"),y=m("../../components/colorscale/attributes"),e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/domain").attributes,n=d({editType:"calc"},y("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});G.exports={domain:t({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:d({},v.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:w({editType:"calc"}),tickfont:w({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(m,G,W){var d=m("../../plots/get_data").getModuleCalcData,v=m("./plot");W.name="parcats",W.plot=function(w,y,e,t){var n=d(w.calcdata,"parcats");if(n.length){var a=n[0];v(w,a,e,t)}},W.clean=function(w,y,e,t){var n=t._has&&t._has("parcats"),a=y._has&&y._has("parcats");n&&!a&&t._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(m,G,W){var d=m("../../lib/gup").wrap,v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/calc"),y=m("../../lib/filter_unique.js"),e=m("../../components/drawing"),t=m("../../lib"),n=m("fast-isnumeric");function a(u,s,h){u.valueInds.push(s),u.count+=h}function r(u,s,h){return{categoryInds:u,color:s,rawColor:h,valueInds:[],count:0}}function g(u,s,h){u.valueInds.push(s),u.count+=h}G.exports=function(u,s){var h=t.filterVisible(s.dimensions);if(h.length===0)return[];var l,o,p,c=h.map(function($){var ne;if($.categoryorder==="trace")ne=null;else if($.categoryorder==="array")ne=$.categoryarray;else{ne=y($.values);for(var H=!0,N=0;N<ne.length;N++)if(!n(ne[N])){H=!1;break}ne.sort(H?t.sorterAsc:void 0),$.categoryorder==="category descending"&&(ne=ne.reverse())}return function(U,te){te=te==null?[]:te.map(function(de){return de});var B={},X={},J=[];te.forEach(function(de,ce){B[de]=0,X[de]=ce});for(var ee=0;ee<U.length;ee++){var re,se=U[ee];B[se]===void 0?(B[se]=1,re=te.push(se)-1,X[se]=re):(B[se]++,re=X[se]),J.push(re)}var oe=te.map(function(de){return B[de]});return{uniqueValues:te,uniqueCounts:oe,inds:J}}($.values,ne)});l=t.isArrayOrTypedArray(s.counts)?s.counts:[s.counts],function($){var ne;if(function(H){for(var N=new Array(H.length),U=0;U<H.length;U++){if(H[U]<0||H[U]>=H.length||N[H[U]]!==void 0)return!1;N[H[U]]=!0}return!0}($.map(function(H){return H.displayindex})))for(ne=0;ne<$.length;ne++)$[ne]._displayindex=$[ne].displayindex;else for(ne=0;ne<$.length;ne++)$[ne]._displayindex=ne}(h),h.forEach(function($,ne){(function(H,N){H._categoryarray=N.uniqueValues,H.ticktext===null||H.ticktext===void 0?H._ticktext=[]:H._ticktext=H.ticktext.slice();for(var U=H._ticktext.length;U<N.uniqueValues.length;U++)H._ticktext.push(N.uniqueValues[U])})($,c[ne])});var i,x=s.line;x?(v(s,"line")&&w(u,s,{vals:s.line.color,containerStr:"line",cLetter:"c"}),i=e.tryColorscale(x)):i=t.identity;var f,_,b,T,k,L=h[0].values.length,A={},I=c.map(function($){return $.inds});for(p=0,f=0;f<L;f++){var P=[];for(_=0;_<I.length;_++)P.push(I[_][f]);o=l[f%l.length],p+=o;var S=(b=f,T=void 0,k=void 0,t.isArrayOrTypedArray(x.color)?k=T=x.color[b%x.color.length]:T=x.color,{color:i(T),rawColor:k}),E=P+"-"+S.rawColor;A[E]===void 0&&(A[E]=r(P,S.color,S.rawColor)),g(A[E],f,o)}var z,D=h.map(function($,ne){return function(H,N,U,te,B){return{dimensionInd:H,containerInd:N,displayInd:U,dimensionLabel:te,count:B,categories:[],dragX:null}}(ne,$._index,$._displayindex,$.label,p)});for(f=0;f<L;f++)for(o=l[f%l.length],_=0;_<D.length;_++){var j=D[_].containerInd,V=c[_].inds[f],Z=D[_].categories;if(Z[V]===void 0){var Q=s.dimensions[j]._categoryarray[V],K=s.dimensions[j]._ticktext[V];Z[V]={dimensionInd:_,categoryInd:z=V,categoryValue:Q,displayInd:z,categoryLabel:K,valueInds:[],count:0,dragY:null}}a(Z[V],f,o)}return d(function($,ne,H){var N=$.map(function(U){return U.categories.length}).reduce(function(U,te){return Math.max(U,te)});return{dimensions:$,paths:ne,trace:void 0,maxCats:N,count:H}}(D,A,p))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../plots/domain").defaults,e=m("../../plots/array_container_defaults"),t=m("./attributes"),n=m("../parcoords/merge_length");function a(r,g){function u(i,x){return d.coerce(r,g,t.dimensions,i,x)}var s=u("values"),h=u("visible");if(s&&s.length||(h=g.visible=!1),h){u("label"),u("displayindex",g._index);var l,o=r.categoryarray,p=Array.isArray(o)&&o.length>0;p&&(l="array");var c=u("categoryorder",l);c==="array"?(u("categoryarray"),u("ticktext")):(delete r.categoryarray,delete r.ticktext),p||c!=="array"||(g.categoryorder="trace")}}G.exports=function(r,g,u,s){function h(i,x){return d.coerce(r,g,t,i,x)}var l=e(r,g,{name:"dimensions",handleItemDefaults:a}),o=function(i,x,f,_,b){b("line.shape"),b("line.hovertemplate");var T=b("line.color",_.colorway[0]);if(v(i,"line")&&d.isArrayOrTypedArray(T)){if(T.length)return b("line.colorscale"),w(i,x,_,b,{prefix:"line.",cLetter:"c"}),T.length;x.line.color=f}return 1/0}(r,g,u,s,h);y(g,s,h),Array.isArray(l)&&l.length||(g.visible=!1),n(g,l,"values",o),h("hoveron"),h("hovertemplate"),h("arrangement"),h("bundlecolors"),h("sortpaths"),h("counts");var p={family:s.font.family,size:Math.round(s.font.size),color:s.font.color};d.coerceFont(h,"labelfont",p);var c={family:s.font.family,size:Math.round(s.font.size/1.2),color:s.font.color};d.coerceFont(h,"tickfont",c)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:m("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolateNumber,w=m("../../plot_api/plot_api"),y=m("../../components/fx"),e=m("../../lib"),t=e.strTranslate,n=m("../../components/drawing"),a=m("tinycolor2"),r=m("../../lib/svg_text_utils");function g(H,N,U,te){var B=N._context.staticPlot,X=H.map(Z.bind(0,N,U)),J=te.selectAll("g.parcatslayer").data([null]);J.enter().append("g").attr("class","parcatslayer").style("pointer-events",B?"none":"all");var ee=J.selectAll("g.trace.parcats").data(X,u),re=ee.enter().append("g").attr("class","trace parcats");ee.attr("transform",function(_e){return t(_e.x,_e.y)}),re.append("g").attr("class","paths");var se=ee.select("g.paths").selectAll("path.path").data(function(_e){return _e.paths},u);se.attr("fill",function(_e){return _e.model.color});var oe=se.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(_e){return _e.model.color}).attr("fill-opacity",0);x(oe),se.attr("d",function(_e){return _e.svgD}),oe.empty()||se.sort(h),se.exit().remove(),se.on("mouseover",l).on("mouseout",o).on("click",i),re.append("g").attr("class","dimensions");var de=ee.select("g.dimensions").selectAll("g.dimension").data(function(_e){return _e.dimensions},u);de.enter().append("g").attr("class","dimension"),de.attr("transform",function(_e){return t(_e.x,0)}),de.exit().remove();var ce=de.selectAll("g.category").data(function(_e){return _e.categories},u),ve=ce.enter().append("g").attr("class","category");ce.attr("transform",function(_e){return t(0,_e.y)}),ve.append("rect").attr("class","catrect").attr("pointer-events","none"),ce.select("rect.catrect").attr("fill","none").attr("width",function(_e){return _e.width}).attr("height",function(_e){return _e.height}),_(ve);var Ae=ce.selectAll("rect.bandrect").data(function(_e){return _e.bands},u);Ae.each(function(){e.raiseToTop(this)}),Ae.attr("fill",function(_e){return _e.color});var fe=Ae.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(_e){return _e.color}).attr("fill-opacity",0);Ae.attr("fill",function(_e){return _e.color}).attr("width",function(_e){return _e.width}).attr("height",function(_e){return _e.height}).attr("y",function(_e){return _e.y}).attr("cursor",function(_e){return _e.parcatsViewModel.arrangement==="fixed"?"default":_e.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),b(fe),Ae.exit().remove(),ve.append("text").attr("class","catlabel").attr("pointer-events","none");var me=N._fullLayout.paper_bgcolor;ce.select("text.catlabel").attr("text-anchor",function(_e){return s(_e)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",r.makeTextShadow(me)).style("fill","rgb(0, 0, 0)").attr("x",function(_e){return s(_e)?_e.width+5:-5}).attr("y",function(_e){return _e.height/2}).text(function(_e){return _e.model.categoryLabel}).each(function(_e){n.font(d.select(this),_e.parcatsViewModel.categorylabelfont),r.convertToTspans(d.select(this),N)}),ve.append("text").attr("class","dimlabel"),ce.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(_e){return _e.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(_e){return _e.width/2}).attr("y",-5).text(function(_e,le){return le===0?_e.parcatsViewModel.model.dimensions[_e.model.dimensionInd].dimensionLabel:null}).each(function(_e){n.font(d.select(this),_e.parcatsViewModel.labelfont)}),ce.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",P),ce.exit().remove(),de.call(d.behavior.drag().origin(function(_e){return{x:_e.x,y:0}}).on("dragstart",S).on("drag",E).on("dragend",z)),ee.each(function(_e){_e.traceSelection=d.select(this),_e.pathSelection=d.select(this).selectAll("g.paths").selectAll("path.path"),_e.dimensionSelection=d.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ee.exit().remove()}function u(H){return H.key}function s(H){var N=H.parcatsViewModel.dimensions.length,U=H.parcatsViewModel.dimensions[N-1].model.dimensionInd;return H.model.dimensionInd===U}function h(H,N){return H.model.rawColor>N.model.rawColor?1:H.model.rawColor<N.model.rawColor?-1:0}function l(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),f(d.select(this));var N=p(H),U=c(H);if(H.parcatsViewModel.graphDiv.emit("plotly_hover",{points:N,event:d.event,constraints:U}),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var te,B,X,J=d.mouse(this)[0],ee=H.parcatsViewModel.graphDiv,re=H.parcatsViewModel.trace,se=ee._fullLayout,oe=se._paperdiv.node().getBoundingClientRect(),de=H.parcatsViewModel.graphDiv.getBoundingClientRect();for(X=0;X<H.leftXs.length-1;X++)if(H.leftXs[X]+H.dimWidths[X]-2<=J&&J<=H.leftXs[X+1]+2){var ce=H.parcatsViewModel.dimensions[X],ve=H.parcatsViewModel.dimensions[X+1];te=(ce.x+ce.width+ve.x)/2,B=(H.topYs[X]+H.topYs[X+1]+H.height)/2;break}var Ae=H.parcatsViewModel.x+te,fe=H.parcatsViewModel.y+B,me=a.mostReadable(H.model.color,["black","white"]),_e=H.model.count,le=_e/H.parcatsViewModel.model.count,ge={countLabel:_e,probabilityLabel:le.toFixed(3)},Te=[];H.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Te.push(["Count:",ge.countLabel].join(" ")),H.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Te.push(["P:",ge.probabilityLabel].join(" "));var Se=Te.join("<br>"),Me=d.mouse(ee)[0];y.loneHover({trace:re,x:Ae-oe.left+de.left,y:fe-oe.top+de.top,text:Se,color:H.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:me,idealAlign:Me<Ae?"right":"left",hovertemplate:(re.line||{}).hovertemplate,hovertemplateLabels:ge,eventData:[{data:re._input,fullData:re,count:_e,probability:le}]},{container:se._hoverlayer.node(),outerContainer:se._paper.node(),gd:ee})}}}function o(H){if(!H.parcatsViewModel.dragDimension&&(x(d.select(this)),y.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),H.parcatsViewModel.pathSelection.sort(h),H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var N=p(H),U=c(H);H.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:N,event:d.event,constraints:U})}}function p(H){for(var N=[],U=D(H.parcatsViewModel),te=0;te<H.model.valueInds.length;te++){var B=H.model.valueInds[te];N.push({curveNumber:U,pointNumber:B})}return N}function c(H){for(var N={},U=H.parcatsViewModel.model.dimensions,te=0;te<U.length;te++){var B=U[te],X=B.categories[H.model.categoryInds[te]];N[B.containerInd]=X.categoryValue}return H.model.rawColor!==void 0&&(N.color=H.model.rawColor),N}function i(H){if(H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var N=p(H),U=c(H);H.parcatsViewModel.graphDiv.emit("plotly_click",{points:N,event:d.event,constraints:U})}}function x(H){H.attr("fill",function(N){return N.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function f(H){H.attr("fill-opacity",.8).attr("stroke",function(N){return a.mostReadable(N.model.color,["black","white"])}).attr("stroke-width",.3)}function _(H){H.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function b(H){H.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function T(H){var N=H.parcatsViewModel.pathSelection,U=H.categoryViewModel.model.dimensionInd,te=H.categoryViewModel.model.categoryInd;return N.filter(function(B){return B.model.categoryInds[U]===te&&B.model.color===H.color})}function k(H,N,U){var te=d.select(H).datum(),B=te.categoryViewModel.model,X=te.parcatsViewModel.graphDiv,J=d.select(H.parentNode).selectAll("rect.bandrect"),ee=[];J.each(function(se){T(se).each(function(oe){Array.prototype.push.apply(ee,p(oe))})});var re={};re[B.dimensionInd]=B.categoryValue,X.emit(N,{points:ee,event:U,constraints:re})}function L(H,N,U){var te=d.select(H).datum(),B=te.categoryViewModel.model,X=te.parcatsViewModel.graphDiv,J=T(te),ee=[];J.each(function(se){Array.prototype.push.apply(ee,p(se))});var re={};re[B.dimensionInd]=B.categoryValue,te.rawColor!==void 0&&(re.color=te.rawColor),X.emit(N,{points:ee,event:U,constraints:re})}function A(H,N,U){H._fullLayout._calcInverseTransform(H);var te,B,X=H._fullLayout._invScaleX,J=H._fullLayout._invScaleY,ee=d.select(U.parentNode).select("rect.catrect"),re=ee.node().getBoundingClientRect(),se=ee.datum(),oe=se.parcatsViewModel,de=oe.model.dimensions[se.model.dimensionInd],ce=oe.trace,ve=re.top+re.height/2;oe.dimensions.length>1&&de.displayInd===oe.dimensions.length-1?(te=re.left,B="left"):(te=re.left+re.width,B="right");var Ae=se.model.count,fe=se.model.categoryLabel,me=Ae/se.parcatsViewModel.model.count,_e={countLabel:Ae,categoryLabel:fe,probabilityLabel:me.toFixed(3)},le=[];se.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&le.push(["Count:",_e.countLabel].join(" ")),se.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&le.push(["P("+_e.categoryLabel+"):",_e.probabilityLabel].join(" "));var ge=le.join("<br>");return{trace:ce,x:X*(te-N.left),y:J*(ve-N.top),text:ge,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:B,hovertemplate:ce.hovertemplate,hovertemplateLabels:_e,eventData:[{data:ce._input,fullData:ce,count:Ae,category:fe,probability:me}]}}function I(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(d.mouse(this)[1]<-1)return;var N,U=H.parcatsViewModel.graphDiv,te=U._fullLayout,B=te._paperdiv.node().getBoundingClientRect(),X=H.parcatsViewModel.hoveron;X==="color"?(function(J){var ee=d.select(J).datum(),re=T(ee);f(re),re.each(function(){e.raiseToTop(this)}),d.select(J.parentNode).selectAll("rect.bandrect").filter(function(se){return se.color===ee.color}).each(function(){e.raiseToTop(this),d.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),L(this,"plotly_hover",d.event)):(function(J){d.select(J.parentNode).selectAll("rect.bandrect").each(function(ee){var re=T(ee);f(re),re.each(function(){e.raiseToTop(this)})}),d.select(J.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),k(this,"plotly_hover",d.event)),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(X==="category"?N=A(U,B,this):X==="color"?N=function(J,ee,re){J._fullLayout._calcInverseTransform(J);var se,oe,de=J._fullLayout._invScaleX,ce=J._fullLayout._invScaleY,ve=re.getBoundingClientRect(),Ae=d.select(re).datum(),fe=Ae.categoryViewModel,me=fe.parcatsViewModel,_e=me.model.dimensions[fe.model.dimensionInd],le=me.trace,ge=ve.y+ve.height/2;me.dimensions.length>1&&_e.displayInd===me.dimensions.length-1?(se=ve.left,oe="left"):(se=ve.left+ve.width,oe="right");var Te=fe.model.categoryLabel,Se=Ae.parcatsViewModel.model.count,Me=0;Ae.categoryViewModel.bands.forEach(function(lt){lt.color===Ae.color&&(Me+=lt.count)});var ze=fe.model.count,Oe=0;me.pathSelection.each(function(lt){lt.model.color===Ae.color&&(Oe+=lt.model.count)});var De=Me/Se,Xe=Me/Oe,Be=Me/ze,Ie={countLabel:Se,categoryLabel:Te,probabilityLabel:De.toFixed(3)},Re=[];fe.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Re.push(["Count:",Ie.countLabel].join(" ")),fe.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Re.push("P(color \u2229 "+Te+"): "+Ie.probabilityLabel),Re.push("P("+Te+" | color): "+Xe.toFixed(3)),Re.push("P(color | "+Te+"): "+Be.toFixed(3)));var Ye=Re.join("<br>"),Qe=a.mostReadable(Ae.color,["black","white"]);return{trace:le,x:de*(se-ee.left),y:ce*(ge-ee.top),text:Ye,color:Ae.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Qe,fontSize:10,idealAlign:oe,hovertemplate:le.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:le._input,fullData:le,category:Te,count:Se,probability:De,categorycount:ze,colorcount:Oe,bandcolorcount:Me}]}}(U,B,this):X==="dimension"&&(N=function(J,ee,re){var se=[];return d.select(re.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){se.push(A(J,ee,this))}),se}(U,B,this)),N&&y.loneHover(N,{container:te._hoverlayer.node(),outerContainer:te._paper.node(),gd:U}))}}function P(H){var N=H.parcatsViewModel;!N.dragDimension&&(x(N.pathSelection),_(N.dimensionSelection.selectAll("g.category")),b(N.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),y.loneUnhover(N.graphDiv._fullLayout._hoverlayer.node()),N.pathSelection.sort(h),N.hoverinfoItems.indexOf("skip")===-1)&&(H.parcatsViewModel.hoveron==="color"?L(this,"plotly_unhover",d.event):k(this,"plotly_unhover",d.event))}function S(H){H.parcatsViewModel.arrangement!=="fixed"&&(H.dragDimensionDisplayInd=H.model.displayInd,H.initialDragDimensionDisplayInds=H.parcatsViewModel.model.dimensions.map(function(N){return N.displayInd}),H.dragHasMoved=!1,H.dragCategoryDisplayInd=null,d.select(this).selectAll("g.category").select("rect.catrect").each(function(N){var U=d.mouse(this)[0],te=d.mouse(this)[1];-2<=U&&U<=N.width+2&&-2<=te&&te<=N.height+2&&(H.dragCategoryDisplayInd=N.model.displayInd,H.initialDragCategoryDisplayInds=H.model.categories.map(function(B){return B.displayInd}),N.model.dragY=N.y,e.raiseToTop(this.parentNode),d.select(this.parentNode).selectAll("rect.bandrect").each(function(B){B.y<te&&te<=B.y+B.height&&(H.potentialClickBand=this)}))}),H.parcatsViewModel.dragDimension=H,y.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(H){if(H.parcatsViewModel.arrangement!=="fixed"&&(H.dragHasMoved=!0,H.dragDimensionDisplayInd!==null)){var N=H.dragDimensionDisplayInd,U=N-1,te=N+1,B=H.parcatsViewModel.dimensions[N];if(H.dragCategoryDisplayInd!==null){var X=B.categories[H.dragCategoryDisplayInd];X.model.dragY+=d.event.dy;var J=X.model.dragY,ee=X.model.displayInd,re=B.categories,se=re[ee-1],oe=re[ee+1];se!==void 0&&J<se.y+se.height/2&&(X.model.displayInd=se.model.displayInd,se.model.displayInd=ee),oe!==void 0&&J+X.height>oe.y+oe.height/2&&(X.model.displayInd=oe.model.displayInd,oe.model.displayInd=ee),H.dragCategoryDisplayInd=X.model.displayInd}if(H.dragCategoryDisplayInd===null||H.parcatsViewModel.arrangement==="freeform"){B.model.dragX=d.event.x;var de=H.parcatsViewModel.dimensions[U],ce=H.parcatsViewModel.dimensions[te];de!==void 0&&B.model.dragX<de.x+de.width&&(B.model.displayInd=de.model.displayInd,de.model.displayInd=N),ce!==void 0&&B.model.dragX+B.width>ce.x&&(B.model.displayInd=ce.model.displayInd,ce.model.displayInd=H.dragDimensionDisplayInd),H.dragDimensionDisplayInd=B.model.displayInd}$(H.parcatsViewModel),K(H.parcatsViewModel),V(H.parcatsViewModel),j(H.parcatsViewModel)}}function z(H){if(H.parcatsViewModel.arrangement!=="fixed"&&H.dragDimensionDisplayInd!==null){d.select(this).selectAll("text").attr("font-weight","normal");var N={},U=D(H.parcatsViewModel),te=H.parcatsViewModel.model.dimensions.map(function(oe){return oe.displayInd}),B=H.initialDragDimensionDisplayInds.some(function(oe,de){return oe!==te[de]});B&&te.forEach(function(oe,de){var ce=H.parcatsViewModel.model.dimensions[de].containerInd;N["dimensions["+ce+"].displayindex"]=oe});var X=!1;if(H.dragCategoryDisplayInd!==null){var J=H.model.categories.map(function(oe){return oe.displayInd});if(X=H.initialDragCategoryDisplayInds.some(function(oe,de){return oe!==J[de]})){var ee=H.model.categories.slice().sort(function(oe,de){return oe.displayInd-de.displayInd}),re=ee.map(function(oe){return oe.categoryValue}),se=ee.map(function(oe){return oe.categoryLabel});N["dimensions["+H.model.containerInd+"].categoryarray"]=[re],N["dimensions["+H.model.containerInd+"].ticktext"]=[se],N["dimensions["+H.model.containerInd+"].categoryorder"]="array"}}H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!H.dragHasMoved&&H.potentialClickBand&&(H.parcatsViewModel.hoveron==="color"?L(H.potentialClickBand,"plotly_click",d.event.sourceEvent):k(H.potentialClickBand,"plotly_click",d.event.sourceEvent)),H.model.dragX=null,H.dragCategoryDisplayInd!==null&&(H.parcatsViewModel.dimensions[H.dragDimensionDisplayInd].categories[H.dragCategoryDisplayInd].model.dragY=null,H.dragCategoryDisplayInd=null),H.dragDimensionDisplayInd=null,H.parcatsViewModel.dragDimension=null,H.dragHasMoved=null,H.potentialClickBand=null,$(H.parcatsViewModel),K(H.parcatsViewModel),d.transition().duration(300).ease("cubic-in-out").each(function(){V(H.parcatsViewModel,!0),j(H.parcatsViewModel,!0)}).each("end",function(){(B||X)&&w.restyle(H.parcatsViewModel.graphDiv,N,[U])})}}function D(H){for(var N,U=H.graphDiv._fullData,te=0;te<U.length;te++)if(H.key===U[te].uid){N=te;break}return N}function j(H,N){var U;N===void 0&&(N=!1),H.pathSelection.data(function(te){return te.paths},u),(U=H.pathSelection,N?U.transition():U).attr("d",function(te){return te.svgD})}function V(H,N){function U(J){return N?J.transition():J}N===void 0&&(N=!1),H.dimensionSelection.data(function(J){return J.dimensions},u);var te=H.dimensionSelection.selectAll("g.category").data(function(J){return J.categories},u);U(H.dimensionSelection).attr("transform",function(J){return t(J.x,0)}),U(te).attr("transform",function(J){return t(0,J.y)}),te.select(".dimlabel").text(function(J,ee){return ee===0?J.parcatsViewModel.model.dimensions[J.model.dimensionInd].dimensionLabel:null}),te.select(".catlabel").attr("text-anchor",function(J){return s(J)?"start":"end"}).attr("x",function(J){return s(J)?J.width+5:-5}).each(function(J){var ee,re;s(J)?(ee=J.width+5,re="start"):(ee=-5,re="end"),d.select(this).selectAll("tspan").attr("x",ee).attr("text-anchor",re)});var B=te.selectAll("rect.bandrect").data(function(J){return J.bands},u),X=B.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(J){return J.color}).attr("fill-opacity",0);B.attr("fill",function(J){return J.color}).attr("width",function(J){return J.width}).attr("height",function(J){return J.height}).attr("y",function(J){return J.y}),b(X),B.each(function(){e.raiseToTop(this)}),B.exit().remove()}function Z(H,N,U){var te,B=U[0],X=N.margin||{l:80,r:80,t:100,b:80},J=B.trace,ee=J.domain,re=N.width,se=N.height,oe=Math.floor(re*(ee.x[1]-ee.x[0])),de=Math.floor(se*(ee.y[1]-ee.y[0])),ce=ee.x[0]*re+X.l,ve=N.height-ee.y[1]*N.height+X.t,Ae=J.line.shape;te=J.hoverinfo==="all"?["count","probability"]:(J.hoverinfo||"").split("+");var fe={trace:J,key:J.uid,model:B,x:ce,y:ve,width:oe,height:de,hoveron:J.hoveron,hoverinfoItems:te,arrangement:J.arrangement,bundlecolors:J.bundlecolors,sortpaths:J.sortpaths,labelfont:J.labelfont,categorylabelfont:J.tickfont,pathShape:Ae,dragDimension:null,margin:X,paths:[],dimensions:[],graphDiv:H,traceSelection:null,pathSelection:null,dimensionSelection:null};return B.dimensions&&($(fe),K(fe)),fe}function Q(H,N,U,te,B){var X,J,ee=[],re=[];for(J=0;J<U.length-1;J++)X=v(U[J]+H[J],H[J+1]),ee.push(X(B)),re.push(X(1-B));var se="M "+H[0]+","+N[0];for(se+="l"+U[0]+",0 ",J=1;J<U.length;J++)se+="C"+ee[J-1]+","+N[J-1]+" "+re[J-1]+","+N[J]+" "+H[J]+","+N[J],se+="l"+U[J]+",0 ";for(se+="l0,"+te+" ",se+="l -"+U[U.length-1]+",0 ",J=U.length-2;J>=0;J--)se+="C"+re[J]+","+(N[J+1]+te)+" "+ee[J]+","+(N[J]+te)+" "+(H[J]+U[J])+","+(N[J]+te),se+="l-"+U[J]+",0 ";return se+="Z"}function K(H){var N=H.dimensions,U=H.model,te=N.map(function(Re){return Re.categories.map(function(Ye){return Ye.y})}),B=H.model.dimensions.map(function(Re){return Re.categories.map(function(Ye){return Ye.displayInd})}),X=H.model.dimensions.map(function(Re){return Re.displayInd}),J=H.dimensions.map(function(Re){return Re.model.dimensionInd}),ee=N.map(function(Re){return Re.x}),re=N.map(function(Re){return Re.width}),se=[];for(var oe in U.paths)U.paths.hasOwnProperty(oe)&&se.push(U.paths[oe]);function de(Re){var Ye=Re.categoryInds.map(function(Qe,lt){return B[lt][Qe]});return J.map(function(Qe){return Ye[Qe]})}se.sort(function(Re,Ye){var Qe=de(Re),lt=de(Ye);return H.sortpaths==="backward"&&(Qe.reverse(),lt.reverse()),Qe.push(Re.valueInds[0]),lt.push(Ye.valueInds[0]),H.bundlecolors&&(Qe.unshift(Re.rawColor),lt.unshift(Ye.rawColor)),Qe<lt?-1:Qe>lt?1:0});for(var ce=new Array(se.length),ve=N[0].model.count,Ae=N[0].categories.map(function(Re){return Re.height}).reduce(function(Re,Ye){return Re+Ye}),fe=0;fe<se.length;fe++){var me,_e=se[fe];me=ve>0?Ae*(_e.count/ve):0;for(var le,ge=new Array(te.length),Te=0;Te<_e.categoryInds.length;Te++){var Se=_e.categoryInds[Te],Me=B[Te][Se],ze=X[Te];ge[ze]=te[ze][Me],te[ze][Me]+=me;var Oe=H.dimensions[ze].categories[Me],De=Oe.bands.length,Xe=Oe.bands[De-1];if(Xe===void 0||_e.rawColor!==Xe.rawColor){var Be=Xe===void 0?0:Xe.y+Xe.height;Oe.bands.push({key:Be,color:_e.color,rawColor:_e.rawColor,height:me,width:Oe.width,count:_e.count,y:Be,categoryViewModel:Oe,parcatsViewModel:H})}else{var Ie=Oe.bands[De-1];Ie.height+=me,Ie.count+=_e.count}}le=H.pathShape==="hspline"?Q(ee,ge,re,me,.5):Q(ee,ge,re,me,0),ce[fe]={key:_e.valueInds[0],model:_e,height:me,leftXs:ee,topYs:ge,dimWidths:re,svgD:le,parcatsViewModel:H}}H.paths=ce}function $(H){var N=H.model.dimensions.map(function(J){return{displayInd:J.displayInd,dimensionInd:J.dimensionInd}});N.sort(function(J,ee){return J.displayInd-ee.displayInd});var U=[];for(var te in N){var B=N[te].dimensionInd,X=H.model.dimensions[B];U.push(ne(H,X))}H.dimensions=U}function ne(H,N){var U,te=H.model.dimensions.length,B=N.displayInd;U=40+(te>1?(H.width-80-16)/(te-1):0)*B;var X,J,ee,re,se,oe=[],de=H.model.maxCats,ce=N.categories.length,ve=N.count,Ae=H.height-8*(de-1),fe=8*(de-ce)/2,me=N.categories.map(function(_e){return{displayInd:_e.displayInd,categoryInd:_e.categoryInd}});for(me.sort(function(_e,le){return _e.displayInd-le.displayInd}),se=0;se<ce;se++)re=me[se].categoryInd,J=N.categories[re],X=ve>0?J.count/ve*Ae:0,ee={key:J.valueInds[0],model:J,width:16,height:X,y:J.dragY!==null?J.dragY:fe,bands:[],parcatsViewModel:H},fe=fe+X+8,oe.push(ee);return{key:N.dimensionInd,x:N.dragX!==null?N.dragX:U,y:0,width:16,model:N,categories:oe,parcatsViewModel:H,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}G.exports=function(H,N,U,te){g(U,H,te,N)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(m,G,W){var d=m("./parcats");G.exports=function(v,w,y,e){var t=v._fullLayout,n=t._paper,a=t._size;d(v,n,w,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},y,e)}},{"./parcats":895}],897:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/layout_attributes"),w=m("../../plots/font_attributes"),y=m("../../plots/domain").attributes,e=m("../../lib/extend").extendFlat,t=m("../../plot_api/plot_template").templatedArray;G.exports={domain:y({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:w({editType:"plot"}),tickfont:w({editType:"plot"}),rangefont:w({editType:"plot"}),dimensions:t("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},v.tickvals,{editType:"plot"}),ticktext:e({},v.ticktext,{editType:"plot"}),tickformat:e({},v.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},d("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(m,G,W){var d=m("./constants"),v=m("@plotly/d3"),w=m("../../lib/gup").keyFun,y=m("../../lib/gup").repeat,e=m("../../lib").sorterAsc,t=m("../../lib").strTranslate,n=d.bar.snapRatio;function a(A,I){return A*(1-n)+I*n}var r=d.bar.snapClose;function g(A,I){return A*(1-r)+I*r}function u(A,I,P,S){if(function(ne,H){for(var N=0;N<H.length;N++)if(ne>=H[N][0]&&ne<=H[N][1])return!0;return!1}(P,S))return P;var E=A?-1:1,z=0,D=I.length-1;if(E<0){var j=z;z=D,D=j}for(var V=I[z],Z=V,Q=z;E*Q<E*D;Q+=E){var K=Q+E,$=I[K];if(E*P<E*g(V,$))return a(V,Z);if(E*P<E*$||K===D)return a($,V);Z=V,V=$}}function s(A){A.attr("x",-d.bar.captureWidth/2).attr("width",d.bar.captureWidth)}function h(A){A.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function l(A){if(!A.brush.filterSpecified)return"0,"+A.height;for(var I,P,S,E=o(A.brush.filter.getConsolidated(),A.height),z=[0],D=E.length?E[0][0]:null,j=0;j<E.length;j++)P=(I=E[j])[1]-I[0],z.push(D),z.push(P),(S=j+1)<E.length&&(D=E[S][0]-I[1]);return z.push(A.height),z}function o(A,I){return A.map(function(P){return P.map(function(S){return Math.max(0,S*I)}).sort(e)})}function p(){v.select(document.body).style("cursor",null)}function c(A){A.attr("stroke-dasharray",l)}function i(A,I){var P=v.select(A).selectAll(".highlight, .highlight-shadow");c(I?P.transition().duration(d.bar.snapDuration).each("end",I):P)}function x(A,I){var P,S=A.brush,E=NaN,z={};if(S.filterSpecified){var D=A.height,j=S.filter.getConsolidated(),V=o(j,D),Z=NaN,Q=NaN,K=NaN;for(P=0;P<=V.length;P++){var $=V[P];if($&&$[0]<=I&&I<=$[1]){Z=P;break}if(Q=P?P-1:NaN,$&&$[0]>I){K=P;break}}if(E=Z,isNaN(E)&&(E=isNaN(Q)||isNaN(K)?isNaN(Q)?K:Q:I-V[Q][1]<V[K][0]-I?Q:K),!isNaN(E)){var ne=V[E],H=function(B,X){var J=d.bar.handleHeight;if(!(X>B[1]+J||X<B[0]-J))return X>=.9*B[1]+.1*B[0]?"n":X<=.9*B[0]+.1*B[1]?"s":"ns"}(ne,I);H&&(z.interval=j[E],z.intervalPix=ne,z.region=H)}}if(A.ordinal&&!z.region){var N=A.unitTickvals,U=A.unitToPaddedPx.invert(I);for(P=0;P<N.length;P++){var te=[.25*N[Math.max(P-1,0)]+.75*N[P],.25*N[Math.min(P+1,N.length-1)]+.75*N[P]];if(U>=te[0]&&U<=te[1]){z.clickableOrdinalRange=te;break}}}return z}function f(A,I){v.event.sourceEvent.stopPropagation();var P=I.height-v.mouse(A)[1]-2*d.verticalPadding,S=I.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.grabbingBar?S.newExtent=[P-S.grabPoint,P+S.barLength-S.grabPoint].map(I.unitToPaddedPx.invert):S.newExtent=[S.startExtent,I.unitToPaddedPx.invert(P)].sort(e),I.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(I),i(A.parentNode)}function _(A,I){var P=x(I,I.height-v.mouse(A)[1]-2*d.verticalPadding),S="crosshair";P.clickableOrdinalRange?S="pointer":P.region&&(S=P.region+"-resize"),v.select(document.body).style("cursor",S)}function b(A){A.on("mousemove",function(I){v.event.preventDefault(),I.parent.inBrushDrag||_(this,I)}).on("mouseleave",function(I){I.parent.inBrushDrag||p()}).call(v.behavior.drag().on("dragstart",function(I){(function(P,S){v.event.sourceEvent.stopPropagation();var E=S.height-v.mouse(P)[1]-2*d.verticalPadding,z=S.unitToPaddedPx.invert(E),D=S.brush,j=x(S,E),V=j.interval,Z=D.svgBrush;if(Z.wasDragged=!1,Z.grabbingBar=j.region==="ns",Z.grabbingBar){var Q=V.map(S.unitToPaddedPx);Z.grabPoint=E-Q[0]-d.verticalPadding,Z.barLength=Q[1]-Q[0]}Z.clickableOrdinalRange=j.clickableOrdinalRange,Z.stayingIntervals=S.multiselect&&D.filterSpecified?D.filter.getConsolidated():[],V&&(Z.stayingIntervals=Z.stayingIntervals.filter(function(K){return K[0]!==V[0]&&K[1]!==V[1]})),Z.startExtent=j.region?V[j.region==="s"?1:0]:z,S.parent.inBrushDrag=!0,Z.brushStartCallback()})(this,I)}).on("drag",function(I){f(this,I)}).on("dragend",function(I){(function(P,S){var E=S.brush,z=E.filter,D=E.svgBrush;D._dragging||(_(P,S),f(P,S),S.brush.svgBrush.wasDragged=!1),D._dragging=!1,v.event.sourceEvent.stopPropagation();var j=D.grabbingBar;if(D.grabbingBar=!1,D.grabLocation=void 0,S.parent.inBrushDrag=!1,p(),!D.wasDragged)return D.wasDragged=void 0,D.clickableOrdinalRange?E.filterSpecified&&S.multiselect?D.extent.push(D.clickableOrdinalRange):(D.extent=[D.clickableOrdinalRange],E.filterSpecified=!0):j?(D.extent=D.stayingIntervals,D.extent.length===0&&k(E)):k(E),D.brushCallback(S),i(P.parentNode),void D.brushEndCallback(E.filterSpecified?z.getConsolidated():[]);var V=function(){z.set(z.getConsolidated())};if(S.ordinal){var Z=S.unitTickvals;Z[Z.length-1]<Z[0]&&Z.reverse(),D.newExtent=[u(0,Z,D.newExtent[0],D.stayingIntervals),u(1,Z,D.newExtent[1],D.stayingIntervals)];var Q=D.newExtent[1]>D.newExtent[0];D.extent=D.stayingIntervals.concat(Q?[D.newExtent]:[]),D.extent.length||k(E),D.brushCallback(S),Q?i(P.parentNode,V):(V(),i(P.parentNode))}else V();D.brushEndCallback(E.filterSpecified?z.getConsolidated():[])})(this,I)}))}function T(A,I){return A[0]-I[0]}function k(A){A.filterSpecified=!1,A.svgBrush.extent=[[-1/0,1/0]]}function L(A){for(var I,P=A.slice(),S=[],E=P.shift();E;){for(I=E.slice();(E=P.shift())&&E[0]<=I[1];)I[1]=Math.max(I[1],E[1]);S.push(I)}return S.length===1&&S[0][0]>S[0][1]&&(S=[]),S}G.exports={makeBrush:function(A,I,P,S,E,z){var D,j=function(){var V,Z,Q=[];return{set:function(K){(Q=K.map(function($){return $.slice().sort(e)}).sort(T)).length===1&&Q[0][0]===-1/0&&Q[0][1]===1/0&&(Q=[[0,-1]]),V=L(Q),Z=Q.reduce(function($,ne){return[Math.min($[0],ne[0]),Math.max($[1],ne[1])]},[1/0,-1/0])},get:function(){return Q.slice()},getConsolidated:function(){return V},getBounds:function(){return Z}}}();return j.set(P),{filter:j,filterSpecified:I,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(D=E,function(V){var Z=V.brush,Q=function(K){return K.svgBrush.extent.map(function($){return $.slice()})}(Z).slice();Z.filter.set(Q),D()}),brushEndCallback:z}}},ensureAxisBrush:function(A,I,P){var S=A.selectAll("."+d.cn.axisBrush).data(y,w);S.enter().append("g").classed(d.cn.axisBrush,!0),function(E,z,D){var j=D._context.staticPlot,V=E.selectAll(".background").data(y);V.enter().append("rect").classed("background",!0).call(s).call(h).style("pointer-events",j?"none":"auto").attr("transform",t(0,d.verticalPadding)),V.call(b).attr("height",function(K){return K.height-d.verticalPadding});var Z=E.selectAll(".highlight-shadow").data(y);Z.enter().append("line").classed("highlight-shadow",!0).attr("x",-d.bar.width/2).attr("stroke-width",d.bar.width+d.bar.strokeWidth).attr("stroke",z).attr("opacity",d.bar.strokeOpacity).attr("stroke-linecap","butt"),Z.attr("y1",function(K){return K.height}).call(c);var Q=E.selectAll(".highlight").data(y);Q.enter().append("line").classed("highlight",!0).attr("x",-d.bar.width/2).attr("stroke-width",d.bar.width-d.bar.strokeWidth).attr("stroke",d.bar.fillColor).attr("opacity",d.bar.fillOpacity).attr("stroke-linecap","butt"),Q.attr("y1",function(K){return K.height}).call(c)}(S,I,P)},cleanRanges:function(A,I){if(Array.isArray(A[0])?(A=A.map(function(S){return S.sort(e)}),A=I.multiselect?L(A.sort(T)):[A[0]]):A=[A.sort(e)],I.tickvals){var P=I.tickvals.slice().sort(e);if(!(A=A.map(function(S){var E=[u(0,P,S[0],[]),u(1,P,S[1],[])];if(E[1]>E[0])return E}).filter(function(S){return S})).length)return}return A.length>1?A:A[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:m("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../plots/get_data").getModuleCalcData,w=m("./plot"),y=m("../../constants/xmlns_namespaces");W.name="parcoords",W.plot=function(e){var t=v(e.calcdata,"parcoords")[0];t.length&&w(e,t)},W.clean=function(e,t,n,a){var r=a._has&&a._has("parcoords"),g=t._has&&t._has("parcoords");r&&!g&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},W.toSVG=function(e){var t=e._fullLayout._glimages,n=d.select(e).selectAll(".svg-container");n.filter(function(a,r){return r===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");t.append("svg:image").attr({xmlns:y.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){d.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray,v=m("../../components/colorscale"),w=m("../../lib/gup").wrap;G.exports=function(y,e){var t,n;return v.hasColorscale(e,"line")&&d(e.line.color)?(t=e.line.color,n=v.extractOpts(e.line).colorscale,v.calc(y,e,{vals:t,containerStr:"line",cLetter:"c"})):(t=function(a){for(var r=new Array(a),g=0;g<a;g++)r[g]=.5;return r}(e._length),n=[[0,e.line.color],[1,e.line.color]]),w({lineColor:t,cscale:n})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(m,G,W){G.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../plots/domain").defaults,e=m("../../plots/array_container_defaults"),t=m("../../plots/cartesian/axes"),n=m("./attributes"),a=m("./axisbrush"),r=m("./constants").maxDimensionCount,g=m("./merge_length");function u(s,h,l,o){function p(_,b){return d.coerce(s,h,n.dimensions,_,b)}var c=p("values"),i=p("visible");if(c&&c.length||(i=h.visible=!1),i){p("label"),p("tickvals"),p("ticktext"),p("tickformat");var x=p("range");h._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:x},t.setConvert(h._ax,o.layout),p("multiselect");var f=p("constraintrange");f&&(h.constraintrange=a.cleanRanges(f,h))}}G.exports=function(s,h,l,o){function p(_,b){return d.coerce(s,h,n,_,b)}var c=s.dimensions;Array.isArray(c)&&c.length>r&&(d.log("parcoords traces support up to "+r+" dimensions at the moment"),c.splice(r));var i=e(s,h,{name:"dimensions",layout:o,handleItemDefaults:u}),x=function(_,b,T,k,L){var A=L("line.color",T);if(v(_,"line")&&d.isArrayOrTypedArray(A)){if(A.length)return L("line.colorscale"),w(_,b,k,L,{prefix:"line.",cLetter:"c"}),A.length;b.line.color=T}return 1/0}(s,h,l,o,p);y(h,o,p),Array.isArray(i)&&i.length||(h.visible=!1),g(h,i,"values",x);var f={family:o.font.family,size:Math.round(o.font.size/1.2),color:o.font.color};d.coerceFont(p,"labelfont",f),d.coerceFont(p,"tickfont",f),d.coerceFont(p,"rangefont",f),p("labelangle"),p("labelside"),p("unselected.line.color"),p("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(m,G,W){var d=m("../../lib").isTypedArray;W.convertTypedArray=function(v){return d(v)?Array.prototype.slice.call(v):v},W.isOrdinal=function(v){return!!v.tickvals},W.isVisible=function(v){return v.visible||!("visible"in v)}},{"../../lib":515}],905:[function(m,G,W){var d=m("./base_index");d.plot=m("./plot"),G.exports=d},{"./base_index":899,"./plot":909}],906:[function(m,G,W){var d=m("glslify"),v=d([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),w=d([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),y=m("./constants").maxDimensionCount,e=m("../../lib"),t=new Uint8Array(4),n=new Uint8Array(4),a={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function r(i,x,f,_,b){var T=i._gl;T.enable(T.SCISSOR_TEST),T.scissor(x,f,_,b),i.clear({color:[0,0,0,0],depth:1})}function g(i,x,f,_,b,T){var k=T.key;f.drawCompleted||(function(L){L.read({x:0,y:0,width:1,height:1,data:t})}(i),f.drawCompleted=!0),function L(A){var I=Math.min(_,b-A*_);A===0&&(window.cancelAnimationFrame(f.currentRafs[k]),delete f.currentRafs[k],r(i,T.scissorX,T.scissorY,T.scissorWidth,T.viewBoxSize[1])),f.clearOnly||(T.count=2*I,T.offset=2*A*_,x(T),A*_+I<b&&(f.currentRafs[k]=window.requestAnimationFrame(function(){L(A+1)})),f.drawCompleted=!1)}(0)}function u(i,x){for(var f=new Array(256),_=0;_<256;_++)f[_]=i(_/255).concat(x);return f}function s(i,x){return(i>>>8*x)%256/255}function h(i,x,f){for(var _=new Array(8*x),b=0,T=0;T<x;T++)for(var k=0;k<2;k++)for(var L=0;L<4;L++){var A=4*i+L,I=f[64*T+A];A===63&&k===0&&(I*=-1),_[b++]=I}return _}function l(i){var x="0"+i;return x.substr(x.length-2)}function o(i){return i<y?"p"+l(i+1)+"_"+l(i+4):"colors"}function p(i,x,f,_,b,T,k,L,A,I,P,S,E,z){for(var D=[[],[]],j=0;j<64;j++)D[0][j]=j===b?1:0,D[1][j]=j===T?1:0;k*=z,L*=z,A*=z,I*=z;var V=i.lines.canvasOverdrag*z,Z=i.domain,Q=i.canvasWidth*z,K=i.canvasHeight*z,$=i.pad.l*z,ne=i.pad.b*z,H=i.layoutHeight*z,N=i.layoutWidth*z,U=i.deselectedLines.color,te=i.deselectedLines.opacity;return e.extendFlat({key:P,resolution:[Q,K],viewBoxPos:[k+V,L],viewBoxSize:[A,I],i0:b,i1:T,dim0A:D[0].slice(0,16),dim0B:D[0].slice(16,32),dim0C:D[0].slice(32,48),dim0D:D[0].slice(48,64),dim1A:D[1].slice(0,16),dim1B:D[1].slice(16,32),dim1C:D[1].slice(32,48),dim1D:D[1].slice(48,64),drwLayer:S,contextColor:[U[0]/255,U[1]/255,U[2]/255,te!=="auto"?U[3]*te:Math.max(1/255,Math.pow(1/i.lines.color.length,1/3))],scissorX:(_===x?0:k+V)+($-V)+N*Z.x[0],scissorWidth:(_===f?Q-k+V:A+.5)+(_===x?k+V:0),scissorY:L+ne+H*Z.y[0],scissorHeight:I,viewportX:$-V+N*Z.x[0],viewportY:ne+H*Z.y[0],viewportWidth:Q,viewportHeight:K},E)}function c(i){var x=Math.max(0,Math.floor(2047*i[0]),0),f=Math.min(2047,Math.ceil(2047*i[1]),2047);return[Math.min(x,f),Math.max(x,f)]}G.exports=function(i,x){var f,_,b,T,k,L=x.context,A=x.pick,I=x.regl,P=I._gl,S=P.getParameter(P.ALIASED_LINE_WIDTH_RANGE),E=Math.max(S[0],Math.min(S[1],x.viewModel.plotGlPixelRatio)),z={currentRafs:{},drawCompleted:!0,clearOnly:!1},D=function(K){for(var $={},ne=0;ne<=y;ne+=4)$[o(ne)]=K.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return $}(I),j=I.texture(a),V=[];Q(x);var Z=I({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:I.prop("scissorX"),y:I.prop("scissorY"),width:I.prop("scissorWidth"),height:I.prop("scissorHeight")}},viewport:{x:I.prop("viewportX"),y:I.prop("viewportY"),width:I.prop("viewportWidth"),height:I.prop("viewportHeight")},dither:!1,vert:v,frag:w,primitive:"lines",lineWidth:E,attributes:D,uniforms:{resolution:I.prop("resolution"),viewBoxPos:I.prop("viewBoxPos"),viewBoxSize:I.prop("viewBoxSize"),dim0A:I.prop("dim0A"),dim1A:I.prop("dim1A"),dim0B:I.prop("dim0B"),dim1B:I.prop("dim1B"),dim0C:I.prop("dim0C"),dim1C:I.prop("dim1C"),dim0D:I.prop("dim0D"),dim1D:I.prop("dim1D"),loA:I.prop("loA"),hiA:I.prop("hiA"),loB:I.prop("loB"),hiB:I.prop("hiB"),loC:I.prop("loC"),hiC:I.prop("hiC"),loD:I.prop("loD"),hiD:I.prop("hiD"),palette:j,contextColor:I.prop("contextColor"),maskTexture:I.prop("maskTexture"),drwLayer:I.prop("drwLayer"),maskHeight:I.prop("maskHeight")},offset:I.prop("offset"),count:I.prop("count")});function Q(K){f=K.model,_=K.viewModel,b=_.dimensions.slice(),T=b[0]?b[0].values.length:0;var $=f.lines,ne=A?$.color.map(function(N,U){return U/$.color.length}):$.color,H=function(N,U,te){for(var B,X=new Array(N*(y+4)),J=0,ee=0;ee<N;ee++){for(var re=0;re<y;re++)X[J++]=re<U.length?U[re].paddedUnitValues[ee]:.5;X[J++]=s(ee,2),X[J++]=s(ee,1),X[J++]=s(ee,0),X[J++]=(B=te[ee],Math.max(1e-6,Math.min(.999999,B)))}return X}(T,b,ne);(function(N,U,te){for(var B=0;B<=y;B+=4)N[o(B)](h(B/4,U,te))})(D,T,H),L||A||(j=I.texture(e.extendFlat({data:u(f.unitToColor,255)},a)))}return{render:function(K,$,ne){var H,N,U,te=K.length,B=1/0,X=-1/0;for(H=0;H<te;H++)K[H].dim0.canvasX<B&&(B=K[H].dim0.canvasX,N=H),K[H].dim1.canvasX>X&&(X=K[H].dim1.canvasX,U=H);te===0&&r(I,0,0,f.canvasWidth,f.canvasHeight);var J=function(me){var _e,le,ge,Te=[[],[]];for(ge=0;ge<64;ge++){var Se=!me&&ge<b.length?b[ge].brush.filter.getBounds():[-1/0,1/0];Te[0][ge]=Se[0],Te[1][ge]=Se[1]}var Me=new Array(16384);for(_e=0;_e<16384;_e++)Me[_e]=255;if(!me)for(_e=0;_e<b.length;_e++){var ze=_e%8,Oe=(_e-ze)/8,De=Math.pow(2,ze),Xe=b[_e].brush.filter.get();if(!(Xe.length<2)){var Be=c(Xe[0])[1];for(le=1;le<Xe.length;le++){var Ie=c(Xe[le]);for(ge=Be+1;ge<Ie[0];ge++)Me[8*ge+Oe]&=~De;Be=Math.max(Be,Ie[1])}}}var Re={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Me};return k?k(Re):k=I.texture(Re),{maskTexture:k,maskHeight:2048,loA:Te[0].slice(0,16),loB:Te[0].slice(16,32),loC:Te[0].slice(32,48),loD:Te[0].slice(48,64),hiA:Te[1].slice(0,16),hiB:Te[1].slice(16,32),hiC:Te[1].slice(32,48),hiD:Te[1].slice(48,64)}}(L);for(H=0;H<te;H++){var ee=K[H],re=ee.dim0.crossfilterDimensionIndex,se=ee.dim1.crossfilterDimensionIndex,oe=ee.canvasX,de=ee.canvasY,ce=oe+ee.panelSizeX,ve=ee.plotGlPixelRatio;if($||!V[re]||V[re][0]!==oe||V[re][1]!==ce){V[re]=[oe,ce];var Ae=p(f,N,U,H,re,se,oe,de,ee.panelSizeX,ee.panelSizeY,ee.dim0.crossfilterDimensionIndex,L?0:A?2:1,J,ve);z.clearOnly=ne;var fe=$?f.lines.blockLineCount:T;g(I,Z,z,fe,T,Ae)}}},readPixel:function(K,$){return I.read({x:K,y:$,width:1,height:1,data:n}),n},readPixels:function(K,$,ne,H){var N=new Uint8Array(4*ne*H);return I.read({x:K,y:$,width:ne,height:H,data:N}),N},destroy:function(){for(var K in i.style["pointer-events"]="none",j.destroy(),k&&k.destroy(),D)D[K].destroy()},update:Q}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(m,G,W){G.exports=function(d,v,w,y){var e,t;for(y||(y=1/0),e=0;e<v.length;e++)(t=v[e]).visible&&(y=Math.min(y,t[w].length));for(y===1/0&&(y=0),d._length=y,e=0;e<v.length;e++)(t=v[e]).visible&&(t._length=y);return y}},{}],908:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("color-rgba"),e=m("../../plots/cartesian/axes"),t=v.strRotate,n=v.strTranslate,a=m("../../lib/svg_text_utils"),r=m("../../components/drawing"),g=m("../../components/colorscale"),u=m("../../lib/gup"),s=u.keyFun,h=u.repeat,l=u.unwrap,o=m("./helpers"),p=m("./constants"),c=m("./axisbrush"),i=m("./lines");function x(V,Z,Q){return v.aggNums(V,null,Z,Q)}function f(V,Z){return b(x(Math.min,V,Z),x(Math.max,V,Z))}function _(V){var Z=V.range;return Z?b(Z[0],Z[1]):f(V.values,V._length)}function b(V,Z){return!isNaN(V)&&isFinite(V)||(V=0),!isNaN(Z)&&isFinite(Z)||(Z=0),V===Z&&(V===0?(V-=1,Z+=1):(V*=.9,Z*=1.1)),[V,Z]}function T(V,Z,Q,K,$){var ne,H,N=_(Q);return K?d.scale.ordinal().domain(K.map((ne=w(Q.tickformat),H=$,H?function(U,te){var B=H[te];return B==null?ne(U):B}:ne))).range(K.map(function(U){var te=(U-N[0])/(N[1]-N[0]);return V-Z+te*(2*Z-V)})):d.scale.linear().domain(N).range([V-Z,Z])}function k(V){if(V.tickvals){var Z=_(V);return d.scale.ordinal().domain(V.tickvals).range(V.tickvals.map(function(Q){return(Q-Z[0])/(Z[1]-Z[0])}))}}function L(V){var Z=V.map(function($){return $[0]}),Q=V.map(function($){var ne=y($[1]);return d.rgb("rgb("+ne[0]+","+ne[1]+","+ne[2]+")")}),K="rgb".split("").map(function($){return d.scale.linear().clamp(!0).domain(Z).range(Q.map((ne=$,function(H){return H[ne]})));var ne});return function($){return K.map(function(ne){return ne($)})}}function A(V){return V.dimensions.some(function(Z){return Z.brush.filterSpecified})}function I(V,Z,Q){var K=l(Z),$=K.trace,ne=o.convertTypedArray(K.lineColor),H=$.line,N={color:y($.unselected.line.color),opacity:$.unselected.line.opacity},U=g.extractOpts(H),te=U.reversescale?g.flipScale(K.cscale):K.cscale,B=$.domain,X=$.dimensions,J=V.width,ee=$.labelangle,re=$.labelside,se=$.labelfont,oe=$.tickfont,de=$.rangefont,ce=v.extendDeepNoArrays({},H,{color:ne.map(d.scale.linear().domain(_({values:ne,range:[U.min,U.max],_length:$._length}))),blockLineCount:p.blockLineCount,canvasOverdrag:p.overdrag*p.canvasPixelRatio}),ve=Math.floor(J*(B.x[1]-B.x[0])),Ae=Math.floor(V.height*(B.y[1]-B.y[0])),fe=V.margin||{l:80,r:80,t:100,b:80},me=ve,_e=Ae;return{key:Q,colCount:X.filter(o.isVisible).length,dimensions:X,tickDistance:p.tickDistance,unitToColor:L(te),lines:ce,deselectedLines:N,labelAngle:ee,labelSide:re,labelFont:se,tickFont:oe,rangeFont:de,layoutWidth:J,layoutHeight:V.height,domain:B,translateX:B.x[0]*J,translateY:V.height-B.y[1]*V.height,pad:fe,canvasWidth:me*p.canvasPixelRatio+2*ce.canvasOverdrag,canvasHeight:_e*p.canvasPixelRatio,width:me,height:_e,canvasPixelRatio:p.canvasPixelRatio}}function P(V,Z,Q){var K=Q.width,$=Q.height,ne=Q.dimensions,H=Q.canvasPixelRatio,N=function(J){return K*J/Math.max(1,Q.colCount-1)},U=p.verticalPadding/$,te=function(J,ee){return d.scale.linear().range([ee,J-ee])}($,p.verticalPadding),B={key:Q.key,xScale:N,model:Q,inBrushDrag:!1},X={};return B.dimensions=ne.filter(o.isVisible).map(function(J,ee){var re=function(Me,ze){return d.scale.linear().domain(_(Me)).range([ze,1-ze])}(J,U),se=X[J.label];X[J.label]=(se||0)+1;var oe=J.label+(se?"__"+se:""),de=J.constraintrange,ce=de&&de.length;ce&&!Array.isArray(de[0])&&(de=[de]);var ve=ce?de.map(function(Me){return Me.map(re)}):[[-1/0,1/0]],Ae=J.values;Ae.length>J._length&&(Ae=Ae.slice(0,J._length));var fe,me=J.tickvals;function _e(Me,ze){return{val:Me,text:fe[ze]}}function le(Me,ze){return Me.val-ze.val}if(Array.isArray(me)&&me.length){fe=J.ticktext,Array.isArray(fe)&&fe.length?fe.length>me.length?fe=fe.slice(0,me.length):me.length>fe.length&&(me=me.slice(0,fe.length)):fe=me.map(w(J.tickformat));for(var ge=1;ge<me.length;ge++)if(me[ge]<me[ge-1]){for(var Te=me.map(_e).sort(le),Se=0;Se<me.length;Se++)me[Se]=Te[Se].val,fe[Se]=Te[Se].text;break}}else me=void 0;return Ae=o.convertTypedArray(Ae),{key:oe,label:J.label,tickFormat:J.tickformat,tickvals:me,ticktext:fe,ordinal:o.isOrdinal(J),multiselect:J.multiselect,xIndex:ee,crossfilterDimensionIndex:ee,visibleIndex:J._index,height:$,values:Ae,paddedUnitValues:Ae.map(re),unitTickvals:me&&me.map(re),xScale:N,x:N(ee),canvasX:N(ee)*H,unitToPaddedPx:te,domainScale:T($,p.verticalPadding,J,me,fe),ordinalScale:k(J),parent:B,model:Q,brush:c.makeBrush(V,ce,ve,function(){V.linePickActive(!1)},function(){var Me=B;Me.focusLayer&&Me.focusLayer.render(Me.panels,!0);var ze=A(Me);!V.contextShown()&&ze?(Me.contextLayer&&Me.contextLayer.render(Me.panels,!0),V.contextShown(!0)):V.contextShown()&&!ze&&(Me.contextLayer&&Me.contextLayer.render(Me.panels,!0,!0),V.contextShown(!1))},function(Me){if(B.focusLayer.render(B.panels,!0),B.pickLayer&&B.pickLayer.render(B.panels,!0),V.linePickActive(!0),Z&&Z.filterChanged){var ze=re.invert,Oe=Me.map(function(De){return De.map(ze).sort(v.sorterAsc)}).sort(function(De,Xe){return De[0]-Xe[0]});Z.filterChanged(B.key,J._index,Oe)}})}}),B}function S(V){V.classed(p.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function E(V,Z){var Q=Z==="top"?1:-1,K=V*Math.PI/180;return{dir:Q,dx:Math.sin(K),dy:Math.cos(K),degrees:V}}function z(V,Z,Q){for(var K=Z.panels||(Z.panels=[]),$=V.data(),ne=0;ne<$.length-1;ne++){var H=K[ne]||(K[ne]={}),N=$[ne],U=$[ne+1];H.dim0=N,H.dim1=U,H.canvasX=N.canvasX,H.panelSizeX=U.canvasX-N.canvasX,H.panelSizeY=Z.model.canvasHeight,H.y=0,H.canvasY=0,H.plotGlPixelRatio=Q}}function D(V,Z){return e.tickText(V._ax,Z,!1).text}function j(V,Z){if(V.ordinal)return"";var Q=V.domainScale.domain(),K=Q[Z?Q.length-1:0];return D(V.model.dimensions[V.visibleIndex],K)}G.exports=function(V,Z,Q,K){var $=V._context.staticPlot,ne=V._fullLayout,H=ne._toppaper,N=ne._glcontainer,U=V._context.plotGlPixelRatio,te=V._fullLayout.paper_bgcolor;(function(Me){for(var ze=0;ze<Me.length;ze++)for(var Oe=0;Oe<Me[ze].length;Oe++)for(var De=Me[ze][Oe].trace,Xe=De.dimensions,Be=0;Be<Xe.length;Be++){var Ie=Xe[Be].values,Re=Xe[Be]._ax;Re&&(Re.range?Re.range=b(Re.range[0],Re.range[1]):Re.range=f(Ie,De._length),Re.dtick||(Re.dtick=.01*(Math.abs(Re.range[1]-Re.range[0])||1)),Re.tickformat=Xe[Be].tickformat,e.calcTicks(Re),Re.cleanRange())}})(Z);var B,X,J=(B=!0,X=!1,{linePickActive:function(Me){return arguments.length?B=!!Me:B},contextShown:function(Me){return arguments.length?X=!!Me:X}}),ee=Z.filter(function(Me){return l(Me).trace.visible}).map(I.bind(0,Q)).map(P.bind(0,J,K));N.each(function(Me,ze){return v.extendFlat(Me,ee[ze])});var re=N.selectAll(".gl-canvas").each(function(Me){Me.viewModel=ee[0],Me.viewModel.plotGlPixelRatio=U,Me.viewModel.paperColor=te,Me.model=Me.viewModel?Me.viewModel.model:null}),se=null;re.filter(function(Me){return Me.pick}).style("pointer-events",$?"none":"auto").on("mousemove",function(Me){if(J.linePickActive()&&Me.lineLayer&&K&&K.hover){var ze=d.event,Oe=this.width,De=this.height,Xe=d.mouse(this),Be=Xe[0],Ie=Xe[1];if(Be<0||Ie<0||Be>=Oe||Ie>=De)return;var Re=Me.lineLayer.readPixel(Be,De-1-Ie),Ye=Re[3]!==0,Qe=Ye?Re[2]+256*(Re[1]+256*Re[0]):null,lt={x:Be,y:Ie,clientX:ze.clientX,clientY:ze.clientY,dataIndex:Me.model.key,curveNumber:Qe};Qe!==se&&(Ye?K.hover(lt):K.unhover&&K.unhover(lt),se=Qe)}}),re.style("opacity",function(Me){return Me.pick?0:1}),H.style("background","rgba(255, 255, 255, 0)");var oe=H.selectAll("."+p.cn.parcoords).data(ee,s);oe.exit().remove(),oe.enter().append("g").classed(p.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),oe.attr("transform",function(Me){return n(Me.model.translateX,Me.model.translateY)});var de=oe.selectAll("."+p.cn.parcoordsControlView).data(h,s);de.enter().append("g").classed(p.cn.parcoordsControlView,!0),de.attr("transform",function(Me){return n(Me.model.pad.l,Me.model.pad.t)});var ce=de.selectAll("."+p.cn.yAxis).data(function(Me){return Me.dimensions},s);ce.enter().append("g").classed(p.cn.yAxis,!0),de.each(function(Me){z(ce,Me,U)}),re.each(function(Me){if(Me.viewModel){!Me.lineLayer||K?Me.lineLayer=i(this,Me):Me.lineLayer.update(Me),(Me.key||Me.key===0)&&(Me.viewModel[Me.key]=Me.lineLayer);var ze=!Me.context||K;Me.lineLayer.render(Me.viewModel.panels,ze)}}),ce.attr("transform",function(Me){return n(Me.xScale(Me.xIndex),0)}),ce.call(d.behavior.drag().origin(function(Me){return Me}).on("drag",function(Me){var ze=Me.parent;J.linePickActive(!1),Me.x=Math.max(-p.overdrag,Math.min(Me.model.width+p.overdrag,d.event.x)),Me.canvasX=Me.x*Me.model.canvasPixelRatio,ce.sort(function(Oe,De){return Oe.x-De.x}).each(function(Oe,De){Oe.xIndex=De,Oe.x=Me===Oe?Oe.x:Oe.xScale(Oe.xIndex),Oe.canvasX=Oe.x*Oe.model.canvasPixelRatio}),z(ce,ze,U),ce.filter(function(Oe){return Math.abs(Me.xIndex-Oe.xIndex)!==0}).attr("transform",function(Oe){return n(Oe.xScale(Oe.xIndex),0)}),d.select(this).attr("transform",n(Me.x,0)),ce.each(function(Oe,De,Xe){Xe===Me.parent.key&&(ze.dimensions[De]=Oe)}),ze.contextLayer&&ze.contextLayer.render(ze.panels,!1,!A(ze)),ze.focusLayer.render&&ze.focusLayer.render(ze.panels)}).on("dragend",function(Me){var ze=Me.parent;Me.x=Me.xScale(Me.xIndex),Me.canvasX=Me.x*Me.model.canvasPixelRatio,z(ce,ze,U),d.select(this).attr("transform",function(Oe){return n(Oe.x,0)}),ze.contextLayer&&ze.contextLayer.render(ze.panels,!1,!A(ze)),ze.focusLayer&&ze.focusLayer.render(ze.panels),ze.pickLayer&&ze.pickLayer.render(ze.panels,!0),J.linePickActive(!0),K&&K.axesMoved&&K.axesMoved(ze.key,ze.dimensions.map(function(Oe){return Oe.crossfilterDimensionIndex}))})),ce.exit().remove();var ve=ce.selectAll("."+p.cn.axisOverlays).data(h,s);ve.enter().append("g").classed(p.cn.axisOverlays,!0),ve.selectAll("."+p.cn.axis).remove();var Ae=ve.selectAll("."+p.cn.axis).data(h,s);Ae.enter().append("g").classed(p.cn.axis,!0),Ae.each(function(Me){var ze=Me.model.height/Me.model.tickDistance,Oe=Me.domainScale,De=Oe.domain();d.select(this).call(d.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(ze,Me.tickFormat).tickValues(Me.ordinal?De:null).tickFormat(function(Xe){return o.isOrdinal(Me)?Xe:D(Me.model.dimensions[Me.visibleIndex],Xe)}).scale(Oe)),r.font(Ae.selectAll("text"),Me.model.tickFont)}),Ae.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Ae.selectAll("text").style("text-shadow",a.makeTextShadow(te)).style("cursor","default");var fe=ve.selectAll("."+p.cn.axisHeading).data(h,s);fe.enter().append("g").classed(p.cn.axisHeading,!0);var me=fe.selectAll("."+p.cn.axisTitle).data(h,s);me.enter().append("text").classed(p.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",$?"none":"auto"),me.text(function(Me){return Me.label}).each(function(Me){var ze=d.select(this);r.font(ze,Me.model.labelFont),a.convertToTspans(ze,V)}).attr("transform",function(Me){var ze=E(Me.model.labelAngle,Me.model.labelSide),Oe=p.axisTitleOffset;return(ze.dir>0?"":n(0,2*Oe+Me.model.height))+t(ze.degrees)+n(-Oe*ze.dx,-Oe*ze.dy)}).attr("text-anchor",function(Me){var ze=E(Me.model.labelAngle,Me.model.labelSide);return 2*Math.abs(ze.dx)>Math.abs(ze.dy)?ze.dir*ze.dx<0?"start":"end":"middle"});var _e=ve.selectAll("."+p.cn.axisExtent).data(h,s);_e.enter().append("g").classed(p.cn.axisExtent,!0);var le=_e.selectAll("."+p.cn.axisExtentTop).data(h,s);le.enter().append("g").classed(p.cn.axisExtentTop,!0),le.attr("transform",n(0,-p.axisExtentOffset));var ge=le.selectAll("."+p.cn.axisExtentTopText).data(h,s);ge.enter().append("text").classed(p.cn.axisExtentTopText,!0).call(S),ge.text(function(Me){return j(Me,!0)}).each(function(Me){r.font(d.select(this),Me.model.rangeFont)});var Te=_e.selectAll("."+p.cn.axisExtentBottom).data(h,s);Te.enter().append("g").classed(p.cn.axisExtentBottom,!0),Te.attr("transform",function(Me){return n(0,Me.model.height+p.axisExtentOffset)});var Se=Te.selectAll("."+p.cn.axisExtentBottomText).data(h,s);Se.enter().append("text").classed(p.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),Se.text(function(Me){return j(Me,!1)}).each(function(Me){r.font(d.select(this),Me.model.rangeFont)}),c.ensureAxisBrush(ve,te,V)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(m,G,W){var d=m("./parcoords"),v=m("../../lib/prepare_regl"),w=m("./helpers").isVisible,y={};function e(t,n,a){var r=n.indexOf(a),g=t.indexOf(r);return g===-1&&(g+=n.length),g}(G.exports=function(t,n){var a=t._fullLayout;if(v(t,[],y)){var r={},g={},u={},s={},h=a._size;n.forEach(function(l,o){var p=l[0].trace;u[o]=p.index;var c=s[o]=p._fullInput.index;r[o]=t.data[c].dimensions,g[o]=t.data[c].dimensions.slice()}),d(t,n,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{filterChanged:function(l,o,p){var c=g[l][o],i=p.map(function(k){return k.slice()}),x="dimensions["+o+"].constraintrange",f=a._tracePreGUI[t._fullData[u[l]]._fullInput.uid];if(f[x]===void 0){var _=c.constraintrange;f[x]=_||null}var b=t._fullData[u[l]].dimensions[o];i.length?(i.length===1&&(i=i[0]),c.constraintrange=i,b.constraintrange=i.slice(),i=[i]):(delete c.constraintrange,delete b.constraintrange,i=null);var T={};T[x]=i,t.emit("plotly_restyle",[T,[s[l]]])},hover:function(l){t.emit("plotly_hover",l)},unhover:function(l){t.emit("plotly_unhover",l)},axesMoved:function(l,o){var p=function(c,i){return function(x,f){return e(c,i,x)-e(c,i,f)}}(o,g[l].filter(w));r[l].sort(p),g[l].filter(function(c){return!w(c)}).sort(function(c){return g[l].indexOf(c)}).forEach(function(c){r[l].splice(r[l].indexOf(c),1),r[l].splice(g[l].indexOf(c),0,c)}),t.emit("plotly_restyle",[{dimensions:[r[l]]},[s[l]]])}})}}).reglPrecompiled=y},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(m,G,W){var d=m("../../plots/attributes"),v=m("../../plots/domain").attributes,w=m("../../plots/font_attributes"),y=m("../../components/color/attributes"),e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("../../lib/extend").extendFlat,a=w({editType:"plot",arrayOk:!0,colorEditType:"plot"});G.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:y.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:t({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},a,{}),outsidetextfont:n({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:v({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(m,G,W){var d=m("../../plots/plots");W.name="pie",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],912:[function(m,G,W){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../../components/color"),y={};function e(n){return function(a,r){return!!a&&!!(a=v(a)).isValid()&&(a=w.addOpacity(a,a.getAlpha()),n[r]||(n[r]=a),a)}}function t(n,a){var r,g=JSON.stringify(n),u=a[g];if(!u){for(u=n.slice(),r=0;r<n.length;r++)u.push(v(n[r]).lighten(20).toHexString());for(r=0;r<n.length;r++)u.push(v(n[r]).darken(20).toHexString());a[g]=u}return u}G.exports={calc:function(n,a){var r,g,u=[],s=n._fullLayout,h=s.hiddenlabels||[],l=a.labels,o=a.marker.colors||[],p=a.values,c=a._length,i=a._hasValues&&c;if(a.dlabel)for(l=new Array(c),r=0;r<c;r++)l[r]=String(a.label0+r*a.dlabel);var x={},f=e(s["_"+a.type+"colormap"]),_=0,b=!1;for(r=0;r<c;r++){var T,k,L;if(i){if(T=p[r],!d(T))continue;T=+T}else T=1;(k=l[r])!==void 0&&k!==""||(k=r);var A=x[k=String(k)];A===void 0?(x[k]=u.length,(L=h.indexOf(k)!==-1)||(_+=T),u.push({v:T,label:k,color:f(o[r],k),i:r,pts:[r],hidden:L})):(b=!0,(g=u[A]).v+=T,g.pts.push(r),g.hidden||(_+=T),g.color===!1&&o[r]&&(g.color=f(o[r],k)))}return u=u.filter(function(I){return I.v>=0}),(a.type==="funnelarea"?b:a.sort)&&u.sort(function(I,P){return P.v-I.v}),u[0]&&(u[0].vTotal=_),u},crossTraceCalc:function(n,a){var r=(a||{}).type;r||(r="pie");var g=n._fullLayout,u=n.calcdata,s=g[r+"colorway"],h=g["_"+r+"colormap"];g["extend"+r+"colors"]&&(s=t(s,y));for(var l=0,o=0;o<u.length;o++){var p=u[o];if(p[0].trace.type===r)for(var c=0;c<p.length;c++){var i=p[c];i.color===!1&&(h[i.label]?i.color=h[i.label]:(h[i.label]=i.color=s[l%s.length],l++))}}},makePullColorFn:e,generateExtendedColors:t}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("./attributes"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText;function t(n,a){var r=Array.isArray(n),g=v.isArrayOrTypedArray(a),u=Math.min(r?n.length:1/0,g?a.length:1/0);if(isFinite(u)||(u=0),u&&g){for(var s,h=0;h<u;h++){var l=a[h];if(d(l)&&l>0){s=!0;break}}s||(u=0)}return{hasLabels:r,hasValues:g,len:u}}G.exports={handleLabelsAndValues:t,supplyDefaults:function(n,a,r,g){function u(f,_){return v.coerce(n,a,w,f,_)}var s=t(u("labels"),u("values")),h=s.len;if(a._hasLabels=s.hasLabels,a._hasValues=s.hasValues,!a._hasLabels&&a._hasValues&&(u("label0"),u("dlabel")),h){a._length=h,u("marker.line.width")&&u("marker.line.color"),u("marker.colors"),u("scalegroup");var l,o=u("text"),p=u("texttemplate");if(p||(l=u("textinfo",Array.isArray(o)?"text+percent":"percent")),u("hovertext"),u("hovertemplate"),p||l&&l!=="none"){var c=u("textposition");e(n,a,g,u,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(c)||c==="auto"||c==="outside")&&u("automargin"),(c==="inside"||c==="auto"||Array.isArray(c))&&u("insidetextorientation")}y(a,g,u);var i=u("hole");if(u("title.text")){var x=u("title.position",i?"middle center":"top center");i||x!=="middle center"||(a.title.position="top center"),v.coerceFont(u,"title.font",g.font)}u("sort"),u("direction"),u("rotation"),u("pull")}else a.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(m,G,W){var d=m("../../components/fx/helpers").appendArrayMultiPointValues;G.exports=function(v,w){var y={curveNumber:w.index,pointNumbers:v.pts,data:w._input,fullData:w,label:v.label,color:v.color,value:v.v,percent:v.percent,text:v.text,bbox:v.bbox,v:v.v};return v.pts.length===1&&(y.pointNumber=y.i=v.pts[0]),d(y,w,v.pts),w.type==="funnelarea"&&(delete y.v,delete y.i),y}},{"../../components/fx/helpers":403}],915:[function(m,G,W){var d=m("../../lib");function v(w){return w.indexOf("e")!==-1?w.replace(/[.]?0+e/,"e"):w.indexOf(".")!==-1?w.replace(/[.]?0+$/,""):w}W.formatPiePercent=function(w,y){var e=v((100*w).toPrecision(3));return d.numSeparate(e,y)+"%"},W.formatPieValue=function(w,y){var e=v(w.toPrecision(10));return d.numSeparate(e,y)},W.getFirstFilled=function(w,y){if(Array.isArray(w))for(var e=0;e<y.length;e++){var t=w[y[e]];if(t||t===0||t==="")return t}},W.castOption=function(w,y){return Array.isArray(w)?W.getFirstFilled(w,y):w||void 0},W.getRotationAngle=function(w){return(w==="auto"?0:w)*Math.PI/180}},{"../../lib":515}],916:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,supplyLayoutDefaults:m("./layout_defaults"),layoutAttributes:m("./layout_attributes"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style"),styleOne:m("./style_one"),moduleType:"trace",name:"pie",basePlotModule:m("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(m,G,W){G.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("hiddenlabels"),e("piecolorway",y.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../../components/fx"),y=m("../../components/color"),e=m("../../components/drawing"),t=m("../../lib"),n=t.strScale,a=t.strTranslate,r=m("../../lib/svg_text_utils"),g=m("../bar/uniform_text"),u=g.recordMinTextSize,s=g.clearMinTextSize,h=m("../bar/constants").TEXTPAD,l=m("./helpers"),o=m("./event_data"),p=m("../../lib").isValidTextValue;function c(Z,Q,K){var $=K[0],ne=$.cx,H=$.cy,N=$.trace,U=N.type==="funnelarea";"_hasHoverLabel"in N||(N._hasHoverLabel=!1),"_hasHoverEvent"in N||(N._hasHoverEvent=!1),Z.on("mouseover",function(te){var B=Q._fullLayout,X=Q._fullData[N.index];if(!Q._dragging&&B.hovermode!==!1){var J=X.hoverinfo;if(Array.isArray(J)&&(J=w.castHoverinfo({hoverinfo:[l.castOption(J,te.pts)],_module:N._module},B,0)),J==="all"&&(J="label+text+value+percent+name"),X.hovertemplate||J!=="none"&&J!=="skip"&&J){var ee=te.rInscribed||0,re=ne+te.pxmid[0]*(1-ee),se=H+te.pxmid[1]*(1-ee),oe=B.separators,de=[];if(J&&J.indexOf("label")!==-1&&de.push(te.label),te.text=l.castOption(X.hovertext||X.text,te.pts),J&&J.indexOf("text")!==-1){var ce=te.text;t.isValidTextValue(ce)&&de.push(ce)}te.value=te.v,te.valueLabel=l.formatPieValue(te.v,oe),J&&J.indexOf("value")!==-1&&de.push(te.valueLabel),te.percent=te.v/$.vTotal,te.percentLabel=l.formatPiePercent(te.percent,oe),J&&J.indexOf("percent")!==-1&&de.push(te.percentLabel);var ve=X.hoverlabel,Ae=ve.font,fe=[];w.loneHover({trace:N,x0:re-ee*$.r,x1:re+ee*$.r,y:se,_x0:U?ne+te.TL[0]:re-ee*$.r,_x1:U?ne+te.TR[0]:re+ee*$.r,_y0:U?H+te.TL[1]:se-ee*$.r,_y1:U?H+te.BL[1]:se+ee*$.r,text:de.join("<br>"),name:X.hovertemplate||J.indexOf("name")!==-1?X.name:void 0,idealAlign:te.pxmid[0]<0?"left":"right",color:l.castOption(ve.bgcolor,te.pts)||te.color,borderColor:l.castOption(ve.bordercolor,te.pts),fontFamily:l.castOption(Ae.family,te.pts),fontSize:l.castOption(Ae.size,te.pts),fontColor:l.castOption(Ae.color,te.pts),nameLength:l.castOption(ve.namelength,te.pts),textAlign:l.castOption(ve.align,te.pts),hovertemplate:l.castOption(X.hovertemplate,te.pts),hovertemplateLabels:te,eventData:[o(te,X)]},{container:B._hoverlayer.node(),outerContainer:B._paper.node(),gd:Q,inOut_bbox:fe}),te.bbox=fe[0],N._hasHoverLabel=!0}N._hasHoverEvent=!0,Q.emit("plotly_hover",{points:[o(te,X)],event:d.event})}}),Z.on("mouseout",function(te){var B=Q._fullLayout,X=Q._fullData[N.index],J=d.select(this).datum();N._hasHoverEvent&&(te.originalEvent=d.event,Q.emit("plotly_unhover",{points:[o(J,X)],event:d.event}),N._hasHoverEvent=!1),N._hasHoverLabel&&(w.loneUnhover(B._hoverlayer.node()),N._hasHoverLabel=!1)}),Z.on("click",function(te){var B=Q._fullLayout,X=Q._fullData[N.index];Q._dragging||B.hovermode===!1||(Q._hoverdata=[o(te,X)],w.click(Q,d.event))})}function i(Z,Q,K){var $=l.castOption(Z.insidetextfont.color,Q.pts);!$&&Z._input.textfont&&($=l.castOption(Z._input.textfont.color,Q.pts));var ne=l.castOption(Z.insidetextfont.family,Q.pts)||l.castOption(Z.textfont.family,Q.pts)||K.family,H=l.castOption(Z.insidetextfont.size,Q.pts)||l.castOption(Z.textfont.size,Q.pts)||K.size;return{color:$||y.contrast(Q.color),family:ne,size:H}}function x(Z,Q){for(var K,$,ne=0;ne<Z.length;ne++)if(($=(K=Z[ne][0]).trace).title.text){var H=$.title.text;$._meta&&(H=t.templateString(H,$._meta));var N=e.tester.append("text").attr("data-notex",1).text(H).call(e.font,$.title.font).call(r.convertToTspans,Q),U=e.bBox(N.node(),!0);K.titleBox={width:U.width,height:U.height},N.remove()}}function f(Z,Q,K){var $=K.r||Q.rpx1,ne=Q.rInscribed;if(Q.startangle===Q.stopangle)return{rCenter:1-ne,scale:0,rotate:0,textPosAngle:0};var H,N=Q.ring,U=N===1&&Math.abs(Q.startangle-Q.stopangle)===2*Math.PI,te=Q.halfangle,B=Q.midangle,X=K.trace.insidetextorientation,J=X==="horizontal",ee=X==="tangential",re=X==="radial",se=X==="auto",oe=[];if(!se){var de,ce=function(le,ge){if(function(ze,Oe){var De=ze.startangle,Xe=ze.stopangle;return De>Oe&&Oe>Xe||De<Oe&&Oe<Xe}(Q,le)){var Te=Math.abs(le-Q.startangle),Se=Math.abs(le-Q.stopangle),Me=Te<Se?Te:Se;(H=ge==="tan"?b(Z,$,N,Me,0):_(Z,$,N,Me,Math.PI/2)).textPosAngle=le,oe.push(H)}};if(J||ee){for(de=4;de>=-4;de-=2)ce(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1),"tan")}if(J||re){for(de=4;de>=-4;de-=2)ce(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)ce(Math.PI*(de+.5),"rad")}}if(U||se||J){var ve=Math.sqrt(Z.width*Z.width+Z.height*Z.height);if((H={scale:ne*$*2/ve,rCenter:1-ne,rotate:0}).textPosAngle=(Q.startangle+Q.stopangle)/2,H.scale>=1)return H;oe.push(H)}(se||re)&&((H=_(Z,$,N,te,B)).textPosAngle=(Q.startangle+Q.stopangle)/2,oe.push(H)),(se||ee)&&((H=b(Z,$,N,te,B)).textPosAngle=(Q.startangle+Q.stopangle)/2,oe.push(H));for(var Ae=0,fe=0,me=0;me<oe.length;me++){var _e=oe[me].scale;if(fe<_e&&(fe=_e,Ae=me),!se&&fe>=1)break}return oe[Ae]}function _(Z,Q,K,$,ne){Q=Math.max(0,Q-2*h);var H=Z.width/Z.height,N=L(H,$,Q,K);return{scale:2*N/Z.height,rCenter:T(H,N/Q),rotate:k(ne)}}function b(Z,Q,K,$,ne){Q=Math.max(0,Q-2*h);var H=Z.height/Z.width,N=L(H,$,Q,K);return{scale:2*N/Z.width,rCenter:T(H,N/Q),rotate:k(ne+Math.PI/2)}}function T(Z,Q){return Math.cos(Q)-Z*Q}function k(Z){return(180/Math.PI*Z+720)%180-90}function L(Z,Q,K,$){var ne=Z+1/(2*Math.tan(Q));return K*Math.min(1/(Math.sqrt(ne*ne+.5)+ne),$/(Math.sqrt(Z*Z+$/2)+Z))}function A(Z,Q){return Z.v!==Q.vTotal||Q.trace.hole?Math.min(1/(1+1/Math.sin(Z.halfangle)),Z.ring/2):1}function I(Z,Q){var K=Q.pxmid[0],$=Q.pxmid[1],ne=Z.width/2,H=Z.height/2;return K<0&&(ne*=-1),$<0&&(H*=-1),{scale:1,rCenter:1,rotate:0,x:ne+Math.abs(H)*(ne>0?1:-1)/2,y:H/(1+K*K/($*$)),outside:!0}}function P(Z,Q){var K,$,ne,H=Z.trace,N={x:Z.cx,y:Z.cy},U={tx:0,ty:0};U.ty+=H.title.font.size,ne=E(H),H.title.position.indexOf("top")!==-1?(N.y-=(1+ne)*Z.r,U.ty-=Z.titleBox.height):H.title.position.indexOf("bottom")!==-1&&(N.y+=(1+ne)*Z.r);var te,B,X=(te=Z.r,B=Z.trace.aspectratio,te/(B===void 0?1:B)),J=Q.w*(H.domain.x[1]-H.domain.x[0])/2;return H.title.position.indexOf("left")!==-1?(J+=X,N.x-=(1+ne)*X,U.tx+=Z.titleBox.width/2):H.title.position.indexOf("center")!==-1?J*=2:H.title.position.indexOf("right")!==-1&&(J+=X,N.x+=(1+ne)*X,U.tx-=Z.titleBox.width/2),K=J/Z.titleBox.width,$=S(Z,Q)/Z.titleBox.height,{x:N.x,y:N.y,scale:Math.min(K,$),tx:U.tx,ty:U.ty}}function S(Z,Q){var K=Z.trace,$=Q.h*(K.domain.y[1]-K.domain.y[0]);return Math.min(Z.titleBox.height,$/2)}function E(Z){var Q,K=Z.pull;if(!K)return 0;if(Array.isArray(K))for(K=0,Q=0;Q<Z.pull.length;Q++)Z.pull[Q]>K&&(K=Z.pull[Q]);return K}function z(Z,Q){for(var K=[],$=0;$<Z.length;$++){var ne=Z[$][0],H=ne.trace,N=H.domain,U=Q.w*(N.x[1]-N.x[0]),te=Q.h*(N.y[1]-N.y[0]);H.title.text&&H.title.position!=="middle center"&&(te-=S(ne,Q));var B=U/2,X=te/2;H.type!=="funnelarea"||H.scalegroup||(X/=H.aspectratio),ne.r=Math.min(B,X)/(1+E(H)),ne.cx=Q.l+Q.w*(H.domain.x[1]+H.domain.x[0])/2,ne.cy=Q.t+Q.h*(1-H.domain.y[0])-te/2,H.title.text&&H.title.position.indexOf("bottom")!==-1&&(ne.cy-=S(ne,Q)),H.scalegroup&&K.indexOf(H.scalegroup)===-1&&K.push(H.scalegroup)}(function(J,ee){for(var re,se,oe,de=0;de<ee.length;de++){var ce=1/0,ve=ee[de];for(se=0;se<J.length;se++)if(re=J[se][0],(oe=re.trace).scalegroup===ve){var Ae;if(oe.type==="pie")Ae=re.r*re.r;else if(oe.type==="funnelarea"){var fe,me;oe.aspectratio>1?(fe=re.r,me=fe/oe.aspectratio):(me=re.r,fe=me*oe.aspectratio),fe*=(1+oe.baseratio)/2,Ae=fe*me}ce=Math.min(ce,Ae/re.vTotal)}for(se=0;se<J.length;se++)if(re=J[se][0],(oe=re.trace).scalegroup===ve){var _e=ce*re.vTotal;oe.type==="funnelarea"&&(_e/=(1+oe.baseratio)/2,_e/=oe.aspectratio),re.r=Math.sqrt(_e)}}})(Z,K)}function D(Z,Q){return[Z*Math.sin(Q),-Z*Math.cos(Q)]}function j(Z,Q,K){var $=Z._fullLayout,ne=K.trace,H=ne.texttemplate,N=ne.textinfo;if(!H&&N&&N!=="none"){var U,te=N.split("+"),B=function(Ae){return te.indexOf(Ae)!==-1},X=B("label"),J=B("text"),ee=B("value"),re=B("percent"),se=$.separators;if(U=X?[Q.label]:[],J){var oe=l.getFirstFilled(ne.text,Q.pts);p(oe)&&U.push(oe)}ee&&U.push(l.formatPieValue(Q.v,se)),re&&U.push(l.formatPiePercent(Q.v/K.vTotal,se)),Q.text=U.join("<br>")}if(H){var de=t.castOption(ne,Q.i,"texttemplate");if(de){var ce=function(Ae){return{label:Ae.label,value:Ae.v,valueLabel:l.formatPieValue(Ae.v,$.separators),percent:Ae.v/K.vTotal,percentLabel:l.formatPiePercent(Ae.v/K.vTotal,$.separators),color:Ae.color,text:Ae.text,customdata:t.castOption(ne,Ae.i,"customdata")}}(Q),ve=l.getFirstFilled(ne.text,Q.pts);(p(ve)||ve==="")&&(ce.text=ve),Q.text=t.texttemplateString(de,ce,Z._fullLayout._d3locale,ce,ne._meta||{})}else Q.text=""}}function V(Z,Q){var K=Z.rotate*Math.PI/180,$=Math.cos(K),ne=Math.sin(K),H=(Q.left+Q.right)/2,N=(Q.top+Q.bottom)/2;Z.textX=H*$-N*ne,Z.textY=H*ne+N*$,Z.noCenter=!0}G.exports={plot:function(Z,Q){var K=Z._context.staticPlot,$=Z._fullLayout,ne=$._size;s("pie",$),x(Q,Z),z(Q,ne);var H=t.makeTraceGroups($._pielayer,Q,"trace").each(function(N){var U=d.select(this),te=N[0],B=te.trace;(function(X){var J,ee,re,se=X[0],oe=se.r,de=se.trace,ce=l.getRotationAngle(de.rotation),ve=2*Math.PI/se.vTotal,Ae="px0",fe="px1";if(de.direction==="counterclockwise"){for(J=0;J<X.length&&X[J].hidden;J++);if(J===X.length)return;ce+=ve*X[J].v,ve*=-1,Ae="px1",fe="px0"}for(re=D(oe,ce),J=0;J<X.length;J++)(ee=X[J]).hidden||(ee[Ae]=re,ee.startangle=ce,ce+=ve*ee.v/2,ee.pxmid=D(oe,ce),ee.midangle=ce,ce+=ve*ee.v/2,re=D(oe,ce),ee.stopangle=ce,ee[fe]=re,ee.largeArc=ee.v>se.vTotal/2?1:0,ee.halfangle=Math.PI*Math.min(ee.v/se.vTotal,.5),ee.ring=1-de.hole,ee.rInscribed=A(ee,se))})(N),U.attr("stroke-linejoin","round"),U.each(function(){var X=d.select(this).selectAll("g.slice").data(N);X.enter().append("g").classed("slice",!0),X.exit().remove();var J=[[[],[]],[[],[]]],ee=!1;X.each(function(fe,me){if(fe.hidden)d.select(this).selectAll("path,g").remove();else{fe.pointNumber=fe.i,fe.curveNumber=B.index,J[fe.pxmid[1]<0?0:1][fe.pxmid[0]<0?0:1].push(fe);var _e=te.cx,le=te.cy,ge=d.select(this),Te=ge.selectAll("path.surface").data([fe]);if(Te.enter().append("path").classed("surface",!0).style({"pointer-events":K?"none":"all"}),ge.call(c,Z,N),B.pull){var Se=+l.castOption(B.pull,fe.pts)||0;Se>0&&(_e+=Se*fe.pxmid[0],le+=Se*fe.pxmid[1])}fe.cxFinal=_e,fe.cyFinal=le;var Me=B.hole;if(fe.v===te.vTotal){var ze="M"+(_e+fe.px0[0])+","+(le+fe.px0[1])+Ie(fe.px0,fe.pxmid,!0,1)+Ie(fe.pxmid,fe.px0,!0,1)+"Z";Me?Te.attr("d","M"+(_e+Me*fe.px0[0])+","+(le+Me*fe.px0[1])+Ie(fe.px0,fe.pxmid,!1,Me)+Ie(fe.pxmid,fe.px0,!1,Me)+"Z"+ze):Te.attr("d",ze)}else{var Oe=Ie(fe.px0,fe.px1,!0,1);if(Me){var De=1-Me;Te.attr("d","M"+(_e+Me*fe.px1[0])+","+(le+Me*fe.px1[1])+Ie(fe.px1,fe.px0,!1,Me)+"l"+De*fe.px0[0]+","+De*fe.px0[1]+Oe+"Z")}else Te.attr("d","M"+_e+","+le+"l"+fe.px0[0]+","+fe.px0[1]+Oe+"Z")}j(Z,fe,te);var Xe=l.castOption(B.textposition,fe.pts),Be=ge.selectAll("g.slicetext").data(fe.text&&Xe!=="none"?[0]:[]);Be.enter().append("g").classed("slicetext",!0),Be.exit().remove(),Be.each(function(){var Re=t.ensureSingle(d.select(this),"text","",function($e){$e.attr("data-notex",1)}),Ye=t.ensureUniformFontSize(Z,Xe==="outside"?function($e,vt,Nt){var qt=l.castOption($e.outsidetextfont.color,vt.pts)||l.castOption($e.textfont.color,vt.pts)||Nt.color,Jt=l.castOption($e.outsidetextfont.family,vt.pts)||l.castOption($e.textfont.family,vt.pts)||Nt.family,Wt=l.castOption($e.outsidetextfont.size,vt.pts)||l.castOption($e.textfont.size,vt.pts)||Nt.size;return{color:qt,family:Jt,size:Wt}}(B,fe,$.font):i(B,fe,$.font));Re.text(fe.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ye).call(r.convertToTspans,Z);var Qe,lt=e.bBox(Re.node());if(Xe==="outside")Qe=I(lt,fe);else if(Qe=f(lt,fe,te),Xe==="auto"&&Qe.scale<1){var xt=t.ensureUniformFontSize(Z,B.outsidetextfont);Re.call(e.font,xt),Qe=I(lt=e.bBox(Re.node()),fe)}var wt=Qe.textPosAngle,bt=wt===void 0?fe.pxmid:D(te.r,wt);if(Qe.targetX=_e+bt[0]*Qe.rCenter+(Qe.x||0),Qe.targetY=le+bt[1]*Qe.rCenter+(Qe.y||0),V(Qe,lt),Qe.outside){var nt=Qe.targetY;fe.yLabelMin=nt-lt.height/2,fe.yLabelMid=nt,fe.yLabelMax=nt+lt.height/2,fe.labelExtraX=0,fe.labelExtraY=0,ee=!0}Qe.fontSize=Ye.size,u(B.type,Qe,$),N[me].transform=Qe,t.setTransormAndDisplay(Re,Qe)})}function Ie(Re,Ye,Qe,lt){var xt=lt*(Ye[0]-Re[0]),wt=lt*(Ye[1]-Re[1]);return"a"+lt*te.r+","+lt*te.r+" 0 "+fe.largeArc+(Qe?" 1 ":" 0 ")+xt+","+wt}});var re=d.select(this).selectAll("g.titletext").data(B.title.text?[0]:[]);if(re.enter().append("g").classed("titletext",!0),re.exit().remove(),re.each(function(){var fe,me=t.ensureSingle(d.select(this),"text","",function(le){le.attr("data-notex",1)}),_e=B.title.text;B._meta&&(_e=t.templateString(_e,B._meta)),me.text(_e).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,B.title.font).call(r.convertToTspans,Z),fe=B.title.position==="middle center"?function(le){var ge=Math.sqrt(le.titleBox.width*le.titleBox.width+le.titleBox.height*le.titleBox.height);return{x:le.cx,y:le.cy,scale:le.trace.hole*le.r*2/ge,tx:0,ty:-le.titleBox.height/2+le.trace.title.font.size}}(te):P(te,ne),me.attr("transform",a(fe.x,fe.y)+n(Math.min(1,fe.scale))+a(fe.tx,fe.ty))}),ee&&function(fe,me){var _e,le,ge,Te,Se,Me,ze,Oe,De,Xe,Be,Ie,Re;function Ye(wt,bt){return wt.pxmid[1]-bt.pxmid[1]}function Qe(wt,bt){return bt.pxmid[1]-wt.pxmid[1]}function lt(wt,bt){bt||(bt={});var nt,$e,vt,Nt,qt=bt.labelExtraY+(le?bt.yLabelMax:bt.yLabelMin),Jt=le?wt.yLabelMin:wt.yLabelMax,Wt=le?wt.yLabelMax:wt.yLabelMin,ar=wt.cyFinal+Se(wt.px0[1],wt.px1[1]),Dt=qt-Jt;if(Dt*ze>0&&(wt.labelExtraY=Dt),Array.isArray(me.pull))for($e=0;$e<Xe.length;$e++)(vt=Xe[$e])===wt||(l.castOption(me.pull,wt.pts)||0)>=(l.castOption(me.pull,vt.pts)||0)||((wt.pxmid[1]-vt.pxmid[1])*ze>0?(Dt=vt.cyFinal+Se(vt.px0[1],vt.px1[1])-Jt-wt.labelExtraY)*ze>0&&(wt.labelExtraY+=Dt):(Wt+wt.labelExtraY-ar)*ze>0&&(nt=3*Me*Math.abs($e-Xe.indexOf(wt)),(Nt=vt.cxFinal+Te(vt.px0[0],vt.px1[0])+nt-(wt.cxFinal+wt.pxmid[0])-wt.labelExtraX)*Me>0&&(wt.labelExtraX+=Nt)))}for(le=0;le<2;le++)for(ge=le?Ye:Qe,Se=le?Math.max:Math.min,ze=le?1:-1,_e=0;_e<2;_e++){for(Te=_e?Math.max:Math.min,Me=_e?1:-1,(Oe=fe[le][_e]).sort(ge),De=fe[1-le][_e],Xe=De.concat(Oe),Ie=[],Be=0;Be<Oe.length;Be++)Oe[Be].yLabelMid!==void 0&&Ie.push(Oe[Be]);for(Re=!1,Be=0;le&&Be<De.length;Be++)if(De[Be].yLabelMid!==void 0){Re=De[Be];break}for(Be=0;Be<Ie.length;Be++){var xt=Be&&Ie[Be-1];Re&&!Be&&(xt=Re),lt(Ie[Be],xt)}}}(J,B),function(fe,me){fe.each(function(_e){var le=d.select(this);if(_e.labelExtraX||_e.labelExtraY){var ge=le.select("g.slicetext text");_e.transform.targetX+=_e.labelExtraX,_e.transform.targetY+=_e.labelExtraY,t.setTransormAndDisplay(ge,_e.transform);var Te=_e.cxFinal+_e.pxmid[0],Se="M"+Te+","+(_e.cyFinal+_e.pxmid[1]),Me=(_e.yLabelMax-_e.yLabelMin)*(_e.pxmid[0]<0?-1:1)/4;if(_e.labelExtraX){var ze=_e.labelExtraX*_e.pxmid[1]/_e.pxmid[0],Oe=_e.yLabelMid+_e.labelExtraY-(_e.cyFinal+_e.pxmid[1]);Math.abs(ze)>Math.abs(Oe)?Se+="l"+Oe*_e.pxmid[0]/_e.pxmid[1]+","+Oe+"H"+(Te+_e.labelExtraX+Me):Se+="l"+_e.labelExtraX+","+ze+"v"+(Oe-ze)+"h"+Me}else Se+="V"+(_e.yLabelMid+_e.labelExtraY)+"h"+Me;t.ensureSingle(le,"path","textline").call(y.stroke,me.outsidetextfont.color).attr({"stroke-width":Math.min(2,me.outsidetextfont.size/8),d:Se,fill:"none"})}else le.select("path.textline").remove()})}(X,B),ee&&B.automargin){var se=e.bBox(U.node()),oe=B.domain,de=ne.w*(oe.x[1]-oe.x[0]),ce=ne.h*(oe.y[1]-oe.y[0]),ve=(.5*de-te.r)/ne.w,Ae=(.5*ce-te.r)/ne.h;v.autoMargin(Z,"pie."+B.uid+".automargin",{xl:oe.x[0]-ve,xr:oe.x[1]+ve,yb:oe.y[0]-Ae,yt:oe.y[1]+Ae,l:Math.max(te.cx-te.r-se.left,0),r:Math.max(se.right-(te.cx+te.r),0),b:Math.max(se.bottom-(te.cy+te.r),0),t:Math.max(te.cy-te.r-se.top,0),pad:5})}})});setTimeout(function(){H.selectAll("tspan").each(function(){var N=d.select(this);N.attr("dy")&&N.attr("dy",N.attr("dy"))})},0)},formatSliceLabel:j,transformInsideText:f,determineInsideTextFont:i,positionTitleOutside:P,prerenderTitles:x,layoutAreas:z,attachFxHandlers:c,computeTransform:V}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(m,G,W){var d=m("@plotly/d3"),v=m("./style_one"),w=m("../bar/uniform_text").resizeText;G.exports=function(y){var e=y._fullLayout._pielayer.selectAll(".trace");w(y,e,"pie"),e.each(function(t){var n=t[0].trace,a=d.select(this);a.style({opacity:n.opacity}),a.selectAll("path.surface").each(function(r){d.select(this).call(v,r,n)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(m,G,W){var d=m("../../components/color"),v=m("./helpers").castOption;G.exports=function(w,y,e){var t=e.marker.line,n=v(t.color,y.pts)||d.defaultLine,a=v(t.width,y.pts)||0;w.style("stroke-width",a).call(d.fill,y.color).call(d.stroke,n)}},{"../../components/color":367,"./helpers":915}],922:[function(m,G,W){var d=m("../scatter/attributes");G.exports={x:d.x,y:d.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:d.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(m,G,W){var d=m("../../../stackgl_modules").gl_pointcloud2d,v=m("../../lib/str2rgbarray"),w=m("../../plots/cartesian/autorange").findExtremes,y=m("../scatter/get_trace_color");function e(n,a){this.scene=n,this.uid=a,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=d(n.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var t=e.prototype;t.handlePick=function(n){var a=this.idToIndex[n.pointId];return{trace:this,dataCoord:n.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*a],this.pickXYData[2*a+1]]:[this.pickXData[a],this.pickYData[a]],textLabel:Array.isArray(this.textLabels)?this.textLabels[a]:this.textLabels,color:this.color,name:this.name,pointIndex:a,hoverinfo:this.hoverinfo}},t.update=function(n){this.index=n.index,this.textLabels=n.text,this.name=n.name,this.hoverinfo=n.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(n),this.color=y(n,{})},t.updateFast=function(n){var a,r,g,u,s,h,l=this.xData=this.pickXData=n.x,o=this.yData=this.pickYData=n.y,p=this.pickXYData=n.xy,c=n.xbounds&&n.ybounds,i=n.indices,x=this.bounds;if(p){if(g=p,a=p.length>>>1,c)x[0]=n.xbounds[0],x[2]=n.xbounds[1],x[1]=n.ybounds[0],x[3]=n.ybounds[1];else for(h=0;h<a;h++)u=g[2*h],s=g[2*h+1],u<x[0]&&(x[0]=u),u>x[2]&&(x[2]=u),s<x[1]&&(x[1]=s),s>x[3]&&(x[3]=s);if(i)r=i;else for(r=new Int32Array(a),h=0;h<a;h++)r[h]=h}else for(a=l.length,g=new Float32Array(2*a),r=new Int32Array(a),h=0;h<a;h++)u=l[h],s=o[h],r[h]=h,g[2*h]=u,g[2*h+1]=s,u<x[0]&&(x[0]=u),u>x[2]&&(x[2]=u),s<x[1]&&(x[1]=s),s>x[3]&&(x[3]=s);this.idToIndex=r,this.pointcloudOptions.idToIndex=r,this.pointcloudOptions.positions=g;var f=v(n.marker.color),_=v(n.marker.border.color),b=n.opacity*n.marker.opacity;f[3]*=b,this.pointcloudOptions.color=f;var T=n.marker.blend;T===null&&(T=l.length<100||o.length<100),this.pointcloudOptions.blend=T,_[3]*=b,this.pointcloudOptions.borderColor=_;var k=n.marker.sizemin,L=Math.max(n.marker.sizemax,n.marker.sizemin);this.pointcloudOptions.sizeMin=k,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=n.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var A=this.scene.xaxis,I=this.scene.yaxis,P=L/2||.5;n._extremes[A._id]=w(A,[x[0],x[2]],{ppad:P}),n._extremes[I._id]=w(I,[x[1],x[3]],{ppad:P})},t.dispose=function(){this.pointcloud.dispose()},G.exports=function(n,a){var r=new e(n,a.uid);return r.update(a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(m,G,W){var d=m("../../lib"),v=m("./attributes");G.exports=function(w,y,e){function t(n,a){return d.coerce(w,y,v,n,a)}t("x"),t("y"),t("xbounds"),t("ybounds"),w.xy&&w.xy instanceof Float32Array&&(y.xy=w.xy),w.indices&&w.indices instanceof Int32Array&&(y.indices=w.indices),t("text"),t("marker.color",e),t("marker.opacity"),t("marker.blend"),t("marker.sizemin"),t("marker.sizemax"),t("marker.border.color",e),t("marker.border.arearatio"),y._length=null}},{"../../lib":515,"./attributes":922}],925:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("../scatter3d/calc"),plot:m("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:m("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(m,G,W){var d=m("../../plots/font_attributes"),v=m("../../plots/attributes"),w=m("../../components/color/attributes"),y=m("../../components/fx/attributes"),e=m("../../plots/domain").attributes,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../components/colorscale/attributes"),a=m("../../plot_api/plot_template").templatedArray,r=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,g=m("../../lib/extend").extendFlat,u=m("../../plot_api/edit_types").overrideAll;(G.exports=u({hoverinfo:g({},v.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:y.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:r("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:d({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:w.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:t({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:w.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:t({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:g(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(m,G,W){var d=m("../../plot_api/edit_types").overrideAll,v=m("../../plots/get_data").getModuleCalcData,w=m("./plot"),y=m("../../components/fx/layout_attributes"),e=m("../../lib/setcursor"),t=m("../../components/dragelement"),n=m("../../components/selections").prepSelect,a=m("../../lib"),r=m("../../registry");function g(u,s){var h=u._fullData[s],l=u._fullLayout,o=l.dragmode,p=l.dragmode==="pan"?"move":"crosshair",c=h._bgRect;if(c&&o!=="pan"&&o!=="zoom"){e(c,p);var i={_id:"x",c2p:a.identity,_offset:h._sankey.translateX,_length:h._sankey.width},x={_id:"y",c2p:a.identity,_offset:h._sankey.translateY,_length:h._sankey.height},f={gd:u,element:c.node(),plotinfo:{id:s,xaxis:i,yaxis:x,fillRangeItems:a.noop},subplot:s,xaxes:[i],yaxes:[x],doneFnCompleted:function(_){var b,T=u._fullData[s],k=T.node.groups.slice(),L=[];function A(E){for(var z=T._sankey.graph.nodes,D=0;D<z.length;D++)if(z[D].pointNumber===E)return z[D]}for(var I=0;I<_.length;I++){var P=A(_[I].pointNumber);if(P)if(P.group){for(var S=0;S<P.childrenNodes.length;S++)L.push(P.childrenNodes[S].pointNumber);k[P.pointNumber-T.node._count]=!1}else L.push(P.pointNumber)}b=k.filter(Boolean).concat([L]),r.call("_guiRestyle",u,{"node.groups":[b]},s)},prepFn:function(_,b,T){n(_,b,T,f,o)}};t.init(f)}}W.name="sankey",W.baseLayoutAttrOverrides=d({hoverlabel:y.hoverlabel},"plot","nested"),W.plot=function(u){var s=v(u.calcdata,"sankey")[0];w(u,s),W.updateFx(u)},W.clean=function(u,s,h,l){var o=l._has&&l._has("sankey"),p=s._has&&s._has("sankey");o&&!p&&(l._paperdiv.selectAll(".sankey").remove(),l._paperdiv.selectAll(".bgsankey").remove())},W.updateFx=function(u){for(var s=0;s<u._fullData.length;s++)g(u,s)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(m,G,W){var d=m("strongly-connected-components"),v=m("../../lib"),w=m("../../lib/gup").wrap,y=v.isArrayOrTypedArray,e=v.isIndex,t=m("../../components/colorscale");function n(a){var r,g=a.node,u=a.link,s=[],h=y(u.color),l=y(u.customdata),o={},p={},c=u.colorscales.length;for(r=0;r<c;r++){var i=u.colorscales[r],x=t.extractScale(i,{cLetter:"c"}),f=t.makeColorScaleFunc(x);p[i.label]=f}var _=0;for(r=0;r<u.value.length;r++)u.source[r]>_&&(_=u.source[r]),u.target[r]>_&&(_=u.target[r]);var b,T=_+1;a.node._count=T;var k=a.node.groups,L={};for(r=0;r<k.length;r++){var A=k[r];for(b=0;b<A.length;b++){var I=A[b],P=T+r;L.hasOwnProperty(I)?v.warn("Node "+I+" is already part of a group."):L[I]=P}}var S={source:[],target:[]};for(r=0;r<u.value.length;r++){var E=u.value[r],z=u.source[r],D=u.target[r];if(E>0&&e(z,T)&&e(D,T)&&(!L.hasOwnProperty(z)||!L.hasOwnProperty(D)||L[z]!==L[D])){L.hasOwnProperty(D)&&(D=L[D]),L.hasOwnProperty(z)&&(z=L[z]),D=+D,o[z=+z]=o[D]=!0;var j="";u.label&&u.label[r]&&(j=u.label[r]);var V=null;j&&p.hasOwnProperty(j)&&(V=p[j]),s.push({pointNumber:r,label:j,color:h?u.color[r]:u.color,customdata:l?u.customdata[r]:u.customdata,concentrationscale:V,source:z,target:D,value:+E}),S.source.push(z),S.target.push(D)}}var Z=T+k.length,Q=y(g.color),K=y(g.customdata),$=[];for(r=0;r<Z;r++)if(o[r]){var ne=g.label[r];$.push({group:r>T-1,childrenNodes:[],pointNumber:r,label:ne,color:Q?g.color[r]:g.color,customdata:K?g.customdata[r]:g.customdata})}var H=!1;return function(N,U,te){for(var B=v.init2dArray(N,0),X=0;X<Math.min(U.length,te.length);X++)if(v.isIndex(U[X],N)&&v.isIndex(te[X],N)){if(U[X]===te[X])return!0;B[U[X]].push(te[X])}return d(B).components.some(function(J){return J.length>1})}(Z,S.source,S.target)&&(H=!0),{circular:H,links:s,nodes:$,groups:k,groupLookup:L}}G.exports=function(a,r){var g=n(r);return w({circular:g.circular,_nodes:g.nodes,_links:g.links,_groups:g.groups,_groupLookup:g.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(m,G,W){G.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("tinycolor2"),e=m("../../plots/domain").defaults,t=m("../../components/fx/hoverlabel_defaults"),n=m("../../plot_api/plot_template"),a=m("../../plots/array_container_defaults");function r(g,u){function s(h,l){return d.coerce(g,u,v.link.colorscales,h,l)}s("label"),s("cmin"),s("cmax"),s("colorscale")}G.exports=function(g,u,s,h){function l(L,A){return d.coerce(g,u,v,L,A)}var o=d.extendDeep(h.hoverlabel,g.hoverlabel),p=g.node,c=n.newContainer(u,"node");function i(L,A){return d.coerce(p,c,v.node,L,A)}i("label"),i("groups"),i("x"),i("y"),i("pad"),i("thickness"),i("line.color"),i("line.width"),i("hoverinfo",g.hoverinfo),t(p,c,i,o),i("hovertemplate");var x=h.colorway;i("color",c.label.map(function(L,A){return w.addOpacity(function(I){return x[I%x.length]}(A),.8)})),i("customdata");var f=g.link||{},_=n.newContainer(u,"link");function b(L,A){return d.coerce(f,_,v.link,L,A)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",g.hoverinfo),t(f,_,b,o),b("hovertemplate");var T,k=y(h.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",d.repeat(k,_.value.length)),b("customdata"),a(f,_,{name:"colorscales",handleItemDefaults:r}),e(u,h,l),l("orientation"),l("valueformat"),l("valuesuffix"),c.x.length&&c.y.length&&(T="freeform"),l("arrangement",T),d.coerceFont(l,"textfont",d.extendFlat({},h.font)),u._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),moduleType:"trace",name:"sankey",basePlotModule:m("./base_plot"),selectPoints:m("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("./render"),e=m("../../components/fx"),t=m("../../components/color"),n=m("./constants").cn,a=v._;function r(f){return f!==""}function g(f,_){return f.filter(function(b){return b.key===_.traceId})}function u(f,_){d.select(f).select("path").style("fill-opacity",_),d.select(f).select("rect").style("fill-opacity",_)}function s(f){d.select(f).select("text.name").style("fill","black")}function h(f){return function(_){return f.node.sourceLinks.indexOf(_.link)!==-1||f.node.targetLinks.indexOf(_.link)!==-1}}function l(f){return function(_){return _.node.sourceLinks.indexOf(f.link)!==-1||_.node.targetLinks.indexOf(f.link)!==-1}}function o(f,_,b){_&&b&&g(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(c.bind(0,_,b,!1))}function p(f,_,b){_&&b&&g(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(i.bind(0,_,b,!1))}function c(f,_,b,T){var k=T.datum().link.label;T.style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),k&&g(_,f).selectAll("."+n.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),b&&g(_,f).selectAll("."+n.sankeyNode).filter(l(f)).call(o)}function i(f,_,b,T){var k=T.datum().link.label;T.style("fill-opacity",function(L){return L.tinyColorAlpha}),k&&g(_,f).selectAll("."+n.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){return L.tinyColorAlpha}),b&&g(_,f).selectAll(n.sankeyNode).filter(l(f)).call(p)}function x(f,_){var b=f.hoverlabel||{},T=v.nestedProperty(b,_).get();return!Array.isArray(T)&&T}G.exports=function(f,_){for(var b=f._fullLayout,T=b._paper,k=b._size,L=0;L<f._fullData.length;L++)if(f._fullData[L].visible&&f._fullData[L].type===n.sankey&&!f._fullData[L]._viewInitial){var A=f._fullData[L].node;f._fullData[L]._viewInitial={node:{groups:A.groups.slice(),x:A.x.slice(),y:A.y.slice()}}}var I=a(f,"source:")+" ",P=a(f,"target:")+" ",S=a(f,"concentration:")+" ",E=a(f,"incoming flow count:")+" ",z=a(f,"outgoing flow count:")+" ";y(f,T,_,{width:k.w,height:k.h,margin:{t:k.t,r:k.r,b:k.b,l:k.l}},{linkEvents:{hover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(c.bind(0,j,V,!0)),j.link.trace.link.hoverinfo!=="skip"&&(j.link.fullData=j.link.trace,f.emit("plotly_hover",{event:d.event,points:[j.link]})))},follow:function(D,j){if(f._fullLayout.hovermode!==!1){var V=j.link.trace.link;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){for(var Z=[],Q=0,K=0;K<j.flow.links.length;K++){var $=j.flow.links[K];if(f._fullLayout.hovermode!=="closest"||j.link.pointNumber===$.pointNumber){j.link.pointNumber===$.pointNumber&&(Q=K),$.fullData=$.trace,V=j.link.trace.link;var ne=N($),H={valueLabel:w(j.valueFormat)($.value)+j.valueSuffix};Z.push({x:ne[0],y:ne[1],name:H.valueLabel,text:[$.label||"",I+$.source.label,P+$.target.label,$.concentrationscale?S+w("%0.2f")($.flow.labelConcentration):""].filter(r).join("<br>"),color:x(V,"bgcolor")||t.addOpacity($.color,1),borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:d.event.x<ne[0]?"right":"left",hovertemplate:V.hovertemplate,hovertemplateLabels:H,eventData:[$]})}}e.loneHover(Z,{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:f,anchorIndex:Q}).each(function(){j.link.concentrationscale||u(this,.65),s(this)})}}function N(U){var te,B;U.circular?(te=(U.circularPathData.leftInnerExtent+U.circularPathData.rightInnerExtent)/2,B=U.circularPathData.verticalFullExtent):(te=(U.source.x1+U.target.x0)/2,B=(U.y0+U.y1)/2);var X=[te,B];return U.trace.orientation==="v"&&X.reverse(),X[0]+=j.parent.translateX,X[1]+=j.parent.translateY,X}},unhover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(i.bind(0,j,V,!0)),j.link.trace.link.hoverinfo!=="skip"&&(j.link.fullData=j.link.trace,f.emit("plotly_unhover",{event:d.event,points:[j.link]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j){var V=j.link;V.originalEvent=d.event,f._hoverdata=[V],e.click(f,{target:!0})}},nodeEvents:{hover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(o,j,V),j.node.trace.node.hoverinfo!=="skip"&&(j.node.fullData=j.node.trace,f.emit("plotly_hover",{event:d.event,points:[j.node]})))},follow:function(D,j){if(f._fullLayout.hovermode!==!1){var V=j.node.trace.node;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){var Z=d.select(D).select("."+n.nodeRect),Q=f._fullLayout._paperdiv.node().getBoundingClientRect(),K=Z.node().getBoundingClientRect(),$=K.left-2-Q.left,ne=K.right+2-Q.left,H=K.top+K.height/4-Q.top,N={valueLabel:w(j.valueFormat)(j.node.value)+j.valueSuffix};j.node.fullData=j.node.trace,f._fullLayout._calcInverseTransform(f);var U=f._fullLayout._invScaleX,te=f._fullLayout._invScaleY,B=e.loneHover({x0:U*$,x1:U*ne,y:te*H,name:w(j.valueFormat)(j.node.value)+j.valueSuffix,text:[j.node.label,E+j.node.targetLinks.length,z+j.node.sourceLinks.length].filter(r).join("<br>"),color:x(V,"bgcolor")||j.tinyColorHue,borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:"left",hovertemplate:V.hovertemplate,hovertemplateLabels:N,eventData:[j.node]},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:f});u(B,.85),s(B)}}},unhover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(p,j,V),j.node.trace.node.hoverinfo!=="skip"&&(j.node.fullData=j.node.trace,f.emit("plotly_unhover",{event:d.event,points:[j.node]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j,V){var Z=j.node;Z.originalEvent=d.event,f._hoverdata=[Z],d.select(D).call(p,j,V),e.click(f,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(m,G,W){var d=m("d3-force"),v=m("d3-interpolate").interpolateNumber,w=m("@plotly/d3"),y=m("@plotly/d3-sankey"),e=m("@plotly/d3-sankey-circular"),t=m("./constants"),n=m("tinycolor2"),a=m("../../components/color"),r=m("../../components/drawing"),g=m("../../lib"),u=g.strTranslate,s=g.strRotate,h=m("../../lib/gup"),l=h.keyFun,o=h.repeat,p=h.unwrap,c=m("../../lib/svg_text_utils"),i=m("../../registry"),x=m("../../constants/alignment"),f=x.CAP_SHIFT,_=x.LINE_SPACING;function b(K,$,ne){var H,N=p($),U=N.trace,te=U.domain,B=U.orientation==="h",X=U.node.pad,J=U.node.thickness,ee=K.width*(te.x[1]-te.x[0]),re=K.height*(te.y[1]-te.y[0]),se=N._nodes,oe=N._links,de=N.circular;(H=de?e.sankeyCircular().circularLinkGap(0):y.sankey()).iterations(t.sankeyIterations).size(B?[ee,re]:[re,ee]).nodeWidth(J).nodePadding(X).nodeId(function(Me){return Me.pointNumber}).nodes(se).links(oe);var ce,ve,Ae,fe=H();for(var me in H.nodePadding()<X&&g.warn("node.pad was reduced to ",H.nodePadding()," to fit within the figure."),N._groupLookup){var _e,le=parseInt(N._groupLookup[me]);for(ce=0;ce<fe.nodes.length;ce++)if(fe.nodes[ce].pointNumber===le){_e=fe.nodes[ce];break}if(_e){var ge={pointNumber:parseInt(me),x0:_e.x0,x1:_e.x1,y0:_e.y0,y1:_e.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};fe.nodes.unshift(ge),_e.childrenNodes.unshift(ge)}}if(function(){for(ce=0;ce<fe.nodes.length;ce++){var Me,ze,Oe=fe.nodes[ce],De={};for(ve=0;ve<Oe.targetLinks.length;ve++)Me=(ze=Oe.targetLinks[ve]).source.pointNumber+":"+ze.target.pointNumber,De.hasOwnProperty(Me)||(De[Me]=[]),De[Me].push(ze);var Xe=Object.keys(De);for(ve=0;ve<Xe.length;ve++){var Be=De[Me=Xe[ve]],Ie=0,Re={};for(Ae=0;Ae<Be.length;Ae++)Re[(ze=Be[Ae]).label]||(Re[ze.label]=0),Re[ze.label]+=ze.value,Ie+=ze.value;for(Ae=0;Ae<Be.length;Ae++)(ze=Be[Ae]).flow={value:Ie,labelConcentration:Re[ze.label]/Ie,concentration:ze.value/Ie,links:Be},ze.concentrationscale&&(ze.color=n(ze.concentrationscale(ze.flow.labelConcentration)))}var Ye=0;for(ve=0;ve<Oe.sourceLinks.length;ve++)Ye+=Oe.sourceLinks[ve].value;for(ve=0;ve<Oe.sourceLinks.length;ve++)(ze=Oe.sourceLinks[ve]).concentrationOut=ze.value/Ye;var Qe=0;for(ve=0;ve<Oe.targetLinks.length;ve++)Qe+=Oe.targetLinks[ve].value;for(ve=0;ve<Oe.targetLinks.length;ve++)(ze=Oe.targetLinks[ve]).concenrationIn=ze.value/Qe}}(),U.node.x.length&&U.node.y.length){for(ce=0;ce<Math.min(U.node.x.length,U.node.y.length,fe.nodes.length);ce++)if(U.node.x[ce]&&U.node.y[ce]){var Te=[U.node.x[ce]*ee,U.node.y[ce]*re];fe.nodes[ce].x0=Te[0]-J/2,fe.nodes[ce].x1=Te[0]+J/2;var Se=fe.nodes[ce].y1-fe.nodes[ce].y0;fe.nodes[ce].y0=Te[1]-Se/2,fe.nodes[ce].y1=Te[1]+Se/2}U.arrangement==="snap"&&function(Me){Me.forEach(function(ze){var Oe,De,Xe,Be=0,Ie=ze.length;for(ze.sort(function(Re,Ye){return Re.y0-Ye.y0}),Xe=0;Xe<Ie;++Xe)(Oe=ze[Xe]).y0>=Be||(De=Be-Oe.y0)>1e-6&&(Oe.y0+=De,Oe.y1+=De),Be=Oe.y1+X})}(function(Me){var ze,Oe,De=Me.map(function(Ye,Qe){return{x0:Ye.x0,index:Qe}}).sort(function(Ye,Qe){return Ye.x0-Qe.x0}),Xe=[],Be=-1,Ie=-1/0;for(ce=0;ce<De.length;ce++){var Re=Me[De[ce].index];Re.x0>Ie+J&&(Be+=1,ze=Re.x0),Ie=Re.x0,Xe[Be]||(Xe[Be]=[]),Xe[Be].push(Re),Oe=ze-Re.x0,Re.x0+=Oe,Re.x1+=Oe}return Xe}(se=fe.nodes)),H.update(fe)}return{circular:de,key:ne,trace:U,guid:g.randstr(),horizontal:B,width:ee,height:re,nodePad:U.node.pad,nodeLineColor:U.node.line.color,nodeLineWidth:U.node.line.width,linkLineColor:U.link.line.color,linkLineWidth:U.link.line.width,linkArrowLength:U.link.arrowlen,valueFormat:U.valueformat,valueSuffix:U.valuesuffix,textFont:U.textfont,translateX:te.x[0]*K.width+K.margin.l,translateY:K.height-te.y[1]*K.height+K.margin.t,dragParallel:B?re:ee,dragPerpendicular:B?ee:re,arrangement:U.arrangement,sankey:H,graph:fe,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function T(K,$,ne){var H=n($.color),N=$.source.label+"|"+$.target.label+"__"+ne;return $.trace=K.trace,$.curveNumber=K.trace.index,{circular:K.circular,key:N,traceId:K.key,pointNumber:$.pointNumber,link:$,tinyColorHue:a.tinyRGB(H),tinyColorAlpha:H.getAlpha(),linkPath:k,linkLineColor:K.linkLineColor,linkLineWidth:K.linkLineWidth,linkArrowLength:K.linkArrowLength,valueFormat:K.valueFormat,valueSuffix:K.valueSuffix,sankey:K.sankey,parent:K,interactionState:K.interactionState,flow:$.flow}}function k(){return function(K){var $=K.linkArrowLength;if(K.link.circular)return function(ve,Ae){var fe=ve.width/2,me=ve.circularPathData;return ve.circularLinkType==="top"?"M "+(me.targetX-Ae)+" "+(me.targetY+fe)+" L"+(me.rightInnerExtent-Ae)+" "+(me.targetY+fe)+"A"+(me.rightLargeArcRadius+fe)+" "+(me.rightSmallArcRadius+fe)+" 0 0 1 "+(me.rightFullExtent-fe-Ae)+" "+(me.targetY-me.rightSmallArcRadius)+"L"+(me.rightFullExtent-fe-Ae)+" "+me.verticalRightInnerExtent+"A"+(me.rightLargeArcRadius+fe)+" "+(me.rightLargeArcRadius+fe)+" 0 0 1 "+(me.rightInnerExtent-Ae)+" "+(me.verticalFullExtent-fe)+"L"+me.leftInnerExtent+" "+(me.verticalFullExtent-fe)+"A"+(me.leftLargeArcRadius+fe)+" "+(me.leftLargeArcRadius+fe)+" 0 0 1 "+(me.leftFullExtent+fe)+" "+me.verticalLeftInnerExtent+"L"+(me.leftFullExtent+fe)+" "+(me.sourceY-me.leftSmallArcRadius)+"A"+(me.leftLargeArcRadius+fe)+" "+(me.leftSmallArcRadius+fe)+" 0 0 1 "+me.leftInnerExtent+" "+(me.sourceY+fe)+"L"+me.sourceX+" "+(me.sourceY+fe)+"L"+me.sourceX+" "+(me.sourceY-fe)+"L"+me.leftInnerExtent+" "+(me.sourceY-fe)+"A"+(me.leftLargeArcRadius-fe)+" "+(me.leftSmallArcRadius-fe)+" 0 0 0 "+(me.leftFullExtent-fe)+" "+(me.sourceY-me.leftSmallArcRadius)+"L"+(me.leftFullExtent-fe)+" "+me.verticalLeftInnerExtent+"A"+(me.leftLargeArcRadius-fe)+" "+(me.leftLargeArcRadius-fe)+" 0 0 0 "+me.leftInnerExtent+" "+(me.verticalFullExtent+fe)+"L"+(me.rightInnerExtent-Ae)+" "+(me.verticalFullExtent+fe)+"A"+(me.rightLargeArcRadius-fe)+" "+(me.rightLargeArcRadius-fe)+" 0 0 0 "+(me.rightFullExtent+fe-Ae)+" "+me.verticalRightInnerExtent+"L"+(me.rightFullExtent+fe-Ae)+" "+(me.targetY-me.rightSmallArcRadius)+"A"+(me.rightLargeArcRadius-fe)+" "+(me.rightSmallArcRadius-fe)+" 0 0 0 "+(me.rightInnerExtent-Ae)+" "+(me.targetY-fe)+"L"+(me.targetX-Ae)+" "+(me.targetY-fe)+(Ae>0?"L"+me.targetX+" "+me.targetY:"")+"Z":"M "+(me.targetX-Ae)+" "+(me.targetY-fe)+" L"+(me.rightInnerExtent-Ae)+" "+(me.targetY-fe)+"A"+(me.rightLargeArcRadius+fe)+" "+(me.rightSmallArcRadius+fe)+" 0 0 0 "+(me.rightFullExtent-fe-Ae)+" "+(me.targetY+me.rightSmallArcRadius)+"L"+(me.rightFullExtent-fe-Ae)+" "+me.verticalRightInnerExtent+"A"+(me.rightLargeArcRadius+fe)+" "+(me.rightLargeArcRadius+fe)+" 0 0 0 "+(me.rightInnerExtent-Ae)+" "+(me.verticalFullExtent+fe)+"L"+me.leftInnerExtent+" "+(me.verticalFullExtent+fe)+"A"+(me.leftLargeArcRadius+fe)+" "+(me.leftLargeArcRadius+fe)+" 0 0 0 "+(me.leftFullExtent+fe)+" "+me.verticalLeftInnerExtent+"L"+(me.leftFullExtent+fe)+" "+(me.sourceY+me.leftSmallArcRadius)+"A"+(me.leftLargeArcRadius+fe)+" "+(me.leftSmallArcRadius+fe)+" 0 0 0 "+me.leftInnerExtent+" "+(me.sourceY-fe)+"L"+me.sourceX+" "+(me.sourceY-fe)+"L"+me.sourceX+" "+(me.sourceY+fe)+"L"+me.leftInnerExtent+" "+(me.sourceY+fe)+"A"+(me.leftLargeArcRadius-fe)+" "+(me.leftSmallArcRadius-fe)+" 0 0 1 "+(me.leftFullExtent-fe)+" "+(me.sourceY+me.leftSmallArcRadius)+"L"+(me.leftFullExtent-fe)+" "+me.verticalLeftInnerExtent+"A"+(me.leftLargeArcRadius-fe)+" "+(me.leftLargeArcRadius-fe)+" 0 0 1 "+me.leftInnerExtent+" "+(me.verticalFullExtent-fe)+"L"+(me.rightInnerExtent-Ae)+" "+(me.verticalFullExtent-fe)+"A"+(me.rightLargeArcRadius-fe)+" "+(me.rightLargeArcRadius-fe)+" 0 0 1 "+(me.rightFullExtent+fe-Ae)+" "+me.verticalRightInnerExtent+"L"+(me.rightFullExtent+fe-Ae)+" "+(me.targetY+me.rightSmallArcRadius)+"A"+(me.rightLargeArcRadius-fe)+" "+(me.rightSmallArcRadius-fe)+" 0 0 1 "+(me.rightInnerExtent-Ae)+" "+(me.targetY+fe)+"L"+(me.targetX-Ae)+" "+(me.targetY+fe)+(Ae>0?"L"+me.targetX+" "+me.targetY:"")+"Z"}(K.link,$);var ne=Math.abs((K.link.target.x0-K.link.source.x1)/2);$>ne&&($=ne);var H=K.link.source.x1,N=K.link.target.x0-$,U=v(H,N),te=U(.5),B=U(.5),X=K.link.y0-K.link.width/2,J=K.link.y0+K.link.width/2,ee=K.link.y1-K.link.width/2,re=K.link.y1+K.link.width/2,se="M"+H+","+X,oe="C"+te+","+X+" "+B+","+ee+" "+N+","+ee,de="C"+B+","+re+" "+te+","+J+" "+H+","+J,ce=$>0?"L"+(N+$)+","+(ee+K.link.width/2):"";return se+oe+(ce+="L"+N+","+re)+de+"Z"}}function L(K,$){var ne=n($.color),H=t.nodePadAcross,N=K.nodePad/2;$.dx=$.x1-$.x0,$.dy=$.y1-$.y0;var U=$.dx,te=Math.max(.5,$.dy),B="node_"+$.pointNumber;return $.group&&(B=g.randstr()),$.trace=K.trace,$.curveNumber=K.trace.index,{index:$.pointNumber,key:B,partOfGroup:$.partOfGroup||!1,group:$.group,traceId:K.key,trace:K.trace,node:$,nodePad:K.nodePad,nodeLineColor:K.nodeLineColor,nodeLineWidth:K.nodeLineWidth,textFont:K.textFont,size:K.horizontal?K.height:K.width,visibleWidth:Math.ceil(U),visibleHeight:te,zoneX:-H,zoneY:-N,zoneWidth:U+2*H,zoneHeight:te+2*N,labelY:K.horizontal?$.dy/2+1:$.dx/2+1,left:$.originalLayer===1,sizeAcross:K.width,forceLayouts:K.forceLayouts,horizontal:K.horizontal,darkBackground:ne.getBrightness()<=128,tinyColorHue:a.tinyRGB(ne),tinyColorAlpha:ne.getAlpha(),valueFormat:K.valueFormat,valueSuffix:K.valueSuffix,sankey:K.sankey,graph:K.graph,arrangement:K.arrangement,uniqueNodeLabelPathId:[K.guid,K.key,B].join("_"),interactionState:K.interactionState,figure:K}}function A(K){K.attr("transform",function($){return u($.node.x0.toFixed(3),$.node.y0.toFixed(3))})}function I(K){K.call(A)}function P(K,$){K.call(I),$.attr("d",k())}function S(K){K.attr("width",function($){return $.node.x1-$.node.x0}).attr("height",function($){return $.visibleHeight})}function E(K){return K.link.width>1||K.linkLineWidth>0}function z(K){return u(K.translateX,K.translateY)+(K.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function D(K,$,ne){K.on(".basic",null).on("mouseover.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(ne.hover(this,H,$),H.interactionState.hovered=[this,H])}).on("mousemove.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(ne.follow(this,H),H.interactionState.hovered=[this,H])}).on("mouseout.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(ne.unhover(this,H,$),H.interactionState.hovered=!1)}).on("click.basic",function(H){H.interactionState.hovered&&(ne.unhover(this,H,$),H.interactionState.hovered=!1),H.interactionState.dragInProgress||H.partOfGroup||ne.select(this,H,$)})}function j(K,$,ne,H){var N=w.behavior.drag().origin(function(U){return{x:U.node.x0+U.visibleWidth/2,y:U.node.y0+U.visibleHeight/2}}).on("dragstart",function(U){if(U.arrangement!=="fixed"&&(g.ensureSingle(H._fullLayout._infolayer,"g","dragcover",function(B){H._fullLayout._dragCover=B}),g.raiseToTop(this),U.interactionState.dragInProgress=U.node,Z(U.node),U.interactionState.hovered&&(ne.nodeEvents.unhover.apply(0,U.interactionState.hovered),U.interactionState.hovered=!1),U.arrangement==="snap")){var te=U.traceId+"|"+U.key;U.forceLayouts[te]?U.forceLayouts[te].alpha(1):function(B,X,J,ee){(function(se){for(var oe=0;oe<se.length;oe++)se[oe].y=(se[oe].y0+se[oe].y1)/2,se[oe].x=(se[oe].x0+se[oe].x1)/2})(J.graph.nodes);var re=J.graph.nodes.filter(function(se){return se.originalX===J.node.originalX}).filter(function(se){return!se.partOfGroup});J.forceLayouts[X]=d.forceSimulation(re).alphaDecay(0).force("collide",d.forceCollide().radius(function(se){return se.dy/2+J.nodePad/2}).strength(1).iterations(t.forceIterations)).force("constrain",function(se,oe,de,ce){return function(){for(var ve=0,Ae=0;Ae<de.length;Ae++){var fe=de[Ae];fe===ce.interactionState.dragInProgress?(fe.x=fe.lastDraggedX,fe.y=fe.lastDraggedY):(fe.vx=(fe.originalX-fe.x)/t.forceTicksPerFrame,fe.y=Math.min(ce.size-fe.dy/2,Math.max(fe.dy/2,fe.y))),ve=Math.max(ve,Math.abs(fe.vx),Math.abs(fe.vy))}!ce.interactionState.dragInProgress&&ve<.1&&ce.forceLayouts[oe].alpha()>0&&ce.forceLayouts[oe].alpha(0)}}(0,X,re,J)).stop()}(0,te,U),function(B,X,J,ee,re){window.requestAnimationFrame(function se(){var oe;for(oe=0;oe<t.forceTicksPerFrame;oe++)J.forceLayouts[ee].tick();if(function(ce){for(var ve=0;ve<ce.length;ve++)ce[ve].y0=ce[ve].y-ce[ve].dy/2,ce[ve].y1=ce[ve].y0+ce[ve].dy,ce[ve].x0=ce[ve].x-ce[ve].dx/2,ce[ve].x1=ce[ve].x0+ce[ve].dx}(J.graph.nodes),J.sankey.update(J.graph),P(B.filter(Q(J)),X),J.forceLayouts[ee].alpha()>0)window.requestAnimationFrame(se);else{var de=J.node.originalX;J.node.x0=de-J.visibleWidth/2,J.node.x1=de+J.visibleWidth/2,V(J,re)}})}(K,$,U,te,H)}}).on("drag",function(U){if(U.arrangement!=="fixed"){var te=w.event.x,B=w.event.y;U.arrangement==="snap"?(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2,U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2):(U.arrangement==="freeform"&&(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2),B=Math.max(0,Math.min(U.size-U.visibleHeight/2,B)),U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2),Z(U.node),U.arrangement!=="snap"&&(U.sankey.update(U.graph),P(K.filter(Q(U)),$))}}).on("dragend",function(U){if(U.arrangement!=="fixed"){U.interactionState.dragInProgress=!1;for(var te=0;te<U.node.childrenNodes.length;te++)U.node.childrenNodes[te].x=U.node.x,U.node.childrenNodes[te].y=U.node.y;U.arrangement!=="snap"&&V(U,H)}});K.on(".drag",null).call(N)}function V(K,$){for(var ne=[],H=[],N=0;N<K.graph.nodes.length;N++){var U=(K.graph.nodes[N].x0+K.graph.nodes[N].x1)/2,te=(K.graph.nodes[N].y0+K.graph.nodes[N].y1)/2;ne.push(U/K.figure.width),H.push(te/K.figure.height)}i.call("_guiRestyle",$,{"node.x":[ne],"node.y":[H]},K.trace.index).then(function(){$._fullLayout._dragCover&&$._fullLayout._dragCover.remove()})}function Z(K){K.lastDraggedX=K.x0+K.dx/2,K.lastDraggedY=K.y0+K.dy/2}function Q(K){return function($){return $.node.originalX===K.node.originalX}}G.exports=function(K,$,ne,H,N){var U=K._context.staticPlot,te=!1;g.ensureSingle(K._fullLayout._infolayer,"g","first-render",function(){te=!0});var B=K._fullLayout._dragCover,X=ne.filter(function(ve){return p(ve).trace.visible}).map(b.bind(null,H)),J=$.selectAll("."+t.cn.sankey).data(X,l);J.exit().remove(),J.enter().append("g").classed(t.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",U?"none":"auto").attr("transform",z),J.each(function(ve,Ae){K._fullData[Ae]._sankey=ve;var fe="bgsankey-"+ve.trace.uid+"-"+Ae;g.ensureSingle(K._fullLayout._draggers,"rect",fe),K._fullData[Ae]._bgRect=w.select("."+fe),K._fullData[Ae]._bgRect.style("pointer-events",U?"none":"all").attr("width",ve.width).attr("height",ve.height).attr("x",ve.translateX).attr("y",ve.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),J.transition().ease(t.ease).duration(t.duration).attr("transform",z);var ee=J.selectAll("."+t.cn.sankeyLinks).data(o,l);ee.enter().append("g").classed(t.cn.sankeyLinks,!0).style("fill","none");var re=ee.selectAll("."+t.cn.sankeyLink).data(function(ve){return ve.graph.links.filter(function(Ae){return Ae.value}).map(T.bind(null,ve))},l);re.enter().append("path").classed(t.cn.sankeyLink,!0).call(D,J,N.linkEvents),re.style("stroke",function(ve){return E(ve)?a.tinyRGB(n(ve.linkLineColor)):ve.tinyColorHue}).style("stroke-opacity",function(ve){return E(ve)?a.opacity(ve.linkLineColor):ve.tinyColorAlpha}).style("fill",function(ve){return ve.tinyColorHue}).style("fill-opacity",function(ve){return ve.tinyColorAlpha}).style("stroke-width",function(ve){return E(ve)?ve.linkLineWidth:1}).attr("d",k()),re.style("opacity",function(){return K._context.staticPlot||te||B?1:0}).transition().ease(t.ease).duration(t.duration).style("opacity",1),re.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var se=J.selectAll("."+t.cn.sankeyNodeSet).data(o,l);se.enter().append("g").classed(t.cn.sankeyNodeSet,!0),se.style("cursor",function(ve){switch(ve.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var oe=se.selectAll("."+t.cn.sankeyNode).data(function(ve){var Ae=ve.graph.nodes;return function(fe){var me,_e=[];for(me=0;me<fe.length;me++)fe[me].originalX=(fe[me].x0+fe[me].x1)/2,fe[me].originalY=(fe[me].y0+fe[me].y1)/2,_e.indexOf(fe[me].originalX)===-1&&_e.push(fe[me].originalX);for(_e.sort(function(le,ge){return le-ge}),me=0;me<fe.length;me++)fe[me].originalLayerIndex=_e.indexOf(fe[me].originalX),fe[me].originalLayer=fe[me].originalLayerIndex/(_e.length-1)}(Ae),Ae.map(L.bind(null,ve))},l);oe.enter().append("g").classed(t.cn.sankeyNode,!0).call(A).style("opacity",function(ve){return!K._context.staticPlot&&!te||ve.partOfGroup?0:1}),oe.call(D,J,N.nodeEvents).call(j,re,N,K),oe.transition().ease(t.ease).duration(t.duration).call(A).style("opacity",function(ve){return ve.partOfGroup?0:1}),oe.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var de=oe.selectAll("."+t.cn.nodeRect).data(o);de.enter().append("rect").classed(t.cn.nodeRect,!0).call(S),de.style("stroke-width",function(ve){return ve.nodeLineWidth}).style("stroke",function(ve){return a.tinyRGB(n(ve.nodeLineColor))}).style("stroke-opacity",function(ve){return a.opacity(ve.nodeLineColor)}).style("fill",function(ve){return ve.tinyColorHue}).style("fill-opacity",function(ve){return ve.tinyColorAlpha}),de.transition().ease(t.ease).duration(t.duration).call(S);var ce=oe.selectAll("."+t.cn.nodeLabel).data(o);ce.enter().append("text").classed(t.cn.nodeLabel,!0).style("cursor","default"),ce.attr("data-notex",1).text(function(ve){return ve.node.label}).each(function(ve){var Ae=w.select(this);r.font(Ae,ve.textFont),c.convertToTspans(Ae,K)}).style("text-shadow",c.makeTextShadow(K._fullLayout.paper_bgcolor)).attr("text-anchor",function(ve){return ve.horizontal&&ve.left?"end":"start"}).attr("transform",function(ve){var Ae=w.select(this),fe=c.lineCount(Ae),me=ve.textFont.size*((fe-1)*_-f),_e=ve.nodeLineWidth/2+3,le=((ve.horizontal?ve.visibleHeight:ve.visibleWidth)-me)/2;ve.horizontal&&(ve.left?_e=-_e:_e+=ve.visibleWidth);var ge=ve.horizontal?"":"scale(-1,1)"+s(90);return u(ve.horizontal?_e:le,ve.horizontal?le:_e)+ge}),ce.transition().ease(t.ease).duration(t.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(m,G,W){G.exports=function(d,v){for(var w=[],y=d.cd[0].trace,e=y._sankey.graph.nodes,t=0;t<e.length;t++){var n=e[t];if(!n.partOfGroup){var a=[(n.x0+n.x1)/2,(n.y0+n.y1)/2];y.orientation==="v"&&a.reverse(),v&&v.contains(a,!1,t,d)&&w.push({pointNumber:n.pointNumber})}}return w}},{}],935:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.texttemplate,v,"txt"),d.mergeArray(w.hovertext,v,"htx"),d.mergeArray(w.customdata,v,"data"),d.mergeArray(w.textposition,v,"tp"),w.textfont&&(d.mergeArrayCastPositive(w.textfont.size,v,"ts"),d.mergeArray(w.textfont.color,v,"tc"),d.mergeArray(w.textfont.family,v,"tf"));var e=w.marker;if(e){d.mergeArrayCastPositive(e.size,v,"ms"),d.mergeArrayCastPositive(e.opacity,v,"mo"),d.mergeArray(e.symbol,v,"mx"),d.mergeArray(e.angle,v,"ma"),d.mergeArray(e.standoff,v,"mf"),d.mergeArray(e.color,v,"mc");var t=e.line;e.line&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"));var n=e.gradient;n&&n.type!=="none"&&(d.mergeArray(n.type,v,"mgt"),d.mergeArray(n.color,v,"mgc"))}}},{"../../lib":515}],936:[function(m,G,W){var d=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../components/colorscale/attributes"),e=m("../../plots/font_attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../components/drawing/attributes").pattern,a=m("../../components/drawing"),r=m("./constants"),g=m("../../lib/extend").extendFlat;G.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:d("x"),yhoverformat:d("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:v({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:w({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:g({},t,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:g({symbol:{valType:"enumerated",values:a.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:g({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},y("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},y("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../../constants/numerical").BADNUM,t=m("./subtypes"),n=m("./colorscale_calc"),a=m("./arrays_to_calcdata"),r=m("./calc_selection");function g(o,p,c,i,x,f,_){var b=p._length,T=o._fullLayout,k=c._id,L=i._id,A=T._firstScatter[h(p)]===p.uid,I=(l(p,T,c,i)||{}).orientation,P=p.fill;c._minDtick=0,i._minDtick=0;var S={padded:!0},E={padded:!0};_&&(S.ppad=E.ppad=_);var z=b<2||x[0]!==x[b-1]||f[0]!==f[b-1];z&&(P==="tozerox"||P==="tonextx"&&(A||I==="h"))?S.tozero=!0:(p.error_y||{}).visible||P!=="tonexty"&&P!=="tozeroy"&&(t.hasMarkers(p)||t.hasText(p))||(S.padded=!1,S.ppad=0),z&&(P==="tozeroy"||P==="tonexty"&&(A||I==="v"))?E.tozero=!0:P!=="tonextx"&&P!=="tozerox"||(E.padded=!1),k&&(p._extremes[k]=w.findExtremes(c,x,S)),L&&(p._extremes[L]=w.findExtremes(i,f,E))}function u(o,p){if(t.hasMarkers(o)){var c,i=o.marker,x=1.6*(o.marker.sizeref||1);if(c=o.marker.sizemode==="area"?function(k){return Math.max(Math.sqrt((k||0)/x),3)}:function(k){return Math.max((k||0)/x,3)},v.isArrayOrTypedArray(i.size)){var f={type:"linear"};w.setConvert(f);for(var _=f.makeCalcdata(o.marker,"size"),b=new Array(p),T=0;T<p;T++)b[T]=c(_[T]);return b}return c(i.size)}}function s(o,p){var c=h(p),i=o._firstScatter;i[c]||(i[c]=p.uid)}function h(o){var p=o.stackgroup;return o.xaxis+o.yaxis+o.type+(p?"-"+p:"")}function l(o,p,c,i){var x=o.stackgroup;if(x){var f=p._scatterStackOpts[c._id+i._id][x],_=f.orientation==="v"?i:c;return _.type==="linear"||_.type==="log"?f:void 0}}G.exports={calc:function(o,p){var c,i,x,f,_,b,T=o._fullLayout,k=p._xA=w.getFromId(o,p.xaxis||"x","x"),L=p._yA=w.getFromId(o,p.yaxis||"y","y"),A=k.makeCalcdata(p,"x"),I=L.makeCalcdata(p,"y"),P=y(p,k,"x",A),S=y(p,L,"y",I),E=P.vals,z=S.vals,D=p._length,j=new Array(D),V=p.ids,Z=l(p,T,k,L),Q=!1;s(T,p);var K,$="x",ne="y";Z?(v.pushUnique(Z.traceIndices,p._expandedIndex),(c=Z.orientation==="v")?(ne="s",K="x"):($="s",K="y"),_=Z.stackgaps==="interpolate"):g(o,p,k,L,E,z,u(p,D));var H=!!p.xperiodalignment,N=!!p.yperiodalignment;for(i=0;i<D;i++){var U=j[i]={},te=d(E[i]),B=d(z[i]);te&&B?(U[$]=E[i],U[ne]=z[i],H&&(U.orig_x=A[i],U.xEnd=P.ends[i],U.xStart=P.starts[i]),N&&(U.orig_y=I[i],U.yEnd=S.ends[i],U.yStart=S.starts[i])):Z&&(c?te:B)?(U[K]=c?E[i]:z[i],U.gap=!0,_?(U.s=e,Q=!0):U.s=0):U[$]=U[ne]=e,V&&(U.id=String(V[i]))}if(a(j,p),n(o,p),r(j,p),Z){for(i=0;i<j.length;)j[i][K]===e?j.splice(i,1):i++;if(v.sort(j,function(re,se){return re[K]-se[K]||re.i-se.i}),Q){for(i=0;i<j.length-1&&j[i].gap;)i++;for((b=j[i].s)||(b=j[i].s=0),x=0;x<i;x++)j[x].s=b;for(f=j.length-1;f>i&&j[f].gap;)f--;for(b=j[f].s,x=j.length-1;x>f;x--)j[x].s=b;for(;i<f;)if(j[++i].gap){for(x=i+1;j[x].gap;)x++;for(var X=j[i-1][K],J=j[i-1].s,ee=(j[x].s-J)/(j[x][K]-X);i<x;)j[i].s=J+(j[i][K]-X)*ee,i++}}}return j},calcMarkerSize:u,calcAxisExpansion:g,setFirstScatter:s,getStackOpts:l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){d.isArrayOrTypedArray(w.selectedpoints)&&d.tagSelected(v,w)}},{"../../lib":515}],939:[function(m,G,W){var d=m("../../components/colorscale/helpers").hasColorscale,v=m("../../components/colorscale/calc"),w=m("./subtypes");G.exports=function(y,e){w.hasLines(e)&&d(e,"line")&&v(y,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),w.hasMarkers(e)&&(d(e,"marker")&&v(y,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),d(e,"marker.line")&&v(y,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(m,G,W){G.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(m,G,W){var d=m("./calc");function v(w,y,e,t,n,a,r){n[t]=!0;var g={i:null,gap:!0,s:0};if(g[r]=e,w.splice(y,0,g),y&&e===w[y-1][r]){var u=w[y-1];g.s=u.s,g.i=u.i,g.gap=u.gap}else a&&(g.s=function(s,h,l,o){var p=s[h-1],c=s[h+1];return c?p?p.s+(c.s-p.s)*(l-p[o])/(c[o]-p[o]):c.s:p.s}(w,y,e,r));y||(w[0].t=w[1].t,w[0].trace=w[1].trace,delete w[1].t,delete w[1].trace)}G.exports=function(w,y){var e=y.xaxis,t=y.yaxis,n=e._id+t._id,a=w._fullLayout._scatterStackOpts[n];if(a){var r,g,u,s,h,l,o,p,c,i,x,f,_,b,T,k=w.calcdata;for(var L in a){var A=(i=a[L]).traceIndices;if(A.length){for(x=i.stackgaps==="interpolate",f=i.groupnorm,i.orientation==="v"?(_="x",b="y"):(_="y",b="x"),T=new Array(A.length),r=0;r<T.length;r++)T[r]=!1;l=k[A[0]];var I=new Array(l.length);for(r=0;r<l.length;r++)I[r]=l[r][_];for(r=1;r<A.length;r++){for(h=k[A[r]],g=u=0;g<h.length;g++){for(o=h[g][_];o>I[u]&&u<I.length;u++)v(h,g,I[u],r,T,x,_),g++;if(o!==I[u]){for(s=0;s<r;s++)v(k[A[s]],u,o,s,T,x,_);I.splice(u,0,o)}u++}for(;u<I.length;u++)v(h,g,I[u],r,T,x,_),g++}var P=I.length;for(g=0;g<l.length;g++){for(p=l[g][b]=l[g].s,r=1;r<A.length;r++)(h=k[A[r]])[0].trace._rawLength=h[0].trace._length,h[0].trace._length=P,p+=h[g].s,h[g][b]=p;if(f)for(c=(f==="fraction"?p:p/100)||1,r=0;r<A.length;r++){var S=k[A[r]][g];S[b]/=c,S.sNorm=S.s/c}}for(r=0;r<A.length;r++){var E=(h=k[A[r]])[0].trace,z=d.calcMarkerSize(E,E._rawLength),D=Array.isArray(z);if(z&&T[r]||D){var j=z;for(z=new Array(P),g=0;g<P;g++)z[g]=h[g].gap?0:D?j[h[g].i]:j}var V=new Array(P),Z=new Array(P);for(g=0;g<P;g++)V[g]=h[g].x,Z[g]=h[g].y;d.calcAxisExpansion(w,E,e,t,V,Z,z),h[0].t.orientation=i.orientation}}}}}},{"./calc":937}],942:[function(m,G,W){G.exports=function(d){for(var v=0;v<d.length;v++){var w=d[v];if(w.type==="scatter"){var y=w.fill;if(y!=="none"&&y!=="toself"&&(w.opacity=void 0,y==="tonexty"||y==="tonextx"))for(var e=v-1;e>=0;e--){var t=d[e];if(t.type==="scatter"&&t.xaxis===w.xaxis&&t.yaxis===w.yaxis){t.opacity=void 0;break}}}}}},{}],943:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=m("./attributes"),y=m("./constants"),e=m("./subtypes"),t=m("./xy_defaults"),n=m("./period_defaults"),a=m("./stack_defaults"),r=m("./marker_defaults"),g=m("./line_defaults"),u=m("./line_shape_defaults"),s=m("./text_defaults"),h=m("./fillcolor_defaults"),l=m("../../lib").coercePattern;G.exports=function(o,p,c,i){function x(I,P){return d.coerce(o,p,w,I,P)}var f=t(o,p,i,x);if(f||(p.visible=!1),p.visible){n(o,p,i,x),x("xhoverformat"),x("yhoverformat");var _=a(o,p,i,x),b=!_&&f<y.PTS_LINESONLY?"lines+markers":"lines";x("text"),x("hovertext"),x("mode",b),e.hasLines(p)&&(g(o,p,c,i,x,{backoff:!0}),u(o,p,x),x("connectgaps"),x("line.simplify")),e.hasMarkers(p)&&r(o,p,c,i,x,{gradient:!0}),e.hasText(p)&&(x("texttemplate"),s(o,p,i,x));var T=[];(e.hasMarkers(p)||e.hasText(p))&&(x("cliponaxis"),x("marker.maxdisplayed"),T.push("points")),x("fill",_?_.fillDflt:"none"),p.fill!=="none"&&(h(o,p,c,x),e.hasLines(p)||u(o,p,x),l(x,"fillpattern",p.fillcolor,!1));var k=(p.line||{}).color,L=(p.marker||{}).color;p.fill!=="tonext"&&p.fill!=="toself"||T.push("fills"),x("hoveron",T.join("+")||"points"),p.hoveron!=="fills"&&x("hovertemplate");var A=v.getComponentMethod("errorbars","supplyDefaults");A(o,p,k||L||c,{axis:"y"}),A(o,p,k||L||c,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(p,x)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(m,G,W){var d=m("../../components/color"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t){var n=!1;if(y.marker){var a=y.marker.color,r=(y.marker.line||{}).color;a&&!v(a)?n=a:r&&!v(r)&&(n=r)}t("fillcolor",d.addOpacity((y.line||{}).color||n||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(m,G,W){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t={_fullLayout:y},n=d.getFromTrace(t,w,"x"),a=d.getFromTrace(t,w,"y");return e.xLabel=d.tickText(n,n.c2l(v.x),!0).text,e.yLabel=d.tickText(a,a.c2l(v.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(m,G,W){var d=m("../../components/color"),v=m("./subtypes");G.exports=function(w,y){var e,t;if(w.mode==="lines")return(e=w.line.color)&&d.opacity(e)?e:w.fillcolor;if(w.mode==="none")return w.fill?w.fillcolor:"";var n=y.mcc||(w.marker||{}).color,a=y.mlcc||((w.marker||{}).line||{}).color;return(t=n&&d.opacity(n)?n:a&&d.opacity(a)&&(y.mlw||((w.marker||{}).line||{}).width)?a:"")?d.opacity(t)<.3?d.addOpacity(t,.3):t:(e=(w.line||{}).color)&&d.opacity(e)&&v.hasLines(w)&&w.line.width?e:w.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(m,G,W){var d=m("../../lib"),v=m("../../components/fx"),w=m("../../registry"),y=m("./get_trace_color"),e=m("../../components/color"),t=d.fillText;G.exports=function(n,a,r,g){var u=n.cd,s=u[0].trace,h=n.xa,l=n.ya,o=h.c2p(a),p=l.c2p(r),c=[o,p],i=s.hoveron||"",x=s.mode.indexOf("markers")!==-1?3:.5,f=!!s.xperiodalignment,_=!!s.yperiodalignment;if(i.indexOf("points")!==-1){var b=function(oe){var de=Math.max(x,oe.mrc||0),ce=h.c2p(oe.x)-o,ve=l.c2p(oe.y)-p;return Math.max(Math.sqrt(ce*ce+ve*ve)-de,1-x/de)},T=v.getDistanceFunction(g,function(oe){if(f){var de=h.c2p(oe.xStart),ce=h.c2p(oe.xEnd);return o>=Math.min(de,ce)&&o<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,oe.mrc||0),Ae=1-1/ve,fe=Math.abs(h.c2p(oe.x)-o);return fe<ve?Ae*fe/ve:fe-ve+Ae},function(oe){if(_){var de=l.c2p(oe.yStart),ce=l.c2p(oe.yEnd);return p>=Math.min(de,ce)&&p<=Math.max(de,ce)?0:1/0}var ve=Math.max(3,oe.mrc||0),Ae=1-1/ve,fe=Math.abs(l.c2p(oe.y)-p);return fe<ve?Ae*fe/ve:fe-ve+Ae},b);if(v.getClosest(u,T,n),n.index!==!1){var k=u[n.index],L=h.c2p(k.x,!0),A=l.c2p(k.y,!0),I=k.mrc||1;n.index=k.i;var P=u[0].t.orientation,S=P&&(k.sNorm||k.s),E=P==="h"?S:k.orig_x!==void 0?k.orig_x:k.x,z=P==="v"?S:k.orig_y!==void 0?k.orig_y:k.y;return d.extendFlat(n,{color:y(s,k),x0:L-I,x1:L+I,xLabelVal:E,y0:A-I,y1:A+I,yLabelVal:z,spikeDistance:b(k),hovertemplate:s.hovertemplate}),t(k,s,n),w.getComponentMethod("errorbars","hoverInfo")(k,s,n),[n]}}if(i.indexOf("fills")!==-1&&s._polygons){var D,j,V,Z,Q,K,$,ne,H,N=s._polygons,U=[],te=!1,B=1/0,X=-1/0,J=1/0,ee=-1/0;for(D=0;D<N.length;D++)(V=N[D]).contains(c)&&(te=!te,U.push(V),J=Math.min(J,V.ymin),ee=Math.max(ee,V.ymax));if(te){var re=((J=Math.max(J,0))+(ee=Math.min(ee,l._length)))/2;for(D=0;D<U.length;D++)for(Z=U[D].pts,j=1;j<Z.length;j++)(ne=Z[j-1][1])>re!=(H=Z[j][1])>=re&&(K=Z[j-1][0],$=Z[j][0],H-ne&&(Q=K+($-K)*(re-ne)/(H-ne),B=Math.min(B,Q),X=Math.max(X,Q)));B=Math.max(B,0),X=Math.min(X,h._length);var se=e.defaultLine;return e.opacity(s.fillcolor)?se=s.fillcolor:e.opacity((s.line||{}).color)&&(se=s.line.color),d.extendFlat(n,{distance:n.maxHoverDistance,x0:B,x1:X,y0:re,y1:re,color:se,hovertemplate:!1}),delete n.index,s.text&&!Array.isArray(s.text)?n.text=String(s.text):n.text=s.name,[n]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(m,G,W){var d=m("./subtypes");G.exports={hasLines:d.hasLines,hasMarkers:d.hasMarkers,hasText:d.hasText,isBubble:d.isBubble,attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./cross_trace_calc"),arraysToCalcdata:m("./arrays_to_calcdata"),plot:m("./plot"),colorbar:m("./marker_colorbar"),formatLabels:m("./format_labels"),style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(m,G,W){var d=m("../../lib").isArrayOrTypedArray,v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults");G.exports=function(y,e,t,n,a,r){r||(r={});var g=(y.marker||{}).color;a("line.color",t),v(y,"line")?w(y,e,n,a,{prefix:"line.",cLetter:"c"}):a("line.color",!d(g)&&g||t),a("line.width"),r.noDash||a("line.dash"),r.backoff&&a("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(m,G,W){var d=m("../../components/drawing"),v=m("../../constants/numerical"),w=v.BADNUM,y=v.LOG_CLIP,e=y+.5,t=y-.5,n=m("../../lib"),a=n.segmentsIntersect,r=n.constrain,g=m("./constants");G.exports=function(u,s){var h,l,o,p,c,i,x,f,_,b,T,k,L,A,I,P,S,E,z=s.trace||{},D=s.xaxis,j=s.yaxis,V=D.type==="log",Z=j.type==="log",Q=D._length,K=j._length,$=s.backoff,ne=z.marker,H=s.connectGaps,N=s.baseTolerance,U=s.shape,te=U==="linear",B=z.fill&&z.fill!=="none",X=[],J=g.minTolerance,ee=u.length,re=new Array(ee),se=0;function oe(Dt){var Ne=u[Dt];if(!Ne)return!1;var qe=s.linearized?D.l2p(Ne.x):D.c2p(Ne.x),pe=s.linearized?j.l2p(Ne.y):j.c2p(Ne.y);if(qe===w){if(V&&(qe=D.c2p(Ne.x,!0)),qe===w)return!1;Z&&pe===w&&(qe*=Math.abs(D._m*K*(D._m>0?e:t)/(j._m*Q*(j._m>0?e:t)))),qe*=1e3}if(pe===w){if(Z&&(pe=j.c2p(Ne.y,!0)),pe===w)return!1;pe*=1e3}return[qe,pe]}function de(Dt,Ne,qe,pe){var be=qe-Dt,Fe=pe-Ne,Ve=.5-Dt,Ke=.5-Ne,Ge=be*be+Fe*Fe,ct=be*Ve+Fe*Ke;if(ct>0&&ct<Ge){var st=Ve*Fe-Ke*be;if(st*st<Ge)return!0}}function ce(Dt,Ne){var qe=Dt[0]/Q,pe=Dt[1]/K,be=Math.max(0,-qe,qe-1,-pe,pe-1);return be&&S!==void 0&&de(qe,pe,S,E)&&(be=0),be&&Ne&&de(qe,pe,Ne[0]/Q,Ne[1]/K)&&(be=0),(1+g.toleranceGrowth*be)*N}function ve(Dt,Ne){var qe=Dt[0]-Ne[0],pe=Dt[1]-Ne[1];return Math.sqrt(qe*qe+pe*pe)}var Ae,fe,me,_e,le,ge,Te,Se=g.maxScreensAway,Me=-Q*Se,ze=Q*(1+Se),Oe=-K*Se,De=K*(1+Se),Xe=[[Me,Oe,ze,Oe],[ze,Oe,ze,De],[ze,De,Me,De],[Me,De,Me,Oe]];function Be(Dt){if(Dt[0]<Me||Dt[0]>ze||Dt[1]<Oe||Dt[1]>De)return[r(Dt[0],Me,ze),r(Dt[1],Oe,De)]}function Ie(Dt,Ne){return Dt[0]===Ne[0]&&(Dt[0]===Me||Dt[0]===ze)||Dt[1]===Ne[1]&&(Dt[1]===Oe||Dt[1]===De)||void 0}function Re(Dt,Ne,qe){return function(pe,be){var Fe=Be(pe),Ve=Be(be),Ke=[];if(Fe&&Ve&&Ie(Fe,Ve))return Ke;Fe&&Ke.push(Fe),Ve&&Ke.push(Ve);var Ge=2*n.constrain((pe[Dt]+be[Dt])/2,Ne,qe)-((Fe||pe)[Dt]+(Ve||be)[Dt]);return Ge&&((Fe&&Ve?Ge>0==Fe[Dt]>Ve[Dt]?Fe:Ve:Fe||Ve)[Dt]+=Ge),Ke}}function Ye(Dt){var Ne=Dt[0],qe=Dt[1],pe=Ne===re[se-1][0],be=qe===re[se-1][1];if(!pe||!be)if(se>1){var Fe=Ne===re[se-2][0],Ve=qe===re[se-2][1];pe&&(Ne===Me||Ne===ze)&&Fe?Ve?se--:re[se-1]=Dt:be&&(qe===Oe||qe===De)&&Ve?Fe?se--:re[se-1]=Dt:re[se++]=Dt}else re[se++]=Dt}function Qe(Dt){re[se-1][0]!==Dt[0]&&re[se-1][1]!==Dt[1]&&Ye([me,_e]),Ye(Dt),le=null,me=_e=0}U==="linear"||U==="spline"?Te=function(Dt,Ne){for(var qe=[],pe=0,be=0;be<4;be++){var Fe=Xe[be],Ve=a(Dt[0],Dt[1],Ne[0],Ne[1],Fe[0],Fe[1],Fe[2],Fe[3]);Ve&&(!pe||Math.abs(Ve.x-qe[0][0])>1||Math.abs(Ve.y-qe[0][1])>1)&&(Ve=[Ve.x,Ve.y],pe&&ve(Ve,Dt)<ve(qe[0],Dt)?qe.unshift(Ve):qe.push(Ve),pe++)}return qe}:U==="hv"||U==="vh"?Te=function(Dt,Ne){var qe=[],pe=Be(Dt),be=Be(Ne);return pe&&be&&Ie(pe,be)||(pe&&qe.push(pe),be&&qe.push(be)),qe}:U==="hvh"?Te=Re(0,Me,ze):U==="vhv"&&(Te=Re(1,Oe,De));var lt=n.isArrayOrTypedArray(ne);function xt(Dt){if(Dt&&$&&(Dt.i=h,Dt.d=u,Dt.trace=z,Dt.marker=lt?ne[Dt.i]:ne,Dt.backoff=$),S=Dt[0]/Q,E=Dt[1]/K,Ae=Dt[0]<Me?Me:Dt[0]>ze?ze:0,fe=Dt[1]<Oe?Oe:Dt[1]>De?De:0,Ae||fe){if(se)if(le){var Ne=Te(le,Dt);Ne.length>1&&(Qe(Ne[0]),re[se++]=Ne[1])}else ge=Te(re[se-1],Dt)[0],re[se++]=ge;else re[se++]=[Ae||Dt[0],fe||Dt[1]];var qe=re[se-1];Ae&&fe&&(qe[0]!==Ae||qe[1]!==fe)?(le&&(me!==Ae&&_e!==fe?Ye(me&&_e?(pe=le,Fe=(be=Dt)[0]-pe[0],Ve=(be[1]-pe[1])/Fe,(pe[1]*be[0]-be[1]*pe[0])/Fe>0?[Ve>0?Me:ze,De]:[Ve>0?ze:Me,Oe]):[me||Ae,_e||fe]):me&&_e&&Ye([me,_e])),Ye([Ae,fe])):me-Ae&&_e-fe&&Ye([Ae||me,fe||_e]),le=Dt,me=Ae,_e=fe}else le&&Qe(Te(le,Dt)[0]),re[se++]=Dt;var pe,be,Fe,Ve}for(h=0;h<ee;h++)if(l=oe(h)){for(se=0,le=null,xt(l),h++;h<ee;h++){if(!(p=oe(h))){if(H)continue;break}if(te&&s.simplify){var wt=oe(h+1);if(b=ve(p,l),B&&(se===0||se===ee-1)||!(b<ce(p,wt)*J)){for(f=[(p[0]-l[0])/b,(p[1]-l[1])/b],c=l,T=b,k=A=I=0,x=!1,o=p,h++;h<u.length;h++){if(i=wt,wt=oe(h+1),!i){if(H)continue;break}if(P=(_=[i[0]-l[0],i[1]-l[1]])[0]*f[1]-_[1]*f[0],A=Math.min(A,P),(I=Math.max(I,P))-A>ce(i,wt))break;o=i,(L=_[0]*f[0]+_[1]*f[1])>T?(T=L,p=i,x=!1):L<k&&(k=L,c=i,x=!0)}if(x?(xt(p),o!==c&&xt(c)):(c!==l&&xt(c),o!==p&&xt(p)),xt(o),h>=u.length||!i)break;xt(i),l=i}}else xt(p)}le&&Ye([me||le[0],_e||le[1]]),X.push(re.slice(0,se))}var bt=U.slice(U.length-1);if($&&bt!=="h"&&bt!=="v"){for(var nt=!1,$e=-1,vt=[],Nt=0;Nt<X.length;Nt++)for(var qt=0;qt<X[Nt].length-1;qt++){var Jt=X[Nt][qt],Wt=X[Nt][qt+1],ar=d.applyBackoff(Wt,Jt);ar[0]===Wt[0]&&ar[1]===Wt[1]||(nt=!0),vt[$e+1]||(vt[++$e]=[Jt,[ar[0],ar[1]]])}return nt?vt:X}return X}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(m,G,W){G.exports=function(d,v,w){w("line.shape")==="spline"&&w("line.smoothing")}},{}],952:[function(m,G,W){var d={tonextx:1,tonexty:1,tonext:1};G.exports=function(v,w,y){var e,t,n,a,r,g={},u=!1,s=-1,h=0,l=-1;for(t=0;t<y.length;t++)(n=(e=y[t][0].trace).stackgroup||"")?n in g?r=g[n]:(r=g[n]=h,h++):e.fill in d&&l>=0?r=l:(r=l=h,h++),r<s&&(u=!0),e._groupIndex=s=r;var o=y.slice();u&&o.sort(function(c,i){var x=c[0].trace,f=i[0].trace;return x._groupIndex-f._groupIndex||x.index-f.index});var p={};for(t=0;t<o.length;t++)n=(e=o[t][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in d&&(a=p[n],e._prevtrace=a||null,a&&(a._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),p[n]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return o}},{}],953:[function(m,G,W){var d=m("fast-isnumeric");G.exports=function(v,w){w||(w=2);var y=v.marker,e=y.sizeref||1,t=y.sizemin||0,n=y.sizemode==="area"?function(a){return Math.sqrt(a/e)}:function(a){return a/e};return function(a){var r=n(a/w);return d(r)&&r>0?Math.max(r,t):0}}},{"fast-isnumeric":190}],954:[function(m,G,W){G.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(m,G,W){var d=m("../../components/color"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("./subtypes");G.exports=function(e,t,n,a,r,g){var u=y.isBubble(e),s=(e.line||{}).color;g=g||{},s&&(n=s),r("marker.symbol"),r("marker.opacity",u?.7:1),r("marker.size"),g.noAngle||(r("marker.angle"),g.noAngleRef||r("marker.angleref"),g.noStandOff||r("marker.standoff")),r("marker.color",n),v(e,"marker")&&w(e,t,a,r,{prefix:"marker.",cLetter:"c"}),g.noSelect||(r("selected.marker.color"),r("unselected.marker.color"),r("selected.marker.size"),r("unselected.marker.size")),g.noLine||(r("marker.line.color",s&&!Array.isArray(s)&&t.marker.color!==s?s:u?d.background:d.defaultLine),v(e,"marker.line")&&w(e,t,a,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width",u?1:0)),u&&(r("marker.sizeref"),r("marker.sizemin"),r("marker.sizemode")),g.gradient&&r("marker.gradient.type")!=="none"&&r("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(m,G,W){var d=m("../../lib").dateTick0,v=m("../../constants/numerical").ONEWEEK;function w(y,e){return d(e,y%v==0?1:0)}G.exports=function(y,e,t,n,a){if(a||(a={x:!0,y:!0}),a.x){var r=n("xperiod");r&&(n("xperiod0",w(r,e.xcalendar)),n("xperiodalignment"))}if(a.y){var g=n("yperiod");g&&(n("yperiod0",w(g,e.ycalendar)),n("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=w.ensureSingle,e=w.identity,t=m("../../components/drawing"),n=m("./subtypes"),a=m("./line_points"),r=m("./link_traces"),g=m("../../lib/polygon").tester;function u(s,h,l,o,p,c,i){var x;(function(ge,Te,Se,Me,ze){var Oe=Se.xaxis,De=Se.yaxis,Xe=d.extent(w.simpleMap(Oe.range,Oe.r2c)),Be=d.extent(w.simpleMap(De.range,De.r2c)),Ie=Me[0].trace;if(!!n.hasMarkers(Ie)){var Re=Ie.marker.maxdisplayed;if(Re!==0){var Ye=Me.filter(function(wt){return wt.x>=Xe[0]&&wt.x<=Xe[1]&&wt.y>=Be[0]&&wt.y<=Be[1]}),Qe=Math.ceil(Ye.length/Re),lt=0;ze.forEach(function(wt,bt){var nt=wt[0].trace;n.hasMarkers(nt)&&nt.marker.maxdisplayed>0&&bt<Te&&lt++});var xt=Math.round(lt*Qe/3+Math.floor(lt/3)*Qe/7.1);Me.forEach(function(wt){delete wt.vis}),Ye.forEach(function(wt,bt){Math.round((bt+xt)%Qe)===0&&(wt.vis=!0)})}}})(0,h,l,o,p);var f=!!i&&i.duration>0;function _(ge){return f?ge.transition():ge}var b=l.xaxis,T=l.yaxis,k=o[0].trace,L=k.line,A=d.select(c),I=y(A,"g","errorbars"),P=y(A,"g","lines"),S=y(A,"g","points"),E=y(A,"g","text");if(v.getComponentMethod("errorbars","plot")(s,I,l,i),k.visible===!0){var z,D;_(A).style("opacity",k.opacity);var j=k.fill.charAt(k.fill.length-1);j!=="x"&&j!=="y"&&(j=""),o[0][l.isRangePlot?"nodeRangePlot3":"node3"]=A;var V,Z,Q="",K=[],$=k._prevtrace;$&&(Q=$._prevRevpath||"",D=$._nextFill,K=$._polygons);var ne,H,N,U,te,B,X,J="",ee="",re=[],se=w.noop;if(z=k._ownFill,n.hasLines(k)||k.fill!=="none"){for(D&&D.datum(o),["hv","vh","hvh","vhv"].indexOf(L.shape)!==-1?(ne=t.steps(L.shape),H=t.steps(L.shape.split("").reverse().join(""))):ne=H=L.shape==="spline"?function(ge){var Te=ge[ge.length-1];return ge.length>1&&ge[0][0]===Te[0]&&ge[0][1]===Te[1]?t.smoothclosed(ge.slice(1),L.smoothing):t.smoothopen(ge,L.smoothing)}:function(ge){return"M"+ge.join("L")},N=function(ge){return H(ge.reverse())},re=a(o,{xaxis:b,yaxis:T,trace:k,connectGaps:k.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,backoff:L.backoff,simplify:L.simplify,fill:k.fill}),X=k._polygons=new Array(re.length),x=0;x<re.length;x++)k._polygons[x]=g(re[x]);re.length&&(U=re[0][0],B=(te=re[re.length-1])[te.length-1]),se=function(ge){return function(Te){if(V=ne(Te),Z=N(Te),J?j?(J+="L"+V.substr(1),ee=Z+"L"+ee.substr(1)):(J+="Z"+V,ee=Z+"Z"+ee):(J=V,ee=Z),n.hasLines(k)&&Te.length>1){var Se=d.select(this);if(Se.datum(o),ge)_(Se.style("opacity",0).attr("d",V).call(t.lineGroupStyle)).style("opacity",1);else{var Me=_(Se);Me.attr("d",V),t.singleLineStyle(o,Me)}}}}}var oe=P.selectAll(".js-line").data(re);_(oe.exit()).style("opacity",0).remove(),oe.each(se(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(t.lineGroupStyle).each(se(!0)),t.setClipUrl(oe,l.layerClipId,s),re.length?(z?(z.datum(o),U&&B&&(j?(j==="y"?U[1]=B[1]=T.c2p(0,!0):j==="x"&&(U[0]=B[0]=b.c2p(0,!0)),_(z).attr("d","M"+B+"L"+U+"L"+J.substr(1)).call(t.singleFillStyle,s)):_(z).attr("d",J+"Z").call(t.singleFillStyle,s))):D&&(k.fill.substr(0,6)==="tonext"&&J&&Q?(k.fill==="tonext"?_(D).attr("d",J+"Z"+Q+"Z").call(t.singleFillStyle,s):_(D).attr("d",J+"L"+Q.substr(1)+"Z").call(t.singleFillStyle,s),k._polygons=k._polygons.concat(K)):(ce(D),k._polygons=null)),k._prevRevpath=ee,k._prevPolygons=X):(z?ce(z):D&&ce(D),k._polygons=k._prevRevpath=k._prevPolygons=null),S.datum(o),E.datum(o),function(ge,Te,Se){var Me,ze=Se[0].trace,Oe=n.hasMarkers(ze),De=n.hasText(ze),Xe=_e(ze),Be=le,Ie=le;if(Oe||De){var Re=e,Ye=ze.stackgroup,Qe=Ye&&s._fullLayout._scatterStackOpts[b._id+T._id][Ye].stackgaps==="infer zero";ze.marker.maxdisplayed||ze._needsCull?Re=Qe?Ae:ve:Ye&&!Qe&&(Re=fe),Oe&&(Be=Re),De&&(Ie=Re)}var lt,xt=(Me=ge.selectAll("path.point").data(Be,Xe)).enter().append("path").classed("point",!0);f&&xt.call(t.pointStyle,ze,s).call(t.translatePoints,b,T).style("opacity",0).transition().style("opacity",1),Me.order(),Oe&&(lt=t.makePointStyleFns(ze)),Me.each(function(wt){var bt=d.select(this),nt=_(bt);t.translatePoint(wt,nt,b,T)?(t.singlePointStyle(wt,nt,ze,lt,s),l.layerClipId&&t.hideOutsideRangePoint(wt,nt,b,T,ze.xcalendar,ze.ycalendar),ze.customdata&&bt.classed("plotly-customdata",wt.data!==null&&wt.data!==void 0)):nt.remove()}),f?Me.exit().transition().style("opacity",0).remove():Me.exit().remove(),(Me=Te.selectAll("g").data(Ie,Xe)).enter().append("g").classed("textpoint",!0).append("text"),Me.order(),Me.each(function(wt){var bt=d.select(this),nt=_(bt.select("text"));t.translatePoint(wt,nt,b,T)?l.layerClipId&&t.hideOutsideRangePoint(wt,bt,b,T,ze.xcalendar,ze.ycalendar):bt.remove()}),Me.selectAll("text").call(t.textPointStyle,ze,s).each(function(wt){var bt=b.c2p(wt.x),nt=T.c2p(wt.y);d.select(this).selectAll("tspan.line").each(function(){_(d.select(this)).attr({x:bt,y:nt})})}),Me.exit().remove()}(S,E,o);var de=k.cliponaxis===!1?null:l.layerClipId;t.setClipUrl(S,de,s),t.setClipUrl(E,de,s)}function ce(ge){_(ge).attr("d","M0,0Z")}function ve(ge){return ge.filter(function(Te){return!Te.gap&&Te.vis})}function Ae(ge){return ge.filter(function(Te){return Te.vis})}function fe(ge){return ge.filter(function(Te){return!Te.gap})}function me(ge){return ge.id}function _e(ge){if(ge.ids)return me}function le(){return!1}}G.exports=function(s,h,l,o,p,c){var i,x,f=!p,_=!!p&&p.duration>0,b=r(s,h,l);(i=o.selectAll("g.trace").data(b,function(T){return T[0].trace.uid})).enter().append("g").attr("class",function(T){return"trace scatter trace"+T[0].trace.uid}).style("stroke-miterlimit",2),i.order(),function(T,k,L){k.each(function(A){var I=y(d.select(this),"g","fills");t.setClipUrl(I,L.layerClipId,T);var P=A[0].trace,S=[];P._ownfill&&S.push("_ownFill"),P._nexttrace&&S.push("_nextFill");var E=I.selectAll("g").data(S,e);E.enter().append("g"),E.exit().each(function(z){P[z]=null}).remove(),E.order().each(function(z){P[z]=y(d.select(this),"path","js-fill")})})}(s,i,h),_?(c&&(x=c()),d.transition().duration(p.duration).ease(p.easing).each("end",function(){x&&x()}).each("interrupt",function(){x&&x()}).each(function(){o.selectAll("g.trace").each(function(T,k){u(s,k,h,T,b,this,p)})})):i.each(function(T,k){u(s,k,h,T,b,this,p)}),f&&i.exit().remove(),o.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(m,G,W){var d=m("./subtypes");G.exports=function(v,w){var y,e,t,n,a=v.cd,r=v.xaxis,g=v.yaxis,u=[],s=a[0].trace;if(!d.hasMarkers(s)&&!d.hasText(s))return[];if(w===!1)for(y=0;y<a.length;y++)a[y].selected=0;else for(y=0;y<a.length;y++)e=a[y],t=r.c2p(e.x),n=g.c2p(e.y),e.i!==null&&w.contains([t,n],!1,y,v)?(u.push({pointNumber:e.i,x:r.c2d(e.x),y:g.c2d(e.y)}),e.selected=1):e.selected=0;return u}},{"./subtypes":961}],959:[function(m,G,W){var d=["orientation","groupnorm","stackgaps"];G.exports=function(v,w,y,e){var t=y._scatterStackOpts,n=e("stackgroup");if(n){var a=w.xaxis+w.yaxis,r=t[a];r||(r=t[a]={});var g=r[n],u=!1;g?g.traces.push(w):(g=r[n]={traceIndices:[],traces:[w]},u=!0);for(var s={orientation:w.x&&!w.y?"h":"v"},h=0;h<d.length;h++){var l=d[h],o=l+"Found";if(!g[o]){var p=v[l]!==void 0,c=l==="orientation";if((p||u)&&(g[l]=e(l,s[l]),c&&(g.fillDflt=g[l]==="h"?"tonextx":"tonexty"),p&&(g[o]=!0,!u&&(delete g.traces[0][l],c))))for(var i=0;i<g.traces.length-1;i++){var x=g.traces[i];x._input.fill!==x.fill&&(x.fill=g.fillDflt)}}}return g}}},{}],960:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../registry");function y(t,n,a){v.pointStyle(t.selectAll("path.point"),n,a)}function e(t,n,a){v.textPointStyle(t.selectAll("text"),n,a)}G.exports={style:function(t){var n=d.select(t).selectAll("g.trace.scatter");n.style("opacity",function(a){return a[0].trace.opacity}),n.selectAll("g.points").each(function(a){y(d.select(this),a.trace||a[0].trace,t)}),n.selectAll("g.text").each(function(a){e(d.select(this),a.trace||a[0].trace,t)}),n.selectAll("g.trace path.js-line").call(v.lineGroupStyle),n.selectAll("g.trace path.js-fill").call(v.fillGroupStyle,t),w.getComponentMethod("errorbars","style")(n)},stylePoints:y,styleText:e,styleOnSelect:function(t,n,a){var r=n[0].trace;r.selectedpoints?(v.selectedPointStyle(a.selectAll("path.point"),r),v.selectedTextStyle(a.selectAll("text"),r)):(y(a,r,t),e(a,r,t))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(m,G,W){var d=m("../../lib");G.exports={hasLines:function(v){return v.visible&&v.mode&&v.mode.indexOf("lines")!==-1},hasMarkers:function(v){return v.visible&&(v.mode&&v.mode.indexOf("markers")!==-1||v.type==="splom")},hasText:function(v){return v.visible&&v.mode&&v.mode.indexOf("text")!==-1},isBubble:function(v){return d.isPlainObject(v.marker)&&d.isArrayOrTypedArray(v.marker.size)}}},{"../../lib":515}],962:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w,y,e,t){t=t||{},e("textposition"),d.coerceFont(e,"textfont",y.font),t.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(m,G,W){var d=m("../../lib"),v=m("../../registry");G.exports=function(w,y,e,t){var n,a=t("x"),r=t("y");if(v.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x","y"],e),a){var g=d.minRowLength(a);r?n=Math.min(g,d.minRowLength(r)):(n=g,t("y0"),t("dy"))}else{if(!r)return 0;n=d.minRowLength(r),t("x0"),t("dx")}return y._length=n,n}},{"../../lib":515,"../../registry":647}],964:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/template_attributes").texttemplateAttrs,t=m("../../plots/attributes"),n=m("../../constants/gl3d_dashes"),a=m("../../constants/gl3d_markers"),r=m("../../lib/extend").extendFlat,g=m("../../plot_api/edit_types").overrideAll,u=m("../../lib/sort_object_keys"),s=d.line,h=d.marker,l=h.line,o=r({width:s.width,dash:{valType:"enumerated",values:u(n),dflt:"solid"}},v("line")),p=G.exports=g({x:d.x,y:d.y,z:{valType:"data_array"},text:r({},d.text,{}),texttemplate:e({},{}),hovertext:r({},d.hovertext,{}),hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),zhoverformat:w("z"),mode:r({},d.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:d.connectgaps,line:o,marker:r({symbol:{valType:"enumerated",values:u(a),dflt:"circle",arrayOk:!0},size:r({},h.size,{dflt:8}),sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,opacity:r({},h.opacity,{arrayOk:!1}),colorbar:h.colorbar,line:r({width:r({},l.width,{arrayOk:!1})},v("marker.line"))},v("marker")),textposition:r({},d.textposition,{dflt:"top center"}),textfont:{color:d.textfont.color,size:d.textfont.size,family:r({},d.textfont.family,{arrayOk:!1})},opacity:t.opacity,hoverinfo:r({},t.hoverinfo)},"calc","nested");p.x.editType=p.y.editType=p.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(m,G,W){var d=m("../scatter/arrays_to_calcdata"),v=m("../scatter/colorscale_calc");G.exports=function(w,y){var e=[{x:!1,y:!1,trace:y,t:{}}];return d(e,y),v(w,y),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(m,G,W){var d=m("../../registry");function v(w,y,e,t){if(!y||!y.visible)return null;for(var n=d.getComponentMethod("errorbars","makeComputeError")(y),a=new Array(w.length),r=0;r<w.length;r++){var g=n(+w[r],r);if(t.type==="log"){var u=t.c2l(w[r]),s=w[r]-g[0],h=w[r]+g[1];if(a[r]=[(t.c2l(s,!0)-u)*e,(t.c2l(h,!0)-u)*e],s>0){var l=t.c2l(s);t._lowerLogErrorBound||(t._lowerLogErrorBound=l),t._lowerErrorBound=Math.min(t._lowerLogErrorBound,l)}}else a[r]=[-g[0]*e,g[1]*e]}return a}G.exports=function(w,y,e){var t=[v(w.x,w.error_x,y[0],e.xaxis),v(w.y,w.error_y,y[1],e.yaxis),v(w.z,w.error_z,y[2],e.zaxis)],n=function(h){for(var l=0;l<h.length;l++)if(h[l])return h[l].length;return 0}(t);if(n===0)return null;for(var a=new Array(n),r=0;r<n;r++){for(var g=[[0,0,0],[0,0,0]],u=0;u<3;u++)if(t[u])for(var s=0;s<2;s++)g[s][u]=t[u][r][s];a[r]=g}return a}},{"../../registry":647}],967:[function(m,G,W){var d=m("../../../stackgl_modules").gl_line3d,v=m("../../../stackgl_modules").gl_scatter3d,w=m("../../../stackgl_modules").gl_error3d,y=m("../../../stackgl_modules").gl_mesh3d,e=m("../../../stackgl_modules").delaunay_triangulate,t=m("../../lib"),n=m("../../lib/str2rgbarray"),a=m("../../lib/gl_format_color").formatColor,r=m("../scatter/make_bubble_size_func"),g=m("../../constants/gl3d_dashes"),u=m("../../constants/gl3d_markers"),s=m("../../plots/cartesian/axes"),h=m("../../components/fx/helpers").appendArrayPointValue,l=m("./calc_errors");function o(L,A){this.scene=L,this.uid=A,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var p=o.prototype;function c(L){return L==null?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function i(L){return L==null?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function x(L,A){return A(4*L)}function f(L){return u[L]}function _(L,A,I,P,S){var E=null;if(t.isArrayOrTypedArray(L)){E=[];for(var z=0;z<A;z++)L[z]===void 0?E[z]=P:E[z]=I(L[z],S)}else E=I(L,t.identity);return E}function b(L,A){var I,P,S,E,z,D,j=[],V=L.fullSceneLayout,Z=L.dataScale,Q=V.xaxis,K=V.yaxis,$=V.zaxis,ne=A.marker,H=A.line,N=A.x||[],U=A.y||[],te=A.z||[],B=N.length,X=A.xcalendar,J=A.ycalendar,ee=A.zcalendar;for(z=0;z<B;z++)I=Q.d2l(N[z],0,X)*Z[0],P=K.d2l(U[z],0,J)*Z[1],S=$.d2l(te[z],0,ee)*Z[2],j[z]=[I,P,S];if(Array.isArray(A.text))D=A.text;else if(A.text!==void 0)for(D=new Array(B),z=0;z<B;z++)D[z]=A.text;function re(Me,ze){var Oe=V[Me];return s.tickText(Oe,Oe.d2l(ze),!0).text}var se=A.texttemplate;if(se){var oe=L.fullLayout._d3locale,de=Array.isArray(se),ce=de?Math.min(se.length,B):B,ve=de?function(Me){return se[Me]}:function(){return se};for(D=new Array(ce),z=0;z<ce;z++){var Ae={x:N[z],y:U[z],z:te[z]},fe={xLabel:re("xaxis",N[z]),yLabel:re("yaxis",U[z]),zLabel:re("zaxis",te[z])},me={};h(me,A,z);var _e=A._meta||{};D[z]=t.texttemplateString(ve(z),fe,oe,me,Ae,_e)}}if(E={position:j,mode:A.mode,text:D},"line"in A&&(E.lineColor=a(H,1,B),E.lineWidth=H.width,E.lineDashes=H.dash),"marker"in A){var le=r(A);E.scatterColor=a(ne,1,B),E.scatterSize=_(ne.size,B,x,20,le),E.scatterMarker=_(ne.symbol,B,f,"\u25CF"),E.scatterLineWidth=ne.line.width,E.scatterLineColor=a(ne.line,1,B),E.scatterAngle=0}"textposition"in A&&(E.textOffset=function(Me){var ze=[0,0];if(Array.isArray(Me))for(var Oe=0;Oe<Me.length;Oe++)ze[Oe]=[0,0],Me[Oe]&&(ze[Oe][0]=c(Me[Oe]),ze[Oe][1]=i(Me[Oe]));else ze[0]=c(Me),ze[1]=i(Me);return ze}(A.textposition),E.textColor=a(A.textfont,1,B),E.textSize=_(A.textfont.size,B,t.identity,12),E.textFont=A.textfont.family,E.textAngle=0);var ge=["x","y","z"];for(E.project=[!1,!1,!1],E.projectScale=[1,1,1],E.projectOpacity=[1,1,1],z=0;z<3;++z){var Te=A.projection[ge[z]];(E.project[z]=Te.show)&&(E.projectOpacity[z]=Te.opacity,E.projectScale[z]=Te.scale)}E.errorBounds=l(A,Z,V);var Se=function(Me){for(var ze=[0,0,0],Oe=[[0,0,0],[0,0,0],[0,0,0]],De=[1,1,1],Xe=0;Xe<3;Xe++){var Be=Me[Xe];Be&&Be.copy_zstyle!==!1&&Me[2].visible!==!1&&(Be=Me[2]),Be&&Be.visible&&(ze[Xe]=Be.width/2,Oe[Xe]=n(Be.color),De[Xe]=Be.thickness)}return{capSize:ze,color:Oe,lineWidth:De}}([A.error_x,A.error_y,A.error_z]);return E.errorColor=Se.color,E.errorLineWidth=Se.lineWidth,E.errorCapSize=Se.capSize,E.delaunayAxis=A.surfaceaxis,E.delaunayColor=n(A.surfacecolor),E}function T(L){if(t.isArrayOrTypedArray(L)){var A=L[0];return t.isArrayOrTypedArray(A)&&(L=A),"rgb("+L.slice(0,3).map(function(I){return Math.round(255*I)})+")"}return null}function k(L){return t.isArrayOrTypedArray(L)?L.length===4&&typeof L[0]=="number"?T(L):L.map(T):null}p.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var A=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[A]||this.textLabels[A]===0)&&(L.textLabel=this.textLabels[A]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[A],this.data.y[A],this.data.z[A]],!0}},p.update=function(L){var A,I,P,S,E=this.scene.glplot.gl,z=g.solid;this.data=L;var D=b(this.scene,L);"mode"in D&&(this.mode=D.mode),"lineDashes"in D&&D.lineDashes in g&&(z=g[D.lineDashes]),this.color=k(D.scatterColor)||k(D.lineColor),this.dataPoints=D.position,A={gl:this.scene.glplot.gl,position:D.position,color:D.lineColor,lineWidth:D.lineWidth||1,dashes:z[0],dashScale:z[1],opacity:L.opacity,connectGaps:L.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(A):(this.linePlot=d(A),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var j=L.opacity;if(L.marker&&L.marker.opacity&&(j*=L.marker.opacity),I={gl:this.scene.glplot.gl,position:D.position,color:D.scatterColor,size:D.scatterSize,glyph:D.scatterMarker,opacity:j,orthographic:!0,lineWidth:D.scatterLineWidth,lineColor:D.scatterLineColor,project:D.project,projectScale:D.projectScale,projectOpacity:D.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(I):(this.scatterPlot=v(I),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:D.position,glyph:D.text,color:D.textColor,size:D.textSize,angle:D.textAngle,alignment:D.textOffset,font:D.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=v(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),P={gl:this.scene.glplot.gl,position:D.position,color:D.errorColor,error:D.errorBounds,lineWidth:D.errorLineWidth,capSize:D.errorCapSize,opacity:L.opacity},this.errorBars?D.errorBounds?this.errorBars.update(P):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):D.errorBounds&&(this.errorBars=w(P),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),D.delaunayAxis>=0){var V=function(Z,Q,K){var $,ne=(K+1)%3,H=(K+2)%3,N=[],U=[];for($=0;$<Z.length;++$){var te=Z[$];!isNaN(te[ne])&&isFinite(te[ne])&&!isNaN(te[H])&&isFinite(te[H])&&(N.push([te[ne],te[H]]),U.push($))}var B=e(N);for($=0;$<B.length;++$)for(var X=B[$],J=0;J<X.length;++J)X[J]=U[X[J]];return{positions:Z,cells:B,meshColor:Q}}(D.position,D.delaunayColor,D.delaunayAxis);V.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(V):(V.gl=E,this.delaunayMesh=y(V),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},p.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},G.exports=function(L,A){var I=new o(L,A.uid);return I.update(A),I}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/text_defaults"),n=m("./attributes");G.exports=function(a,r,g,u){function s(x,f){return v.coerce(a,r,n,x,f)}if(function(x,f,_,b){var T=0,k=_("x"),L=_("y"),A=_("z");return d.getComponentMethod("calendars","handleTraceDefaults")(x,f,["x","y","z"],b),k&&L&&A&&(T=Math.min(k.length,L.length,A.length),f._length=f._xlength=f._ylength=f._zlength=T),T}(a,r,s,u)){s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),s("mode"),w.hasLines(r)&&(s("connectgaps"),e(a,r,g,u,s)),w.hasMarkers(r)&&y(a,r,g,u,s,{noSelect:!0,noAngle:!0}),w.hasText(r)&&(s("texttemplate"),t(a,r,u,s,{noSelect:!0}));var h=(r.line||{}).color,l=(r.marker||{}).color;s("surfaceaxis")>=0&&s("surfacecolor",h||l);for(var o=["x","y","z"],p=0;p<3;++p){var c="projection."+o[p];s(c+".show")&&(s(c+".opacity"),s(c+".scale"))}var i=d.getComponentMethod("errorbars","supplyDefaults");i(a,r,h||l||g,{axis:"z"}),i(a,r,h||l||g,{axis:"y",inherit:"z"}),i(a,r,h||l||g,{axis:"x",inherit:"z"})}else r.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(m,G,W){G.exports={plot:m("./convert"),attributes:m("./attributes"),markerSymbols:m("../../constants/gl3d_markers"),supplyDefaults:m("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:m("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../../plots/attributes"),w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../components/colorscale/attributes"),t=m("../../lib/extend").extendFlat,n=d.marker,a=d.line,r=n.line;G.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:t({},d.mode,{dflt:"markers"}),text:t({},d.text,{}),texttemplate:y({editType:"plot"},{keys:["a","b","text"]}),hovertext:t({},d.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:t({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:d.connectgaps,fill:t({},d.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:d.fillcolor,marker:t({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:t({width:r.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:d.textfont,textposition:d.textposition,selected:d.selected,unselected:d.unselected,hoverinfo:t({},v.hoverinfo,{flags:["a","b","text","name"]}),hoveron:d.hoveron,hovertemplate:w()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../scatter/colorscale_calc"),w=m("../scatter/arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../scatter/calc").calcMarkerSize,t=m("../carpet/lookup_carpetid");G.exports=function(n,a){var r=a._carpetTrace=t(n,a);if(r&&r.visible&&r.visible!=="legendonly"){var g;a.xaxis=r.xaxis,a.yaxis=r.yaxis;var u,s,h=a._length,l=new Array(h),o=!1;for(g=0;g<h;g++)if(u=a.a[g],s=a.b[g],d(u)&&d(s)){var p=r.ab2xy(+u,+s,!0),c=r.isVisible(+u,+s);c||(o=!0),l[g]={x:p[0],y:p[1],a:u,b:s,vis:c}}else l[g]={x:!1,y:!1};return a._needsCull=o,l[0].carpet=r,l[0].trace=a,e(a,h),v(n,a),w(l,a),y(l,a),l}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/constants"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/line_shape_defaults"),n=m("../scatter/text_defaults"),a=m("../scatter/fillcolor_defaults"),r=m("./attributes");G.exports=function(g,u,s,h){function l(x,f){return d.coerce(g,u,r,x,f)}l("carpet"),u.xaxis="x",u.yaxis="y";var o=l("a"),p=l("b"),c=Math.min(o.length,p.length);if(c){u._length=c,l("text"),l("texttemplate"),l("hovertext"),l("mode",c<v.PTS_LINESONLY?"lines+markers":"lines"),w.hasLines(u)&&(e(g,u,s,h,l,{backoff:!0}),t(g,u,l),l("connectgaps")),w.hasMarkers(u)&&y(g,u,s,h,l,{gradient:!0}),w.hasText(u)&&n(g,u,h,l);var i=[];(w.hasMarkers(u)||w.hasText(u))&&(l("marker.maxdisplayed"),i.push("points")),l("fill"),u.fill!=="none"&&(a(g,u,s,l),w.hasLines(u)||t(g,u,l)),u.fill!=="tonext"&&u.fill!=="toself"||i.push("fills"),l("hoveron",i.join("+")||"points")!=="fills"&&l("hovertemplate"),d.coerceSelectionMarkerOpacity(u,l)}else u.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(m,G,W){G.exports=function(d,v,w,y,e){var t=y[e];return d.a=t.a,d.b=t.b,d.y=t.y,d}},{}],974:[function(m,G,W){G.exports=function(d,v){var w={},y=v._carpet,e=y.ab2ij([d.a,d.b]),t=Math.floor(e[0]),n=e[0]-t,a=Math.floor(e[1]),r=e[1]-a,g=y.evalxy([],t,a,n,r);return w.yLabel=g[1].toFixed(3),w}},{}],975:[function(m,G,W){var d=m("../scatter/hover"),v=m("../../lib").fillText;G.exports=function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var a=n[0];if(a.index===void 0){var r=1-a.y0/w.ya._length,g=w.xa._length,u=g*r/2,s=g-u;return a.x0=Math.max(Math.min(a.x0,s),u),a.x1=Math.max(Math.min(a.x1,s),u),n}var h=a.cd[a.index];a.a=h.a,a.b=h.b,a.xLabelVal=void 0,a.yLabelVal=void 0;var l=a.trace,o=l._carpet,p=l._module.formatLabels(h,l);a.yLabel=p.yLabel,delete a.text;var c=[];if(!l.hovertemplate){var i=(h.hi||l.hoverinfo).split("+");i.indexOf("all")!==-1&&(i=["a","b","text"]),i.indexOf("a")!==-1&&x(o.aaxis,h.a),i.indexOf("b")!==-1&&x(o.baxis,h.b),c.push("y: "+a.yLabel),i.indexOf("text")!==-1&&v(h,l,c),a.extraText=c.join("<br>")}return n}function x(f,_){var b;b=f.labelprefix&&f.labelprefix.length>0?f.labelprefix.replace(/ = $/,""):f._hovertitle,c.push(b+": "+_.toFixed(3)+f.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../scatter/select"),eventData:m("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:m("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(m,G,W){var d=m("../scatter/plot"),v=m("../../plots/cartesian/axes"),w=m("../../components/drawing");G.exports=function(y,e,t,n){var a,r,g,u=t[0][0].carpet,s=v.getFromId(y,u.xaxis||"x"),h=v.getFromId(y,u.yaxis||"y"),l={xaxis:s,yaxis:h,plot:e.plot};for(a=0;a<t.length;a++)(r=t[a][0].trace)._xA=s,r._yA=h;for(d(y,l,t,n),a=0;a<t.length;a++)r=t[a][0].trace,g=n.selectAll("g.trace"+r.uid+" .js-line"),w.setClipUrl(g,t[a][0].carpet._clipPathId,y)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scatter/attributes"),y=m("../../plots/attributes"),e=m("../../components/colorscale/attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat,a=m("../../plot_api/edit_types").overrideAll,r=w.marker,g=w.line,u=r.line;G.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},w.mode,{dflt:"markers"}),text:n({},w.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},w.hovertext,{}),textfont:w.textfont,textposition:w.textposition,line:{color:g.color,width:g.width,dash:t},connectgaps:w.connectgaps,marker:n({symbol:r.symbol,opacity:r.opacity,angle:r.angle,angleref:n({},r.angleref,{values:["previous","up","north"]}),standoff:r.standoff,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,colorbar:r.colorbar,line:n({width:u.width},e("marker.line")),gradient:r.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:w.fillcolor,selected:w.selected,unselected:w.unselected,hoverinfo:n({},y.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/colorscale_calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection"),t=m("../../lib")._;function n(a){return a&&typeof a=="string"}G.exports=function(a,r){var g,u=Array.isArray(r.locations),s=u?r.locations.length:r._length,h=new Array(s);g=r.geojson?function(x){return n(x)||d(x)}:n;for(var l=0;l<s;l++){var o=h[l]={};if(u){var p=r.locations[l];o.loc=g(p)?p:null}else{var c=r.lon[l],i=r.lat[l];d(c)&&d(i)?o.lonlat=[+c,+i]:o.lonlat=[v,v]}}return y(h,r),w(a,r),e(h,r),s&&(h[0].t={labels:{lat:t(a,"lat:")+" ",lon:t(a,"lon:")+" "}}),h}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/text_defaults"),t=m("../scatter/fillcolor_defaults"),n=m("./attributes");G.exports=function(a,r,g,u){function s(x,f){return d.coerce(a,r,n,x,f)}var h,l=s("locations");if(l&&l.length){var o,p=s("geojson");(typeof p=="string"&&p!==""||d.isPlainObject(p))&&(o="geojson-id"),s("locationmode",o)==="geojson-id"&&s("featureidkey"),h=l.length}else{var c=s("lon")||[],i=s("lat")||[];h=Math.min(c.length,i.length)}h?(r._length=h,s("text"),s("hovertext"),s("hovertemplate"),s("mode"),v.hasLines(r)&&(y(a,r,g,u,s),s("connectgaps")),v.hasMarkers(r)&&w(a,r,g,u,s,{gradient:!0}),v.hasText(r)&&(s("texttemplate"),e(a,r,u,s)),s("fill"),r.fill!=="none"&&t(a,r,g,s),d.coerceSelectionMarkerOpacity(r,s)):r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(m,G,W){G.exports=function(d,v,w,y,e){d.lon=v.lon,d.lat=v.lat,d.location=v.loc?v.loc:null;var t=y[e];return t.fIn&&t.fIn.properties&&(d.properties=t.fIn.properties),d}},{}],982:[function(m,G,W){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.geo]._subplot.mockAxis,n=v.lonlat;return e.lonLabel=d.tickText(t,t.c2l(n[0]),!0).text,e.latLabel=d.tickText(t,t.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(m,G,W){var d=m("../../components/fx"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/get_trace_color"),y=m("../../lib").fillText,e=m("./attributes");G.exports=function(t,n,a){var r=t.cd,g=r[0].trace,u=t.xa,s=t.ya,h=t.subplot,l=h.projection.isLonLatOverEdges,o=h.project;if(d.getClosest(r,function(b){var T=b.lonlat;if(T[0]===v||l(T))return 1/0;var k=o(T),L=o([n,a]),A=Math.abs(k[0]-L[0]),I=Math.abs(k[1]-L[1]),P=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(A*A+I*I)-P,1-3/P)},t),t.index!==!1){var p=r[t.index],c=p.lonlat,i=[u.c2p(c),s.c2p(c)],x=p.mrc||1;t.x0=i[0]-x,t.x1=i[0]+x,t.y0=i[1]-x,t.y1=i[1]+x,t.loc=p.loc,t.lon=c[0],t.lat=c[1];var f={};f[g.geo]={_subplot:h};var _=g._module.formatLabels(p,g,f);return t.lonLabel=_.lonLabel,t.latLabel=_.latLabel,t.color=w(g,p),t.extraText=function(b,T,k,L){if(b.hovertemplate)return;var A=T.hi||b.hoverinfo,I=A==="all"?e.hoverinfo.flags:A.split("+"),P=I.indexOf("location")!==-1&&Array.isArray(b.locations),S=I.indexOf("lon")!==-1,E=I.indexOf("lat")!==-1,z=I.indexOf("text")!==-1,D=[];function j(V){return V+"\xB0"}return P?D.push(T.loc):S&&E?D.push("("+j(k.latLabel)+", "+j(k.lonLabel)+")"):S?D.push(L.lon+j(k.lonLabel)):E&&D.push(L.lat+j(k.latLabel)),z&&y(T,b,D),D.join("<br>")}(g,p,t,r[0].t.labels),t.hovertemplate=g.hovertemplate,[t]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),calcGeoJSON:m("./plot").calcGeoJSON,plot:m("./plot").plot,style:m("./style"),styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:m("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../lib/topojson_utils").getTopojsonFeatures,y=m("../../lib/geojson_utils"),e=m("../../lib/geo_location_utils"),t=m("../../plots/cartesian/autorange").findExtremes,n=m("../../constants/numerical").BADNUM,a=m("../scatter/calc").calcMarkerSize,r=m("../scatter/subtypes"),g=m("./style");G.exports={calcGeoJSON:function(u,s){var h,l,o=u[0].trace,p=s[o.geo],c=p._subplot,i=o._length;if(Array.isArray(o.locations)){var x=o.locationmode,f=x==="geojson-id"?e.extractTraceFeature(u):w(o,c.topojson);for(h=0;h<i;h++){l=u[h];var _=x==="geojson-id"?l.fOut:e.locationToFeature(x,l.loc,f);l.lonlat=_?_.properties.ct:[n,n]}}var b,T,k={padded:!0};if(p.fitbounds==="geojson"&&o.locationmode==="geojson-id"){var L=e.computeBbox(e.getTraceGeojson(o));b=[L[0],L[2]],T=[L[1],L[3]]}else{for(b=new Array(i),T=new Array(i),h=0;h<i;h++)l=u[h],b[h]=l.lonlat[0],T[h]=l.lonlat[1];k.ppad=a(o,i)}o._extremes.lon=t(p.lonaxis._ax,b,k),o._extremes.lat=t(p.lataxis._ax,T,k)},plot:function(u,s,h){var l=s.layers.frontplot.select(".scatterlayer"),o=v.makeTraceGroups(l,h,"trace scattergeo");function p(c,i){c.lonlat[0]===n&&d.select(i).remove()}o.selectAll("*").remove(),o.each(function(c){var i=d.select(this),x=c[0].trace;if(r.hasLines(x)||x.fill!=="none"){var f=y.calcTraceToLineCoords(c),_=x.fill!=="none"?y.makePolygon(f):y.makeLine(f);i.selectAll("path.js-line").data([{geojson:_,trace:x}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}r.hasMarkers(x)&&i.selectAll("path.point").data(v.identity).enter().append("path").classed("point",!0).each(function(b){p(b,this)}),r.hasText(x)&&i.selectAll("g").data(v.identity).enter().append("g").append("text").each(function(b){p(b,this)}),g(u,c)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(m,G,W){var d=m("../scatter/subtypes"),v=m("../../constants/numerical").BADNUM;G.exports=function(w,y){var e,t,n,a,r,g=w.cd,u=w.xaxis,s=w.yaxis,h=[],l=g[0].trace;if(!d.hasMarkers(l)&&!d.hasText(l))return[];if(y===!1)for(r=0;r<g.length;r++)g[r].selected=0;else for(r=0;r<g.length;r++)(t=(e=g[r]).lonlat)[0]!==v&&(n=u.c2p(t),a=s.c2p(t),y.contains([n,a],null,r,w)?(h.push({pointNumber:r,lon:t[0],lat:t[1]}),e.selected=1):e.selected=0);return h}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../scatter/style"),e=y.stylePoints,t=y.styleText;G.exports=function(n,a){a&&function(r,g){var u=g[0].trace,s=g[0].node3;s.style("opacity",g[0].trace.opacity),e(s,u,r),t(s,u,r),s.selectAll("path.js-line").style("fill","none").each(function(h){var l=d.select(this),o=h.trace,p=o.line||{};l.call(w.stroke,p.color).call(v.dashLine,p.dash||"",p.width||0),o.fill!=="none"&&l.call(w.fill,o.fillcolor)})}(n,a)}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(m,G,W){var d=m("../../plots/attributes"),v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../components/colorscale/attributes"),e=m("../../lib/sort_object_keys"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll,a=m("./constants").DASHES,r=v.line,g=v.marker,u=g.line,s=G.exports=n({x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:w("x"),yhoverformat:w("y"),text:v.text,hovertext:v.hovertext,textposition:v.textposition,textfont:v.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:t({},y("marker"),{symbol:g.symbol,angle:g.angle,size:g.size,sizeref:g.sizeref,sizemin:g.sizemin,sizemode:g.sizemode,opacity:g.opacity,colorbar:g.colorbar,line:t({},y("marker.line"),{width:u.width})}),connectgaps:v.connectgaps,fill:t({},v.fill,{dflt:"none"}),fillcolor:v.fillcolor,selected:{marker:v.selected.marker,textfont:v.selected.textfont},unselected:{marker:v.unselected.marker,textfont:v.unselected.textfont},opacity:d.opacity},"calc","nested");s.x.editType=s.y.editType=s.x0.editType=s.y0.editType="calc+clearAxisTypes",s.hovertemplate=v.hovertemplate,s.texttemplate=v.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(m,G,W){var d=m("./hover");G.exports={moduleType:"trace",name:"scattergl",basePlotModule:m("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../scatter/cross_trace_defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),hoverPoints:d.hoverPoints,selectPoints:m("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(m,G,W){var d=m("@plotly/point-cluster"),v=m("../../lib"),w=m("../../plots/cartesian/axis_ids"),y=m("../../plots/cartesian/autorange").findExtremes,e=m("../../plots/cartesian/align_period"),t=m("../scatter/calc"),n=t.calcMarkerSize,a=t.calcAxisExpansion,r=t.setFirstScatter,g=m("../scatter/colorscale_calc"),u=m("./convert"),s=m("./scene_update"),h=m("../../constants/numerical").BADNUM,l=m("./constants").TOO_MANY_POINTS;function o(p,c,i){var x=p._extremes[c._id],f=y(c,i._bnds,{padded:!0});x.min=x.min.concat(f.min),x.max=x.max.concat(f.max)}G.exports=function(p,c){var i,x=p._fullLayout,f=c._xA=w.getFromId(p,c.xaxis,"x"),_=c._yA=w.getFromId(p,c.yaxis,"y"),b=x._plots[c.xaxis+c.yaxis],T=c._length,k=T>=l,L=2*T,A={},I=f.makeCalcdata(c,"x"),P=_.makeCalcdata(c,"y"),S=e(c,f,"x",I),E=e(c,_,"y",P),z=S.vals,D=E.vals;c._x=z,c._y=D,c.xperiodalignment&&(c._origX=I,c._xStarts=S.starts,c._xEnds=S.ends),c.yperiodalignment&&(c._origY=P,c._yStarts=E.starts,c._yEnds=E.ends);var j=new Array(L),V=new Array(T);for(i=0;i<T;i++)j[2*i]=z[i]===h?NaN:z[i],j[2*i+1]=D[i]===h?NaN:D[i],V[i]=i;if(f.type==="log")for(i=0;i<L;i+=2)j[i]=f.c2l(j[i]);if(_.type==="log")for(i=1;i<L;i+=2)j[i]=_.c2l(j[i]);k&&f.type!=="log"&&_.type!=="log"?A.tree=d(j):A.ids=V,g(p,c);var Z,Q=function($,ne,H,N,U,te){var B=u.style($,H);if(B.marker&&(B.marker.positions=N),B.line&&N.length>1&&v.extendFlat(B.line,u.linePositions($,H,N)),B.errorX||B.errorY){var X=u.errorBarPositions($,H,N,U,te);B.errorX&&v.extendFlat(B.errorX,X.x),B.errorY&&v.extendFlat(B.errorY,X.y)}return B.text&&(v.extendFlat(B.text,{positions:N},u.textPosition($,H,B.text,B.marker)),v.extendFlat(B.textSel,{positions:N},u.textPosition($,H,B.text,B.markerSel)),v.extendFlat(B.textUnsel,{positions:N},u.textPosition($,H,B.text,B.markerUnsel))),B}(p,0,c,j,z,D),K=s(p,b);return r(x,c),k?Q.marker&&(Z=Q.marker.sizeAvg||Math.max(Q.marker.size,3)):Z=n(c,T),a(p,c,f,_,z,D,Z),Q.errorX&&o(c,f,Q.errorX),Q.errorY&&o(c,_,Q.errorY),Q.fill&&!K.fill2d&&(K.fill2d=!0),Q.marker&&!K.scatter2d&&(K.scatter2d=!0),Q.line&&!K.line2d&&(K.line2d=!0),!Q.errorX&&!Q.errorY||K.error2d||(K.error2d=!0),Q.text&&!K.glText&&(K.glText=!0),Q.marker&&(Q.marker.snap=T),K.lineOptions.push(Q.line),K.errorXOptions.push(Q.errorX),K.errorYOptions.push(Q.errorY),K.fillOptions.push(Q.fill),K.markerOptions.push(Q.marker),K.markerSelectedOptions.push(Q.markerSel),K.markerUnselectedOptions.push(Q.markerUnsel),K.textOptions.push(Q.text),K.textSelectedOptions.push(Q.textSel),K.textUnselectedOptions.push(Q.textUnsel),K.selectBatch.push([]),K.unselectBatch.push([]),A._scene=K,A.index=K.count,A.x=z,A.y=D,A.positions=j,K.count++,[{x:!1,y:!1,t:A,trace:c}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(m,G,W){G.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(m,G,W){var d=m("fast-isnumeric"),v=m("svg-path-sdf"),w=m("color-normalize"),y=m("../../registry"),e=m("../../lib"),t=m("../../components/drawing"),n=m("../../plots/cartesian/axis_ids"),a=m("../../lib/gl_format_color").formatColor,r=m("../scatter/subtypes"),g=m("../scatter/make_bubble_size_func"),u=m("./helpers"),s=m("./constants"),h=m("../../constants/interactions").DESELECTDIM,l={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},o=m("../../components/fx/helpers").appendArrayPointValue;function p(I,P){var S,E=I._fullLayout,z=P._length,D=P.textfont,j=P.textposition,V=Array.isArray(j)?j:[j],Z=D.color,Q=D.size,K=D.family,$={},ne=I._context.plotGlPixelRatio,H=P.texttemplate;if(H){$.text=[];var N=E._d3locale,U=Array.isArray(H),te=U?Math.min(H.length,z):z,B=U?function(de){return H[de]}:function(){return H};for(S=0;S<te;S++){var X={i:S},J=P._module.formatLabels(X,P,E),ee={};o(ee,P,S);var re=P._meta||{};$.text.push(e.texttemplateString(B(S),J,N,ee,X,re))}}else Array.isArray(P.text)&&P.text.length<z?$.text=P.text.slice():$.text=P.text;if(Array.isArray($.text))for(S=$.text.length;S<z;S++)$.text[S]="";for($.opacity=P.opacity,$.font={},$.align=[],$.baseline=[],S=0;S<V.length;S++){var se=V[S].split(/\s+/);switch(se[1]){case"left":$.align.push("right");break;case"right":$.align.push("left");break;default:$.align.push(se[1])}switch(se[0]){case"top":$.baseline.push("bottom");break;case"bottom":$.baseline.push("top");break;default:$.baseline.push(se[0])}}if(Array.isArray(Z))for($.color=new Array(z),S=0;S<z;S++)$.color[S]=Z[S];else $.color=Z;if(e.isArrayOrTypedArray(Q)||Array.isArray(K))for($.font=new Array(z),S=0;S<z;S++){var oe=$.font[S]={};oe.size=(e.isTypedArray(Q)?Q[S]:Array.isArray(Q)?d(Q[S])?Q[S]:0:Q)*ne,oe.family=Array.isArray(K)?K[S]:K}else $.font={size:Q*ne,family:K};return $}function c(I,P){var S,E,z=P._length,D=P.marker,j={},V=e.isArrayOrTypedArray(D.symbol),Z=e.isArrayOrTypedArray(D.angle),Q=e.isArrayOrTypedArray(D.color),K=e.isArrayOrTypedArray(D.line.color),$=e.isArrayOrTypedArray(D.opacity),ne=e.isArrayOrTypedArray(D.size),H=e.isArrayOrTypedArray(D.line.width);if(V||(E=u.isOpenSymbol(D.symbol)),V||Q||K||$||Z){j.symbols=new Array(z),j.angles=new Array(z),j.colors=new Array(z),j.borderColors=new Array(z);var N=D.symbol,U=D.angle,te=a(D,D.opacity,z),B=a(D.line,D.opacity,z);if(!Array.isArray(B[0])){var X=B;for(B=Array(z),S=0;S<z;S++)B[S]=X}if(!Array.isArray(te[0])){var J=te;for(te=Array(z),S=0;S<z;S++)te[S]=J}if(!Array.isArray(N)){var ee=N;for(N=Array(z),S=0;S<z;S++)N[S]=ee}if(!Array.isArray(U)){var re=U;for(U=Array(z),S=0;S<z;S++)U[S]=re}for(j.symbols=N,j.angles=U,j.colors=te,j.borderColors=B,S=0;S<z;S++)V&&(E=u.isOpenSymbol(D.symbol[S])),E&&(B[S]=te[S].slice(),te[S]=te[S].slice(),te[S][3]=0);for(j.opacity=P.opacity,j.markers=new Array(z),S=0;S<z;S++)j.markers[S]=A({mx:j.symbols[S],ma:j.angles[S]},P)}else E?(j.color=w(D.color,"uint8"),j.color[3]=0,j.borderColor=w(D.color,"uint8")):(j.color=w(D.color,"uint8"),j.borderColor=w(D.line.color,"uint8")),j.opacity=P.opacity*D.opacity,j.marker=A({mx:D.symbol,ma:D.angle},P);var se,oe=g(P,1);if(ne||H){var de,ce=j.sizes=new Array(z),ve=j.borderSizes=new Array(z),Ae=0;if(ne){for(S=0;S<z;S++)ce[S]=oe(D.size[S]),Ae+=ce[S];de=Ae/z}else for(se=oe(D.size),S=0;S<z;S++)ce[S]=se;if(H)for(S=0;S<z;S++)ve[S]=D.line.width[S];else for(se=D.line.width,S=0;S<z;S++)ve[S]=se;j.sizeAvg=de}else j.size=oe(D&&D.size||10),j.borderSizes=oe(D.line.width);return j}function i(I,P,S){var E=P.marker,z={};return S&&(S.marker&&S.marker.symbol?z=c(0,e.extendFlat({},E,S.marker)):S.marker&&(S.marker.size&&(z.size=S.marker.size),S.marker.color&&(z.colors=S.marker.color),S.marker.opacity!==void 0&&(z.opacity=S.marker.opacity))),z}function x(I,P,S){var E={};if(!S)return E;if(S.textfont){var z={opacity:1,text:P.text,texttemplate:P.texttemplate,textposition:P.textposition,textfont:e.extendFlat({},P.textfont)};S.textfont&&e.extendFlat(z.textfont,S.textfont),E=p(I,z)}return E}function f(I,P,S){var E={capSize:2*P.width*S,lineWidth:P.thickness*S,color:P.color};return P.copy_ystyle&&(E=I.error_y),E}var _=s.SYMBOL_SDF_SIZE,b=s.SYMBOL_SIZE,T=s.SYMBOL_STROKE,k={},L=t.symbolFuncs[0](.05*b);function A(I,P){var S,E,z=I.mx;if(z==="circle")return null;var D=t.symbolNumber(z),j=t.symbolFuncs[D%100],V=!!t.symbolNoDot[D%100],Z=!!t.symbolNoFill[D%100],Q=u.isDotSymbol(z);if(I.ma&&(z+="_"+I.ma),k[z])return k[z];var K=t.getMarkerAngle(I,P);return S=Q&&!V?j(1.1*b,K)+L:j(b,K),E=v(S,{w:_,h:_,viewBox:[-b,-b,b,b],stroke:Z?T:-T}),k[z]=E,E||null}G.exports={style:function(I,P){var S,E={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},z=I._context.plotGlPixelRatio;if(P.visible!==!0)return E;if(r.hasText(P)&&(E.text=p(I,P),E.textSel=x(I,P,P.selected),E.textUnsel=x(I,P,P.unselected)),r.hasMarkers(P)&&(E.marker=c(I,P),E.markerSel=i(I,P,P.selected),E.markerUnsel=i(I,P,P.unselected),!P.unselected&&e.isArrayOrTypedArray(P.marker.opacity))){var D=P.marker.opacity;for(E.markerUnsel.opacity=new Array(D.length),S=0;S<D.length;S++)E.markerUnsel.opacity[S]=h*D[S]}if(r.hasLines(P)){E.line={overlay:!0,thickness:P.line.width*z,color:P.line.color,opacity:P.opacity};var j=(s.DASHES[P.line.dash]||[1]).slice();for(S=0;S<j.length;++S)j[S]*=P.line.width*z;E.line.dashes=j}return P.error_x&&P.error_x.visible&&(E.errorX=f(P,P.error_x,z)),P.error_y&&P.error_y.visible&&(E.errorY=f(P,P.error_y,z)),P.fill&&P.fill!=="none"&&(E.fill={closed:!0,fill:P.fillcolor,thickness:0}),E},markerStyle:c,markerSelection:i,linePositions:function(I,P,S){var E,z,D=S.length,j=D/2;if(r.hasLines(P)&&j)if(P.line.shape==="hv"){for(E=[],z=0;z<j-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z+2],S[2*z+1]));E.push(S[D-2],S[D-1])}else if(P.line.shape==="hvh"){for(E=[],z=0;z<j-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var V=(S[2*z]+S[2*z+2])/2;E.push(S[2*z],S[2*z+1],V,S[2*z+1],V,S[2*z+3])}E.push(S[D-2],S[D-1])}else if(P.line.shape==="vhv"){for(E=[],z=0;z<j-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var Z=(S[2*z+1]+S[2*z+3])/2;E.push(S[2*z],S[2*z+1],S[2*z],Z,S[2*z+2],Z)}E.push(S[D-2],S[D-1])}else if(P.line.shape==="vh"){for(E=[],z=0;z<j-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+3]));E.push(S[D-2],S[D-1])}else E=S;var Q=!1;for(z=0;z<E.length;z++)if(isNaN(E[z])){Q=!0;break}var K=Q||E.length>s.TOO_MANY_POINTS||r.hasMarkers(P)?"rect":"round";if(Q&&P.connectgaps){var $=E[0],ne=E[1];for(z=0;z<E.length;z+=2)isNaN(E[z])||isNaN(E[z+1])?(E[z]=$,E[z+1]=ne):($=E[z],ne=E[z+1])}return{join:K,positions:E}},errorBarPositions:function(I,P,S,E,z){var D=y.getComponentMethod("errorbars","makeComputeError"),j=n.getFromId(I,P.xaxis,"x"),V=n.getFromId(I,P.yaxis,"y"),Z=S.length/2,Q={};function K($,ne){var H=ne._id.charAt(0),N=P["error_"+H];if(N&&N.visible&&(ne.type==="linear"||ne.type==="log")){for(var U=D(N),te={x:0,y:1}[H],B={x:[0,1,2,3],y:[2,3,0,1]}[H],X=new Float64Array(4*Z),J=1/0,ee=-1/0,re=0,se=0;re<Z;re++,se+=4){var oe=$[re];if(d(oe)){var de=S[2*re+te],ce=U(oe,re),ve=ce[0],Ae=ce[1];if(d(ve)&&d(Ae)){var fe=oe-ve,me=oe+Ae;X[se+B[0]]=de-ne.c2l(fe),X[se+B[1]]=ne.c2l(me)-de,X[se+B[2]]=0,X[se+B[3]]=0,J=Math.min(J,oe-ve),ee=Math.max(ee,oe+Ae)}}}Q[H]={positions:S,errors:X,_bnds:[J,ee]}}}return K(E,j),K(z,V),Q},textPosition:function(I,P,S,E){var z,D=P._length,j={};if(r.hasMarkers(P)){var V=S.font,Z=S.align,Q=S.baseline;for(j.offset=new Array(D),z=0;z<D;z++){var K=E.sizes?E.sizes[z]:E.size,$=Array.isArray(V)?V[z].size:V.size,ne=Array.isArray(Z)?Z.length>1?Z[z]:Z[0]:Z,H=Array.isArray(Q)?Q.length>1?Q[z]:Q[0]:Q,N=l[ne],U=l[H],te=K?K/.8+1:0,B=-U*te-.5*U;j.offset[z]=[N*te/$,B/$]}}return j}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(m,G,W){var d=m("../../lib"),v=m("../../registry"),w=m("./helpers"),y=m("./attributes"),e=m("../scatter/constants"),t=m("../scatter/subtypes"),n=m("../scatter/xy_defaults"),a=m("../scatter/period_defaults"),r=m("../scatter/marker_defaults"),g=m("../scatter/line_defaults"),u=m("../scatter/fillcolor_defaults"),s=m("../scatter/text_defaults");G.exports=function(h,l,o,p){function c(L,A){return d.coerce(h,l,y,L,A)}var i=!!h.marker&&w.isOpenSymbol(h.marker.symbol),x=t.isBubble(h),f=n(h,l,p,c);if(f){a(h,l,p,c),c("xhoverformat"),c("yhoverformat");var _=f<e.PTS_LINESONLY?"lines+markers":"lines";c("text"),c("hovertext"),c("hovertemplate"),c("mode",_),t.hasLines(l)&&(c("connectgaps"),g(h,l,o,p,c),c("line.shape")),t.hasMarkers(l)&&(r(h,l,o,p,c,{noAngleRef:!0,noStandOff:!0}),c("marker.line.width",i||x?1:0)),t.hasText(l)&&(c("texttemplate"),s(h,l,p,c));var b=(l.line||{}).color,T=(l.marker||{}).color;c("fill"),l.fill!=="none"&&u(h,l,o,c);var k=v.getComponentMethod("errorbars","supplyDefaults");k(h,l,b||T||o,{axis:"y"}),k(h,l,b||T||o,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(l,c)}else l.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../../constants/interactions").DESELECTDIM;G.exports={styleTextSelection:function(y){var e,t,n=y[0],a=n.trace,r=n.t,g=r._scene,u=r.index,s=g.selectBatch[u],h=g.unselectBatch[u],l=g.textOptions[u],o=g.textSelectedOptions[u]||{},p=g.textUnselectedOptions[u]||{},c=d.extendFlat({},l);if(s.length||h.length){var i=o.color,x=p.color,f=l.color,_=Array.isArray(f);for(c.color=new Array(a._length),e=0;e<s.length;e++)t=s[e],c.color[t]=i||(_?f[t]:f);for(e=0;e<h.length;e++){t=h[e];var b=_?f[t]:f;c.color[t]=x||(i?b:v.addOpacity(b,w))}}g.glText[u].update(c)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(m,G,W){var d=m("../scatter/format_labels");G.exports=function(v,w,y){var e=v.i;return"x"in v||(v.x=w._x[e]),"y"in v||(v.y=w._y[e]),d(v,w,y)}},{"../scatter/format_labels":945}],996:[function(m,G,W){var d=m("./constants");W.isOpenSymbol=function(v){return typeof v=="string"?d.OPEN_RE.test(v):v%200>100},W.isDotSymbol=function(v){return typeof v=="string"?d.DOT_RE.test(v):v>200}},{"./constants":991}],997:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../scatter/get_trace_color");function y(e,t,n,a){var r=e.xa,g=e.ya,u=e.distance,s=e.dxy,h=e.index,l={pointNumber:h,x:t[h],y:n[h]};l.tx=Array.isArray(a.text)?a.text[h]:a.text,l.htx=Array.isArray(a.hovertext)?a.hovertext[h]:a.hovertext,l.data=Array.isArray(a.customdata)?a.customdata[h]:a.customdata,l.tp=Array.isArray(a.textposition)?a.textposition[h]:a.textposition;var o=a.textfont;o&&(l.ts=v.isArrayOrTypedArray(o.size)?o.size[h]:o.size,l.tc=Array.isArray(o.color)?o.color[h]:o.color,l.tf=Array.isArray(o.family)?o.family[h]:o.family);var p=a.marker;p&&(l.ms=v.isArrayOrTypedArray(p.size)?p.size[h]:p.size,l.mo=v.isArrayOrTypedArray(p.opacity)?p.opacity[h]:p.opacity,l.mx=v.isArrayOrTypedArray(p.symbol)?p.symbol[h]:p.symbol,l.ma=v.isArrayOrTypedArray(p.angle)?p.angle[h]:p.angle,l.mc=v.isArrayOrTypedArray(p.color)?p.color[h]:p.color);var c=p&&p.line;c&&(l.mlc=Array.isArray(c.color)?c.color[h]:c.color,l.mlw=v.isArrayOrTypedArray(c.width)?c.width[h]:c.width);var i=p&&p.gradient;i&&i.type!=="none"&&(l.mgt=Array.isArray(i.type)?i.type[h]:i.type,l.mgc=Array.isArray(i.color)?i.color[h]:i.color);var x=r.c2p(l.x,!0),f=g.c2p(l.y,!0),_=l.mrc||1,b=a.hoverlabel;b&&(l.hbg=Array.isArray(b.bgcolor)?b.bgcolor[h]:b.bgcolor,l.hbc=Array.isArray(b.bordercolor)?b.bordercolor[h]:b.bordercolor,l.hts=v.isArrayOrTypedArray(b.font.size)?b.font.size[h]:b.font.size,l.htc=Array.isArray(b.font.color)?b.font.color[h]:b.font.color,l.htf=Array.isArray(b.font.family)?b.font.family[h]:b.font.family,l.hnl=v.isArrayOrTypedArray(b.namelength)?b.namelength[h]:b.namelength);var T=a.hoverinfo;T&&(l.hi=Array.isArray(T)?T[h]:T);var k=a.hovertemplate;k&&(l.ht=Array.isArray(k)?k[h]:k);var L={};L[e.index]=l;var A=a._origX,I=a._origY,P=v.extendFlat({},e,{color:w(a,l),x0:x-_,x1:x+_,xLabelVal:A?A[h]:l.x,y0:f-_,y1:f+_,yLabelVal:I?I[h]:l.y,cd:L,distance:u,spikeDistance:s,hovertemplate:l.ht});return l.htx?P.text=l.htx:l.tx?P.text=l.tx:a.text&&(P.text=a.text),v.fillText(l,a,P),d.getComponentMethod("errorbars","hoverInfo")(l,a,P),P}G.exports={hoverPoints:function(e,t,n,a){var r,g,u,s,h,l,o,p,c,i,x=e.cd,f=x[0].t,_=x[0].trace,b=e.xa,T=e.ya,k=f.x,L=f.y,A=b.c2p(t),I=T.c2p(n),P=e.distance;if(f.tree){var S=b.p2c(A-P),E=b.p2c(A+P),z=T.p2c(I-P),D=T.p2c(I+P);r=a==="x"?f.tree.range(Math.min(S,E),Math.min(T._rl[0],T._rl[1]),Math.max(S,E),Math.max(T._rl[0],T._rl[1])):f.tree.range(Math.min(S,E),Math.min(z,D),Math.max(S,E),Math.max(z,D))}else r=f.ids;var j=P;if(a==="x"){var V=!!_.xperiodalignment,Z=!!_.yperiodalignment;for(l=0;l<r.length;l++){if(s=k[g=r[l]],o=Math.abs(b.c2p(s)-A),V){var Q=b.c2p(_._xStarts[g]),K=b.c2p(_._xEnds[g]);o=A>=Math.min(Q,K)&&A<=Math.max(Q,K)?0:1/0}if(o<j){if(j=o,h=L[g],p=T.c2p(h)-I,Z){var $=T.c2p(_._yStarts[g]),ne=T.c2p(_._yEnds[g]);p=I>=Math.min($,ne)&&I<=Math.max($,ne)?0:1/0}i=Math.sqrt(o*o+p*p),u=r[l]}}}else for(l=r.length-1;l>-1;l--)s=k[g=r[l]],h=L[g],o=b.c2p(s)-A,p=T.c2p(h)-I,(c=Math.sqrt(o*o+p*p))<j&&(j=i=c,u=g);return e.index=u,e.distance=j,e.dxy=i,u===void 0?[e]:[y(e,k,L,_)]},calcHover:y}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(m,G,W){arguments[4][905][0].apply(W,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(m,G,W){var d=m("regl-scatter2d"),v=m("regl-line2d"),w=m("regl-error2d"),y=m("gl-text"),e=m("../../lib"),t=m("../../components/dragelement/helpers").selectMode,n=m("../../lib/prepare_regl"),a=m("../scatter/subtypes"),r=m("../scatter/link_traces"),g=m("./edit_style").styleTextSelection,u={};function s(h,l,o,p){var c=h._size,i=h.width*p,x=h.height*p,f=c.l*p,_=c.b*p,b=c.r*p,T=c.t*p,k=c.w*p,L=c.h*p;return[f+l.domain[0]*k,_+o.domain[0]*L,i-b-(1-l.domain[1])*k,x-T-(1-o.domain[1])*L]}(G.exports=function(h,l,o){if(o.length){var p,c,i=h._fullLayout,x=l._scene,f=l.xaxis,_=l.yaxis;if(x)if(n(h,["ANGLE_instanced_arrays","OES_element_index_uint"],u)){var b=x.count,T=i._glcanvas.data()[0].regl;if(r(h,l,o),x.dirty){if(x.error2d===!0&&(x.error2d=w(T)),x.line2d===!0&&(x.line2d=v(T)),x.scatter2d===!0&&(x.scatter2d=d(T)),x.fill2d===!0&&(x.fill2d=v(T)),x.glText===!0)for(x.glText=new Array(b),p=0;p<b;p++)x.glText[p]=new y(T);if(x.glText){if(b>x.glText.length){var k=b-x.glText.length;for(p=0;p<k;p++)x.glText.push(new y(T))}else if(b<x.glText.length){var L=x.glText.length-b;x.glText.splice(b,L).forEach(function(X){X.destroy()})}for(p=0;p<b;p++)x.glText[p].update(x.textOptions[p])}if(x.line2d&&(x.line2d.update(x.lineOptions),x.lineOptions=x.lineOptions.map(function(X){if(X&&X.positions){for(var J=X.positions,ee=0;ee<J.length&&(isNaN(J[ee])||isNaN(J[ee+1]));)ee+=2;for(var re=J.length-2;re>ee&&(isNaN(J[re])||isNaN(J[re+1]));)re-=2;X.positions=J.slice(ee,re+2)}return X}),x.line2d.update(x.lineOptions)),x.error2d){var A=(x.errorXOptions||[]).concat(x.errorYOptions||[]);x.error2d.update(A)}x.scatter2d&&x.scatter2d.update(x.markerOptions),x.fillOrder=e.repeat(null,b),x.fill2d&&(x.fillOptions=x.fillOptions.map(function(X,J){var ee=o[J];if(X&&ee&&ee[0]&&ee[0].trace){var re,se,oe=ee[0],de=oe.trace,ce=oe.t,ve=x.lineOptions[J],Ae=[];de._ownfill&&Ae.push(J),de._nexttrace&&Ae.push(J+1),Ae.length&&(x.fillOrder[J]=Ae);var fe,me,_e=[],le=ve&&ve.positions||ce.positions;if(de.fill==="tozeroy"){for(fe=0;fe<le.length&&isNaN(le[fe+1]);)fe+=2;for(me=le.length-2;me>fe&&isNaN(le[me+1]);)me-=2;le[fe+1]!==0&&(_e=[le[fe],0]),_e=_e.concat(le.slice(fe,me+2)),le[me+1]!==0&&(_e=_e.concat([le[me],0]))}else if(de.fill==="tozerox"){for(fe=0;fe<le.length&&isNaN(le[fe]);)fe+=2;for(me=le.length-2;me>fe&&isNaN(le[me]);)me-=2;le[fe]!==0&&(_e=[0,le[fe+1]]),_e=_e.concat(le.slice(fe,me+2)),le[me]!==0&&(_e=_e.concat([0,le[me+1]]))}else if(de.fill==="toself"||de.fill==="tonext"){for(_e=[],re=0,X.splitNull=!0,se=0;se<le.length;se+=2)(isNaN(le[se])||isNaN(le[se+1]))&&((_e=_e.concat(le.slice(re,se))).push(le[re],le[re+1]),_e.push(null,null),re=se+2);_e=_e.concat(le.slice(re)),re&&_e.push(le[re],le[re+1])}else{var ge=de._nexttrace;if(ge){var Te=x.lineOptions[J+1];if(Te){var Se=Te.positions;if(de.fill==="tonexty"){for(_e=le.slice(),J=Math.floor(Se.length/2);J--;){var Me=Se[2*J],ze=Se[2*J+1];isNaN(Me)||isNaN(ze)||_e.push(Me,ze)}X.fill=ge.fillcolor}}}}if(de._prevtrace&&de._prevtrace.fill==="tonext"){var Oe=x.lineOptions[J-1].positions,De=_e.length/2,Xe=[re=De];for(se=0;se<Oe.length;se+=2)(isNaN(Oe[se])||isNaN(Oe[se+1]))&&(Xe.push(se/2+De+1),re=se+2);_e=_e.concat(Oe),X.hole=Xe}return X.fillmode=de.fill,X.opacity=de.opacity,X.positions=_e,X}}),x.fill2d.update(x.fillOptions))}var I=i.dragmode,P=t(I),S=i.clickmode.indexOf("select")>-1;for(p=0;p<b;p++){var E=o[p][0],z=E.trace,D=E.t,j=D.index,V=z._length,Z=D.x,Q=D.y;if(z.selectedpoints||P||S){if(P||(P=!0),z.selectedpoints){var K=x.selectBatch[j]=e.selIndices2selPoints(z),$={};for(c=0;c<K.length;c++)$[K[c]]=1;var ne=[];for(c=0;c<V;c++)$[c]||ne.push(c);x.unselectBatch[j]=ne}var H=D.xpx=new Array(V),N=D.ypx=new Array(V);for(c=0;c<V;c++)H[c]=f.c2p(Z[c]),N[c]=_.c2p(Q[c])}else D.xpx=D.ypx=null}if(P){if(x.select2d||(x.select2d=d(i._glcanvas.data()[1].regl)),x.scatter2d){var U=new Array(b);for(p=0;p<b;p++)U[p]=x.selectBatch[p].length||x.unselectBatch[p].length?x.markerUnselectedOptions[p]:{};x.scatter2d.update(U)}x.select2d&&(x.select2d.update(x.markerOptions),x.select2d.update(x.markerSelectedOptions)),x.glText&&o.forEach(function(X){var J=((X||[])[0]||{}).trace||{};a.hasText(J)&&g(X)})}else x.scatter2d&&x.scatter2d.update(x.markerOptions);var te={viewport:s(i,f,_,h._context.plotGlPixelRatio),range:[(f._rl||f.range)[0],(_._rl||_.range)[0],(f._rl||f.range)[1],(_._rl||_.range)[1]]},B=e.repeat(te,x.count);x.fill2d&&x.fill2d.update(B),x.line2d&&x.line2d.update(B),x.error2d&&x.error2d.update(B.concat(B)),x.scatter2d&&x.scatter2d.update(B),x.select2d&&x.select2d.update(B),x.glText&&x.glText.forEach(function(X){X.update(te)})}else x.init()}}).reglPrecompiled=u},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){var y=w._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},t={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return w._scene||((y=w._scene={}).init=function(){d.extendFlat(y,t,e)},y.init(),y.update=function(n){var a=d.repeat(n,y.count);if(y.fill2d&&y.fill2d.update(a),y.scatter2d&&y.scatter2d.update(a),y.line2d&&y.line2d.update(a),y.error2d&&y.error2d.update(a.concat(a)),y.select2d&&y.select2d.update(a),y.glText)for(var r=0;r<y.count;r++)y.glText[r].update(n)},y.draw=function(){for(var n=y.count,a=y.fill2d,r=y.error2d,g=y.line2d,u=y.scatter2d,s=y.glText,h=y.select2d,l=y.selectBatch,o=y.unselectBatch,p=0;p<n;p++){if(a&&y.fillOrder[p]&&a.draw(y.fillOrder[p]),g&&y.lineOptions[p]&&g.draw(p),r&&(y.errorXOptions[p]&&r.draw(p),y.errorYOptions[p]&&r.draw(p+n)),u&&y.markerOptions[p])if(o[p].length){var c=d.repeat([],y.count);c[p]=o[p],u.draw(c)}else l[p].length||u.draw(p);s[p]&&y.textOptions[p]&&s[p].render()}h&&h.draw(l),y.dirty=!1},y.destroy=function(){y.fill2d&&y.fill2d.destroy&&y.fill2d.destroy(),y.scatter2d&&y.scatter2d.destroy&&y.scatter2d.destroy(),y.error2d&&y.error2d.destroy&&y.error2d.destroy(),y.line2d&&y.line2d.destroy&&y.line2d.destroy(),y.select2d&&y.select2d.destroy&&y.select2d.destroy(),y.glText&&y.glText.forEach(function(n){n.destroy&&n.destroy()}),y.lineOptions=null,y.fillOptions=null,y.markerOptions=null,y.markerSelectedOptions=null,y.markerUnselectedOptions=null,y.errorXOptions=null,y.errorYOptions=null,y.textOptions=null,y.textSelectedOptions=null,y.textUnselectedOptions=null,y.selectBatch=null,y.unselectBatch=null,w._scene=null}),y.dirty||d.extendFlat(y,e),y}},{"../../lib":515}],1001:[function(m,G,W){var d=m("../scatter/subtypes"),v=m("./edit_style").styleTextSelection;G.exports=function(w,y){var e=w.cd,t=w.xaxis,n=w.yaxis,a=[],r=e[0].trace,g=e[0].t,u=r._length,s=g.x,h=g.y,l=g._scene,o=g.index;if(!l)return a;var p=d.hasText(r),c=d.hasMarkers(r),i=!c&&!p;if(r.visible!==!0||i)return a;var x=[],f=[];if(y!==!1&&!y.degenerate)for(var _=0;_<u;_++)y.contains([g.xpx[_],g.ypx[_]],!1,_,w)?(x.push(_),a.push({pointNumber:_,x:t.c2d(s[_]),y:n.c2d(h[_])})):f.push(_);if(c){var b=l.scatter2d;if(x.length||f.length){if(!l.selectBatch[o].length&&!l.unselectBatch[o].length){var T=new Array(l.count);T[o]=l.markerUnselectedOptions[o],b.update.apply(b,T)}}else{var k=new Array(l.count);k[o]=l.markerOptions[o],b.update.apply(b,k)}}return l.selectBatch[o]=x,l.unselectBatch[o]=f,p&&v(e),a}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scattergeo/attributes"),y=m("../scatter/attributes"),e=m("../../plots/mapbox/layout_attributes"),t=m("../../plots/attributes"),n=m("../../components/colorscale/attributes"),a=m("../../lib/extend").extendFlat,r=m("../../plot_api/edit_types").overrideAll,g=m("../../plots/mapbox/layout_attributes"),u=w.line,s=w.marker;G.exports=r({lon:w.lon,lat:w.lat,cluster:{enabled:{valType:"boolean"},maxzoom:a({},g.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:a({},s.opacity,{dflt:1})},mode:a({},y.mode,{dflt:"markers"}),text:a({},y.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},y.hovertext,{}),line:{color:u.color,width:u.width},connectgaps:y.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode},n("marker")),fill:w.fill,fillcolor:y.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:y.selected.marker},unselected:{marker:y.unselected.marker},hoverinfo:a({},t.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM,y=m("../../lib/geojson_utils"),e=m("../../components/colorscale"),t=m("../../components/drawing"),n=m("../scatter/make_bubble_size_func"),a=m("../scatter/subtypes"),r=m("../../plots/mapbox/convert_text_opts"),g=m("../../components/fx/helpers").appendArrayPointValue,u=m("../../lib/svg_text_utils").NEWLINES,s=m("../../lib/svg_text_utils").BR_TAG_ALL;function h(i){return{type:i,geojson:y.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function l(i,x){return v.isArrayOrTypedArray(i)?x?function(f){return d(i[f])?+i[f]:0}:function(f){return i[f]}:i?function(){return i}:o}function o(){return""}function p(i){return i[0]===w}function c(i,x){var f;if(v.isArrayOrTypedArray(i)&&v.isArrayOrTypedArray(x)){f=["step",["get","point_count"],i[0]];for(var _=1;_<i.length;_++)f.push(x[_-1],i[_])}else f=i;return f}G.exports=function(i,x){var f,_=x[0].trace,b=_.visible===!0&&_._length!==0,T=_.fill!=="none",k=a.hasLines(_),L=a.hasMarkers(_),A=a.hasText(_),I=L&&_.marker.symbol==="circle",P=L&&_.marker.symbol!=="circle",S=_.cluster&&_.cluster.enabled,E=h("fill"),z=h("line"),D=h("circle"),j=h("symbol"),V={fill:E,line:z,circle:D,symbol:j};if(!b)return V;if((T||k)&&(f=y.calcTraceToLineCoords(x)),T&&(E.geojson=y.makePolygon(f),E.layout.visibility="visible",v.extendFlat(E.paint,{"fill-color":_.fillcolor})),k&&(z.geojson=y.makeLine(f),z.layout.visibility="visible",v.extendFlat(z.paint,{"line-width":_.line.width,"line-color":_.line.color,"line-opacity":_.opacity})),I){var Z=function($){var ne,H,N,U,te=$[0].trace,B=te.marker,X=te.selectedpoints,J=v.isArrayOrTypedArray(B.color),ee=v.isArrayOrTypedArray(B.size),re=v.isArrayOrTypedArray(B.opacity);function se(_e){return te.opacity*_e}J&&(H=e.hasColorscale(te,"marker")?e.makeColorScaleFuncFromTrace(B):v.identity),ee&&(N=n(te)),re&&(U=function(_e){return se(d(_e)?+v.constrain(_e,0,1):0)});var oe,de=[];for(ne=0;ne<$.length;ne++){var ce=$[ne],ve=ce.lonlat;if(!p(ve)){var Ae={};H&&(Ae.mcc=ce.mcc=H(ce.mc)),N&&(Ae.mrc=ce.mrc=N(ce.ms)),U&&(Ae.mo=U(ce.mo)),X&&(Ae.selected=ce.selected||0),de.push({type:"Feature",id:ne+1,geometry:{type:"Point",coordinates:ve},properties:Ae})}}if(X)for(oe=t.makeSelectedPointStyleFns(te),ne=0;ne<de.length;ne++){var fe=de[ne].properties;oe.selectedOpacityFn&&(fe.mo=se(oe.selectedOpacityFn(fe))),oe.selectedColorFn&&(fe.mcc=oe.selectedColorFn(fe)),oe.selectedSizeFn&&(fe.mrc=oe.selectedSizeFn(fe))}return{geojson:{type:"FeatureCollection",features:de},mcc:J||oe&&oe.selectedColorFn?{type:"identity",property:"mcc"}:B.color,mrc:ee||oe&&oe.selectedSizeFn?{type:"identity",property:"mrc"}:(me=B.size,me/2),mo:re||oe&&oe.selectedOpacityFn?{type:"identity",property:"mo"}:se(B.opacity)};var me}(x);D.geojson=Z.geojson,D.layout.visibility="visible",S&&(D.filter=["!",["has","point_count"]],V.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":c(_.cluster.color,_.cluster.step),"circle-radius":c(_.cluster.size,_.cluster.step),"circle-opacity":c(_.cluster.opacity,_.cluster.step)}},V.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),v.extendFlat(D.paint,{"circle-color":Z.mcc,"circle-radius":Z.mrc,"circle-opacity":Z.mo})}if(I&&S&&(D.filter=["!",["has","point_count"]]),(P||A)&&(j.geojson=function($,ne){for(var H=ne._fullLayout,N=$[0].trace,U=N.marker||{},te=U.symbol,B=U.angle,X=te!=="circle"?l(te):o,J=B!=="auto"?l(B,!0):o,ee=a.hasText(N)?l(N.text):o,re=[],se=0;se<$.length;se++){var oe=$[se];if(!p(oe.lonlat)){var de,ce=N.texttemplate;if(ce){var ve=Array.isArray(ce)?ce[se]||"":ce,Ae=N._module.formatLabels(oe,N,H),fe={};g(fe,N,oe.i);var me=N._meta||{};de=v.texttemplateString(ve,Ae,H._d3locale,fe,oe,me)}else de=ee(se);de&&(de=de.replace(u,"").replace(s,`
`)),re.push({type:"Feature",geometry:{type:"Point",coordinates:oe.lonlat},properties:{symbol:X(se),angle:J(se),text:de}})}}return{type:"FeatureCollection",features:re}}(x,i),v.extendFlat(j.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),P&&(v.extendFlat(j.layout,{"icon-size":_.marker.size/10}),"angle"in _.marker&&_.marker.angle!=="auto"&&v.extendFlat(j.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),j.layout["icon-allow-overlap"]=_.marker.allowoverlap,v.extendFlat(j.paint,{"icon-opacity":_.opacity*_.marker.opacity,"icon-color":_.marker.color})),A)){var Q=(_.marker||{}).size,K=r(_.textposition,Q);v.extendFlat(j.layout,{"text-size":_.textfont.size,"text-anchor":K.anchor,"text-offset":K.offset}),v.extendFlat(j.paint,{"text-color":_.textfont.color,"text-opacity":_.opacity})}return V}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/text_defaults"),t=m("../scatter/fillcolor_defaults"),n=m("./attributes");G.exports=function(a,r,g,u){function s(f,_){return d.coerce(a,r,n,f,_)}function h(f,_){return d.coerce2(a,r,n,f,_)}if(function(f,_,b){var T=b("lon")||[],k=b("lat")||[],L=Math.min(T.length,k.length);return _._length=L,L}(0,r,s)){if(s("text"),s("texttemplate"),s("hovertext"),s("hovertemplate"),s("mode"),s("below"),v.hasLines(r)&&(y(a,r,g,u,s,{noDash:!0}),s("connectgaps")),v.hasMarkers(r)){w(a,r,g,u,s,{noLine:!0,noAngle:!0}),s("marker.allowoverlap"),s("marker.angle");var l=r.marker;l.symbol!=="circle"&&(d.isArrayOrTypedArray(l.size)&&(l.size=l.size[0]),d.isArrayOrTypedArray(l.color)&&(l.color=l.color[0]))}var o=h("cluster.maxzoom"),p=h("cluster.step"),c=h("cluster.color",r.marker&&r.marker.color||g),i=h("cluster.size"),x=h("cluster.opacity");s("cluster.enabled",o!==!1||p!==!1||c!==!1||i!==!1||x!==!1),v.hasText(r)&&e(a,r,u,s,{noSelect:!0}),s("fill"),r.fill!=="none"&&t(a,r,g,s),d.coerceSelectionMarkerOpacity(r,s)}else r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(m,G,W){G.exports=function(d,v){return d.lon=v.lon,d.lat=v.lat,d}},{}],1006:[function(m,G,W){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot.mockAxis,n=v.lonlat;return e.lonLabel=d.tickText(t,t.c2l(n[0]),!0).text,e.latLabel=d.tickText(t,t.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(m,G,W){var d=m("../../components/fx"),v=m("../../lib"),w=m("../scatter/get_trace_color"),y=v.fillText,e=m("../../constants/numerical").BADNUM,t=m("../../plots/mapbox/constants").traceLayerPrefix;function n(a,r,g){if(!a.hovertemplate){var u=(r.hi||a.hoverinfo).split("+"),s=u.indexOf("all")!==-1,h=u.indexOf("lon")!==-1,l=u.indexOf("lat")!==-1,o=r.lonlat,p=[];return s||h&&l?p.push("("+c(o[1])+", "+c(o[0])+")"):h?p.push(g.lon+c(o[0])):l&&p.push(g.lat+c(o[1])),(s||u.indexOf("text")!==-1)&&y(r,a,p),p.join("<br>")}function c(i){return i+"\xB0"}}G.exports={hoverPoints:function(a,r,g){var u=a.cd,s=u[0].trace,h=a.xa,l=a.ya,o=a.subplot,p=[],c=t+s.uid+"-circle",i=s.cluster&&s.cluster.enabled;if(i){var x=o.map.queryRenderedFeatures(null,{layers:[c]});p=x.map(function(E){return E.id})}var f=360*(r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360)),_=r-f;if(d.getClosest(u,function(E){var z=E.lonlat;if(z[0]===e||i&&p.indexOf(E.i+1)===-1)return 1/0;var D=v.modHalf(z[0],360),j=z[1],V=o.project([D,j]),Z=V.x-h.c2p([_,j]),Q=V.y-l.c2p([D,g]),K=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(Z*Z+Q*Q)-K,1-3/K)},a),a.index!==!1){var b=u[a.index],T=b.lonlat,k=[v.modHalf(T[0],360)+f,T[1]],L=h.c2p(k),A=l.c2p(k),I=b.mrc||1;a.x0=L-I,a.x1=L+I,a.y0=A-I,a.y1=A+I;var P={};P[s.subplot]={_subplot:o};var S=s._module.formatLabels(b,s,P);return a.lonLabel=S.lonLabel,a.latLabel=S.latLabel,a.color=w(s,b),a.extraText=n(s,b,u[0].t.labels),a.hovertemplate=s.hovertemplate,[a]}},getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("../scattergeo/calc"),plot:m("./plot"),hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),styleOnSelect:function(d,v){v&&v[0].trace._glTrace.update(v)},moduleType:"trace",name:"scattermapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(m,G,W){var d=m("../../lib"),v=m("./convert"),w=m("../../plots/mapbox/constants").traceLayerPrefix,y={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,a,r){this.type="scattermapbox",this.subplot=n,this.uid=a,this.clusterEnabled=r,this.sourceIds={fill:"source-"+a+"-fill",line:"source-"+a+"-line",circle:"source-"+a+"-circle",symbol:"source-"+a+"-symbol",cluster:"source-"+a+"-circle",clusterCount:"source-"+a+"-circle"},this.layerIds={fill:w+a+"-fill",line:w+a+"-line",circle:w+a+"-circle",symbol:w+a+"-symbol",cluster:w+a+"-cluster",clusterCount:w+a+"-cluster-count"},this.below=null}var t=e.prototype;t.addSource=function(n,a,r){var g={type:"geojson",data:a.geojson};r&&r.enabled&&d.extendFlat(g,{cluster:!0,clusterMaxZoom:r.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],g)},t.setSourceData=function(n,a){this.subplot.map.getSource(this.sourceIds[n]).setData(a.geojson)},t.addLayer=function(n,a,r){var g={type:a.type,id:this.layerIds[n],source:this.sourceIds[n],layout:a.layout,paint:a.paint};a.filter&&(g.filter=a.filter),this.subplot.addLayer(g,r)},t.update=function(n){var a,r,g,u=n[0].trace,s=this.subplot,h=s.map,l=v(s.gd,n),o=s.belowLookup["trace-"+this.uid],p=!(!u.cluster||!u.cluster.enabled),c=!!this.clusterEnabled;if(o!==this.below){var i=y.nonCluster;for(a=i.length-1;a>=0;a--)r=i[a],h.removeLayer(this.layerIds[r]);for(a=0;a<i.length;a++)g=l[r=i[a]],this.addLayer(r,g,o);this.below=o}else if(p&&!c){for(a=y.nonCluster.length-1;a>=0;a--)r=y.nonCluster[a],h.removeLayer(this.layerIds[r]),h.removeSource(this.sourceIds[r]);for(this.addSource("circle",l.circle,u.cluster),a=0;a<y.cluster.length;a++)g=l[r=y.cluster[a]],this.addLayer(r,g,o);this.clusterEnabled=p}else if(!p&&c){for(a=0;a<y.cluster.length;a++)r=y.cluster[a],h.removeLayer(this.layerIds[r]);for(h.removeSource(this.sourceIds.circle),a=0;a<y.nonCluster.length;a++)g=l[r=y.nonCluster[a]],this.addSource(r,g,u.cluster),this.addLayer(r,g,o);this.clusterEnabled=p}n[0].trace._glTrace=this},t.dispose=function(){for(var n=this.subplot.map,a=this.clusterEnabled?y.cluster:y.nonCluster,r=a.length-1;r>=0;r--){var g=a[r];n.removeLayer(this.layerIds[g]),n.removeSource(this.sourceIds[g])}},G.exports=function(n,a){var r,g,u,s=a[0].trace,h=s.cluster&&s.cluster.enabled,l=new e(n,s.uid,h),o=v(n.gd,a),p=l.below=n.belowLookup["trace-"+s.uid];if(h)for(l.addSource("circle",o.circle,s.cluster),r=0;r<y.cluster.length;r++)u=o[g=y.cluster[r]],l.addLayer(g,u,p);else for(r=0;r<y.nonCluster.length;r++)u=o[g=y.nonCluster[r]],l.addSource(g,u,s.cluster),l.addLayer(g,u,p);return a[0].trace._glTrace=l,l}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../../constants/numerical").BADNUM;G.exports=function(y,e){var t,n=y.cd,a=y.xaxis,r=y.yaxis,g=[],u=n[0].trace;if(!v.hasMarkers(u))return[];if(e===!1)for(t=0;t<n.length;t++)n[t].selected=0;else for(t=0;t<n.length;t++){var s=n[t],h=s.lonlat;if(h[0]!==w){var l=[d.modHalf(h[0],360),h[1]],o=[a.c2p(l),r.c2p(l)];e.contains(o,null,t,y)?(g.push({pointNumber:t,lon:h[0],lat:h[1]}),s.selected=1):s.selected=0}}return g}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("../scatter/attributes"),e=m("../../plots/attributes"),t=y.line;G.exports={mode:y.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:v({editType:"plot"},{keys:["r","theta","text"]}),hovertext:y.hovertext,line:{color:t.color,width:t.width,dash:t.dash,backoff:t.backoff,shape:w({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:w({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:w({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:w({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:y.hoveron,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/cartesian/axes"),y=m("../scatter/colorscale_calc"),e=m("../scatter/arrays_to_calcdata"),t=m("../scatter/calc_selection"),n=m("../scatter/calc").calcMarkerSize;G.exports=function(a,r){for(var g=a._fullLayout,u=r.subplot,s=g[u].radialaxis,h=g[u].angularaxis,l=s.makeCalcdata(r,"r"),o=h.makeCalcdata(r,"theta"),p=r._length,c=new Array(p),i=0;i<p;i++){var x=l[i],f=o[i],_=c[i]={};d(x)&&d(f)?(_.r=x,_.theta=f):_.r=v}var b=n(r,p);return r._extremes.x=w.findExtremes(s,l,{ppad:b}),y(a,r),e(c,r),t(c,r),c}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/line_shape_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),a=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");function g(u,s,h,l){var o,p=l("r"),c=l("theta");if(p)c?o=Math.min(p.length,c.length):(o=p.length,l("theta0"),l("dtheta"));else{if(!c)return 0;o=s.theta.length,l("r0"),l("dr")}return s._length=o,o}G.exports={handleRThetaDefaults:g,supplyDefaults:function(u,s,h,l){function o(i,x){return d.coerce(u,s,r,i,x)}var p=g(u,s,l,o);if(p){o("thetaunit"),o("mode",p<a?"lines+markers":"lines"),o("text"),o("hovertext"),s.hoveron!=="fills"&&o("hovertemplate"),v.hasLines(s)&&(y(u,s,h,l,o,{backoff:!0}),e(u,s,o),o("connectgaps")),v.hasMarkers(s)&&w(u,s,h,l,o,{gradient:!0}),v.hasText(s)&&(o("texttemplate"),t(u,s,l,o));var c=[];(v.hasMarkers(s)||v.hasText(s))&&(o("cliponaxis"),o("marker.maxdisplayed"),c.push("points")),o("fill"),s.fill!=="none"&&(n(u,s,h,o),v.hasLines(s)||e(u,s,o)),s.fill!=="tonext"&&s.fill!=="toself"||c.push("fills"),o("hoveron",c.join("+")||"points"),d.coerceSelectionMarkerOpacity(s,o)}else s.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes");G.exports=function(w,y,e){var t,n,a={},r=e[y.subplot]._subplot;r?(t=r.radialAxis,n=r.angularAxis):(t=(r=e[y.subplot]).radialaxis,n=r.angularaxis);var g=t.c2l(w.r);a.rLabel=v.tickText(t,g,!0).text;var u=n.thetaunit==="degrees"?d.rad2deg(w.theta):w.theta;return a.thetaLabel=v.tickText(n,u,!0).text,a}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(m,G,W){var d=m("../scatter/hover");function v(w,y,e,t){var n=e.radialAxis,a=e.angularAxis;n._hovertitle="r",a._hovertitle="\u03B8";var r={};r[y.subplot]={_subplot:e};var g=y._module.formatLabels(w,y,r);t.rLabel=g.rLabel,t.thetaLabel=g.thetaLabel;var u=w.hi||y.hoverinfo,s=[];function h(o,p){s.push(o._hovertitle+": "+p)}if(!y.hovertemplate){var l=u.split("+");l.indexOf("all")!==-1&&(l=["r","theta","text"]),l.indexOf("r")!==-1&&h(n,t.rLabel),l.indexOf("theta")!==-1&&h(a,t.thetaLabel),l.indexOf("text")!==-1&&t.text&&(s.push(t.text),delete t.text),t.extraText=s.join("<br>")}}G.exports={hoverPoints:function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var a=n[0];if(a.index===void 0)return n;var r=w.subplot,g=a.cd[a.index],u=a.trace;if(r.isPtInside(g))return a.xLabelVal=void 0,a.yLabelVal=void 0,v(g,u,r,a),a.hovertemplate=u.hovertemplate,n}},makeHoverPointText:v}},{"../scatter/hover":947}],1016:[function(m,G,W){G.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:m("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(m,G,W){var d=m("../scatter/plot"),v=m("../../constants/numerical").BADNUM;G.exports=function(w,y,e){for(var t=y.layers.frontplot.select("g.scatterlayer"),n=y.xaxis,a=y.yaxis,r={xaxis:n,yaxis:a,plot:y.framework,layerClipId:y._hasClipOnAxisFalse?y.clipIds.forTraces:null},g=y.radialAxis,u=y.angularAxis,s=0;s<e.length;s++)for(var h=e[s],l=0;l<h.length;l++){l===0&&(h[0].trace._xA=n,h[0].trace._yA=a);var o=h[l],p=o.r;if(p===v)o.x=o.y=v;else{var c=g.c2g(p),i=u.c2g(o.theta);o.x=c*Math.cos(i),o.y=c*Math.sin(i)}}d(w,r,e,t)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(m,G,W){var d=m("../scatterpolar/attributes"),v=m("../scattergl/attributes"),w=m("../../plots/template_attributes").texttemplateAttrs;G.exports={mode:d.mode,r:d.r,theta:d.theta,r0:d.r0,dr:d.dr,theta0:d.theta0,dtheta:d.dtheta,thetaunit:d.thetaunit,text:d.text,texttemplate:w({editType:"plot"},{keys:["r","theta","text"]}),hovertext:d.hovertext,hovertemplate:d.hovertemplate,line:v.line,connectgaps:v.connectgaps,marker:v.marker,fill:v.fill,fillcolor:v.fillcolor,textposition:v.textposition,textfont:v.textfont,hoverinfo:d.hoverinfo,selected:d.selected,unselected:d.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(m,G,W){G.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:m("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(m,G,W){var d=m("../scatter/colorscale_calc"),v=m("../scatter/calc").calcMarkerSize,w=m("../scattergl/convert"),y=m("../../plots/cartesian/axes"),e=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(t,n){var a=t._fullLayout,r=n.subplot,g=a[r].radialaxis,u=a[r].angularaxis,s=n._r=g.makeCalcdata(n,"r"),h=n._theta=u.makeCalcdata(n,"theta"),l=n._length,o={};l<s.length&&(s=s.slice(0,l)),l<h.length&&(h=h.slice(0,l)),o.r=s,o.theta=h,d(t,n);var p,c=o.opts=w.style(t,n);return l<e?p=v(n,l):c.marker&&(p=2*(c.marker.sizeAvg||Math.max(c.marker.size,3))),n._extremes.x=y.findExtremes(g,s,{ppad:p}),[{x:!1,y:!1,t:o,trace:n}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatterpolar/defaults").handleRThetaDefaults,y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),a=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");G.exports=function(g,u,s,h){function l(p,c){return d.coerce(g,u,r,p,c)}var o=w(g,u,h,l);o?(l("thetaunit"),l("mode",o<a?"lines+markers":"lines"),l("text"),l("hovertext"),u.hoveron!=="fills"&&l("hovertemplate"),v.hasLines(u)&&(e(g,u,s,h,l),l("connectgaps")),v.hasMarkers(u)&&y(g,u,s,h,l,{noAngleRef:!0,noStandOff:!0}),v.hasText(u)&&(l("texttemplate"),t(g,u,h,l)),l("fill"),u.fill!=="none"&&n(g,u,s,l),d.coerceSelectionMarkerOpacity(u,l)):u.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(m,G,W){var d=m("../scatterpolar/format_labels");G.exports=function(v,w,y){var e=v.i;return"r"in v||(v.r=w._r[e]),"theta"in v||(v.theta=w._theta[e]),d(v,w,y)}},{"../scatterpolar/format_labels":1014}],1023:[function(m,G,W){var d=m("../scattergl/hover"),v=m("../scatterpolar/hover").makeHoverPointText;G.exports={hoverPoints:function(w,y,e,t){var n=w.cd[0].t,a=n.r,r=n.theta,g=d.hoverPoints(w,y,e,t);if(g&&g[0].index!==!1){var u=g[0];if(u.index===void 0)return g;var s=w.subplot,h=u.cd[u.index],l=u.trace;if(h.r=a[u.index],h.theta=r[u.index],s.isPtInside(h))return u.xLabelVal=void 0,u.yLabelVal=void 0,v(h,l,s,u),g}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(m,G,W){arguments[4][905][0].apply(W,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(m,G,W){var d=m("@plotly/point-cluster"),v=m("fast-isnumeric"),w=m("../scattergl/plot"),y=m("../scattergl/scene_update"),e=m("../scattergl/convert"),t=m("../../lib"),n=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(a,r,g){if(g.length){var u=r.radialAxis,s=r.angularAxis,h=y(a,r);return g.forEach(function(l){if(l&&l[0]&&l[0].trace){var o,p=l[0],c=p.trace,i=p.t,x=c._length,f=i.r,_=i.theta,b=i.opts,T=f.slice(),k=_.slice();for(o=0;o<f.length;o++)r.isPtInside({r:f[o],theta:_[o]})||(T[o]=NaN,k[o]=NaN);var L=new Array(2*x),A=Array(x),I=Array(x);for(o=0;o<x;o++){var P,S,E=T[o];if(v(E)){var z=u.c2g(E),D=s.c2g(k[o],c.thetaunit);P=z*Math.cos(D),S=z*Math.sin(D)}else P=S=NaN;A[o]=L[2*o]=P,I[o]=L[2*o+1]=S}i.tree=d(L),b.marker&&x>=n&&(b.marker.cluster=i.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=L),b.line&&L.length>1&&t.extendFlat(b.line,e.linePositions(a,c,L)),b.text&&(t.extendFlat(b.text,{positions:L},e.textPosition(a,c,b.text,b.marker)),t.extendFlat(b.textSel,{positions:L},e.textPosition(a,c,b.text,b.markerSel)),t.extendFlat(b.textUnsel,{positions:L},e.textPosition(a,c,b.text,b.markerUnsel))),b.fill&&!h.fill2d&&(h.fill2d=!0),b.marker&&!h.scatter2d&&(h.scatter2d=!0),b.line&&!h.line2d&&(h.line2d=!0),b.text&&!h.glText&&(h.glText=!0),h.lineOptions.push(b.line),h.fillOptions.push(b.fill),h.markerOptions.push(b.marker),h.markerSelectedOptions.push(b.markerSel),h.markerUnselectedOptions.push(b.markerUnsel),h.textOptions.push(b.text),h.textSelectedOptions.push(b.textSel),h.textUnselectedOptions.push(b.textUnsel),h.selectBatch.push([]),h.unselectBatch.push([]),i.x=A,i.y=I,i.rawx=A,i.rawy=I,i.r=f,i.theta=_,i.positions=L,i._scene=h,i.index=h.count,h.count++}}),w(a,r,g)}},G.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("../scatter/attributes"),e=m("../../plots/attributes"),t=y.line;G.exports={mode:y.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:v({editType:"plot"},{keys:["real","imag","text"]}),hovertext:y.hovertext,line:{color:t.color,width:t.width,dash:t.dash,backoff:t.backoff,shape:w({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:w({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:w({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:w({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:y.hoveron,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/colorscale_calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection"),t=m("../scatter/calc").calcMarkerSize;G.exports=function(n,a){for(var r=n._fullLayout,g=a.subplot,u=r[g].realaxis,s=r[g].imaginaryaxis,h=u.makeCalcdata(a,"real"),l=s.makeCalcdata(a,"imag"),o=a._length,p=new Array(o),c=0;c<o;c++){var i=h[c],x=l[c],f=p[c]={};d(i)&&d(x)?(f.real=i,f.imag=x):f.real=v}return t(a,o),w(n,a),y(p,a),e(p,a),p}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/line_shape_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),a=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");G.exports=function(g,u,s,h){function l(c,i){return d.coerce(g,u,r,c,i)}var o=function(c,i,x,f){var _,b=f("real"),T=f("imag");return b&&T&&(_=Math.min(b.length,T.length)),i._length=_,_}(0,u,0,l);if(o){l("mode",o<a?"lines+markers":"lines"),l("text"),l("hovertext"),u.hoveron!=="fills"&&l("hovertemplate"),v.hasLines(u)&&(y(g,u,s,h,l,{backoff:!0}),e(g,u,l),l("connectgaps")),v.hasMarkers(u)&&w(g,u,s,h,l,{gradient:!0}),v.hasText(u)&&(l("texttemplate"),t(g,u,h,l));var p=[];(v.hasMarkers(u)||v.hasText(u))&&(l("cliponaxis"),l("marker.maxdisplayed"),p.push("points")),l("fill"),u.fill!=="none"&&(n(g,u,s,l),v.hasLines(u)||e(g,u,l)),u.fill!=="tonext"&&u.fill!=="toself"||p.push("fills"),l("hoveron",p.join("+")||"points"),d.coerceSelectionMarkerOpacity(u,l)}else u.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(m,G,W){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot;return e.realLabel=d.tickText(t.radialAxis,v.real,!0).text,e.imagLabel=d.tickText(t.angularAxis,v.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(m,G,W){var d=m("../scatter/hover");function v(w,y,e,t){var n=e.radialAxis,a=e.angularAxis;n._hovertitle="real",a._hovertitle="imag";var r={};r[y.subplot]={_subplot:e};var g=y._module.formatLabels(w,y,r);t.realLabel=g.realLabel,t.imagLabel=g.imagLabel;var u=w.hi||y.hoverinfo,s=[];function h(o,p){s.push(o._hovertitle+": "+p)}if(!y.hovertemplate){var l=u.split("+");l.indexOf("all")!==-1&&(l=["real","imag","text"]),l.indexOf("real")!==-1&&h(n,t.realLabel),l.indexOf("imag")!==-1&&h(a,t.imagLabel),l.indexOf("text")!==-1&&t.text&&(s.push(t.text),delete t.text),t.extraText=s.join("<br>")}}G.exports={hoverPoints:function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var a=n[0];if(a.index===void 0)return n;var r=w.subplot,g=a.cd[a.index],u=a.trace;if(r.isPtInside(g))return a.xLabelVal=void 0,a.yLabelVal=void 0,v(g,u,r,a),a.hovertemplate=u.hovertemplate,n}},makeHoverPointText:v}},{"../scatter/hover":947}],1031:[function(m,G,W){G.exports={moduleType:"trace",name:"scattersmith",basePlotModule:m("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(m,G,W){var d=m("../scatter/plot"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/smith/helpers").smith;G.exports=function(y,e,t){for(var n=e.layers.frontplot.select("g.scatterlayer"),a=e.xaxis,r=e.yaxis,g={xaxis:a,yaxis:r,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},u=0;u<t.length;u++)for(var s=t[u],h=0;h<s.length;h++){h===0&&(s[0].trace._xA=a,s[0].trace._yA=r);var l=s[h],o=l.real;if(o===v)l.x=l.y=v;else{var p=w([o,l.imag]);l.x=p[0],l.y=p[1]}}d(y,g,t,n)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scatter/attributes"),y=m("../../plots/attributes"),e=m("../../components/colorscale/attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat,a=w.marker,r=w.line,g=a.line;G.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},w.mode,{dflt:"markers"}),text:n({},w.text,{}),texttemplate:v({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},w.hovertext,{}),line:{color:r.color,width:r.width,dash:t,backoff:r.backoff,shape:n({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:w.connectgaps,cliponaxis:w.cliponaxis,fill:n({},w.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:w.fillcolor,marker:n({symbol:a.symbol,opacity:a.opacity,angle:a.angle,angleref:a.angleref,standoff:a.standoff,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:n({width:g.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:w.textfont,textposition:w.textposition,selected:w.selected,unselected:w.unselected,hoverinfo:n({},y.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:w.hoveron,hovertemplate:d()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(m,G,W){var d=m("fast-isnumeric"),v=m("../scatter/colorscale_calc"),w=m("../scatter/arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../scatter/calc").calcMarkerSize,t=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};G.exports=function(a,r){var g,u,s,h,l,o,p=a._fullLayout[r.subplot].sum,c=r.sum||p,i={a:r.a,b:r.b,c:r.c};for(g=0;g<t.length;g++)if(!i[s=t[g]]){for(l=i[n[s][0]],o=i[n[s][1]],h=new Array(l.length),u=0;u<l.length;u++)h[u]=c-l[u]-o[u];i[s]=h}var x,f,_,b,T,k,L=r._length,A=new Array(L);for(g=0;g<L;g++)x=i.a[g],f=i.b[g],_=i.c[g],d(x)&&d(f)&&d(_)?((b=p/((x=+x)+(f=+f)+(_=+_)))!==1&&(x*=b,f*=b,_*=b),k=x,T=_-f,A[g]={x:T,y:k,a:x,b:f,c:_}):A[g]={x:!1,y:!1};return e(r,L),v(a,r),w(A,r),y(A,r),A}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/constants"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/line_shape_defaults"),n=m("../scatter/text_defaults"),a=m("../scatter/fillcolor_defaults"),r=m("./attributes");G.exports=function(g,u,s,h){function l(f,_){return d.coerce(g,u,r,f,_)}var o,p=l("a"),c=l("b"),i=l("c");if(p?(o=p.length,c?(o=Math.min(o,c.length),i&&(o=Math.min(o,i.length))):o=i?Math.min(o,i.length):0):c&&i&&(o=Math.min(c.length,i.length)),o){u._length=o,l("sum"),l("text"),l("hovertext"),u.hoveron!=="fills"&&l("hovertemplate"),l("mode",o<v.PTS_LINESONLY?"lines+markers":"lines"),w.hasLines(u)&&(e(g,u,s,h,l,{backoff:!0}),t(g,u,l),l("connectgaps")),w.hasMarkers(u)&&y(g,u,s,h,l,{gradient:!0}),w.hasText(u)&&(l("texttemplate"),n(g,u,h,l));var x=[];(w.hasMarkers(u)||w.hasText(u))&&(l("cliponaxis"),l("marker.maxdisplayed"),x.push("points")),l("fill"),u.fill!=="none"&&(a(g,u,s,l),w.hasLines(u)||t(g,u,l)),u.fill!=="tonext"&&u.fill!=="toself"||x.push("fills"),l("hoveron",x.join("+")||"points"),d.coerceSelectionMarkerOpacity(u,l)}else u.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(m,G,W){G.exports=function(d,v,w,y,e){if(v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),y[e]){var t=y[e];d.a=t.a,d.b=t.b,d.c=t.c}else d.a=v.a,d.b=v.b,d.c=v.c;return d}},{}],1037:[function(m,G,W){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot;return e.aLabel=d.tickText(t.aaxis,v.a,!0).text,e.bLabel=d.tickText(t.baxis,v.b,!0).text,e.cLabel=d.tickText(t.caxis,v.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(m,G,W){var d=m("../scatter/hover");G.exports=function(v,w,y,e){var t=d(v,w,y,e);if(t&&t[0].index!==!1){var n=t[0];if(n.index===void 0){var a=1-n.y0/v.ya._length,r=v.xa._length,g=r*a/2,u=r-g;return n.x0=Math.max(Math.min(n.x0,u),g),n.x1=Math.max(Math.min(n.x1,u),g),t}var s=n.cd[n.index],h=n.trace,l=n.subplot;n.a=s.a,n.b=s.b,n.c=s.c,n.xLabelVal=void 0,n.yLabelVal=void 0;var o={};o[h.subplot]={_subplot:l};var p=h._module.formatLabels(s,h,o);n.aLabel=p.aLabel,n.bLabel=p.bLabel,n.cLabel=p.cLabel;var c=s.hi||h.hoverinfo,i=[];if(!h.hovertemplate){var x=c.split("+");x.indexOf("all")!==-1&&(x=["a","b","c"]),x.indexOf("a")!==-1&&f(l.aaxis,n.aLabel),x.indexOf("b")!==-1&&f(l.baxis,n.bLabel),x.indexOf("c")!==-1&&f(l.caxis,n.cLabel)}return n.extraText=i.join("<br>"),n.hovertemplate=h.hovertemplate,t}function f(_,b){i.push(_._hovertitle+": "+b)}}},{"../scatter/hover":947}],1039:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../scatter/select"),eventData:m("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:m("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(m,G,W){var d=m("../scatter/plot");G.exports=function(v,w,y){var e=w.plotContainer;e.select(".scatterlayer").selectAll("*").remove();for(var t=w.xaxis,n=w.yaxis,a={xaxis:t,yaxis:n,plot:e,layerClipId:w._hasClipOnAxisFalse?w.clipIdRelative:null},r=w.layers.frontplot.select("g.scatterlayer"),g=0;g<y.length;g++){var u=y[g];u.length&&(u[0].trace._xA=t,u[0].trace._yA=n)}d(v,a,y,r)}},{"../scatter/plot":957}],1041:[function(m,G,W){var d=m("../scatter/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../scattergl/attributes"),t=m("../../plots/cartesian/constants").idRegex,n=m("../../plot_api/plot_template").templatedArray,a=m("../../lib/extend").extendFlat,r=d.marker,g=r.line,u=a(v("marker.line",{editTypeOverride:"calc"}),{width:a({},g.width,{editType:"calc"}),editType:"calc"}),s=a(v("marker"),{symbol:r.symbol,angle:r.angle,size:a({},r.size,{editType:"markerSize"}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,colorbar:r.colorbar,line:u,editType:"calc"});function h(l){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:t[l],editType:"plot"}}}s.color.editType=s.cmin.editType=s.cmax.editType="style",G.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),marker:s,xaxes:h("x"),yaxes:h("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(m,G,W){var d=m("../../registry"),v=m("../../components/grid");G.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),calc:m("./calc"),plot:m("./plot"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("./select"),editStyle:m("./edit_style"),meta:{}},d.register(v)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(m,G,W){var d=m("regl-line2d"),v=m("../../registry"),w=m("../../lib/prepare_regl"),y=m("../../plots/get_data").getModuleCalcData,e=m("../../plots/cartesian"),t=m("../../plots/cartesian/axis_ids").getFromId,n=m("../../plots/cartesian/axes").shouldShowZeroLine,a={};function r(u,s,h){for(var l=h.matrixOptions.data.length,o=s._visibleDims,p=h.viewOpts.ranges=new Array(l),c=0;c<o.length;c++){var i=o[c],x=p[c]=new Array(4),f=t(u,s._diag[i][0]);f&&(x[0]=f.r2l(f.range[0]),x[2]=f.r2l(f.range[1]));var _=t(u,s._diag[i][1]);_&&(x[1]=_.r2l(_.range[0]),x[3]=_.r2l(_.range[1]))}h.selectBatch.length||h.unselectBatch.length?h.matrix.update({ranges:p},{ranges:p}):h.matrix.update({ranges:p})}function g(u){var s=u._fullLayout,h=s._glcanvas.data()[0].regl,l=s._splomGrid;l||(l=s._splomGrid=d(h)),l.update(function(o){var p,c=o._context.plotGlPixelRatio,i=o._fullLayout,x=i._size,f=[0,0,i.width*c,i.height*c],_={};function b(K,$,ne,H,N,U){ne*=c,H*=c,N*=c,U*=c;var te=$[K+"color"],B=$[K+"width"],X=String(te+B);X in _?_[X].data.push(NaN,NaN,ne,H,N,U):_[X]={data:[ne,H,N,U],join:"rect",thickness:B*c,color:te,viewport:f,range:f,overlay:!1}}for(p in i._splomSubplots){var T,k,L=i._plots[p],A=L.xaxis,I=L.yaxis,P=A._gridVals,S=I._gridVals,E=A._offset,z=A._length,D=I._length,j=x.b+I.domain[0]*x.h,V=-I._m,Z=-V*I.r2l(I.range[0],I.calendar);if(A.showgrid)for(p=0;p<P.length;p++)T=E+A.l2p(P[p].x),b("grid",A,T,j,T,j+D);if(I.showgrid)for(p=0;p<S.length;p++)k=j+Z+V*S[p].x,b("grid",I,E,k,E+z,k);n(o,A,I)&&(T=E+A.l2p(0),b("zeroline",A,T,j,T,j+D)),n(o,I,A)&&b("zeroline",I,E,k=j+Z+0,E+z,k)}var Q=[];for(p in _)Q.push(_[p]);return Q}(u))}G.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(u){var s=u._fullLayout,h=v.getModule("splom"),l=y(u.calcdata,h)[0];w(u,["ANGLE_instanced_arrays","OES_element_index_uint"],a)&&(s._hasOnlyLargeSploms&&g(u),h.plot(u,{},l))},drag:function(u){var s=u.calcdata,h=u._fullLayout;h._hasOnlyLargeSploms&&g(u);for(var l=0;l<s.length;l++){var o=s[l][0].trace,p=h._splomScenes[o.uid];o.type==="splom"&&p&&p.matrix&&r(u,o,p)}},updateGrid:g,clean:function(u,s,h,l){var o,p={};if(l._splomScenes){for(o=0;o<u.length;o++){var c=u[o];c.type==="splom"&&(p[c.uid]=1)}for(o=0;o<h.length;o++){var i=h[o];if(!p[i.uid]){var x=l._splomScenes[i.uid];x&&x.destroy&&x.destroy(),l._splomScenes[i.uid]=null,delete l._splomScenes[i.uid]}}}Object.keys(l._splomScenes||{}).length===0&&delete l._splomScenes,l._splomGrid&&!s._hasOnlyLargeSploms&&l._hasOnlyLargeSploms&&(l._splomGrid.destroy(),l._splomGrid=null,delete l._splomGrid),e.clean(u,s,h,l)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:a}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axis_ids"),w=m("../scatter/calc").calcMarkerSize,y=m("../scatter/calc").calcAxisExpansion,e=m("../scatter/colorscale_calc"),t=m("../scattergl/convert").markerSelection,n=m("../scattergl/convert").markerStyle,a=m("./scene_update"),r=m("../../constants/numerical").BADNUM,g=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(u,s){var h,l,o,p,c,i,x=s.dimensions,f=s._length,_={},b=_.cdata=[],T=_.data=[],k=s._visibleDims=[];function L(I,P){for(var S=I.makeCalcdata({v:P.values,vcalendar:s.calendar},"v"),E=0;E<S.length;E++)S[E]=S[E]===r?NaN:S[E];b.push(S),T.push(I.type==="log"?d.simpleMap(S,I.c2l):S)}for(h=0;h<x.length;h++)if((o=x[h]).visible){if(p=v.getFromId(u,s._diag[h][0]),c=v.getFromId(u,s._diag[h][1]),p&&c&&p.type!==c.type){d.log("Skipping splom dimension "+h+" with conflicting axis types");continue}p?(L(p,o),c&&c.type==="category"&&(c._categories=p._categories.slice())):L(c,o),k.push(h)}for(e(u,s),d.extendFlat(_,n(u,s)),i=b.length*f>g?_.sizeAvg||Math.max(_.size,3):w(s,f),l=0;l<k.length;l++)o=x[h=k[l]],p=v.getFromId(u,s._diag[h][0])||{},c=v.getFromId(u,s._diag[h][1])||{},y(u,s,p,c,b[l],b[l],i);var A=a(u,s);return A.matrix||(A.matrix=!0),A.matrixOptions=_,A.selectedOptions=t(u,s,s.selected),A.unselectedOptions=t(u,s,s.unselected),[{x:!1,y:!1,t:{},trace:s}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("../scatter/subtypes"),e=m("../scatter/marker_defaults"),t=m("../parcoords/merge_length"),n=m("../scattergl/helpers").isOpenSymbol;function a(r,g){function u(h,l){return d.coerce(r,g,w.dimensions,h,l)}u("label");var s=u("values");s&&s.length?u("visible"):g.visible=!1,u("axis.type"),u("axis.matches")}G.exports=function(r,g,u,s){function h(f,_){return d.coerce(r,g,w,f,_)}var l=v(r,g,{name:"dimensions",handleItemDefaults:a}),o=h("diagonal.visible"),p=h("showupperhalf"),c=h("showlowerhalf");if(t(g,l,"values")&&(o||p||c)){h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),e(r,g,u,s,h,{noAngleRef:!0,noStandOff:!0});var i=n(g.marker.symbol),x=y.isBubble(g);h("marker.line.width",i||x?1:0),function(f,_,b,T){var k,L,A=_.dimensions,I=A.length,P=_.showupperhalf,S=_.showlowerhalf,E=_.diagonal.visible,z=new Array(I),D=new Array(I);for(k=0;k<I;k++){var j=k?k+1:"";z[k]="x"+j,D[k]="y"+j}var V=T("xaxes",z),Z=T("yaxes",D),Q=_._diag=new Array(I);_._xaxes={},_._yaxes={};var K=[],$=[];function ne(re,se,oe,de){if(re){var ce=re.charAt(0),ve=b._splomAxes[ce];if(_["_"+ce+"axes"][re]=1,de.push(re),!(re in ve)){var Ae=ve[re]={};oe&&(Ae.label=oe.label||"",oe.visible&&oe.axis&&(oe.axis.type&&(Ae.type=oe.axis.type),oe.axis.matches&&(Ae.matches=se)))}}}var H=!E&&!S,N=!E&&!P;for(_._axesDim={},k=0;k<I;k++){var U=A[k],te=k===0,B=k===I-1,X=te&&H||B&&N?void 0:V[k],J=te&&N||B&&H?void 0:Z[k];ne(X,J,U,K),ne(J,X,U,$),Q[k]=[X,J],_._axesDim[X]=k,_._axesDim[J]=k}for(k=0;k<K.length;k++)for(L=0;L<$.length;L++){var ee=K[k]+$[L];k>L&&P||k<L&&S?b._splomSubplots[ee]=1:k!==L||!E&&S&&P||(b._splomSubplots[ee]=1)}(!S||!E&&P&&S)&&(b._splomGridDflt.xside="bottom",b._splomGridDflt.yside="left")}(0,g,s,h),d.coerceSelectionMarkerOpacity(g,h)}else g.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(m,G,W){var d=m("../../lib"),v=m("../scatter/colorscale_calc"),w=m("../scattergl/convert").markerStyle;G.exports=function(y,e){var t=e.trace,n=y._fullLayout._splomScenes[t.uid];if(n){v(y,t),d.extendFlat(n.matrixOptions,w(y,t));var a=d.extendFlat({},n.matrixOptions,n.viewOpts);n.matrix.update(a,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(m,G,W){W.getDimIndex=function(d,v){for(var w=v._id,y={x:0,y:1}[w.charAt(0)],e=d._visibleDims,t=0;t<e.length;t++){var n=e[t];if(d._diag[n][y]===w)return t}return!1}},{}],1048:[function(m,G,W){var d=m("./helpers"),v=m("../scattergl/hover").calcHover;G.exports={hoverPoints:function(w,y,e){var t=w.cd[0].trace,n=w.scene.matrixOptions.cdata,a=w.xa,r=w.ya,g=a.c2p(y),u=r.c2p(e),s=w.distance,h=d.getDimIndex(t,a),l=d.getDimIndex(t,r);if(h===!1||l===!1)return[w];for(var o,p,c=n[h],i=n[l],x=s,f=0;f<c.length;f++){var _=c[f],b=i[f],T=a.c2p(_)-g,k=r.c2p(b)-u,L=Math.sqrt(T*T+k*k);L<x&&(x=p=L,o=f)}return w.index=o,w.distance=x,w.dxy=p,o===void 0?[w]:[v(w,c,i,t)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(m,G,W){var d=m("./base_index");d.basePlotModule=m("./base_plot"),G.exports=d},{"./base_index":1042,"./base_plot":1043}],1050:[function(m,G,W){var d=m("regl-splom"),v=m("../../lib"),w=m("../../plots/cartesian/axis_ids"),y=m("../../components/dragelement/helpers").selectMode;function e(t,n){var a,r,g,u,s,h=t._fullLayout,l=h._size,o=n.trace,p=n.t,c=h._splomScenes[o.uid],i=c.matrixOptions,x=i.cdata,f=h._glcanvas.data()[0].regl,_=h.dragmode;if(x.length!==0){i.lower=o.showupperhalf,i.upper=o.showlowerhalf,i.diagonal=o.diagonal.visible;var b=o._visibleDims,T=x.length,k=c.viewOpts={};for(k.ranges=new Array(T),k.domains=new Array(T),s=0;s<b.length;s++){g=b[s];var L=k.ranges[s]=new Array(4),A=k.domains[s]=new Array(4);(a=w.getFromId(t,o._diag[g][0]))&&(L[0]=a._rl[0],L[2]=a._rl[1],A[0]=a.domain[0],A[2]=a.domain[1]),(r=w.getFromId(t,o._diag[g][1]))&&(L[1]=r._rl[0],L[3]=r._rl[1],A[1]=r.domain[0],A[3]=r.domain[1])}var I=t._context.plotGlPixelRatio,P=l.l*I,S=l.b*I,E=l.w*I,z=l.h*I;k.viewport=[P,S,E+P,z+S],c.matrix===!0&&(c.matrix=d(f));var D=h.clickmode.indexOf("select")>-1,j=!0;if(y(_)||!!o.selectedpoints||D){var V=o._length;if(o.selectedpoints){c.selectBatch=o.selectedpoints;var Z=o.selectedpoints,Q={};for(g=0;g<Z.length;g++)Q[Z[g]]=!0;var K=[];for(g=0;g<V;g++)Q[g]||K.push(g);c.unselectBatch=K}var $=p.xpx=new Array(T),ne=p.ypx=new Array(T);for(s=0;s<b.length;s++){if(g=b[s],a=w.getFromId(t,o._diag[g][0]))for($[s]=new Array(V),u=0;u<V;u++)$[s][u]=a.c2p(x[s][u]);if(r=w.getFromId(t,o._diag[g][1]))for(ne[s]=new Array(V),u=0;u<V;u++)ne[s][u]=r.c2p(x[s][u])}if(c.selectBatch.length||c.unselectBatch.length){var H=v.extendFlat({},i,c.unselectedOptions,k),N=v.extendFlat({},i,c.selectedOptions,k);c.matrix.update(H,N),j=!1}}else p.xpx=p.ypx=null;if(j){var U=v.extendFlat({},i,k);c.matrix.update(U,null)}}}G.exports=function(t,n,a){if(a.length)for(var r=0;r<a.length;r++)e(t,a[r][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(m,G,W){var d=m("../../lib");G.exports=function(v,w){var y=v._fullLayout,e=w.uid,t=y._splomScenes;t||(t=y._splomScenes={});var n={dirty:!0,selectBatch:[],unselectBatch:[]},a=t[w.uid];return a||((a=t[e]=d.extendFlat({},n,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){a.matrix&&a.matrix.draw&&(a.selectBatch.length||a.unselectBatch.length?a.matrix.draw(a.unselectBatch,a.selectBatch):a.matrix.draw()),a.dirty=!1},a.destroy=function(){a.matrix&&a.matrix.destroy&&a.matrix.destroy(),a.matrixOptions=null,a.selectBatch=null,a.unselectBatch=null,a=null}),a.dirty||d.extendFlat(a,n),a}},{"../../lib":515}],1052:[function(m,G,W){var d=m("../../lib"),v=d.pushUnique,w=m("../scatter/subtypes"),y=m("./helpers");G.exports=function(e,t){var n=e.cd,a=n[0].trace,r=n[0].t,g=e.scene,u=g.matrixOptions.cdata,s=e.xaxis,h=e.yaxis,l=[];if(!g)return l;var o=!w.hasMarkers(a)&&!w.hasText(a);if(a.visible!==!0||o)return l;var p=y.getDimIndex(a,s),c=y.getDimIndex(a,h);if(p===!1||c===!1)return l;var i=r.xpx[p],x=r.ypx[c],f=u[p],_=u[c],b=(e.scene.selectBatch||[]).slice(),T=[];if(t!==!1&&!t.degenerate)for(var k=0;k<f.length;k++)t.contains([i[k],x[k]],null,k,e)?(l.push({pointNumber:k,x:f[k],y:_[k]}),v(b,k)):b.indexOf(k)!==-1?v(b,k):T.push(k);var L=g.matrixOptions;return b.length||T.length?g.selectBatch.length||g.unselectBatch.length||g.matrix.update(g.unselectedOptions,d.extendFlat({},L,g.selectedOptions,g.viewOpts)):g.matrix.update(L,null),g.selectBatch=b,g.unselectBatch=T,l}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:w({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:t({},e.showlegend,{dflt:!1})};t(n,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){n[a]=y[a]}),n.hoverinfo=t({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,G.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/calc");function w(t){var n,a,r,g,u,s,h,l,o,p,c,i,x=t._x,f=t._y,_=t._z,b=t._len,T=-1/0,k=1/0,L=-1/0,A=1/0,I=-1/0,P=1/0,S="";for(b&&(h=x[0],o=f[0],c=_[0]),b>1&&(l=x[b-1],p=f[b-1],i=_[b-1]),n=0;n<b;n++)T=Math.max(T,x[n]),k=Math.min(k,x[n]),L=Math.max(L,f[n]),A=Math.min(A,f[n]),I=Math.max(I,_[n]),P=Math.min(P,_[n]),g||x[n]===h||(g=!0,S+="x"),u||f[n]===o||(u=!0,S+="y"),s||_[n]===c||(s=!0,S+="z");g||(S+="x"),u||(S+="y"),s||(S+="z");var E=y(t._x),z=y(t._y),D=y(t._z);S=(S=(S=S.replace("x",(h>l?"-":"+")+"x")).replace("y",(o>p?"-":"+")+"y")).replace("z",(c>i?"-":"+")+"z");var j=function(){b=0,E=[],z=[],D=[]};(!b||b<E.length*z.length*D.length)&&j();var V=function(ce){return ce==="x"?x:ce==="y"?f:_},Z=function(ce){return ce==="x"?E:ce==="y"?z:D},Q=function(ce){return ce[b-1]<ce[0]?-1:1},K=V(S[1]),$=V(S[3]),ne=V(S[5]),H=Z(S[1]).length,N=Z(S[3]).length,U=Z(S[5]).length,te=!1,B=function(ce,ve,Ae){return H*(N*ce+ve)+Ae},X=Q(V(S[1])),J=Q(V(S[3])),ee=Q(V(S[5]));for(n=0;n<U-1;n++){for(a=0;a<N-1;a++){for(r=0;r<H-1;r++){var re=B(n,a,r),se=B(n,a,r+1),oe=B(n,a+1,r),de=B(n+1,a,r);if(K[re]*X<K[se]*X&&$[re]*J<$[oe]*J&&ne[re]*ee<ne[de]*ee||(te=!0),te)break}if(te)break}if(te)break}return te&&(d.warn("Encountered arbitrary coordinates! Unable to input data grid."),j()),{xMin:k,yMin:A,zMin:P,xMax:T,yMax:L,zMax:I,Xs:E,Ys:z,Zs:D,len:b,fill:S}}function y(t){return d.distinctVals(t).vals}function e(t,n){if(n===void 0&&(n=t.length),d.isTypedArray(t))return t.subarray(0,n);for(var a=[],r=0;r<n;r++)a[r]=+t[r];return a}G.exports={calc:function(t,n){n._len=Math.min(n.u.length,n.v.length,n.w.length,n.x.length,n.y.length,n.z.length),n._u=e(n.u,n._len),n._v=e(n.v,n._len),n._w=e(n.w,n._len),n._x=e(n.x,n._len),n._y=e(n.y,n._len),n._z=e(n.z,n._len);var a=w(n);n._gridFill=a.fill,n._Xs=a.Xs,n._Ys=a.Ys,n._Zs=a.Zs,n._len=a.len;var r,g,u,s=0;n.starts&&(r=e(n.starts.x||[]),g=e(n.starts.y||[]),u=e(n.starts.z||[]),s=Math.min(r.length,g.length,u.length)),n._startsX=r||[],n._startsY=g||[],n._startsZ=u||[];var h,l=0,o=1/0;for(h=0;h<n._len;h++){var p=n._u[h],c=n._v[h],i=n._w[h],x=Math.sqrt(p*p+c*c+i*i);l=Math.max(l,x),o=Math.min(o,x)}for(v(t,n,{vals:[o,l],containerStr:"",cLetter:"c"}),h=0;h<s;h++){var f=r[h];a.xMax=Math.max(a.xMax,f),a.xMin=Math.min(a.xMin,f);var _=g[h];a.yMax=Math.max(a.yMax,_),a.yMin=Math.min(a.yMin,_);var b=u[h];a.zMax=Math.max(a.zMax,b),a.zMin=Math.min(a.zMin,b)}n._slen=s,n._normMax=l,n._xbnds=[a.xMin,a.xMax],n._ybnds=[a.yMin,a.yMax],n._zbnds=[a.zMin,a.zMax]},filter:e,processGrid:w}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(m,G,W){var d=m("../../../stackgl_modules").gl_streamtube3d,v=d.createTubeMesh,w=m("../../lib"),y=m("../../lib/gl_format_color").parseColorScale,e=m("../../components/colorscale").extractOpts,t=m("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function a(h,l){this.scene=h,this.uid=l,this.mesh=null,this.data=null}var r=a.prototype;function g(h){var l=h.length;return l>2?h.slice(1,l-1):l===2?[(h[0]+h[1])/2]:h}function u(h){var l=h.length;return l===1?[.5,.5]:[h[1]-h[0],h[l-1]-h[l-2]]}function s(h,l){var o=h.fullSceneLayout,p=h.dataScale,c=l._len,i={};function x(H,N){var U=o[N],te=p[n[N]];return w.simpleMap(H,function(B){return U.d2l(B)*te})}if(i.vectors=t(x(l._u,"xaxis"),x(l._v,"yaxis"),x(l._w,"zaxis"),c),!c)return{positions:[],cells:[]};var f=x(l._Xs,"xaxis"),_=x(l._Ys,"yaxis"),b=x(l._Zs,"zaxis");if(i.meshgrid=[f,_,b],i.gridFill=l._gridFill,l._slen)i.startingPositions=t(x(l._startsX,"xaxis"),x(l._startsY,"yaxis"),x(l._startsZ,"zaxis"));else{for(var T=_[0],k=g(f),L=g(b),A=new Array(k.length*L.length),I=0,P=0;P<k.length;P++)for(var S=0;S<L.length;S++)A[I++]=[k[P],T,L[S]];i.startingPositions=A}i.colormap=y(l),i.tubeSize=l.sizeref,i.maxLength=l.maxdisplayed;var E=x(l._xbnds,"xaxis"),z=x(l._ybnds,"yaxis"),D=x(l._zbnds,"zaxis"),j=u(f),V=u(_),Z=u(b),Q=[[E[0]-j[0],z[0]-V[0],D[0]-Z[0]],[E[1]+j[1],z[1]+V[1],D[1]+Z[1]]],K=d(i,Q),$=e(l);K.vertexIntensityBounds=[$.min/l._normMax,$.max/l._normMax];var ne=l.lightposition;return K.lightPosition=[ne.x,ne.y,ne.z],K.ambient=l.lighting.ambient,K.diffuse=l.lighting.diffuse,K.specular=l.lighting.specular,K.roughness=l.lighting.roughness,K.fresnel=l.lighting.fresnel,K.opacity=l.opacity,l._pad=K.tubeScale*l.sizeref*2,K}r.handlePick=function(h){var l=this.scene.fullSceneLayout,o=this.scene.dataScale;function p(x,f){var _=l[f],b=o[n[f]];return _.l2c(x)/b}if(h.object===this.mesh){var c=h.data.position,i=h.data.velocity;return h.traceCoordinate=[p(c[0],"xaxis"),p(c[1],"yaxis"),p(c[2],"zaxis"),p(i[0],"xaxis"),p(i[1],"yaxis"),p(i[2],"zaxis"),h.data.intensity*this.data._normMax,h.data.divergence],h.textLabel=this.data.hovertext||this.data.text,!0}},r.update=function(h){this.data=h;var l=s(this.scene,h);this.mesh.update(l)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(h,l){var o=h.glplot.gl,p=s(h,l),c=v(o,p),i=new a(h,l.uid);return i.mesh=c,i.data=l,c._trace=i,h.glplot.add(c),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(m,G,W){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function a(o,p){return d.coerce(y,e,w,o,p)}var r=a("u"),g=a("v"),u=a("w"),s=a("x"),h=a("y"),l=a("z");r&&r.length&&g&&g.length&&u&&u.length&&s&&s.length&&h&&h.length&&l&&l.length?(a("starts.x"),a("starts.y"),a("starts.z"),a("maxdisplayed"),a("sizeref"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),v(y,e,n,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(m,G,W){G.exports={moduleType:"trace",name:"streamtube",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:m("./calc").calc,plot:m("./convert"),eventData:function(d,v){return d.tubex=d.x,d.tubey=d.y,d.tubez=d.z,d.tubeu=v.traceCoordinate[3],d.tubev=v.traceCoordinate[4],d.tubew=v.traceCoordinate[5],d.norm=v.traceCoordinate[6],d.divergence=v.traceCoordinate[7],delete d.x,delete d.y,delete d.z,d},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(m,G,W){var d=m("../../plots/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../plots/template_attributes").texttemplateAttrs,y=m("../../components/colorscale/attributes"),e=m("../../plots/domain").attributes,t=m("../pie/attributes"),n=m("./constants"),a=m("../../lib/extend").extendFlat;G.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},t.marker.line.color,{dflt:null}),width:a({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},y("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:t.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:w({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:t.hovertext,hoverinfo:a({},d.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:v({},{keys:n.eventDataKeys}),textfont:t.textfont,insidetextorientation:t.insidetextorientation,insidetextfont:t.insidetextfont,outsidetextfont:a({},t.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:t.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(m,G,W){var d=m("../../plots/plots");W.name="sunburst",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],1060:[function(m,G,W){var d=m("d3-hierarchy"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../components/colorscale").makeColorScaleFuncFromTrace,e=m("../pie/calc").makePullColorFn,t=m("../pie/calc").generateExtendedColors,n=m("../../components/colorscale").calc,a=m("../../constants/numerical").ALMOST_EQUAL,r={},g={},u={};W.calc=function(s,h){var l,o,p,c,i,x,f=s._fullLayout,_=h.ids,b=w.isArrayOrTypedArray(_),T=h.labels,k=h.parents,L=h.values,A=w.isArrayOrTypedArray(L),I=[],P={},S={},E=function(J){return J||typeof J=="number"},z=function(J){return!A||v(L[J])&&L[J]>=0};b?(l=Math.min(_.length,k.length),o=function(J){return E(_[J])&&z(J)},p=function(J){return String(_[J])}):(l=Math.min(T.length,k.length),o=function(J){return E(T[J])&&z(J)},p=function(J){return String(T[J])}),A&&(l=Math.min(l,L.length));for(var D=0;D<l;D++)if(o(D)){var j=p(D),V=E(k[D])?String(k[D]):"",Z={i:D,id:j,pid:V,label:E(T[D])?String(T[D]):""};A&&(Z.v=+L[D]),I.push(Z),i=j,P[c=V]?P[c].push(i):P[c]=[i],S[i]=1}if(P[""]){if(P[""].length>1){for(var Q=w.randstr(),K=0;K<I.length;K++)I[K].pid===""&&(I[K].pid=Q);I.unshift({hasMultipleRoots:!0,id:Q,pid:"",label:""})}}else{var $,ne=[];for($ in P)S[$]||ne.push($);if(ne.length!==1)return w.warn(["Multiple implied roots, cannot build",h.type,"hierarchy of",h.name+".","These roots include:",ne.join(", ")].join(" "));$=ne[0],I.unshift({hasImpliedRoot:!0,id:$,pid:"",label:$})}try{x=d.stratify().id(function(J){return J.id}).parentId(function(J){return J.pid})(I)}catch(J){return w.warn(["Failed to build",h.type,"hierarchy of",h.name+".","Error:",J.message].join(" "))}var H=d.hierarchy(x),N=!1;if(A)switch(h.branchvalues){case"remainder":H.sum(function(J){return J.data.v});break;case"total":H.each(function(J){var ee=J.data.data,re=ee.v;if(J.children){var se=J.children.reduce(function(oe,de){return oe+de.data.data.v},0);if((ee.hasImpliedRoot||ee.hasMultipleRoots)&&(re=se),re<se*a)return N=!0,w.warn(["Total value for node",J.data.data.id,"of",h.name,"is smaller than the sum of its children.",`
parent value =`,re,`
children sum =`,se].join(" "))}J.value=re})}else(function J(ee,re,se){var oe=0,de=ee.children;if(de){for(var ce=de.length,ve=0;ve<ce;ve++)oe+=J(de[ve],re,se);se.branches&&oe++}else se.leaves&&oe++;return ee.value=ee.data.data.value=oe,re._values||(re._values=[]),re._values[ee.data.data.i]=oe,oe})(H,h,{branches:h.count.indexOf("branches")!==-1,leaves:h.count.indexOf("leaves")!==-1});if(!N){var U,te;h.sort&&H.sort(function(J,ee){return ee.value-J.value});var B=h.marker.colors||[],X=!!B.length;return h._hasColorscale?(X||(B=A?h.values:h._values),n(s,h,{vals:B,containerStr:"marker",cLetter:"c"}),te=y(h.marker)):U=e(f["_"+h.type+"colormap"]),H.each(function(J){var ee=J.data.data;ee.color=h._hasColorscale?te(B[ee.i]):U(B[ee.i],ee.id)}),I[0].hierarchy=H,I}},W._runCrossTraceCalc=function(s,h){var l=h._fullLayout,o=h.calcdata,p=l[s+"colorway"],c=l["_"+s+"colormap"];l["extend"+s+"colors"]&&(p=t(p,s==="icicle"?u:s==="treemap"?g:r));var i,x=0;function f(T){var k=T.data.data,L=k.id;k.color===!1&&(c[L]?k.color=c[L]:T.parent?T.parent.parent?k.color=T.parent.data.data.color:(c[L]=k.color=p[x%p.length],x++):k.color=i)}for(var _=0;_<o.length;_++){var b=o[_][0];b.trace.type===s&&b.hierarchy&&(i=b.trace.root.color,b.hierarchy.each(f))}},W.crossTraceCalc=function(s){return W._runCrossTraceCalc("sunburst",s)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(m,G,W){G.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../bar/defaults").handleText,e=m("../../components/colorscale"),t=e.hasColorscale,n=e.handleDefaults;G.exports=function(a,r,g,u){function s(i,x){return d.coerce(a,r,v,i,x)}var h=s("labels"),l=s("parents");if(h&&h.length&&l&&l.length){var o=s("values");o&&o.length?s("branchvalues"):s("count"),s("level"),s("maxdepth"),s("marker.line.width")&&s("marker.line.color",u.paper_bgcolor),s("marker.colors");var p=r._hasColorscale=t(a,"marker","colors")||(a.marker||{}).coloraxis;p&&n(a,r,u,s,{prefix:"marker.",cLetter:"c"}),s("leaf.opacity",p?1:.7);var c=s("text");s("texttemplate"),r.texttemplate||s("textinfo",Array.isArray(c)?"text+label":"label"),s("hovertext"),s("hovertemplate"),y(a,r,u,s,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),s("insidetextorientation"),s("sort"),s("rotation"),s("root.color"),w(r,u,s),r._length=null}else r.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../components/fx/helpers").appendArrayPointValue,y=m("../../components/fx"),e=m("../../lib"),t=m("../../lib/events"),n=m("./helpers"),a=m("../pie/helpers").formatPieValue;function r(g,u,s){for(var h=g.data.data,l={curveNumber:u.index,pointNumber:h.i,data:u._input,fullData:u},o=0;o<s.length;o++){var p=s[o];p in g&&(l[p]=g[p])}return"parentString"in g&&!n.isHierarchyRoot(g)&&(l.parent=g.parentString),w(l,u,h.i),l}G.exports=function(g,u,s,h,l){var o=h[0],p=o.trace,c=o.hierarchy,i=p.type==="sunburst",x=p.type==="treemap"||p.type==="icicle";"_hasHoverLabel"in p||(p._hasHoverLabel=!1),"_hasHoverEvent"in p||(p._hasHoverEvent=!1),g.on("mouseover",function(f){var _=s._fullLayout;if(!s._dragging&&_.hovermode!==!1){var b,T=s._fullData[p.index],k=f.data.data,L=k.i,A=n.isHierarchyRoot(f),I=n.getParent(c,f),P=n.getValue(f),S=function(X){return e.castOption(T,L,X)},E=S("hovertemplate"),z=y.castHoverinfo(T,_,L),D=_.separators;if(E||z&&z!=="none"&&z!=="skip"){var j,V;i&&(j=o.cx+f.pxmid[0]*(1-f.rInscribed),V=o.cy+f.pxmid[1]*(1-f.rInscribed)),x&&(j=f._hoverX,V=f._hoverY);var Z,Q={},K=[],$=[],ne=function(X){return K.indexOf(X)!==-1};z&&(K=z==="all"?T._module.attributes.hoverinfo.flags:z.split("+")),Q.label=k.label,ne("label")&&Q.label&&$.push(Q.label),k.hasOwnProperty("v")&&(Q.value=k.v,Q.valueLabel=a(Q.value,D),ne("value")&&$.push(Q.valueLabel)),Q.currentPath=f.currentPath=n.getPath(f.data),ne("current path")&&!A&&$.push(Q.currentPath);var H=[],N=function(){H.indexOf(Z)===-1&&($.push(Z),H.push(Z))};Q.percentParent=f.percentParent=P/n.getValue(I),Q.parent=f.parentString=n.getPtLabel(I),ne("percent parent")&&(Z=n.formatPercent(Q.percentParent,D)+" of "+Q.parent,N()),Q.percentEntry=f.percentEntry=P/n.getValue(u),Q.entry=f.entry=n.getPtLabel(u),!ne("percent entry")||A||f.onPathbar||(Z=n.formatPercent(Q.percentEntry,D)+" of "+Q.entry,N()),Q.percentRoot=f.percentRoot=P/n.getValue(c),Q.root=f.root=n.getPtLabel(c),ne("percent root")&&!A&&(Z=n.formatPercent(Q.percentRoot,D)+" of "+Q.root,N()),Q.text=S("hovertext")||S("text"),ne("text")&&(Z=Q.text,e.isValidTextValue(Z)&&$.push(Z)),b=[r(f,T,l.eventDataKeys)];var U={trace:T,y:V,_x0:f._x0,_x1:f._x1,_y0:f._y0,_y1:f._y1,text:$.join("<br>"),name:E||ne("name")?T.name:void 0,color:S("hoverlabel.bgcolor")||k.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:E,hovertemplateLabels:Q,eventData:b};i&&(U.x0=j-f.rInscribed*f.rpx1,U.x1=j+f.rInscribed*f.rpx1,U.idealAlign=f.pxmid[0]<0?"left":"right"),x&&(U.x=j,U.idealAlign=j<0?"left":"right");var te=[];y.loneHover(U,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:s,inOut_bbox:te}),b[0].bbox=te[0],p._hasHoverLabel=!0}if(x){var B=g.select("path.surface");l.styleOne(B,f,T,{hovered:!0})}p._hasHoverEvent=!0,s.emit("plotly_hover",{points:b||[r(f,T,l.eventDataKeys)],event:d.event})}}),g.on("mouseout",function(f){var _=s._fullLayout,b=s._fullData[p.index],T=d.select(this).datum();if(p._hasHoverEvent&&(f.originalEvent=d.event,s.emit("plotly_unhover",{points:[r(T,b,l.eventDataKeys)],event:d.event}),p._hasHoverEvent=!1),p._hasHoverLabel&&(y.loneUnhover(_._hoverlayer.node()),p._hasHoverLabel=!1),x){var k=g.select("path.surface");l.styleOne(k,T,b,{hovered:!1})}}),g.on("click",function(f){var _=s._fullLayout,b=s._fullData[p.index],T=i&&(n.isHierarchyRoot(f)||n.isLeaf(f)),k=n.getPtId(f),L=n.isEntry(f)?n.findEntryWithChild(c,k):n.findEntryWithLevel(c,k),A=n.getPtId(L),I={points:[r(f,b,l.eventDataKeys)],event:d.event};T||(I.nextLevel=A);var P=t.triggerHandler(s,"plotly_"+p.type+"click",I);if(P!==!1&&_.hovermode&&(s._hoverdata=[r(f,b,l.eventDataKeys)],y.click(s,d.event)),!T&&P!==!1&&!s._dragging&&!s._transitioning){v.call("_storeDirectGUIEdit",b,_._tracePreGUI[b.uid],{level:b.level});var S={data:[{level:A}],traces:[p.index]},E={frame:{redraw:!1,duration:l.transitionTime},transition:{duration:l.transitionTime,easing:l.transitionEasing},mode:"immediate",fromcurrent:!0};y.loneUnhover(_._hoverlayer.node()),v.call("animate",s,S,E)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../../lib/setcursor"),y=m("../pie/helpers");function e(t){return t.data.data.pid}W.findEntryWithLevel=function(t,n){var a;return n&&t.eachAfter(function(r){if(W.getPtId(r)===n)return a=r.copy()}),a||t},W.findEntryWithChild=function(t,n){var a;return t.eachAfter(function(r){for(var g=r.children||[],u=0;u<g.length;u++){var s=g[u];if(W.getPtId(s)===n)return a=r.copy()}}),a||t},W.isEntry=function(t){return!t.parent},W.isLeaf=function(t){return!t.children},W.getPtId=function(t){return t.data.data.id},W.getPtLabel=function(t){return t.data.data.label},W.getValue=function(t){return t.value},W.isHierarchyRoot=function(t){return e(t)===""},W.setSliceCursor=function(t,n,a){var r=a.isTransitioning;if(!r){var g=t.datum();r=a.hideOnRoot&&W.isHierarchyRoot(g)||a.hideOnLeaves&&W.isLeaf(g)}w(t,r?null:"pointer")},W.getInsideTextFontKey=function(t,n,a,r,g){var u=(g||{}).onPathbar?"pathbar.textfont":"insidetextfont",s=a.data.data.i;return d.castOption(n,s,u+"."+t)||d.castOption(n,s,"textfont."+t)||r.size},W.getOutsideTextFontKey=function(t,n,a,r){var g=a.data.data.i;return d.castOption(n,g,"outsidetextfont."+t)||d.castOption(n,g,"textfont."+t)||r.size},W.isOutsideText=function(t,n){return!t._hasColorscale&&W.isHierarchyRoot(n)},W.determineTextFont=function(t,n,a,r){return W.isOutsideText(t,n)?function(g,u,s){return{color:W.getOutsideTextFontKey("color",g,u,s),family:W.getOutsideTextFontKey("family",g,u,s),size:W.getOutsideTextFontKey("size",g,u,s)}}(t,n,a):function(g,u,s,h){var l=(h||{}).onPathbar,o=u.data.data,p=o.i,c=d.castOption(g,p,(l?"pathbar.textfont":"insidetextfont")+".color");return!c&&g._input.textfont&&(c=d.castOption(g._input,p,"textfont.color")),{color:c||v.contrast(o.color),family:W.getInsideTextFontKey("family",g,u,s,h),size:W.getInsideTextFontKey("size",g,u,s,h)}}(t,n,a,r)},W.hasTransition=function(t){return!!(t&&t.duration>0)},W.getMaxDepth=function(t){return t.maxdepth>=0?t.maxdepth:1/0},W.isHeader=function(t,n){return!(W.isLeaf(t)||t.depth===n._maxDepth-1)},W.getParent=function(t,n){return W.findEntryWithLevel(t,e(n))},W.listPath=function(t,n){var a=t.parent;if(!a)return[];var r=n?[a.data[n]]:[a];return W.listPath(a,n).concat(r)},W.getPath=function(t){return W.listPath(t,"label").join("/")+"/"},W.formatValue=y.formatPieValue,W.formatPercent=function(t,n){var a=d.formatPercent(t,0);return a==="0%"&&(a=y.formatPiePercent(t,n)),a}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(m,G,W){G.exports={moduleType:"trace",name:"sunburst",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(m,G,W){G.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("sunburstcolorway",y.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-hierarchy"),w=m("d3-interpolate").interpolate,y=m("../../components/drawing"),e=m("../../lib"),t=m("../../lib/svg_text_utils"),n=m("../bar/uniform_text"),a=n.recordMinTextSize,r=n.clearMinTextSize,g=m("../pie/plot"),u=m("../pie/helpers").getRotationAngle,s=g.computeTransform,h=g.transformInsideText,l=m("./style").styleOne,o=m("../bar/style").resizeText,p=m("./fx"),c=m("./constants"),i=m("./helpers");function x(_,b,T,k){var L=_._context.staticPlot,A=_._fullLayout,I=!A.uniformtext.mode&&i.hasTransition(k),P=d.select(T).selectAll("g.slice"),S=b[0],E=S.trace,z=S.hierarchy,D=i.findEntryWithLevel(z,E.level),j=i.getMaxDepth(E),V=A._size,Z=E.domain,Q=V.w*(Z.x[1]-Z.x[0]),K=V.h*(Z.y[1]-Z.y[0]),$=.5*Math.min(Q,K),ne=S.cx=V.l+V.w*(Z.x[1]+Z.x[0])/2,H=S.cy=V.t+V.h*(1-Z.y[0])-K/2;if(!D)return P.remove();var N=null,U={};I&&P.each(function(le){U[i.getPtId(le)]={rpx0:le.rpx0,rpx1:le.rpx1,x0:le.x0,x1:le.x1,transform:le.transform},!N&&i.isEntry(le)&&(N=le)});var te=function(le){return v.partition().size([2*Math.PI,le.height+1])(le)}(D).descendants(),B=D.height+1,X=0,J=j;S.hasMultipleRoots&&i.isHierarchyRoot(D)&&(te=te.slice(1),B-=1,X=1,J+=1),te=te.filter(function(le){return le.y1<=J});var ee=u(E.rotation);ee&&te.forEach(function(le){le.x0+=ee,le.x1+=ee});var re=Math.min(B,j),se=function(le){return(le-X)/re*$},oe=function(le,ge){return[le*Math.cos(ge),-le*Math.sin(ge)]},de=function(le){return e.pathAnnulus(le.rpx0,le.rpx1,le.x0,le.x1,ne,H)},ce=function(le){return ne+f(le)[0]*(le.transform.rCenter||0)+(le.transform.x||0)},ve=function(le){return H+f(le)[1]*(le.transform.rCenter||0)+(le.transform.y||0)};(P=P.data(te,i.getPtId)).enter().append("g").classed("slice",!0),I?P.exit().transition().each(function(){var le=d.select(this);le.select("path.surface").transition().attrTween("d",function(ge){var Te=function(Se){var Me,ze=i.getPtId(Se),Oe=U[ze],De=U[i.getPtId(D)];if(De){var Xe=(Se.x1>De.x1?2*Math.PI:0)+ee;Me=Se.rpx1<De.rpx1?{x0:Se.x0,x1:Se.x1,rpx0:0,rpx1:0}:{x0:Xe,x1:Xe,rpx0:Se.rpx0,rpx1:Se.rpx1}}else{var Be,Ie=i.getPtId(Se.parent);P.each(function(xt){if(i.getPtId(xt)===Ie)return Be=xt});var Re,Ye=Be.children;Ye.forEach(function(xt,wt){if(i.getPtId(xt)===ze)return Re=wt});var Qe=Ye.length,lt=w(Be.x0,Be.x1);Me={rpx0:$,rpx1:$,x0:lt(Re/Qe),x1:lt((Re+1)/Qe)}}return w(Oe,Me)}(ge);return function(Se){return de(Te(Se))}}),le.select("g.slicetext").attr("opacity",0)}).remove():P.exit().remove(),P.order();var Ae=null;if(I&&N){var fe=i.getPtId(N);P.each(function(le){Ae===null&&i.getPtId(le)===fe&&(Ae=le.x1)})}var me=P;function _e(le){var ge=le.parent,Te=U[i.getPtId(ge)],Se={};if(Te){var Me=ge.children,ze=Me.indexOf(le),Oe=Me.length,De=w(Te.x0,Te.x1);Se.x0=De(ze/Oe),Se.x1=De(ze/Oe)}else Se.x0=Se.x1=0;return Se}I&&(me=me.transition().each("end",function(){var le=d.select(this);i.setSliceCursor(le,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),me.each(function(le){var ge=d.select(this),Te=e.ensureSingle(ge,"path","surface",function(Xe){Xe.style("pointer-events",L?"none":"all")});le.rpx0=se(le.y0),le.rpx1=se(le.y1),le.xmid=(le.x0+le.x1)/2,le.pxmid=oe(le.rpx1,le.xmid),le.midangle=-(le.xmid-Math.PI/2),le.startangle=-(le.x0-Math.PI/2),le.stopangle=-(le.x1-Math.PI/2),le.halfangle=.5*Math.min(e.angleDelta(le.x0,le.x1)||Math.PI,Math.PI),le.ring=1-le.rpx0/le.rpx1,le.rInscribed=function(Xe){return Xe.rpx0===0&&e.isFullCircle([Xe.x0,Xe.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Xe.halfangle)),Xe.ring/2))}(le),I?Te.transition().attrTween("d",function(Xe){var Be=function(Ie){var Re,Ye=U[i.getPtId(Ie)],Qe={x0:Ie.x0,x1:Ie.x1,rpx0:Ie.rpx0,rpx1:Ie.rpx1};if(Ye)Re=Ye;else if(N)if(Ie.parent)if(Ae){var lt=(Ie.x1>Ae?2*Math.PI:0)+ee;Re={x0:lt,x1:lt}}else Re={rpx0:$,rpx1:$},e.extendFlat(Re,_e(Ie));else Re={rpx0:0,rpx1:0};else Re={x0:ee,x1:ee};return w(Re,Qe)}(Xe);return function(Ie){return de(Be(Ie))}}):Te.attr("d",de),ge.call(p,D,_,b,{eventDataKeys:c.eventDataKeys,transitionTime:c.CLICK_TRANSITION_TIME,transitionEasing:c.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:_._transitioning}),Te.call(l,le,E);var Se=e.ensureSingle(ge,"g","slicetext"),Me=e.ensureSingle(Se,"text","",function(Xe){Xe.attr("data-notex",1)}),ze=e.ensureUniformFontSize(_,i.determineTextFont(E,le,A.font));Me.text(W.formatSliceLabel(le,D,E,b,A)).classed("slicetext",!0).attr("text-anchor","middle").call(y.font,ze).call(t.convertToTspans,_);var Oe=y.bBox(Me.node());le.transform=h(Oe,le,S),le.transform.targetX=ce(le),le.transform.targetY=ve(le);var De=function(Xe,Be){var Ie=Xe.transform;return s(Ie,Be),Ie.fontSize=ze.size,a(E.type,Ie,A),e.getTextTransform(Ie)};I?Me.transition().attrTween("transform",function(Xe){var Be=function(Ie){var Re,Ye=U[i.getPtId(Ie)],Qe=Ie.transform;if(Ye)Re=Ye;else if(Re={rpx1:Ie.rpx1,transform:{textPosAngle:Qe.textPosAngle,scale:0,rotate:Qe.rotate,rCenter:Qe.rCenter,x:Qe.x,y:Qe.y}},N)if(Ie.parent)if(Ae){var lt=Ie.x1>Ae?2*Math.PI:0;Re.x0=Re.x1=lt}else e.extendFlat(Re,_e(Ie));else Re.x0=Re.x1=ee;else Re.x0=Re.x1=ee;var xt=w(Re.transform.textPosAngle,Ie.transform.textPosAngle),wt=w(Re.rpx1,Ie.rpx1),bt=w(Re.x0,Ie.x0),nt=w(Re.x1,Ie.x1),$e=w(Re.transform.scale,Qe.scale),vt=w(Re.transform.rotate,Qe.rotate),Nt=Qe.rCenter===0?3:Re.transform.rCenter===0?1/3:1,qt=w(Re.transform.rCenter,Qe.rCenter);return function(Jt){var Wt=wt(Jt),ar=bt(Jt),Dt=nt(Jt),Ne=function(pe){return qt(Math.pow(pe,Nt))}(Jt),qe={pxmid:oe(Wt,(ar+Dt)/2),rpx1:Wt,transform:{textPosAngle:xt(Jt),rCenter:Ne,x:Qe.x,y:Qe.y}};return a(E.type,Qe,A),{transform:{targetX:ce(qe),targetY:ve(qe),scale:$e(Jt),rotate:vt(Jt),rCenter:Ne}}}}(Xe);return function(Ie){return De(Be(Ie),Oe)}}):Me.attr("transform",De(le,Oe))})}function f(_){return b=_.rpx1,T=_.transform.textPosAngle,[b*Math.sin(T),-b*Math.cos(T)];var b,T}W.plot=function(_,b,T,k){var L,A,I=_._fullLayout,P=I._sunburstlayer,S=!T,E=!I.uniformtext.mode&&i.hasTransition(T);r("sunburst",I),(L=P.selectAll("g.trace.sunburst").data(b,function(z){return z[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),E?(k&&(A=k()),d.transition().duration(T.duration).ease(T.easing).each("end",function(){A&&A()}).each("interrupt",function(){A&&A()}).each(function(){P.selectAll("g.trace").each(function(z){x(_,z,this,T)})})):(L.each(function(z){x(_,z,this,T)}),I.uniformtext.mode&&o(_,I._sunburstlayer.selectAll(".trace"),"sunburst")),S&&L.exit().remove()},W.formatSliceLabel=function(_,b,T,k,L){var A=T.texttemplate,I=T.textinfo;if(!(A||I&&I!=="none"))return"";var P=L.separators,S=k[0],E=_.data.data,z=S.hierarchy,D=i.isHierarchyRoot(_),j=i.getParent(z,_),V=i.getValue(_);if(!A){var Z,Q=I.split("+"),K=function(J){return Q.indexOf(J)!==-1},$=[];if(K("label")&&E.label&&$.push(E.label),E.hasOwnProperty("v")&&K("value")&&$.push(i.formatValue(E.v,P)),!D){K("current path")&&$.push(i.getPath(_.data));var ne=0;K("percent parent")&&ne++,K("percent entry")&&ne++,K("percent root")&&ne++;var H=ne>1;if(ne){var N,U=function(J){Z=i.formatPercent(N,P),H&&(Z+=" of "+J),$.push(Z)};K("percent parent")&&!D&&(N=V/i.getValue(j),U("parent")),K("percent entry")&&(N=V/i.getValue(b),U("entry")),K("percent root")&&(N=V/i.getValue(z),U("root"))}}return K("text")&&(Z=e.castOption(T,E.i,"text"),e.isValidTextValue(Z)&&$.push(Z)),$.join("<br>")}var te=e.castOption(T,E.i,"texttemplate");if(!te)return"";var B={};E.label&&(B.label=E.label),E.hasOwnProperty("v")&&(B.value=E.v,B.valueLabel=i.formatValue(E.v,P)),B.currentPath=i.getPath(_.data),D||(B.percentParent=V/i.getValue(j),B.percentParentLabel=i.formatPercent(B.percentParent,P),B.parent=i.getPtLabel(j)),B.percentEntry=V/i.getValue(b),B.percentEntryLabel=i.formatPercent(B.percentEntry,P),B.entry=i.getPtLabel(b),B.percentRoot=V/i.getValue(z),B.percentRootLabel=i.formatPercent(B.percentRoot,P),B.root=i.getPtLabel(z),E.hasOwnProperty("color")&&(B.color=E.color);var X=e.castOption(T,E.i,"text");return(e.isValidTextValue(X)||X==="")&&(B.text=X),B.customdata=e.castOption(T,E.i,"customdata"),e.texttemplateString(te,B,L._d3locale,B,T._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../bar/uniform_text").resizeText;function e(t,n,a){var r=n.data.data,g=!n.children,u=r.i,s=w.castOption(a,u,"marker.line.color")||v.defaultLine,h=w.castOption(a,u,"marker.line.width")||0;t.style("stroke-width",h).call(v.fill,r.color).call(v.stroke,s).style("opacity",g?a.leaf.opacity:null)}G.exports={style:function(t){var n=t._fullLayout._sunburstlayer.selectAll(".trace");y(t,n,"sunburst"),n.each(function(a){var r=d.select(this),g=a[0].trace;r.style("opacity",g.opacity),r.selectAll("path.surface").each(function(u){d.select(this).call(e,u,g)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(m,G,W){var d=m("../../components/color"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll;function a(g){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:d.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:d.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=G.exports=n(t({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),zhoverformat:w("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},v("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:a(),y:a(),z:a()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:t({},v.zauto,{}),zmin:t({},v.zmin,{}),zmax:t({},v.zmax,{})},hoverinfo:t({},e.hoverinfo),showlegend:t({},e.showlegend,{dflt:!1})}),"calc","nested");r.x.editType=r.y.editType=r.z.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(m,G,W){var d=m("../../components/colorscale/calc");G.exports=function(v,w){w.surfacecolor?d(v,w,{vals:w.surfacecolor,containerStr:"",cLetter:"c"}):d(v,w,{vals:w.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(m,G,W){var d=m("../../../stackgl_modules").gl_surface3d,v=m("../../../stackgl_modules").ndarray,w=m("../../../stackgl_modules").ndarray_linear_interpolate.d2,y=m("../heatmap/interp2d"),e=m("../heatmap/find_empties"),t=m("../../lib").isArrayOrTypedArray,n=m("../../lib/gl_format_color").parseColorScale,a=m("../../lib/str2rgbarray"),r=m("../../components/colorscale").extractOpts;function g(T,k,L){this.scene=T,this.uid=L,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var u=g.prototype;u.getXat=function(T,k,L,A){var I=t(this.data.x)?t(this.data.x[0])?this.data.x[k][T]:this.data.x[T]:T;return L===void 0?I:A.d2l(I,0,L)},u.getYat=function(T,k,L,A){var I=t(this.data.y)?t(this.data.y[0])?this.data.y[k][T]:this.data.y[k]:k;return L===void 0?I:A.d2l(I,0,L)},u.getZat=function(T,k,L,A){var I=this.data.z[k][T];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][T]),L===void 0?I:A.d2l(I,0,L)},u.handlePick=function(T){if(T.object===this.surface){var k=(T.data.index[0]-1)/this.dataScaleX-1,L=(T.data.index[1]-1)/this.dataScaleY-1,A=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);T.index=[A,I],T.traceCoordinate=[this.getXat(A,I),this.getYat(A,I),this.getZat(A,I)],T.dataCoordinate=[this.getXat(A,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(A,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(A,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var P=0;P<3;P++){var S=T.dataCoordinate[P];S!=null&&(T.dataCoordinate[P]*=this.scene.dataScale[P])}var E=this.data.hovertext||this.data.text;return Array.isArray(E)&&E[I]&&E[I][A]!==void 0?T.textLabel=E[I][A]:T.textLabel=E||"",T.data.dataCoordinate=T.dataCoordinate.slice(),this.surface.highlight(T.data),this.scene.glplot.spikes.position=T.dataCoordinate,!0}};var s=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function h(T,k){if(T<k)return 0;for(var L=0;Math.floor(T%k)===0;)T/=k,L++;return L}function l(T){for(var k=[],L=0;L<s.length;L++){var A=s[L];k.push(h(T,A))}return k}function o(T){for(var k=l(T),L=T,A=0;A<s.length;A++)if(k[A]>0){L=s[A];break}return L}function p(T,k){if(!(T<1||k<1)){for(var L=l(T),A=l(k),I=1,P=0;P<s.length;P++)I*=Math.pow(s[P],Math.max(L[P],A[P]));return I}}u.calcXnums=function(T){var k,L=[];for(k=1;k<T;k++){var A=this.getXat(k-1,0),I=this.getXat(k,0);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<T;k++)P+=L[k-1];for(k=1;k<T;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L},u.calcYnums=function(T){var k,L=[];for(k=1;k<T;k++){var A=this.getYat(0,k-1),I=this.getYat(0,k);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<T;k++)P+=L[k-1];for(k=1;k<T;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L};var c=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],i=c[9],x=c[13];function f(T,k,L){var A=L[8]+L[2]*k[0]+L[5]*k[1];return T[0]=(L[6]+L[0]*k[0]+L[3]*k[1])/A,T[1]=(L[7]+L[1]*k[0]+L[4]*k[1])/A,T}function _(T,k,L){return function(A,I,P,S){for(var E=[0,0],z=A.shape[0],D=A.shape[1],j=0;j<z;j++)for(var V=0;V<D;V++)P(E,[j,V],S),A.set(j,V,w(I,E[0],E[1]))}(T,k,f,L),T}function b(T,k){for(var L=!1,A=0;A<T.length;A++)if(k===T[A]){L=!0;break}L===!1&&T.push(k)}u.estimateScale=function(T,k){for(var L=1+function(I){if(I.length!==0){for(var P=1,S=0;S<I.length;S++)P=p(P,I[S]);return P}}(k===0?this.calcXnums(T):this.calcYnums(T));L<i;)L*=2;for(;L>x;)L--,L/=o(L),++L<i&&(L=x);var A=Math.round(L/T);return A>1?A:1},u.refineCoords=function(T){for(var k=this.dataScaleX,L=this.dataScaleY,A=T[0].shape[0],I=T[0].shape[1],P=0|Math.floor(T[0].shape[0]*k+1),S=0|Math.floor(T[0].shape[1]*L+1),E=1+A+1,z=1+I+1,D=v(new Float32Array(E*z),[E,z]),j=[1/k,0,0,0,1/L,0,0,0,1],V=0;V<T.length;++V){this.surface.padField(D,T[V]);var Z=v(new Float32Array(P*S),[P,S]);_(Z,D,j),T[V]=Z}},u.setContourLevels=function(){var T,k,L,A=[[],[],[]],I=[!1,!1,!1],P=!1;for(T=0;T<3;++T)if(this.showContour[T]&&(P=!0,this.contourSize[T]>0&&this.contourStart[T]!==null&&this.contourEnd[T]!==null&&this.contourEnd[T]>this.contourStart[T]))for(I[T]=!0,k=this.contourStart[T];k<this.contourEnd[T];k+=this.contourSize[T])L=k*this.scene.dataScale[T],b(A[T],L);if(P){var S=[[],[],[]];for(T=0;T<3;++T)this.showContour[T]&&(S[T]=I[T]?A[T]:this.scene.contourLevels[T]);this.surface.update({levels:S})}},u.update=function(T){var k,L,A,I,P=this.scene,S=P.fullSceneLayout,E=this.surface,z=n(T),D=P.dataScale,j=T.z[0].length,V=T._ylength,Z=P.contourLevels;this.data=T;var Q=[];for(k=0;k<3;k++)for(Q[k]=[],L=0;L<j;L++)Q[k][L]=[];for(L=0;L<j;L++)for(A=0;A<V;A++)Q[0][L][A]=this.getXat(L,A,T.xcalendar,S.xaxis),Q[1][L][A]=this.getYat(L,A,T.ycalendar,S.yaxis),Q[2][L][A]=this.getZat(L,A,T.zcalendar,S.zaxis);if(T.connectgaps)for(T._emptypoints=e(Q[2]),y(Q[2],T._emptypoints),T._interpolatedZ=[],L=0;L<j;L++)for(T._interpolatedZ[L]=[],A=0;A<V;A++)T._interpolatedZ[L][A]=Q[2][L][A];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])==null?Q[k][L][A]=NaN:I=Q[k][L][A]*=D[k];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])!=null&&(this.minValues[k]>I&&(this.minValues[k]=I),this.maxValues[k]<I&&(this.maxValues[k]=I));for(k=0;k<3;k++)this.objectOffset[k]=.5*(this.minValues[k]+this.maxValues[k]);for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])!=null&&(Q[k][L][A]-=this.objectOffset[k]);var K=[v(new Float32Array(j*V),[j,V]),v(new Float32Array(j*V),[j,V]),v(new Float32Array(j*V),[j,V])];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)K[k].set(L,A,Q[k][L][A]);Q=[];var $={colormap:z,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!T.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:T.opacityscale,opacity:T.opacity},ne=r(T);if($.intensityBounds=[ne.min,ne.max],T.surfacecolor){var H=v(new Float32Array(j*V),[j,V]);for(L=0;L<j;L++)for(A=0;A<V;A++)H.set(L,A,T.surfacecolor[A][L]);K.push(H)}else $.intensityBounds[0]*=D[2],$.intensityBounds[1]*=D[2];(x<K[0].shape[0]||x<K[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(K[0].shape[0],0),this.dataScaleY=this.estimateScale(K[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(K)),T.surfacecolor&&($.intensity=K.pop());var N=[!0,!0,!0],U=["x","y","z"];for(k=0;k<3;++k){var te=T.contours[U[k]];N[k]=te.highlight,$.showContour[k]=te.show||te.highlight,$.showContour[k]&&($.contourProject[k]=[te.project.x,te.project.y,te.project.z],te.show?(this.showContour[k]=!0,$.levels[k]=Z[k],E.highlightColor[k]=$.contourColor[k]=a(te.color),te.usecolormap?E.highlightTint[k]=$.contourTint[k]=0:E.highlightTint[k]=$.contourTint[k]=1,$.contourWidth[k]=te.width,this.contourStart[k]=te.start,this.contourEnd[k]=te.end,this.contourSize[k]=te.size):(this.showContour[k]=!1,this.contourStart[k]=null,this.contourEnd[k]=null,this.contourSize[k]=0),te.highlight&&($.dynamicColor[k]=a(te.highlightcolor),$.dynamicWidth[k]=te.highlightwidth))}(function(B){var X=B[0].rgb,J=B[B.length-1].rgb;return X[0]===J[0]&&X[1]===J[1]&&X[2]===J[2]&&X[3]===J[3]})(z)&&($.vertexColor=!0),$.objectOffset=this.objectOffset,$.coords=K,E.update($),E.visible=T.visible,E.enableDynamic=N,E.enableHighlight=N,E.snapToData=!0,"lighting"in T&&(E.ambientLight=T.lighting.ambient,E.diffuseLight=T.lighting.diffuse,E.specularLight=T.lighting.specular,E.roughness=T.lighting.roughness,E.fresnel=T.lighting.fresnel),"lightposition"in T&&(E.lightPosition=[T.lightposition.x,T.lightposition.y,T.lightposition.z])},u.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},G.exports=function(T,k){var L=T.glplot.gl,A=d({gl:L}),I=new g(T,A,k.uid);return A._trace=I,I.update(k),T.glplot.add(A),I}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(m,G,W){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/colorscale/defaults"),y=m("./attributes");function e(n,a,r,g){var u=g("opacityscale");u==="max"?a.opacityscale=[[0,.1],[1,1]]:u==="min"?a.opacityscale=[[0,1],[1,.1]]:u==="extremes"?a.opacityscale=function(s,h){for(var l=[],o=0;o<32;o++){var p=o/31,c=h+(1-h)*(1-Math.pow(Math.sin(s*p*Math.PI),2));l.push([p,Math.max(0,Math.min(1,c))])}return l}(1,.1):function(s){var h=0;if(!Array.isArray(s)||s.length<2||!s[0]||!s[s.length-1]||+s[0][0]!=0||+s[s.length-1][0]!=1)return!1;for(var l=0;l<s.length;l++){var o=s[l];if(o.length!==2||+o[0]<h)return!1;h=+o[0]}return!0}(u)||(a.opacityscale=void 0)}function t(n,a,r){a in n&&!(r in n)&&(n[r]=n[a])}G.exports={supplyDefaults:function(n,a,r,g){var u,s;function h(b,T){return v.coerce(n,a,y,b,T)}var l=h("x"),o=h("y"),p=h("z");if(!p||!p.length||l&&l.length<1||o&&o.length<1)a.visible=!1;else{a._xlength=Array.isArray(l)&&v.isArrayOrTypedArray(l[0])?p.length:p[0].length,a._ylength=p.length,d.getComponentMethod("calendars","handleTraceDefaults")(n,a,["x","y","z"],g),h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),h("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(b){h(b)});var c=h("surfacecolor"),i=["x","y","z"];for(u=0;u<3;++u){var x="contours."+i[u],f=h(x+".show"),_=h(x+".highlight");if(f||_)for(s=0;s<3;++s)h(x+".project."+i[s]);f&&(h(x+".color"),h(x+".width"),h(x+".usecolormap")),_&&(h(x+".highlightcolor"),h(x+".highlightwidth")),h(x+".start"),h(x+".end"),h(x+".size")}c||(t(n,"zmin","cmin"),t(n,"zmax","cmax"),t(n,"zauto","cauto")),w(n,a,g,h,{prefix:"",cLetter:"c"}),e(n,a,g,h),a._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:m("./calc"),plot:m("./convert"),moduleType:"trace",name:"surface",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(m,G,W){var d=m("../../components/annotations/attributes"),v=m("../../lib/extend").extendFlat,w=m("../../plot_api/edit_types").overrideAll,y=m("../../plots/font_attributes"),e=m("../../plots/domain").attributes,t=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(G.exports=w({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:t("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:v({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},y({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:t("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:v({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},y({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(m,G,W){var d=m("../../plots/get_data").getModuleCalcData,v=m("./plot");W.name="table",W.plot=function(w){var y=d(w.calcdata,"table")[0];y.length&&v(w,y)},W.clean=function(w,y,e,t){var n=t._has&&t._has("table"),a=y._has&&y._has("table");n&&!a&&t._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(m,G,W){var d=m("../../lib/gup").wrap;G.exports=function(){return d({})}},{"../../lib/gup":512}],1078:[function(m,G,W){G.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(m,G,W){var d=m("./constants"),v=m("../../lib/extend").extendFlat,w=m("fast-isnumeric");function y(u){if(Array.isArray(u)){for(var s=0,h=0;h<u.length;h++)s=Math.max(s,y(u[h]));return s}return u}function e(u,s){return u+s}function t(u){var s,h=u.slice(),l=1/0,o=0;for(s=0;s<h.length;s++)Array.isArray(h[s])||(h[s]=[h[s]]),l=Math.min(l,h[s].length),o=Math.max(o,h[s].length);if(l!==o)for(s=0;s<h.length;s++){var p=o-h[s].length;p&&(h[s]=h[s].concat(n(p)))}return h}function n(u){for(var s=new Array(u),h=0;h<u;h++)s[h]="";return s}function a(u){return u.calcdata.columns.reduce(function(s,h){return h.xIndex<u.xIndex?s+h.columnWidth:s},0)}function r(u,s){return Object.keys(u).map(function(h){return v({},u[h],{auxiliaryBlocks:s})})}function g(u,s){for(var h,l={},o=0,p=0,c={firstRowIndex:null,lastRowIndex:null,rows:[]},i=0,x=0,f=0;f<u.length;f++)h=u[f],c.rows.push({rowIndex:f,rowHeight:h}),((p+=h)>=s||f===u.length-1)&&(l[o]=c,c.key=x++,c.firstRowIndex=i,c.lastRowIndex=f,c={firstRowIndex:null,lastRowIndex:null,rows:[]},o+=p,i=f+1,p=0);return l}G.exports=function(u,s){var h=t(s.cells.values),l=function(D){return D.slice(s.header.values.length,D.length)},o=t(s.header.values);o.length&&!o[0].length&&(o[0]=[""],o=t(o));var p=o.concat(l(h).map(function(){return n((o[0]||[""]).length)})),c=s.domain,i=Math.floor(u._fullLayout._size.w*(c.x[1]-c.x[0])),x=Math.floor(u._fullLayout._size.h*(c.y[1]-c.y[0])),f=s.header.values.length?p[0].map(function(){return s.header.height}):[d.emptyHeaderHeight],_=h.length?h[0].map(function(){return s.cells.height}):[],b=f.reduce(e,0),T=g(_,x-b+d.uplift),k=r(g(f,b),[]),L=r(T,k),A={},I=s._fullInput.columnorder.concat(l(h.map(function(D,j){return j}))),P=p.map(function(D,j){var V=Array.isArray(s.columnwidth)?s.columnwidth[Math.min(j,s.columnwidth.length-1)]:s.columnwidth;return w(V)?Number(V):1}),S=P.reduce(e,0);P=P.map(function(D){return D/S*i});var E=Math.max(y(s.header.line.width),y(s.cells.line.width)),z={key:s.uid+u._context.staticPlot,translateX:c.x[0]*u._fullLayout._size.w,translateY:u._fullLayout._size.h*(1-c.y[1]),size:u._fullLayout._size,width:i,maxLineWidth:E,height:x,columnOrder:I,groupHeight:x,rowBlocks:L,headerRowBlocks:k,scrollY:0,cells:v({},s.cells,{values:h}),headerCells:v({},s.header,{values:p}),gdColumns:p.map(function(D){return D[0]}),gdColumnsOriginalOrder:p.map(function(D){return D[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:p.map(function(D,j){var V=A[D];return A[D]=(V||0)+1,{key:D+"__"+A[D],label:D,specIndex:j,xIndex:I[j],xScale:a,x:void 0,calcdata:void 0,columnWidth:P[j]}})};return z.columns.forEach(function(D){D.calcdata=z,D.x=a(D)}),z}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(m,G,W){var d=m("../../lib/extend").extendFlat;W.splitToPanels=function(v){var w=[0,0],y=d({},v,{key:"header",type:"header",page:0,prevPages:w,currentRepaint:[null,null],dragHandle:!0,values:v.calcdata.headerCells.values[v.specIndex],rowBlocks:v.calcdata.headerRowBlocks,calcdata:d({},v.calcdata,{cells:v.calcdata.headerCells})});return[d({},v,{key:"cells1",type:"cells",page:0,prevPages:w,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),d({},v,{key:"cells2",type:"cells",page:1,prevPages:w,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),y]},W.splitToCells=function(v){var w=function(y){var e=y.rowBlocks[y.page],t=e?e.rows[0].rowIndex:0,n=e?t+e.rows.length:0;return[t,n]}(v);return(v.values||[]).slice(w[0],w[1]).map(function(y,e){return{keyWithinBlock:e+(typeof y=="string"&&y.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:w[0]+e,column:v,calcdata:v.calcdata,page:v.page,rowBlocks:v.rowBlocks,value:y}})}},{"../../lib/extend":505}],1081:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults;G.exports=function(y,e,t,n){function a(r,g){return d.coerce(y,e,v,r,g)}w(e,n,a),a("columnwidth"),a("header.values"),a("header.format"),a("header.align"),a("header.prefix"),a("header.suffix"),a("header.height"),a("header.line.width"),a("header.line.color"),a("header.fill.color"),d.coerceFont(a,"header.font",d.extendFlat({},n.font)),function(r,g){for(var u=r.columnorder||[],s=r.header.values.length,h=u.slice(0,s),l=h.slice().sort(function(c,i){return c-i}),o=h.map(function(c){return l.indexOf(c)}),p=o.length;p<s;p++)o.push(p);g("columnorder",o)}(e,a),a("cells.values"),a("cells.format"),a("cells.align"),a("cells.prefix"),a("cells.suffix"),a("cells.height"),a("cells.line.width"),a("cells.line.color"),a("cells.fill.color"),d.coerceFont(a,"cells.font",d.extendFlat({},n.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),moduleType:"trace",name:"table",basePlotModule:m("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(m,G,W){var d=m("./constants"),v=m("@plotly/d3"),w=m("../../lib").numberFormat,y=m("../../lib/gup"),e=m("../../components/drawing"),t=m("../../lib/svg_text_utils"),n=m("../../lib").raiseToTop,a=m("../../lib").strTranslate,r=m("../../lib").cancelTransition,g=m("./data_preparation_helper"),u=m("./data_split_helpers"),s=m("../../components/color");function h(K){return Math.ceil(K.calcdata.maxLineWidth/2)}function l(K,$){return"clip"+K._fullLayout._uid+"_scrollAreaBottomClip_"+$.key}function o(K,$){return"clip"+K._fullLayout._uid+"_columnBoundaryClippath_"+$.calcdata.key+"_"+$.specIndex}function p(K){return[].concat.apply([],K.map(function($){return $})).map(function($){return $.__data__})}function c(K,$,ne){var H=K.selectAll("."+d.cn.scrollbarKit).data(y.repeat,y.keyFun);H.enter().append("g").classed(d.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),H.each(function(X){var J=X.scrollbarState;J.totalHeight=function(ee){var re=ee.rowBlocks;return j(re,re.length-1)+(re.length?V(re[re.length-1],1/0):1)}(X),J.scrollableAreaHeight=X.groupHeight-L(X),J.currentlyVisibleHeight=Math.min(J.totalHeight,J.scrollableAreaHeight),J.ratio=J.currentlyVisibleHeight/J.totalHeight,J.barLength=Math.max(J.ratio*J.currentlyVisibleHeight,d.goldenRatio*d.scrollbarWidth),J.barWiggleRoom=J.currentlyVisibleHeight-J.barLength,J.wiggleRoom=Math.max(0,J.totalHeight-J.scrollableAreaHeight),J.topY=J.barWiggleRoom===0?0:X.scrollY/J.wiggleRoom*J.barWiggleRoom,J.bottomY=J.topY+J.barLength,J.dragMultiplier=J.wiggleRoom/J.barWiggleRoom}).attr("transform",function(X){var J=X.width+d.scrollbarWidth/2+d.scrollbarOffset;return a(J,L(X))});var N=H.selectAll("."+d.cn.scrollbar).data(y.repeat,y.keyFun);N.enter().append("g").classed(d.cn.scrollbar,!0);var U=N.selectAll("."+d.cn.scrollbarSlider).data(y.repeat,y.keyFun);U.enter().append("g").classed(d.cn.scrollbarSlider,!0),U.attr("transform",function(X){return a(0,X.scrollbarState.topY||0)});var te=U.selectAll("."+d.cn.scrollbarGlyph).data(y.repeat,y.keyFun);te.enter().append("line").classed(d.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",d.scrollbarWidth).attr("stroke-linecap","round").attr("y1",d.scrollbarWidth/2),te.attr("y2",function(X){return X.scrollbarState.barLength-d.scrollbarWidth/2}).attr("stroke-opacity",function(X){return X.columnDragInProgress||!X.scrollbarState.barWiggleRoom||ne?0:.4}),te.transition().delay(0).duration(0),te.transition().delay(d.scrollbarHideDelay).duration(d.scrollbarHideDuration).attr("stroke-opacity",0);var B=N.selectAll("."+d.cn.scrollbarCaptureZone).data(y.repeat,y.keyFun);B.enter().append("line").classed(d.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",d.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(X){var J=v.event.y,ee=this.getBoundingClientRect(),re=X.scrollbarState,se=J-ee.top,oe=v.scale.linear().domain([0,re.scrollableAreaHeight]).range([0,re.totalHeight]).clamp(!0);re.topY<=se&&se<=re.bottomY||I($,K,null,oe(se-re.barLength/2))(X)}).call(v.behavior.drag().origin(function(X){return v.event.stopPropagation(),X.scrollbarState.scrollbarScrollInProgress=!0,X}).on("drag",I($,K)).on("dragend",function(){})),B.attr("y2",function(X){return X.scrollbarState.scrollableAreaHeight}),$._context.staticPlot&&(te.remove(),B.remove())}function i(K,$,ne,H){var N=function(te){var B=te.selectAll("."+d.cn.columnCell).data(u.splitToCells,function(X){return X.keyWithinBlock});return B.enter().append("g").classed(d.cn.columnCell,!0),B.exit().remove(),B}(function(te){var B=te.selectAll("."+d.cn.columnCells).data(y.repeat,y.keyFun);return B.enter().append("g").classed(d.cn.columnCells,!0),B.exit().remove(),B}(ne));(function(te){te.each(function(B,X){var J=B.calcdata.cells.font,ee=B.column.specIndex,re={size:_(J.size,ee,X),color:_(J.color,ee,X),family:_(J.family,ee,X)};B.rowNumber=B.key,B.align=_(B.calcdata.cells.align,ee,X),B.cellBorderWidth=_(B.calcdata.cells.line.width,ee,X),B.font=re})})(N),function(te){te.attr("width",function(B){return B.column.columnWidth}).attr("stroke-width",function(B){return B.cellBorderWidth}).each(function(B){var X=v.select(this);s.stroke(X,_(B.calcdata.cells.line.color,B.column.specIndex,B.rowNumber)),s.fill(X,_(B.calcdata.cells.fill.color,B.column.specIndex,B.rowNumber))})}(function(te){var B=te.selectAll("."+d.cn.cellRect).data(y.repeat,function(X){return X.keyWithinBlock});return B.enter().append("rect").classed(d.cn.cellRect,!0),B}(N));var U=function(te){var B=te.selectAll("."+d.cn.cellText).data(y.repeat,function(X){return X.keyWithinBlock});return B.enter().append("text").classed(d.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){v.event.stopPropagation()}),B}(function(te){var B=te.selectAll("."+d.cn.cellTextHolder).data(y.repeat,function(X){return X.keyWithinBlock});return B.enter().append("g").classed(d.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),B}(N));(function(te){te.each(function(B){e.font(v.select(this),B.font)})})(U),x(U,$,H,K),D(N)}function x(K,$,ne,H){K.text(function(N){var U=N.column.specIndex,te=N.rowNumber,B=N.value,X=typeof B=="string",J=X&&B.match(/<br>/i),ee=!X||J;N.mayHaveMarkup=X&&B.match(/[<&>]/);var re,se=typeof(re=B)=="string"&&re.match(d.latexCheck);N.latex=se;var oe,de,ce=se?"":_(N.calcdata.cells.prefix,U,te)||"",ve=se?"":_(N.calcdata.cells.suffix,U,te)||"",Ae=se?null:_(N.calcdata.cells.format,U,te)||null,fe=ce+(Ae?w(Ae)(N.value):N.value)+ve;if(N.wrappingNeeded=!N.wrapped&&!ee&&!se&&(oe=f(fe)),N.cellHeightMayIncrease=J||se||N.mayHaveMarkup||(oe===void 0?f(fe):oe),N.needsConvertToTspans=N.mayHaveMarkup||N.wrappingNeeded||N.latex,N.wrappingNeeded){var me=(d.wrapSplitCharacter===" "?fe.replace(/<a href=/gi,"<a_href="):fe).split(d.wrapSplitCharacter),_e=d.wrapSplitCharacter===" "?me.map(function(le){return le.replace(/<a_href=/gi,"<a href=")}):me;N.fragments=_e.map(function(le){return{text:le,width:null}}),N.fragments.push({fragment:d.wrapSpacer,width:null}),de=_e.join(d.lineBreaker)+d.lineBreaker+d.wrapSpacer}else delete N.fragments,de=fe;return de}).attr("dy",function(N){return N.needsConvertToTspans?0:"0.75em"}).each(function(N){var U=v.select(this),te=N.wrappingNeeded?S:E;N.needsConvertToTspans?t.convertToTspans(U,H,te(ne,this,$,H,N)):v.select(this.parentNode).attr("transform",function(B){return a(z(B),d.cellPad)}).attr("text-anchor",function(B){return{left:"start",center:"middle",right:"end"}[B.align]})})}function f(K){return K.indexOf(d.wrapSplitCharacter)!==-1}function _(K,$,ne){if(Array.isArray(K)){var H=K[Math.min($,K.length-1)];return Array.isArray(H)?H[Math.min(ne,H.length-1)]:H}return K}function b(K,$,ne){K.transition().ease(d.releaseTransitionEase).duration(d.releaseTransitionDuration).attr("transform",a($.x,ne))}function T(K){return K.type==="cells"}function k(K){return K.type==="header"}function L(K){return(K.rowBlocks.length?K.rowBlocks[0].auxiliaryBlocks:[]).reduce(function($,ne){return $+V(ne,1/0)},0)}function A(K,$,ne){var H=p($)[0];if(H!==void 0){var N=H.rowBlocks,U=H.calcdata,te=j(N,N.length),B=H.calcdata.groupHeight-L(H),X=U.scrollY=Math.max(0,Math.min(te-B,U.scrollY)),J=function(ee,re,se){for(var oe=[],de=0,ce=0;ce<ee.length;ce++){for(var ve=ee[ce],Ae=ve.rows,fe=0,me=0;me<Ae.length;me++)fe+=Ae[me].rowHeight;ve.allRowsHeight=fe,re<de+fe&&re+se>de&&oe.push(ce),de+=fe}return oe}(N,X,B);J.length===1&&(J[0]===N.length-1?J.unshift(J[0]-1):J.push(J[0]+1)),J[0]%2&&J.reverse(),$.each(function(ee,re){ee.page=J[re],ee.scrollY=X}),$.attr("transform",function(ee){var re=j(ee.rowBlocks,ee.page)-ee.scrollY;return a(0,re)}),K&&(P(K,ne,$,J,H.prevPages,H,0),P(K,ne,$,J,H.prevPages,H,1),c(ne,K))}}function I(K,$,ne,H){return function(N){var U=N.calcdata?N.calcdata:N,te=$.filter(function(ee){return U.key===ee.key}),B=ne||U.scrollbarState.dragMultiplier,X=U.scrollY;U.scrollY=H===void 0?U.scrollY+B*v.event.dy:H;var J=te.selectAll("."+d.cn.yColumn).selectAll("."+d.cn.columnBlock).filter(T);return A(K,J,te),U.scrollY===X}}function P(K,$,ne,H,N,U,te){H[te]!==N[te]&&(clearTimeout(U.currentRepaint[te]),U.currentRepaint[te]=setTimeout(function(){var B=ne.filter(function(X,J){return J===te&&H[J]!==N[J]});i(K,$,B,ne),N[te]=H[te]}))}function S(K,$,ne,H){return function(){var N=v.select($.parentNode);N.each(function(U){var te=U.fragments;N.selectAll("tspan.line").each(function(de,ce){te[ce].width=this.getComputedTextLength()});var B,X,J=te[te.length-1].width,ee=te.slice(0,-1),re=[],se=0,oe=U.column.columnWidth-2*d.cellPad;for(U.value="";ee.length;)se+(X=(B=ee.shift()).width+J)>oe&&(U.value+=re.join(d.wrapSpacer)+d.lineBreaker,re=[],se=0),re.push(B.text),se+=X;se&&(U.value+=re.join(d.wrapSpacer)),U.wrapped=!0}),N.selectAll("tspan.line").remove(),x(N.select("."+d.cn.cellText),ne,K,H),v.select($.parentNode.parentNode).call(D)}}function E(K,$,ne,H,N){return function(){if(!N.settledY){var U=v.select($.parentNode),te=Q(N),B=N.key-te.firstRowIndex,X=te.rows[B].rowHeight,J=N.cellHeightMayIncrease?$.parentNode.getBoundingClientRect().height+2*d.cellPad:X,ee=Math.max(J,X);ee-te.rows[B].rowHeight&&(te.rows[B].rowHeight=ee,K.selectAll("."+d.cn.columnCell).call(D),A(null,K.filter(T),0),c(ne,H,!0)),U.attr("transform",function(){var re=this.parentNode.getBoundingClientRect(),se=v.select(this.parentNode).select("."+d.cn.cellRect).node().getBoundingClientRect(),oe=this.transform.baseVal.consolidate(),de=se.top-re.top+(oe?oe.matrix.f:d.cellPad);return a(z(N,v.select(this.parentNode).select("."+d.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),N.settledY=!0}}}function z(K,$){switch(K.align){case"left":return d.cellPad;case"right":return K.column.columnWidth-($||0)-d.cellPad;case"center":return(K.column.columnWidth-($||0))/2;default:return d.cellPad}}function D(K){K.attr("transform",function($){var ne=$.rowBlocks[0].auxiliaryBlocks.reduce(function(N,U){return N+V(U,1/0)},0),H=V(Q($),$.key);return a(0,H+ne)}).selectAll("."+d.cn.cellRect).attr("height",function($){return(ne=Q($),H=$.key,ne.rows[H-ne.firstRowIndex]).rowHeight;var ne,H})}function j(K,$){for(var ne=0,H=$-1;H>=0;H--)ne+=Z(K[H]);return ne}function V(K,$){for(var ne=0,H=0;H<K.rows.length&&K.rows[H].rowIndex<$;H++)ne+=K.rows[H].rowHeight;return ne}function Z(K){var $=K.allRowsHeight;if($!==void 0)return $;for(var ne=0,H=0;H<K.rows.length;H++)ne+=K.rows[H].rowHeight;return K.allRowsHeight=ne,ne}function Q(K){return K.rowBlocks[K.page]}G.exports=function(K,$){var ne=!K._context.staticPlot,H=K._fullLayout._paper.selectAll("."+d.cn.table).data($.map(function(ve){var Ae=y.unwrap(ve).trace;return g(K,Ae)}),y.keyFun);H.exit().remove(),H.enter().append("g").classed(d.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),H.attr("width",function(ve){return ve.width+ve.size.l+ve.size.r}).attr("height",function(ve){return ve.height+ve.size.t+ve.size.b}).attr("transform",function(ve){return a(ve.translateX,ve.translateY)});var N=H.selectAll("."+d.cn.tableControlView).data(y.repeat,y.keyFun),U=N.enter().append("g").classed(d.cn.tableControlView,!0).style("box-sizing","content-box");if(ne){var te="onwheel"in document?"wheel":"mousewheel";U.on("mousemove",function(ve){N.filter(function(Ae){return ve===Ae}).call(c,K)}).on(te,function(ve){if(!ve.scrollbarState.wheeling){ve.scrollbarState.wheeling=!0;var Ae=ve.scrollY+v.event.deltaY;I(K,N,null,Ae)(ve)||(v.event.stopPropagation(),v.event.preventDefault()),ve.scrollbarState.wheeling=!1}}).call(c,K,!0)}N.attr("transform",function(ve){return a(ve.size.l,ve.size.t)});var B=N.selectAll("."+d.cn.scrollBackground).data(y.repeat,y.keyFun);B.enter().append("rect").classed(d.cn.scrollBackground,!0).attr("fill","none"),B.attr("width",function(ve){return ve.width}).attr("height",function(ve){return ve.height}),N.each(function(ve){e.setClipUrl(v.select(this),l(K,ve),K)});var X=N.selectAll("."+d.cn.yColumn).data(function(ve){return ve.columns},y.keyFun);X.enter().append("g").classed(d.cn.yColumn,!0),X.exit().remove(),X.attr("transform",function(ve){return a(ve.x,0)}),ne&&X.call(v.behavior.drag().origin(function(ve){return b(v.select(this),ve,-d.uplift),n(this),ve.calcdata.columnDragInProgress=!0,c(N.filter(function(Ae){return ve.calcdata.key===Ae.key}),K),ve}).on("drag",function(ve){var Ae=v.select(this),fe=function(me){return(ve===me?v.event.x:me.x)+me.columnWidth/2};ve.x=Math.max(-d.overdrag,Math.min(ve.calcdata.width+d.overdrag-ve.columnWidth,v.event.x)),p(X).filter(function(me){return me.calcdata.key===ve.calcdata.key}).sort(function(me,_e){return fe(me)-fe(_e)}).forEach(function(me,_e){me.xIndex=_e,me.x=ve===me?me.x:me.xScale(me)}),X.filter(function(me){return ve!==me}).transition().ease(d.transitionEase).duration(d.transitionDuration).attr("transform",function(me){return a(me.x,0)}),Ae.call(r).attr("transform",a(ve.x,-d.uplift))}).on("dragend",function(ve){var Ae=v.select(this),fe=ve.calcdata;ve.x=ve.xScale(ve),ve.calcdata.columnDragInProgress=!1,b(Ae,ve,0),function(me,_e,le){var ge=_e.gdColumnsOriginalOrder;_e.gdColumns.sort(function(Te,Se){return le[ge.indexOf(Te)]-le[ge.indexOf(Se)]}),_e.columnorder=le,me.emit("plotly_restyle")}(K,fe,fe.columns.map(function(me){return me.xIndex}))})),X.each(function(ve){e.setClipUrl(v.select(this),o(K,ve),K)});var J=X.selectAll("."+d.cn.columnBlock).data(u.splitToPanels,y.keyFun);J.enter().append("g").classed(d.cn.columnBlock,!0).attr("id",function(ve){return ve.key}),J.style("cursor",function(ve){return ve.dragHandle?"ew-resize":ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ee=J.filter(k),re=J.filter(T);ne&&re.call(v.behavior.drag().origin(function(ve){return v.event.stopPropagation(),ve}).on("drag",I(K,N,-1)).on("dragend",function(){})),i(K,N,ee,J),i(K,N,re,J);var se=N.selectAll("."+d.cn.scrollAreaClip).data(y.repeat,y.keyFun);se.enter().append("clipPath").classed(d.cn.scrollAreaClip,!0).attr("id",function(ve){return l(K,ve)});var oe=se.selectAll("."+d.cn.scrollAreaClipRect).data(y.repeat,y.keyFun);oe.enter().append("rect").classed(d.cn.scrollAreaClipRect,!0).attr("x",-d.overdrag).attr("y",-d.uplift).attr("fill","none"),oe.attr("width",function(ve){return ve.width+2*d.overdrag}).attr("height",function(ve){return ve.height+d.uplift}),X.selectAll("."+d.cn.columnBoundary).data(y.repeat,y.keyFun).enter().append("g").classed(d.cn.columnBoundary,!0);var de=X.selectAll("."+d.cn.columnBoundaryClippath).data(y.repeat,y.keyFun);de.enter().append("clipPath").classed(d.cn.columnBoundaryClippath,!0),de.attr("id",function(ve){return o(K,ve)});var ce=de.selectAll("."+d.cn.columnBoundaryRect).data(y.repeat,y.keyFun);ce.enter().append("rect").classed(d.cn.columnBoundaryRect,!0).attr("fill","none"),ce.attr("width",function(ve){return ve.columnWidth+2*h(ve)}).attr("height",function(ve){return ve.calcdata.height+2*h(ve)+d.uplift}).attr("x",function(ve){return-h(ve)}).attr("y",function(ve){return-h(ve)}),A(null,re,N)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(m,G,W){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../components/colorscale/attributes"),y=m("../../plots/domain").attributes,e=m("../pie/attributes"),t=m("../sunburst/attributes"),n=m("./constants"),a=m("../../lib/extend").extendFlat;G.exports={labels:t.labels,parents:t.parents,values:t.values,branchvalues:t.branchvalues,count:t.count,level:t.level,maxdepth:t.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:t.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:t.marker.line,editType:"calc"},w("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:t.textinfo,texttemplate:v({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:t.hoverinfo,hovertemplate:d({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:t.root,domain:y({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(m,G,W){var d=m("../../plots/plots");W.name="treemap",W.plot=function(v,w,y,e){d.plotBasePlot(W.name,v,w,y,e)},W.clean=function(v,w,y,e){d.cleanBasePlot(W.name,v,w,y,e)}},{"../../plots/plots":628}],1086:[function(m,G,W){var d=m("../sunburst/calc");W.calc=function(v,w){return d.calc(v,w)},W.crossTraceCalc=function(v){return d._runCrossTraceCalc("treemap",v)}},{"../sunburst/calc":1060}],1087:[function(m,G,W){G.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText,t=m("../bar/constants").TEXTPAD,n=m("../../components/colorscale"),a=n.hasColorscale,r=n.handleDefaults;G.exports=function(g,u,s,h){function l(T,k){return d.coerce(g,u,v,T,k)}var o=l("labels"),p=l("parents");if(o&&o.length&&p&&p.length){var c=l("values");c&&c.length?l("branchvalues"):l("count"),l("level"),l("maxdepth"),l("tiling.packing")==="squarify"&&l("tiling.squarifyratio"),l("tiling.flip"),l("tiling.pad");var i=l("text");l("texttemplate"),u.texttemplate||l("textinfo",Array.isArray(i)?"text+label":"label"),l("hovertext"),l("hovertemplate");var x=l("pathbar.visible");e(g,u,h,l,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition");var f=u.textposition.indexOf("bottom")!==-1;l("marker.line.width")&&l("marker.line.color",h.paper_bgcolor);var _=l("marker.colors");(u._hasColorscale=a(g,"marker","colors")||(g.marker||{}).coloraxis)?r(g,u,h,l,{prefix:"marker.",cLetter:"c"}):l("marker.depthfade",!(_||[]).length);var b=2*u.textfont.size;l("marker.pad.t",f?b/4:b),l("marker.pad.l",b/4),l("marker.pad.r",b/4),l("marker.pad.b",f?b:b/4),u._hovered={marker:{line:{width:2,color:w.contrast(h.paper_bgcolor)}}},x&&(l("pathbar.thickness",u.pathbar.textfont.size+2*t),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),y(u,h,l),u._length=null}else u.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(m,G,W){var d=m("@plotly/d3"),v=m("../sunburst/helpers"),w=m("../bar/uniform_text").clearMinTextSize,y=m("../bar/style").resizeText,e=m("./plot_one");G.exports=function(t,n,a,r,g){var u,s,h=g.type,l=g.drawDescendants,o=t._fullLayout,p=o["_"+h+"layer"],c=!a;w(h,o),(u=p.selectAll("g.trace."+h).data(n,function(i){return i[0].trace.uid})).enter().append("g").classed("trace",!0).classed(h,!0),u.order(),!o.uniformtext.mode&&v.hasTransition(a)?(r&&(s=r()),d.transition().duration(a.duration).ease(a.easing).each("end",function(){s&&s()}).each("interrupt",function(){s&&s()}).each(function(){p.selectAll("g.trace").each(function(i){e(t,i,this,a,l)})})):(u.each(function(i){e(t,i,this,a,l)}),o.uniformtext.mode&&y(t,p.selectAll(".trace"),h)),c&&u.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("./constants"),a=m("../sunburst/helpers"),r=m("../sunburst/fx");G.exports=function(g,u,s,h,l){var o=l.barDifY,p=l.width,c=l.height,i=l.viewX,x=l.viewY,f=l.pathSlice,_=l.toMoveInsideSlice,b=l.strTransform,T=l.hasTransition,k=l.handleSlicesExit,L=l.makeUpdateSliceInterpolator,A=l.makeUpdateTextInterpolator,I={},P=g._context.staticPlot,S=g._fullLayout,E=u[0],z=E.trace,D=E.hierarchy,j=p/z._entryDepth,V=a.listPath(s.data,"id"),Z=e(D.copy(),[p,c],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(Z=Z.filter(function(K){var $=V.indexOf(K.data.id);return $!==-1&&(K.x0=j*$,K.x1=j*($+1),K.y0=o,K.y1=o+c,K.onPathbar=!0,!0)})).reverse(),(h=h.data(Z,a.getPtId)).enter().append("g").classed("pathbar",!0),k(h,!0,I,[p,c],f),h.order();var Q=h;T&&(Q=Q.transition().each("end",function(){var K=d.select(this);a.setSliceCursor(K,g,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),Q.each(function(K){K._x0=i(K.x0),K._x1=i(K.x1),K._y0=x(K.y0),K._y1=x(K.y1),K._hoverX=i(K.x1-Math.min(p,c)/2),K._hoverY=x(K.y1-c/2);var $=d.select(this),ne=v.ensureSingle($,"path","surface",function(te){te.style("pointer-events",P?"none":"all")});T?ne.transition().attrTween("d",function(te){var B=L(te,!0,I,[p,c]);return function(X){return f(B(X))}}):ne.attr("d",f),$.call(r,s,g,u,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,g,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:g._transitioning}),ne.call(t,K,z,{hovered:!1}),K._text=(a.getPtLabel(K)||"").split("<br>").join(" ")||"";var H=v.ensureSingle($,"g","slicetext"),N=v.ensureSingle(H,"text","",function(te){te.attr("data-notex",1)}),U=v.ensureUniformFontSize(g,a.determineTextFont(z,K,S.font,{onPathbar:!0}));N.text(K._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(w.font,U).call(y.convertToTspans,g),K.textBB=w.bBox(N.node()),K.transform=_(K,{fontSize:U.size,onPathbar:!0}),K.transform.fontSize=U.size,T?N.transition().attrTween("transform",function(te){var B=A(te,!0,I,[p,c]);return function(X){return b(B(X))}}):N.attr("transform",b(K))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("./constants"),a=m("../sunburst/helpers"),r=m("../sunburst/fx"),g=m("../sunburst/plot").formatSliceLabel;G.exports=function(u,s,h,l,o){var p=o.width,c=o.height,i=o.viewX,x=o.viewY,f=o.pathSlice,_=o.toMoveInsideSlice,b=o.strTransform,T=o.hasTransition,k=o.handleSlicesExit,L=o.makeUpdateSliceInterpolator,A=o.makeUpdateTextInterpolator,I=o.prevEntry,P=u._context.staticPlot,S=u._fullLayout,E=s[0].trace,z=E.textposition.indexOf("left")!==-1,D=E.textposition.indexOf("right")!==-1,j=E.textposition.indexOf("bottom")!==-1,V=!j&&!E.marker.pad.t||j&&!E.marker.pad.b,Z=e(h,[p,c],{packing:E.tiling.packing,squarifyratio:E.tiling.squarifyratio,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,pad:{inner:E.tiling.pad,top:E.marker.pad.t,left:E.marker.pad.l,right:E.marker.pad.r,bottom:E.marker.pad.b}}).descendants(),Q=1/0,K=-1/0;Z.forEach(function(U){var te=U.depth;te>=E._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Q=Math.min(Q,te),K=Math.max(K,te))}),l=l.data(Z,a.getPtId),E._maxVisibleLayers=isFinite(K)?K-Q+1:0,l.enter().append("g").classed("slice",!0),k(l,!1,{},[p,c],f),l.order();var $=null;if(T&&I){var ne=a.getPtId(I);l.each(function(U){$===null&&a.getPtId(U)===ne&&($={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var H=function(){return $||{x0:0,x1:p,y0:0,y1:c}},N=l;return T&&(N=N.transition().each("end",function(){var U=d.select(this);a.setSliceCursor(U,u,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(U){var te=a.isHeader(U,E);U._x0=i(U.x0),U._x1=i(U.x1),U._y0=x(U.y0),U._y1=x(U.y1),U._hoverX=i(U.x1-E.marker.pad.r),U._hoverY=x(j?U.y1-E.marker.pad.b/2:U.y0+E.marker.pad.t/2);var B=d.select(this),X=v.ensureSingle(B,"path","surface",function(se){se.style("pointer-events",P?"none":"all")});T?X.transition().attrTween("d",function(se){var oe=L(se,!1,H(),[p,c]);return function(de){return f(oe(de))}}):X.attr("d",f),B.call(r,h,u,s,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,u,{isTransitioning:u._transitioning}),X.call(t,U,E,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":U._text=te?V?"":a.getPtLabel(U)||"":g(U,h,E,s,S)||"";var J=v.ensureSingle(B,"g","slicetext"),ee=v.ensureSingle(J,"text","",function(se){se.attr("data-notex",1)}),re=v.ensureUniformFontSize(u,a.determineTextFont(E,U,S.font));ee.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":z||te?"start":"middle").call(w.font,re).call(y.convertToTspans,u),U.textBB=w.bBox(ee.node()),U.transform=_(U,{fontSize:re.size,isHeader:te}),U.transform.fontSize=re.size,T?ee.transition().attrTween("transform",function(se){var oe=A(se,!1,H(),[p,c]);return function(de){return b(oe(de))}}):ee.attr("transform",b(U))}),$}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(m,G,W){G.exports=function d(v,w,y){var e;y.swapXY&&(e=v.x0,v.x0=v.y0,v.y0=e,e=v.x1,v.x1=v.y1,v.y1=e),y.flipX&&(e=v.x0,v.x0=w[0]-v.x1,v.x1=w[0]-e),y.flipY&&(e=v.y0,v.y0=w[1]-v.y1,v.y1=w[1]-e);var t=v.children;if(t)for(var n=0;n<t.length;n++)d(t[n],w,y)}},{}],1093:[function(m,G,W){G.exports={moduleType:"trace",name:"treemap",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(m,G,W){G.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("treemapcolorway",y.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(m,G,W){var d=m("d3-hierarchy"),v=m("./flip_tree");G.exports=function(w,y,e){var t,n=e.flipX,a=e.flipY,r=e.packing==="dice-slice",g=e.pad[a?"bottom":"top"],u=e.pad[n?"right":"left"],s=e.pad[n?"left":"right"],h=e.pad[a?"top":"bottom"];r&&(t=u,u=g,g=t,t=s,s=h,h=t);var l=d.treemap().tile(function(o,p){switch(o){case"squarify":return d.treemapSquarify.ratio(p);case"binary":return d.treemapBinary;case"dice":return d.treemapDice;case"slice":return d.treemapSlice;default:return d.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(u).paddingRight(s).paddingTop(g).paddingBottom(h).size(r?[y[1],y[0]]:y)(w);return(r||n||a)&&v(l,y,{swapXY:r,flipX:n,flipY:a}),l}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(m,G,W){var d=m("./draw"),v=m("./draw_descendants");G.exports=function(w,y,e,t){return d(w,y,e,t,{type:"treemap",drawDescendants:v})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(m,G,W){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolate,w=m("../sunburst/helpers"),y=m("../../lib"),e=m("../bar/constants").TEXTPAD,t=m("../bar/plot").toMoveInsideBar,n=m("../bar/uniform_text").recordMinTextSize,a=m("./constants"),r=m("./draw_ancestors");function g(u){return w.isHierarchyRoot(u)?"":w.getPtId(u)}G.exports=function(u,s,h,l,o){var p=u._fullLayout,c=s[0],i=c.trace,x=i.type==="icicle",f=c.hierarchy,_=w.findEntryWithLevel(f,i.level),b=d.select(h),T=b.selectAll("g.pathbar"),k=b.selectAll("g.slice");if(!_)return T.remove(),void k.remove();var L=w.isHierarchyRoot(_),A=!p.uniformtext.mode&&w.hasTransition(l),I=w.getMaxDepth(i),P=p._size,S=i.domain,E=P.w*(S.x[1]-S.x[0]),z=P.h*(S.y[1]-S.y[0]),D=E,j=i.pathbar.thickness,V=i.marker.line.width+a.gapWithPathbar,Z=i.pathbar.visible?i.pathbar.side.indexOf("bottom")>-1?z+V:-(j+V):0,Q={x0:D,x1:D,y0:Z,y1:Z+j},K=function(Me,ze,Oe){var De=i.tiling.pad,Xe=function(Ye){return Ye-De<=ze.x0},Be=function(Ye){return Ye+De>=ze.x1},Ie=function(Ye){return Ye-De<=ze.y0},Re=function(Ye){return Ye+De>=ze.y1};return Me.x0===ze.x0&&Me.x1===ze.x1&&Me.y0===ze.y0&&Me.y1===ze.y1?{x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1}:{x0:Xe(Me.x0-De)?0:Be(Me.x0-De)?Oe[0]:Me.x0,x1:Xe(Me.x1+De)?0:Be(Me.x1+De)?Oe[0]:Me.x1,y0:Ie(Me.y0-De)?0:Re(Me.y0-De)?Oe[1]:Me.y0,y1:Ie(Me.y1+De)?0:Re(Me.y1+De)?Oe[1]:Me.y1}},$=null,ne={},H={},N=null,U=function(Me,ze){return ze?ne[g(Me)]:H[g(Me)]},te=function(Me,ze,Oe,De){if(ze)return ne[g(f)]||Q;var Xe=H[i.level]||Oe;return function(Be){return Be.data.depth-_.data.depth<I}(Me)?K(Me,Xe,De):{}};c.hasMultipleRoots&&L&&I++,i._maxDepth=I,i._backgroundColor=p.paper_bgcolor,i._entryDepth=_.data.depth,i._atRootLevel=L;var B=-E/2+P.l+P.w*(S.x[1]+S.x[0])/2,X=-z/2+P.t+P.h*(1-(S.y[1]+S.y[0])/2),J=function(Me){return B+Me},ee=function(Me){return X+Me},re=ee(0),se=J(0),oe=function(Me){return se+Me},de=function(Me){return re+Me};function ce(Me,ze){return Me+","+ze}var ve=oe(0),Ae=function(Me){Me.x=Math.max(ve,Me.x)},fe=i.pathbar.edgeshape,me=function(Me,ze){var Oe=Me.x0,De=Me.x1,Xe=Me.y0,Be=Me.y1,Ie=Me.textBB,Re=function(vt){return i.textposition.indexOf(vt)!==-1},Ye=Re("bottom"),Qe=Re("top")||ze.isHeader&&!Ye?"start":Ye?"end":"middle",lt=Re("right"),xt=Re("left")||ze.onPathbar?-1:lt?1:0,wt=i[x?"tiling":"marker"].pad;if(ze.isHeader){if((Oe+=(x?wt:wt.l)-e)>=(De-=(x?wt:wt.r)-e)){var bt=(Oe+De)/2;Oe=bt,De=bt}var nt;Ye?Xe<(nt=Be-(x?wt:wt.b))&&nt<Be&&(Xe=nt):Xe<(nt=Xe+(x?wt:wt.t))&&nt<Be&&(Be=nt)}var $e=t(Oe,De,Xe,Be,Ie,{isHorizontal:!1,constrained:!0,angle:0,anchor:Qe,leftToRight:xt});return $e.fontSize=ze.fontSize,$e.targetX=J($e.targetX),$e.targetY=ee($e.targetY),isNaN($e.targetX)||isNaN($e.targetY)?{}:(Oe!==De&&Xe!==Be&&n(i.type,$e,p),{scale:$e.scale,rotate:$e.rotate,textX:$e.textX,textY:$e.textY,anchorX:$e.anchorX,anchorY:$e.anchorY,targetX:$e.targetX,targetY:$e.targetY})},_e=function(Me,ze){for(var Oe,De=0,Xe=Me;!Oe&&De<I;)De++,(Xe=Xe.parent)?Oe=U(Xe,ze):De=I;return Oe||{}},le=function(Me,ze,Oe,De,Xe){var Be,Ie=U(Me,ze);if(Ie)Be=Ie;else if(ze)Be=Q;else if($)if(Me.parent){var Re=N||Oe;Re&&!ze?Be=K(Me,Re,De):(Be={},y.extendFlat(Be,_e(Me,ze)))}else Be=y.extendFlat({},Me),x&&(Xe.orientation==="h"?Xe.flipX?Be.x0=Me.x1:Be.x1=0:Xe.flipY?Be.y0=Me.y1:Be.y1=0);else Be={};return v(Be,{x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1})},ge=function(Me,ze,Oe,De){var Xe=U(Me,ze),Be={},Ie=te(Me,ze,Oe,De);y.extendFlat(Be,{transform:me({x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1,textBB:Me.textBB,_text:Me._text},{isHeader:w.isHeader(Me,i)})}),Xe?Be=Xe:Me.parent&&y.extendFlat(Be,_e(Me,ze));var Re=Me.transform;return Me.x0!==Me.x1&&Me.y0!==Me.y1&&n(i.type,Re,p),v(Be,{transform:{scale:Re.scale,rotate:Re.rotate,textX:Re.textX,textY:Re.textY,anchorX:Re.anchorX,anchorY:Re.anchorY,targetX:Re.targetX,targetY:Re.targetY}})},Te=function(Me,ze,Oe,De,Xe){var Be=De[0],Ie=De[1];A?Me.exit().transition().each(function(){var Re=d.select(this);Re.select("path.surface").transition().attrTween("d",function(Ye){var Qe=function(lt,xt,wt,bt){var nt,$e=U(lt,xt);if(xt)nt=Q;else{var vt=U(_,xt);nt=vt?K(lt,vt,bt):{}}return v($e,nt)}(Ye,ze,0,[Be,Ie]);return function(lt){return Xe(Qe(lt))}}),Re.select("g.slicetext").attr("opacity",0)}).remove():Me.exit().remove()},Se=function(Me){var ze=Me.transform;return Me.x0!==Me.x1&&Me.y0!==Me.y1&&n(i.type,ze,p),y.getTextTransform({textX:ze.textX,textY:ze.textY,anchorX:ze.anchorX,anchorY:ze.anchorY,targetX:ze.targetX,targetY:ze.targetY,scale:ze.scale,rotate:ze.rotate})};A&&(T.each(function(Me){ne[g(Me)]={x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1},Me.transform&&(ne[g(Me)].transform={textX:Me.transform.textX,textY:Me.transform.textY,anchorX:Me.transform.anchorX,anchorY:Me.transform.anchorY,targetX:Me.transform.targetX,targetY:Me.transform.targetY,scale:Me.transform.scale,rotate:Me.transform.rotate})}),k.each(function(Me){H[g(Me)]={x0:Me.x0,x1:Me.x1,y0:Me.y0,y1:Me.y1},Me.transform&&(H[g(Me)].transform={textX:Me.transform.textX,textY:Me.transform.textY,anchorX:Me.transform.anchorX,anchorY:Me.transform.anchorY,targetX:Me.transform.targetX,targetY:Me.transform.targetY,scale:Me.transform.scale,rotate:Me.transform.rotate}),!$&&w.isEntry(Me)&&($=Me)})),N=o(u,s,_,k,{width:E,height:z,viewX:J,viewY:ee,pathSlice:function(Me){var ze=J(Me.x0),Oe=J(Me.x1),De=ee(Me.y0),Xe=ee(Me.y1),Be=Oe-ze,Ie=Xe-De;return!Be||!Ie?"":"M"+ce(ze,De+0)+"L"+ce(Oe-0,De)+"L"+ce(Oe,Xe-0)+"L"+ce(ze+0,Xe)+"Z"},toMoveInsideSlice:me,prevEntry:$,makeUpdateSliceInterpolator:le,makeUpdateTextInterpolator:ge,handleSlicesExit:Te,hasTransition:A,strTransform:Se}),i.pathbar.visible?r(u,s,_,T,{barDifY:Z,width:D,height:j,viewX:oe,viewY:de,pathSlice:function(Me){var ze=oe(Math.max(Math.min(Me.x0,Me.x0),0)),Oe=oe(Math.min(Math.max(Me.x1,Me.x1),D)),De=de(Me.y0),Xe=de(Me.y1),Be=j/2,Ie={},Re={};Ie.x=ze,Re.x=Oe,Ie.y=Re.y=(De+Xe)/2;var Ye={x:ze,y:De},Qe={x:Oe,y:De},lt={x:Oe,y:Xe},xt={x:ze,y:Xe};return fe===">"?(Ye.x-=Be,Qe.x-=Be,lt.x-=Be,xt.x-=Be):fe==="/"?(lt.x-=Be,xt.x-=Be,Ie.x-=Be/2,Re.x-=Be/2):fe==="\\"?(Ye.x-=Be,Qe.x-=Be,Ie.x-=Be/2,Re.x-=Be/2):fe==="<"&&(Ie.x-=Be,Re.x-=Be),Ae(Ye),Ae(xt),Ae(Ie),Ae(Qe),Ae(lt),Ae(Re),"M"+ce(Ye.x,Ye.y)+"L"+ce(Qe.x,Qe.y)+"L"+ce(Re.x,Re.y)+"L"+ce(lt.x,lt.y)+"L"+ce(xt.x,xt.y)+"L"+ce(Ie.x,Ie.y)+"Z"},toMoveInsideSlice:me,makeUpdateSliceInterpolator:le,makeUpdateTextInterpolator:ge,handleSlicesExit:Te,hasTransition:A,strTransform:Se}):T.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../sunburst/helpers"),e=m("../bar/uniform_text").resizeText;function t(n,a,r,g){var u,s,h=(g||{}).hovered,l=a.data.data,o=l.i,p=l.color,c=y.isHierarchyRoot(a),i=1;if(h)u=r._hovered.marker.line.color,s=r._hovered.marker.line.width;else if(c&&p===r.root.color)i=100,u="rgba(0,0,0,0)",s=0;else if(u=w.castOption(r,o,"marker.line.color")||v.defaultLine,s=w.castOption(r,o,"marker.line.width")||0,!r._hasColorscale&&!a.onPathbar){var x=r.marker.depthfade;if(x){var f,_=v.combine(v.addOpacity(r._backgroundColor,.75),p);if(x===!0){var b=y.getMaxDepth(r);f=isFinite(b)?y.isLeaf(a)?0:r._maxVisibleLayers-(a.data.depth-r._entryDepth):a.data.height+1}else f=a.data.depth-r._entryDepth,r._atRootLevel||f++;if(f>0)for(var T=0;T<f;T++){var k=.5*T/f;p=v.combine(v.addOpacity(_,k),p)}}}n.style("stroke-width",s).call(v.fill,p).call(v.stroke,u).style("opacity",i)}G.exports={style:function(n){var a=n._fullLayout._treemaplayer.selectAll(".trace");e(n,a,"treemap"),a.each(function(r){var g=d.select(this),u=r[0].trace;g.style("opacity",u.opacity),g.selectAll("path.surface").each(function(s){d.select(this).call(t,s,u,{hovered:!1})})})},styleOne:t}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(m,G,W){var d=m("../box/attributes"),v=m("../../lib/extend").extendFlat,w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat;G.exports={y:d.y,x:d.x,x0:d.x0,y0:d.y0,xhoverformat:w("x"),yhoverformat:w("y"),name:v({},d.name,{}),orientation:v({},d.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,points:v({},d.boxpoints,{}),jitter:v({},d.jitter,{}),pointpos:v({},d.pointpos,{}),width:v({},d.width,{}),marker:d.marker,text:d.text,hovertext:d.hovertext,hovertemplate:d.hovertemplate,quartilemethod:d.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(m,G,W){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../box/calc"),y=m("./helpers"),e=m("../../constants/numerical").BADNUM;function t(a,r,g){var u=r.max-r.min;if(!u)return a.bandwidth?a.bandwidth:0;if(a.bandwidth)return Math.max(a.bandwidth,u/1e4);var s=g.length,h=d.stdev(g,s-1,r.mean);return Math.max(function(l,o,p){return 1.059*Math.min(o,p/1.349)*Math.pow(l,-.2)}(s,h,r.q3-r.q1),u/100)}function n(a,r,g,u){var s,h=a.spanmode,l=a.span||[],o=[r.min,r.max],p=[r.min-2*u,r.max+2*u];function c(x){var f=l[x],_=g.type==="multicategory"?g.r2c(f):g.d2c(f,0,a[r.valLetter+"calendar"]);return _===e?p[x]:_}var i={type:"linear",range:s=h==="soft"?p:h==="hard"?o:[c(0),c(1)]};return v.setConvert(i),i.cleanRange(),s}G.exports=function(a,r){var g=w(a,r);if(g[0].t.empty)return g;for(var u=a._fullLayout,s=v.getFromId(a,r[r.orientation==="h"?"xaxis":"yaxis"]),h=1/0,l=-1/0,o=0,p=0,c=0;c<g.length;c++){var i=g[c],x=i.pts.map(y.extractVal),f=i.bandwidth=t(r,i,x),_=i.span=n(r,i,s,f);if(i.min===i.max&&f===0)_=i.span=[i.min,i.max],i.density=[{v:1,t:_[0]}],i.bandwidth=f,o=Math.max(o,1);else{var b=_[1]-_[0],T=Math.ceil(b/(f/3)),k=b/T;if(!isFinite(k)||!isFinite(T))return d.error("Something went wrong with computing the violin span"),g[0].t.empty=!0,g;var L=y.makeKDE(i,r,x);i.density=new Array(T);for(var A=0,I=_[0];I<_[1]+k/2;A++,I+=k){var P=L(I);i.density[A]={v:P,t:I},o=Math.max(o,P)}}p=Math.max(p,x.length),h=Math.min(h,_[0]),l=Math.max(l,_[1])}var S=v.findExtremes(s,[h,l],{padded:!0});if(r._extremes[s._id]=S,r.width)g[0].t.maxKDE=o;else{var E=u._violinScaleGroupStats,z=r.scalegroup,D=E[z];D?(D.maxKDE=Math.max(D.maxKDE,o),D.maxCount=Math.max(D.maxCount,p)):E[z]={maxKDE:o,maxCount:p}}return g[0].t.labels.kde=d._(a,"kde:"),g}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(m,G,W){var d=m("../box/cross_trace_calc").setPositionOffset,v=["v","h"];G.exports=function(w,y){for(var e=w.calcdata,t=y.xaxis,n=y.yaxis,a=0;a<v.length;a++){for(var r=v[a],g=r==="h"?n:t,u=[],s=0;s<e.length;s++){var h=e[s],l=h[0].t,o=h[0].trace;o.visible!==!0||o.type!=="violin"||l.empty||o.orientation!==r||o.xaxis!==t._id||o.yaxis!==n._id||u.push(s)}d("violin",w,u,g)}}},{"../box/cross_trace_calc":684}],1103:[function(m,G,W){var d=m("../../lib"),v=m("../../components/color"),w=m("../box/defaults"),y=m("./attributes");G.exports=function(e,t,n,a){function r(b,T){return d.coerce(e,t,y,b,T)}function g(b,T){return d.coerce2(e,t,y,b,T)}if(w.handleSampleDefaults(e,t,r,a),t.visible!==!1){r("bandwidth"),r("side"),r("width")||(r("scalegroup",t.name),r("scalemode"));var u,s=r("span");Array.isArray(s)&&(u="manual"),r("spanmode",u);var h=r("line.color",(e.marker||{}).color||n),l=r("line.width"),o=r("fillcolor",v.addOpacity(t.line.color,.5));w.handlePointsDefaults(e,t,r,{prefix:""});var p=g("box.width"),c=g("box.fillcolor",o),i=g("box.line.color",h),x=g("box.line.width",l);r("box.visible",Boolean(p||c||i||x))||(t.box={visible:!1});var f=g("meanline.color",h),_=g("meanline.width",l);r("meanline.visible",Boolean(f||_))||(t.meanline={visible:!1}),r("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(m,G,W){var d=m("../../lib"),v=function(w){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*w*w)};W.makeKDE=function(w,y,e){var t=e.length,n=v,a=w.bandwidth,r=1/(t*a);return function(g){for(var u=0,s=0;s<t;s++)u+=n((g-e[s])/a);return r*u}},W.getPositionOnKdePath=function(w,y,e){var t,n;y.orientation==="h"?(t="y",n="x"):(t="x",n="y");var a=d.findPointOnPath(w.path,e,n,{pathLength:w.pathLength}),r=w.posCenterPx,g=a[t];return[g,y.side==="both"?2*r-g:r]},W.getKdeValue=function(w,y,e){var t=w.pts.map(W.extractVal);return W.makeKDE(w,y,t)(e)/w.posDensityScale},W.extractVal=function(w){return w.v}},{"../../lib":515}],1105:[function(m,G,W){var d=m("../../components/color"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../box/hover"),e=m("./helpers");G.exports=function(t,n,a,r,g){g||(g={});var u,s,h=g.hoverLayer,l=t.cd,o=l[0].trace,p=o.hoveron,c=p.indexOf("violins")!==-1,i=p.indexOf("kde")!==-1,x=[];if(c||i){var f=y.hoverOnBoxes(t,n,a,r);if(i&&f.length>0){var _,b,T,k,L,A=t.xa,I=t.ya;o.orientation==="h"?(L=n,_="y",T=I,b="x",k=A):(L=a,_="x",T=A,b="y",k=I);var P=l[t.index];if(L>=P.span[0]&&L<=P.span[1]){var S=v.extendFlat({},t),E=k.c2p(L,!0),z=e.getKdeValue(P,o,L),D=e.getPositionOnKdePath(P,o,E),j=T._offset,V=T._length;S[_+"0"]=D[0],S[_+"1"]=D[1],S[b+"0"]=S[b+"1"]=E,S[b+"Label"]=b+": "+w.hoverLabelText(k,L,o[b+"hoverformat"])+", "+l[0].t.labels.kde+" "+z.toFixed(3);for(var Z=0,Q=0;Q<f.length;Q++)if(f[Q].attr==="med"){Z=Q;break}S.spikeDistance=f[Z].spikeDistance;var K=_+"Spike";S[K]=f[Z][K],f[Z].spikeDistance=void 0,f[Z][K]=void 0,S.hovertemplate=!1,x.push(S),(s={})[_+"1"]=v.constrain(j+D[0],j,j+V),s[_+"2"]=v.constrain(j+D[1],j,j+V),s[b+"1"]=s[b+"2"]=k._offset+E}}c&&(x=x.concat(f))}p.indexOf("points")!==-1&&(u=y.hoverOnPoints(t,n,a));var $=h.selectAll(".violinline-"+o.uid).data(s?[0]:[]);return $.enter().append("line").classed("violinline-"+o.uid,!0).attr("stroke-width",1.5),$.exit().remove(),$.attr(s).call(d.stroke,t.color),r==="closest"?u?[u]:x:(u&&x.push(u),x)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style"),styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../box/select"),moduleType:"trace",name:"violin",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(m,G,W){var d=m("../box/layout_attributes"),v=m("../../lib").extendFlat;G.exports={violinmode:v({},d.boxmode,{}),violingap:v({},d.boxgap,{}),violingroupgap:v({},d.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes"),w=m("../box/layout_defaults");G.exports=function(y,e,t){w._supply(y,e,t,function(n,a){return d.coerce(y,e,v,n,a)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../box/plot"),e=m("../scatter/line_points"),t=m("./helpers");G.exports=function(n,a,r,g){var u=n._fullLayout,s=a.xaxis,h=a.yaxis;function l(o,p){var c=e(o,{xaxis:s,yaxis:h,trace:p,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return w.smoothopen(c[0],1)}v.makeTraceGroups(g,r,"trace violins").each(function(o){var p=d.select(this),c=o[0],i=c.t,x=c.trace;if(x.visible!==!0||i.empty)p.remove();else{var f=i.bPos,_=i.bdPos,b=a[i.valLetter+"axis"],T=a[i.posLetter+"axis"],k=x.side==="both",L=k||x.side==="positive",A=k||x.side==="negative",I=p.selectAll("path.violin").data(v.identity);I.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),I.exit().remove(),I.each(function(Z){var Q,K,$,ne,H,N,U,te,B=d.select(this),X=Z.density,J=X.length,ee=T.c2l(Z.pos+f,!0),re=T.l2p(ee);if(x.width)Q=i.maxKDE/_;else{var se=u._violinScaleGroupStats[x.scalegroup];Q=x.scalemode==="count"?se.maxKDE/_*(se.maxCount/Z.pts.length):se.maxKDE/_}if(L){for(U=new Array(J),H=0;H<J;H++)(te=U[H]={})[i.posLetter]=ee+X[H].v/Q,te[i.valLetter]=b.c2l(X[H].t,!0);K=l(U,x)}if(A){for(U=new Array(J),N=0,H=J-1;N<J;N++,H--)(te=U[N]={})[i.posLetter]=ee-X[H].v/Q,te[i.valLetter]=b.c2l(X[H].t,!0);$=l(U,x)}if(k)ne=K+"L"+$.substr(1)+"Z";else{var oe=[re,b.c2p(X[0].t)],de=[re,b.c2p(X[J-1].t)];x.orientation==="h"&&(oe.reverse(),de.reverse()),ne=L?"M"+oe+"L"+K.substr(1)+"L"+de:"M"+de+"L"+$.substr(1)+"L"+oe}B.attr("d",ne),Z.posCenterPx=re,Z.posDensityScale=Q*_,Z.path=B.node(),Z.pathLength=Z.path.getTotalLength()/(k?2:1)});var P,S,E,z=x.box,D=z.width,j=(z.line||{}).width;k?(P=_*D,S=0):L?(P=[0,_*D/2],S=j*{x:1,y:-1}[i.posLetter]):(P=[_*D/2,0],S=j*{x:-1,y:1}[i.posLetter]),y.plotBoxAndWhiskers(p,{pos:T,val:b},x,{bPos:f,bdPos:P,bPosPxOffset:S}),y.plotBoxMean(p,{pos:T,val:b},x,{bPos:f,bdPos:P,bPosPxOffset:S}),!x.box.visible&&x.meanline.visible&&(E=v.identity);var V=p.selectAll("path.meanline").data(E||[]);V.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),V.exit().remove(),V.each(function(Z){var Q=b.c2p(Z.mean,!0),K=t.getPositionOnKdePath(Z,x,Q);d.select(this).attr("d",x.orientation==="h"?"M"+Q+","+K[0]+"V"+K[1]:"M"+K[0]+","+Q+"H"+K[1])}),y.plotPoints(p,{x:s,y:h},x,i)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../scatter/style").stylePoints;G.exports=function(y){var e=d.select(y).selectAll("g.trace.violins");e.style("opacity",function(t){return t[0].trace.opacity}),e.each(function(t){var n=t[0].trace,a=d.select(this),r=n.box||{},g=r.line||{},u=n.meanline||{},s=u.width;a.selectAll("path.violin").style("stroke-width",n.line.width+"px").call(v.stroke,n.line.color).call(v.fill,n.fillcolor),a.selectAll("path.box").style("stroke-width",g.width+"px").call(v.stroke,g.color).call(v.fill,r.fillcolor);var h={"stroke-width":s+"px","stroke-dasharray":2*s+"px,"+s+"px"};a.selectAll("path.mean").style(h).call(v.stroke,u.color),a.selectAll("path.meanline").style(h).call(v.stroke,u.color),w(a,n,y)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(m,G,W){var d=m("../../components/colorscale/attributes"),v=m("../isosurface/attributes"),w=m("../surface/attributes"),y=m("../../plots/attributes"),e=m("../../lib/extend").extendFlat,t=m("../../plot_api/edit_types").overrideAll,n=G.exports=t(e({x:v.x,y:v.y,z:v.z,value:v.value,isomin:v.isomin,isomax:v.isomax,surface:v.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:v.slices,caps:v.caps,text:v.text,hovertext:v.hovertext,xhoverformat:v.xhoverformat,yhoverformat:v.yhoverformat,zhoverformat:v.zhoverformat,valuehoverformat:v.valuehoverformat,hovertemplate:v.hovertemplate},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:v.colorbar,opacity:v.opacity,opacityscale:w.opacityscale,lightposition:v.lightposition,lighting:v.lighting,flatshading:v.flatshading,contour:v.contour,hoverinfo:e({},y.hoverinfo),showlegend:e({},y.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(m,G,W){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../lib/gl_format_color").parseColorScale,w=m("../../lib/str2rgbarray"),y=m("../../components/colorscale").extractOpts,e=m("../../plots/gl3d/zip3"),t=m("../isosurface/convert").findNearestOnAxis,n=m("../isosurface/convert").generateIsoMeshes;function a(g,u,s){this.scene=g,this.uid=s,this.mesh=u,this.name="",this.data=null,this.showContour=!1}var r=a.prototype;r.handlePick=function(g){if(g.object===this.mesh){var u=g.data.index,s=this.data._meshX[u],h=this.data._meshY[u],l=this.data._meshZ[u],o=this.data._Ys.length,p=this.data._Zs.length,c=t(s,this.data._Xs).id,i=t(h,this.data._Ys).id,x=t(l,this.data._Zs).id,f=g.index=x+p*i+p*o*c;g.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[f]!==void 0?g.textLabel=_[f]:_&&(g.textLabel=_),!0}},r.update=function(g){var u=this.scene,s=u.fullSceneLayout;function h(p,c,i,x){return c.map(function(f){return p.d2l(f,0,x)*i})}this.data=n(g);var l={positions:e(h(s.xaxis,g._meshX,u.dataScale[0],g.xcalendar),h(s.yaxis,g._meshY,u.dataScale[1],g.ycalendar),h(s.zaxis,g._meshZ,u.dataScale[2],g.zcalendar)),cells:e(g._meshI,g._meshJ,g._meshK),lightPosition:[g.lightposition.x,g.lightposition.y,g.lightposition.z],ambient:g.lighting.ambient,diffuse:g.lighting.diffuse,specular:g.lighting.specular,roughness:g.lighting.roughness,fresnel:g.lighting.fresnel,vertexNormalsEpsilon:g.lighting.vertexnormalsepsilon,faceNormalsEpsilon:g.lighting.facenormalsepsilon,opacity:g.opacity,opacityscale:g.opacityscale,contourEnable:g.contour.show,contourColor:w(g.contour.color).slice(0,3),contourWidth:g.contour.width,useFacetNormals:g.flatshading},o=y(g);l.vertexIntensity=g._meshIntensity,l.vertexIntensityBounds=[o.min,o.max],l.colormap=v(g),this.mesh.update(l)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(g,u){var s=g.glplot.gl,h=d({gl:s}),l=new a(g,h,u.uid);return h._trace=l,l.update(u),g.glplot.add(h),l}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(m,G,W){var d=m("../../lib"),v=m("./attributes"),w=m("../isosurface/defaults").supplyIsoDefaults,y=m("../surface/defaults").opacityscaleDefaults;G.exports=function(e,t,n,a){function r(g,u){return d.coerce(e,t,v,g,u)}w(e,t,n,a,r),y(e,t,a,r)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(m,G,W){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert"),moduleType:"trace",name:"volume",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(m,G,W){var d=m("../bar/attributes"),v=m("../scatter/attributes").line,w=m("../../plots/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("./constants"),a=m("../../lib/extend").extendFlat,r=m("../../components/color");function g(u){return{marker:{color:a({},d.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},d.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},d.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}G.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),hovertext:d.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:a({},w.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:t({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:d.text,textposition:d.textposition,insidetextanchor:d.insidetextanchor,textangle:d.textangle,textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:d.orientation,offset:d.offset,width:d.width,increasing:g(),decreasing:g(),totals:g(),connector:{line:{color:a({},v.color,{dflt:r.defaultLine}),width:a({},v.width,{editType:"plot"}),dash:v.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(m,G,W){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("../../lib").mergeArray,y=m("../scatter/calc_selection"),e=m("../../constants/numerical").BADNUM;function t(a){return a==="a"||a==="absolute"}function n(a){return a==="t"||a==="total"}G.exports=function(a,r){var g,u,s,h,l,o,p=d.getFromId(a,r.xaxis||"x"),c=d.getFromId(a,r.yaxis||"y");r.orientation==="h"?(g=p.makeCalcdata(r,"x"),s=c.makeCalcdata(r,"y"),h=v(r,c,"y",s),l=!!r.yperiodalignment,o="y"):(g=c.makeCalcdata(r,"y"),s=p.makeCalcdata(r,"x"),h=v(r,p,"x",s),l=!!r.xperiodalignment,o="x"),u=h.vals;for(var i,x=Math.min(u.length,g.length),f=new Array(x),_=0,b=!1,T=0;T<x;T++){var k=g[T]||0,L=!1;(g[T]!==e||n(r.measure[T])||t(r.measure[T]))&&T+1<x&&(g[T+1]!==e||n(r.measure[T+1])||t(r.measure[T+1]))&&(L=!0);var A=f[T]={i:T,p:u[T],s:k,rawS:k,cNext:L};t(r.measure[T])?(_=A.s,A.isSum=!0,A.dir="totals",A.s=_):n(r.measure[T])?(A.isSum=!0,A.dir="totals",A.s=_):(A.isSum=!1,A.dir=A.rawS<0?"decreasing":"increasing",i=A.s,A.s=_+i,_+=i),A.dir==="totals"&&(b=!0),l&&(f[T].orig_p=s[T],f[T][o+"End"]=h.ends[T],f[T][o+"Start"]=h.starts[T]),r.ids&&(A.id=String(r.ids[T])),A.v=(r.base||0)+_}return f.length&&(f[0].hasTotals=b),w(r.text,f,"tx"),w(r.hovertext,f,"htx"),y(f,r),f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(m,G,W){G.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(m,G,W){var d=m("../bar/cross_trace_calc").setGroupPositions;G.exports=function(v,w){var y,e,t=v._fullLayout,n=v._fullData,a=v.calcdata,r=w.xaxis,g=w.yaxis,u=[],s=[],h=[];for(e=0;e<n.length;e++){var l=n[e];l.visible===!0&&l.xaxis===r._id&&l.yaxis===g._id&&l.type==="waterfall"&&(y=a[e],l.orientation==="h"?h.push(y):s.push(y),u.push(y))}var o={mode:t.waterfallmode,norm:t.waterfallnorm,gap:t.waterfallgap,groupgap:t.waterfallgroupgap};for(d(v,r,g,s,o),d(v,g,r,h,o),e=0;e<u.length;e++){y=u[e];for(var p=0;p<y.length;p++){var c=y[p];c.isSum===!1&&(c.s0+=p===0?0:y[p-1].s),p+1<y.length&&(y[p].nextP0=y[p+1].p0,y[p].nextS0=y[p+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(m,G,W){var d=m("../../lib"),v=m("../bar/defaults").handleGroupingDefaults,w=m("../bar/defaults").handleText,y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./attributes"),n=m("../../components/color"),a=m("../../constants/delta.js"),r=a.INCREASING.COLOR,g=a.DECREASING.COLOR;function u(s,h,l){s(h+".marker.color",l),s(h+".marker.line.color",n.defaultLine),s(h+".marker.line.width")}G.exports={supplyDefaults:function(s,h,l,o){function p(i,x){return d.coerce(s,h,t,i,x)}if(y(s,h,o,p)){e(s,h,o,p),p("xhoverformat"),p("yhoverformat"),p("measure"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var c=p("textposition");w(s,h,o,p,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),h.textposition!=="none"&&(p("texttemplate"),h.texttemplate||p("textinfo")),u(p,"increasing",r),u(p,"decreasing",g),u(p,"totals","#4499FF"),p("connector.visible")&&(p("connector.mode"),p("connector.line.width")&&(p("connector.line.color"),p("connector.line.dash")))}else h.visible=!1},crossTraceDefaults:function(s,h){var l,o;function p(i){return d.coerce(o._input,o,t,i)}if(h.waterfallmode==="group")for(var c=0;c<s.length;c++)l=(o=s[c])._input,v(l,o,h,p)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(m,G,W){G.exports=function(d,v){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"initial"in v&&(d.initial=v.initial),"delta"in v&&(d.delta=v.delta),"final"in v&&(d.final=v.final),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],1121:[function(m,G,W){var d=m("../../plots/cartesian/axes").hoverLabelText,v=m("../../components/color").opacity,w=m("../bar/hover").hoverOnBars,y=m("../../constants/delta.js"),e=y.INCREASING.SYMBOL,t=y.DECREASING.SYMBOL;G.exports=function(n,a,r,g,u){var s=w(n,a,r,g,u);if(s){var h=s.cd,l=h[0].trace,o=l.orientation==="h",p=o?"x":"y",c=o?n.xa:n.ya,i=h[s.index],x=i.isSum?i.b+i.s:i.rawS;if(!i.isSum){s.initial=i.b+i.s-x,s.delta=x,s.final=s.initial+s.delta;var f=A(Math.abs(s.delta));s.deltaLabel=x<0?"("+f+")":f,s.finalLabel=A(s.final),s.initialLabel=A(s.initial)}var _=i.hi||l.hoverinfo,b=[];if(_&&_!=="none"&&_!=="skip"){var T=_==="all",k=_.split("+"),L=function(I){return T||k.indexOf(I)!==-1};i.isSum||(!L("final")||L(o?"x":"y")||b.push(s.finalLabel),L("delta")&&(x<0?b.push(s.deltaLabel+" "+t):b.push(s.deltaLabel+" "+e)),L("initial")&&b.push("Initial: "+s.initialLabel))}return b.length&&(s.extraText=b.join("<br>")),s.color=function(I,P){var S=I[P.dir].marker,E=S.color,z=S.line.color,D=S.line.width;if(v(E))return E;if(v(z)&&D)return z}(l,i),[s]}function A(I){return d(c,I,l[p+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(m,G,W){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style").style,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(m,G,W){G.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(m,G,W){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t=!1;function n(g,u){return d.coerce(w,y,v,g,u)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="waterfall"){t=!0;break}}t&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../constants/numerical").BADNUM,e=m("../bar/plot"),t=m("../bar/uniform_text").clearMinTextSize;G.exports=function(n,a,r,g){var u=n._fullLayout;t("waterfall",u),e.plot(n,a,r,g,{mode:u.waterfallmode,norm:u.waterfallmode,gap:u.waterfallgap,groupgap:u.waterfallgroupgap}),function(s,h,l,o){var p=h.xaxis,c=h.yaxis;v.makeTraceGroups(o,l,"trace bars").each(function(i){var x=d.select(this),f=i[0].trace,_=v.ensureSingle(x,"g","lines");if(f.connector&&f.connector.visible){var b=f.orientation==="h",T=f.connector.mode,k=_.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=function(D,j,V,Z){var Q=[],K=[],$=Z?j:V,ne=Z?V:j;return Q[0]=$.c2p(D.s0,!0),K[0]=ne.c2p(D.p0,!0),Q[1]=$.c2p(D.s1,!0),K[1]=ne.c2p(D.p1,!0),Q[2]=$.c2p(D.nextS0,!0),K[2]=ne.c2p(D.nextP0,!0),Z?[Q,K]:[K,Q]}(A,p,c,b),S=P[0],E=P[1],z="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&(T==="spanning"&&!A.isSum&&I>0&&(z+=b?"M"+S[0]+","+E[1]+"V"+E[0]:"M"+S[1]+","+E[0]+"H"+S[0]),T!=="between"&&(A.isSum||I<L-1)&&(z+=b?"M"+S[1]+","+E[0]+"V"+E[1]:"M"+S[0]+","+E[1]+"H"+S[1]),S[2]!==y&&E[2]!==y&&(z+=b?"M"+S[1]+","+E[1]+"V"+E[2]:"M"+S[1]+","+E[1]+"H"+S[2])),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,h.layerClipId,s)}})}else _.remove()})}(n,a,r,g)}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(m,G,W){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../../constants/interactions").DESELECTDIM,e=m("../bar/style"),t=m("../bar/uniform_text").resizeText,n=e.styleTextPoints;G.exports={style:function(a,r,g){var u=g||d.select(a).selectAll("g.waterfalllayer").selectAll("g.trace");t(a,u,"waterfall"),u.style("opacity",function(s){return s[0].trace.opacity}),u.each(function(s){var h=d.select(this),l=s[0].trace;h.selectAll(".point > path").each(function(o){if(!o.isBlank){var p=l[o.dir].marker;d.select(this).call(w.fill,p.color).call(w.stroke,p.line.color).call(v.dashLine,p.line.dash,p.line.width).style("opacity",l.selectedpoints&&!o.selected?y:1)}}),n(h,l,a),h.selectAll(".lines").each(function(){var o=l.connector.line;v.lineGroupStyle(d.select(this).selectAll("path"),o.width,o.color,o.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(m,G,W){var d=m("../plots/cartesian/axes"),v=m("../lib"),w=m("../plot_api/plot_schema"),y=m("./helpers").pointsAccessorFunction,e=m("../constants/numerical").BADNUM;W.moduleType="transform",W.name="aggregate";var t=W.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=t.aggregations;function a(s,h,l,o){if(o.enabled){for(var p=o.target,c=v.nestedProperty(h,p),i=c.get(),x=function(b,T){var k=b.func,L=T.d2c,A=T.c2d;switch(k){case"count":return r;case"first":return g;case"last":return u;case"sum":return function(I,P){for(var S=0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S+=z)}return A(S)};case"avg":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S+=D,E++)}return E?A(S/E):e};case"min":return function(I,P){for(var S=1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.min(S,z))}return S===1/0?e:A(S)};case"max":return function(I,P){for(var S=-1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.max(S,z))}return S===-1/0?e:A(S)};case"range":return function(I,P){for(var S=1/0,E=-1/0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S=Math.min(S,D),E=Math.max(E,D))}return E===-1/0||S===1/0?e:A(E-S)};case"change":return function(I,P){var S=L(I[P[0]]),E=L(I[P[P.length-1]]);return S===e||E===e?e:A(E-S)};case"median":return function(I,P){for(var S=[],E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&S.push(z)}if(!S.length)return e;S.sort(v.sorterAsc);var D=(S.length-1)/2;return A((S[Math.floor(D)]+S[Math.ceil(D)])/2)};case"mode":return function(I,P){for(var S={},E=0,z=e,D=0;D<P.length;D++){var j=L(I[P[D]]);if(j!==e){var V=S[j]=(S[j]||0)+1;V>E&&(E=V,z=j)}}return E?A(z):e};case"rms":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S+=D*D,E++)}return E?A(Math.sqrt(S/E)):e};case"stddev":return function(I,P){var S,E=0,z=0,D=1,j=e;for(S=0;S<P.length&&j===e;S++)j=L(I[P[S]]);if(j===e)return e;for(;S<P.length;S++){var V=L(I[P[S]]);if(V!==e){var Z=V-j;E+=Z,z+=Z*Z,D++}}var Q=b.funcmode==="sample"?D-1:D;return Q?Math.sqrt((z-E*E/D)/Q):0}}}(o,d.getDataConversions(s,h,p,i)),f=new Array(l.length),_=0;_<l.length;_++)f[_]=x(i,l[_]);c.set(f),o.func==="count"&&v.pushUnique(h._arrayAttrs,p)}}function r(s,h){return h.length}function g(s,h){return s[h[0]]}function u(s,h){return s[h[h.length-1]]}W.supplyDefaults=function(s,h){var l,o={};function p(A,I){return v.coerce(s,o,t,A,I)}if(!p("enabled"))return o;var c=w.findArrayAttributes(h),i={};for(l=0;l<c.length;l++)i[c[l]]=1;var x=p("groups");if(!Array.isArray(x)){if(!i[x])return o.enabled=!1,o;i[x]=0}var f,_=s.aggregations||[],b=o.aggregations=new Array(_.length);function T(A,I){return v.coerce(_[l],f,n,A,I)}for(l=0;l<_.length;l++){f={_index:l};var k=T("target"),L=T("func");T("enabled")&&k&&(i[k]||L==="count"&&i[k]===void 0)?(L==="stddev"&&T("funcmode"),i[k]=0,b[l]=f):b[l]={enabled:!1,_index:l}}for(l=0;l<c.length;l++)i[c[l]]&&b.push({target:c[l],func:n.func.dflt,enabled:!0,_index:-1});return o},W.calcTransform=function(s,h,l){if(l.enabled){var o=l.groups,p=v.getTargetArray(h,{target:o});if(p){var c,i,x,f,_={},b={},T=[],k=y(h.transforms,l),L=p.length;for(h._length&&(L=Math.min(L,h._length)),c=0;c<L;c++)(x=_[i=p[c]])===void 0?(_[i]=T.length,f=[c],T.push(f),b[_[i]]=k(c)):(T[x].push(c),b[_[i]]=(b[_[i]]||[]).concat(k(c)));l._indexToPoints=b;var A=l.aggregations;for(c=0;c<A.length;c++)a(s,h,T,A[c]);typeof o=="string"&&a(s,h,T,{target:o,func:"first",enabled:!0}),h._length=T.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(m,G,W){var d=m("../lib"),v=m("../registry"),w=m("../plots/cartesian/axes"),y=m("./helpers").pointsAccessorFunction,e=m("../constants/filter_ops"),t=e.COMPARISON_OPS,n=e.INTERVAL_OPS,a=e.SET_OPS;W.moduleType="transform",W.name="filter",W.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(t).concat(n).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},W.supplyDefaults=function(r){var g={};function u(l,o){return d.coerce(r,g,W.attributes,l,o)}if(u("enabled")){var s=u("target");if(d.isArrayOrTypedArray(s)&&s.length===0)return g.enabled=!1,g;u("preservegaps"),u("operation"),u("value");var h=v.getComponentMethod("calendars","handleDefaults");h(r,g,"valuecalendar",null),h(r,g,"targetcalendar",null)}return g},W.calcTransform=function(r,g,u){if(u.enabled){var s=d.getTargetArray(g,u);if(s){var h=u.target,l=s.length;g._length&&(l=Math.min(l,g._length));var o=u.targetcalendar,p=g._arrayAttrs,c=u.preservegaps;if(typeof h=="string"){var i=d.nestedProperty(g,h+"calendar").get();i&&(o=i)}var x,f,_=function(P,S,E){var z=P.operation,D=P.value,j=Array.isArray(D);function V($){return $.indexOf(z)!==-1}var Z,Q=function($){return S($,0,P.valuecalendar)},K=function($){return S($,0,E)};switch(V(t)?Z=Q(j?D[0]:D):V(n)?Z=j?[Q(D[0]),Q(D[1])]:[Q(D),Q(D)]:V(a)&&(Z=j?D.map(Q):[Q(D)]),z){case"=":return function($){return K($)===Z};case"!=":return function($){return K($)!==Z};case"<":return function($){return K($)<Z};case"<=":return function($){return K($)<=Z};case">":return function($){return K($)>Z};case">=":return function($){return K($)>=Z};case"[]":return function($){var ne=K($);return ne>=Z[0]&&ne<=Z[1]};case"()":return function($){var ne=K($);return ne>Z[0]&&ne<Z[1]};case"[)":return function($){var ne=K($);return ne>=Z[0]&&ne<Z[1]};case"(]":return function($){var ne=K($);return ne>Z[0]&&ne<=Z[1]};case"][":return function($){var ne=K($);return ne<=Z[0]||ne>=Z[1]};case")(":return function($){var ne=K($);return ne<Z[0]||ne>Z[1]};case"](":return function($){var ne=K($);return ne<=Z[0]||ne>Z[1]};case")[":return function($){var ne=K($);return ne<Z[0]||ne>=Z[1]};case"{}":return function($){return Z.indexOf(K($))!==-1};case"}{":return function($){return Z.indexOf(K($))===-1}}}(u,w.getDataToCoordFunc(r,g,h,s),o),b={},T={},k=0;c?(x=function(P){b[P.astr]=d.extendDeep([],P.get()),P.set(new Array(l))},f=function(P,S){var E=b[P.astr][S];P.get()[S]=E}):(x=function(P){b[P.astr]=d.extendDeep([],P.get()),P.set([])},f=function(P,S){var E=b[P.astr][S];P.get().push(E)}),I(x);for(var L=y(g.transforms,u),A=0;A<l;A++)_(s[A])?(I(f,A),T[k++]=L(A)):c&&k++;u._indexToPoints=T,g._length=k}}function I(P,S){for(var E=0;E<p.length;E++)P(d.nestedProperty(g,p[E]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(m,G,W){var d=m("../lib"),v=m("../plot_api/plot_schema"),w=m("../plots/plots"),y=m("./helpers").pointsAccessorFunction;function e(t,n){var a,r,g,u,s,h,l,o,p,c,i=n.transform,x=n.transformIndex,f=t.transforms[x].groups,_=y(t.transforms,i);if(!d.isArrayOrTypedArray(f)||f.length===0)return[t];var b=d.filterUnique(f),T=new Array(b.length),k=f.length,L=v.findArrayAttributes(t),A=i.styles||[],I={};for(a=0;a<A.length;a++)I[A[a].target]=A[a].value;i.styles&&(c=d.keyedContainer(i,"styles","target","value.name"));var P={},S={};for(a=0;a<b.length;a++){P[h=b[a]]=a,S[h]=0,(l=T[a]=d.extendDeepNoArrays({},t))._group=h,l.transforms[x]._indexToPoints={};var E=null;for(c&&(E=c.get(h)),l.name=E||E===""?E:d.templateString(i.nameformat,{trace:t.name,group:h}),o=l.transforms,l.transforms=[],r=0;r<o.length;r++)l.transforms[r]=d.extendDeepNoArrays({},o[r]);for(r=0;r<L.length;r++)d.nestedProperty(l,L[r]).set([])}for(g=0;g<L.length;g++){for(u=L[g],r=0,p=[];r<b.length;r++)p[r]=d.nestedProperty(T[r],u).get();for(s=d.nestedProperty(t,u).get(),r=0;r<k;r++)p[P[f[r]]].push(s[r])}for(r=0;r<k;r++)(l=T[P[f[r]]]).transforms[x]._indexToPoints[S[f[r]]]=_(r),S[f[r]]++;for(a=0;a<b.length;a++)h=b[a],l=T[a],w.clearExpandedTraceDefaultColors(l),l=d.extendDeepNoArrays(l,I[h]||{});return T}W.moduleType="transform",W.name="groupby",W.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},W.supplyDefaults=function(t,n,a){var r,g={};function u(p,c){return d.coerce(t,g,W.attributes,p,c)}if(!u("enabled"))return g;u("groups"),u("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var s=t.styles,h=g.styles=[];if(s)for(r=0;r<s.length;r++){var l=h[r]={};d.coerce(s[r],h[r],W.attributes.styles,"target");var o=d.coerce(s[r],h[r],W.attributes.styles,"value");d.isPlainObject(o)?l.value=d.extendDeep({},o):o&&delete l.value}return g},W.transform=function(t,n){var a,r,g,u=[];for(r=0;r<t.length;r++)for(a=e(t[r],n),g=0;g<a.length;g++)u.push(a[g]);return u}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(m,G,W){W.pointsAccessorFunction=function(d,v){for(var w,y,e=0;e<d.length&&(w=d[e])!==v;e++)w._indexToPoints&&w.enabled!==!1&&(y=w._indexToPoints);return y?function(t){return y[t]}:function(t){return[t]}}},{}],1131:[function(m,G,W){var d=m("../lib"),v=m("../plots/cartesian/axes"),w=m("./helpers").pointsAccessorFunction,y=m("../constants/numerical").BADNUM;W.moduleType="transform",W.name="sort",W.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},W.supplyDefaults=function(e){var t={};function n(a,r){return d.coerce(e,t,W.attributes,a,r)}return n("enabled")&&(n("target"),n("order")),t},W.calcTransform=function(e,t,n){if(n.enabled){var a=d.getTargetArray(t,n);if(a){var r=n.target,g=a.length;t._length&&(g=Math.min(g,t._length));var u,s,h=t._arrayAttrs,l=function(f,_,b,T){var k,L=new Array(T),A=new Array(T);for(k=0;k<T;k++)L[k]={v:_[k],i:k};for(L.sort(function(I,P){switch(I.order){case"ascending":return function(S,E){var z=P(S.v),D=P(E.v);return z===y?1:D===y?-1:z-D};case"descending":return function(S,E){var z=P(S.v),D=P(E.v);return z===y?1:D===y?-1:D-z}}}(f,b)),k=0;k<T;k++)A[k]=L[k].i;return A}(n,a,v.getDataToCoordFunc(e,t,r,a),g),o=w(t.transforms,n),p={};for(u=0;u<h.length;u++){var c=d.nestedProperty(t,h[u]),i=c.get(),x=new Array(g);for(s=0;s<g;s++)x[s]=i[l[s]];c.set(x)}for(s=0;s<g;s++)p[s]=o(l[s]);n._indexToPoints=p,t._length=g}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(m,G,W){W.version="2.16.1"},{}],1133:[function(m,G,W){(function(d){(function(){(function(v){typeof W=="object"&&G!==void 0?G.exports=v():(typeof window<"u"?window:d!==void 0?d:typeof self<"u"?self:this).stackgl=v()})(function(){return function v(w,y,e){function t(r,g){if(!y[r]){if(!w[r]){var u=typeof m=="function"&&m;if(!g&&u)return u(r,!0);if(n)return n(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var h=y[r]={exports:{}};w[r][0].call(h.exports,function(l){return t(w[r][1][l]||l)},h,h.exports,v,w,y,e)}return y[r].exports}for(var n=typeof m=="function"&&m,a=0;a<e.length;a++)t(e[a]);return t}({1:[function(v,w,y){y.byteLength=function(h){var l=u(h),o=l[0],p=l[1];return 3*(o+p)/4-p},y.toByteArray=function(h){var l,o,p=u(h),c=p[0],i=p[1],x=new n(function(b,T,k){return 3*(T+k)/4-k}(0,c,i)),f=0,_=i>0?c-4:c;for(o=0;o<_;o+=4)l=t[h.charCodeAt(o)]<<18|t[h.charCodeAt(o+1)]<<12|t[h.charCodeAt(o+2)]<<6|t[h.charCodeAt(o+3)],x[f++]=l>>16&255,x[f++]=l>>8&255,x[f++]=255&l;return i===2&&(l=t[h.charCodeAt(o)]<<2|t[h.charCodeAt(o+1)]>>4,x[f++]=255&l),i===1&&(l=t[h.charCodeAt(o)]<<10|t[h.charCodeAt(o+1)]<<4|t[h.charCodeAt(o+2)]>>2,x[f++]=l>>8&255,x[f++]=255&l),x},y.fromByteArray=function(h){for(var l,o=h.length,p=o%3,c=[],i=0,x=o-p;i<x;i+=16383)c.push(s(h,i,i+16383>x?x:i+16383));return p===1?(l=h[o-1],c.push(e[l>>2]+e[l<<4&63]+"==")):p===2&&(l=(h[o-2]<<8)+h[o-1],c.push(e[l>>10]+e[l>>4&63]+e[l<<2&63]+"=")),c.join("")};for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,g=a.length;r<g;++r)e[r]=a[r],t[a.charCodeAt(r)]=r;function u(h){var l=h.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=h.indexOf("=");return o===-1&&(o=l),[o,o===l?0:4-o%4]}function s(h,l,o){for(var p,c,i=[],x=l;x<o;x+=3)p=(h[x]<<16&16711680)+(h[x+1]<<8&65280)+(255&h[x+2]),i.push(e[(c=p)>>18&63]+e[c>>12&63]+e[c>>6&63]+e[63&c]);return i.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63},{}],2:[function(v,w,y){},{}],3:[function(v,w,y){(function(e){(function(){var t=v("base64-js"),n=v("ieee754");y.Buffer=r,y.SlowBuffer=function(B){return+B!=B&&(B=0),r.alloc(+B)},y.INSPECT_MAX_BYTES=50;function a(B){if(B>2147483647)throw new RangeError('The value "'+B+'" is invalid for option "size"');var X=new Uint8Array(B);return X.__proto__=r.prototype,X}function r(B,X,J){if(typeof B=="number"){if(typeof X=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return s(B)}return g(B,X,J)}function g(B,X,J){if(typeof B=="string")return function(se,oe){if(typeof oe=="string"&&oe!==""||(oe="utf8"),!r.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var de=0|o(se,oe),ce=a(de),ve=ce.write(se,oe);return ve!==de&&(ce=ce.slice(0,ve)),ce}(B,X);if(ArrayBuffer.isView(B))return h(B);if(B==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(U(B,ArrayBuffer)||B&&U(B.buffer,ArrayBuffer))return function(se,oe,de){if(oe<0||se.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<oe+(de||0))throw new RangeError('"length" is outside of buffer bounds');var ce;return ce=oe===void 0&&de===void 0?new Uint8Array(se):de===void 0?new Uint8Array(se,oe):new Uint8Array(se,oe,de),ce.__proto__=r.prototype,ce}(B,X,J);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=B.valueOf&&B.valueOf();if(ee!=null&&ee!==B)return r.from(ee,X,J);var re=function(se){if(r.isBuffer(se)){var oe=0|l(se.length),de=a(oe);return de.length===0||se.copy(de,0,0,oe),de}if(se.length!==void 0)return typeof se.length!="number"||te(se.length)?a(0):h(se);if(se.type==="Buffer"&&Array.isArray(se.data))return h(se.data)}(B);if(re)return re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return r.from(B[Symbol.toPrimitive]("string"),X,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function u(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function s(B){return u(B),a(B<0?0:0|l(B))}function h(B){for(var X=B.length<0?0:0|l(B.length),J=a(X),ee=0;ee<X;ee+=1)J[ee]=255&B[ee];return J}function l(B){if(B>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|B}function o(B,X){if(r.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||U(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var J=B.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&J===0)return 0;for(var re=!1;;)switch(X){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return ne(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return H(B).length;default:if(re)return ee?-1:ne(B).length;X=(""+X).toLowerCase(),re=!0}}function p(B,X,J){var ee=!1;if((X===void 0||X<0)&&(X=0),X>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0)<=(X>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return E(this,X,J);case"utf8":case"utf-8":return I(this,X,J);case"ascii":return P(this,X,J);case"latin1":case"binary":return S(this,X,J);case"base64":return A(this,X,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,X,J);default:if(ee)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),ee=!0}}function c(B,X,J){var ee=B[X];B[X]=B[J],B[J]=ee}function i(B,X,J,ee,re){if(B.length===0)return-1;if(typeof J=="string"?(ee=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),te(J=+J)&&(J=re?0:B.length-1),J<0&&(J=B.length+J),J>=B.length){if(re)return-1;J=B.length-1}else if(J<0){if(!re)return-1;J=0}if(typeof X=="string"&&(X=r.from(X,ee)),r.isBuffer(X))return X.length===0?-1:x(B,X,J,ee,re);if(typeof X=="number")return X&=255,typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(B,X,J):Uint8Array.prototype.lastIndexOf.call(B,X,J):x(B,[X],J,ee,re);throw new TypeError("val must be string, number or Buffer")}function x(B,X,J,ee,re){var se,oe=1,de=B.length,ce=X.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(B.length<2||X.length<2)return-1;oe=2,de/=2,ce/=2,J/=2}function ve(_e,le){return oe===1?_e[le]:_e.readUInt16BE(le*oe)}if(re){var Ae=-1;for(se=J;se<de;se++)if(ve(B,se)===ve(X,Ae===-1?0:se-Ae)){if(Ae===-1&&(Ae=se),se-Ae+1===ce)return Ae*oe}else Ae!==-1&&(se-=se-Ae),Ae=-1}else for(J+ce>de&&(J=de-ce),se=J;se>=0;se--){for(var fe=!0,me=0;me<ce;me++)if(ve(B,se+me)!==ve(X,me)){fe=!1;break}if(fe)return se}return-1}function f(B,X,J,ee){J=Number(J)||0;var re=B.length-J;ee?(ee=Number(ee))>re&&(ee=re):ee=re;var se=X.length;ee>se/2&&(ee=se/2);for(var oe=0;oe<ee;++oe){var de=parseInt(X.substr(2*oe,2),16);if(te(de))return oe;B[J+oe]=de}return oe}function _(B,X,J,ee){return N(ne(X,B.length-J),B,J,ee)}function b(B,X,J,ee){return N(function(re){for(var se=[],oe=0;oe<re.length;++oe)se.push(255&re.charCodeAt(oe));return se}(X),B,J,ee)}function T(B,X,J,ee){return b(B,X,J,ee)}function k(B,X,J,ee){return N(H(X),B,J,ee)}function L(B,X,J,ee){return N(function(re,se){for(var oe,de,ce,ve=[],Ae=0;Ae<re.length&&!((se-=2)<0);++Ae)oe=re.charCodeAt(Ae),de=oe>>8,ce=oe%256,ve.push(ce),ve.push(de);return ve}(X,B.length-J),B,J,ee)}function A(B,X,J){return X===0&&J===B.length?t.fromByteArray(B):t.fromByteArray(B.slice(X,J))}function I(B,X,J){J=Math.min(B.length,J);for(var ee=[],re=X;re<J;){var se,oe,de,ce,ve=B[re],Ae=null,fe=ve>239?4:ve>223?3:ve>191?2:1;if(re+fe<=J)switch(fe){case 1:ve<128&&(Ae=ve);break;case 2:(192&(se=B[re+1]))==128&&(ce=(31&ve)<<6|63&se)>127&&(Ae=ce);break;case 3:se=B[re+1],oe=B[re+2],(192&se)==128&&(192&oe)==128&&(ce=(15&ve)<<12|(63&se)<<6|63&oe)>2047&&(ce<55296||ce>57343)&&(Ae=ce);break;case 4:se=B[re+1],oe=B[re+2],de=B[re+3],(192&se)==128&&(192&oe)==128&&(192&de)==128&&(ce=(15&ve)<<18|(63&se)<<12|(63&oe)<<6|63&de)>65535&&ce<1114112&&(Ae=ce)}Ae===null?(Ae=65533,fe=1):Ae>65535&&(Ae-=65536,ee.push(Ae>>>10&1023|55296),Ae=56320|1023&Ae),ee.push(Ae),re+=fe}return function(me){var _e=me.length;if(_e<=4096)return String.fromCharCode.apply(String,me);for(var le="",ge=0;ge<_e;)le+=String.fromCharCode.apply(String,me.slice(ge,ge+=4096));return le}(ee)}y.kMaxLength=2147483647,r.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},B.foo()===42}catch{return!1}}(),r.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(B,X,J){return g(B,X,J)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(B,X,J){return function(ee,re,se){return u(ee),ee<=0?a(ee):re!==void 0?typeof se=="string"?a(ee).fill(re,se):a(ee).fill(re):a(ee)}(B,X,J)},r.allocUnsafe=function(B){return s(B)},r.allocUnsafeSlow=function(B){return s(B)},r.isBuffer=function(B){return B!=null&&B._isBuffer===!0&&B!==r.prototype},r.compare=function(B,X){if(U(B,Uint8Array)&&(B=r.from(B,B.offset,B.byteLength)),U(X,Uint8Array)&&(X=r.from(X,X.offset,X.byteLength)),!r.isBuffer(B)||!r.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===X)return 0;for(var J=B.length,ee=X.length,re=0,se=Math.min(J,ee);re<se;++re)if(B[re]!==X[re]){J=B[re],ee=X[re];break}return J<ee?-1:ee<J?1:0},r.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(B,X){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(B.length===0)return r.alloc(0);var J;if(X===void 0)for(X=0,J=0;J<B.length;++J)X+=B[J].length;var ee=r.allocUnsafe(X),re=0;for(J=0;J<B.length;++J){var se=B[J];if(U(se,Uint8Array)&&(se=r.from(se)),!r.isBuffer(se))throw new TypeError('"list" argument must be an Array of Buffers');se.copy(ee,re),re+=se.length}return ee},r.byteLength=o,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var B=this.length;if(B%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var X=0;X<B;X+=2)c(this,X,X+1);return this},r.prototype.swap32=function(){var B=this.length;if(B%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var X=0;X<B;X+=4)c(this,X,X+3),c(this,X+1,X+2);return this},r.prototype.swap64=function(){var B=this.length;if(B%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var X=0;X<B;X+=8)c(this,X,X+7),c(this,X+1,X+6),c(this,X+2,X+5),c(this,X+3,X+4);return this},r.prototype.toString=function(){var B=this.length;return B===0?"":arguments.length===0?I(this,0,B):p.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(B){if(!r.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B||r.compare(this,B)===0},r.prototype.inspect=function(){var B="",X=y.INSPECT_MAX_BYTES;return B=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(B+=" ... "),"<Buffer "+B+">"},r.prototype.compare=function(B,X,J,ee,re){if(U(B,Uint8Array)&&(B=r.from(B,B.offset,B.byteLength)),!r.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(X===void 0&&(X=0),J===void 0&&(J=B?B.length:0),ee===void 0&&(ee=0),re===void 0&&(re=this.length),X<0||J>B.length||ee<0||re>this.length)throw new RangeError("out of range index");if(ee>=re&&X>=J)return 0;if(ee>=re)return-1;if(X>=J)return 1;if(this===B)return 0;for(var se=(re>>>=0)-(ee>>>=0),oe=(J>>>=0)-(X>>>=0),de=Math.min(se,oe),ce=this.slice(ee,re),ve=B.slice(X,J),Ae=0;Ae<de;++Ae)if(ce[Ae]!==ve[Ae]){se=ce[Ae],oe=ve[Ae];break}return se<oe?-1:oe<se?1:0},r.prototype.includes=function(B,X,J){return this.indexOf(B,X,J)!==-1},r.prototype.indexOf=function(B,X,J){return i(this,B,X,J,!0)},r.prototype.lastIndexOf=function(B,X,J){return i(this,B,X,J,!1)},r.prototype.write=function(B,X,J,ee){if(X===void 0)ee="utf8",J=this.length,X=0;else if(J===void 0&&typeof X=="string")ee=X,J=this.length,X=0;else{if(!isFinite(X))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");X>>>=0,isFinite(J)?(J>>>=0,ee===void 0&&(ee="utf8")):(ee=J,J=void 0)}var re=this.length-X;if((J===void 0||J>re)&&(J=re),B.length>0&&(J<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var se=!1;;)switch(ee){case"hex":return f(this,B,X,J);case"utf8":case"utf-8":return _(this,B,X,J);case"ascii":return b(this,B,X,J);case"latin1":case"binary":return T(this,B,X,J);case"base64":return k(this,B,X,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,B,X,J);default:if(se)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),se=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(B,X,J){var ee="";J=Math.min(B.length,J);for(var re=X;re<J;++re)ee+=String.fromCharCode(127&B[re]);return ee}function S(B,X,J){var ee="";J=Math.min(B.length,J);for(var re=X;re<J;++re)ee+=String.fromCharCode(B[re]);return ee}function E(B,X,J){var ee=B.length;(!X||X<0)&&(X=0),(!J||J<0||J>ee)&&(J=ee);for(var re="",se=X;se<J;++se)re+=$(B[se]);return re}function z(B,X,J){for(var ee=B.slice(X,J),re="",se=0;se<ee.length;se+=2)re+=String.fromCharCode(ee[se]+256*ee[se+1]);return re}function D(B,X,J){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+X>J)throw new RangeError("Trying to access beyond buffer length")}function j(B,X,J,ee,re,se){if(!r.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(X>re||X<se)throw new RangeError('"value" argument is out of bounds');if(J+ee>B.length)throw new RangeError("Index out of range")}function V(B,X,J,ee,re,se){if(J+ee>B.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Z(B,X,J,ee,re){return X=+X,J>>>=0,re||V(B,0,J,4),n.write(B,X,J,ee,23,4),J+4}function Q(B,X,J,ee,re){return X=+X,J>>>=0,re||V(B,0,J,8),n.write(B,X,J,ee,52,8),J+8}r.prototype.slice=function(B,X){var J=this.length;(B=~~B)<0?(B+=J)<0&&(B=0):B>J&&(B=J),(X=X===void 0?J:~~X)<0?(X+=J)<0&&(X=0):X>J&&(X=J),X<B&&(X=B);var ee=this.subarray(B,X);return ee.__proto__=r.prototype,ee},r.prototype.readUIntLE=function(B,X,J){B>>>=0,X>>>=0,J||D(B,X,this.length);for(var ee=this[B],re=1,se=0;++se<X&&(re*=256);)ee+=this[B+se]*re;return ee},r.prototype.readUIntBE=function(B,X,J){B>>>=0,X>>>=0,J||D(B,X,this.length);for(var ee=this[B+--X],re=1;X>0&&(re*=256);)ee+=this[B+--X]*re;return ee},r.prototype.readUInt8=function(B,X){return B>>>=0,X||D(B,1,this.length),this[B]},r.prototype.readUInt16LE=function(B,X){return B>>>=0,X||D(B,2,this.length),this[B]|this[B+1]<<8},r.prototype.readUInt16BE=function(B,X){return B>>>=0,X||D(B,2,this.length),this[B]<<8|this[B+1]},r.prototype.readUInt32LE=function(B,X){return B>>>=0,X||D(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+16777216*this[B+3]},r.prototype.readUInt32BE=function(B,X){return B>>>=0,X||D(B,4,this.length),16777216*this[B]+(this[B+1]<<16|this[B+2]<<8|this[B+3])},r.prototype.readIntLE=function(B,X,J){B>>>=0,X>>>=0,J||D(B,X,this.length);for(var ee=this[B],re=1,se=0;++se<X&&(re*=256);)ee+=this[B+se]*re;return ee>=(re*=128)&&(ee-=Math.pow(2,8*X)),ee},r.prototype.readIntBE=function(B,X,J){B>>>=0,X>>>=0,J||D(B,X,this.length);for(var ee=X,re=1,se=this[B+--ee];ee>0&&(re*=256);)se+=this[B+--ee]*re;return se>=(re*=128)&&(se-=Math.pow(2,8*X)),se},r.prototype.readInt8=function(B,X){return B>>>=0,X||D(B,1,this.length),128&this[B]?-1*(255-this[B]+1):this[B]},r.prototype.readInt16LE=function(B,X){B>>>=0,X||D(B,2,this.length);var J=this[B]|this[B+1]<<8;return 32768&J?4294901760|J:J},r.prototype.readInt16BE=function(B,X){B>>>=0,X||D(B,2,this.length);var J=this[B+1]|this[B]<<8;return 32768&J?4294901760|J:J},r.prototype.readInt32LE=function(B,X){return B>>>=0,X||D(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},r.prototype.readInt32BE=function(B,X){return B>>>=0,X||D(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},r.prototype.readFloatLE=function(B,X){return B>>>=0,X||D(B,4,this.length),n.read(this,B,!0,23,4)},r.prototype.readFloatBE=function(B,X){return B>>>=0,X||D(B,4,this.length),n.read(this,B,!1,23,4)},r.prototype.readDoubleLE=function(B,X){return B>>>=0,X||D(B,8,this.length),n.read(this,B,!0,52,8)},r.prototype.readDoubleBE=function(B,X){return B>>>=0,X||D(B,8,this.length),n.read(this,B,!1,52,8)},r.prototype.writeUIntLE=function(B,X,J,ee){B=+B,X>>>=0,J>>>=0,ee||j(this,B,X,J,Math.pow(2,8*J)-1,0);var re=1,se=0;for(this[X]=255&B;++se<J&&(re*=256);)this[X+se]=B/re&255;return X+J},r.prototype.writeUIntBE=function(B,X,J,ee){B=+B,X>>>=0,J>>>=0,ee||j(this,B,X,J,Math.pow(2,8*J)-1,0);var re=J-1,se=1;for(this[X+re]=255&B;--re>=0&&(se*=256);)this[X+re]=B/se&255;return X+J},r.prototype.writeUInt8=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,1,255,0),this[X]=255&B,X+1},r.prototype.writeUInt16LE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,2,65535,0),this[X]=255&B,this[X+1]=B>>>8,X+2},r.prototype.writeUInt16BE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,2,65535,0),this[X]=B>>>8,this[X+1]=255&B,X+2},r.prototype.writeUInt32LE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,4,4294967295,0),this[X+3]=B>>>24,this[X+2]=B>>>16,this[X+1]=B>>>8,this[X]=255&B,X+4},r.prototype.writeUInt32BE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,4,4294967295,0),this[X]=B>>>24,this[X+1]=B>>>16,this[X+2]=B>>>8,this[X+3]=255&B,X+4},r.prototype.writeIntLE=function(B,X,J,ee){if(B=+B,X>>>=0,!ee){var re=Math.pow(2,8*J-1);j(this,B,X,J,re-1,-re)}var se=0,oe=1,de=0;for(this[X]=255&B;++se<J&&(oe*=256);)B<0&&de===0&&this[X+se-1]!==0&&(de=1),this[X+se]=(B/oe>>0)-de&255;return X+J},r.prototype.writeIntBE=function(B,X,J,ee){if(B=+B,X>>>=0,!ee){var re=Math.pow(2,8*J-1);j(this,B,X,J,re-1,-re)}var se=J-1,oe=1,de=0;for(this[X+se]=255&B;--se>=0&&(oe*=256);)B<0&&de===0&&this[X+se+1]!==0&&(de=1),this[X+se]=(B/oe>>0)-de&255;return X+J},r.prototype.writeInt8=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,1,127,-128),B<0&&(B=255+B+1),this[X]=255&B,X+1},r.prototype.writeInt16LE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,2,32767,-32768),this[X]=255&B,this[X+1]=B>>>8,X+2},r.prototype.writeInt16BE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,2,32767,-32768),this[X]=B>>>8,this[X+1]=255&B,X+2},r.prototype.writeInt32LE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,4,2147483647,-2147483648),this[X]=255&B,this[X+1]=B>>>8,this[X+2]=B>>>16,this[X+3]=B>>>24,X+4},r.prototype.writeInt32BE=function(B,X,J){return B=+B,X>>>=0,J||j(this,B,X,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[X]=B>>>24,this[X+1]=B>>>16,this[X+2]=B>>>8,this[X+3]=255&B,X+4},r.prototype.writeFloatLE=function(B,X,J){return Z(this,B,X,!0,J)},r.prototype.writeFloatBE=function(B,X,J){return Z(this,B,X,!1,J)},r.prototype.writeDoubleLE=function(B,X,J){return Q(this,B,X,!0,J)},r.prototype.writeDoubleBE=function(B,X,J){return Q(this,B,X,!1,J)},r.prototype.copy=function(B,X,J,ee){if(!r.isBuffer(B))throw new TypeError("argument should be a Buffer");if(J||(J=0),ee||ee===0||(ee=this.length),X>=B.length&&(X=B.length),X||(X=0),ee>0&&ee<J&&(ee=J),ee===J||B.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),B.length-X<ee-J&&(ee=B.length-X+J);var re=ee-J;if(this===B&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(X,J,ee);else if(this===B&&J<X&&X<ee)for(var se=re-1;se>=0;--se)B[se+X]=this[se+J];else Uint8Array.prototype.set.call(B,this.subarray(J,ee),X);return re},r.prototype.fill=function(B,X,J,ee){if(typeof B=="string"){if(typeof X=="string"?(ee=X,X=0,J=this.length):typeof J=="string"&&(ee=J,J=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!r.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(B.length===1){var re=B.charCodeAt(0);(ee==="utf8"&&re<128||ee==="latin1")&&(B=re)}}else typeof B=="number"&&(B&=255);if(X<0||this.length<X||this.length<J)throw new RangeError("Out of range index");if(J<=X)return this;var se;if(X>>>=0,J=J===void 0?this.length:J>>>0,B||(B=0),typeof B=="number")for(se=X;se<J;++se)this[se]=B;else{var oe=r.isBuffer(B)?B:r.from(B,ee),de=oe.length;if(de===0)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(se=0;se<J-X;++se)this[se+X]=oe[se%de]}return this};var K=/[^+/0-9A-Za-z-_]/g;function $(B){return B<16?"0"+B.toString(16):B.toString(16)}function ne(B,X){var J;X=X||1/0;for(var ee=B.length,re=null,se=[],oe=0;oe<ee;++oe){if((J=B.charCodeAt(oe))>55295&&J<57344){if(!re){if(J>56319){(X-=3)>-1&&se.push(239,191,189);continue}if(oe+1===ee){(X-=3)>-1&&se.push(239,191,189);continue}re=J;continue}if(J<56320){(X-=3)>-1&&se.push(239,191,189),re=J;continue}J=65536+(re-55296<<10|J-56320)}else re&&(X-=3)>-1&&se.push(239,191,189);if(re=null,J<128){if((X-=1)<0)break;se.push(J)}else if(J<2048){if((X-=2)<0)break;se.push(J>>6|192,63&J|128)}else if(J<65536){if((X-=3)<0)break;se.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((X-=4)<0)break;se.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return se}function H(B){return t.toByteArray(function(X){if((X=(X=X.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;X.length%4!=0;)X+="=";return X}(B))}function N(B,X,J,ee){for(var re=0;re<ee&&!(re+J>=X.length||re>=B.length);++re)X[re+J]=B[re];return re}function U(B,X){return B instanceof X||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===X.name}function te(B){return B!=B}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(v,w,y){y.read=function(e,t,n,a,r){var g,u,s=8*r-a-1,h=(1<<s)-1,l=h>>1,o=-7,p=n?r-1:0,c=n?-1:1,i=e[t+p];for(p+=c,g=i&(1<<-o)-1,i>>=-o,o+=s;o>0;g=256*g+e[t+p],p+=c,o-=8);for(u=g&(1<<-o)-1,g>>=-o,o+=a;o>0;u=256*u+e[t+p],p+=c,o-=8);if(g===0)g=1-l;else{if(g===h)return u?NaN:1/0*(i?-1:1);u+=Math.pow(2,a),g-=l}return(i?-1:1)*u*Math.pow(2,g-a)},y.write=function(e,t,n,a,r,g){var u,s,h,l=8*g-r-1,o=(1<<l)-1,p=o>>1,c=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:g-1,x=a?1:-1,f=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,u=o):(u=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-u))<1&&(u--,h*=2),(t+=u+p>=1?c/h:c*Math.pow(2,1-p))*h>=2&&(u++,h/=2),u+p>=o?(s=0,u=o):u+p>=1?(s=(t*h-1)*Math.pow(2,r),u+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,r),u=0));r>=8;e[n+i]=255&s,i+=x,s/=256,r-=8);for(u=u<<r|s,l+=r;l>0;e[n+i]=255&u,i+=x,u/=256,l-=8);e[n+i-x]|=128*f}},{}],5:[function(v,w,y){var e,t,n=w.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function g(x){if(e===setTimeout)return setTimeout(x,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(x,0);try{return e(x,0)}catch{try{return e.call(null,x,0)}catch{return e.call(this,x,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:a}catch{e=a}try{t=typeof clearTimeout=="function"?clearTimeout:r}catch{t=r}})();var u,s=[],h=!1,l=-1;function o(){h&&u&&(h=!1,u.length?s=u.concat(s):l=-1,s.length&&p())}function p(){if(!h){var x=g(o);h=!0;for(var f=s.length;f;){for(u=s,s=[];++l<f;)u&&u[l].run();l=-1,f=s.length}u=null,h=!1,function(_){if(t===clearTimeout)return clearTimeout(_);if((t===r||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(_);try{t(_)}catch{try{return t.call(null,_)}catch{return t.call(this,_)}}}(x)}}function c(x,f){this.fun=x,this.array=f}function i(){}n.nextTick=function(x){var f=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)f[_-1]=arguments[_];s.push(new c(x,f)),s.length!==1||h||g(p)},c.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.prependListener=i,n.prependOnceListener=i,n.listeners=function(x){return[]},n.binding=function(x){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(x){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],6:[function(v,w,y){w.exports={alpha_shape:v("alpha-shape"),convex_hull:v("convex-hull"),delaunay_triangulate:v("delaunay-triangulate"),gl_cone3d:v("gl-cone3d"),gl_error3d:v("gl-error3d"),gl_heatmap2d:v("gl-heatmap2d"),gl_line3d:v("gl-line3d"),gl_mesh3d:v("gl-mesh3d"),gl_plot2d:v("gl-plot2d"),gl_plot3d:v("gl-plot3d"),gl_pointcloud2d:v("gl-pointcloud2d"),gl_scatter3d:v("gl-scatter3d"),gl_select_box:v("gl-select-box"),gl_spikes2d:v("gl-spikes2d"),gl_streamtube3d:v("gl-streamtube3d"),gl_surface3d:v("gl-surface3d"),ndarray:v("ndarray"),ndarray_linear_interpolate:v("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(v,w,y){w.exports=function(g){var u=(g=g||{}).eye||[0,0,1],s=g.center||[0,0,0],h=g.up||[0,1,0],l=g.distanceLimits||[0,1/0],o=g.mode||"turntable",p=e(),c=t(),i=n();return p.setDistanceLimits(l[0],l[1]),p.lookAt(0,u,s,h),c.setDistanceLimits(l[0],l[1]),c.lookAt(0,u,s,h),i.setDistanceLimits(l[0],l[1]),i.lookAt(0,u,s,h),new a({turntable:p,orbit:c,matrix:i},o)};var e=v("turntable-camera-controller"),t=v("orbit-camera-controller"),n=v("matrix-camera-controller");function a(g,u){this._controllerNames=Object.keys(g),this._controllerList=this._controllerNames.map(function(s){return g[s]}),this._mode=u,this._active=g[u],this._active||(this._mode="turntable",this._active=g.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=a.prototype;r.flush=function(g){for(var u=this._controllerList,s=0;s<u.length;++s)u[s].flush(g)},r.idle=function(g){for(var u=this._controllerList,s=0;s<u.length;++s)u[s].idle(g)},r.lookAt=function(g,u,s,h){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].lookAt(g,u,s,h)},r.rotate=function(g,u,s,h){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].rotate(g,u,s,h)},r.pan=function(g,u,s,h){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].pan(g,u,s,h)},r.translate=function(g,u,s,h){for(var l=this._controllerList,o=0;o<l.length;++o)l[o].translate(g,u,s,h)},r.setMatrix=function(g,u){for(var s=this._controllerList,h=0;h<s.length;++h)s[h].setMatrix(g,u)},r.setDistanceLimits=function(g,u){for(var s=this._controllerList,h=0;h<s.length;++h)s[h].setDistanceLimits(g,u)},r.setDistance=function(g,u){for(var s=this._controllerList,h=0;h<s.length;++h)s[h].setDistance(g,u)},r.recalcMatrix=function(g){this._active.recalcMatrix(g)},r.getDistance=function(g){return this._active.getDistance(g)},r.getDistanceLimits=function(g){return this._active.getDistanceLimits(g)},r.lastT=function(){return this._active.lastT()},r.setMode=function(g){if(g!==this._mode){var u=this._controllerNames.indexOf(g);if(!(u<0)){var s=this._active,h=this._controllerList[u],l=Math.max(s.lastT(),h.lastT());s.recalcMatrix(l),h.setMatrix(l,s.computedMatrix),this._active=h,this._mode=g,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(v,w,y){var e=typeof WeakMap>"u"?v("weak-map"):WeakMap,t=v("gl-buffer"),n=v("gl-vao"),a=new e;w.exports=function(r){var g=a.get(r),u=g&&(g._triangleBuffer.handle||g._triangleBuffer.buffer);if(!u||!r.isBuffer(u)){var s=t(r,new Float32Array([-1,-1,-1,4,4,-1]));(g=n(r,[{buffer:s,type:r.FLOAT,size:2}]))._triangleBuffer=s,a.set(r,g)}g.bind(),r.drawArrays(r.TRIANGLES,0,3),g.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(v,w,y){var e=v("pad-left");w.exports=function(t,n,a){n=typeof n=="number"?n:1,a=a||": ";var r=t.split(/\r?\n/),g=String(r.length+n-1).length;return r.map(function(u,s){var h=s+n,l=String(h).length;return e(h,g-l)+a+u}).join(`
`)}},{"pad-left":264}],10:[function(v,w,y){w.exports=function(n){var a=n.length;if(a===0)return[];if(a===1)return[0];for(var r=n[0].length,g=[n[0]],u=[0],s=1;s<a;++s)if(g.push(n[s]),t(g,r)){if(u.push(s),u.length===r+1)return u}else g.pop();return u};var e=v("robust-orientation");function t(n,a){for(var r=new Array(a+1),g=0;g<n.length;++g)r[g]=n[g];for(g=0;g<=n.length;++g){for(var u=n.length;u<=a;++u){for(var s=new Array(a),h=0;h<a;++h)s[h]=Math.pow(u+1-g,h);r[u]=s}if(e.apply(void 0,r))return!0}return!1}},{"robust-orientation":284}],11:[function(v,w,y){w.exports=function(n,a){return e(a).filter(function(r){for(var g=new Array(r.length),u=0;u<r.length;++u)g[u]=a[r[u]];return t(g)*n<1})};var e=v("delaunay-triangulate"),t=v("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(v,w,y){w.exports=function(n,a){return t(e(n,a))};var e=v("alpha-complex"),t=v("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(v,w,y){w.exports=function(e){return atob(e)}},{}],14:[function(v,w,y){w.exports=function(n,a){for(var r=a.length,g=new Array(r+1),u=0;u<r;++u){for(var s=new Array(r+1),h=0;h<=r;++h)s[h]=n[h][u];g[u]=s}for(g[r]=new Array(r+1),u=0;u<=r;++u)g[r][u]=1;var l=new Array(r+1);for(u=0;u<r;++u)l[u]=a[u];l[r]=1;var o=e(g,l),p=t(o[r+1]);p===0&&(p=1);var c=new Array(r+1);for(u=0;u<=r;++u)c[u]=t(o[u])/p;return c};var e=v("robust-linear-solve");function t(n){for(var a=0,r=0;r<n.length;++r)a+=n[r];return a}},{"robust-linear-solve":283}],15:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]).add(n[0].mul(t[1])),t[1].mul(n[1]))}},{"./lib/rationalize":25}],16:[function(v,w,y){w.exports=function(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],17:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]),t[1].mul(n[0]))}},{"./lib/rationalize":25}],18:[function(v,w,y){var e=v("./is-rat"),t=v("./lib/is-bn"),n=v("./lib/num-to-bn"),a=v("./lib/str-to-bn"),r=v("./lib/rationalize"),g=v("./div");w.exports=function u(s,h){if(e(s))return h?g(s,u(h)):[s[0].clone(),s[1].clone()];var l,o,p=0;if(t(s))l=s.clone();else if(typeof s=="string")l=a(s);else{if(s===0)return[n(0),n(1)];if(s===Math.floor(s))l=n(s);else{for(;s!==Math.floor(s);)s*=Math.pow(2,256),p-=256;l=n(s)}}if(e(h))l.mul(h[1]),o=h[0].clone();else if(t(h))o=h.clone();else if(typeof h=="string")o=a(h);else if(h)if(h===Math.floor(h))o=n(h);else{for(;h!==Math.floor(h);)h*=Math.pow(2,256),p+=256;o=n(h)}else o=n(1);return p>0?l=l.ushln(p):p<0&&(o=o.ushln(-p)),r(l,o)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(v,w,y){var e=v("./lib/is-bn");w.exports=function(t){return Array.isArray(t)&&t.length===2&&e(t[0])&&e(t[1])}},{"./lib/is-bn":23}],20:[function(v,w,y){var e=v("bn.js");w.exports=function(t){return t.cmp(new e(0))}},{"bn.js":33}],21:[function(v,w,y){var e=v("./bn-sign");w.exports=function(t){var n=t.length,a=t.words,r=0;if(n===1)r=a[0];else if(n===2)r=a[0]+67108864*a[1];else for(var g=0;g<n;g++){var u=a[g];r+=u*Math.pow(67108864,g)}return e(t)*r}},{"./bn-sign":20}],22:[function(v,w,y){var e=v("double-bits"),t=v("bit-twiddle").countTrailingZeros;w.exports=function(n){var a=t(e.lo(n));if(a<32)return a;var r=t(e.hi(n));return r>20?52:r+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(v,w,y){v("bn.js"),w.exports=function(e){return e&&typeof e=="object"&&Boolean(e.words)}},{"bn.js":33}],24:[function(v,w,y){var e=v("bn.js"),t=v("double-bits");w.exports=function(n){var a=t.exponent(n);return a<52?new e(n):new e(n*Math.pow(2,52-a)).ushln(a-52)}},{"bn.js":33,"double-bits":64}],25:[function(v,w,y){var e=v("./num-to-bn"),t=v("./bn-sign");w.exports=function(n,a){var r=t(n),g=t(a);if(r===0)return[e(0),e(1)];if(g===0)return[e(0),e(0)];g<0&&(n=n.neg(),a=a.neg());var u=n.gcd(a);return u.cmpn(1)?[n.div(u),a.div(u)]:[n,a]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(v,w,y){var e=v("bn.js");w.exports=function(t){return new e(t)}},{"bn.js":33}],27:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[0]),t[1].mul(n[1]))}},{"./lib/rationalize":25}],28:[function(v,w,y){var e=v("./lib/bn-sign");w.exports=function(t){return e(t[0])*e(t[1])}},{"./lib/bn-sign":20}],29:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]).sub(t[1].mul(n[0])),t[1].mul(n[1]))}},{"./lib/rationalize":25}],30:[function(v,w,y){var e=v("./lib/bn-to-num"),t=v("./lib/ctz");w.exports=function(n){var a=n[0],r=n[1];if(a.cmpn(0)===0)return 0;var g=a.abs().divmod(r.abs()),u=g.div,s=e(u),h=g.mod,l=a.negative!==r.negative?-1:1;if(h.cmpn(0)===0)return l*s;if(s){var o=t(s)+4,p=e(h.ushln(o).divRound(r));return l*(s+p*Math.pow(2,-o))}var c=r.bitLength()-h.bitLength()+53;return p=e(h.ushln(c).divRound(r)),c<1023?l*p*Math.pow(2,-c):(p*=Math.pow(2,-1023),l*p*Math.pow(2,1023-c))}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(v,w,y){function e(u,s,h,l,o){for(var p=o+1;l<=o;){var c=l+o>>>1,i=u[c];(h!==void 0?h(i,s):i-s)>=0?(p=c,o=c-1):l=c+1}return p}function t(u,s,h,l,o){for(var p=o+1;l<=o;){var c=l+o>>>1,i=u[c];(h!==void 0?h(i,s):i-s)>0?(p=c,o=c-1):l=c+1}return p}function n(u,s,h,l,o){for(var p=l-1;l<=o;){var c=l+o>>>1,i=u[c];(h!==void 0?h(i,s):i-s)<0?(p=c,l=c+1):o=c-1}return p}function a(u,s,h,l,o){for(var p=l-1;l<=o;){var c=l+o>>>1,i=u[c];(h!==void 0?h(i,s):i-s)<=0?(p=c,l=c+1):o=c-1}return p}function r(u,s,h,l,o){for(;l<=o;){var p=l+o>>>1,c=u[p],i=h!==void 0?h(c,s):c-s;if(i===0)return p;i<=0?l=p+1:o=p-1}return-1}function g(u,s,h,l,o,p){return typeof h=="function"?p(u,s,h,l===void 0?0:0|l,o===void 0?u.length-1:0|o):p(u,s,void 0,h===void 0?0:0|h,l===void 0?u.length-1:0|l)}w.exports={ge:function(u,s,h,l,o){return g(u,s,h,l,o,e)},gt:function(u,s,h,l,o){return g(u,s,h,l,o,t)},lt:function(u,s,h,l,o){return g(u,s,h,l,o,n)},le:function(u,s,h,l,o){return g(u,s,h,l,o,a)},eq:function(u,s,h,l,o){return g(u,s,h,l,o,r)}}},{}],32:[function(v,w,y){function e(n){var a=32;return(n&=-n)&&a--,65535&n&&(a-=16),16711935&n&&(a-=8),252645135&n&&(a-=4),858993459&n&&(a-=2),1431655765&n&&(a-=1),a}y.INT_BITS=32,y.INT_MAX=2147483647,y.INT_MIN=-1<<31,y.sign=function(n){return(n>0)-(n<0)},y.abs=function(n){var a=n>>31;return(n^a)-a},y.min=function(n,a){return a^(n^a)&-(n<a)},y.max=function(n,a){return n^(n^a)&-(n<a)},y.isPow2=function(n){return!(n&n-1||!n)},y.log2=function(n){var a,r;return a=(n>65535)<<4,a|=r=((n>>>=a)>255)<<3,a|=r=((n>>>=r)>15)<<2,(a|=r=((n>>>=r)>3)<<1)|(n>>>=r)>>1},y.log10=function(n){return n>=1e9?9:n>=1e8?8:n>=1e7?7:n>=1e6?6:n>=1e5?5:n>=1e4?4:n>=1e3?3:n>=100?2:n>=10?1:0},y.popCount=function(n){return 16843009*((n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)>>>24},y.countTrailingZeros=e,y.nextPow2=function(n){return n+=n===0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)+1},y.prevPow2=function(n){return n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)-(n>>>1)},y.parity=function(n){return n^=n>>>16,n^=n>>>8,n^=n>>>4,27030>>>(n&=15)&1};var t=new Array(256);(function(n){for(var a=0;a<256;++a){var r=a,g=a,u=7;for(r>>>=1;r;r>>>=1)g<<=1,g|=1&r,--u;n[a]=g<<u&255}})(t),y.reverse=function(n){return t[255&n]<<24|t[n>>>8&255]<<16|t[n>>>16&255]<<8|t[n>>>24&255]},y.interleave2=function(n,a){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n&=65535)|n<<8))|n<<4))|n<<2))|n<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a&=65535)|a<<8))|a<<4))|a<<2))|a<<1))<<1},y.deinterleave2=function(n,a){return(n=65535&((n=16711935&((n=252645135&((n=858993459&((n=n>>>a&1431655765)|n>>>1))|n>>>2))|n>>>4))|n>>>16))<<16>>16},y.interleave3=function(n,a,r){return n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2),(n|=(a=1227133513&((a=3272356035&((a=251719695&((a=4278190335&((a&=1023)|a<<16))|a<<8))|a<<4))|a<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},y.deinterleave3=function(n,a){return(n=1023&((n=4278190335&((n=251719695&((n=3272356035&((n=n>>>a&1227133513)|n>>>2))|n>>>4))|n>>>8))|n>>>16))<<22>>22},y.nextCombination=function(n){var a=n|n-1;return a+1|(~a&-~a)-1>>>e(n)+1}},{}],33:[function(v,w,y){(function(e,t){function n(S,E){if(!S)throw new Error(E||"Assertion failed")}function a(S,E){S.super_=E;var z=function(){};z.prototype=E.prototype,S.prototype=new z,S.prototype.constructor=S}function r(S,E,z){if(r.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(z=E,E=10),this._init(S||0,E||10,z||"be"))}var g;typeof e=="object"?e.exports=r:t.BN=r,r.BN=r,r.wordSize=26;try{g=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:v("buffer").Buffer}catch{}function u(S,E){var z=S.charCodeAt(E);return z>=65&&z<=70?z-55:z>=97&&z<=102?z-87:z-48&15}function s(S,E,z){var D=u(S,z);return z-1>=E&&(D|=u(S,z-1)<<4),D}function h(S,E,z,D){for(var j=0,V=Math.min(S.length,z),Z=E;Z<V;Z++){var Q=S.charCodeAt(Z)-48;j*=D,j+=Q>=49?Q-49+10:Q>=17?Q-17+10:Q}return j}r.isBN=function(S){return S instanceof r||S!==null&&typeof S=="object"&&S.constructor.wordSize===r.wordSize&&Array.isArray(S.words)},r.max=function(S,E){return S.cmp(E)>0?S:E},r.min=function(S,E){return S.cmp(E)<0?S:E},r.prototype._init=function(S,E,z){if(typeof S=="number")return this._initNumber(S,E,z);if(typeof S=="object")return this._initArray(S,E,z);E==="hex"&&(E=16),n(E===(0|E)&&E>=2&&E<=36);var D=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&(D++,this.negative=1),D<S.length&&(E===16?this._parseHex(S,D,z):(this._parseBase(S,E,D),z==="le"&&this._initArray(this.toArray(),E,z)))},r.prototype._initNumber=function(S,E,z){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(n(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),z==="le"&&this._initArray(this.toArray(),E,z)},r.prototype._initArray=function(S,E,z){if(n(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,V,Z=0;if(z==="be")for(D=S.length-1,j=0;D>=0;D-=3)V=S[D]|S[D-1]<<8|S[D-2]<<16,this.words[j]|=V<<Z&67108863,this.words[j+1]=V>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);else if(z==="le")for(D=0,j=0;D<S.length;D+=3)V=S[D]|S[D+1]<<8|S[D+2]<<16,this.words[j]|=V<<Z&67108863,this.words[j+1]=V>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);return this.strip()},r.prototype._parseHex=function(S,E,z){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,V=0,Z=0;if(z==="be")for(D=S.length-1;D>=E;D-=2)j=s(S,E,D)<<V,this.words[Z]|=67108863&j,V>=18?(V-=18,Z+=1,this.words[Z]|=j>>>26):V+=8;else for(D=(S.length-E)%2==0?E+1:E;D<S.length;D+=2)j=s(S,E,D)<<V,this.words[Z]|=67108863&j,V>=18?(V-=18,Z+=1,this.words[Z]|=j>>>26):V+=8;this.strip()},r.prototype._parseBase=function(S,E,z){this.words=[0],this.length=1;for(var D=0,j=1;j<=67108863;j*=E)D++;D--,j=j/E|0;for(var V=S.length-z,Z=V%D,Q=Math.min(V,V-Z)+z,K=0,$=z;$<Q;$+=D)K=h(S,$,$+D,E),this.imuln(j),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K);if(Z!==0){var ne=1;for(K=h(S,$,S.length,E),$=0;$<Z;$++)ne*=E;this.imuln(ne),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K)}this.strip()},r.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},r.prototype.clone=function(){var S=new r(null);return this.copy(S),S},r.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(S,E,z){z.negative=E.negative^S.negative;var D=S.length+E.length|0;z.length=D,D=D-1|0;var j=0|S.words[0],V=0|E.words[0],Z=j*V,Q=67108863&Z,K=Z/67108864|0;z.words[0]=Q;for(var $=1;$<D;$++){for(var ne=K>>>26,H=67108863&K,N=Math.min($,E.length-1),U=Math.max(0,$-S.length+1);U<=N;U++){var te=$-U|0;ne+=(Z=(j=0|S.words[te])*(V=0|E.words[U])+H)/67108864|0,H=67108863&Z}z.words[$]=0|H,K=0|ne}return K!==0?z.words[$]=0|K:z.length--,z.strip()}r.prototype.toString=function(S,E){var z;if(E=0|E||1,(S=S||10)===16||S==="hex"){z="";for(var D=0,j=0,V=0;V<this.length;V++){var Z=this.words[V],Q=(16777215&(Z<<D|j)).toString(16);z=(j=Z>>>24-D&16777215)!==0||V!==this.length-1?l[6-Q.length]+Q+z:Q+z,(D+=2)>=26&&(D-=26,V--)}for(j!==0&&(z=j.toString(16)+z);z.length%E!=0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}if(S===(0|S)&&S>=2&&S<=36){var K=o[S],$=p[S];z="";var ne=this.clone();for(ne.negative=0;!ne.isZero();){var H=ne.modn($).toString(S);z=(ne=ne.idivn($)).isZero()?H+z:l[K-H.length]+H+z}for(this.isZero()&&(z="0"+z);z.length%E!=0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}n(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(S,E){return n(g!==void 0),this.toArrayLike(g,S,E)},r.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)},r.prototype.toArrayLike=function(S,E,z){var D=this.byteLength(),j=z||Math.max(1,D);n(D<=j,"byte array longer than desired length"),n(j>0,"Requested array length <= 0"),this.strip();var V,Z,Q=E==="le",K=new S(j),$=this.clone();if(Q){for(Z=0;!$.isZero();Z++)V=$.andln(255),$.iushrn(8),K[Z]=V;for(;Z<j;Z++)K[Z]=0}else{for(Z=0;Z<j-D;Z++)K[Z]=0;for(Z=0;!$.isZero();Z++)V=$.andln(255),$.iushrn(8),K[j-Z-1]=V}return K},Math.clz32?r.prototype._countBits=function(S){return 32-Math.clz32(S)}:r.prototype._countBits=function(S){var E=S,z=0;return E>=4096&&(z+=13,E>>>=13),E>=64&&(z+=7,E>>>=7),E>=8&&(z+=4,E>>>=4),E>=2&&(z+=2,E>>>=2),z+E},r.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,z=0;return(8191&E)==0&&(z+=13,E>>>=13),(127&E)==0&&(z+=7,E>>>=7),(15&E)==0&&(z+=4,E>>>=4),(3&E)==0&&(z+=2,E>>>=2),(1&E)==0&&z++,z},r.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var z=this._zeroBits(this.words[E]);if(S+=z,z!==26)break}return S},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},r.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this.strip()},r.prototype.ior=function(S){return n((this.negative|S.negative)==0),this.iuor(S)},r.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},r.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},r.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var z=0;z<E.length;z++)this.words[z]=this.words[z]&S.words[z];return this.length=E.length,this.strip()},r.prototype.iand=function(S){return n((this.negative|S.negative)==0),this.iuand(S)},r.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},r.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},r.prototype.iuxor=function(S){var E,z;this.length>S.length?(E=this,z=S):(E=S,z=this);for(var D=0;D<z.length;D++)this.words[D]=E.words[D]^z.words[D];if(this!==E)for(;D<E.length;D++)this.words[D]=E.words[D];return this.length=E.length,this.strip()},r.prototype.ixor=function(S){return n((this.negative|S.negative)==0),this.iuxor(S)},r.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},r.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},r.prototype.inotn=function(S){n(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),z=S%26;this._expand(E),z>0&&E--;for(var D=0;D<E;D++)this.words[D]=67108863&~this.words[D];return z>0&&(this.words[D]=~this.words[D]&67108863>>26-z),this.strip()},r.prototype.notn=function(S){return this.clone().inotn(S)},r.prototype.setn=function(S,E){n(typeof S=="number"&&S>=0);var z=S/26|0,D=S%26;return this._expand(z+1),this.words[z]=E?this.words[z]|1<<D:this.words[z]&~(1<<D),this.strip()},r.prototype.iadd=function(S){var E,z,D;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(z=this,D=S):(z=S,D=this);for(var j=0,V=0;V<D.length;V++)E=(0|z.words[V])+(0|D.words[V])+j,this.words[V]=67108863&E,j=E>>>26;for(;j!==0&&V<z.length;V++)E=(0|z.words[V])+j,this.words[V]=67108863&E,j=E>>>26;if(this.length=z.length,j!==0)this.words[this.length]=j,this.length++;else if(z!==this)for(;V<z.length;V++)this.words[V]=z.words[V];return this},r.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},r.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var z,D,j=this.cmp(S);if(j===0)return this.negative=0,this.length=1,this.words[0]=0,this;j>0?(z=this,D=S):(z=S,D=this);for(var V=0,Z=0;Z<D.length;Z++)V=(E=(0|z.words[Z])-(0|D.words[Z])+V)>>26,this.words[Z]=67108863&E;for(;V!==0&&Z<z.length;Z++)V=(E=(0|z.words[Z])+V)>>26,this.words[Z]=67108863&E;if(V===0&&Z<z.length&&z!==this)for(;Z<z.length;Z++)this.words[Z]=z.words[Z];return this.length=Math.max(this.length,Z),z!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(S){return this.clone().isub(S)};var i=function(S,E,z){var D,j,V,Z=S.words,Q=E.words,K=z.words,$=0,ne=0|Z[0],H=8191&ne,N=ne>>>13,U=0|Z[1],te=8191&U,B=U>>>13,X=0|Z[2],J=8191&X,ee=X>>>13,re=0|Z[3],se=8191&re,oe=re>>>13,de=0|Z[4],ce=8191&de,ve=de>>>13,Ae=0|Z[5],fe=8191&Ae,me=Ae>>>13,_e=0|Z[6],le=8191&_e,ge=_e>>>13,Te=0|Z[7],Se=8191&Te,Me=Te>>>13,ze=0|Z[8],Oe=8191&ze,De=ze>>>13,Xe=0|Z[9],Be=8191&Xe,Ie=Xe>>>13,Re=0|Q[0],Ye=8191&Re,Qe=Re>>>13,lt=0|Q[1],xt=8191&lt,wt=lt>>>13,bt=0|Q[2],nt=8191&bt,$e=bt>>>13,vt=0|Q[3],Nt=8191&vt,qt=vt>>>13,Jt=0|Q[4],Wt=8191&Jt,ar=Jt>>>13,Dt=0|Q[5],Ne=8191&Dt,qe=Dt>>>13,pe=0|Q[6],be=8191&pe,Fe=pe>>>13,Ve=0|Q[7],Ke=8191&Ve,Ge=Ve>>>13,ct=0|Q[8],st=8191&ct,Mt=ct>>>13,Ot=0|Q[9],it=8191&Ot,ht=Ot>>>13;z.negative=S.negative^E.negative,z.length=19;var jt=($+(D=Math.imul(H,Ye))|0)+((8191&(j=(j=Math.imul(H,Qe))+Math.imul(N,Ye)|0))<<13)|0;$=((V=Math.imul(N,Qe))+(j>>>13)|0)+(jt>>>26)|0,jt&=67108863,D=Math.imul(te,Ye),j=(j=Math.imul(te,Qe))+Math.imul(B,Ye)|0,V=Math.imul(B,Qe);var kt=($+(D=D+Math.imul(H,xt)|0)|0)+((8191&(j=(j=j+Math.imul(H,wt)|0)+Math.imul(N,xt)|0))<<13)|0;$=((V=V+Math.imul(N,wt)|0)+(j>>>13)|0)+(kt>>>26)|0,kt&=67108863,D=Math.imul(J,Ye),j=(j=Math.imul(J,Qe))+Math.imul(ee,Ye)|0,V=Math.imul(ee,Qe),D=D+Math.imul(te,xt)|0,j=(j=j+Math.imul(te,wt)|0)+Math.imul(B,xt)|0,V=V+Math.imul(B,wt)|0;var Pt=($+(D=D+Math.imul(H,nt)|0)|0)+((8191&(j=(j=j+Math.imul(H,$e)|0)+Math.imul(N,nt)|0))<<13)|0;$=((V=V+Math.imul(N,$e)|0)+(j>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,D=Math.imul(se,Ye),j=(j=Math.imul(se,Qe))+Math.imul(oe,Ye)|0,V=Math.imul(oe,Qe),D=D+Math.imul(J,xt)|0,j=(j=j+Math.imul(J,wt)|0)+Math.imul(ee,xt)|0,V=V+Math.imul(ee,wt)|0,D=D+Math.imul(te,nt)|0,j=(j=j+Math.imul(te,$e)|0)+Math.imul(B,nt)|0,V=V+Math.imul(B,$e)|0;var Ee=($+(D=D+Math.imul(H,Nt)|0)|0)+((8191&(j=(j=j+Math.imul(H,qt)|0)+Math.imul(N,Nt)|0))<<13)|0;$=((V=V+Math.imul(N,qt)|0)+(j>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,D=Math.imul(ce,Ye),j=(j=Math.imul(ce,Qe))+Math.imul(ve,Ye)|0,V=Math.imul(ve,Qe),D=D+Math.imul(se,xt)|0,j=(j=j+Math.imul(se,wt)|0)+Math.imul(oe,xt)|0,V=V+Math.imul(oe,wt)|0,D=D+Math.imul(J,nt)|0,j=(j=j+Math.imul(J,$e)|0)+Math.imul(ee,nt)|0,V=V+Math.imul(ee,$e)|0,D=D+Math.imul(te,Nt)|0,j=(j=j+Math.imul(te,qt)|0)+Math.imul(B,Nt)|0,V=V+Math.imul(B,qt)|0;var Ze=($+(D=D+Math.imul(H,Wt)|0)|0)+((8191&(j=(j=j+Math.imul(H,ar)|0)+Math.imul(N,Wt)|0))<<13)|0;$=((V=V+Math.imul(N,ar)|0)+(j>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,D=Math.imul(fe,Ye),j=(j=Math.imul(fe,Qe))+Math.imul(me,Ye)|0,V=Math.imul(me,Qe),D=D+Math.imul(ce,xt)|0,j=(j=j+Math.imul(ce,wt)|0)+Math.imul(ve,xt)|0,V=V+Math.imul(ve,wt)|0,D=D+Math.imul(se,nt)|0,j=(j=j+Math.imul(se,$e)|0)+Math.imul(oe,nt)|0,V=V+Math.imul(oe,$e)|0,D=D+Math.imul(J,Nt)|0,j=(j=j+Math.imul(J,qt)|0)+Math.imul(ee,Nt)|0,V=V+Math.imul(ee,qt)|0,D=D+Math.imul(te,Wt)|0,j=(j=j+Math.imul(te,ar)|0)+Math.imul(B,Wt)|0,V=V+Math.imul(B,ar)|0;var at=($+(D=D+Math.imul(H,Ne)|0)|0)+((8191&(j=(j=j+Math.imul(H,qe)|0)+Math.imul(N,Ne)|0))<<13)|0;$=((V=V+Math.imul(N,qe)|0)+(j>>>13)|0)+(at>>>26)|0,at&=67108863,D=Math.imul(le,Ye),j=(j=Math.imul(le,Qe))+Math.imul(ge,Ye)|0,V=Math.imul(ge,Qe),D=D+Math.imul(fe,xt)|0,j=(j=j+Math.imul(fe,wt)|0)+Math.imul(me,xt)|0,V=V+Math.imul(me,wt)|0,D=D+Math.imul(ce,nt)|0,j=(j=j+Math.imul(ce,$e)|0)+Math.imul(ve,nt)|0,V=V+Math.imul(ve,$e)|0,D=D+Math.imul(se,Nt)|0,j=(j=j+Math.imul(se,qt)|0)+Math.imul(oe,Nt)|0,V=V+Math.imul(oe,qt)|0,D=D+Math.imul(J,Wt)|0,j=(j=j+Math.imul(J,ar)|0)+Math.imul(ee,Wt)|0,V=V+Math.imul(ee,ar)|0,D=D+Math.imul(te,Ne)|0,j=(j=j+Math.imul(te,qe)|0)+Math.imul(B,Ne)|0,V=V+Math.imul(B,qe)|0;var pt=($+(D=D+Math.imul(H,be)|0)|0)+((8191&(j=(j=j+Math.imul(H,Fe)|0)+Math.imul(N,be)|0))<<13)|0;$=((V=V+Math.imul(N,Fe)|0)+(j>>>13)|0)+(pt>>>26)|0,pt&=67108863,D=Math.imul(Se,Ye),j=(j=Math.imul(Se,Qe))+Math.imul(Me,Ye)|0,V=Math.imul(Me,Qe),D=D+Math.imul(le,xt)|0,j=(j=j+Math.imul(le,wt)|0)+Math.imul(ge,xt)|0,V=V+Math.imul(ge,wt)|0,D=D+Math.imul(fe,nt)|0,j=(j=j+Math.imul(fe,$e)|0)+Math.imul(me,nt)|0,V=V+Math.imul(me,$e)|0,D=D+Math.imul(ce,Nt)|0,j=(j=j+Math.imul(ce,qt)|0)+Math.imul(ve,Nt)|0,V=V+Math.imul(ve,qt)|0,D=D+Math.imul(se,Wt)|0,j=(j=j+Math.imul(se,ar)|0)+Math.imul(oe,Wt)|0,V=V+Math.imul(oe,ar)|0,D=D+Math.imul(J,Ne)|0,j=(j=j+Math.imul(J,qe)|0)+Math.imul(ee,Ne)|0,V=V+Math.imul(ee,qe)|0,D=D+Math.imul(te,be)|0,j=(j=j+Math.imul(te,Fe)|0)+Math.imul(B,be)|0,V=V+Math.imul(B,Fe)|0;var St=($+(D=D+Math.imul(H,Ke)|0)|0)+((8191&(j=(j=j+Math.imul(H,Ge)|0)+Math.imul(N,Ke)|0))<<13)|0;$=((V=V+Math.imul(N,Ge)|0)+(j>>>13)|0)+(St>>>26)|0,St&=67108863,D=Math.imul(Oe,Ye),j=(j=Math.imul(Oe,Qe))+Math.imul(De,Ye)|0,V=Math.imul(De,Qe),D=D+Math.imul(Se,xt)|0,j=(j=j+Math.imul(Se,wt)|0)+Math.imul(Me,xt)|0,V=V+Math.imul(Me,wt)|0,D=D+Math.imul(le,nt)|0,j=(j=j+Math.imul(le,$e)|0)+Math.imul(ge,nt)|0,V=V+Math.imul(ge,$e)|0,D=D+Math.imul(fe,Nt)|0,j=(j=j+Math.imul(fe,qt)|0)+Math.imul(me,Nt)|0,V=V+Math.imul(me,qt)|0,D=D+Math.imul(ce,Wt)|0,j=(j=j+Math.imul(ce,ar)|0)+Math.imul(ve,Wt)|0,V=V+Math.imul(ve,ar)|0,D=D+Math.imul(se,Ne)|0,j=(j=j+Math.imul(se,qe)|0)+Math.imul(oe,Ne)|0,V=V+Math.imul(oe,qe)|0,D=D+Math.imul(J,be)|0,j=(j=j+Math.imul(J,Fe)|0)+Math.imul(ee,be)|0,V=V+Math.imul(ee,Fe)|0,D=D+Math.imul(te,Ke)|0,j=(j=j+Math.imul(te,Ge)|0)+Math.imul(B,Ke)|0,V=V+Math.imul(B,Ge)|0;var Ut=($+(D=D+Math.imul(H,st)|0)|0)+((8191&(j=(j=j+Math.imul(H,Mt)|0)+Math.imul(N,st)|0))<<13)|0;$=((V=V+Math.imul(N,Mt)|0)+(j>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,D=Math.imul(Be,Ye),j=(j=Math.imul(Be,Qe))+Math.imul(Ie,Ye)|0,V=Math.imul(Ie,Qe),D=D+Math.imul(Oe,xt)|0,j=(j=j+Math.imul(Oe,wt)|0)+Math.imul(De,xt)|0,V=V+Math.imul(De,wt)|0,D=D+Math.imul(Se,nt)|0,j=(j=j+Math.imul(Se,$e)|0)+Math.imul(Me,nt)|0,V=V+Math.imul(Me,$e)|0,D=D+Math.imul(le,Nt)|0,j=(j=j+Math.imul(le,qt)|0)+Math.imul(ge,Nt)|0,V=V+Math.imul(ge,qt)|0,D=D+Math.imul(fe,Wt)|0,j=(j=j+Math.imul(fe,ar)|0)+Math.imul(me,Wt)|0,V=V+Math.imul(me,ar)|0,D=D+Math.imul(ce,Ne)|0,j=(j=j+Math.imul(ce,qe)|0)+Math.imul(ve,Ne)|0,V=V+Math.imul(ve,qe)|0,D=D+Math.imul(se,be)|0,j=(j=j+Math.imul(se,Fe)|0)+Math.imul(oe,be)|0,V=V+Math.imul(oe,Fe)|0,D=D+Math.imul(J,Ke)|0,j=(j=j+Math.imul(J,Ge)|0)+Math.imul(ee,Ke)|0,V=V+Math.imul(ee,Ge)|0,D=D+Math.imul(te,st)|0,j=(j=j+Math.imul(te,Mt)|0)+Math.imul(B,st)|0,V=V+Math.imul(B,Mt)|0;var Kt=($+(D=D+Math.imul(H,it)|0)|0)+((8191&(j=(j=j+Math.imul(H,ht)|0)+Math.imul(N,it)|0))<<13)|0;$=((V=V+Math.imul(N,ht)|0)+(j>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,D=Math.imul(Be,xt),j=(j=Math.imul(Be,wt))+Math.imul(Ie,xt)|0,V=Math.imul(Ie,wt),D=D+Math.imul(Oe,nt)|0,j=(j=j+Math.imul(Oe,$e)|0)+Math.imul(De,nt)|0,V=V+Math.imul(De,$e)|0,D=D+Math.imul(Se,Nt)|0,j=(j=j+Math.imul(Se,qt)|0)+Math.imul(Me,Nt)|0,V=V+Math.imul(Me,qt)|0,D=D+Math.imul(le,Wt)|0,j=(j=j+Math.imul(le,ar)|0)+Math.imul(ge,Wt)|0,V=V+Math.imul(ge,ar)|0,D=D+Math.imul(fe,Ne)|0,j=(j=j+Math.imul(fe,qe)|0)+Math.imul(me,Ne)|0,V=V+Math.imul(me,qe)|0,D=D+Math.imul(ce,be)|0,j=(j=j+Math.imul(ce,Fe)|0)+Math.imul(ve,be)|0,V=V+Math.imul(ve,Fe)|0,D=D+Math.imul(se,Ke)|0,j=(j=j+Math.imul(se,Ge)|0)+Math.imul(oe,Ke)|0,V=V+Math.imul(oe,Ge)|0,D=D+Math.imul(J,st)|0,j=(j=j+Math.imul(J,Mt)|0)+Math.imul(ee,st)|0,V=V+Math.imul(ee,Mt)|0;var Ht=($+(D=D+Math.imul(te,it)|0)|0)+((8191&(j=(j=j+Math.imul(te,ht)|0)+Math.imul(B,it)|0))<<13)|0;$=((V=V+Math.imul(B,ht)|0)+(j>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,D=Math.imul(Be,nt),j=(j=Math.imul(Be,$e))+Math.imul(Ie,nt)|0,V=Math.imul(Ie,$e),D=D+Math.imul(Oe,Nt)|0,j=(j=j+Math.imul(Oe,qt)|0)+Math.imul(De,Nt)|0,V=V+Math.imul(De,qt)|0,D=D+Math.imul(Se,Wt)|0,j=(j=j+Math.imul(Se,ar)|0)+Math.imul(Me,Wt)|0,V=V+Math.imul(Me,ar)|0,D=D+Math.imul(le,Ne)|0,j=(j=j+Math.imul(le,qe)|0)+Math.imul(ge,Ne)|0,V=V+Math.imul(ge,qe)|0,D=D+Math.imul(fe,be)|0,j=(j=j+Math.imul(fe,Fe)|0)+Math.imul(me,be)|0,V=V+Math.imul(me,Fe)|0,D=D+Math.imul(ce,Ke)|0,j=(j=j+Math.imul(ce,Ge)|0)+Math.imul(ve,Ke)|0,V=V+Math.imul(ve,Ge)|0,D=D+Math.imul(se,st)|0,j=(j=j+Math.imul(se,Mt)|0)+Math.imul(oe,st)|0,V=V+Math.imul(oe,Mt)|0;var pr=($+(D=D+Math.imul(J,it)|0)|0)+((8191&(j=(j=j+Math.imul(J,ht)|0)+Math.imul(ee,it)|0))<<13)|0;$=((V=V+Math.imul(ee,ht)|0)+(j>>>13)|0)+(pr>>>26)|0,pr&=67108863,D=Math.imul(Be,Nt),j=(j=Math.imul(Be,qt))+Math.imul(Ie,Nt)|0,V=Math.imul(Ie,qt),D=D+Math.imul(Oe,Wt)|0,j=(j=j+Math.imul(Oe,ar)|0)+Math.imul(De,Wt)|0,V=V+Math.imul(De,ar)|0,D=D+Math.imul(Se,Ne)|0,j=(j=j+Math.imul(Se,qe)|0)+Math.imul(Me,Ne)|0,V=V+Math.imul(Me,qe)|0,D=D+Math.imul(le,be)|0,j=(j=j+Math.imul(le,Fe)|0)+Math.imul(ge,be)|0,V=V+Math.imul(ge,Fe)|0,D=D+Math.imul(fe,Ke)|0,j=(j=j+Math.imul(fe,Ge)|0)+Math.imul(me,Ke)|0,V=V+Math.imul(me,Ge)|0,D=D+Math.imul(ce,st)|0,j=(j=j+Math.imul(ce,Mt)|0)+Math.imul(ve,st)|0,V=V+Math.imul(ve,Mt)|0;var Mr=($+(D=D+Math.imul(se,it)|0)|0)+((8191&(j=(j=j+Math.imul(se,ht)|0)+Math.imul(oe,it)|0))<<13)|0;$=((V=V+Math.imul(oe,ht)|0)+(j>>>13)|0)+(Mr>>>26)|0,Mr&=67108863,D=Math.imul(Be,Wt),j=(j=Math.imul(Be,ar))+Math.imul(Ie,Wt)|0,V=Math.imul(Ie,ar),D=D+Math.imul(Oe,Ne)|0,j=(j=j+Math.imul(Oe,qe)|0)+Math.imul(De,Ne)|0,V=V+Math.imul(De,qe)|0,D=D+Math.imul(Se,be)|0,j=(j=j+Math.imul(Se,Fe)|0)+Math.imul(Me,be)|0,V=V+Math.imul(Me,Fe)|0,D=D+Math.imul(le,Ke)|0,j=(j=j+Math.imul(le,Ge)|0)+Math.imul(ge,Ke)|0,V=V+Math.imul(ge,Ge)|0,D=D+Math.imul(fe,st)|0,j=(j=j+Math.imul(fe,Mt)|0)+Math.imul(me,st)|0,V=V+Math.imul(me,Mt)|0;var hr=($+(D=D+Math.imul(ce,it)|0)|0)+((8191&(j=(j=j+Math.imul(ce,ht)|0)+Math.imul(ve,it)|0))<<13)|0;$=((V=V+Math.imul(ve,ht)|0)+(j>>>13)|0)+(hr>>>26)|0,hr&=67108863,D=Math.imul(Be,Ne),j=(j=Math.imul(Be,qe))+Math.imul(Ie,Ne)|0,V=Math.imul(Ie,qe),D=D+Math.imul(Oe,be)|0,j=(j=j+Math.imul(Oe,Fe)|0)+Math.imul(De,be)|0,V=V+Math.imul(De,Fe)|0,D=D+Math.imul(Se,Ke)|0,j=(j=j+Math.imul(Se,Ge)|0)+Math.imul(Me,Ke)|0,V=V+Math.imul(Me,Ge)|0,D=D+Math.imul(le,st)|0,j=(j=j+Math.imul(le,Mt)|0)+Math.imul(ge,st)|0,V=V+Math.imul(ge,Mt)|0;var Qt=($+(D=D+Math.imul(fe,it)|0)|0)+((8191&(j=(j=j+Math.imul(fe,ht)|0)+Math.imul(me,it)|0))<<13)|0;$=((V=V+Math.imul(me,ht)|0)+(j>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,D=Math.imul(Be,be),j=(j=Math.imul(Be,Fe))+Math.imul(Ie,be)|0,V=Math.imul(Ie,Fe),D=D+Math.imul(Oe,Ke)|0,j=(j=j+Math.imul(Oe,Ge)|0)+Math.imul(De,Ke)|0,V=V+Math.imul(De,Ge)|0,D=D+Math.imul(Se,st)|0,j=(j=j+Math.imul(Se,Mt)|0)+Math.imul(Me,st)|0,V=V+Math.imul(Me,Mt)|0;var tr=($+(D=D+Math.imul(le,it)|0)|0)+((8191&(j=(j=j+Math.imul(le,ht)|0)+Math.imul(ge,it)|0))<<13)|0;$=((V=V+Math.imul(ge,ht)|0)+(j>>>13)|0)+(tr>>>26)|0,tr&=67108863,D=Math.imul(Be,Ke),j=(j=Math.imul(Be,Ge))+Math.imul(Ie,Ke)|0,V=Math.imul(Ie,Ge),D=D+Math.imul(Oe,st)|0,j=(j=j+Math.imul(Oe,Mt)|0)+Math.imul(De,st)|0,V=V+Math.imul(De,Mt)|0;var rr=($+(D=D+Math.imul(Se,it)|0)|0)+((8191&(j=(j=j+Math.imul(Se,ht)|0)+Math.imul(Me,it)|0))<<13)|0;$=((V=V+Math.imul(Me,ht)|0)+(j>>>13)|0)+(rr>>>26)|0,rr&=67108863,D=Math.imul(Be,st),j=(j=Math.imul(Be,Mt))+Math.imul(Ie,st)|0,V=Math.imul(Ie,Mt);var fr=($+(D=D+Math.imul(Oe,it)|0)|0)+((8191&(j=(j=j+Math.imul(Oe,ht)|0)+Math.imul(De,it)|0))<<13)|0;$=((V=V+Math.imul(De,ht)|0)+(j>>>13)|0)+(fr>>>26)|0,fr&=67108863;var yr=($+(D=Math.imul(Be,it))|0)+((8191&(j=(j=Math.imul(Be,ht))+Math.imul(Ie,it)|0))<<13)|0;return $=((V=Math.imul(Ie,ht))+(j>>>13)|0)+(yr>>>26)|0,yr&=67108863,K[0]=jt,K[1]=kt,K[2]=Pt,K[3]=Ee,K[4]=Ze,K[5]=at,K[6]=pt,K[7]=St,K[8]=Ut,K[9]=Kt,K[10]=Ht,K[11]=pr,K[12]=Mr,K[13]=hr,K[14]=Qt,K[15]=tr,K[16]=rr,K[17]=fr,K[18]=yr,$!==0&&(K[19]=$,z.length++),z};function x(S,E,z){return new f().mulp(S,E,z)}function f(S,E){this.x=S,this.y=E}Math.imul||(i=c),r.prototype.mulTo=function(S,E){var z=this.length+S.length;return this.length===10&&S.length===10?i(this,S,E):z<63?c(this,S,E):z<1024?function(D,j,V){V.negative=j.negative^D.negative,V.length=D.length+j.length;for(var Z=0,Q=0,K=0;K<V.length-1;K++){var $=Q;Q=0;for(var ne=67108863&Z,H=Math.min(K,j.length-1),N=Math.max(0,K-D.length+1);N<=H;N++){var U=K-N,te=(0|D.words[U])*(0|j.words[N]),B=67108863&te;ne=67108863&(B=B+ne|0),Q+=($=($=$+(te/67108864|0)|0)+(B>>>26)|0)>>>26,$&=67108863}V.words[K]=ne,Z=$,$=Q}return Z!==0?V.words[K]=Z:V.length--,V.strip()}(this,S,E):x(this,S,E)},f.prototype.makeRBT=function(S){for(var E=new Array(S),z=r.prototype._countBits(S)-1,D=0;D<S;D++)E[D]=this.revBin(D,z,S);return E},f.prototype.revBin=function(S,E,z){if(S===0||S===z-1)return S;for(var D=0,j=0;j<E;j++)D|=(1&S)<<E-j-1,S>>=1;return D},f.prototype.permute=function(S,E,z,D,j,V){for(var Z=0;Z<V;Z++)D[Z]=E[S[Z]],j[Z]=z[S[Z]]},f.prototype.transform=function(S,E,z,D,j,V){this.permute(V,S,E,z,D,j);for(var Z=1;Z<j;Z<<=1)for(var Q=Z<<1,K=Math.cos(2*Math.PI/Q),$=Math.sin(2*Math.PI/Q),ne=0;ne<j;ne+=Q)for(var H=K,N=$,U=0;U<Z;U++){var te=z[ne+U],B=D[ne+U],X=z[ne+U+Z],J=D[ne+U+Z],ee=H*X-N*J;J=H*J+N*X,X=ee,z[ne+U]=te+X,D[ne+U]=B+J,z[ne+U+Z]=te-X,D[ne+U+Z]=B-J,U!==Q&&(ee=K*H-$*N,N=K*N+$*H,H=ee)}},f.prototype.guessLen13b=function(S,E){var z=1|Math.max(E,S),D=1&z,j=0;for(z=z/2|0;z;z>>>=1)j++;return 1<<j+1+D},f.prototype.conjugate=function(S,E,z){if(!(z<=1))for(var D=0;D<z/2;D++){var j=S[D];S[D]=S[z-D-1],S[z-D-1]=j,j=E[D],E[D]=-E[z-D-1],E[z-D-1]=-j}},f.prototype.normalize13b=function(S,E){for(var z=0,D=0;D<E/2;D++){var j=8192*Math.round(S[2*D+1]/E)+Math.round(S[2*D]/E)+z;S[D]=67108863&j,z=j<67108864?0:j/67108864|0}return S},f.prototype.convert13b=function(S,E,z,D){for(var j=0,V=0;V<E;V++)j+=0|S[V],z[2*V]=8191&j,j>>>=13,z[2*V+1]=8191&j,j>>>=13;for(V=2*E;V<D;++V)z[V]=0;n(j===0),n((-8192&j)==0)},f.prototype.stub=function(S){for(var E=new Array(S),z=0;z<S;z++)E[z]=0;return E},f.prototype.mulp=function(S,E,z){var D=2*this.guessLen13b(S.length,E.length),j=this.makeRBT(D),V=this.stub(D),Z=new Array(D),Q=new Array(D),K=new Array(D),$=new Array(D),ne=new Array(D),H=new Array(D),N=z.words;N.length=D,this.convert13b(S.words,S.length,Z,D),this.convert13b(E.words,E.length,$,D),this.transform(Z,V,Q,K,D,j),this.transform($,V,ne,H,D,j);for(var U=0;U<D;U++){var te=Q[U]*ne[U]-K[U]*H[U];K[U]=Q[U]*H[U]+K[U]*ne[U],Q[U]=te}return this.conjugate(Q,K,D),this.transform(Q,K,N,V,D,j),this.conjugate(N,V,D),this.normalize13b(N,D),z.negative=S.negative^E.negative,z.length=S.length+E.length,z.strip()},r.prototype.mul=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},r.prototype.mulf=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),x(this,S,E)},r.prototype.imul=function(S){return this.clone().mulTo(S,this)},r.prototype.imuln=function(S){n(typeof S=="number"),n(S<67108864);for(var E=0,z=0;z<this.length;z++){var D=(0|this.words[z])*S,j=(67108863&D)+(67108863&E);E>>=26,E+=D/67108864|0,E+=j>>>26,this.words[z]=67108863&j}return E!==0&&(this.words[z]=E,this.length++),this},r.prototype.muln=function(S){return this.clone().imuln(S)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(S){var E=function(V){for(var Z=new Array(V.bitLength()),Q=0;Q<Z.length;Q++){var K=Q/26|0,$=Q%26;Z[Q]=(V.words[K]&1<<$)>>>$}return Z}(S);if(E.length===0)return new r(1);for(var z=this,D=0;D<E.length&&E[D]===0;D++,z=z.sqr());if(++D<E.length)for(var j=z.sqr();D<E.length;D++,j=j.sqr())E[D]!==0&&(z=z.mul(j));return z},r.prototype.iushln=function(S){n(typeof S=="number"&&S>=0);var E,z=S%26,D=(S-z)/26,j=67108863>>>26-z<<26-z;if(z!==0){var V=0;for(E=0;E<this.length;E++){var Z=this.words[E]&j,Q=(0|this.words[E])-Z<<z;this.words[E]=Q|V,V=Z>>>26-z}V&&(this.words[E]=V,this.length++)}if(D!==0){for(E=this.length-1;E>=0;E--)this.words[E+D]=this.words[E];for(E=0;E<D;E++)this.words[E]=0;this.length+=D}return this.strip()},r.prototype.ishln=function(S){return n(this.negative===0),this.iushln(S)},r.prototype.iushrn=function(S,E,z){var D;n(typeof S=="number"&&S>=0),D=E?(E-E%26)/26:0;var j=S%26,V=Math.min((S-j)/26,this.length),Z=67108863^67108863>>>j<<j,Q=z;if(D-=V,D=Math.max(0,D),Q){for(var K=0;K<V;K++)Q.words[K]=this.words[K];Q.length=V}if(V!==0)if(this.length>V)for(this.length-=V,K=0;K<this.length;K++)this.words[K]=this.words[K+V];else this.words[0]=0,this.length=1;var $=0;for(K=this.length-1;K>=0&&($!==0||K>=D);K--){var ne=0|this.words[K];this.words[K]=$<<26-j|ne>>>j,$=ne&Z}return Q&&$!==0&&(Q.words[Q.length++]=$),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(S,E,z){return n(this.negative===0),this.iushrn(S,E,z)},r.prototype.shln=function(S){return this.clone().ishln(S)},r.prototype.ushln=function(S){return this.clone().iushln(S)},r.prototype.shrn=function(S){return this.clone().ishrn(S)},r.prototype.ushrn=function(S){return this.clone().iushrn(S)},r.prototype.testn=function(S){n(typeof S=="number"&&S>=0);var E=S%26,z=(S-E)/26,D=1<<E;return!(this.length<=z)&&!!(this.words[z]&D)},r.prototype.imaskn=function(S){n(typeof S=="number"&&S>=0);var E=S%26,z=(S-E)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=z)return this;if(E!==0&&z++,this.length=Math.min(z,this.length),E!==0){var D=67108863^67108863>>>E<<E;this.words[this.length-1]&=D}return this.strip()},r.prototype.maskn=function(S){return this.clone().imaskn(S)},r.prototype.iaddn=function(S){return n(typeof S=="number"),n(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},r.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},r.prototype.isubn=function(S){if(n(typeof S=="number"),n(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},r.prototype.addn=function(S){return this.clone().iaddn(S)},r.prototype.subn=function(S){return this.clone().isubn(S)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(S,E,z){var D,j,V=S.length+z;this._expand(V);var Z=0;for(D=0;D<S.length;D++){j=(0|this.words[D+z])+Z;var Q=(0|S.words[D])*E;Z=((j-=67108863&Q)>>26)-(Q/67108864|0),this.words[D+z]=67108863&j}for(;D<this.length-z;D++)Z=(j=(0|this.words[D+z])+Z)>>26,this.words[D+z]=67108863&j;if(Z===0)return this.strip();for(n(Z===-1),Z=0,D=0;D<this.length;D++)Z=(j=-(0|this.words[D])+Z)>>26,this.words[D]=67108863&j;return this.negative=1,this.strip()},r.prototype._wordDiv=function(S,E){var z=(this.length,S.length),D=this.clone(),j=S,V=0|j.words[j.length-1];(z=26-this._countBits(V))!==0&&(j=j.ushln(z),D.iushln(z),V=0|j.words[j.length-1]);var Z,Q=D.length-j.length;if(E!=="mod"){(Z=new r(null)).length=Q+1,Z.words=new Array(Z.length);for(var K=0;K<Z.length;K++)Z.words[K]=0}var $=D.clone()._ishlnsubmul(j,1,Q);$.negative===0&&(D=$,Z&&(Z.words[Q]=1));for(var ne=Q-1;ne>=0;ne--){var H=67108864*(0|D.words[j.length+ne])+(0|D.words[j.length+ne-1]);for(H=Math.min(H/V|0,67108863),D._ishlnsubmul(j,H,ne);D.negative!==0;)H--,D.negative=0,D._ishlnsubmul(j,1,ne),D.isZero()||(D.negative^=1);Z&&(Z.words[ne]=H)}return Z&&Z.strip(),D.strip(),E!=="div"&&z!==0&&D.iushrn(z),{div:Z||null,mod:D}},r.prototype.divmod=function(S,E,z){return n(!S.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:this.negative!==0&&S.negative===0?(V=this.neg().divmod(S,E),E!=="mod"&&(D=V.div.neg()),E!=="div"&&(j=V.mod.neg(),z&&j.negative!==0&&j.iadd(S)),{div:D,mod:j}):this.negative===0&&S.negative!==0?(V=this.divmod(S.neg(),E),E!=="mod"&&(D=V.div.neg()),{div:D,mod:V.mod}):(this.negative&S.negative)!=0?(V=this.neg().divmod(S.neg(),E),E!=="div"&&(j=V.mod.neg(),z&&j.negative!==0&&j.isub(S)),{div:V.div,mod:j}):S.length>this.length||this.cmp(S)<0?{div:new r(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new r(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new r(this.modn(S.words[0]))}:this._wordDiv(S,E);var D,j,V},r.prototype.div=function(S){return this.divmod(S,"div",!1).div},r.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},r.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},r.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var z=E.div.negative!==0?E.mod.isub(S):E.mod,D=S.ushrn(1),j=S.andln(1),V=z.cmp(D);return V<0||j===1&&V===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},r.prototype.modn=function(S){n(S<=67108863);for(var E=(1<<26)%S,z=0,D=this.length-1;D>=0;D--)z=(E*z+(0|this.words[D]))%S;return z},r.prototype.idivn=function(S){n(S<=67108863);for(var E=0,z=this.length-1;z>=0;z--){var D=(0|this.words[z])+67108864*E;this.words[z]=D/S|0,E=D%S}return this.strip()},r.prototype.divn=function(S){return this.clone().idivn(S)},r.prototype.egcd=function(S){n(S.negative===0),n(!S.isZero());var E=this,z=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var D=new r(1),j=new r(0),V=new r(0),Z=new r(1),Q=0;E.isEven()&&z.isEven();)E.iushrn(1),z.iushrn(1),++Q;for(var K=z.clone(),$=E.clone();!E.isZero();){for(var ne=0,H=1;(E.words[0]&H)==0&&ne<26;++ne,H<<=1);if(ne>0)for(E.iushrn(ne);ne-- >0;)(D.isOdd()||j.isOdd())&&(D.iadd(K),j.isub($)),D.iushrn(1),j.iushrn(1);for(var N=0,U=1;(z.words[0]&U)==0&&N<26;++N,U<<=1);if(N>0)for(z.iushrn(N);N-- >0;)(V.isOdd()||Z.isOdd())&&(V.iadd(K),Z.isub($)),V.iushrn(1),Z.iushrn(1);E.cmp(z)>=0?(E.isub(z),D.isub(V),j.isub(Z)):(z.isub(E),V.isub(D),Z.isub(j))}return{a:V,b:Z,gcd:z.iushln(Q)}},r.prototype._invmp=function(S){n(S.negative===0),n(!S.isZero());var E=this,z=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var D,j=new r(1),V=new r(0),Z=z.clone();E.cmpn(1)>0&&z.cmpn(1)>0;){for(var Q=0,K=1;(E.words[0]&K)==0&&Q<26;++Q,K<<=1);if(Q>0)for(E.iushrn(Q);Q-- >0;)j.isOdd()&&j.iadd(Z),j.iushrn(1);for(var $=0,ne=1;(z.words[0]&ne)==0&&$<26;++$,ne<<=1);if($>0)for(z.iushrn($);$-- >0;)V.isOdd()&&V.iadd(Z),V.iushrn(1);E.cmp(z)>=0?(E.isub(z),j.isub(V)):(z.isub(E),V.isub(j))}return(D=E.cmpn(1)===0?j:V).cmpn(0)<0&&D.iadd(S),D},r.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),z=S.clone();E.negative=0,z.negative=0;for(var D=0;E.isEven()&&z.isEven();D++)E.iushrn(1),z.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;z.isEven();)z.iushrn(1);var j=E.cmp(z);if(j<0){var V=E;E=z,z=V}else if(j===0||z.cmpn(1)===0)break;E.isub(z)}return z.iushln(D)},r.prototype.invm=function(S){return this.egcd(S).a.umod(S)},r.prototype.isEven=function(){return(1&this.words[0])==0},r.prototype.isOdd=function(){return(1&this.words[0])==1},r.prototype.andln=function(S){return this.words[0]&S},r.prototype.bincn=function(S){n(typeof S=="number");var E=S%26,z=(S-E)/26,D=1<<E;if(this.length<=z)return this._expand(z+1),this.words[z]|=D,this;for(var j=D,V=z;j!==0&&V<this.length;V++){var Z=0|this.words[V];j=(Z+=j)>>>26,Z&=67108863,this.words[V]=Z}return j!==0&&(this.words[V]=j,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(S){var E,z=S<0;if(this.negative!==0&&!z)return-1;if(this.negative===0&&z)return 1;if(this.strip(),this.length>1)E=1;else{z&&(S=-S),n(S<=67108863,"Number is too big");var D=0|this.words[0];E=D===S?0:D<S?-1:1}return this.negative!==0?0|-E:E},r.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},r.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,z=this.length-1;z>=0;z--){var D=0|this.words[z],j=0|S.words[z];if(D!==j){D<j?E=-1:D>j&&(E=1);break}}return E},r.prototype.gtn=function(S){return this.cmpn(S)===1},r.prototype.gt=function(S){return this.cmp(S)===1},r.prototype.gten=function(S){return this.cmpn(S)>=0},r.prototype.gte=function(S){return this.cmp(S)>=0},r.prototype.ltn=function(S){return this.cmpn(S)===-1},r.prototype.lt=function(S){return this.cmp(S)===-1},r.prototype.lten=function(S){return this.cmpn(S)<=0},r.prototype.lte=function(S){return this.cmp(S)<=0},r.prototype.eqn=function(S){return this.cmpn(S)===0},r.prototype.eq=function(S){return this.cmp(S)===0},r.red=function(S){return new I(S)},r.prototype.toRed=function(S){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},r.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(S){return this.red=S,this},r.prototype.forceRed=function(S){return n(!this.red,"Already a number in reduction context"),this._forceRed(S)},r.prototype.redAdd=function(S){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},r.prototype.redIAdd=function(S){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},r.prototype.redSub=function(S){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},r.prototype.redISub=function(S){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},r.prototype.redShl=function(S){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},r.prototype.redMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},r.prototype.redIMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},r.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(S){return n(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var _={k256:null,p224:null,p192:null,p25519:null};function b(S,E){this.name=S,this.p=new r(E,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function T(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if(typeof S=="string"){var E=r._prime(S);this.m=E.p,this.prime=E}else n(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function P(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var S=new r(null);return S.words=new Array(Math.ceil(this.n/13)),S},b.prototype.ireduce=function(S){var E,z=S;do this.split(z,this.tmp),E=(z=(z=this.imulK(z)).iadd(this.tmp)).bitLength();while(E>this.n);var D=E<this.n?-1:z.ucmp(this.p);return D===0?(z.words[0]=0,z.length=1):D>0?z.isub(this.p):z.strip!==void 0?z.strip():z._strip(),z},b.prototype.split=function(S,E){S.iushrn(this.n,0,E)},b.prototype.imulK=function(S){return S.imul(this.k)},a(T,b),T.prototype.split=function(S,E){for(var z=Math.min(S.length,9),D=0;D<z;D++)E.words[D]=S.words[D];if(E.length=z,S.length<=9)return S.words[0]=0,void(S.length=1);var j=S.words[9];for(E.words[E.length++]=4194303&j,D=10;D<S.length;D++){var V=0|S.words[D];S.words[D-10]=(4194303&V)<<4|j>>>22,j=V}j>>>=22,S.words[D-10]=j,j===0&&S.length>10?S.length-=10:S.length-=9},T.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,z=0;z<S.length;z++){var D=0|S.words[z];E+=977*D,S.words[z]=67108863&E,E=64*D+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},a(k,b),a(L,b),a(A,b),A.prototype.imulK=function(S){for(var E=0,z=0;z<S.length;z++){var D=19*(0|S.words[z])+E,j=67108863&D;D>>>=26,S.words[z]=j,E=D}return E!==0&&(S.words[S.length++]=E),S},r._prime=function(S){if(_[S])return _[S];var E;if(S==="k256")E=new T;else if(S==="p224")E=new k;else if(S==="p192")E=new L;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new A}return _[S]=E,E},I.prototype._verify1=function(S){n(S.negative===0,"red works only with positives"),n(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){n((S.negative|E.negative)==0,"red works only with positives"),n(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var z=S.add(E);return z.cmp(this.m)>=0&&z.isub(this.m),z._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var z=S.iadd(E);return z.cmp(this.m)>=0&&z.isub(this.m),z},I.prototype.sub=function(S,E){this._verify2(S,E);var z=S.sub(E);return z.cmpn(0)<0&&z.iadd(this.m),z._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var z=S.isub(E);return z.cmpn(0)<0&&z.iadd(this.m),z},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(n(E%2==1),E===3){var z=this.m.add(new r(1)).iushrn(2);return this.pow(S,z)}for(var D=this.m.subn(1),j=0;!D.isZero()&&D.andln(1)===0;)j++,D.iushrn(1);n(!D.isZero());var V=new r(1).toRed(this),Z=V.redNeg(),Q=this.m.subn(1).iushrn(1),K=this.m.bitLength();for(K=new r(2*K*K).toRed(this);this.pow(K,Q).cmp(Z)!==0;)K.redIAdd(Z);for(var $=this.pow(K,D),ne=this.pow(S,D.addn(1).iushrn(1)),H=this.pow(S,D),N=j;H.cmp(V)!==0;){for(var U=H,te=0;U.cmp(V)!==0;te++)U=U.redSqr();n(te<N);var B=this.pow($,new r(1).iushln(N-te-1));ne=ne.redMul(B),$=B.redSqr(),H=H.redMul($),N=te}return ne},I.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new r(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var z=new Array(16);z[0]=new r(1).toRed(this),z[1]=S;for(var D=2;D<z.length;D++)z[D]=this.mul(z[D-1],S);var j=z[0],V=0,Z=0,Q=E.bitLength()%26;for(Q===0&&(Q=26),D=E.length-1;D>=0;D--){for(var K=E.words[D],$=Q-1;$>=0;$--){var ne=K>>$&1;j!==z[0]&&(j=this.sqr(j)),ne!==0||V!==0?(V<<=1,V|=ne,(++Z===4||D===0&&$===0)&&(j=this.mul(j,z[V]),Z=0,V=0)):Z=0}Q=26}return j},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},r.mont=function(S){return new P(S)},a(P,I),P.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},P.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},P.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var z=S.imul(E),D=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=z.isub(D).iushrn(this.shift),V=j;return j.cmp(this.m)>=0?V=j.isub(this.m):j.cmpn(0)<0&&(V=j.iadd(this.m)),V._forceRed(this)},P.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new r(0)._forceRed(this);var z=S.mul(E),D=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=z.isub(D).iushrn(this.shift),V=j;return j.cmp(this.m)>=0?V=j.isub(this.m):j.cmpn(0)<0&&(V=j.iadd(this.m)),V._forceRed(this)},P.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(w===void 0||w,this)},{buffer:2}],34:[function(v,w,y){w.exports=function(e){var t,n,a,r=e.length,g=0;for(t=0;t<r;++t)g+=e[t].length;var u=new Array(g),s=0;for(t=0;t<r;++t){var h=e[t],l=h.length;for(n=0;n<l;++n){var o=u[s++]=new Array(l-1),p=0;for(a=0;a<l;++a)a!==n&&(o[p++]=h[a]);if(1&n){var c=o[1];o[1]=o[0],o[0]=c}}}return u}},{}],35:[function(v,w,y){w.exports=function(o,p,c){switch(arguments.length){case 1:return h(o);case 2:return typeof p=="function"?u(o,o,p,!0):l(o,p);case 3:return u(o,p,c,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,t=v("typedarray-pool"),n=v("./lib/sweep"),a=v("./lib/intersect");function r(o,p){for(var c=0;c<o;++c)if(!(p[c]<=p[c+o]))return!0;return!1}function g(o,p,c,i){for(var x=0,f=0,_=0,b=o.length;_<b;++_){var T=o[_];if(!r(p,T)){for(var k=0;k<2*p;++k)c[x++]=T[k];i[f++]=_}}return f}function u(o,p,c,i){var x=o.length,f=p.length;if(!(x<=0||f<=0)){var _=o[0].length>>>1;if(!(_<=0)){var b,T=t.mallocDouble(2*_*x),k=t.mallocInt32(x);if((x=g(o,_,T,k))>0){if(_===1&&i)n.init(x),b=n.sweepComplete(_,c,0,x,T,k,0,x,T,k);else{var L=t.mallocDouble(2*_*f),A=t.mallocInt32(f);(f=g(p,_,L,A))>0&&(n.init(x+f),b=_===1?n.sweepBipartite(_,c,0,x,T,k,0,f,L,A):a(_,c,i,x,T,k,f,L,A),t.free(L),t.free(A))}t.free(T),t.free(k)}return b}}}function s(o,p){e.push([o,p])}function h(o){return e=[],u(o,o,s,!0),e}function l(o,p){return e=[],u(o,p,s,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(v,w,y){function e(t){return t?function(n,a,r,g,u,s,h,l,o,p,c){return u-g>o-l?function(i,x,f,_,b,T,k,L,A,I,P){for(var S=2*i,E=_,z=S*_;E<b;++E,z+=S){var D=T[x+z],j=T[x+z+i],V=k[E];e:for(var Z=L,Q=S*L;Z<A;++Z,Q+=S){var K=I[x+Q],$=I[x+Q+i],ne=P[Z];if(!($<D||j<K)){for(var H=x+1;H<i;++H){var N=T[H+z],U=T[H+i+z],te=I[H+Q],B=I[H+i+Q];if(U<te||B<N)continue e}var X=f(V,ne);if(X!==void 0)return X}}}}(n,a,r,g,u,s,h,l,o,p,c):function(i,x,f,_,b,T,k,L,A,I,P){for(var S=2*i,E=L,z=S*L;E<A;++E,z+=S){var D=I[x+z],j=I[x+z+i],V=P[E];e:for(var Z=_,Q=S*_;Z<b;++Z,Q+=S){var K=T[x+Q],$=T[x+Q+i],ne=k[Z];if(!(j<K||$<D)){for(var H=x+1;H<i;++H){var N=T[H+Q],U=T[H+i+Q],te=I[H+z],B=I[H+i+z];if(U<te||B<N)continue e}var X=f(ne,V);if(X!==void 0)return X}}}}(n,a,r,g,u,s,h,l,o,p,c)}:function(n,a,r,g,u,s,h,l,o,p,c,i){return s-u>p-o?g?function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=b,D=E*b;z<T;++z,D+=E){var j=k[f+D],V=k[f+D+x],Z=L[z];e:for(var Q=A,K=E*A;Q<I;++Q,K+=E){var $=P[f+K],ne=S[Q];if(!($<=j||V<$)){for(var H=f+1;H<x;++H){var N=k[H+D],U=k[H+x+D],te=P[H+K],B=P[H+x+K];if(U<te||B<N)continue e}var X=_(ne,Z);if(X!==void 0)return X}}}}(n,a,r,u,s,h,l,o,p,c,i):function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=b,D=E*b;z<T;++z,D+=E){var j=k[f+D],V=k[f+D+x],Z=L[z];e:for(var Q=A,K=E*A;Q<I;++Q,K+=E){var $=P[f+K],ne=S[Q];if(!($<j||V<$)){for(var H=f+1;H<x;++H){var N=k[H+D],U=k[H+x+D],te=P[H+K],B=P[H+x+K];if(U<te||B<N)continue e}var X=_(Z,ne);if(X!==void 0)return X}}}}(n,a,r,u,s,h,l,o,p,c,i):g?function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=A,D=E*A;z<I;++z,D+=E){var j=P[f+D],V=S[z];e:for(var Z=b,Q=E*b;Z<T;++Z,Q+=E){var K=k[f+Q],$=k[f+Q+x],ne=L[Z];if(!(j<=K||$<j)){for(var H=f+1;H<x;++H){var N=k[H+Q],U=k[H+x+Q],te=P[H+D],B=P[H+x+D];if(U<te||B<N)continue e}var X=_(V,ne);if(X!==void 0)return X}}}}(n,a,r,u,s,h,l,o,p,c,i):function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=A,D=E*A;z<I;++z,D+=E){var j=P[f+D],V=S[z];e:for(var Z=b,Q=E*b;Z<T;++Z,Q+=E){var K=k[f+Q],$=k[f+Q+x],ne=L[Z];if(!(j<K||$<j)){for(var H=f+1;H<x;++H){var N=k[H+Q],U=k[H+x+Q],te=P[H+D],B=P[H+x+D];if(U<te||B<N)continue e}var X=_(ne,V);if(X!==void 0)return X}}}}(n,a,r,u,s,h,l,o,p,c,i)}}y.partial=e(!1),y.full=e(!0)},{}],37:[function(v,w,y){w.exports=function(k,L,A,I,P,S,E,z,D){(function(Te,Se){var Me=8*t.log2(Se+1)*(Te+1)|0,ze=t.nextPow2(6*Me);x.length<ze&&(e.free(x),x=e.mallocInt32(ze));var Oe=t.nextPow2(2*Me);f.length<Oe&&(e.free(f),f=e.mallocDouble(Oe))})(k,I+E);var j,V=0,Z=2*k;for(_(V++,0,0,I,0,E,A?16:0,-1/0,1/0),A||_(V++,0,0,E,0,I,1,-1/0,1/0);V>0;){var Q=6*(V-=1),K=x[Q],$=x[Q+1],ne=x[Q+2],H=x[Q+3],N=x[Q+4],U=x[Q+5],te=2*V,B=f[te],X=f[te+1],J=1&U,ee=!!(16&U),re=P,se=S,oe=z,de=D;if(J&&(re=z,se=D,oe=P,de=S),!(2&U&&(ne=o(k,K,$,ne,re,se,X),$>=ne)||4&U&&($=p(k,K,$,ne,re,se,B))>=ne)){var ce=ne-$,ve=N-H;if(ee){if(k*ce*(ce+ve)<1<<22){if((j=g.scanComplete(k,K,L,$,ne,re,se,H,N,oe,de))!==void 0)return j;continue}}else{if(k*Math.min(ce,ve)<128){if((j=a(k,K,L,J,$,ne,re,se,H,N,oe,de))!==void 0)return j;continue}if(k*ce*ve<1<<22){if((j=g.scanBipartite(k,K,L,J,$,ne,re,se,H,N,oe,de))!==void 0)return j;continue}}var Ae=h(k,K,$,ne,re,se,B,X);if($<Ae)if(k*(Ae-$)<128){if((j=r(k,K+1,L,$,Ae,re,se,H,N,oe,de))!==void 0)return j}else if(K===k-2){if((j=J?g.sweepBipartite(k,L,H,N,oe,de,$,Ae,re,se):g.sweepBipartite(k,L,$,Ae,re,se,H,N,oe,de))!==void 0)return j}else _(V++,K+1,$,Ae,H,N,J,-1/0,1/0),_(V++,K+1,H,N,$,Ae,1^J,-1/0,1/0);if(Ae<ne){var fe=u(k,K,H,N,oe,de),me=oe[Z*fe+K],_e=l(k,K,fe,N,oe,de,me);if(_e<N&&_(V++,K,Ae,ne,_e,N,(4|J)+(ee?16:0),me,X),H<fe&&_(V++,K,Ae,ne,H,fe,(2|J)+(ee?16:0),B,me),fe+1===_e){if((j=ee?T(k,K,L,Ae,ne,re,se,fe,oe,de[fe]):b(k,K,L,J,Ae,ne,re,se,fe,oe,de[fe]))!==void 0)return j}else if(fe<_e){var le;if(ee){if(le=c(k,K,Ae,ne,re,se,me),Ae<le){var ge=l(k,K,Ae,le,re,se,me);if(K===k-2){if(Ae<ge&&(j=g.sweepComplete(k,L,Ae,ge,re,se,fe,_e,oe,de))!==void 0||ge<le&&(j=g.sweepBipartite(k,L,ge,le,re,se,fe,_e,oe,de))!==void 0)return j}else Ae<ge&&_(V++,K+1,Ae,ge,fe,_e,16,-1/0,1/0),ge<le&&(_(V++,K+1,ge,le,fe,_e,0,-1/0,1/0),_(V++,K+1,fe,_e,ge,le,1,-1/0,1/0))}}else le=J?i(k,K,Ae,ne,re,se,me):c(k,K,Ae,ne,re,se,me),Ae<le&&(K===k-2?j=J?g.sweepBipartite(k,L,fe,_e,oe,de,Ae,le,re,se):g.sweepBipartite(k,L,Ae,le,re,se,fe,_e,oe,de):(_(V++,K+1,Ae,le,fe,_e,J,-1/0,1/0),_(V++,K+1,fe,_e,Ae,le,1^J,-1/0,1/0)))}}}}};var e=v("typedarray-pool"),t=v("bit-twiddle"),n=v("./brute"),a=n.partial,r=n.full,g=v("./sweep"),u=v("./median"),s=v("./partition"),h=s("!(lo>=p0)&&!(p1>=hi)"),l=s("lo===p0"),o=s("lo<p0"),p=s("hi<=p0"),c=s("lo<=p0&&p0<=hi"),i=s("lo<p0&&p0<=hi"),x=e.mallocInt32(1024),f=e.mallocDouble(1024);function _(k,L,A,I,P,S,E,z,D){var j=6*k;x[j]=L,x[j+1]=A,x[j+2]=I,x[j+3]=P,x[j+4]=S,x[j+5]=E;var V=2*k;f[V]=z,f[V+1]=D}function b(k,L,A,I,P,S,E,z,D,j,V){var Z=2*k,Q=D*Z,K=j[Q+L];e:for(var $=P,ne=P*Z;$<S;++$,ne+=Z){var H=E[ne+L],N=E[ne+L+k];if(!(K<H||N<K)&&(!I||K!==H)){for(var U,te=z[$],B=L+1;B<k;++B){H=E[ne+B],N=E[ne+B+k];var X=j[Q+B],J=j[Q+B+k];if(N<X||J<H)continue e}if((U=I?A(V,te):A(te,V))!==void 0)return U}}}function T(k,L,A,I,P,S,E,z,D,j){var V=2*k,Z=z*V,Q=D[Z+L];e:for(var K=I,$=I*V;K<P;++K,$+=V){var ne=E[K];if(ne!==j){var H=S[$+L],N=S[$+L+k];if(!(Q<H||N<Q)){for(var U=L+1;U<k;++U){H=S[$+U],N=S[$+U+k];var te=D[Z+U],B=D[Z+U+k];if(N<te||B<H)continue e}var X=A(ne,j);if(X!==void 0)return X}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(v,w,y){w.exports=function(n,a,r,g,u,s){if(g<=r+1)return r;for(var h=r,l=g,o=g+r>>>1,p=2*n,c=o,i=u[p*o+a];h<l;){if(l-h<8){t(n,a,h,l,u,s),i=u[p*o+a];break}var x=l-h,f=Math.random()*x+h|0,_=u[p*f+a],b=Math.random()*x+h|0,T=u[p*b+a],k=Math.random()*x+h|0,L=u[p*k+a];_<=T?L>=T?(c=b,i=T):_>=L?(c=f,i=_):(c=k,i=L):T>=L?(c=b,i=T):L>=_?(c=f,i=_):(c=k,i=L);for(var A=p*(l-1),I=p*c,P=0;P<p;++P,++A,++I){var S=u[A];u[A]=u[I],u[I]=S}var E=s[l-1];for(s[l-1]=s[c],s[c]=E,c=e(n,a,h,l-1,u,s,i),A=p*(l-1),I=p*c,P=0;P<p;++P,++A,++I)S=u[A],u[A]=u[I],u[I]=S;if(E=s[l-1],s[l-1]=s[c],s[c]=E,o<c){for(l=c-1;h<l&&u[p*(l-1)+a]===i;)l-=1;l+=1}else{if(!(c<o))break;for(h=c+1;h<l&&u[p*h+a]===i;)h+=1}}return e(n,a,r,o,u,s,u[p*o+a])};var e=v("./partition")("lo<p0");function t(n,a,r,g,u,s){for(var h=2*n,l=h*(r+1)+a,o=r+1;o<g;++o,l+=h)for(var p=u[l],c=o,i=h*(o-1);c>r&&u[i+a]>p;--c,i-=h){for(var x=i,f=i+h,_=0;_<h;++_,++x,++f){var b=u[x];u[x]=u[f],u[f]=b}var T=s[c];s[c]=s[c-1],s[c-1]=T}}},{"./partition":39}],39:[function(v,w,y){w.exports=function(t){return e[t]};var e={"lo===p0":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=n,i=a;r>i;++i,l+=h)if(g[l+c]===s)if(p===i)p+=1,o+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[o],g[o++]=f}var _=u[i];u[i]=u[p],u[p++]=_}return p},"lo<p0":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=n,i=a;r>i;++i,l+=h)if(g[l+c]<s)if(p===i)p+=1,o+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[o],g[o++]=f}var _=u[i];u[i]=u[p],u[p++]=_}return p},"lo<=p0":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=t+n,i=a;r>i;++i,l+=h)if(g[l+c]<=s)if(p===i)p+=1,o+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[o],g[o++]=f}var _=u[i];u[i]=u[p],u[p++]=_}return p},"hi<=p0":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=t+n,i=a;r>i;++i,l+=h)if(g[l+c]<=s)if(p===i)p+=1,o+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[o],g[o++]=f}var _=u[i];u[i]=u[p],u[p++]=_}return p},"lo<p0&&p0<=hi":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=n,i=t+n,x=a;r>x;++x,l+=h){var f=g[l+c],_=g[l+i];if(f<s&&s<=_)if(p===x)p+=1,o+=h;else{for(var b=0;h>b;++b){var T=g[l+b];g[l+b]=g[o],g[o++]=T}var k=u[x];u[x]=u[p],u[p++]=k}}return p},"lo<=p0&&p0<=hi":function(t,n,a,r,g,u,s){for(var h=2*t,l=h*a,o=l,p=a,c=n,i=t+n,x=a;r>x;++x,l+=h){var f=g[l+c],_=g[l+i];if(f<=s&&s<=_)if(p===x)p+=1,o+=h;else{for(var b=0;h>b;++b){var T=g[l+b];g[l+b]=g[o],g[o++]=T}var k=u[x];u[x]=u[p],u[p++]=k}}return p},"!(lo>=p0)&&!(p1>=hi)":function(t,n,a,r,g,u,s,h){for(var l=2*t,o=l*a,p=o,c=a,i=n,x=t+n,f=a;r>f;++f,o+=l){var _=g[o+i],b=g[o+x];if(!(_>=s||h>=b))if(c===f)c+=1,p+=l;else{for(var T=0;l>T;++T){var k=g[o+T];g[o+T]=g[p],g[p++]=k}var L=u[f];u[f]=u[c],u[c++]=L}}return c}}},{}],40:[function(v,w,y){w.exports=function(s,h){h<=128?e(0,h-1,s):function l(o,p,c){var i=(p-o+1)/6|0,x=o+i,f=p-i,_=o+p>>1,b=_-i,T=_+i,k=x,L=b,A=_,I=T,P=f,S=o+1,E=p-1,z=0;g(k,L,c)&&(z=k,k=L,L=z),g(I,P,c)&&(z=I,I=P,P=z),g(k,A,c)&&(z=k,k=A,A=z),g(L,A,c)&&(z=L,L=A,A=z),g(k,I,c)&&(z=k,k=I,I=z),g(A,I,c)&&(z=A,A=I,I=z),g(L,P,c)&&(z=L,L=P,P=z),g(L,A,c)&&(z=L,L=A,A=z),g(I,P,c)&&(z=I,I=P,P=z);for(var D=c[2*L],j=c[2*L+1],V=c[2*I],Z=c[2*I+1],Q=2*k,K=2*A,$=2*P,ne=2*x,H=2*_,N=2*f,U=0;U<2;++U){var te=c[Q+U],B=c[K+U],X=c[$+U];c[ne+U]=te,c[H+U]=B,c[N+U]=X}n(b,o,c),n(T,p,c);for(var J=S;J<=E;++J)if(u(J,D,j,c))J!==S&&t(J,S,c),++S;else if(!u(J,V,Z,c))for(;;){if(u(E,V,Z,c)){u(E,D,j,c)?(a(J,S,E,c),++S,--E):(t(J,E,c),--E);break}if(--E<J)break}r(o,S-1,D,j,c),r(p,E+1,V,Z,c),S-2-o<=32?e(o,S-2,c):l(o,S-2,c),p-(E+2)<=32?e(E+2,p,c):l(E+2,p,c),E-S<=32?e(S,E,c):l(S,E,c)}(0,h-1,s)};function e(s,h,l){for(var o=2*(s+1),p=s+1;p<=h;++p){for(var c=l[o++],i=l[o++],x=p,f=o-2;x-- >s;){var _=l[f-2],b=l[f-1];if(_<c||_===c&&b<i)break;l[f]=_,l[f+1]=b,f-=2}l[f]=c,l[f+1]=i}}function t(s,h,l){h*=2;var o=l[s*=2],p=l[s+1];l[s]=l[h],l[s+1]=l[h+1],l[h]=o,l[h+1]=p}function n(s,h,l){h*=2,l[s*=2]=l[h],l[s+1]=l[h+1]}function a(s,h,l,o){h*=2,l*=2;var p=o[s*=2],c=o[s+1];o[s]=o[h],o[s+1]=o[h+1],o[h]=o[l],o[h+1]=o[l+1],o[l]=p,o[l+1]=c}function r(s,h,l,o,p){h*=2,p[s*=2]=p[h],p[h]=l,p[s+1]=p[h+1],p[h+1]=o}function g(s,h,l){h*=2;var o=l[s*=2],p=l[h];return!(o<p)&&(o!==p||l[s+1]>l[h+1])}function u(s,h,l,o){var p=o[s*=2];return p<h||p===h&&o[s+1]<l}},{}],41:[function(v,w,y){w.exports={init:function(c){var i=t.nextPow2(c);a.length<i&&(e.free(a),a=e.mallocInt32(i)),r.length<i&&(e.free(r),r=e.mallocInt32(i)),g.length<i&&(e.free(g),g=e.mallocInt32(i)),u.length<i&&(e.free(u),u=e.mallocInt32(i)),s.length<i&&(e.free(s),s=e.mallocInt32(i)),h.length<i&&(e.free(h),h=e.mallocInt32(i));var x=8*i;l.length<x&&(e.free(l),l=e.mallocDouble(x))},sweepBipartite:function(c,i,x,f,_,b,T,k,L,A){for(var I=0,P=2*c,S=c-1,E=P-1,z=x;z<f;++z){var D=b[z],j=P*z;l[I++]=_[j+S],l[I++]=-(D+1),l[I++]=_[j+E],l[I++]=D}for(z=T;z<k;++z){D=A[z]+(1<<28);var V=P*z;l[I++]=L[V+S],l[I++]=-D,l[I++]=L[V+E],l[I++]=D}var Z=I>>>1;n(l,Z);var Q=0,K=0;for(z=0;z<Z;++z){var $=0|l[2*z+1];if($>=1<<28)o(g,u,K--,$=$-(1<<28)|0);else if($>=0)o(a,r,Q--,$);else if($<=-(1<<28)){$=-$-(1<<28)|0;for(var ne=0;ne<Q;++ne)if((H=i(a[ne],$))!==void 0)return H;p(g,u,K++,$)}else{for($=-$-1|0,ne=0;ne<K;++ne){var H;if((H=i($,g[ne]))!==void 0)return H}p(a,r,Q++,$)}}},sweepComplete:function(c,i,x,f,_,b,T,k,L,A){for(var I=0,P=2*c,S=c-1,E=P-1,z=x;z<f;++z){var D=b[z]+1<<1,j=P*z;l[I++]=_[j+S],l[I++]=-D,l[I++]=_[j+E],l[I++]=D}for(z=T;z<k;++z){D=A[z]+1<<1;var V=P*z;l[I++]=L[V+S],l[I++]=1|-D,l[I++]=L[V+E],l[I++]=1|D}var Z=I>>>1;n(l,Z);var Q=0,K=0,$=0;for(z=0;z<Z;++z){var ne=0|l[2*z+1],H=1&ne;if(z<Z-1&&ne>>1==l[2*z+3]>>1&&(H=2,z+=1),ne<0){for(var N=-(ne>>1)-1,U=0;U<$;++U)if((te=i(s[U],N))!==void 0)return te;if(H!==0){for(U=0;U<Q;++U)if((te=i(a[U],N))!==void 0)return te}if(H!==1)for(U=0;U<K;++U){var te;if((te=i(g[U],N))!==void 0)return te}H===0?p(a,r,Q++,N):H===1?p(g,u,K++,N):H===2&&p(s,h,$++,N)}else N=(ne>>1)-1,H===0?o(a,r,Q--,N):H===1?o(g,u,K--,N):H===2&&o(s,h,$--,N)}},scanBipartite:function(c,i,x,f,_,b,T,k,L,A,I,P){var S=0,E=2*c,z=i,D=i+c,j=1,V=1;f?V=1<<28:j=1<<28;for(var Z=_;Z<b;++Z){var Q=Z+j,K=E*Z;l[S++]=T[K+z],l[S++]=-Q,l[S++]=T[K+D],l[S++]=Q}for(Z=L;Z<A;++Z){Q=Z+V;var $=E*Z;l[S++]=I[$+z],l[S++]=-Q}var ne=S>>>1;n(l,ne);var H=0;for(Z=0;Z<ne;++Z){var N=0|l[2*Z+1];if(N<0){var U=!1;if((Q=-N)>=1<<28?(U=!f,Q-=1<<28):(U=!!f,Q-=1),U)p(a,r,H++,Q);else{var te=P[Q],B=E*Q,X=I[B+i+1],J=I[B+i+1+c];e:for(var ee=0;ee<H;++ee){var re=a[ee],se=E*re;if(!(J<T[se+i+1]||T[se+i+1+c]<X)){for(var oe=i+2;oe<c;++oe)if(I[B+oe+c]<T[se+oe]||T[se+oe+c]<I[B+oe])continue e;var de,ce=k[re];if((de=f?x(te,ce):x(ce,te))!==void 0)return de}}}}else o(a,r,H--,N-j)}},scanComplete:function(c,i,x,f,_,b,T,k,L,A,I){for(var P=0,S=2*c,E=i,z=i+c,D=f;D<_;++D){var j=D+268435456,V=S*D;l[P++]=b[V+E],l[P++]=-j,l[P++]=b[V+z],l[P++]=j}for(D=k;D<L;++D){j=D+1;var Z=S*D;l[P++]=A[Z+E],l[P++]=-j}var Q=P>>>1;n(l,Q);var K=0;for(D=0;D<Q;++D){var $=0|l[2*D+1];if($<0)if((j=-$)>=1<<28)a[K++]=j-(1<<28);else{var ne=I[j-=1],H=S*j,N=A[H+i+1],U=A[H+i+1+c];e:for(var te=0;te<K;++te){var B=a[te],X=T[B];if(X===ne)break;var J=S*B;if(!(U<b[J+i+1]||b[J+i+1+c]<N)){for(var ee=i+2;ee<c;++ee)if(A[H+ee+c]<b[J+ee]||b[J+ee+c]<A[H+ee])continue e;var re=x(X,ne);if(re!==void 0)return re}}}else{for(j=$-(1<<28),te=K-1;te>=0;--te)if(a[te]===j){for(ee=te+1;ee<K;++ee)a[ee-1]=a[ee];break}--K}}}};var e=v("typedarray-pool"),t=v("bit-twiddle"),n=v("./sort"),a=e.mallocInt32(1024),r=e.mallocInt32(1024),g=e.mallocInt32(1024),u=e.mallocInt32(1024),s=e.mallocInt32(1024),h=e.mallocInt32(1024),l=e.mallocDouble(8192);function o(c,i,x,f){var _=i[f],b=c[x-1];c[_]=b,i[b]=_}function p(c,i,x,f){c[x]=f,i[f]=x}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(v,w,y){var e=v("./lib/monotone"),t=v("./lib/triangulation"),n=v("./lib/delaunay"),a=v("./lib/filter");function r(s){return[Math.min(s[0],s[1]),Math.max(s[0],s[1])]}function g(s,h){return s[0]-h[0]||s[1]-h[1]}function u(s,h,l){return h in s?s[h]:l}w.exports=function(s,h,l){Array.isArray(h)?(l=l||{},h=h||[]):(l=h||{},h=[]);var o=!!u(l,"delaunay",!0),p=!!u(l,"interior",!0),c=!!u(l,"exterior",!0),i=!!u(l,"infinity",!1);if(!p&&!c||s.length===0)return[];var x=e(s,h);if(o||p!==c||i){for(var f=t(s.length,function(T){return T.map(r).sort(g)}(h)),_=0;_<x.length;++_){var b=x[_];f.addTriangle(b[0],b[1],b[2])}return o&&n(s,f),c?p?i?a(f,0,i):f.cells():a(f,1,i):a(f,-1)}return x}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(v,w,y){var e=v("robust-in-sphere")[4];v("binary-search-bounds");function t(n,a,r,g,u,s){var h=a.opposite(g,u);if(!(h<0)){if(u<g){var l=g;g=u,u=l,l=s,s=h,h=l}a.isConstraint(g,u)||e(n[g],n[u],n[s],n[h])<0&&r.push(g,u)}}w.exports=function(n,a){for(var r=[],g=n.length,u=a.stars,s=0;s<g;++s)for(var h=u[s],l=1;l<h.length;l+=2)if(!((i=h[l])<s)&&!a.isConstraint(s,i)){for(var o=h[l-1],p=-1,c=1;c<h.length;c+=2)if(h[c-1]===i){p=h[c];break}p<0||e(n[s],n[i],n[o],n[p])<0&&r.push(s,i)}for(;r.length>0;){for(var i=r.pop(),x=(s=r.pop(),o=-1,p=-1,h=u[s],1);x<h.length;x+=2){var f=h[x-1],_=h[x];f===i?p=_:_===i&&(o=f)}o<0||p<0||e(n[s],n[i],n[o],n[p])>=0||(a.flip(s,i),t(n,a,r,o,s,p),t(n,a,r,s,p,o),t(n,a,r,p,i,o),t(n,a,r,i,o,p))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(v,w,y){var e,t=v("binary-search-bounds");function n(r,g,u,s,h,l,o){this.cells=r,this.neighbor=g,this.flags=s,this.constraint=u,this.active=h,this.next=l,this.boundary=o}function a(r,g){return r[0]-g[0]||r[1]-g[1]||r[2]-g[2]}w.exports=function(r,g,u){var s=function(L,A){for(var I=L.cells(),P=I.length,S=0;S<P;++S){var E=(H=I[S])[0],z=H[1],D=H[2];z<D?z<E&&(H[0]=z,H[1]=D,H[2]=E):D<E&&(H[0]=D,H[1]=E,H[2]=z)}I.sort(a);var j=new Array(P);for(S=0;S<j.length;++S)j[S]=0;var V=[],Z=[],Q=new Array(3*P),K=new Array(3*P),$=null;A&&($=[]);var ne=new n(I,Q,K,j,V,Z,$);for(S=0;S<P;++S)for(var H=I[S],N=0;N<3;++N){E=H[N],z=H[(N+1)%3];var U=Q[3*S+N]=ne.locate(z,E,L.opposite(z,E)),te=K[3*S+N]=L.isConstraint(E,z);U<0&&(te?Z.push(S):(V.push(S),j[S]=1),A&&$.push([z,E,-1]))}return ne}(r,u);if(g===0)return u?s.cells.concat(s.boundary):s.cells;for(var h=1,l=s.active,o=s.next,p=s.flags,c=s.cells,i=s.constraint,x=s.neighbor;l.length>0||o.length>0;){for(;l.length>0;){var f=l.pop();if(p[f]!==-h){p[f]=h,c[f];for(var _=0;_<3;++_){var b=x[3*f+_];b>=0&&p[b]===0&&(i[3*f+_]?o.push(b):(l.push(b),p[b]=h))}}}var T=o;o=l,l=T,o.length=0,h=-h}var k=function(L,A,I){for(var P=0,S=0;S<L.length;++S)A[S]===I&&(L[P++]=L[S]);return L.length=P,L}(c,p,g);return u?k.concat(s.boundary):k},n.prototype.locate=(e=[0,0,0],function(r,g,u){var s=r,h=g,l=u;return g<u?g<r&&(s=g,h=u,l=r):u<r&&(s=u,h=r,l=g),s<0?-1:(e[0]=s,e[1]=h,e[2]=l,t.eq(this.cells,e,a))})},{"binary-search-bounds":31}],45:[function(v,w,y){var e=v("binary-search-bounds"),t=v("robust-orientation")[3];function n(o,p,c,i,x){this.a=o,this.b=p,this.idx=c,this.lowerIds=i,this.upperIds=x}function a(o,p,c,i){this.a=o,this.b=p,this.type=c,this.idx=i}function r(o,p){var c=o.a[0]-p.a[0]||o.a[1]-p.a[1]||o.type-p.type;return c||(o.type!==0&&(c=t(o.a,o.b,p.b))?c:o.idx-p.idx)}function g(o,p){return t(o.a,o.b,p)}function u(o,p,c,i,x){for(var f=e.lt(p,i,g),_=e.gt(p,i,g),b=f;b<_;++b){for(var T=p[b],k=T.lowerIds,L=k.length;L>1&&t(c[k[L-2]],c[k[L-1]],i)>0;)o.push([k[L-1],k[L-2],x]),L-=1;k.length=L,k.push(x);var A=T.upperIds;for(L=A.length;L>1&&t(c[A[L-2]],c[A[L-1]],i)<0;)o.push([A[L-2],A[L-1],x]),L-=1;A.length=L,A.push(x)}}function s(o,p){var c;return(c=o.a[0]<p.a[0]?t(o.a,o.b,p.a):t(p.b,p.a,o.a))?c:(c=p.b[0]<o.b[0]?t(o.a,o.b,p.b):t(p.b,p.a,o.b))||o.idx-p.idx}function h(o,p,c){var i=e.le(o,c,s),x=o[i],f=x.upperIds,_=f[f.length-1];x.upperIds=[_],o.splice(i+1,0,new n(c.a,c.b,c.idx,[_],f))}function l(o,p,c){var i=c.a;c.a=c.b,c.b=i;var x=e.eq(o,c,s),f=o[x];o[x-1].upperIds=f.upperIds,o.splice(x,1)}w.exports=function(o,p){for(var c=o.length,i=p.length,x=[],f=0;f<c;++f)x.push(new a(o[f],null,0,f));for(f=0;f<i;++f){var _=p[f],b=o[_[0]],T=o[_[1]];b[0]<T[0]?x.push(new a(b,T,2,f),new a(T,b,1,f)):b[0]>T[0]&&x.push(new a(T,b,2,f),new a(b,T,1,f))}x.sort(r);for(var k=x[0].a[0]-(1+Math.abs(x[0].a[0]))*Math.pow(2,-52),L=[new n([k,1],[k,0],-1,[],[])],A=[],I=(f=0,x.length);f<I;++f){var P=x[f],S=P.type;S===0?u(A,L,o,P.a,P.idx):S===2?h(L,o,P):l(L,o,P)}return A}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(v,w,y){var e=v("binary-search-bounds");function t(r,g){this.stars=r,this.edges=g}w.exports=function(r,g){for(var u=new Array(r),s=0;s<r;++s)u[s]=[];return new t(u,g)};var n=t.prototype;function a(r,g,u){for(var s=1,h=r.length;s<h;s+=2)if(r[s-1]===g&&r[s]===u)return r[s-1]=r[h-2],r[s]=r[h-1],void(r.length=h-2)}n.isConstraint=function(){var r=[0,0];function g(u,s){return u[0]-s[0]||u[1]-s[1]}return function(u,s){return r[0]=Math.min(u,s),r[1]=Math.max(u,s),e.eq(this.edges,r,g)>=0}}(),n.removeTriangle=function(r,g,u){var s=this.stars;a(s[r],g,u),a(s[g],u,r),a(s[u],r,g)},n.addTriangle=function(r,g,u){var s=this.stars;s[r].push(g,u),s[g].push(u,r),s[u].push(r,g)},n.opposite=function(r,g){for(var u=this.stars[g],s=1,h=u.length;s<h;s+=2)if(u[s]===r)return u[s-1];return-1},n.flip=function(r,g){var u=this.opposite(r,g),s=this.opposite(g,r);this.removeTriangle(r,g,u),this.removeTriangle(g,r,s),this.addTriangle(r,s,u),this.addTriangle(g,u,s)},n.edges=function(){for(var r=this.stars,g=[],u=0,s=r.length;u<s;++u)for(var h=r[u],l=0,o=h.length;l<o;l+=2)g.push([h[l],h[l+1]]);return g},n.cells=function(){for(var r=this.stars,g=[],u=0,s=r.length;u<s;++u)for(var h=r[u],l=0,o=h.length;l<o;l+=2){var p=h[l],c=h[l+1];u<Math.min(p,c)&&g.push([u,p,c])}return g}},{"binary-search-bounds":31}],47:[function(v,w,y){w.exports=function(e){for(var t=1,n=1;n<e.length;++n)for(var a=0;a<n;++a)if(e[n]<e[a])t=-t;else if(e[a]===e[n])return 0;return t}},{}],48:[function(v,w,y){var e=v("dup"),t=v("robust-linear-solve");function n(g,u){for(var s=0,h=g.length,l=0;l<h;++l)s+=g[l]*u[l];return s}function a(g){var u=g.length;if(u===0)return[];g[0].length;var s=e([g.length+1,g.length+1],1),h=e([g.length+1],1);s[u][u]=0;for(var l=0;l<u;++l){for(var o=0;o<=l;++o)s[o][l]=s[l][o]=2*n(g[l],g[o]);h[l]=n(g[l],g[l])}var p=t(s,h),c=0,i=p[u+1];for(l=0;l<i.length;++l)c+=i[l];var x=new Array(u);for(l=0;l<u;++l){i=p[l];var f=0;for(o=0;o<i.length;++o)f+=i[o];x[l]=f/c}return x}function r(g){if(g.length===0)return[];for(var u=g[0].length,s=e([u]),h=a(g),l=0;l<g.length;++l)for(var o=0;o<u;++o)s[o]+=g[l][o]*h[l];return s}r.barycenetric=a,w.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(v,w,y){w.exports=function(t){for(var n=e(t),a=0,r=0;r<t.length;++r)for(var g=t[r],u=0;u<n.length;++u)a+=Math.pow(g[u]-n[u],2);return Math.sqrt(a/t.length)};var e=v("circumcenter")},{circumcenter:48}],50:[function(v,w,y){w.exports=function(_,b,T){var k;if(T){k=b;for(var L=new Array(b.length),A=0;A<b.length;++A){var I=b[A];L[A]=[I[0],I[1],T[A]]}b=L}for(var P=function(S,E,z){var D=p(S,[],o(S));return x(E,D,z),!!D}(_,b,!!T);f(_,b,!!T);)P=!0;if(T&&P)for(k.length=0,T.length=0,A=0;A<b.length;++A)I=b[A],k.push([I[0],I[1]]),T.push(I[2]);return P};var e=v("union-find"),t=v("box-intersect"),n=v("robust-segment-intersect"),a=v("big-rat"),r=v("big-rat/cmp"),g=v("big-rat/to-float"),u=v("rat-vec"),s=v("nextafter"),h=v("./lib/rat-seg-intersect");function l(_){var b=g(_);return[s(b,-1/0),s(b,1/0)]}function o(_){for(var b=new Array(_.length),T=0;T<_.length;++T){var k=_[T];b[T]=[s(k[0],-1/0),s(k[1],-1/0),s(k[0],1/0),s(k[1],1/0)]}return b}function p(_,b,T){for(var k=b.length,L=new e(k),A=[],I=0;I<b.length;++I){var P=b[I],S=l(P[0]),E=l(P[1]);A.push([s(S[0],-1/0),s(E[0],-1/0),s(S[1],1/0),s(E[1],1/0)])}t(A,function(Z,Q){L.link(Z,Q)});var z=!0,D=new Array(k);for(I=0;I<k;++I)(V=L.find(I))!==I&&(z=!1,_[V]=[Math.min(_[I][0],_[V][0]),Math.min(_[I][1],_[V][1])]);if(z)return null;var j=0;for(I=0;I<k;++I){var V;(V=L.find(I))===I?(D[I]=j,_[j++]=_[I]):D[I]=-1}for(_.length=j,I=0;I<k;++I)D[I]<0&&(D[I]=D[L.find(I)]);return D}function c(_,b){return _[0]-b[0]||_[1]-b[1]}function i(_,b){var T=_[0]-b[0]||_[1]-b[1];return T||(_[2]<b[2]?-1:_[2]>b[2]?1:0)}function x(_,b,T){if(_.length!==0){if(b)for(var k=0;k<_.length;++k){var L=b[(I=_[k])[0]],A=b[I[1]];I[0]=Math.min(L,A),I[1]=Math.max(L,A)}else for(k=0;k<_.length;++k){var I;L=(I=_[k])[0],A=I[1],I[0]=Math.min(L,A),I[1]=Math.max(L,A)}T?_.sort(i):_.sort(c);var P=1;for(k=1;k<_.length;++k){var S=_[k-1],E=_[k];(E[0]!==S[0]||E[1]!==S[1]||T&&E[2]!==S[2])&&(_[P++]=E)}_.length=P}}function f(_,b,T){var k=function(S,E){for(var z=new Array(E.length),D=0;D<E.length;++D){var j=E[D],V=S[j[0]],Z=S[j[1]];z[D]=[s(Math.min(V[0],Z[0]),-1/0),s(Math.min(V[1],Z[1]),-1/0),s(Math.max(V[0],Z[0]),1/0),s(Math.max(V[1],Z[1]),1/0)]}return z}(_,b),L=function(S,E,z){var D=[];return t(z,function(j,V){var Z=E[j],Q=E[V];if(Z[0]!==Q[0]&&Z[0]!==Q[1]&&Z[1]!==Q[0]&&Z[1]!==Q[1]){var K=S[Z[0]],$=S[Z[1]],ne=S[Q[0]],H=S[Q[1]];n(K,$,ne,H)&&D.push([j,V])}}),D}(_,b,k),A=o(_),I=function(S,E,z,D){var j=[];return t(z,D,function(V,Z){var Q=E[V];if(Q[0]!==Z&&Q[1]!==Z){var K=S[Z],$=S[Q[0]],ne=S[Q[1]];n($,ne,K,K)&&j.push([V,Z])}}),j}(_,b,k,A),P=p(_,function(S,E,z,D,j){var V,Z,Q=S.map(function(ve){return[a(ve[0]),a(ve[1])]});for(V=0;V<z.length;++V){var K=z[V];Z=K[0];var $=K[1],ne=E[Z],H=E[$],N=h(u(S[ne[0]]),u(S[ne[1]]),u(S[H[0]]),u(S[H[1]]));if(N){var U=S.length;S.push([g(N[0]),g(N[1])]),Q.push(N),D.push([Z,U],[$,U])}}for(D.sort(function(ve,Ae){if(ve[0]!==Ae[0])return ve[0]-Ae[0];var fe=Q[ve[1]],me=Q[Ae[1]];return r(fe[0],me[0])||r(fe[1],me[1])}),V=D.length-1;V>=0;--V){var te=E[Z=(de=D[V])[0]],B=te[0],X=te[1],J=S[B],ee=S[X];if((J[0]-ee[0]||J[1]-ee[1])<0){var re=B;B=X,X=re}te[0]=B;var se,oe=te[1]=de[1];for(j&&(se=te[2]);V>0&&D[V-1][0]===Z;){var de,ce=(de=D[--V])[1];j?E.push([oe,ce,se]):E.push([oe,ce]),oe=ce}j?E.push([oe,X,se]):E.push([oe,X])}return Q}(_,b,L,I,T));return x(b,P,T),!!P||L.length>0||I.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(v,w,y){w.exports=function(h,l,o,p){var c=r(l,h),i=r(p,o),x=s(c,i);if(a(x)===0)return null;var f=r(h,o),_=s(i,f),b=t(_,x),T=u(c,b);return g(h,T)};var e=v("big-rat/mul"),t=v("big-rat/div"),n=v("big-rat/sub"),a=v("big-rat/sign"),r=v("rat-vec/sub"),g=v("rat-vec/add"),u=v("rat-vec/muls");function s(h,l){return n(e(h[0],l[1]),e(h[1],l[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(v,w,y){w.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(v,w,y){var e=v("./colorScale"),t=v("lerp");function n(g){return[g[0]/255,g[1]/255,g[2]/255,g[3]]}function a(g){for(var u,s="#",h=0;h<3;++h)s+=("00"+(u=(u=g[h]).toString(16))).substr(u.length);return s}function r(g){return"rgba("+g.join(",")+")"}w.exports=function(g){var u,s,h,l,o,p,c,i,x,f;if(g||(g={}),i=(g.nshades||72)-1,c=g.format||"hex",(p=g.colormap)||(p="jet"),typeof p=="string"){if(p=p.toLowerCase(),!e[p])throw Error(p+" not a supported colorscale");o=e[p]}else{if(!Array.isArray(p))throw Error("unsupported colormap option",p);o=p.slice()}if(o.length>i+1)throw new Error(p+" map requires nshades to be at least size "+o.length);x=Array.isArray(g.alpha)?g.alpha.length!==2?[1,1]:g.alpha.slice():typeof g.alpha=="number"?[g.alpha,g.alpha]:[1,1],u=o.map(function(L){return Math.round(L.index*i)}),x[0]=Math.min(Math.max(x[0],0),1),x[1]=Math.min(Math.max(x[1],0),1);var _=o.map(function(L,A){var I=o[A].index,P=o[A].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=x[0]+(x[1]-x[0])*I),P}),b=[];for(f=0;f<u.length-1;++f){l=u[f+1]-u[f],s=_[f],h=_[f+1];for(var T=0;T<l;T++){var k=T/l;b.push([Math.round(t(s[0],h[0],k)),Math.round(t(s[1],h[1],k)),Math.round(t(s[2],h[2],k)),t(s[3],h[3],k)])}}return b.push(o[o.length-1].rgb.concat(x[1])),c==="hex"?b=b.map(a):c==="rgbaString"?b=b.map(r):c==="float"&&(b=b.map(n)),b}},{"./colorScale":52,lerp:240}],54:[function(v,w,y){w.exports=function(u,s,h,l){var o=e(s,h,l);if(o===0){var p=t(e(u,s,h)),c=t(e(u,s,l));if(p===c){if(p===0){var i=g(u,s,h),x=g(u,s,l);return i===x?0:i?1:-1}return 0}return c===0?p>0||g(u,s,l)?-1:1:p===0?c>0||g(u,s,h)?1:-1:t(c-p)}var f=e(u,s,h);return f>0?o>0&&e(u,s,l)>0?1:-1:f<0?o>0||e(u,s,l)>0?1:-1:e(u,s,l)>0||g(u,s,h)?1:-1};var e=v("robust-orientation"),t=v("signum"),n=v("two-sum"),a=v("robust-product"),r=v("robust-sum");function g(u,s,h){var l=n(u[0],-s[0]),o=n(u[1],-s[1]),p=n(h[0],-s[0]),c=n(h[1],-s[1]),i=r(a(l,p),a(o,c));return i[i.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(v,w,y){w.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(v,w,y){w.exports=function(n,a){var r=n.length,g=n.length-a.length;if(g)return g;switch(r){case 0:return 0;case 1:return n[0]-a[0];case 2:return n[0]+n[1]-a[0]-a[1]||e(n[0],n[1])-e(a[0],a[1]);case 3:var u=n[0]+n[1],s=a[0]+a[1];if(g=u+n[2]-(s+a[2]))return g;var h=e(n[0],n[1]),l=e(a[0],a[1]);return e(h,n[2])-e(l,a[2])||e(h+n[2],u)-e(l+a[2],s);case 4:var o=n[0],p=n[1],c=n[2],i=n[3],x=a[0],f=a[1],_=a[2],b=a[3];return o+p+c+i-(x+f+_+b)||e(o,p,c,i)-e(x,f,_,b,x)||e(o+p,o+c,o+i,p+c,p+i,c+i)-e(x+f,x+_,x+b,f+_,f+b,_+b)||e(o+p+c,o+p+i,o+c+i,p+c+i)-e(x+f+_,x+f+b,x+_+b,f+_+b);default:for(var T=n.slice().sort(t),k=a.slice().sort(t),L=0;L<r;++L)if(g=T[L]-k[L])return g;return 0}};var e=Math.min;function t(n,a){return n-a}},{}],57:[function(v,w,y){var e=v("compare-cell"),t=v("cell-orientation");w.exports=function(n,a){return e(n,a)||t(n)-t(a)}},{"cell-orientation":47,"compare-cell":56}],58:[function(v,w,y){var e=v("./lib/ch1d"),t=v("./lib/ch2d"),n=v("./lib/chnd");w.exports=function(a){var r=a.length;if(r===0)return[];if(r===1)return[[0]];var g=a[0].length;return g===0?[]:g===1?e(a):g===2?t(a):n(a,g)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(v,w,y){w.exports=function(e){for(var t=0,n=0,a=1;a<e.length;++a)e[a][0]<e[t][0]&&(t=a),e[a][0]>e[n][0]&&(n=a);return t<n?[[t],[n]]:t>n?[[n],[t]]:[[t]]}},{}],60:[function(v,w,y){w.exports=function(t){var n=e(t),a=n.length;if(a<=2)return[];for(var r=new Array(a),g=n[a-1],u=0;u<a;++u){var s=n[u];r[u]=[g,s],g=s}return r};var e=v("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(v,w,y){w.exports=function(n,a){try{return e(n,!0)}catch{var r=t(n);if(r.length<=a)return[];var g=function(s,h){for(var l=s.length,o=new Array(l),p=0;p<h.length;++p)o[p]=s[h[p]];var c=h.length;for(p=0;p<l;++p)h.indexOf(p)<0&&(o[c++]=s[p]);return o}(n,r);return function(s,h){for(var l=s.length,o=h.length,p=0;p<l;++p)for(var c=s[p],i=0;i<c.length;++i){var x=c[i];if(x<o)c[i]=h[x];else{x-=o;for(var f=0;f<o;++f)x>=h[f]&&(x+=1);c[i]=x}}return s}(e(g,!0),r)}};var e=v("incremental-convex-hull"),t=v("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(v,w,y){w.exports=function(e,t,n,a,r,g){var u=r-1,s=r*r,h=u*u,l=(1+2*r)*h,o=r*h,p=s*(3-2*r),c=s*u;if(e.length){g||(g=new Array(e.length));for(var i=e.length-1;i>=0;--i)g[i]=l*e[i]+o*t[i]+p*n[i]+c*a[i];return g}return l*e+o*t+p*n+c*a},w.exports.derivative=function(e,t,n,a,r,g){var u=6*r*r-6*r,s=3*r*r-4*r+1,h=-6*r*r+6*r,l=3*r*r-2*r;if(e.length){g||(g=new Array(e.length));for(var o=e.length-1;o>=0;--o)g[o]=u*e[o]+s*t[o]+h*n[o]+l*a[o];return g}return u*e+s*t+h*n[o]+l*a}},{}],63:[function(v,w,y){var e=v("incremental-convex-hull"),t=v("uniq");function n(r,g){this.point=r,this.index=g}function a(r,g){for(var u=r.point,s=g.point,h=u.length,l=0;l<h;++l){var o=s[l]-u[l];if(o)return o}return 0}w.exports=function(r,g){var u=r.length;if(u===0)return[];var s=r[0].length;if(s<1)return[];if(s===1)return function(I,P,S){if(I===1)return S?[[-1,0]]:[];var E=P.map(function(Z,Q){return[Z[0],Q]});E.sort(function(Z,Q){return Z[0]-Q[0]});for(var z=new Array(I-1),D=1;D<I;++D){var j=E[D-1],V=E[D];z[D-1]=[j[1],V[1]]}return S&&z.push([-1,z[0][1]],[z[I-1][1],-1]),z}(u,r,g);for(var h=new Array(u),l=1,o=0;o<u;++o){for(var p=r[o],c=new Array(s+1),i=0,x=0;x<s;++x){var f=p[x];c[x]=f,i+=f*f}c[s]=i,h[o]=new n(c,o),l=Math.max(i,l)}t(h,a),u=h.length;var _=new Array(u+s+1),b=new Array(u+s+1),T=(s+1)*(s+1)*l,k=new Array(s+1);for(o=0;o<=s;++o)k[o]=0;for(k[s]=T,_[0]=k.slice(),b[0]=-1,o=0;o<=s;++o)(c=k.slice())[o]=1,_[o+1]=c,b[o+1]=-1;for(o=0;o<u;++o){var L=h[o];_[o+s+1]=L.point,b[o+s+1]=L.index}var A=e(_,!1);if(A=g?A.filter(function(I){for(var P=0,S=0;S<=s;++S){var E=b[I[S]];if(E<0&&++P>=2)return!1;I[S]=E}return!0}):A.filter(function(I){for(var P=0;P<=s;++P){var S=b[I[P]];if(S<0)return!1;I[P]=S}return!0}),1&s)for(o=0;o<A.length;++o)c=(L=A[o])[0],L[0]=L[1],L[1]=c;return A}},{"incremental-convex-hull":233,uniq:310}],64:[function(v,w,y){(function(e){(function(){var t=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),a=new Uint32Array(n.buffer);n[0]=1,t=!0,a[1]===1072693248?(w.exports=function(g){return n[0]=g,[a[0],a[1]]},w.exports.pack=function(g,u){return a[0]=g,a[1]=u,n[0]},w.exports.lo=function(g){return n[0]=g,a[0]},w.exports.hi=function(g){return n[0]=g,a[1]}):a[0]===1072693248?(w.exports=function(g){return n[0]=g,[a[1],a[0]]},w.exports.pack=function(g,u){return a[1]=g,a[0]=u,n[0]},w.exports.lo=function(g){return n[0]=g,a[1]},w.exports.hi=function(g){return n[0]=g,a[0]}):t=!1}if(!t){var r=new e(8);w.exports=function(g){return r.writeDoubleLE(g,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},w.exports.pack=function(g,u){return r.writeUInt32LE(g,0,!0),r.writeUInt32LE(u,4,!0),r.readDoubleLE(0,!0)},w.exports.lo=function(g){return r.writeDoubleLE(g,0,!0),r.readUInt32LE(0,!0)},w.exports.hi=function(g){return r.writeDoubleLE(g,0,!0),r.readUInt32LE(4,!0)}}w.exports.sign=function(g){return w.exports.hi(g)>>>31},w.exports.exponent=function(g){return(w.exports.hi(g)<<1>>>21)-1023},w.exports.fraction=function(g){var u=w.exports.lo(g),s=w.exports.hi(g),h=1048575&s;return 2146435072&s&&(h+=1<<20),[u,h]},w.exports.denormalized=function(g){return!(2146435072&w.exports.hi(g))}}).call(this)}).call(this,v("buffer").Buffer)},{buffer:3}],65:[function(v,w,y){w.exports=function(e,t){switch(t===void 0&&(t=0),typeof e){case"number":if(e>0)return function(n,a){var r,g;for(r=new Array(n),g=0;g<n;++g)r[g]=a;return r}(0|e,t);break;case"object":if(typeof e.length=="number")return function n(a,r,g){var u=0|a[g];if(u<=0)return[];var s,h=new Array(u);if(g===a.length-1)for(s=0;s<u;++s)h[s]=r;else for(s=0;s<u;++s)h[s]=n(a,r,g+1);return h}(e,t,0)}return[]}},{}],66:[function(v,w,y){w.exports=function(t,n){var a=t.length;if(typeof n!="number"){n=0;for(var r=0;r<a;++r){var g=t[r];n=Math.max(n,g[0],g[1])}n=1+(0|n)}n|=0;var u=new Array(n);for(r=0;r<n;++r)u[r]=[];for(r=0;r<a;++r)g=t[r],u[g[0]].push(g[1]),u[g[1]].push(g[0]);for(var s=0;s<n;++s)e(u[s],function(h,l){return h-l});return u};var e=v("uniq")},{uniq:310}],67:[function(v,w,y){w.exports=function(e,t,n){var a=t||0,r=n||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[a*e[12]+e[8],a*e[13]+e[9],a*e[14]+e[10],a*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],68:[function(v,w,y){w.exports=function(u,s,h){switch(arguments.length){case 0:return new a([0],[0],0);case 1:return typeof u=="number"?new a(l=g(u),l,0):new a(u,g(u.length),0);case 2:if(typeof s=="number"){var l=g(u.length);return new a(u,l,+s)}h=0;case 3:if(u.length!==s.length)throw new Error("state and velocity lengths must match");return new a(u,s,h)}};var e=v("cubic-hermite"),t=v("binary-search-bounds");function n(u,s,h){return Math.min(s,Math.max(u,h))}function a(u,s,h){this.dimension=u.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var l=0;l<this.dimension;++l)this.bounds[0][l]=-1/0,this.bounds[1][l]=1/0;this._state=u.slice().reverse(),this._velocity=s.slice().reverse(),this._time=[h],this._scratch=[u.slice(),u.slice(),u.slice(),u.slice(),u.slice()]}var r=a.prototype;function g(u){for(var s=new Array(u),h=0;h<u;++h)s[h]=0;return s}r.flush=function(u){var s=t.gt(this._time,u)-1;s<=0||(this._time.splice(0,s),this._state.splice(0,s*this.dimension),this._velocity.splice(0,s*this.dimension))},r.curve=function(u){var s=this._time,h=s.length,l=t.le(s,u),o=this._scratch[0],p=this._state,c=this._velocity,i=this.dimension,x=this.bounds;if(l<0)for(var f=i-1,_=0;_<i;++_,--f)o[_]=p[f];else if(l>=h-1){f=p.length-1;var b=u-s[h-1];for(_=0;_<i;++_,--f)o[_]=p[f]+b*c[f]}else{f=i*(l+1)-1;var T=s[l],k=s[l+1]-T||1,L=this._scratch[1],A=this._scratch[2],I=this._scratch[3],P=this._scratch[4],S=!0;for(_=0;_<i;++_,--f)L[_]=p[f],I[_]=c[f]*k,A[_]=p[f+i],P[_]=c[f+i]*k,S=S&&L[_]===A[_]&&I[_]===P[_]&&I[_]===0;if(S)for(_=0;_<i;++_)o[_]=L[_];else e(L,I,A,P,(u-T)/k,o)}var E=x[0],z=x[1];for(_=0;_<i;++_)o[_]=n(E[_],z[_],o[_]);return o},r.dcurve=function(u){var s=this._time,h=s.length,l=t.le(s,u),o=this._scratch[0],p=this._state,c=this._velocity,i=this.dimension;if(l>=h-1)for(var x=p.length-1,f=(s[h-1],0);f<i;++f,--x)o[f]=c[x];else{x=i*(l+1)-1;var _=s[l],b=s[l+1]-_||1,T=this._scratch[1],k=this._scratch[2],L=this._scratch[3],A=this._scratch[4],I=!0;for(f=0;f<i;++f,--x)T[f]=p[x],L[f]=c[x]*b,k[f]=p[x+i],A[f]=c[x+i]*b,I=I&&T[f]===k[f]&&L[f]===A[f]&&L[f]===0;if(I)for(f=0;f<i;++f)o[f]=0;else for(e.derivative(T,L,k,A,(u-_)/b,o),f=0;f<i;++f)o[f]/=b}return o},r.lastT=function(){var u=this._time;return u[u.length-1]},r.stable=function(){for(var u=this._velocity,s=u.length,h=this.dimension-1;h>=0;--h)if(u[--s])return!1;return!0},r.jump=function(u){var s=this.lastT(),h=this.dimension;if(!(u<s||arguments.length!==h+1)){var l=this._state,o=this._velocity,p=l.length-this.dimension,c=this.bounds,i=c[0],x=c[1];this._time.push(s,u);for(var f=0;f<2;++f)for(var _=0;_<h;++_)l.push(l[p++]),o.push(0);for(this._time.push(u),_=h;_>0;--_)l.push(n(i[_-1],x[_-1],arguments[_])),o.push(0)}},r.push=function(u){var s=this.lastT(),h=this.dimension;if(!(u<s||arguments.length!==h+1)){var l=this._state,o=this._velocity,p=l.length-this.dimension,c=u-s,i=this.bounds,x=i[0],f=i[1],_=c>1e-6?1/c:0;this._time.push(u);for(var b=h;b>0;--b){var T=n(x[b-1],f[b-1],arguments[b]);l.push(T),o.push((T-l[p++])*_)}}},r.set=function(u){var s=this.dimension;if(!(u<this.lastT()||arguments.length!==s+1)){var h=this._state,l=this._velocity,o=this.bounds,p=o[0],c=o[1];this._time.push(u);for(var i=s;i>0;--i)h.push(n(p[i-1],c[i-1],arguments[i])),l.push(0)}},r.move=function(u){var s=this.lastT(),h=this.dimension;if(!(u<=s||arguments.length!==h+1)){var l=this._state,o=this._velocity,p=l.length-this.dimension,c=this.bounds,i=c[0],x=c[1],f=u-s,_=f>1e-6?1/f:0;this._time.push(u);for(var b=h;b>0;--b){var T=arguments[b];l.push(n(i[b-1],x[b-1],l[p++]+T)),o.push(T*_)}}},r.idle=function(u){var s=this.lastT();if(!(u<s)){var h=this.dimension,l=this._state,o=this._velocity,p=l.length-h,c=this.bounds,i=c[0],x=c[1],f=u-s;this._time.push(u);for(var _=h-1;_>=0;--_)l.push(n(i[_],x[_],l[p]+f*o[p])),o.push(0),p+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(v,w,y){w.exports=function(i){return new r(i||c,null)};function e(i,x,f,_,b,T){this._color=i,this.key=x,this.value=f,this.left=_,this.right=b,this._count=T}function t(i){return new e(i._color,i.key,i.value,i.left,i.right,i._count)}function n(i,x){return new e(i,x.key,x.value,x.left,x.right,x._count)}function a(i){i._count=1+(i.left?i.left._count:0)+(i.right?i.right._count:0)}function r(i,x){this._compare=i,this.root=x}var g=r.prototype;function u(i,x){var f;return x.left&&(f=u(i,x.left))?f:(f=i(x.key,x.value))||(x.right?u(i,x.right):void 0)}function s(i,x,f,_){if(x(i,_.key)<=0){var b;if(_.left&&(b=s(i,x,f,_.left))||(b=f(_.key,_.value)))return b}if(_.right)return s(i,x,f,_.right)}function h(i,x,f,_,b){var T,k=f(i,b.key),L=f(x,b.key);if(k<=0&&(b.left&&(T=h(i,x,f,_,b.left))||L>0&&(T=_(b.key,b.value))))return T;if(L>0&&b.right)return h(i,x,f,_,b.right)}function l(i,x){this.tree=i,this._stack=x}Object.defineProperty(g,"keys",{get:function(){var i=[];return this.forEach(function(x,f){i.push(x)}),i}}),Object.defineProperty(g,"values",{get:function(){var i=[];return this.forEach(function(x,f){i.push(f)}),i}}),Object.defineProperty(g,"length",{get:function(){return this.root?this.root._count:0}}),g.insert=function(i,x){for(var f=this._compare,_=this.root,b=[],T=[];_;){var k=f(i,_.key);b.push(_),T.push(k),_=k<=0?_.left:_.right}b.push(new e(0,i,x,null,null,1));for(var L=b.length-2;L>=0;--L)_=b[L],T[L]<=0?b[L]=new e(_._color,_.key,_.value,b[L+1],_.right,_._count+1):b[L]=new e(_._color,_.key,_.value,_.left,b[L+1],_._count+1);for(L=b.length-1;L>1;--L){var A=b[L-1];if(_=b[L],A._color===1||_._color===1)break;var I=b[L-2];if(I.left===A)if(A.left===_){if(!(P=I.right)||P._color!==0){I._color=0,I.left=A.right,A._color=1,A.right=I,b[L-2]=A,b[L-1]=_,a(I),a(A),L>=3&&((S=b[L-3]).left===I?S.left=A:S.right=A);break}A._color=1,I.right=n(1,P),I._color=0,L-=1}else{if(!(P=I.right)||P._color!==0){A.right=_.left,I._color=0,I.left=_.right,_._color=1,_.left=A,_.right=I,b[L-2]=_,b[L-1]=A,a(I),a(A),a(_),L>=3&&((S=b[L-3]).left===I?S.left=_:S.right=_);break}A._color=1,I.right=n(1,P),I._color=0,L-=1}else if(A.right===_){if(!(P=I.left)||P._color!==0){I._color=0,I.right=A.left,A._color=1,A.left=I,b[L-2]=A,b[L-1]=_,a(I),a(A),L>=3&&((S=b[L-3]).right===I?S.right=A:S.left=A);break}A._color=1,I.left=n(1,P),I._color=0,L-=1}else{var P;if(!(P=I.left)||P._color!==0){var S;A.left=_.right,I._color=0,I.right=_.left,_._color=1,_.right=A,_.left=I,b[L-2]=_,b[L-1]=A,a(I),a(A),a(_),L>=3&&((S=b[L-3]).right===I?S.right=_:S.left=_);break}A._color=1,I.left=n(1,P),I._color=0,L-=1}}return b[0]._color=1,new r(f,b[0])},g.forEach=function(i,x,f){if(this.root)switch(arguments.length){case 1:return u(i,this.root);case 2:return s(x,this._compare,i,this.root);case 3:return this._compare(x,f)>=0?void 0:h(x,f,this._compare,i,this.root)}},Object.defineProperty(g,"begin",{get:function(){for(var i=[],x=this.root;x;)i.push(x),x=x.left;return new l(this,i)}}),Object.defineProperty(g,"end",{get:function(){for(var i=[],x=this.root;x;)i.push(x),x=x.right;return new l(this,i)}}),g.at=function(i){if(i<0)return new l(this,[]);for(var x=this.root,f=[];;){if(f.push(x),x.left){if(i<x.left._count){x=x.left;continue}i-=x.left._count}if(!i)return new l(this,f);if(i-=1,!x.right||i>=x.right._count)break;x=x.right}return new l(this,[])},g.ge=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T<=0&&(b=_.length),f=T<=0?f.left:f.right}return _.length=b,new l(this,_)},g.gt=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T<0&&(b=_.length),f=T<0?f.left:f.right}return _.length=b,new l(this,_)},g.lt=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T>0&&(b=_.length),f=T<=0?f.left:f.right}return _.length=b,new l(this,_)},g.le=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T>=0&&(b=_.length),f=T<0?f.left:f.right}return _.length=b,new l(this,_)},g.find=function(i){for(var x=this._compare,f=this.root,_=[];f;){var b=x(i,f.key);if(_.push(f),b===0)return new l(this,_);f=b<=0?f.left:f.right}return new l(this,[])},g.remove=function(i){var x=this.find(i);return x?x.remove():this},g.get=function(i){for(var x=this._compare,f=this.root;f;){var _=x(i,f.key);if(_===0)return f.value;f=_<=0?f.left:f.right}};var o=l.prototype;function p(i,x){i.key=x.key,i.value=x.value,i.left=x.left,i.right=x.right,i._color=x._color,i._count=x._count}function c(i,x){return i<x?-1:i>x?1:0}Object.defineProperty(o,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(o,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),o.clone=function(){return new l(this.tree,this._stack.slice())},o.remove=function(){var i=this._stack;if(i.length===0)return this.tree;var x=new Array(i.length),f=i[i.length-1];x[x.length-1]=new e(f._color,f.key,f.value,f.left,f.right,f._count);for(var _=i.length-2;_>=0;--_)(f=i[_]).left===i[_+1]?x[_]=new e(f._color,f.key,f.value,x[_+1],f.right,f._count):x[_]=new e(f._color,f.key,f.value,f.left,x[_+1],f._count);if((f=x[x.length-1]).left&&f.right){var b=x.length;for(f=f.left;f.right;)x.push(f),f=f.right;var T=x[b-1];for(x.push(new e(f._color,T.key,T.value,f.left,f.right,f._count)),x[b-1].key=f.key,x[b-1].value=f.value,_=x.length-2;_>=b;--_)f=x[_],x[_]=new e(f._color,f.key,f.value,f.left,x[_+1],f._count);x[b-1].left=x[b]}if((f=x[x.length-1])._color===0){var k=x[x.length-2];for(k.left===f?k.left=null:k.right===f&&(k.right=null),x.pop(),_=0;_<x.length;++_)x[_]._count--;return new r(this.tree._compare,x[0])}if(f.left||f.right){for(f.left?p(f,f.left):f.right&&p(f,f.right),f._color=1,_=0;_<x.length-1;++_)x[_]._count--;return new r(this.tree._compare,x[0])}if(x.length===1)return new r(this.tree._compare,null);for(_=0;_<x.length;++_)x[_]._count--;var L=x[x.length-2];return function(A){for(var I,P,S,E,z=A.length-1;z>=0;--z){if(I=A[z],z===0)return void(I._color=1);if((P=A[z-1]).left===I){if((S=P.right).right&&S.right._color===0)return E=(S=P.right=t(S)).right=t(S.right),P.right=S.left,S.left=P,S.right=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),z>1&&((D=A[z-2]).left===P?D.left=S:D.right=S),void(A[z-1]=S);if(S.left&&S.left._color===0)return E=(S=P.right=t(S)).left=t(S.left),P.right=E.left,S.left=E.right,E.left=P,E.right=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),z>1&&((D=A[z-2]).left===P?D.left=E:D.right=E),void(A[z-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.right=n(0,S));P.right=n(0,S);continue}S=t(S),P.right=S.left,S.left=P,S._color=P._color,P._color=0,a(P),a(S),z>1&&((D=A[z-2]).left===P?D.left=S:D.right=S),A[z-1]=S,A[z]=P,z+1<A.length?A[z+1]=I:A.push(I),z+=2}else{if((S=P.left).left&&S.left._color===0)return E=(S=P.left=t(S)).left=t(S.left),P.left=S.right,S.right=P,S.left=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),z>1&&((D=A[z-2]).right===P?D.right=S:D.left=S),void(A[z-1]=S);if(S.right&&S.right._color===0)return E=(S=P.left=t(S)).right=t(S.right),P.left=E.right,S.right=E.left,E.right=P,E.left=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),z>1&&((D=A[z-2]).right===P?D.right=E:D.left=E),void(A[z-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.left=n(0,S));P.left=n(0,S);continue}var D;S=t(S),P.left=S.right,S.right=P,S._color=P._color,P._color=0,a(P),a(S),z>1&&((D=A[z-2]).right===P?D.right=S:D.left=S),A[z-1]=S,A[z]=P,z+1<A.length?A[z+1]=I:A.push(I),z+=2}}}(x),L.left===f?L.left=null:L.right=null,new r(this.tree._compare,x[0])},Object.defineProperty(o,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(o,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(o,"index",{get:function(){var i=0,x=this._stack;if(x.length===0){var f=this.tree.root;return f?f._count:0}x[x.length-1].left&&(i=x[x.length-1].left._count);for(var _=x.length-2;_>=0;--_)x[_+1]===x[_].right&&(++i,x[_].left&&(i+=x[_].left._count));return i},enumerable:!0}),o.next=function(){var i=this._stack;if(i.length!==0){var x=i[i.length-1];if(x.right)for(x=x.right;x;)i.push(x),x=x.left;else for(i.pop();i.length>0&&i[i.length-1].right===x;)x=i[i.length-1],i.pop()}},Object.defineProperty(o,"hasNext",{get:function(){var i=this._stack;if(i.length===0)return!1;if(i[i.length-1].right)return!0;for(var x=i.length-1;x>0;--x)if(i[x-1].left===i[x])return!0;return!1}}),o.update=function(i){var x=this._stack;if(x.length===0)throw new Error("Can't update empty node!");var f=new Array(x.length),_=x[x.length-1];f[f.length-1]=new e(_._color,_.key,i,_.left,_.right,_._count);for(var b=x.length-2;b>=0;--b)(_=x[b]).left===x[b+1]?f[b]=new e(_._color,_.key,_.value,f[b+1],_.right,_._count):f[b]=new e(_._color,_.key,_.value,_.left,f[b+1],_._count);return new r(this.tree._compare,f[0])},o.prev=function(){var i=this._stack;if(i.length!==0){var x=i[i.length-1];if(x.left)for(x=x.left;x;)i.push(x),x=x.right;else for(i.pop();i.length>0&&i[i.length-1].left===x;)x=i[i.length-1],i.pop()}},Object.defineProperty(o,"hasPrev",{get:function(){var i=this._stack;if(i.length===0)return!1;if(i[i.length-1].left)return!0;for(var x=i.length-1;x>0;--x)if(i[x-1].right===i[x])return!0;return!1}})},{}],70:[function(v,w,y){w.exports=function(b,T){var k=new s(b);return k.update(T),k};var e=v("./lib/text.js"),t=v("./lib/lines.js"),n=v("./lib/background.js"),a=v("./lib/cube.js"),r=v("./lib/ticks.js"),g=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(b,T){return b[0]=T[0],b[1]=T[1],b[2]=T[2],b}function s(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var h=s.prototype;function l(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}h.update=function(b){function T(Z,Q,K){if(K in b){var $,ne=b[K],H=this[K];(Z?Array.isArray(ne)&&Array.isArray(ne[0]):Array.isArray(ne))?this[K]=$=[Q(ne[0]),Q(ne[1]),Q(ne[2])]:this[K]=$=[Q(ne),Q(ne),Q(ne)];for(var N=0;N<3;++N)if($[N]!==H[N])return!0}return!1}b=b||{};var k,L=T.bind(this,!1,Number),A=T.bind(this,!1,Boolean),I=T.bind(this,!1,String),P=T.bind(this,!0,function(Z){if(Array.isArray(Z)){if(Z.length===3)return[+Z[0],+Z[1],+Z[2],1];if(Z.length===4)return[+Z[0],+Z[1],+Z[2],+Z[3]]}return[0,0,0,1]}),S=!1,E=!1;if("bounds"in b)for(var z=b.bounds,D=0;D<2;++D)for(var j=0;j<3;++j)z[D][j]!==this.bounds[D][j]&&(E=!0),this.bounds[D][j]=z[D][j];if("ticks"in b)for(k=b.ticks,S=!0,this.autoTicks=!1,D=0;D<3;++D)this.tickSpacing[D]=0;else L("tickSpacing")&&(this.autoTicks=!0,E=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),E=!0,S=!0,this._firstInit=!1),E&&this.autoTicks&&(k=r.create(this.bounds,this.tickSpacing),S=!0),S){for(D=0;D<3;++D)k[D].sort(function(Z,Q){return Z.x-Q.x});r.equal(k,this.ticks)?S=!1:this.ticks=k}A("tickEnable"),I("tickFont")&&(S=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var V=I("labels");I("labelFont")&&(V=!0),A("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),A("lineEnable"),A("lineMirror"),L("lineWidth"),P("lineColor"),A("lineTickEnable"),A("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),A("gridEnable"),L("gridWidth"),P("gridColor"),A("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),A("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(V||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=t(this.gl,this.bounds,this.ticks))};var o=[new l,new l,new l];function p(b,T,k,L,A){for(var I=b.primalOffset,P=b.primalMinor,S=b.mirrorOffset,E=b.mirrorMinor,z=L[T],D=0;D<3;++D)if(T!==D){var j=I,V=S,Z=P,Q=E;z&1<<D&&(j=S,V=I,Z=E,Q=P),j[D]=k[0][D],V[D]=k[1][D],A[D]>0?(Z[D]=-1,Q[D]=0):(Z[D]=0,Q[D]=1)}}var c=[0,0,0],i={model:g,view:g,projection:g,_ortho:!1};h.isOpaque=function(){return!0},h.isTransparent=function(){return!1},h.drawTransparent=function(b){};var x=[0,0,0],f=[0,0,0],_=[0,0,0];h.draw=function(b){b=b||i;for(var T=this.gl,k=b.model||g,L=b.view||g,A=b.projection||g,I=this.bounds,P=b._ortho||!1,S=a(k,L,A,I,P),E=S.cubeEdges,z=S.axis,D=L[12],j=L[13],V=L[14],Z=L[15],Q=(P?2:1)*this.pixelRatio*(A[3]*D+A[7]*j+A[11]*V+A[15]*Z)/T.drawingBufferHeight,K=0;K<3;++K)this.lastCubeProps.cubeEdges[K]=E[K],this.lastCubeProps.axis[K]=z[K];var $=o;for(K=0;K<3;++K)p(o[K],K,this.bounds,E,z);T=this.gl;var ne,H=c;for(K=0;K<3;++K)this.backgroundEnable[K]?H[K]=z[K]:H[K]=0;for(this._background.draw(k,L,A,I,H,this.backgroundColor),this._lines.bind(k,L,A,this),K=0;K<3;++K){var N=[0,0,0];z[K]>0?N[K]=I[1][K]:N[K]=I[0][K];for(var U=0;U<2;++U){var te=(K+1+U)%3,B=(K+1+(1^U))%3;this.gridEnable[te]&&this._lines.drawGrid(te,B,this.bounds,N,this.gridColor[te],this.gridWidth[te]*this.pixelRatio)}for(U=0;U<2;++U)te=(K+1+U)%3,B=(K+1+(1^U))%3,this.zeroEnable[B]&&Math.min(I[0][B],I[1][B])<=0&&Math.max(I[0][B],I[1][B])>=0&&this._lines.drawZero(te,B,this.bounds,N,this.zeroLineColor[B],this.zeroLineWidth[B]*this.pixelRatio)}for(K=0;K<3;++K){this.lineEnable[K]&&this._lines.drawAxisLine(K,this.bounds,$[K].primalOffset,this.lineColor[K],this.lineWidth[K]*this.pixelRatio),this.lineMirror[K]&&this._lines.drawAxisLine(K,this.bounds,$[K].mirrorOffset,this.lineColor[K],this.lineWidth[K]*this.pixelRatio);var X=u(x,$[K].primalMinor),J=u(f,$[K].mirrorMinor),ee=this.lineTickLength;for(U=0;U<3;++U){var re=Q/k[5*U];X[U]*=ee[U]*re,J[U]*=ee[U]*re}this.lineTickEnable[K]&&this._lines.drawAxisTicks(K,$[K].primalOffset,X,this.lineTickColor[K],this.lineTickWidth[K]*this.pixelRatio),this.lineTickMirror[K]&&this._lines.drawAxisTicks(K,$[K].mirrorOffset,J,this.lineTickColor[K],this.lineTickWidth[K]*this.pixelRatio)}this._lines.unbind(),this._text.bind(k,L,A,this.pixelRatio);var se,oe;function de(_e){(oe=[0,0,0])[_e]=1}function ce(_e,le,ge){var Te=(_e+1)%3,Se=(_e+2)%3,Me=le[Te],ze=le[Se],Oe=ge[Te],De=ge[Se];Me>0&&De>0||Me>0&&De<0||Me<0&&De>0||Me<0&&De<0?de(Te):(ze>0&&Oe>0||ze>0&&Oe<0||ze<0&&Oe>0||ze<0&&Oe<0)&&de(Se)}for(K=0;K<3;++K){var ve=$[K].primalMinor,Ae=$[K].mirrorMinor,fe=u(_,$[K].primalOffset);for(U=0;U<3;++U)this.lineTickEnable[K]&&(fe[U]+=Q*ve[U]*Math.max(this.lineTickLength[U],0)/k[5*U]);var me=[0,0,0];if(me[K]=1,this.tickEnable[K]){for(this.tickAngle[K]===-3600?(this.tickAngle[K]=0,this.tickAlign[K]="auto"):this.tickAlign[K]=-1,se=1,(ne=[this.tickAlign[K],.5,se])[0]==="auto"?ne[0]=0:ne[0]=parseInt(""+ne[0]),oe=[0,0,0],ce(K,ve,Ae),U=0;U<3;++U)fe[U]+=Q*ve[U]*this.tickPad[U]/k[5*U];this._text.drawTicks(K,this.tickSize[K],this.tickAngle[K],fe,this.tickColor[K],me,oe,ne)}if(this.labelEnable[K]){for(se=0,oe=[0,0,0],this.labels[K].length>4&&(de(K),se=1),(ne=[this.labelAlign[K],.5,se])[0]==="auto"?ne[0]=0:ne[0]=parseInt(""+ne[0]),U=0;U<3;++U)fe[U]+=Q*ve[U]*this.labelPad[U]/k[5*U];fe[K]+=.5*(I[0][K]+I[1][K]),this._text.drawLabel(K,this.labelSize[K],this.labelAngle[K],fe,this.labelColor[K],[0,0,0],oe,ne)}}this._text.unbind()},h.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(v,w,y){w.exports=function(g){for(var u=[],s=[],h=0,l=0;l<3;++l)for(var o=(l+1)%3,p=(l+2)%3,c=[0,0,0],i=[0,0,0],x=-1;x<=1;x+=2){s.push(h,h+2,h+1,h+1,h+2,h+3),c[l]=x,i[l]=x;for(var f=-1;f<=1;f+=2){c[o]=f;for(var _=-1;_<=1;_+=2)c[p]=_,u.push(c[0],c[1],c[2],i[0],i[1],i[2]),h+=1}var b=o;o=p,p=b}var T=e(g,new Float32Array(u)),k=e(g,new Uint16Array(s),g.ELEMENT_ARRAY_BUFFER),L=t(g,[{buffer:T,type:g.FLOAT,size:3,offset:0,stride:24},{buffer:T,type:g.FLOAT,size:3,offset:12,stride:24}],k),A=n(g);return A.attributes.position.location=0,A.attributes.normal.location=1,new a(g,T,L,A)};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders").bg;function a(g,u,s,h){this.gl=g,this.buffer=u,this.vao=s,this.shader=h}var r=a.prototype;r.draw=function(g,u,s,h,l,o){for(var p=!1,c=0;c<3;++c)p=p||l[c];if(p){var i=this.gl;i.enable(i.POLYGON_OFFSET_FILL),i.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:g,view:u,projection:s,bounds:h,enable:l,colors:o},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),i.disable(i.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(v,w,y){w.exports=function(f,_,b,T,k){t(r,_,f),t(r,b,r);for(var L=0,A=0;A<2;++A){s[2]=T[A][2];for(var I=0;I<2;++I){s[1]=T[I][1];for(var P=0;P<2;++P)s[0]=T[P][0],l(g[L],s,r),L+=1}}var S=-1;for(A=0;A<8;++A){for(var E=g[A][3],z=0;z<3;++z)u[A][z]=g[A][z]/E;k&&(u[A][2]*=-1),E<0&&(S<0||u[A][2]<u[S][2])&&(S=A)}if(S<0){S=0;for(var D=0;D<3;++D){for(var j=(D+2)%3,V=(D+1)%3,Z=-1,Q=-1,K=0;K<2;++K){var $=(H=K<<D)+(K<<j)+(1-K<<V),ne=H+(1-K<<j)+(K<<V);a(u[H],u[$],u[ne],h)<0||(K?Z=1:Q=1)}if(Z<0||Q<0)Q>Z&&(S|=1<<D);else{for(K=0;K<2;++K){$=(H=K<<D)+(K<<j)+(1-K<<V),ne=H+(1-K<<j)+(K<<V);var H,N=p([g[H],g[$],g[ne],g[H+(1<<j)+(1<<V)]]);K?Z=N:Q=N}Q>Z&&(S|=1<<D)}}}var U=7^S,te=-1;for(A=0;A<8;++A)A!==S&&A!==U&&(te<0||u[te][1]>u[A][1])&&(te=A);var B=-1;for(A=0;A<3;++A)(J=te^1<<A)!==S&&J!==U&&(B<0&&(B=J),(V=u[J])[0]<u[B][0]&&(B=J));var X=-1;for(A=0;A<3;++A){var J;(J=te^1<<A)!==S&&J!==U&&J!==B&&(X<0&&(X=J),(V=u[J])[0]>u[X][0]&&(X=J))}var ee=c;ee[0]=ee[1]=ee[2]=0,ee[e.log2(B^te)]=te&B,ee[e.log2(te^X)]=te&X;var re=7^X;re===S||re===U?(re=7^B,ee[e.log2(X^re)]=re&X):ee[e.log2(B^re)]=re&B;var se=i,oe=S;for(D=0;D<3;++D)se[D]=oe&1<<D?-1:1;return x};var e=v("bit-twiddle"),t=v("gl-mat4/multiply"),n=v("split-polygon"),a=v("robust-orientation"),r=new Array(16),g=new Array(8),u=new Array(8),s=new Array(3),h=[0,0,0];function l(f,_,b){for(var T=0;T<4;++T){f[T]=b[12+T];for(var k=0;k<3;++k)f[T]+=_[k]*b[4*k+T]}}(function(){for(var f=0;f<8;++f)g[f]=[1,1,1,1],u[f]=[1,1,1]})();var o=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function p(f){for(var _=0;_<o.length;++_)if((f=n.positive(f,o[_])).length<3)return 0;var b=f[0],T=b[0]/b[3],k=b[1]/b[3],L=0;for(_=1;_+1<f.length;++_){var A=f[_],I=f[_+1],P=A[0]/A[3]-T,S=A[1]/A[3]-k,E=I[0]/I[3]-T,z=I[1]/I[3]-k;L+=Math.abs(P*z-S*E)}return L}var c=[1,1,1],i=[0,0,0],x={cubeEdges:c,axis:i}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(v,w,y){w.exports=function(c,i,x){var f=[],_=[0,0,0],b=[0,0,0],T=[0,0,0],k=[0,0,0];f.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var A=f.length/3|0,I=0;I<x[L].length;++I){var P=+x[L][I].x;f.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1)}var S=f.length/3|0;_[L]=A,b[L]=S-A,A=f.length/3|0;for(var E=0;E<x[L].length;++E)P=+x[L][E].x,f.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1);S=f.length/3|0,T[L]=A,k[L]=S-A}var z=e(c,new Float32Array(f)),D=t(c,[{buffer:z,type:c.FLOAT,size:3,stride:0,offset:0}]),j=n(c);return j.attributes.position.location=0,new o(c,z,D,j,b,_,k,T)};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders").line,a=[0,0,0],r=[0,0,0],g=[0,0,0],u=[0,0,0],s=[1,1];function h(c){return c[0]=c[1]=c[2]=0,c}function l(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c}function o(c,i,x,f,_,b,T,k){this.gl=c,this.vertBuffer=i,this.vao=x,this.shader=f,this.tickCount=_,this.tickOffset=b,this.gridCount=T,this.gridOffset=k}var p=o.prototype;p.bind=function(c,i,x){this.shader.bind(),this.shader.uniforms.model=c,this.shader.uniforms.view=i,this.shader.uniforms.projection=x,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=s,this.vao.bind()},p.unbind=function(){this.vao.unbind()},p.drawAxisLine=function(c,i,x,f,_){var b=h(r);this.shader.uniforms.majorAxis=r,b[c]=i[1][c]-i[0][c],this.shader.uniforms.minorAxis=b;var T,k=l(u,x);k[c]+=i[0][c],this.shader.uniforms.offset=k,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=f,(T=h(g))[(c+2)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6),(T=h(g))[(c+1)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6)},p.drawAxisTicks=function(c,i,x,f,_){if(this.tickCount[c]){var b=h(a);b[c]=1,this.shader.uniforms.majorAxis=b,this.shader.uniforms.offset=i,this.shader.uniforms.minorAxis=x,this.shader.uniforms.color=f,this.shader.uniforms.lineWidth=_;var T=h(g);T[c]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,this.tickCount[c],this.tickOffset[c])}},p.drawGrid=function(c,i,x,f,_,b){if(this.gridCount[c]){var T=h(r);T[i]=x[1][i]-x[0][i],this.shader.uniforms.minorAxis=T;var k=l(u,f);k[i]+=x[0][i],this.shader.uniforms.offset=k;var L=h(a);L[c]=1,this.shader.uniforms.majorAxis=L;var A=h(g);A[c]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[c],this.gridOffset[c])}},p.drawZero=function(c,i,x,f,_,b){var T=h(r);this.shader.uniforms.majorAxis=T,T[c]=x[1][c]-x[0][c],this.shader.uniforms.minorAxis=T;var k=l(u,f);k[c]+=x[0][c],this.shader.uniforms.offset=k;var L=h(g);L[i]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},p.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.line=function(h){return t(h,n,a,null,[{name:"position",type:"vec3"}])};var r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),g=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.text=function(h){return t(h,r,g,null,[{name:"position",type:"vec3"}])};var u=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),s=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);y.bg=function(h){return t(h,u,s,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(v,w,y){(function(e){(function(){w.exports=function(o,p,c,i,x,f){var _=t(o),b=n(o,[{buffer:_,size:3}]),T=r(o);T.attributes.position.location=0;var k=new s(o,T,_,b);return k.update(p,c,i,x,f),k};var t=v("gl-buffer"),n=v("gl-vao"),a=v("vectorize-text"),r=v("./shaders").text,g=window||e.global||{},u=g.__TEXT_CACHE||{};g.__TEXT_CACHE={};function s(o,p,c,i){this.gl=o,this.shader=p,this.buffer=c,this.vao=i,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var h=s.prototype,l=[0,0];h.bind=function(o,p,c,i){this.vao.bind(),this.shader.bind();var x=this.shader.uniforms;x.model=o,x.view=p,x.projection=c,x.pixelScale=i,l[0]=this.gl.drawingBufferWidth,l[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=l},h.unbind=function(){this.vao.unbind()},h.update=function(o,p,c,i,x){var f=[];function _(S,E,z,D,j,V){var Z=u[z];Z||(Z=u[z]={});var Q=Z[E];Q||(Q=Z[E]=function(X,J){try{return a(X,J)}catch(ee){return console.warn('error vectorizing text:"'+X+'" error:',ee),{cells:[],positions:[]}}}(E,{triangles:!0,font:z,textAlign:"center",textBaseline:"middle",lineSpacing:j,styletags:V}));for(var K=(D||12)/12,$=Q.positions,ne=Q.cells,H=0,N=ne.length;H<N;++H)for(var U=ne[H],te=2;te>=0;--te){var B=$[U[te]];f.push(K*B[0],-K*B[1],S)}}for(var b=[0,0,0],T=[0,0,0],k=[0,0,0],L=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){k[I]=f.length/3|0,_(.5*(o[0][I]+o[1][I]),p[I],c[I],12,1.25,A),L[I]=(f.length/3|0)-k[I],b[I]=f.length/3|0;for(var P=0;P<i[I].length;++P)i[I][P].text&&_(i[I][P].x,i[I][P].text,i[I][P].font||x,i[I][P].fontSize||12,1.25,A);T[I]=(f.length/3|0)-b[I]}this.buffer.update(f),this.tickOffset=b,this.tickCount=T,this.labelOffset=k,this.labelCount=L},h.drawTicks=function(o,p,c,i,x,f,_,b){this.tickCount[o]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=x,this.shader.uniforms.angle=c,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o]))},h.drawLabel=function(o,p,c,i,x,f,_,b){this.labelCount[o]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=x,this.shader.uniforms.angle=c,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.labelCount[o],this.labelOffset[o]))},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,v("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(v,w,y){function e(t,n){var a=t+"",r=a.indexOf("."),g=0;r>=0&&(g=a.length-r-1);var u=Math.pow(10,g),s=Math.round(t*n*u),h=s+"";if(h.indexOf("e")>=0)return h;var l=s/u,o=s%u;s<0?(l=0|-Math.ceil(l),o=0|-o):(l=0|Math.floor(l),o|=0);var p=""+l;if(s<0&&(p="-"+p),g){for(var c=""+o;c.length<g;)c="0"+c;return p+"."+c}return p}y.create=function(t,n){for(var a=[],r=0;r<3;++r){for(var g=[],u=(t[0][r],t[1][r],0);u*n[r]<=t[1][r];++u)g.push({x:u*n[r],text:e(n[r],u)});for(u=-1;u*n[r]>=t[0][r];--u)g.push({x:u*n[r],text:e(n[r],u)});a.push(g)}return a},y.equal=function(t,n){for(var a=0;a<3;++a){if(t[a].length!==n[a].length)return!1;for(var r=0;r<t[a].length;++r){var g=t[a][r],u=n[a][r];if(g.x!==u.x||g.text!==u.text||g.font!==u.font||g.fontColor!==u.fontColor||g.fontSize!==u.fontSize||g.dx!==u.dx||g.dy!==u.dy)return!1}}return!0}},{}],77:[function(v,w,y){w.exports=function(x,f,_,b,T){var k=f.model||u,L=f.view||u,A=f.projection||u,I=f._ortho||!1,P=x.bounds,S=(T=T||n(k,L,A,P,I)).axis;a(s,L,k),a(s,A,s);for(var E=c,z=0;z<3;++z)E[z].lo=1/0,E[z].hi=-1/0,E[z].pixelsPerDataUnit=1/0;var D=e(r(s,s));r(s,s);for(var j=0;j<3;++j){var V=(j+1)%3,Z=(j+2)%3,Q=i;e:for(z=0;z<2;++z){var K=[];if(S[j]<0!=!!z){Q[j]=P[z][j];for(var $=0;$<2;++$){Q[V]=P[$^z][V];for(var ne=0;ne<2;++ne)Q[Z]=P[ne^$^z][Z],K.push(Q.slice())}var H=I?5:4;for($=H;$===H;++$){if(K.length===0)continue e;K=t.positive(K,D[$])}for($=0;$<K.length;++$){Z=K[$];var N=p(i,s,Z,_,b);for(ne=0;ne<3;++ne)E[ne].lo=Math.min(E[ne].lo,Z[ne]),E[ne].hi=Math.max(E[ne].hi,Z[ne]),ne!==j&&(E[ne].pixelsPerDataUnit=Math.min(E[ne].pixelsPerDataUnit,Math.abs(N[ne])))}}}}return E};var e=v("extract-frustum-planes"),t=v("split-polygon"),n=v("./lib/cube.js"),a=v("gl-mat4/multiply"),r=v("gl-mat4/transpose"),g=v("gl-vec4/transformMat4"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),s=new Float32Array(16);function h(x,f,_){this.lo=x,this.hi=f,this.pixelsPerDataUnit=_}var l=[0,0,0,1],o=[0,0,0,1];function p(x,f,_,b,T){for(var k=0;k<3;++k){for(var L=l,A=o,I=0;I<3;++I)A[I]=L[I]=_[I];A[3]=L[3]=1,A[k]+=1,g(A,A,f),A[3]<0&&(x[k]=1/0),L[k]-=1,g(L,L,f),L[3]<0&&(x[k]=1/0);var P=(L[0]/L[3]-A[0]/A[3])*b,S=(L[1]/L[3]-A[1]/A[3])*T;x[k]=.25*Math.sqrt(P*P+S*S)}return x}var c=[new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0)],i=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(v,w,y){var e=v("typedarray-pool"),t=v("ndarray-ops"),n=v("ndarray"),a=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(h,l,o,p,c){this.gl=h,this.type=l,this.handle=o,this.length=p,this.usage=c}var g=r.prototype;function u(h,l,o,p,c,i){var x=c.length*c.BYTES_PER_ELEMENT;if(i<0)return h.bufferData(l,c,p),x;if(x+i>o)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return h.bufferSubData(l,i,c),o}function s(h,l){for(var o=e.malloc(h.length,l),p=h.length,c=0;c<p;++c)o[c]=h[c];return o}g.bind=function(){this.gl.bindBuffer(this.type,this.handle)},g.unbind=function(){this.gl.bindBuffer(this.type,null)},g.dispose=function(){this.gl.deleteBuffer(this.handle)},g.update=function(h,l){if(typeof l!="number"&&(l=-1),this.bind(),typeof h=="object"&&h.shape!==void 0){var o=h.dtype;if(a.indexOf(o)<0&&(o="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(o=gl.getExtension("OES_element_index_uint")&&o!=="uint16"?"uint32":"uint16"),o===h.dtype&&function(x,f){for(var _=1,b=f.length-1;b>=0;--b){if(f[b]!==_)return!1;_*=x[b]}return!0}(h.shape,h.stride))h.offset===0&&h.data.length===h.shape[0]?this.length=u(this.gl,this.type,this.length,this.usage,h.data,l):this.length=u(this.gl,this.type,this.length,this.usage,h.data.subarray(h.offset,h.shape[0]),l);else{var p=e.malloc(h.size,o),c=n(p,h.shape);t.assign(c,h),this.length=u(this.gl,this.type,this.length,this.usage,l<0?p:p.subarray(0,h.size),l),e.free(p)}}else if(Array.isArray(h)){var i;i=this.type===this.gl.ELEMENT_ARRAY_BUFFER?s(h,"uint16"):s(h,"float32"),this.length=u(this.gl,this.type,this.length,this.usage,l<0?i:i.subarray(0,h.length),l),e.free(i)}else if(typeof h=="object"&&typeof h.length=="number")this.length=u(this.gl,this.type,this.length,this.usage,h,l);else{if(typeof h!="number"&&h!==void 0)throw new Error("gl-buffer: Invalid data type");if(l>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(h|=0)<=0&&(h=1),this.gl.bufferData(this.type,0|h,this.usage),this.length=h}},w.exports=function(h,l,o,p){if(o=o||h.ARRAY_BUFFER,p=p||h.DYNAMIC_DRAW,o!==h.ARRAY_BUFFER&&o!==h.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(p!==h.DYNAMIC_DRAW&&p!==h.STATIC_DRAW&&p!==h.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var c=h.createBuffer(),i=new r(h,o,c,0,p);return i.update(l),i}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(v,w,y){var e=v("gl-vec3");w.exports=function(n,a){var r=n.positions,g=n.vectors,u={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return a&&(a[0]=[0,0,0],a[1]=[0,0,0]),u;for(var s=0,h=1/0,l=-1/0,o=1/0,p=-1/0,c=1/0,i=-1/0,x=null,f=null,_=[],b=1/0,T=!1,k=0;k<r.length;k++){var L=r[k];h=Math.min(L[0],h),l=Math.max(L[0],l),o=Math.min(L[1],o),p=Math.max(L[1],p),c=Math.min(L[2],c),i=Math.max(L[2],i);var A=g[k];if(e.length(A)>s&&(s=e.length(A)),k){var I=2*e.distance(x,L)/(e.length(f)+e.length(A));I?(b=Math.min(b,I),T=!1):T=!0}T||(x=L,f=A),_.push(A)}var P=[h,o,c],S=[l,p,i];a&&(a[0]=P,a[1]=S),s===0&&(s=1);var E=1/s;isFinite(b)||(b=1),u.vectorScale=b;var z=n.coneSize||.5;n.absoluteConeSize&&(z=n.absoluteConeSize*E),u.coneScale=z,k=0;for(var D=0;k<r.length;k++)for(var j=(L=r[k])[0],V=L[1],Z=L[2],Q=_[k],K=e.length(Q)*E,$=0;$<8;$++){u.positions.push([j,V,Z,D++]),u.positions.push([j,V,Z,D++]),u.positions.push([j,V,Z,D++]),u.positions.push([j,V,Z,D++]),u.positions.push([j,V,Z,D++]),u.positions.push([j,V,Z,D++]),u.vectors.push(Q),u.vectors.push(Q),u.vectors.push(Q),u.vectors.push(Q),u.vectors.push(Q),u.vectors.push(Q),u.vertexIntensity.push(K,K,K),u.vertexIntensity.push(K,K,K);var ne=u.positions.length;u.cells.push([ne-6,ne-5,ne-4],[ne-3,ne-2,ne-1])}return u};var t=v("./lib/shaders");w.exports.createMesh=v("./create_mesh"),w.exports.createConeMesh=function(n,a){return w.exports.createMesh(n,a,{shaders:t,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("gl-vao"),a=v("gl-texture2d"),r=v("gl-mat4/multiply"),g=v("gl-mat4/invert"),u=v("ndarray"),s=v("colormap"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(i,x,f,_,b,T,k,L,A,I,P){this.gl=i,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=x,this.dirty=!0,this.triShader=f,this.pickShader=_,this.trianglePositions=b,this.triangleVectors=T,this.triangleColors=L,this.triangleUVs=A,this.triangleIds=k,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=P,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=h,this._view=h,this._projection=h,this._resolution=[1,1]}var o=l.prototype;function p(i,x){var f=e(i,x.meshShader.vertex,x.meshShader.fragment,null,x.meshShader.attributes);return f.attributes.position.location=0,f.attributes.color.location=2,f.attributes.uv.location=3,f.attributes.vector.location=4,f}function c(i,x){var f=e(i,x.pickShader.vertex,x.pickShader.fragment,null,x.pickShader.attributes);return f.attributes.position.location=0,f.attributes.id.location=1,f.attributes.vector.location=4,f}o.isOpaque=function(){return this.opacity>=1},o.isTransparent=function(){return this.opacity<1},o.pickSlots=1,o.setPickBase=function(i){this.pickId=i},o.update=function(i){i=i||{};var x=this.gl;this.dirty=!0,"lightPosition"in i&&(this.lightPosition=i.lightPosition),"opacity"in i&&(this.opacity=i.opacity),"ambient"in i&&(this.ambientLight=i.ambient),"diffuse"in i&&(this.diffuseLight=i.diffuse),"specular"in i&&(this.specularLight=i.specular),"roughness"in i&&(this.roughness=i.roughness),"fresnel"in i&&(this.fresnel=i.fresnel),i.tubeScale!==void 0&&(this.tubeScale=i.tubeScale),i.vectorScale!==void 0&&(this.vectorScale=i.vectorScale),i.coneScale!==void 0&&(this.coneScale=i.coneScale),i.coneOffset!==void 0&&(this.coneOffset=i.coneOffset),i.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=x.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=x.LINEAR,this.texture.setPixels(function(te){for(var B=s({colormap:te,nshades:256,format:"rgba"}),X=new Uint8Array(1024),J=0;J<256;++J){for(var ee=B[J],re=0;re<3;++re)X[4*J+re]=ee[re];X[4*J+3]=255*ee[3]}return u(X,[256,256,4],[4,0,1])}(i.colormap)),this.texture.generateMipmap());var f=i.cells,_=i.positions,b=i.vectors;if(_&&f&&b){var T=[],k=[],L=[],A=[],I=[];this.cells=f,this.positions=_,this.vectors=b;var P=i.meshColor||[1,1,1,1],S=i.vertexIntensity,E=1/0,z=-1/0;if(S)if(i.vertexIntensityBounds)E=+i.vertexIntensityBounds[0],z=+i.vertexIntensityBounds[1];else for(var D=0;D<S.length;++D){var j=S[D];E=Math.min(E,j),z=Math.max(z,j)}else for(D=0;D<_.length;++D)j=_[D][2],E=Math.min(E,j),z=Math.max(z,j);for(this.intensity=S||function(te){for(var B=te.length,X=new Array(B),J=0;J<B;++J)X[J]=te[J][2];return X}(_),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],D=0;D<_.length;++D)for(var V=_[D],Z=0;Z<3;++Z)!isNaN(V[Z])&&isFinite(V[Z])&&(this.bounds[0][Z]=Math.min(this.bounds[0][Z],V[Z]),this.bounds[1][Z]=Math.max(this.bounds[1][Z],V[Z]));var Q=0;e:for(D=0;D<f.length;++D){var K=f[D];switch(K.length){case 3:for(Z=0;Z<3;++Z){V=_[ne=K[Z]];for(var $=0;$<3;++$)if(isNaN(V[$])||!isFinite(V[$]))continue e}for(Z=0;Z<3;++Z){var ne;V=_[ne=K[2-Z]],T.push(V[0],V[1],V[2],V[3]);var H=b[ne];k.push(H[0],H[1],H[2],H[3]||0);var N,U=P;U.length===3?L.push(U[0],U[1],U[2],1):L.push(U[0],U[1],U[2],U[3]),N=S?[(S[ne]-E)/(z-E),0]:[(V[2]-E)/(z-E),0],A.push(N[0],N[1]),I.push(D)}Q+=1}}this.triangleCount=Q,this.trianglePositions.update(T),this.triangleVectors.update(k),this.triangleColors.update(L),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(I))}},o.drawTransparent=o.draw=function(i){i=i||{};for(var x=this.gl,f=i.model||h,_=i.view||h,b=i.projection||h,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)T[0][k]=Math.max(T[0][k],this.clipBounds[0][k]),T[1][k]=Math.min(T[1][k],this.clipBounds[1][k]);var L={model:f,view:_,projection:b,inverseModel:h.slice(),clipBounds:T,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};L.inverseModel=g(L.inverseModel,L.model),x.disable(x.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(r(A,L.view,L.model),r(A,L.projection,A),g(A,A),k=0;k<3;++k)L.eyePosition[k]=A[12+k]/A[15];var I=A[15];for(k=0;k<3;++k)I+=this.lightPosition[k]*A[4*k+3];for(k=0;k<3;++k){for(var P=A[12+k],S=0;S<3;++S)P+=A[4*S+k]*this.lightPosition[S];L.lightPosition[k]=P/I}if(this.triangleCount>0){var E=this.triShader;E.bind(),E.uniforms=L,this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},o.drawPick=function(i){i=i||{};for(var x=this.gl,f=i.model||h,_=i.view||h,b=i.projection||h,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)T[0][k]=Math.max(T[0][k],this.clipBounds[0][k]),T[1][k]=Math.min(T[1][k],this.clipBounds[1][k]);this._model=[].slice.call(f),this._view=[].slice.call(_),this._projection=[].slice.call(b),this._resolution=[x.drawingBufferWidth,x.drawingBufferHeight];var L={model:f,view:_,projection:b,clipBounds:T,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=L,this.triangleCount>0&&(this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},o.pick=function(i){if(!i||i.id!==this.pickId)return null;var x=i.value[0]+256*i.value[1]+65536*i.value[2],f=this.cells[x],_=this.positions[f[1]].slice(0,3),b={position:_,dataCoordinate:_,index:Math.floor(f[1]/48)};return this.traceType==="cone"?b.index=Math.floor(f[1]/48):this.traceType==="streamtube"&&(b.intensity=this.intensity[f[1]],b.velocity=this.vectors[f[1]].slice(0,3),b.divergence=this.vectors[f[1]][3],b.index=x),b},o.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},w.exports=function(i,x,f){var _=f.shaders;arguments.length===1&&(i=(x=i).gl);var b=p(i,_),T=c(i,_),k=a(i,u(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=i.LINEAR_MIPMAP_LINEAR,k.magFilter=i.LINEAR;var L=t(i),A=t(i),I=t(i),P=t(i),S=t(i),E=n(i,[{buffer:L,type:i.FLOAT,size:4},{buffer:S,type:i.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:i.FLOAT,size:4},{buffer:P,type:i.FLOAT,size:2},{buffer:A,type:i.FLOAT,size:4}]),z=new l(i,k,b,T,L,A,S,I,P,E,f.traceType||"cone");return z.update(x),z}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},y.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(v,w,y){w.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(v,w,y){var e=v("./1.0/numbers");w.exports=function(t){return e[t]}},{"./1.0/numbers":82}],84:[function(v,w,y){w.exports=function(l){var o=l.gl,p=e(o),c=t(o,[{buffer:p,type:o.FLOAT,size:3,offset:0,stride:40},{buffer:p,type:o.FLOAT,size:4,offset:12,stride:40},{buffer:p,type:o.FLOAT,size:3,offset:28,stride:40}]),i=n(o);i.attributes.position.location=0,i.attributes.color.location=1,i.attributes.offset.location=2;var x=new r(o,p,c,i);return x.update(l),x};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders/index"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(l,o,p,c){this.gl=l,this.shader=c,this.buffer=o,this.vao=p,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var g=r.prototype;function u(l,o){for(var p=0;p<3;++p)l[0][p]=Math.min(l[0][p],o[p]),l[1][p]=Math.max(l[1][p],o[p])}g.isOpaque=function(){return!this.hasAlpha},g.isTransparent=function(){return this.hasAlpha},g.drawTransparent=g.draw=function(l){var o=this.gl,p=this.shader.uniforms;this.shader.bind();var c=p.view=l.view||a,i=p.projection=l.projection||a;p.model=l.model||a,p.clipBounds=this.clipBounds,p.opacity=this.opacity;var x=c[12],f=c[13],_=c[14],b=c[15],T=(l._ortho?2:1)*this.pixelRatio*(i[3]*x+i[7]*f+i[11]*_+i[15]*b)/o.drawingBufferHeight;this.vao.bind();for(var k=0;k<3;++k)o.lineWidth(this.lineWidth[k]*this.pixelRatio),p.capSize=this.capSize[k]*T,this.lineCount[k]&&o.drawArrays(o.LINES,this.lineOffset[k],this.lineCount[k]);this.vao.unbind()};var s=function(){for(var l=new Array(3),o=0;o<3;++o){for(var p=[],c=1;c<=2;++c)for(var i=-1;i<=1;i+=2){var x=[0,0,0];x[(c+o)%3]=i,p.push(x)}l[o]=p}return l}();function h(l,o,p,c){for(var i=s[c],x=0;x<i.length;++x){var f=i[x];l.push(o[0],o[1],o[2],p[0],p[1],p[2],p[3],f[0],f[1],f[2])}return i.length}g.update=function(l){"lineWidth"in(l=l||{})&&(this.lineWidth=l.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in l&&(this.capSize=l.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in l&&(this.opacity=+l.opacity,this.opacity<1&&(this.hasAlpha=!0));var o=l.color||[[0,0,0],[0,0,0],[0,0,0]],p=l.position,c=l.error;if(Array.isArray(o[0])||(o=[o,o,o]),p&&c){var i=[],x=p.length,f=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=f;e:for(var b=0;b<x;++b){for(var T=p[b],k=0;k<3;++k)if(isNaN(T[k])||!isFinite(T[k]))continue e;var L=c[b],A=o[_];if(Array.isArray(A[0])&&(A=o[b]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(L[0][_])&&!isNaN(L[1][_])){var I;L[0][_]<0&&((I=T.slice())[_]+=L[0][_],i.push(T[0],T[1],T[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,I),f+=2+h(i,I,A,_)),L[1][_]>0&&((I=T.slice())[_]+=L[1][_],i.push(T[0],T[1],T[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),u(this.bounds,I),f+=2+h(i,I,A,_))}}this.lineCount[_]=f-this.lineOffset[_]}this.buffer.update(i)}},g.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);w.exports=function(r){return t(r,n,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(v,w,y){var e=v("gl-texture2d");w.exports=function(x,f,_,b){t||(t=x.FRAMEBUFFER_UNSUPPORTED,n=x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,a=x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,r=x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var T=x.getExtension("WEBGL_draw_buffers");if(!g&&T&&function(E,z){var D=E.getParameter(z.MAX_COLOR_ATTACHMENTS_WEBGL);g=new Array(D+1);for(var j=0;j<=D;++j){for(var V=new Array(D),Z=0;Z<j;++Z)V[Z]=E.COLOR_ATTACHMENT0+Z;for(Z=j;Z<D;++Z)V[Z]=E.NONE;g[j]=V}}(x,T),Array.isArray(f)&&(b=_,_=0|f[1],f=0|f[0]),typeof f!="number")throw new Error("gl-fbo: Missing shape parameter");var k=x.getParameter(x.MAX_RENDERBUFFER_SIZE);if(f<0||f>k||_<0||_>k)throw new Error("gl-fbo: Parameters are too large for FBO");var L=1;if("color"in(b=b||{})){if((L=Math.max(0|b.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(L>1){if(!T)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(L>x.getParameter(T.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+L+" draw buffers")}}var A=x.UNSIGNED_BYTE,I=x.getExtension("OES_texture_float");if(b.float&&L>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");A=x.FLOAT}else b.preferFloat&&L>0&&I&&(A=x.FLOAT);var P=!0;"depth"in b&&(P=!!b.depth);var S=!1;return"stencil"in b&&(S=!!b.stencil),new p(x,f,_,A,L,P,S,T)};var t,n,a,r,g=null;function u(x){return[x.getParameter(x.FRAMEBUFFER_BINDING),x.getParameter(x.RENDERBUFFER_BINDING),x.getParameter(x.TEXTURE_BINDING_2D)]}function s(x,f){x.bindFramebuffer(x.FRAMEBUFFER,f[0]),x.bindRenderbuffer(x.RENDERBUFFER,f[1]),x.bindTexture(x.TEXTURE_2D,f[2])}function h(x){switch(x){case t:throw new Error("gl-fbo: Framebuffer unsupported");case n:throw new Error("gl-fbo: Framebuffer incomplete attachment");case a:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case r:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function l(x,f,_,b,T,k){if(!b)return null;var L=e(x,f,_,T,b);return L.magFilter=x.NEAREST,L.minFilter=x.NEAREST,L.mipSamples=1,L.bind(),x.framebufferTexture2D(x.FRAMEBUFFER,k,x.TEXTURE_2D,L.handle,0),L}function o(x,f,_,b,T){var k=x.createRenderbuffer();return x.bindRenderbuffer(x.RENDERBUFFER,k),x.renderbufferStorage(x.RENDERBUFFER,b,f,_),x.framebufferRenderbuffer(x.FRAMEBUFFER,T,x.RENDERBUFFER,k),k}function p(x,f,_,b,T,k,L,A){this.gl=x,this._shape=[0|f,0|_],this._destroyed=!1,this._ext=A,this.color=new Array(T);for(var I=0;I<T;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=b,this._useDepth=k,this._useStencil=L;var P=this,S=[0|f,0|_];Object.defineProperties(S,{0:{get:function(){return P._shape[0]},set:function(E){return P.width=E}},1:{get:function(){return P._shape[1]},set:function(E){return P.height=E}}}),this._shapeVector=S,function(E){var z=u(E.gl),D=E.gl,j=E.handle=D.createFramebuffer(),V=E._shape[0],Z=E._shape[1],Q=E.color.length,K=E._ext,$=E._useStencil,ne=E._useDepth,H=E._colorType;D.bindFramebuffer(D.FRAMEBUFFER,j);for(var N=0;N<Q;++N)E.color[N]=l(D,V,Z,H,D.RGBA,D.COLOR_ATTACHMENT0+N);Q===0?(E._color_rb=o(D,V,Z,D.RGBA4,D.COLOR_ATTACHMENT0),K&&K.drawBuffersWEBGL(g[0])):Q>1&&K.drawBuffersWEBGL(g[Q]);var U=D.getExtension("WEBGL_depth_texture");U?$?E.depth=l(D,V,Z,U.UNSIGNED_INT_24_8_WEBGL,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):ne&&(E.depth=l(D,V,Z,D.UNSIGNED_SHORT,D.DEPTH_COMPONENT,D.DEPTH_ATTACHMENT)):ne&&$?E._depth_rb=o(D,V,Z,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):ne?E._depth_rb=o(D,V,Z,D.DEPTH_COMPONENT16,D.DEPTH_ATTACHMENT):$&&(E._depth_rb=o(D,V,Z,D.STENCIL_INDEX,D.STENCIL_ATTACHMENT));var te=D.checkFramebufferStatus(D.FRAMEBUFFER);if(te!==D.FRAMEBUFFER_COMPLETE){for(E._destroyed=!0,D.bindFramebuffer(D.FRAMEBUFFER,null),D.deleteFramebuffer(E.handle),E.handle=null,E.depth&&(E.depth.dispose(),E.depth=null),E._depth_rb&&(D.deleteRenderbuffer(E._depth_rb),E._depth_rb=null),N=0;N<E.color.length;++N)E.color[N].dispose(),E.color[N]=null;E._color_rb&&(D.deleteRenderbuffer(E._color_rb),E._color_rb=null),s(D,z),h(te)}s(D,z)}(this)}var c=p.prototype;function i(x,f,_){if(x._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(x._shape[0]!==f||x._shape[1]!==_){var b=x.gl,T=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(f<0||f>T||_<0||_>T)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");x._shape[0]=f,x._shape[1]=_;for(var k=u(b),L=0;L<x.color.length;++L)x.color[L].shape=x._shape;x._color_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,x._color_rb),b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,x._shape[0],x._shape[1])),x.depth&&(x.depth.shape=x._shape),x._depth_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,x._depth_rb),x._useDepth&&x._useStencil?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,x._shape[0],x._shape[1]):x._useDepth?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,x._shape[0],x._shape[1]):x._useStencil&&b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX,x._shape[0],x._shape[1])),b.bindFramebuffer(b.FRAMEBUFFER,x.handle);var A=b.checkFramebufferStatus(b.FRAMEBUFFER);A!==b.FRAMEBUFFER_COMPLETE&&(x.dispose(),s(b,k),h(A)),s(b,k)}}Object.defineProperties(c,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(x){if(Array.isArray(x)||(x=[0|x,0|x]),x.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var f=0|x[0],_=0|x[1];return i(this,f,_),[f,_]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(x){return i(this,x|=0,this._shape[1]),x},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(x){return x|=0,i(this,this._shape[0],x),x},enumerable:!1}}),c.bind=function(){if(!this._destroyed){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,this.handle),x.viewport(0,0,this._shape[0],this._shape[1])}},c.dispose=function(){if(!this._destroyed){this._destroyed=!0;var x=this.gl;x.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(x.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var f=0;f<this.color.length;++f)this.color[f].dispose(),this.color[f]=null;this._color_rb&&(x.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(v,w,y){var e=v("sprintf-js").sprintf,t=v("gl-constants/lookup"),n=v("glsl-shader-name"),a=v("add-line-numbers");w.exports=function(r,g,u){var s=n(g)||"of unknown name (see npm glsl-shader-name)",h="unknown type";u!==void 0&&(h=u===t.FRAGMENT_SHADER?"fragment":"vertex");for(var l=e(`Error compiling %s shader %s:
`,h,s),o=e("%s%s",l,r),p=r.split(`
`),c={},i=0;i<p.length;i++){var x=p[i];if(x!==""&&x!=="\0"){var f=parseInt(x.split(":")[2]);if(isNaN(f))throw new Error(e("Could not parse error: %s",x));c[f]=x}}var _=a(g).split(`
`);for(i=0;i<_.length;i++)if(c[i+3]||c[i+2]||c[i+1]){var b=_[i];if(l+=b+`
`,c[i+1]){var T=c[i+1];T=T.substr(T.split(":",3).join(":").length+1).trim(),l+=e(`^^^ %s

`,T)}}return{long:l.trim(),short:o.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(v,w,y){w.exports=function(o,p){var c=o.gl,i=a(c,g.vertex,g.fragment),x=a(c,g.pickVertex,g.pickFragment),f=r(c),_=r(c),b=r(c),T=r(c),k=new u(o,i,x,f,_,b,T);return k.update(p),o.addObject(k),k};var e=v("binary-search-bounds"),t=v("iota-array"),n=v("typedarray-pool"),a=v("gl-shader"),r=v("gl-buffer"),g=v("./lib/shaders");function u(o,p,c,i,x,f,_){this.plot=o,this.shader=p,this.pickShader=c,this.positionBuffer=i,this.weightBuffer=x,this.colorBuffer=f,this.idBuffer=_,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var s,h=u.prototype,l=[0,0,1,0,0,1,1,0,1,1,0,1];h.draw=(s=[1,0,0,0,1,0,0,0,1],function(){var o=this.plot,p=this.shader,c=this.bounds,i=this.numVertices;if(!(i<=0)){var x=o.gl,f=o.dataBox,_=c[2]-c[0],b=c[3]-c[1],T=f[2]-f[0],k=f[3]-f[1];s[0]=2*_/T,s[4]=2*b/k,s[6]=2*(c[0]-f[0])/T-1,s[7]=2*(c[1]-f[1])/k-1,p.bind();var L=p.uniforms;L.viewTransform=s,L.shape=this.shape;var A=p.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(x.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(x.UNSIGNED_BYTE,!0),x.drawArrays(x.TRIANGLES,0,i)}}),h.drawPick=function(){var o=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(c){var i=this.plot,x=this.pickShader,f=this.bounds,_=this.numVertices;if(!(_<=0)){var b=i.gl,T=i.dataBox,k=f[2]-f[0],L=f[3]-f[1],A=T[2]-T[0],I=T[3]-T[1];o[0]=2*k/A,o[4]=2*L/I,o[6]=2*(f[0]-T[0])/A-1,o[7]=2*(f[1]-T[1])/I-1;for(var P=0;P<4;++P)p[P]=c>>8*P&255;this.pickOffset=c,x.bind();var S=x.uniforms;S.viewTransform=o,S.pickOffset=p,S.shape=this.shape;var E=x.attributes;return this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(b.UNSIGNED_BYTE,!1),this.idBuffer.bind(),E.pickId.pointer(b.UNSIGNED_BYTE,!1),b.drawArrays(b.TRIANGLES,0,_),c+this.shape[0]*this.shape[1]}}}(),h.pick=function(o,p,c){var i=this.pickOffset,x=this.shape[0]*this.shape[1];if(c<i||c>=i+x)return null;var f=c-i,_=this.xData,b=this.yData;return{object:this,pointId:f,dataCoord:[_[f%this.shape[0]],b[f/this.shape[0]|0]]}},h.update=function(o){var p=(o=o||{}).shape||[0,0],c=o.x||t(p[0]),i=o.y||t(p[1]),x=o.z||new Float32Array(p[0]*p[1]),f=o.zsmooth!==!1;this.xData=c,this.yData=i;var _,b,T,k,L=o.colorLevels||[0],A=o.colorValues||[0,0,0,1],I=L.length,P=this.bounds;f?(_=P[0]=c[0],b=P[1]=i[0],T=P[2]=c[c.length-1],k=P[3]=i[i.length-1]):(_=P[0]=c[0]+(c[1]-c[0])/2,b=P[1]=i[0]+(i[1]-i[0])/2,T=P[2]=c[c.length-1]+(c[c.length-1]-c[c.length-2])/2,k=P[3]=i[i.length-1]+(i[i.length-1]-i[i.length-2])/2);var S=1/(T-_),E=1/(k-b),z=p[0],D=p[1];this.shape=[z,D];var j=(f?(z-1)*(D-1):z*D)*(l.length>>>1);this.numVertices=j;for(var V=n.mallocUint8(4*j),Z=n.mallocFloat32(2*j),Q=n.mallocUint8(2*j),K=n.mallocUint32(j),$=0,ne=f?z-1:z,H=f?D-1:D,N=0;N<H;++N){var U,te;f?(U=E*(i[N]-b),te=E*(i[N+1]-b)):(U=N<D-1?E*(i[N]-(i[N+1]-i[N])/2-b):E*(i[N]-(i[N]-i[N-1])/2-b),te=N<D-1?E*(i[N]+(i[N+1]-i[N])/2-b):E*(i[N]+(i[N]-i[N-1])/2-b));for(var B=0;B<ne;++B){var X,J;f?(X=S*(c[B]-_),J=S*(c[B+1]-_)):(X=B<z-1?S*(c[B]-(c[B+1]-c[B])/2-_):S*(c[B]-(c[B]-c[B-1])/2-_),J=B<z-1?S*(c[B]+(c[B+1]-c[B])/2-_):S*(c[B]+(c[B]-c[B-1])/2-_));for(var ee=0;ee<l.length;ee+=2){var re,se,oe,de,ce=l[ee],ve=l[ee+1],Ae=x[f?(N+ve)*z+(B+ce):N*z+B],fe=e.le(L,Ae);if(fe<0)re=A[0],se=A[1],oe=A[2],de=A[3];else if(fe===I-1)re=A[4*I-4],se=A[4*I-3],oe=A[4*I-2],de=A[4*I-1];else{var me=(Ae-L[fe])/(L[fe+1]-L[fe]),_e=1-me,le=4*fe,ge=4*(fe+1);re=_e*A[le]+me*A[ge],se=_e*A[le+1]+me*A[ge+1],oe=_e*A[le+2]+me*A[ge+2],de=_e*A[le+3]+me*A[ge+3]}V[4*$]=255*re,V[4*$+1]=255*se,V[4*$+2]=255*oe,V[4*$+3]=255*de,Z[2*$]=.5*X+.5*J,Z[2*$+1]=.5*U+.5*te,Q[2*$]=ce,Q[2*$+1]=ve,K[$]=N*z+B,$+=1}}}this.positionBuffer.update(Z),this.weightBuffer.update(Q),this.colorBuffer.update(V),this.idBuffer.update(K),n.free(Z),n.free(V),n.free(Q),n.free(K)},h.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(v,w,y){var e=v("glslify");w.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),g=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];y.createShader=function(u){return t(u,n,a,null,g)},y.createPickShader=function(u){return t(u,n,r,null,g)}},{"gl-shader":132,glslify:231}],91:[function(v,w,y){w.exports=function(_){var b=_.gl||_.scene&&_.scene.gl,T=h(b);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;var k=l(b);k.attributes.position.location=0,k.attributes.nextPosition.location=1,k.attributes.arcLength.location=2,k.attributes.lineWidth.location=3,k.attributes.color.location=4;for(var L=e(b),A=t(b,[{buffer:L,size:3,offset:0,stride:48},{buffer:L,size:3,offset:12,stride:48},{buffer:L,size:1,offset:24,stride:48},{buffer:L,size:1,offset:28,stride:48},{buffer:L,size:4,offset:32,stride:48}]),I=u(new Array(1024),[256,1,4]),P=0;P<1024;++P)I.data[P]=255;var S=n(b,I);S.wrap=b.REPEAT;var E=new x(b,T,k,L,A,S);return E.update(_),E};var e=v("gl-buffer"),t=v("gl-vao"),n=v("gl-texture2d"),a=new Uint8Array(4),r=new Float32Array(a.buffer),g=v("binary-search-bounds"),u=v("ndarray"),s=v("./lib/shaders"),h=s.createShader,l=s.createPickShader,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(_,b){for(var T=0,k=0;k<3;++k){var L=_[k]-b[k];T+=L*L}return Math.sqrt(T)}function c(_){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)b[0][T]=Math.max(_[0][T],b[0][T]),b[1][T]=Math.min(_[1][T],b[1][T]);return b}function i(_,b,T,k){this.arcLength=_,this.position=b,this.index=T,this.dataCoordinate=k}function x(_,b,T,k,L,A){this.gl=_,this.shader=b,this.pickShader=T,this.buffer=k,this.vao=L,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var f=x.prototype;f.isTransparent=function(){return this.hasAlpha},f.isOpaque=function(){return!this.hasAlpha},f.pickSlots=1,f.setPickBase=function(_){this.pickId=_},f.drawTransparent=f.draw=function(_){if(this.vertexCount){var b=this.gl,T=this.shader,k=this.vao;T.bind(),T.uniforms={model:_.model||o,view:_.view||o,projection:_.projection||o,clipBounds:c(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(b.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},f.drawPick=function(_){if(this.vertexCount){var b=this.gl,T=this.pickShader,k=this.vao;T.bind(),T.uniforms={model:_.model||o,view:_.view||o,projection:_.projection||o,pickId:this.pickId,clipBounds:c(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(b.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},f.update=function(_){var b,T;this.dirty=!0;var k=!!_.connectGaps;"dashScale"in _&&(this.dashScale=_.dashScale),this.hasAlpha=!1,"opacity"in _&&(this.opacity=+_.opacity,this.opacity<1&&(this.hasAlpha=!0));var L=[],A=[],I=[],P=0,S=0,E=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],z=_.position||_.positions;if(z){var D=_.color||_.colors||[0,0,0,1],j=_.lineWidth||1,V=!1;e:for(b=1;b<z.length;++b){var Z,Q,K,$=z[b-1],ne=z[b];for(A.push(P),I.push($.slice()),T=0;T<3;++T){if(isNaN($[T])||isNaN(ne[T])||!isFinite($[T])||!isFinite(ne[T])){if(!k&&L.length>0){for(var H=0;H<24;++H)L.push(L[L.length-12]);S+=2,V=!0}continue e}E[0][T]=Math.min(E[0][T],$[T],ne[T]),E[1][T]=Math.max(E[1][T],$[T],ne[T])}Array.isArray(D[0])?(Z=D.length>b-1?D[b-1]:D.length>0?D[D.length-1]:[0,0,0,1],Q=D.length>b?D[b]:D.length>0?D[D.length-1]:[0,0,0,1]):Z=Q=D,Z.length===3&&(Z=[Z[0],Z[1],Z[2],1]),Q.length===3&&(Q=[Q[0],Q[1],Q[2],1]),!this.hasAlpha&&Z[3]<1&&(this.hasAlpha=!0),K=Array.isArray(j)?j.length>b-1?j[b-1]:j.length>0?j[j.length-1]:[0,0,0,1]:j;var N=P;if(P+=p($,ne),V){for(T=0;T<2;++T)L.push($[0],$[1],$[2],ne[0],ne[1],ne[2],N,K,Z[0],Z[1],Z[2],Z[3]);S+=2,V=!1}L.push($[0],$[1],$[2],ne[0],ne[1],ne[2],N,K,Z[0],Z[1],Z[2],Z[3],$[0],$[1],$[2],ne[0],ne[1],ne[2],N,-K,Z[0],Z[1],Z[2],Z[3],ne[0],ne[1],ne[2],$[0],$[1],$[2],P,-K,Q[0],Q[1],Q[2],Q[3],ne[0],ne[1],ne[2],$[0],$[1],$[2],P,K,Q[0],Q[1],Q[2],Q[3]),S+=4}}if(this.buffer.update(L),A.push(P),I.push(z[z.length-1].slice()),this.bounds=E,this.vertexCount=S,this.points=I,this.arcLength=A,"dashes"in _){var U=_.dashes.slice();for(U.unshift(0),b=1;b<U.length;++b)U[b]=U[b-1]+U[b];var te=u(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(T=0;T<4;++T)te.set(b,0,T,0);1&g.le(U,U[U.length-1]*b/255)?te.set(b,0,0,0):te.set(b,0,0,255)}this.texture.setPixels(te)}},f.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},f.pick=function(_){if(!_||_.id!==this.pickId)return null;var b=function(z,D,j,V){return a[0]=V,a[1]=j,a[2]=D,a[3]=z,r[0]}(_.value[0],_.value[1],_.value[2],0),T=g.le(this.arcLength,b);if(T<0)return null;if(T===this.arcLength.length-1)return new i(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),T);for(var k=this.points[T],L=this.points[Math.min(T+1,this.points.length-1)],A=(b-this.arcLength[T])/(this.arcLength[T+1]-this.arcLength[T]),I=1-A,P=[0,0,0],S=0;S<3;++S)P[S]=I*k[S]+A*L[S];var E=Math.min(A<.5?T:T+1,this.points.length-1);return new i(b,P,E,this.points[E])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(v,w,y){w.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],93:[function(v,w,y){w.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],a=e[2],r=e[3],g=e[4],u=e[5],s=e[6],h=e[7],l=e[8],o=e[9],p=e[10],c=e[11],i=e[12],x=e[13],f=e[14],_=e[15];return(t*u-n*g)*(p*_-c*f)-(t*s-a*g)*(o*_-c*x)+(t*h-r*g)*(o*f-p*x)+(n*s-a*u)*(l*_-c*i)-(n*h-r*u)*(l*f-p*i)+(a*h-r*s)*(l*x-o*i)}},{}],95:[function(v,w,y){w.exports=function(e,t){var n=t[0],a=t[1],r=t[2],g=t[3],u=n+n,s=a+a,h=r+r,l=n*u,o=a*u,p=a*s,c=r*u,i=r*s,x=r*h,f=g*u,_=g*s,b=g*h;return e[0]=1-p-x,e[1]=o+b,e[2]=c-_,e[3]=0,e[4]=o-b,e[5]=1-l-x,e[6]=i+f,e[7]=0,e[8]=c+_,e[9]=i-f,e[10]=1-l-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=t[3],s=a+a,h=r+r,l=g+g,o=a*s,p=a*h,c=a*l,i=r*h,x=r*l,f=g*l,_=u*s,b=u*h,T=u*l;return e[0]=1-(i+f),e[1]=p+T,e[2]=c-b,e[3]=0,e[4]=p-T,e[5]=1-(o+f),e[6]=x+_,e[7]=0,e[8]=c+b,e[9]=x-_,e[10]=1-(o+i),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],97:[function(v,w,y){w.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(v,w,y){w.exports=function(e,t){var n=t[0],a=t[1],r=t[2],g=t[3],u=t[4],s=t[5],h=t[6],l=t[7],o=t[8],p=t[9],c=t[10],i=t[11],x=t[12],f=t[13],_=t[14],b=t[15],T=n*s-a*u,k=n*h-r*u,L=n*l-g*u,A=a*h-r*s,I=a*l-g*s,P=r*l-g*h,S=o*f-p*x,E=o*_-c*x,z=o*b-i*x,D=p*_-c*f,j=p*b-i*f,V=c*b-i*_,Z=T*V-k*j+L*D+A*z-I*E+P*S;return Z?(Z=1/Z,e[0]=(s*V-h*j+l*D)*Z,e[1]=(r*j-a*V-g*D)*Z,e[2]=(f*P-_*I+b*A)*Z,e[3]=(c*I-p*P-i*A)*Z,e[4]=(h*z-u*V-l*E)*Z,e[5]=(n*V-r*z+g*E)*Z,e[6]=(_*L-x*P-b*k)*Z,e[7]=(o*P-c*L+i*k)*Z,e[8]=(u*j-s*z+l*S)*Z,e[9]=(a*z-n*j-g*S)*Z,e[10]=(x*I-f*L+b*T)*Z,e[11]=(p*L-o*I-i*T)*Z,e[12]=(s*E-u*D-h*S)*Z,e[13]=(n*D-a*E+r*S)*Z,e[14]=(f*k-x*A-_*T)*Z,e[15]=(o*A-p*k+c*T)*Z,e):null}},{}],99:[function(v,w,y){var e=v("./identity");w.exports=function(t,n,a,r){var g,u,s,h,l,o,p,c,i,x,f=n[0],_=n[1],b=n[2],T=r[0],k=r[1],L=r[2],A=a[0],I=a[1],P=a[2];return Math.abs(f-A)<1e-6&&Math.abs(_-I)<1e-6&&Math.abs(b-P)<1e-6?e(t):(p=f-A,c=_-I,i=b-P,x=1/Math.sqrt(p*p+c*c+i*i),g=k*(i*=x)-L*(c*=x),u=L*(p*=x)-T*i,s=T*c-k*p,(x=Math.sqrt(g*g+u*u+s*s))?(g*=x=1/x,u*=x,s*=x):(g=0,u=0,s=0),h=c*s-i*u,l=i*g-p*s,o=p*u-c*g,(x=Math.sqrt(h*h+l*l+o*o))?(h*=x=1/x,l*=x,o*=x):(h=0,l=0,o=0),t[0]=g,t[1]=h,t[2]=p,t[3]=0,t[4]=u,t[5]=l,t[6]=c,t[7]=0,t[8]=s,t[9]=o,t[10]=i,t[11]=0,t[12]=-(g*f+u*_+s*b),t[13]=-(h*f+l*_+o*b),t[14]=-(p*f+c*_+i*b),t[15]=1,t)}},{"./identity":97}],100:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=t[3],s=t[4],h=t[5],l=t[6],o=t[7],p=t[8],c=t[9],i=t[10],x=t[11],f=t[12],_=t[13],b=t[14],T=t[15],k=n[0],L=n[1],A=n[2],I=n[3];return e[0]=k*a+L*s+A*p+I*f,e[1]=k*r+L*h+A*c+I*_,e[2]=k*g+L*l+A*i+I*b,e[3]=k*u+L*o+A*x+I*T,k=n[4],L=n[5],A=n[6],I=n[7],e[4]=k*a+L*s+A*p+I*f,e[5]=k*r+L*h+A*c+I*_,e[6]=k*g+L*l+A*i+I*b,e[7]=k*u+L*o+A*x+I*T,k=n[8],L=n[9],A=n[10],I=n[11],e[8]=k*a+L*s+A*p+I*f,e[9]=k*r+L*h+A*c+I*_,e[10]=k*g+L*l+A*i+I*b,e[11]=k*u+L*o+A*x+I*T,k=n[12],L=n[13],A=n[14],I=n[15],e[12]=k*a+L*s+A*p+I*f,e[13]=k*r+L*h+A*c+I*_,e[14]=k*g+L*l+A*i+I*b,e[15]=k*u+L*o+A*x+I*T,e}},{}],101:[function(v,w,y){w.exports=function(e,t,n,a,r,g,u){var s=1/(t-n),h=1/(a-r),l=1/(g-u);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(r+a)*h,e[14]=(u+g)*l,e[15]=1,e}},{}],102:[function(v,w,y){w.exports=function(e,t,n,a,r){var g=1/Math.tan(t/2),u=1/(a-r);return e[0]=g/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*u,e[15]=0,e}},{}],103:[function(v,w,y){w.exports=function(e,t,n,a){var r,g,u,s,h,l,o,p,c,i,x,f,_,b,T,k,L,A,I,P,S,E,z,D,j=a[0],V=a[1],Z=a[2],Q=Math.sqrt(j*j+V*V+Z*Z);return Math.abs(Q)<1e-6?null:(j*=Q=1/Q,V*=Q,Z*=Q,r=Math.sin(n),g=Math.cos(n),u=1-g,s=t[0],h=t[1],l=t[2],o=t[3],p=t[4],c=t[5],i=t[6],x=t[7],f=t[8],_=t[9],b=t[10],T=t[11],k=j*j*u+g,L=V*j*u+Z*r,A=Z*j*u-V*r,I=j*V*u-Z*r,P=V*V*u+g,S=Z*V*u+j*r,E=j*Z*u+V*r,z=V*Z*u-j*r,D=Z*Z*u+g,e[0]=s*k+p*L+f*A,e[1]=h*k+c*L+_*A,e[2]=l*k+i*L+b*A,e[3]=o*k+x*L+T*A,e[4]=s*I+p*P+f*S,e[5]=h*I+c*P+_*S,e[6]=l*I+i*P+b*S,e[7]=o*I+x*P+T*S,e[8]=s*E+p*z+f*D,e[9]=h*E+c*z+_*D,e[10]=l*E+i*z+b*D,e[11]=o*E+x*z+T*D,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}},{}],104:[function(v,w,y){w.exports=function(e,t,n){var a=Math.sin(n),r=Math.cos(n),g=t[4],u=t[5],s=t[6],h=t[7],l=t[8],o=t[9],p=t[10],c=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*r+l*a,e[5]=u*r+o*a,e[6]=s*r+p*a,e[7]=h*r+c*a,e[8]=l*r-g*a,e[9]=o*r-u*a,e[10]=p*r-s*a,e[11]=c*r-h*a,e}},{}],105:[function(v,w,y){w.exports=function(e,t,n){var a=Math.sin(n),r=Math.cos(n),g=t[0],u=t[1],s=t[2],h=t[3],l=t[8],o=t[9],p=t[10],c=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*r-l*a,e[1]=u*r-o*a,e[2]=s*r-p*a,e[3]=h*r-c*a,e[8]=g*a+l*r,e[9]=u*a+o*r,e[10]=s*a+p*r,e[11]=h*a+c*r,e}},{}],106:[function(v,w,y){w.exports=function(e,t,n){var a=Math.sin(n),r=Math.cos(n),g=t[0],u=t[1],s=t[2],h=t[3],l=t[4],o=t[5],p=t[6],c=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*r+l*a,e[1]=u*r+o*a,e[2]=s*r+p*a,e[3]=h*r+c*a,e[4]=l*r-g*a,e[5]=o*r-u*a,e[6]=p*r-s*a,e[7]=c*r-h*a,e}},{}],107:[function(v,w,y){w.exports=function(e,t,n){var a=n[0],r=n[1],g=n[2];return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],108:[function(v,w,y){w.exports=function(e,t,n){var a,r,g,u,s,h,l,o,p,c,i,x,f=n[0],_=n[1],b=n[2];return t===e?(e[12]=t[0]*f+t[4]*_+t[8]*b+t[12],e[13]=t[1]*f+t[5]*_+t[9]*b+t[13],e[14]=t[2]*f+t[6]*_+t[10]*b+t[14],e[15]=t[3]*f+t[7]*_+t[11]*b+t[15]):(a=t[0],r=t[1],g=t[2],u=t[3],s=t[4],h=t[5],l=t[6],o=t[7],p=t[8],c=t[9],i=t[10],x=t[11],e[0]=a,e[1]=r,e[2]=g,e[3]=u,e[4]=s,e[5]=h,e[6]=l,e[7]=o,e[8]=p,e[9]=c,e[10]=i,e[11]=x,e[12]=a*f+s*_+p*b+t[12],e[13]=r*f+h*_+c*b+t[13],e[14]=g*f+l*_+i*b+t[14],e[15]=u*f+o*_+x*b+t[15]),e}},{}],109:[function(v,w,y){w.exports=function(e,t){if(e===t){var n=t[1],a=t[2],r=t[3],g=t[6],u=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=a,e[9]=g,e[11]=t[14],e[12]=r,e[13]=u,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],110:[function(v,w,y){var e=v("barycentric"),t=v("polytope-closest-point/lib/closest_point_2d.js");function n(g,u){for(var s=[0,0,0,0],h=0;h<4;++h)for(var l=0;l<4;++l)s[l]+=g[4*h+l]*u[h];return s}function a(g,u,s,h,l){for(var o=n(h,n(s,n(u,[g[0],g[1],g[2],1]))),p=0;p<3;++p)o[p]/=o[3];return[.5*l[0]*(1+o[0]),.5*l[1]*(1-o[1])]}function r(g,u){for(var s=[0,0,0],h=0;h<g.length;++h)for(var l=g[h],o=u[h],p=0;p<3;++p)s[p]+=o*l[p];return s}w.exports=function(g,u,s,h,l,o){if(g.length===1)return[0,g[0].slice()];for(var p=new Array(g.length),c=0;c<g.length;++c)p[c]=a(g[c],s,h,l,o);var i=0,x=1/0;for(c=0;c<p.length;++c){for(var f=0,_=0;_<2;++_)f+=Math.pow(p[c][_]-u[_],2);f<x&&(x=f,i=c)}var b=function(k,L){if(k.length===2){for(var A=0,I=0,P=0;P<2;++P)A+=Math.pow(L[P]-k[0][P],2),I+=Math.pow(L[P]-k[1][P],2);return A=Math.sqrt(A),I=Math.sqrt(I),A+I<1e-6?[1,0]:[I/(A+I),A/(I+A)]}if(k.length===3){var S=[0,0];return t(k[0],k[1],k[2],L,S),e(k,S)}return[]}(p,u),T=0;for(c=0;c<3;++c){if(b[c]<-.001||b[c]>1.0001)return null;T+=b[c]}return Math.abs(T-1)>.001?null:[i,r(g,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),g=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),u=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),s=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),h=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),l=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.wireShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.pointShader={vertex:g,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},y.pickShader={vertex:s,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},y.pointPickShader={vertex:l,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},y.contourShader={vertex:o,fragment:p,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("gl-vao"),a=v("gl-texture2d"),r=v("normals"),g=v("gl-mat4/multiply"),u=v("gl-mat4/invert"),s=v("ndarray"),h=v("colormap"),l=v("simplicial-complex-contour"),o=v("typedarray-pool"),p=v("./lib/shaders"),c=v("./lib/closest-point"),i=p.meshShader,x=p.wireShader,f=p.pointShader,_=p.pickShader,b=p.pointPickShader,T=p.contourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function L(V,Z,Q,K,$,ne,H,N,U,te,B,X,J,ee,re,se,oe,de,ce,ve,Ae,fe,me,_e,le,ge,Te){this.gl=V,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Z,this.dirty=!0,this.triShader=Q,this.lineShader=K,this.pointShader=$,this.pickShader=ne,this.pointPickShader=H,this.contourShader=N,this.trianglePositions=U,this.triangleColors=B,this.triangleNormals=J,this.triangleUVs=X,this.triangleIds=te,this.triangleVAO=ee,this.triangleCount=0,this.lineWidth=1,this.edgePositions=re,this.edgeColors=oe,this.edgeUVs=de,this.edgeIds=se,this.edgeVAO=ce,this.edgeCount=0,this.pointPositions=ve,this.pointColors=fe,this.pointUVs=me,this.pointSizes=_e,this.pointIds=Ae,this.pointVAO=le,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=ge,this.contourVAO=Te,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=k,this._view=k,this._projection=k,this._resolution=[1,1]}var A=L.prototype;function I(V,Z){if(!Z||!Z.length)return 1;for(var Q=0;Q<Z.length;++Q){if(Z.length<2)return 1;if(Z[Q][0]===V)return Z[Q][1];if(Z[Q][0]>V&&Q>0){var K=(Z[Q][0]-V)/(Z[Q][0]-Z[Q-1][0]);return Z[Q][1]*(1-K)+K*Z[Q-1][1]}}return 1}function P(V){var Z=e(V,i.vertex,i.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.normal.location=4,Z}function S(V){var Z=e(V,x.vertex,x.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z}function E(V){var Z=e(V,f.vertex,f.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.pointSize.location=4,Z}function z(V){var Z=e(V,_.vertex,_.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z}function D(V){var Z=e(V,b.vertex,b.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z.attributes.pointSize.location=4,Z}function j(V){var Z=e(V,T.vertex,T.fragment);return Z.attributes.position.location=0,Z}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(V){this.pickId=V},A.highlight=function(V){if(V&&this.contourEnable){for(var Z=l(this.cells,this.intensity,V.intensity),Q=Z.cells,K=Z.vertexIds,$=Z.vertexWeights,ne=Q.length,H=o.mallocFloat32(6*ne),N=0,U=0;U<ne;++U)for(var te=Q[U],B=0;B<2;++B){var X=te[0];te.length===2&&(X=te[B]);for(var J=K[X][0],ee=K[X][1],re=$[X],se=1-re,oe=this.positions[J],de=this.positions[ee],ce=0;ce<3;++ce)H[N++]=re*oe[ce]+se*de[ce]}this.contourCount=N/3|0,this.contourPositions.update(H.subarray(0,N)),o.free(H)}else this.contourCount=0},A.update=function(V){V=V||{};var Z=this.gl;this.dirty=!0,"contourEnable"in V&&(this.contourEnable=V.contourEnable),"contourColor"in V&&(this.contourColor=V.contourColor),"lineWidth"in V&&(this.lineWidth=V.lineWidth),"lightPosition"in V&&(this.lightPosition=V.lightPosition),this.hasAlpha=!1,"opacity"in V&&(this.opacity=V.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in V&&(this.opacityscale=V.opacityscale,this.hasAlpha=!0),"ambient"in V&&(this.ambientLight=V.ambient),"diffuse"in V&&(this.diffuseLight=V.diffuse),"specular"in V&&(this.specularLight=V.specular),"roughness"in V&&(this.roughness=V.roughness),"fresnel"in V&&(this.fresnel=V.fresnel),V.texture?(this.texture.dispose(),this.texture=a(Z,V.texture)):V.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Z.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Z.LINEAR,this.texture.setPixels(function(qt,Jt){for(var Wt=h({colormap:qt,nshades:256,format:"rgba"}),ar=new Uint8Array(1024),Dt=0;Dt<256;++Dt){for(var Ne=Wt[Dt],qe=0;qe<3;++qe)ar[4*Dt+qe]=Ne[qe];ar[4*Dt+3]=Jt?255*I(Dt/255,Jt):255*Ne[3]}return s(ar,[256,256,4],[4,0,1])}(V.colormap,this.opacityscale)),this.texture.generateMipmap());var Q=V.cells,K=V.positions;if(K&&Q){var $=[],ne=[],H=[],N=[],U=[],te=[],B=[],X=[],J=[],ee=[],re=[],se=[],oe=[],de=[];this.cells=Q,this.positions=K;var ce=V.vertexNormals,ve=V.cellNormals,Ae=V.vertexNormalsEpsilon===void 0?1e-6:V.vertexNormalsEpsilon,fe=V.faceNormalsEpsilon===void 0?1e-6:V.faceNormalsEpsilon;V.useFacetNormals&&!ve&&(ve=r.faceNormals(Q,K,fe)),ve||ce||(ce=r.vertexNormals(Q,K,Ae));var me=V.vertexColors,_e=V.cellColors,le=V.meshColor||[1,1,1,1],ge=V.vertexUVs,Te=V.vertexIntensity,Se=V.cellUVs,Me=V.cellIntensity,ze=1/0,Oe=-1/0;if(!ge&&!Se)if(Te)if(V.vertexIntensityBounds)ze=+V.vertexIntensityBounds[0],Oe=+V.vertexIntensityBounds[1];else for(var De=0;De<Te.length;++De){var Xe=Te[De];ze=Math.min(ze,Xe),Oe=Math.max(Oe,Xe)}else if(Me)if(V.cellIntensityBounds)ze=+V.cellIntensityBounds[0],Oe=+V.cellIntensityBounds[1];else for(De=0;De<Me.length;++De)Xe=Me[De],ze=Math.min(ze,Xe),Oe=Math.max(Oe,Xe);else for(De=0;De<K.length;++De)Xe=K[De][2],ze=Math.min(ze,Xe),Oe=Math.max(Oe,Xe);this.intensity=Te||Me||function(qt){for(var Jt=qt.length,Wt=new Array(Jt),ar=0;ar<Jt;++ar)Wt[ar]=qt[ar][2];return Wt}(K),this.pickVertex=!(Me||_e);var Be=V.pointSizes,Ie=V.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],De=0;De<K.length;++De)for(var Re=K[De],Ye=0;Ye<3;++Ye)!isNaN(Re[Ye])&&isFinite(Re[Ye])&&(this.bounds[0][Ye]=Math.min(this.bounds[0][Ye],Re[Ye]),this.bounds[1][Ye]=Math.max(this.bounds[1][Ye],Re[Ye]));var Qe=0,lt=0,xt=0;e:for(De=0;De<Q.length;++De){var wt=Q[De];switch(wt.length){case 1:for(Re=K[nt=wt[0]],Ye=0;Ye<3;++Ye)if(isNaN(Re[Ye])||!isFinite(Re[Ye]))continue e;ee.push(Re[0],Re[1],Re[2]),$e=me?me[nt]:_e?_e[De]:le,this.opacityscale&&Te?ne.push($e[0],$e[1],$e[2],this.opacity*I((Te[nt]-ze)/(Oe-ze),this.opacityscale)):$e.length===3?re.push($e[0],$e[1],$e[2],this.opacity):(re.push($e[0],$e[1],$e[2],$e[3]*this.opacity),$e[3]<1&&(this.hasAlpha=!0)),vt=ge?ge[nt]:Te?[(Te[nt]-ze)/(Oe-ze),0]:Se?Se[De]:Me?[(Me[De]-ze)/(Oe-ze),0]:[(Re[2]-ze)/(Oe-ze),0],se.push(vt[0],vt[1]),Be?oe.push(Be[nt]):oe.push(Ie),de.push(De),xt+=1;break;case 2:for(Ye=0;Ye<2;++Ye){Re=K[nt=wt[Ye]];for(var bt=0;bt<3;++bt)if(isNaN(Re[bt])||!isFinite(Re[bt]))continue e}for(Ye=0;Ye<2;++Ye)Re=K[nt=wt[Ye]],te.push(Re[0],Re[1],Re[2]),$e=me?me[nt]:_e?_e[De]:le,this.opacityscale&&Te?ne.push($e[0],$e[1],$e[2],this.opacity*I((Te[nt]-ze)/(Oe-ze),this.opacityscale)):$e.length===3?B.push($e[0],$e[1],$e[2],this.opacity):(B.push($e[0],$e[1],$e[2],$e[3]*this.opacity),$e[3]<1&&(this.hasAlpha=!0)),vt=ge?ge[nt]:Te?[(Te[nt]-ze)/(Oe-ze),0]:Se?Se[De]:Me?[(Me[De]-ze)/(Oe-ze),0]:[(Re[2]-ze)/(Oe-ze),0],X.push(vt[0],vt[1]),J.push(De);lt+=1;break;case 3:for(Ye=0;Ye<3;++Ye)for(Re=K[nt=wt[Ye]],bt=0;bt<3;++bt)if(isNaN(Re[bt])||!isFinite(Re[bt]))continue e;for(Ye=0;Ye<3;++Ye){var nt,$e,vt,Nt;Re=K[nt=wt[2-Ye]],$.push(Re[0],Re[1],Re[2]),($e=me?me[nt]:_e?_e[De]:le)?this.opacityscale&&Te?ne.push($e[0],$e[1],$e[2],this.opacity*I((Te[nt]-ze)/(Oe-ze),this.opacityscale)):$e.length===3?ne.push($e[0],$e[1],$e[2],this.opacity):(ne.push($e[0],$e[1],$e[2],$e[3]*this.opacity),$e[3]<1&&(this.hasAlpha=!0)):ne.push(.5,.5,.5,1),vt=ge?ge[nt]:Te?[(Te[nt]-ze)/(Oe-ze),0]:Se?Se[De]:Me?[(Me[De]-ze)/(Oe-ze),0]:[(Re[2]-ze)/(Oe-ze),0],N.push(vt[0],vt[1]),Nt=ce?ce[nt]:ve[De],H.push(Nt[0],Nt[1],Nt[2]),U.push(De)}Qe+=1}}this.pointCount=xt,this.edgeCount=lt,this.triangleCount=Qe,this.pointPositions.update(ee),this.pointColors.update(re),this.pointUVs.update(se),this.pointSizes.update(oe),this.pointIds.update(new Uint32Array(de)),this.edgePositions.update(te),this.edgeColors.update(B),this.edgeUVs.update(X),this.edgeIds.update(new Uint32Array(J)),this.trianglePositions.update($),this.triangleColors.update(ne),this.triangleUVs.update(N),this.triangleNormals.update(H),this.triangleIds.update(new Uint32Array(U))}},A.drawTransparent=A.draw=function(V){V=V||{};for(var Z=this.gl,Q=V.model||k,K=V.view||k,$=V.projection||k,ne=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)ne[0][H]=Math.max(ne[0][H],this.clipBounds[0][H]),ne[1][H]=Math.min(ne[1][H],this.clipBounds[1][H]);var N={model:Q,view:K,projection:$,inverseModel:k.slice(),clipBounds:ne,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};N.inverseModel=u(N.inverseModel,N.model),Z.disable(Z.CULL_FACE),this.texture.bind(0);var U=new Array(16);for(g(U,N.view,N.model),g(U,N.projection,U),u(U,U),H=0;H<3;++H)N.eyePosition[H]=U[12+H]/U[15];var te,B=U[15];for(H=0;H<3;++H)B+=this.lightPosition[H]*U[4*H+3];for(H=0;H<3;++H){for(var X=U[12+H],J=0;J<3;++J)X+=U[4*J+H]*this.lightPosition[J];N.lightPosition[H]=X/B}this.triangleCount>0&&((te=this.triShader).bind(),te.uniforms=N,this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((te=this.lineShader).bind(),te.uniforms=N,this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((te=this.pointShader).bind(),te.uniforms=N,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((te=this.contourShader).bind(),te.uniforms=N,this.contourVAO.bind(),Z.drawArrays(Z.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(V){V=V||{};for(var Z=this.gl,Q=V.model||k,K=V.view||k,$=V.projection||k,ne=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)ne[0][H]=Math.max(ne[0][H],this.clipBounds[0][H]),ne[1][H]=Math.min(ne[1][H],this.clipBounds[1][H]);this._model=[].slice.call(Q),this._view=[].slice.call(K),this._projection=[].slice.call($),this._resolution=[Z.drawingBufferWidth,Z.drawingBufferHeight];var N,U={model:Q,view:K,projection:$,clipBounds:ne,pickId:this.pickId/255};(N=this.pickShader).bind(),N.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((N=this.pointPickShader).bind(),N.uniforms=U,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(V){if(!V||V.id!==this.pickId)return null;for(var Z=V.value[0]+256*V.value[1]+65536*V.value[2],Q=this.cells[Z],K=this.positions,$=new Array(Q.length),ne=0;ne<Q.length;++ne)$[ne]=K[Q[ne]];var H=V.coord[0],N=V.coord[1];if(!this.pickVertex){var U=this.positions[Q[0]],te=this.positions[Q[1]],B=this.positions[Q[2]],X=[(U[0]+te[0]+B[0])/3,(U[1]+te[1]+B[1])/3,(U[2]+te[2]+B[2])/3];return{_cellCenter:!0,position:[H,N],index:Z,cell:Q,cellId:Z,intensity:this.intensity[Z],dataCoordinate:X}}var J=c($,[H*this.pixelRatio,this._resolution[1]-N*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!J)return null;var ee=J[2],re=0;for(ne=0;ne<Q.length;++ne)re+=ee[ne]*this.intensity[Q[ne]];return{position:J[1],index:Q[J[0]],cell:Q,cellId:Z,intensity:re,dataCoordinate:this.positions[Q[J[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},w.exports=function(V,Z){arguments.length===1&&(V=(Z=V).gl);var Q=V.getExtension("OES_standard_derivatives")||V.getExtension("MOZ_OES_standard_derivatives")||V.getExtension("WEBKIT_OES_standard_derivatives");if(!Q)throw new Error("derivatives not supported");var K=P(V),$=S(V),ne=E(V),H=z(V),N=D(V),U=j(V),te=a(V,s(new Uint8Array([255,255,255,255]),[1,1,4]));te.generateMipmap(),te.minFilter=V.LINEAR_MIPMAP_LINEAR,te.magFilter=V.LINEAR;var B=t(V),X=t(V),J=t(V),ee=t(V),re=t(V),se=n(V,[{buffer:B,type:V.FLOAT,size:3},{buffer:re,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:X,type:V.FLOAT,size:4},{buffer:J,type:V.FLOAT,size:2},{buffer:ee,type:V.FLOAT,size:3}]),oe=t(V),de=t(V),ce=t(V),ve=t(V),Ae=n(V,[{buffer:oe,type:V.FLOAT,size:3},{buffer:ve,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:de,type:V.FLOAT,size:4},{buffer:ce,type:V.FLOAT,size:2}]),fe=t(V),me=t(V),_e=t(V),le=t(V),ge=t(V),Te=n(V,[{buffer:fe,type:V.FLOAT,size:3},{buffer:ge,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:me,type:V.FLOAT,size:4},{buffer:_e,type:V.FLOAT,size:2},{buffer:le,type:V.FLOAT,size:1}]),Se=t(V),Me=n(V,[{buffer:Se,type:V.FLOAT,size:3}]),ze=new L(V,te,K,$,ne,H,N,U,B,re,X,J,ee,se,oe,ve,de,ce,Ae,fe,ge,me,_e,le,Te,Se,Me);return ze.update(Z),ze}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(v,w,y){w.exports=function(s){var h=s.gl,l=e(h,[0,0,0,1,1,0,1,1]),o=t(h,n.boxVert,n.lineFrag);return new a(s,l,o)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("./shaders");function a(s,h,l){this.plot=s,this.vbo=h,this.shader=l}var r,g,u=a.prototype;u.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},u.drawBox=(r=[0,0],g=[0,0],function(s,h,l,o,p){var c=this.plot,i=this.shader,x=c.gl;r[0]=s,r[1]=h,g[0]=l,g[1]=o,i.uniforms.lo=r,i.uniforms.hi=g,i.uniforms.color=p,x.drawArrays(x.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(v,w,y){w.exports=function(c){var i=c.gl,x=e(i),f=t(i,a.gridVert,a.gridFrag),_=t(i,a.tickVert,a.gridFrag);return new r(c,x,f,_)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("binary-search-bounds"),a=v("./shaders");function r(c,i,x,f){this.plot=c,this.vbo=i,this.shader=x,this.tickShader=f,this.ticks=[[],[]]}function g(c,i){return c-i}var u,s,h,l,o,p=r.prototype;p.draw=(u=[0,0],s=[0,0],h=[0,0],function(){for(var c=this.plot,i=this.vbo,x=this.shader,f=this.ticks,_=c.gl,b=c._tickBounds,T=c.dataBox,k=c.viewBox,L=c.gridLineWidth,A=c.gridLineColor,I=c.gridLineEnable,P=c.pixelRatio,S=0;S<2;++S){var E=b[S],z=b[S+2]-E,D=.5*(T[S+2]+T[S]),j=T[S+2]-T[S];s[S]=2*z/j,u[S]=2*(E-D)/j}x.bind(),i.bind(),x.attributes.dataCoord.pointer(),x.uniforms.dataShift=u,x.uniforms.dataScale=s;var V=0;for(S=0;S<2;++S){h[0]=h[1]=0,h[S]=1,x.uniforms.dataAxis=h,x.uniforms.lineWidth=L[S]/(k[S+2]-k[S])*P,x.uniforms.color=A[S];var Z=6*f[S].length;I[S]&&Z&&_.drawArrays(_.TRIANGLES,V,Z),V+=Z}}),p.drawTickMarks=function(){var c=[0,0],i=[0,0],x=[1,0],f=[0,1],_=[0,0],b=[0,0];return function(){for(var T=this.plot,k=this.vbo,L=this.tickShader,A=this.ticks,I=T.gl,P=T._tickBounds,S=T.dataBox,E=T.viewBox,z=T.pixelRatio,D=T.screenBox,j=D[2]-D[0],V=D[3]-D[1],Z=E[2]-E[0],Q=E[3]-E[1],K=0;K<2;++K){var $=P[K],ne=P[K+2]-$,H=.5*(S[K+2]+S[K]),N=S[K+2]-S[K];i[K]=2*ne/N,c[K]=2*($-H)/N}i[0]*=Z/j,c[0]*=Z/j,i[1]*=Q/V,c[1]*=Q/V,L.bind(),k.bind(),L.attributes.dataCoord.pointer();var U=L.uniforms;U.dataShift=c,U.dataScale=i;var te=T.tickMarkLength,B=T.tickMarkWidth,X=T.tickMarkColor,J=6*A[0].length,ee=Math.min(n.ge(A[0],(S[0]-P[0])/(P[2]-P[0]),g),A[0].length),re=Math.min(n.gt(A[0],(S[2]-P[0])/(P[2]-P[0]),g),A[0].length),se=0+6*ee,oe=6*Math.max(0,re-ee),de=Math.min(n.ge(A[1],(S[1]-P[1])/(P[3]-P[1]),g),A[1].length),ce=Math.min(n.gt(A[1],(S[3]-P[1])/(P[3]-P[1]),g),A[1].length),ve=J+6*de,Ae=6*Math.max(0,ce-de);_[0]=2*(E[0]-te[1])/j-1,_[1]=(E[3]+E[1])/V-1,b[0]=te[1]*z/j,b[1]=B[1]*z/V,Ae&&(U.color=X[1],U.tickScale=b,U.dataAxis=f,U.screenOffset=_,I.drawArrays(I.TRIANGLES,ve,Ae)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[1]-te[0])/V-1,b[0]=B[0]*z/j,b[1]=te[0]*z/V,oe&&(U.color=X[0],U.tickScale=b,U.dataAxis=x,U.screenOffset=_,I.drawArrays(I.TRIANGLES,se,oe)),_[0]=2*(E[2]+te[3])/j-1,_[1]=(E[3]+E[1])/V-1,b[0]=te[3]*z/j,b[1]=B[3]*z/V,Ae&&(U.color=X[3],U.tickScale=b,U.dataAxis=f,U.screenOffset=_,I.drawArrays(I.TRIANGLES,ve,Ae)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[3]+te[2])/V-1,b[0]=B[2]*z/j,b[1]=te[2]*z/V,oe&&(U.color=X[2],U.tickScale=b,U.dataAxis=x,U.screenOffset=_,I.drawArrays(I.TRIANGLES,se,oe))}}(),p.update=(l=[1,1,-1,-1,1,-1],o=[1,-1,1,1,-1,-1],function(c){for(var i=c.ticks,x=c.bounds,f=new Float32Array(18*(i[0].length+i[1].length)),_=(this.plot.zeroLineEnable,0),b=[[],[]],T=0;T<2;++T)for(var k=b[T],L=i[T],A=x[T],I=x[T+2],P=0;P<L.length;++P){var S=(L[P].x-A)/(I-A);k.push(S);for(var E=0;E<6;++E)f[_++]=S,f[_++]=l[E],f[_++]=o[E]}this.ticks=b,this.vbo.update(f)}),p.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(v,w,y){w.exports=function(s){var h=s.gl,l=e(h,[-1,-1,-1,1,1,-1,1,1]),o=t(h,n.lineVert,n.lineFrag);return new a(s,l,o)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("./shaders");function a(s,h,l){this.plot=s,this.vbo=h,this.shader=l}var r,g,u=a.prototype;u.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},u.drawLine=(r=[0,0],g=[0,0],function(s,h,l,o,p,c){var i=this.plot,x=this.shader,f=i.gl;r[0]=s,r[1]=h,g[0]=l,g[1]=o,x.uniforms.start=r,x.uniforms.end=g,x.uniforms.width=p*i.pixelRatio,x.uniforms.color=c,f.drawArrays(f.TRIANGLE_STRIP,0,4)}),u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(v,w,y){var e=v("glslify"),t=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);w.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:t,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:t,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:t,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(v,w,y){w.exports=function(i){var x=i.gl,f=e(x),_=t(x,r.textVert,r.textFrag);return new g(i,f,_)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("text-cache"),a=v("binary-search-bounds"),r=v("./shaders");function g(i,x,f){this.plot=i,this.vbo=x,this.shader=f,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var u,s,h,l,o,p,c=g.prototype;c.drawTicks=(u=[0,0],s=[0,0],h=[0,0],function(i){var x=this.plot,f=this.shader,_=this.tickX[i],b=this.tickOffset[i],T=x.gl,k=x.viewBox,L=x.dataBox,A=x.screenBox,I=x.pixelRatio,P=x.tickEnable,S=x.tickPad,E=x.tickColor,z=x.tickAngle,D=x.labelEnable,j=x.labelPad,V=x.labelColor,Z=x.labelAngle,Q=this.labelOffset[i],K=this.labelCount[i],$=a.lt(_,L[i]),ne=a.le(_,L[i+2]);u[0]=u[1]=0,u[i]=1,s[i]=(k[2+i]+k[i])/(A[2+i]-A[i])-1;var H=2/A[2+(1^i)]-A[1^i];s[1^i]=H*k[1^i]-1,P[i]&&(s[1^i]-=H*I*S[i],$<ne&&b[ne]>b[$]&&(f.uniforms.dataAxis=u,f.uniforms.screenOffset=s,f.uniforms.color=E[i],f.uniforms.angle=z[i],T.drawArrays(T.TRIANGLES,b[$],b[ne]-b[$]))),D[i]&&K&&(s[1^i]-=H*I*j[i],f.uniforms.dataAxis=h,f.uniforms.screenOffset=s,f.uniforms.color=V[i],f.uniforms.angle=Z[i],T.drawArrays(T.TRIANGLES,Q,K)),s[1^i]=H*k[2+(1^i)]-1,P[i+2]&&(s[1^i]+=H*I*S[i+2],$<ne&&b[ne]>b[$]&&(f.uniforms.dataAxis=u,f.uniforms.screenOffset=s,f.uniforms.color=E[i+2],f.uniforms.angle=z[i+2],T.drawArrays(T.TRIANGLES,b[$],b[ne]-b[$]))),D[i+2]&&K&&(s[1^i]+=H*I*j[i+2],f.uniforms.dataAxis=h,f.uniforms.screenOffset=s,f.uniforms.color=V[i+2],f.uniforms.angle=Z[i+2],T.drawArrays(T.TRIANGLES,Q,K))}),c.drawTitle=function(){var i=[0,0],x=[0,0];return function(){var f=this.plot,_=this.shader,b=f.gl,T=f.screenBox,k=f.titleCenter,L=f.titleAngle,A=f.titleColor,I=f.pixelRatio;if(this.titleCount){for(var P=0;P<2;++P)x[P]=2*(k[P]*I-T[P])/(T[2+P]-T[P])-1;_.bind(),_.uniforms.dataAxis=i,_.uniforms.screenOffset=x,_.uniforms.angle=L,_.uniforms.color=A,b.drawArrays(b.TRIANGLES,this.titleOffset,this.titleCount)}}}(),c.bind=(l=[0,0],o=[0,0],p=[0,0],function(){var i=this.plot,x=this.shader,f=i._tickBounds,_=i.dataBox,b=i.screenBox,T=i.viewBox;x.bind();for(var k=0;k<2;++k){var L=f[k],A=f[k+2]-L,I=.5*(_[k+2]+_[k]),P=_[k+2]-_[k],S=T[k],E=T[k+2]-S,z=b[k],D=b[k+2]-z;o[k]=2*A/P*E/D,l[k]=2*(L-I)/P*E/D}p[1]=2*i.pixelRatio/(b[3]-b[1]),p[0]=p[1]*(b[3]-b[1])/(b[2]-b[0]),x.uniforms.dataScale=o,x.uniforms.dataShift=l,x.uniforms.textScale=p,this.vbo.bind(),x.attributes.textCoordinate.pointer()}),c.update=function(i){var x,f,_,b,T,k=[],L=i.ticks,A=i.bounds;for(T=0;T<2;++T){var I=[Math.floor(k.length/3)],P=[-1/0],S=L[T];for(x=0;x<S.length;++x){var E=S[x],z=E.x,D=E.text,j=E.font||"sans-serif";b=E.fontSize||12;for(var V=1/(A[T+2]-A[T]),Z=A[T],Q=D.split(`
`),K=0;K<Q.length;K++)for(_=n(j,Q[K]).data,f=0;f<_.length;f+=2)k.push(_[f]*b,-_[f+1]*b-K*b*1.2,(z-Z)*V);I.push(Math.floor(k.length/3)),P.push(z)}this.tickOffset[T]=I,this.tickX[T]=P}for(T=0;T<2;++T){for(this.labelOffset[T]=Math.floor(k.length/3),_=n(i.labelFont[T],i.labels[T],{textAlign:"center"}).data,b=i.labelSize[T],x=0;x<_.length;x+=2)k.push(_[x]*b,-_[x+1]*b,0);this.labelCount[T]=Math.floor(k.length/3)-this.labelOffset[T]}for(this.titleOffset=Math.floor(k.length/3),_=n(i.titleFont,i.title).data,b=i.titleSize,x=0;x<_.length;x+=2)k.push(_[x]*b,-_[x+1]*b,0);this.titleCount=Math.floor(k.length/3)-this.titleOffset,this.vbo.update(k)},c.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(v,w,y){w.exports=function(l){var o=l.gl,p=e(o,[o.drawingBufferWidth,o.drawingBufferHeight]),c=new g(o,p);return c.grid=t(c),c.text=n(c),c.line=a(c),c.box=r(c),c.update(l),c};var e=v("gl-select-static"),t=v("./lib/grid"),n=v("./lib/text"),a=v("./lib/line"),r=v("./lib/box");function g(l,o){this.gl=l,this.pickBuffer=o,this.screenBox=[0,0,l.drawingBufferWidth,l.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var u=g.prototype;function s(l){for(var o=l.slice(),p=0;p<o.length;++p)o[p]=o[p].slice();return o}function h(l,o){return l.x-o.x}u.setDirty=function(){this.dirty=this.pickDirty=!0},u.setOverlayDirty=function(){this.dirty=!0},u.nextDepthValue=function(){return this._depthCounter++/65536},u.draw=function(){var l=this.gl,o=this.screenBox,p=this.viewBox,c=this.dataBox,i=this.pixelRatio,x=this.grid,f=this.line,_=this.text,b=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.enable(l.SCISSOR_TEST),l.disable(l.DEPTH_TEST),l.depthFunc(l.LESS),l.depthMask(!1),l.enable(l.BLEND),l.blendEquation(l.FUNC_ADD,l.FUNC_ADD),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),this.borderColor){l.scissor(o[0],o[1],o[2]-o[0],o[3]-o[1]);var T=this.borderColor;l.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)}l.scissor(p[0],p[1],p[2]-p[0],p[3]-p[1]),l.viewport(p[0],p[1],p[2]-p[0],p[3]-p[1]);var k=this.backgroundColor;l.clearColor(k[0]*k[3],k[1]*k[3],k[2]*k[3],k[3]),l.clear(l.COLOR_BUFFER_BIT),x.draw();var L=this.zeroLineEnable,A=this.zeroLineColor,I=this.zeroLineWidth;if(L[0]||L[1]){f.bind();for(var P=0;P<2;++P)if(L[P]&&c[P]<=0&&c[P+2]>=0){var S=o[P]-c[P]*(o[P+2]-o[P])/(c[P+2]-c[P]);P===0?f.drawLine(S,o[1],S,o[3],I[P],A[P]):f.drawLine(o[0],S,o[2],S,I[P],A[P])}}for(P=0;P<b.length;++P)b[P].draw();l.viewport(o[0],o[1],o[2]-o[0],o[3]-o[1]),l.scissor(o[0],o[1],o[2]-o[0],o[3]-o[1]),this.grid.drawTickMarks(),f.bind();var E=this.borderLineEnable,z=this.borderLineWidth,D=this.borderLineColor;for(E[1]&&f.drawLine(p[0],p[1]-.5*z[1]*i,p[0],p[3]+.5*z[3]*i,z[1],D[1]),E[0]&&f.drawLine(p[0]-.5*z[0]*i,p[1],p[2]+.5*z[2]*i,p[1],z[0],D[0]),E[3]&&f.drawLine(p[2],p[1]-.5*z[1]*i,p[2],p[3]+.5*z[3]*i,z[3],D[3]),E[2]&&f.drawLine(p[0]-.5*z[0]*i,p[3],p[2]+.5*z[2]*i,p[3],z[2],D[2]),_.bind(),P=0;P<2;++P)_.drawTicks(P);this.titleEnable&&_.drawTitle();var j=this.overlays;for(P=0;P<j.length;++P)j[P].draw();l.disable(l.SCISSOR_TEST),l.disable(l.BLEND),l.depthMask(!0)}},u.drawPick=function(){if(!this.static){var l=this.pickBuffer;this.gl,this._pickTimeout=null,l.begin();for(var o=1,p=this.objects,c=0;c<p.length;++c)o=p[c].drawPick(o);l.end()}},u.pick=function(l,o){if(!this.static){var p=this.pixelRatio,c=this.pickPixelRatio,i=this.viewBox,x=0|Math.round((l-i[0]/p)*c),f=0|Math.round((o-i[1]/p)*c),_=this.pickBuffer.query(x,f,this.pickRadius);if(!_)return null;for(var b=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),T=this.objects,k=0;k<T.length;++k){var L=T[k].pick(x,f,b);if(L)return L}return null}},u.setScreenBox=function(l){var o=this.screenBox,p=this.pixelRatio;o[0]=0|Math.round(l[0]*p),o[1]=0|Math.round(l[1]*p),o[2]=0|Math.round(l[2]*p),o[3]=0|Math.round(l[3]*p),this.setDirty()},u.setDataBox=function(l){var o=this.dataBox;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3])&&(o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3],this.setDirty())},u.setViewBox=function(l){var o=this.pixelRatio,p=this.viewBox;p[0]=0|Math.round(l[0]*o),p[1]=0|Math.round(l[1]*o),p[2]=0|Math.round(l[2]*o),p[3]=0|Math.round(l[3]*o);var c=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((l[2]-l[0])*c),0|Math.round((l[3]-l[1])*c)],this.setDirty()},u.update=function(l){l=l||{};var o=this.gl;this.pixelRatio=l.pixelRatio||1;var p=this.pixelRatio;this.pickPixelRatio=Math.max(p,1),this.setScreenBox(l.screenBox||[0,0,o.drawingBufferWidth/p,o.drawingBufferHeight/p]),this.screenBox,this.setViewBox(l.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/p,.125*(this.screenBox[3]-this.screenBox[1])/p,.875*(this.screenBox[2]-this.screenBox[0])/p,.875*(this.screenBox[3]-this.screenBox[1])/p]);var c=this.viewBox,i=(c[2]-c[0])/(c[3]-c[1]);this.setDataBox(l.dataBox||[-10,-10/i,10,10/i]),this.borderColor=l.borderColor!==!1&&(l.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(l.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(l.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(l.gridLineWidth||[1,1]).slice(),this.gridLineColor=s(l.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(l.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(l.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=s(l.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(l.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(l.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=s(l.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(l.titleCenter||[.5*(c[0]+c[2])/p,(c[3]+120)/p]).slice(),this.titleEnable=!("titleEnable"in l)||!!l.titleEnable,this.titleAngle=l.titleAngle||0,this.titleColor=(l.titleColor||[0,0,0,1]).slice(),this.labelPad=(l.labelPad||[15,15,15,15]).slice(),this.labelAngle=(l.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(l.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=s(l.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(l.tickPad||[15,15,15,15]).slice(),this.tickAngle=(l.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(l.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=s(l.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(l.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(l.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=s(l.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var x=l.ticks||[[],[]],f=this._tickBounds;f[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var _=0;_<2;++_){var b=x[_].slice(0);b.length!==0&&(b.sort(h),f[_]=Math.min(f[_],b[0].x),f[_+2]=Math.max(f[_+2],b[b.length-1].x))}this.grid.update({bounds:f,ticks:x}),this.text.update({bounds:f,ticks:x,labels:l.labels||["x","y"],labelSize:l.labelSize||[12,12],labelFont:l.labelFont||["sans-serif","sans-serif"],title:l.title||"",titleSize:l.titleSize||18,titleFont:l.titleFont||"sans-serif"}),this.static=!!l.static,this.setDirty()},u.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var l=this.objects.length-1;l>=0;--l)this.objects[l].dispose();for(this.objects.length=0,l=this.overlays.length-1;l>=0;--l)this.overlays[l].dispose();this.overlays.length=0,this.gl=null},u.addObject=function(l){this.objects.indexOf(l)<0&&(this.objects.push(l),this.setDirty())},u.removeObject=function(l){for(var o=this.objects,p=0;p<o.length;++p)if(o[p]===l){o.splice(p,1),this.setDirty();break}},u.addOverlay=function(l){this.overlays.indexOf(l)<0&&(this.overlays.push(l),this.setOverlayDirty())},u.removeOverlay=function(l){for(var o=this.overlays,p=0;p<o.length;++p)if(o[p]===l){o.splice(p,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(v,w,y){w.exports=function(u,s){u=u||document.body,s=s||{};var h=[.01,1/0];"distanceLimits"in s&&(h[0]=s.distanceLimits[0],h[1]=s.distanceLimits[1]),"zoomMin"in s&&(h[0]=s.zoomMin),"zoomMax"in s&&(h[1]=s.zoomMax);var l=t({center:s.center||[0,0,0],up:s.up||[0,1,0],eye:s.eye||[0,0,10],mode:s.mode||"orbit",distanceLimits:h}),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0,c=u.clientWidth,i=u.clientHeight,x={keyBindingMode:"rotate",enableWheel:!0,view:l,element:u,delay:s.delay||16,rotateSpeed:s.rotateSpeed||1,zoomSpeed:s.zoomSpeed||1,translateSpeed:s.translateSpeed||1,flipX:!!s.flipX,flipY:!!s.flipY,modes:l.modes,_ortho:s._ortho||s.projection&&s.projection.type==="orthographic"||!1,tick:function(){var f=e(),_=this.delay,b=f-2*_;l.idle(f-_),l.recalcMatrix(b),l.flush(f-(100+2*_));for(var T=!0,k=l.computedMatrix,L=0;L<16;++L)T=T&&o[L]===k[L],o[L]=k[L];var A=u.clientWidth===c&&u.clientHeight===i;return c=u.clientWidth,i=u.clientHeight,T?!A:(p=Math.exp(l.computedRadius[0]),!0)},lookAt:function(f,_,b){l.lookAt(l.lastT(),f,_,b)},rotate:function(f,_,b){l.rotate(l.lastT(),f,_,b)},pan:function(f,_,b){l.pan(l.lastT(),f,_,b)},translate:function(f,_,b){l.translate(l.lastT(),f,_,b)}};return Object.defineProperties(x,{matrix:{get:function(){return l.computedMatrix},set:function(f){return l.setMatrix(l.lastT(),f),l.computedMatrix},enumerable:!0},mode:{get:function(){return l.getMode()},set:function(f){var _=l.computedUp.slice(),b=l.computedEye.slice(),T=l.computedCenter.slice();if(l.setMode(f),f==="turntable"){var k=e();l._active.lookAt(k,b,T,_),l._active.lookAt(k+500,b,T,[0,0,1]),l._active.flush(k)}return l.getMode()},enumerable:!0},center:{get:function(){return l.computedCenter},set:function(f){return l.lookAt(l.lastT(),null,f),l.computedCenter},enumerable:!0},eye:{get:function(){return l.computedEye},set:function(f){return l.lookAt(l.lastT(),f),l.computedEye},enumerable:!0},up:{get:function(){return l.computedUp},set:function(f){return l.lookAt(l.lastT(),null,null,f),l.computedUp},enumerable:!0},distance:{get:function(){return p},set:function(f){return l.setDistance(l.lastT(),f),f},enumerable:!0},distanceLimits:{get:function(){return l.getDistanceLimits(h)},set:function(f){return l.setDistanceLimits(f),f},enumerable:!0}}),u.addEventListener("contextmenu",function(f){return f.preventDefault(),!1}),x._lastX=-1,x._lastY=-1,x._lastMods={shift:!1,control:!1,alt:!1,meta:!1},x.enableMouseListeners=function(){function f(_,b,T,k){var L=x.keyBindingMode;if(L!==!1){var A=L==="rotate",I=L==="pan",P=L==="zoom",S=!!k.control,E=!!k.alt,z=!!k.shift,D=!!(1&_),j=!!(2&_),V=!!(4&_),Z=1/u.clientHeight,Q=Z*(b-x._lastX),K=Z*(T-x._lastY),$=x.flipX?1:-1,ne=x.flipY?1:-1,H=Math.PI*x.rotateSpeed,N=e();if(x._lastX!==-1&&x._lastY!==-1&&((A&&D&&!S&&!E&&!z||D&&!S&&!E&&z)&&l.rotate(N,$*H*Q,-ne*H*K,0),(I&&D&&!S&&!E&&!z||j||D&&S&&!E&&!z)&&l.pan(N,-x.translateSpeed*Q*p,x.translateSpeed*K*p,0),P&&D&&!S&&!E&&!z||V||D&&!S&&E&&!z)){var U=-x.zoomSpeed*K/window.innerHeight*(N-l.lastT())*100;l.pan(N,0,0,p*(Math.exp(U)-1))}return x._lastX=b,x._lastY=T,x._lastMods=k,!0}}x.mouseListener=n(u,f),u.addEventListener("touchstart",function(_){var b=r(_.changedTouches[0],u);f(0,b[0],b[1],x._lastMods),f(1,b[0],b[1],x._lastMods)},!!g&&{passive:!0}),u.addEventListener("touchmove",function(_){var b=r(_.changedTouches[0],u);f(1,b[0],b[1],x._lastMods),_.preventDefault()},!!g&&{passive:!1}),u.addEventListener("touchend",function(_){f(0,x._lastX,x._lastY,x._lastMods)},!!g&&{passive:!0}),x.wheelListener=a(u,function(_,b){if(x.keyBindingMode!==!1&&x.enableWheel){var T=x.flipX?1:-1,k=x.flipY?1:-1,L=e();if(Math.abs(_)>Math.abs(b))l.rotate(L,0,0,-_*T*Math.PI*x.rotateSpeed/window.innerWidth);else if(!x._ortho){var A=-x.zoomSpeed*k*b/window.innerHeight*(L-l.lastT())/20;l.pan(L,0,0,p*(Math.exp(A)-1))}}},!0)},x.enableMouseListeners(),x};var e=v("right-now"),t=v("3d-view"),n=v("mouse-change"),a=v("mouse-wheel"),r=v("mouse-event-offset"),g=v("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),a=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);w.exports=function(r){return t(r,n,a,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(v,w,y){var e=v("./camera.js"),t=v("gl-axes3d"),n=v("gl-axes3d/properties"),a=v("gl-spikes3d"),r=v("gl-select-static"),g=v("gl-fbo"),u=v("a-big-triangle"),s=v("mouse-change"),h=v("gl-mat4/perspective"),l=v("gl-mat4/ortho"),o=v("./lib/shader"),p=v("is-mobile")({tablet:!0,featureDetect:!0});function c(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function i(f){var _=Math.round(Math.log(Math.abs(f))/Math.log(10));if(_<0){var b=Math.round(Math.pow(10,-_));return Math.ceil(f*b)/b}return _>0?(b=Math.round(Math.pow(10,_)),Math.ceil(f/b)*b):Math.ceil(f)}function x(f){return typeof f!="boolean"||f}w.exports={createScene:function(f){(f=f||{}).camera=f.camera||{};var _=f.canvas;_||(_=document.createElement("canvas"),f.container?f.container.appendChild(_):document.body.appendChild(_));var b=f.gl;if(b||(f.glOptions&&(p=!!f.glOptions.preserveDrawingBuffer),b=function(ce,ve){var Ae=null;try{(Ae=ce.getContext("webgl",ve))||(Ae=ce.getContext("experimental-webgl",ve))}catch{return null}return Ae}(_,f.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:p})),!b)throw new Error("webgl not supported");var T=f.bounds||[[-10,-10,-10],[10,10,10]],k=new c,L=g(b,b.drawingBufferWidth,b.drawingBufferHeight,{preferFloat:!p}),A=o(b),I=f.cameraObject&&f.cameraObject._ortho===!0||f.camera.projection&&f.camera.projection.type==="orthographic"||!1,P={eye:f.camera.eye||[2,0,0],center:f.camera.center||[0,0,0],up:f.camera.up||[0,1,0],zoomMin:f.camera.zoomMax||.1,zoomMax:f.camera.zoomMin||100,mode:f.camera.mode||"turntable",_ortho:I},S=f.axes||{},E=t(b,S);E.enable=!S.disable;var z=f.spikes||{},D=a(b,z),j=[],V=[],Z=[],Q=[],K=!0,$=!0,ne=new Array(16),H=new Array(16),N={view:null,projection:ne,model:H,_ortho:!1},U=($=!0,[b.drawingBufferWidth,b.drawingBufferHeight]),te=f.cameraObject||e(_,P),B={gl:b,contextLost:!1,pixelRatio:f.pixelRatio||1,canvas:_,selection:k,camera:te,axes:E,axesPixels:null,spikes:D,bounds:T,objects:j,shape:U,aspect:f.aspectRatio||[1,1,1],pickRadius:f.pickRadius||10,zNear:f.zNear||.01,zFar:f.zFar||1e3,fovy:f.fovy||Math.PI/4,clearColor:f.clearColor||[0,0,0,0],autoResize:x(f.autoResize),autoBounds:x(f.autoBounds),autoScale:!!f.autoScale,autoCenter:x(f.autoCenter),clipToBounds:x(f.clipToBounds),snapToData:!!f.snapToData,onselect:f.onselect||null,onrender:f.onrender||null,onclick:f.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ce){this.aspect[0]=ce.x,this.aspect[1]=ce.y,this.aspect[2]=ce.z,$=!0},setBounds:function(ce,ve){this.bounds[0][ce]=ve.min,this.bounds[1][ce]=ve.max},setClearColor:function(ce){this.clearColor=ce},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},X=[b.drawingBufferWidth/B.pixelRatio|0,b.drawingBufferHeight/B.pixelRatio|0];function J(){if(!B._stopped&&B.autoResize){var ce=_.parentNode,ve=1,Ae=1;ce&&ce!==document.body?(ve=ce.clientWidth,Ae=ce.clientHeight):(ve=window.innerWidth,Ae=window.innerHeight);var fe=0|Math.ceil(ve*B.pixelRatio),me=0|Math.ceil(Ae*B.pixelRatio);if(fe!==_.width||me!==_.height){_.width=fe,_.height=me;var _e=_.style;_e.position=_e.position||"absolute",_e.left="0px",_e.top="0px",_e.width=ve+"px",_e.height=Ae+"px",K=!0}}}B.autoResize&&J();function ee(){for(var ce=j.length,ve=Q.length,Ae=0;Ae<ve;++Ae)Z[Ae]=0;e:for(Ae=0;Ae<ce;++Ae){var fe=j[Ae],me=fe.pickSlots;if(me){for(var _e=0;_e<ve;++_e)if(Z[_e]+me<255){V[Ae]=_e,fe.setPickBase(Z[_e]+1),Z[_e]+=me;continue e}var le=r(b,U);V[Ae]=ve,Q.push(le),Z.push(me),fe.setPickBase(1),ve+=1}else V[Ae]=-1}for(;ve>0&&Z[ve-1]===0;)Z.pop(),Q.pop().dispose()}function re(){if(B.contextLost)return!0;b.isContextLost()&&(B.contextLost=!0,B.mouseListener.enabled=!1,B.selection.object=null,B.oncontextloss&&B.oncontextloss())}window.addEventListener("resize",J),B.update=function(ce){B._stopped||(K=!0,$=!0)},B.add=function(ce){B._stopped||(ce.axes=E,j.push(ce),V.push(-1),K=!0,$=!0,ee())},B.remove=function(ce){if(!B._stopped){var ve=j.indexOf(ce);ve<0||(j.splice(ve,1),V.pop(),K=!0,$=!0,ee())}},B.dispose=function(){if(!B._stopped&&(B._stopped=!0,window.removeEventListener("resize",J),_.removeEventListener("webglcontextlost",re),B.mouseListener.enabled=!1,!B.contextLost)){E.dispose(),D.dispose();for(var ce=0;ce<j.length;++ce)j[ce].dispose();for(L.dispose(),ce=0;ce<Q.length;++ce)Q[ce].dispose();A.dispose(),b=null,E=null,D=null,j=[]}},B._mouseRotating=!1,B._prevButtons=0,B.enableMouseListeners=function(){B.mouseListener=s(_,function(ce,ve,Ae){if(!B._stopped){var fe=Q.length,me=j.length,_e=k.object;k.distance=1/0,k.mouse[0]=ve,k.mouse[1]=Ae,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var le=!1;if(ce&&B._prevButtons)B._mouseRotating=!0;else{B._mouseRotating&&($=!0),B._mouseRotating=!1;for(var ge=0;ge<fe;++ge){var Te=Q[ge].query(ve,X[1]-Ae-1,B.pickRadius);if(Te){if(Te.distance>k.distance)continue;for(var Se=0;Se<me;++Se){var Me=j[Se];if(V[Se]===ge){var ze=Me.pick(Te);ze&&(k.buttons=ce,k.screen=Te.coord,k.distance=Te.distance,k.object=Me,k.index=ze.distance,k.dataPosition=ze.position,k.dataCoordinate=ze.dataCoordinate,k.data=ze,le=!0)}}}}}_e&&_e!==k.object&&(_e.highlight&&_e.highlight(null),K=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),K=!0),(le=le||k.object!==_e)&&B.onselect&&B.onselect(k),1&ce&&!(1&B._prevButtons)&&B.onclick&&B.onclick(k),B._prevButtons=ce}})},_.addEventListener("webglcontextlost",re);var se=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],oe=[se[0].slice(),se[1].slice()];function de(){if(!re()){J();var ce=B.camera.tick();N.view=B.camera.matrix,K=K||ce,$=$||ce,E.pixelRatio=B.pixelRatio,D.pixelRatio=B.pixelRatio;var ve=j.length,Ae=se[0],fe=se[1];Ae[0]=Ae[1]=Ae[2]=1/0,fe[0]=fe[1]=fe[2]=-1/0;for(var me=0;me<ve;++me){(Ie=j[me]).pixelRatio=B.pixelRatio,Ie.axes=B.axes,K=K||!!Ie.dirty,$=$||!!Ie.dirty;var _e=Ie.bounds;if(_e)for(var le=_e[0],ge=_e[1],Te=0;Te<3;++Te)Ae[Te]=Math.min(Ae[Te],le[Te]),fe[Te]=Math.max(fe[Te],ge[Te])}var Se=B.bounds;if(B.autoBounds)for(Te=0;Te<3;++Te){if(fe[Te]<Ae[Te])Ae[Te]=-1,fe[Te]=1;else{Ae[Te]===fe[Te]&&(Ae[Te]-=1,fe[Te]+=1);var Me=.05*(fe[Te]-Ae[Te]);Ae[Te]=Ae[Te]-Me,fe[Te]=fe[Te]+Me}Se[0][Te]=Ae[Te],Se[1][Te]=fe[Te]}var ze=!1;for(Te=0;Te<3;++Te)ze=ze||oe[0][Te]!==Se[0][Te]||oe[1][Te]!==Se[1][Te],oe[0][Te]=Se[0][Te],oe[1][Te]=Se[1][Te];if($=$||ze,K=K||ze){if(ze){var Oe=[0,0,0];for(me=0;me<3;++me)Oe[me]=i((Se[1][me]-Se[0][me])/10);E.autoTicks?E.update({bounds:Se,tickSpacing:Oe}):E.update({bounds:Se})}var De=b.drawingBufferWidth,Xe=b.drawingBufferHeight;for(U[0]=De,U[1]=Xe,X[0]=0|Math.max(De/B.pixelRatio,1),X[1]=0|Math.max(Xe/B.pixelRatio,1),function(Re,Ye){var Qe=Re.bounds,lt=Re.cameraParams,xt=lt.projection,wt=lt.model,bt=Re.gl.drawingBufferWidth,nt=Re.gl.drawingBufferHeight,$e=Re.zNear,vt=Re.zFar,Nt=Re.fovy,qt=bt/nt;Ye?(l(xt,-qt,qt,-1,1,$e,vt),lt._ortho=!0):(h(xt,Nt,qt,$e,vt),lt._ortho=!1);for(var Jt=0;Jt<16;++Jt)wt[Jt]=0;wt[15]=1;var Wt=0;for(Jt=0;Jt<3;++Jt)Wt=Math.max(Wt,Qe[1][Jt]-Qe[0][Jt]);for(Jt=0;Jt<3;++Jt)Re.autoScale?wt[5*Jt]=Re.aspect[Jt]/(Qe[1][Jt]-Qe[0][Jt]):wt[5*Jt]=1/Wt,Re.autoCenter&&(wt[12+Jt]=.5*-wt[5*Jt]*(Qe[0][Jt]+Qe[1][Jt]))}(B,I),me=0;me<ve;++me)(Ie=j[me]).axesBounds=Se,B.clipToBounds&&(Ie.clipBounds=Se);k.object&&(B.snapToData?D.position=k.dataCoordinate:D.position=k.dataPosition,D.bounds=Se),$&&($=!1,function(){if(!re()){b.colorMask(!0,!0,!0,!0),b.depthMask(!0),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL);for(var Re=j.length,Ye=Q.length,Qe=0;Qe<Ye;++Qe){var lt=Q[Qe];lt.shape=X,lt.begin();for(var xt=0;xt<Re;++xt)if(V[xt]===Qe){var wt=j[xt];wt.drawPick&&(wt.pixelRatio=1,wt.drawPick(N))}lt.end()}}}()),B.axesPixels=n(B.axes,N,De,Xe),B.onrender&&B.onrender(),b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,De,Xe),B.clearRGBA(),b.depthMask(!0),b.colorMask(!0,!0,!0,!0),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.disable(b.BLEND),b.disable(b.CULL_FACE);var Be=!1;for(E.enable&&(Be=Be||E.isTransparent(),E.draw(N)),D.axes=E,k.object&&D.draw(N),b.disable(b.CULL_FACE),me=0;me<ve;++me)(Ie=j[me]).axes=E,Ie.pixelRatio=B.pixelRatio,Ie.isOpaque&&Ie.isOpaque()&&Ie.draw(N),Ie.isTransparent&&Ie.isTransparent()&&(Be=!0);if(Be){for(L.shape=U,L.bind(),b.clear(b.DEPTH_BUFFER_BIT),b.colorMask(!1,!1,!1,!1),b.depthMask(!0),b.depthFunc(b.LESS),E.enable&&E.isTransparent()&&E.drawTransparent(N),me=0;me<ve;++me)(Ie=j[me]).isOpaque&&Ie.isOpaque()&&Ie.draw(N);for(b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.colorMask(!0,!0,!0,!0),b.depthMask(!1),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),E.isTransparent()&&E.drawTransparent(N),me=0;me<ve;++me){var Ie;(Ie=j[me]).isTransparent&&Ie.isTransparent()&&Ie.drawTransparent(N)}b.bindFramebuffer(b.FRAMEBUFFER,null),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),A.bind(),L.color[0].bind(0),A.uniforms.accumBuffer=0,u(b),b.disable(b.BLEND)}for(K=!1,me=0;me<ve;++me)j[me].dirty=!1}}}return B.enableMouseListeners(),function ce(){B._stopped||B.contextLost||(de(),requestAnimationFrame(ce))}(),B.redraw=function(){B._stopped||(K=!0,de())},B},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(v,w,y){var e=v("glslify");y.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),y.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),y.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),y.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("typedarray-pool"),a=v("./lib/shader");function r(h,l,o,p,c){this.plot=h,this.offsetBuffer=l,this.pickBuffer=o,this.shader=p,this.pickShader=c,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}w.exports=function(h,l){var o=h.gl,p=t(o),c=t(o),i=e(o,a.pointVertex,a.pointFragment),x=e(o,a.pickVertex,a.pickFragment),f=new r(h,p,c,i,x);return f.update(l),h.addObject(f),f};var g,u,s=r.prototype;s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},s.update=function(h){var l;function o(b,T){return b in h?h[b]:T}h=h||{},this.sizeMin=o("sizeMin",.5),this.sizeMax=o("sizeMax",20),this.color=o("color",[1,0,0,1]).slice(),this.areaRatio=o("areaRatio",1),this.borderColor=o("borderColor",[0,0,0,1]).slice(),this.blend=o("blend",!1);var p=h.positions.length>>>1,c=h.positions instanceof Float32Array,i=h.idToIndex instanceof Int32Array&&h.idToIndex.length>=p,x=h.positions,f=c?x:n.mallocFloat32(x.length),_=i?h.idToIndex:n.mallocInt32(p);if(c||f.set(x),!i)for(f.set(x),l=0;l<p;l++)_[l]=l;this.points=x,this.offsetBuffer.update(f),this.pickBuffer.update(_),c||n.free(f),i||n.free(_),this.pointCount=p,this.pickOffset=0},s.unifiedDraw=(g=[1,0,0,0,1,0,0,0,1],u=[0,0,0,0],function(h){var l=h!==void 0,o=l?this.pickShader:this.shader,p=this.plot.gl,c=this.plot.dataBox;if(this.pointCount===0)return h;var i=c[2]-c[0],x=c[3]-c[1],f=function(k,L){var A,I=0,P=k.length>>>1;for(A=0;A<P;A++){var S=k[2*A],E=k[2*A+1];S>=L[0]&&S<=L[2]&&E>=L[1]&&E<=L[3]&&I++}return I}(this.points,c),_=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(f,.33333)));g[0]=2/i,g[4]=2/x,g[6]=-2*c[0]/i-1,g[7]=-2*c[1]/x-1,this.offsetBuffer.bind(),o.bind(),o.attributes.position.pointer(),o.uniforms.matrix=g,o.uniforms.color=this.color,o.uniforms.borderColor=this.borderColor,o.uniforms.pointCloud=_<5,o.uniforms.pointSize=_,o.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),l&&(u[0]=255&h,u[1]=h>>8&255,u[2]=h>>16&255,u[3]=h>>24&255,this.pickBuffer.bind(),o.attributes.pickId.pointer(p.UNSIGNED_BYTE),o.uniforms.pickOffset=u,this.pickOffset=h);var b=p.getParameter(p.BLEND),T=p.getParameter(p.DITHER);return b&&!this.blend&&p.disable(p.BLEND),T&&p.disable(p.DITHER),p.drawArrays(p.POINTS,0,this.pointCount),b&&!this.blend&&p.enable(p.BLEND),T&&p.enable(p.DITHER),h+this.pointCount}),s.draw=s.unifiedDraw,s.drawPick=s.unifiedDraw,s.pick=function(h,l,o){var p=this.pickOffset,c=this.pointCount;if(o<p||o>=p+c)return null;var i=o-p,x=this.points;return{object:this,pointId:i,dataCoord:[x[2*i],x[2*i+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(v,w,y){w.exports=function(e,t,n,a){var r,g,u,s,h,l=t[0],o=t[1],p=t[2],c=t[3],i=n[0],x=n[1],f=n[2],_=n[3];return(g=l*i+o*x+p*f+c*_)<0&&(g=-g,i=-i,x=-x,f=-f,_=-_),1-g>1e-6?(r=Math.acos(g),u=Math.sin(r),s=Math.sin((1-a)*r)/u,h=Math.sin(a*r)/u):(s=1-a,h=a),e[0]=s*l+h*i,e[1]=s*o+h*x,e[2]=s*p+h*f,e[3]=s*c+h*_,e}},{}],125:[function(v,w,y){w.exports=function(e){return e||e===0?e.toString():""}},{}],126:[function(v,w,y){var e=v("vectorize-text");w.exports=function(n,a,r){var g=t[a];if(g||(g=t[a]={}),n in g)return g[n];var u={textAlign:"center",textBaseline:"middle",lineHeight:1,font:a,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},s=e(n,u);u.triangles=!1;var h,l,o=e(n,u);if(r&&r!==1){for(h=0;h<s.positions.length;++h)for(l=0;l<s.positions[h].length;++l)s.positions[h][l]/=r;for(h=0;h<o.positions.length;++h)for(l=0;l<o.positions[h].length;++l)o.positions[h][l]/=r}var p=[[1/0,1/0],[-1/0,-1/0]],c=o.positions.length;for(h=0;h<c;++h){var i=o.positions[h];for(l=0;l<2;++l)p[0][l]=Math.min(p[0][l],i[l]),p[1][l]=Math.max(p[1][l],i[l])}return g[n]=[s,o,p]};var t={}},{"vectorize-text":311}],127:[function(v,w,y){var e=v("gl-shader"),t=v("glslify"),n=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),a=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),g=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),u=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),s=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],h={vertex:n,fragment:g,attributes:s},l={vertex:a,fragment:g,attributes:s},o={vertex:r,fragment:g,attributes:s},p={vertex:n,fragment:u,attributes:s},c={vertex:a,fragment:u,attributes:s},i={vertex:r,fragment:u,attributes:s};function x(f,_){var b=e(f,_),T=b.attributes;return T.position.location=0,T.color.location=1,T.glyph.location=2,T.id.location=3,b}y.createPerspective=function(f){return x(f,h)},y.createOrtho=function(f){return x(f,l)},y.createProject=function(f){return x(f,o)},y.createPickPerspective=function(f){return x(f,p)},y.createPickOrtho=function(f){return x(f,c)},y.createPickProject=function(f){return x(f,i)}},{"gl-shader":132,glslify:231}],128:[function(v,w,y){var e=v("is-string-blank"),t=v("gl-buffer"),n=v("gl-vao"),a=v("typedarray-pool"),r=v("gl-mat4/multiply"),g=v("./lib/shaders"),u=v("./lib/glyphs"),s=v("./lib/get-simple-string"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(Z,Q){var K=Z[0],$=Z[1],ne=Z[2],H=Z[3];return Z[0]=Q[0]*K+Q[4]*$+Q[8]*ne+Q[12]*H,Z[1]=Q[1]*K+Q[5]*$+Q[9]*ne+Q[13]*H,Z[2]=Q[2]*K+Q[6]*$+Q[10]*ne+Q[14]*H,Z[3]=Q[3]*K+Q[7]*$+Q[11]*ne+Q[15]*H,Z}function o(Z,Q,K,$){return l($,$),l($,$),l($,$)}function p(Z,Q){this.index=Z,this.dataCoordinate=this.position=Q}function c(Z){return Z===!0||Z>1?1:Z}function i(Z,Q,K,$,ne,H,N,U,te,B,X,J){this.gl=Z,this.pixelRatio=1,this.shader=Q,this.orthoShader=K,this.projectShader=$,this.pointBuffer=ne,this.colorBuffer=H,this.glyphBuffer=N,this.idBuffer=U,this.vao=te,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=B,this.pickOrthoShader=X,this.pickProjectShader=J,this.points=[],this._selectResult=new p(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}w.exports=function(Z){var Q=Z.gl,K=g.createPerspective(Q),$=g.createOrtho(Q),ne=g.createProject(Q),H=g.createPickPerspective(Q),N=g.createPickOrtho(Q),U=g.createPickProject(Q),te=t(Q),B=t(Q),X=t(Q),J=t(Q),ee=n(Q,[{buffer:te,size:3,type:Q.FLOAT},{buffer:B,size:4,type:Q.FLOAT},{buffer:X,size:2,type:Q.FLOAT},{buffer:J,size:4,type:Q.UNSIGNED_BYTE,normalized:!0}]),re=new i(Q,K,$,ne,te,B,X,J,ee,H,N,U);return re.update(Z),re};var x=i.prototype;x.pickSlots=1,x.setPickBase=function(Z){this.pickId=Z},x.isTransparent=function(){if(this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&this.projectHasAlpha)return!0;return!1},x.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&!this.projectHasAlpha)return!0;return!1};var f=[0,0],_=[0,0,0],b=[0,0,0],T=[0,0,0,1],k=[0,0,0,1],L=h.slice(),A=[0,0,0],I=[[0,0,0],[0,0,0]];function P(Z){return Z[0]=Z[1]=Z[2]=0,Z}function S(Z,Q){return Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[3]=1,Z}function E(Z,Q,K,$){return Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[K]=$,Z}function z(Z,Q,K,$){var ne,H=Q.axesProject,N=Q.gl,U=Z.uniforms,te=K.model||h,B=K.view||h,X=K.projection||h,J=Q.axesBounds,ee=function(Se){for(var Me=I,ze=0;ze<2;++ze)for(var Oe=0;Oe<3;++Oe)Me[ze][Oe]=Math.max(Math.min(Se[ze][Oe],1e8),-1e8);return Me}(Q.clipBounds);ne=Q.axes&&Q.axes.lastCubeProps?Q.axes.lastCubeProps.axis:[1,1,1],f[0]=2/N.drawingBufferWidth,f[1]=2/N.drawingBufferHeight,Z.bind(),U.view=B,U.projection=X,U.screenSize=f,U.highlightId=Q.highlightId,U.highlightScale=Q.highlightScale,U.clipBounds=ee,U.pickGroup=Q.pickId/255,U.pixelRatio=$;for(var re=0;re<3;++re)if(H[re]){U.scale=Q.projectScale[re],U.opacity=Q.projectOpacity[re];for(var se=L,oe=0;oe<16;++oe)se[oe]=0;for(oe=0;oe<4;++oe)se[5*oe]=1;se[5*re]=0,ne[re]<0?se[12+re]=J[0][re]:se[12+re]=J[1][re],r(se,te,se),U.model=se;var de=(re+1)%3,ce=(re+2)%3,ve=P(_),Ae=P(b);ve[de]=1,Ae[ce]=1;var fe=o(0,0,0,S(T,ve)),me=o(0,0,0,S(k,Ae));if(Math.abs(fe[1])>Math.abs(me[1])){var _e=fe;fe=me,me=_e,_e=ve,ve=Ae,Ae=_e;var le=de;de=ce,ce=le}fe[0]<0&&(ve[de]=-1),me[1]>0&&(Ae[ce]=-1);var ge=0,Te=0;for(oe=0;oe<4;++oe)ge+=Math.pow(te[4*de+oe],2),Te+=Math.pow(te[4*ce+oe],2);ve[de]/=Math.sqrt(ge),Ae[ce]/=Math.sqrt(Te),U.axes[0]=ve,U.axes[1]=Ae,U.fragClipBounds[0]=E(A,ee[0],re,-1e8),U.fragClipBounds[1]=E(A,ee[1],re,1e8),Q.vao.bind(),Q.vao.draw(N.TRIANGLES,Q.vertexCount),Q.lineWidth>0&&(N.lineWidth(Q.lineWidth*$),Q.vao.draw(N.LINES,Q.lineVertexCount,Q.vertexCount)),Q.vao.unbind()}}var D=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function j(Z,Q,K,$,ne,H,N){var U=K.gl;if((H===K.projectHasAlpha||N)&&z(Q,K,$,ne),H===K.hasAlpha||N){Z.bind();var te=Z.uniforms;te.model=$.model||h,te.view=$.view||h,te.projection=$.projection||h,f[0]=2/U.drawingBufferWidth,f[1]=2/U.drawingBufferHeight,te.screenSize=f,te.highlightId=K.highlightId,te.highlightScale=K.highlightScale,te.fragClipBounds=D,te.clipBounds=K.axes.bounds,te.opacity=K.opacity,te.pickGroup=K.pickId/255,te.pixelRatio=ne,K.vao.bind(),K.vao.draw(U.TRIANGLES,K.vertexCount),K.lineWidth>0&&(U.lineWidth(K.lineWidth*ne),K.vao.draw(U.LINES,K.lineVertexCount,K.vertexCount)),K.vao.unbind()}}function V(Z,Q,K,$){var ne;ne=Array.isArray(Z)?Q<Z.length?Z[Q]:void 0:Z,ne=s(ne);var H=!0;e(ne)&&(ne="\u25BC",H=!1);var N=u(ne,K,$);return{mesh:N[0],lines:N[1],bounds:N[2],visible:H}}x.draw=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!1,!1)},x.drawTransparent=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!0,!1)},x.drawPick=function(Z){j(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,Z,1,!0,!0)},x.pick=function(Z){if(!Z||Z.id!==this.pickId)return null;var Q=Z.value[2]+(Z.value[1]<<8)+(Z.value[0]<<16);if(Q>=this.pointCount||Q<0)return null;var K=this.points[Q],$=this._selectResult;$.index=Q;for(var ne=0;ne<3;++ne)$.position[ne]=$.dataCoordinate[ne]=K[ne];return $},x.highlight=function(Z){if(Z){var Q=Z.index,K=255&Q,$=Q>>8&255,ne=Q>>16&255;this.highlightId=[K/255,$/255,ne/255,0]}else this.highlightId=[1,1,1,1]},x.update=function(Z){if("perspective"in(Z=Z||{})&&(this.useOrtho=!Z.perspective),"orthographic"in Z&&(this.useOrtho=!!Z.orthographic),"lineWidth"in Z&&(this.lineWidth=Z.lineWidth),"project"in Z)if(Array.isArray(Z.project))this.axesProject=Z.project;else{var Q=!!Z.project;this.axesProject=[Q,Q,Q]}if("projectScale"in Z)if(Array.isArray(Z.projectScale))this.projectScale=Z.projectScale.slice();else{var K=+Z.projectScale;this.projectScale=[K,K,K]}if(this.projectHasAlpha=!1,"projectOpacity"in Z){Array.isArray(Z.projectOpacity)?this.projectOpacity=Z.projectOpacity.slice():(K=+Z.projectOpacity,this.projectOpacity=[K,K,K]);for(var $=0;$<3;++$)this.projectOpacity[$]=c(this.projectOpacity[$]),this.projectOpacity[$]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Z&&(this.opacity=c(Z.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var ne,H,N=Z.position,U=Z.font||"normal",te=Z.alignment||[0,0];if(te.length===2)ne=te[0],H=te[1];else for(ne=[],H=[],$=0;$<te.length;++$)ne[$]=te[$][0],H[$]=te[$][1];var B=[1/0,1/0,1/0],X=[-1/0,-1/0,-1/0],J=Z.glyph,ee=Z.color,re=Z.size,se=Z.angle,oe=Z.lineColor,de=-1,ce=0,ve=0,Ae=0;if(N.length){Ae=N.length;e:for($=0;$<Ae;++$){for(var fe=N[$],me=0;me<3;++me)if(isNaN(fe[me])||!isFinite(fe[me]))continue e;var _e=(Qe=V(J,$,U,this.pixelRatio)).mesh,le=Qe.lines,ge=Qe.bounds;ce+=3*_e.cells.length,ve+=2*le.edges.length}}var Te=ce+ve,Se=a.mallocFloat(3*Te),Me=a.mallocFloat(4*Te),ze=a.mallocFloat(2*Te),Oe=a.mallocUint32(Te);if(Te>0){var De=0,Xe=ce,Be=[0,0,0,1],Ie=[0,0,0,1],Re=Array.isArray(ee)&&Array.isArray(ee[0]),Ye=Array.isArray(oe)&&Array.isArray(oe[0]);e:for($=0;$<Ae;++$){for(de+=1,fe=N[$],me=0;me<3;++me){if(isNaN(fe[me])||!isFinite(fe[me]))continue e;X[me]=Math.max(X[me],fe[me]),B[me]=Math.min(B[me],fe[me])}_e=(Qe=V(J,$,U,this.pixelRatio)).mesh,le=Qe.lines,ge=Qe.bounds;var Qe,lt=Qe.visible;if(lt)if(Array.isArray(ee)){if((xt=Re?$<ee.length?ee[$]:[0,0,0,0]:ee).length===3){for(me=0;me<3;++me)Be[me]=xt[me];Be[3]=1}else if(xt.length===4){for(me=0;me<4;++me)Be[me]=xt[me];!this.hasAlpha&&xt[3]<1&&(this.hasAlpha=!0)}}else Be[0]=Be[1]=Be[2]=0,Be[3]=1;else Be=[1,1,1,0];if(lt)if(Array.isArray(oe)){var xt;if((xt=Ye?$<oe.length?oe[$]:[0,0,0,0]:oe).length===3){for(me=0;me<3;++me)Ie[me]=xt[me];Ie[me]=1}else if(xt.length===4){for(me=0;me<4;++me)Ie[me]=xt[me];!this.hasAlpha&&xt[3]<1&&(this.hasAlpha=!0)}}else Ie[0]=Ie[1]=Ie[2]=0,Ie[3]=1;else Ie=[1,1,1,0];var wt=.5;lt?Array.isArray(re)?wt=$<re.length?+re[$]:12:re?wt=+re:this.useOrtho&&(wt=12):wt=0;var bt=0;Array.isArray(se)?bt=$<se.length?+se[$]:0:se&&(bt=+se);var nt=Math.cos(bt),$e=Math.sin(bt);for(fe=N[$],me=0;me<3;++me)X[me]=Math.max(X[me],fe[me]),B[me]=Math.min(B[me],fe[me]);var vt=ne,Nt=H;vt=0,Array.isArray(ne)?vt=$<ne.length?ne[$]:0:ne&&(vt=ne),Nt=0,Array.isArray(H)?Nt=$<H.length?H[$]:0:H&&(Nt=H);var qt=[vt*=vt>0?1-ge[0][0]:vt<0?1+ge[1][0]:1,Nt*=Nt>0?1-ge[0][1]:Nt<0?1+ge[1][1]:1],Jt=_e.cells||[],Wt=_e.positions||[];for(me=0;me<Jt.length;++me)for(var ar=Jt[me],Dt=0;Dt<3;++Dt){for(var Ne=0;Ne<3;++Ne)Se[3*De+Ne]=fe[Ne];for(Ne=0;Ne<4;++Ne)Me[4*De+Ne]=Be[Ne];Oe[De]=de;var qe=Wt[ar[Dt]];ze[2*De]=wt*(nt*qe[0]-$e*qe[1]+qt[0]),ze[2*De+1]=wt*($e*qe[0]+nt*qe[1]+qt[1]),De+=1}for(Jt=le.edges,Wt=le.positions,me=0;me<Jt.length;++me)for(ar=Jt[me],Dt=0;Dt<2;++Dt){for(Ne=0;Ne<3;++Ne)Se[3*Xe+Ne]=fe[Ne];for(Ne=0;Ne<4;++Ne)Me[4*Xe+Ne]=Ie[Ne];Oe[Xe]=de,qe=Wt[ar[Dt]],ze[2*Xe]=wt*(nt*qe[0]-$e*qe[1]+qt[0]),ze[2*Xe+1]=wt*($e*qe[0]+nt*qe[1]+qt[1]),Xe+=1}}}this.bounds=[B,X],this.points=N,this.pointCount=N.length,this.vertexCount=ce,this.lineVertexCount=ve,this.pointBuffer.update(Se),this.colorBuffer.update(Me),this.glyphBuffer.update(ze),this.idBuffer.update(Oe),a.free(Se),a.free(Me),a.free(ze),a.free(Oe)},x.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(v,w,y){var e=v("glslify");y.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),y.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("./lib/shaders");function a(g,u,s){this.plot=g,this.boxBuffer=u,this.boxShader=s,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}w.exports=function(g,u){var s=g.gl,h=t(s,[0,0,0,1,1,0,1,1]),l=e(s,n.boxVertex,n.boxFragment),o=new a(g,h,l);return o.update(u),g.addOverlay(o),o};var r=a.prototype;r.draw=function(){if(this.enabled){var g=this.plot,u=this.selectBox,s=this.borderWidth,h=(this.innerFill,this.innerColor),l=(this.outerFill,this.outerColor),o=this.borderColor,p=g.box,c=g.screenBox,i=g.dataBox,x=g.viewBox,f=g.pixelRatio,_=(u[0]-i[0])*(x[2]-x[0])/(i[2]-i[0])+x[0],b=(u[1]-i[1])*(x[3]-x[1])/(i[3]-i[1])+x[1],T=(u[2]-i[0])*(x[2]-x[0])/(i[2]-i[0])+x[0],k=(u[3]-i[1])*(x[3]-x[1])/(i[3]-i[1])+x[1];if(_=Math.max(_,x[0]),b=Math.max(b,x[1]),T=Math.min(T,x[2]),k=Math.min(k,x[3]),!(T<_||k<b)){p.bind();var L=c[2]-c[0],A=c[3]-c[1];if(this.outerFill&&(p.drawBox(0,0,L,b,l),p.drawBox(0,b,_,k,l),p.drawBox(0,k,L,A,l),p.drawBox(T,b,L,k,l)),this.innerFill&&p.drawBox(_,b,T,k,h),s>0){var I=s*f;p.drawBox(_-I,b-I,T+I,b+I,o),p.drawBox(_-I,k-I,T+I,k+I,o),p.drawBox(_-I,b-I,_+I,k+I,o),p.drawBox(T-I,b-I,T+I,k+I,o)}}}},r.update=function(g){g=g||{},this.innerFill=!!g.innerFill,this.outerFill=!!g.outerFill,this.innerColor=(g.innerColor||[0,0,0,.5]).slice(),this.outerColor=(g.outerColor||[0,0,0,.5]).slice(),this.borderColor=(g.borderColor||[0,0,0,1]).slice(),this.borderWidth=g.borderWidth||0,this.selectBox=(g.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(v,w,y){w.exports=function(s,h){var l=h[0],o=h[1],p=e(s,l,o,{}),c=t.mallocUint8(l*o*4);return new g(s,p,c)};var e=v("gl-fbo"),t=v("typedarray-pool"),n=v("ndarray"),a=v("bit-twiddle").nextPow2;function r(s,h,l,o,p){this.coord=[s,h],this.id=l,this.value=o,this.distance=p}function g(s,h,l){this.gl=s,this.fbo=h,this.buffer=l,this._readTimeout=null;var o=this;this._readCallback=function(){o.gl&&(h.bind(),s.readPixels(0,0,h.shape[0],h.shape[1],s.RGBA,s.UNSIGNED_BYTE,o.buffer),o._readTimeout=null)}}var u=g.prototype;Object.defineProperty(u,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(s){if(this.gl){this.fbo.shape=s;var h=this.fbo.shape[0],l=this.fbo.shape[1];if(l*h*4>this.buffer.length){t.free(this.buffer);for(var o=this.buffer=t.mallocUint8(a(l*h*4)),p=0;p<l*h*4;++p)o[p]=255}return s}}}),u.begin=function(){var s=this.gl;this.shape,s&&(this.fbo.bind(),s.clearColor(1,1,1,1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT))},u.end=function(){var s=this.gl;s&&(s.bindFramebuffer(s.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},u.query=function(s,h,l){if(!this.gl)return null;var o=this.fbo.shape.slice();s|=0,h|=0,typeof l!="number"&&(l=1);var p=0|Math.min(Math.max(s-l,0),o[0]),c=0|Math.min(Math.max(s+l,0),o[0]),i=0|Math.min(Math.max(h-l,0),o[1]),x=0|Math.min(Math.max(h+l,0),o[1]);if(c<=p||x<=i)return null;var f=[c-p,x-i],_=n(this.buffer,[f[0],f[1],4],[4,4*o[0],1],4*(p+o[0]*i)),b=function(L,A,I){for(var P=1e8,S=-1,E=-1,z=L.shape[0],D=L.shape[1],j=0;j<z;j++)for(var V=0;V<D;V++){var Z=L.get(j,V,0),Q=L.get(j,V,1),K=L.get(j,V,2),$=L.get(j,V,3);if(Z<255||Q<255||K<255||$<255){var ne=A-j,H=I-V,N=ne*ne+H*H;N<P&&(P=N,S=j,E=V)}}return[S,E,P]}(_.hi(f[0],f[1],1),l,l),T=b[0],k=b[1];return T<0||Math.pow(this.radius,2)<b[2]?null:new r(T+p|0,k+i|0,_.get(T,k,0),[_.get(T,k,1),_.get(T,k,2),_.get(T,k,3)],Math.sqrt(b[2]))},u.dispose=function(){this.gl&&(this.fbo.dispose(),t.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(v,w,y){var e=v("./lib/create-uniforms"),t=v("./lib/create-attributes"),n=v("./lib/reflect"),a=v("./lib/shader-cache"),r=v("./lib/runtime-reflect"),g=v("./lib/GLError");function u(l){this.gl=l,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var s=u.prototype;function h(l,o){return l.name<o.name?-1:1}s.bind=function(){var l;this.program||this._relink();var o=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),p=this.gl.lastAttribCount;if(o>p)for(l=p;l<o;l++)this.gl.enableVertexAttribArray(l);else if(p>o)for(l=o;l<p;l++)this.gl.disableVertexAttribArray(l);this.gl.lastAttribCount=o,this.gl.useProgram(this.program)},s.dispose=function(){for(var l=this.gl.lastAttribCount,o=0;o<l;o++)this.gl.disableVertexAttribArray(o);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},s.update=function(l,o,p,c){if(!o||arguments.length===1){var i=l;l=i.vertex,o=i.fragment,p=i.uniforms,c=i.attributes}var x=this,f=x.gl,_=x._vref;x._vref=a.shader(f,f.VERTEX_SHADER,l),_&&_.dispose(),x.vertShader=x._vref.shader;var b=this._fref;if(x._fref=a.shader(f,f.FRAGMENT_SHADER,o),b&&b.dispose(),x.fragShader=x._fref.shader,!p||!c){var T=f.createProgram();if(f.attachShader(T,x.fragShader),f.attachShader(T,x.vertShader),f.linkProgram(T),!f.getProgramParameter(T,f.LINK_STATUS)){var k=f.getProgramInfoLog(T);throw new g(k,"Error linking program:"+k)}p=p||r.uniforms(f,T),c=c||r.attributes(f,T),f.deleteProgram(T)}(c=c.slice()).sort(h);var L,A=[],I=[],P=[];for(L=0;L<c.length;++L){var S=c[L];if(S.type.indexOf("mat")>=0){for(var E=0|S.type.charAt(S.type.length-1),z=new Array(E),D=0;D<E;++D)z[D]=P.length,I.push(S.name+"["+D+"]"),typeof S.location=="number"?P.push(S.location+D):Array.isArray(S.location)&&S.location.length===E&&typeof S.location[D]=="number"?P.push(0|S.location[D]):P.push(-1);A.push({name:S.name,type:S.type,locations:z})}else A.push({name:S.name,type:S.type,locations:[P.length]}),I.push(S.name),typeof S.location=="number"?P.push(0|S.location):P.push(-1)}var j=0;for(L=0;L<P.length;++L)if(P[L]<0){for(;P.indexOf(j)>=0;)j+=1;P[L]=j}var V=new Array(p.length);function Z(){x.program=a.program(f,x._vref,x._fref,I,P);for(var Q=0;Q<p.length;++Q)V[Q]=f.getUniformLocation(x.program,p[Q].name)}Z(),x._relink=Z,x.types={uniforms:n(p),attributes:n(c)},x.attributes=t(f,x,A,P),Object.defineProperty(x,"uniforms",e(f,x,p,V))},w.exports=function(l,o,p,c,i){var x=new u(l);return x.update(o,p,c,i),x}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(v,w,y){function e(t,n,a){this.shortMessage=n||"",this.longMessage=a||"",this.rawError=t||"",this.message="gl-shader: "+(n||t||"")+(a?`
`+a:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,w.exports=e},{}],134:[function(v,w,y){w.exports=function(u,s,h,l){for(var o={},p=0,c=h.length;p<c;++p){var i=h[p],x=i.name,f=i.type,_=i.locations;switch(f){case"bool":case"int":case"float":r(u,s,_[0],l,1,o,x);break;default:if(f.indexOf("vec")>=0){if((b=f.charCodeAt(f.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+x+": "+f);r(u,s,_[0],l,b,o,x)}else{if(!(f.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+x+": "+f);var b;if((b=f.charCodeAt(f.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+x+": "+f);g(u,s,_,l,b,o,x)}}}return o};var e=v("./GLError");function t(u,s,h,l,o,p){this._gl=u,this._wrapper=s,this._index=h,this._locations=l,this._dimension=o,this._constFunc=p}var n=t.prototype;n.pointer=function(u,s,h,l){var o=this._gl,p=this._locations[this._index];o.vertexAttribPointer(p,this._dimension,u||o.FLOAT,!!s,h||0,l||0),o.enableVertexAttribArray(p)},n.set=function(u,s,h,l){return this._constFunc(this._locations[this._index],u,s,h,l)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(u){return u!==this._locations[this._index]&&(this._locations[this._index]=0|u,this._wrapper.program=null),0|u}});var a=[function(u,s,h){return h.length===void 0?u.vertexAttrib1f(s,h):u.vertexAttrib1fv(s,h)},function(u,s,h,l){return h.length===void 0?u.vertexAttrib2f(s,h,l):u.vertexAttrib2fv(s,h)},function(u,s,h,l,o){return h.length===void 0?u.vertexAttrib3f(s,h,l,o):u.vertexAttrib3fv(s,h)},function(u,s,h,l,o,p){return h.length===void 0?u.vertexAttrib4f(s,h,l,o,p):u.vertexAttrib4fv(s,h)}];function r(u,s,h,l,o,p,c){var i=a[o],x=new t(u,s,h,l,o,i);Object.defineProperty(p,c,{set:function(f){return u.disableVertexAttribArray(l[h]),i(u,l[h],f),f},get:function(){return x},enumerable:!0})}function g(u,s,h,l,o,p,c){for(var i=new Array(o),x=new Array(o),f=0;f<o;++f)r(u,s,h[f],l,o,i,f),x[f]=i[f];Object.defineProperty(i,"location",{set:function(T){if(Array.isArray(T))for(var k=0;k<o;++k)x[k].location=T[k];else for(k=0;k<o;++k)x[k].location=T+k;return T},get:function(){for(var T=new Array(o),k=0;k<o;++k)T[k]=l[h[k]];return T},enumerable:!0}),i.pointer=function(T,k,L,A){T=T||u.FLOAT,k=!!k,L=L||o*o,A=A||0;for(var I=0;I<o;++I){var P=l[h[I]];u.vertexAttribPointer(P,o,T,k,L,A+I*o),u.enableVertexAttribArray(P)}};var _=new Array(o),b=u["vertexAttrib"+o+"fv"];Object.defineProperty(p,c,{set:function(T){for(var k=0;k<o;++k){var L=l[h[k]];if(u.disableVertexAttribArray(L),Array.isArray(T[0]))b.call(u,L,T[k]);else{for(var A=0;A<o;++A)_[A]=T[o*k+A];b.call(u,L,_)}}return T},get:function(){return i},enumerable:!0})}},{"./GLError":133}],135:[function(v,w,y){var e=v("./reflect"),t=v("./GLError");function n(r){return function(){return r}}function a(r,g){for(var u=new Array(r),s=0;s<r;++s)u[s]=g;return u}w.exports=function(r,g,u,s){function h(c){return function(i){for(var x=function D(j,V){if(typeof V!="object")return[[j,V]];var Z=[];for(var Q in V){var K=V[Q],$=j;parseInt(Q)+""===Q?$+="["+Q+"]":$+="."+Q,typeof K=="object"?Z.push.apply(Z,D($,K)):Z.push([$,K])}return Z}("",c),f=0;f<x.length;++f){var _=x[f],b=_[0],T=_[1];if(s[T]){var k=i;if(typeof b=="string"&&(b.indexOf(".")===0||b.indexOf("[")===0)){var L=b;if(b.indexOf(".")===0&&(L=b.slice(1)),L.indexOf("]")===L.length-1){var A=L.indexOf("["),I=L.slice(0,A),P=L.slice(A+1,L.length-1);k=I?i[I][P]:i[P]}else k=i[L]}var S,E=u[T].type;switch(E){case"bool":case"int":case"sampler2D":case"samplerCube":r.uniform1i(s[T],k);break;case"float":r.uniform1f(s[T],k);break;default:var z=E.indexOf("vec");if(!(0<=z&&z<=1&&E.length===4+z)){if(E.indexOf("mat")===0&&E.length===4){if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+E);r["uniformMatrix"+S+"fv"](s[T],!1,k);break}throw new t("","Unknown uniform data type for "+name+": "+E)}if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new t("","Invalid data type");switch(E.charAt(0)){case"b":case"i":r["uniform"+S+"iv"](s[T],k);break;case"v":r["uniform"+S+"fv"](s[T],k);break;default:throw new t("","Unrecognized data type for vector "+name+": "+E)}}}}}}function l(c,i,x){if(typeof x=="object"){var f=o(x);Object.defineProperty(c,i,{get:n(f),set:h(x),enumerable:!0,configurable:!1})}else s[x]?Object.defineProperty(c,i,{get:(_=x,function(b,T,k){return b.getUniform(T.program,k[_])}),set:h(x),enumerable:!0,configurable:!1}):c[i]=function(b){switch(b){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var T=b.indexOf("vec");if(0<=T&&T<=1&&b.length===4+T){if((k=b.charCodeAt(b.length-1)-48)<2||k>4)throw new t("","Invalid data type");return b.charAt(0)==="b"?a(k,!1):a(k,0)}if(b.indexOf("mat")===0&&b.length===4){var k;if((k=b.charCodeAt(b.length-1)-48)<2||k>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+b);return a(k*k,0)}throw new t("","Unknown uniform data type for "+name+": "+b)}}(u[x].type);var _}function o(c){var i;if(Array.isArray(c)){i=new Array(c.length);for(var x=0;x<c.length;++x)l(i,x,c[x])}else for(var f in i={},c)l(i,f,c[f]);return i}var p=e(u,!0);return{get:n(o(p)),set:h(p),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(v,w,y){w.exports=function(e,t){for(var n={},a=0;a<e.length;++a)for(var r=e[a].name.split("."),g=n,u=0;u<r.length;++u){var s=r[u].split("[");if(s.length>1){s[0]in g||(g[s[0]]=[]),g=g[s[0]];for(var h=1;h<s.length;++h){var l=parseInt(s[h]);h<s.length-1||u<r.length-1?(l in g||(h<s.length-1?g[l]=[]:g[l]={}),g=g[l]):g[l]=t?a:e[a].type}}else u<r.length-1?(s[0]in g||(g[s[0]]={}),g=g[s[0]]):g[s[0]]=t?a:e[a].type}return n}},{}],137:[function(v,w,y){y.uniforms=function(a,r){for(var g=a.getProgramParameter(r,a.ACTIVE_UNIFORMS),u=[],s=0;s<g;++s){var h=a.getActiveUniform(r,s);if(h){var l=n(a,h.type);if(h.size>1)for(var o=0;o<h.size;++o)u.push({name:h.name.replace("[0]","["+o+"]"),type:l});else u.push({name:h.name,type:l})}}return u},y.attributes=function(a,r){for(var g=a.getProgramParameter(r,a.ACTIVE_ATTRIBUTES),u=[],s=0;s<g;++s){var h=a.getActiveAttrib(r,s);h&&u.push({name:h.name,type:n(a,h.type)})}return u};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},t=null;function n(a,r){if(!t){var g=Object.keys(e);t={};for(var u=0;u<g.length;++u){var s=g[u];t[a[s]]=e[s]}}return t[r]}},{}],138:[function(v,w,y){y.shader=function(h,l,o){return s(h).getShaderReference(l,o)},y.program=function(h,l,o,p,c){return s(h).getProgram(l,o,p,c)};var e=v("./GLError"),t=v("gl-format-compiler-error"),n=new(typeof WeakMap>"u"?v("weakmap-shim"):WeakMap),a=0;function r(h,l,o,p,c,i,x){this.id=h,this.src=l,this.type=o,this.shader=p,this.count=i,this.programs=[],this.cache=x}function g(h){this.gl=h,this.shaders=[{},{}],this.programs={}}r.prototype.dispose=function(){if(--this.count==0){for(var h=this.cache,l=h.gl,o=this.programs,p=0,c=o.length;p<c;++p){var i=h.programs[o[p]];i&&(delete h.programs[p],l.deleteProgram(i))}l.deleteShader(this.shader),delete h.shaders[this.type===l.FRAGMENT_SHADER|0][this.src]}};var u=g.prototype;function s(h){var l=n.get(h);return l||(l=new g(h),n.set(h,l)),l}u.getShaderReference=function(h,l){var o=this.gl,p=this.shaders[h===o.FRAGMENT_SHADER|0],c=p[l];if(c&&o.isShader(c.shader))c.count+=1;else{var i=function(x,f,_){var b=x.createShader(f);if(x.shaderSource(b,_),x.compileShader(b),!x.getShaderParameter(b,x.COMPILE_STATUS)){var T=x.getShaderInfoLog(b);try{var k=t(T,_,f)}catch(L){throw console.warn("Failed to format compiler error: "+L),new e(T,`Error compiling shader:
`+T)}throw new e(T,k.short,k.long)}return b}(o,h,l);c=p[l]=new r(a++,l,h,i,[],1,this)}return c},u.getProgram=function(h,l,o,p){var c=[h.id,l.id,o.join(":"),p.join(":")].join("@"),i=this.programs[c];return i&&this.gl.isProgram(i)||(this.programs[c]=i=function(x,f,_,b,T){var k=x.createProgram();x.attachShader(k,f),x.attachShader(k,_);for(var L=0;L<b.length;++L)x.bindAttribLocation(k,T[L],b[L]);if(x.linkProgram(k),!x.getProgramParameter(k,x.LINK_STATUS)){var A=x.getProgramInfoLog(k);throw new e(A,"Error linking program: "+A)}return k}(this.gl,h.shader,l.shader,o,p),h.programs.push(c),l.programs.push(c)),i}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(v,w,y){function e(n){this.plot=n,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}w.exports=function(n,a){var r=new e(n);return r.update(a),n.addOverlay(r),r};var t=e.prototype;t.update=function(n){n=n||{},this.enable=(n.enable||[!0,!0,!1,!1]).slice(),this.width=(n.width||[1,1,1,1]).slice(),this.color=(n.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(a){return a.slice()}),this.center=(n.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},t.draw=function(){var n=this.enable,a=this.width,r=this.color,g=this.center,u=this.plot,s=u.line,h=u.dataBox,l=u.viewBox;if(s.bind(),h[0]<=g[0]&&g[0]<=h[2]&&h[1]<=g[1]&&g[1]<=h[3]){var o=l[0]+(g[0]-h[0])/(h[2]-h[0])*(l[2]-l[0]),p=l[1]+(g[1]-h[1])/(h[3]-h[1])*(l[3]-l[1]);n[0]&&s.drawLine(o,p,l[0],p,a[0],r[0]),n[1]&&s.drawLine(o,p,o,l[1],a[1],r[1]),n[2]&&s.drawLine(o,p,l[2],p,a[2],r[2]),n[3]&&s.drawLine(o,p,o,l[3],a[3],r[3])}},t.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),a=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);w.exports=function(r){return t(r,n,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(v,w,y){var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders/index");w.exports=function(l,o){var p=[];function c(b,T,k,L,A,I){var P=[b,T,k,0,0,0,1];P[L+3]=1,P[L]=A,p.push.apply(p,P),P[6]=-1,p.push.apply(p,P),P[L]=I,p.push.apply(p,P),p.push.apply(p,P),P[6]=1,p.push.apply(p,P),P[L]=A,p.push.apply(p,P)}c(0,0,0,0,0,1),c(0,0,0,1,0,1),c(0,0,0,2,0,1),c(1,0,0,1,-1,1),c(1,0,0,2,-1,1),c(0,1,0,0,-1,1),c(0,1,0,2,-1,1),c(0,0,1,0,-1,1),c(0,0,1,1,-1,1);var i=e(l,p),x=t(l,[{type:l.FLOAT,buffer:i,size:3,offset:0,stride:28},{type:l.FLOAT,buffer:i,size:3,offset:12,stride:28},{type:l.FLOAT,buffer:i,size:1,offset:24,stride:28}]),f=n(l);f.attributes.position.location=0,f.attributes.color.location=1,f.attributes.weight.location=2;var _=new r(l,i,x,f);return _.update(o),_};var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(l,o,p,c){this.gl=l,this.buffer=o,this.vao=p,this.shader=c,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var g=r.prototype,u=[0,0,0],s=[0,0,0],h=[0,0];g.isTransparent=function(){return!1},g.drawTransparent=function(l){},g.draw=function(l){var o=this.gl,p=this.vao,c=this.shader;p.bind(),c.bind();var i,x=l.model||a,f=l.view||a,_=l.projection||a;this.axes&&(i=this.axes.lastCubeProps.axis);for(var b=u,T=s,k=0;k<3;++k)i&&i[k]<0?(b[k]=this.bounds[0][k],T[k]=this.bounds[1][k]):(b[k]=this.bounds[1][k],T[k]=this.bounds[0][k]);for(h[0]=o.drawingBufferWidth,h[1]=o.drawingBufferHeight,c.uniforms.model=x,c.uniforms.view=f,c.uniforms.projection=_,c.uniforms.coordinates=[this.position,b,T],c.uniforms.colors=this.colors,c.uniforms.screenShape=h,k=0;k<3;++k)c.uniforms.lineWidth=this.lineWidth[k]*this.pixelRatio,this.enabled[k]&&(p.draw(o.TRIANGLES,6,6*k),this.drawSides[k]&&p.draw(o.TRIANGLES,12,18+12*k));p.unbind()},g.update=function(l){l&&("bounds"in l&&(this.bounds=l.bounds),"position"in l&&(this.position=l.position),"lineWidth"in l&&(this.lineWidth=l.lineWidth),"colors"in l&&(this.colors=l.colors),"enabled"in l&&(this.enabled=l.enabled),"drawSides"in l&&(this.drawSides=l.drawSides))},g.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},y.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(v,w,y){var e=v("gl-vec3"),t=v("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],a=function(l,o,p,c){for(var i=0,x=0;x<l.length;x++)for(var f=l[x].velocities,_=0;_<f.length;_++)i=Math.max(i,e.length(f[_]));var b=l.map(function(D){return function(j,V,Z,Q){for(var K=j.points,$=j.velocities,ne=j.divergences,H=[],N=[],U=[],te=[],B=[],X=[],J=0,ee=0,re=t.create(),se=t.create(),oe=0;oe<K.length;oe++){var de=K[oe],ce=$[oe],ve=ne[oe];V===0&&(ve=.05*Z),ee=e.length(ce)/Q,re=t.create(),e.copy(re,ce),re[3]=ve;for(var Ae=0;Ae<8;Ae++)B[Ae]=[de[0],de[1],de[2],Ae];if(te.length>0)for(Ae=0;Ae<8;Ae++){var fe=(Ae+1)%8;H.push(te[Ae],B[Ae],B[fe],B[fe],te[fe],te[Ae]),U.push(se,re,re,re,se,se),X.push(J,ee,ee,ee,J,J);var me=H.length;N.push([me-6,me-5,me-4],[me-3,me-2,me-1])}var _e=te;te=B,B=_e;var le=se;se=re,re=le;var ge=J;J=ee,ee=ge}return{positions:H,cells:N,vectors:U,vertexIntensity:X}}(D,p,c,i)}),T=[],k=[],L=[],A=[];for(x=0;x<b.length;x++){var I=b[x],P=T.length;for(T=T.concat(I.positions),L=L.concat(I.vectors),A=A.concat(I.vertexIntensity),_=0;_<I.cells.length;_++){var S=I.cells[_],E=[];k.push(E);for(var z=0;z<S.length;z++)E.push(S[z]+P)}}return{positions:T,cells:k,vectors:L,vertexIntensity:A,colormap:o}},r=function(l,o){var p,c=l.length;for(p=0;p<c;p++){var i=l[p];if(i===o)return p;if(i>o)return p-1}return p},g=function(l,o,p){return l<o?o:l>p?p:l},u=function(l){var o=1/0;l.sort(function(x,f){return x-f});for(var p=l.length,c=1;c<p;c++){var i=Math.abs(l[c]-l[c-1]);i<o&&(o=i)}return o};w.exports=function(l,o){var p=l.startingPositions,c=l.maxLength||1e3,i=l.tubeSize||1,x=l.absoluteTubeSize,f=l.gridFill||"+x+y+z",_={};f.indexOf("-x")!==-1&&(_.reversedX=!0),f.indexOf("-y")!==-1&&(_.reversedY=!0),f.indexOf("-z")!==-1&&(_.reversedZ=!0),_.filled=n.indexOf(f.replace(/-/g,"").replace(/\+/g,""));var b=l.getVelocity||function(oe){return function(de,ce,ve){var Ae=ce.vectors,fe=ce.meshgrid,me=de[0],_e=de[1],le=de[2],ge=fe[0].length,Te=fe[1].length,Se=fe[2].length,Me=r(fe[0],me),ze=r(fe[1],_e),Oe=r(fe[2],le),De=Me+1,Xe=ze+1,Be=Oe+1;if(Me=g(Me,0,ge-1),De=g(De,0,ge-1),ze=g(ze,0,Te-1),Xe=g(Xe,0,Te-1),Oe=g(Oe,0,Se-1),Be=g(Be,0,Se-1),Me<0||ze<0||Oe<0||De>ge-1||Xe>Te-1||Be>Se-1)return e.create();var Ie,Re,Ye,Qe,lt,xt,wt=fe[0][Me],bt=fe[0][De],nt=fe[1][ze],$e=fe[1][Xe],vt=fe[2][Oe],Nt=(me-wt)/(bt-wt),qt=(_e-nt)/($e-nt),Jt=(le-vt)/(fe[2][Be]-vt);switch(isFinite(Nt)||(Nt=.5),isFinite(qt)||(qt=.5),isFinite(Jt)||(Jt=.5),ve.reversedX&&(Me=ge-1-Me,De=ge-1-De),ve.reversedY&&(ze=Te-1-ze,Xe=Te-1-Xe),ve.reversedZ&&(Oe=Se-1-Oe,Be=Se-1-Be),ve.filled){case 5:lt=Oe,xt=Be,Ye=ze*Se,Qe=Xe*Se,Ie=Me*Se*Te,Re=De*Se*Te;break;case 4:lt=Oe,xt=Be,Ie=Me*Se,Re=De*Se,Ye=ze*Se*ge,Qe=Xe*Se*ge;break;case 3:Ye=ze,Qe=Xe,lt=Oe*Te,xt=Be*Te,Ie=Me*Te*Se,Re=De*Te*Se;break;case 2:Ye=ze,Qe=Xe,Ie=Me*Te,Re=De*Te,lt=Oe*Te*ge,xt=Be*Te*ge;break;case 1:Ie=Me,Re=De,lt=Oe*ge,xt=Be*ge,Ye=ze*ge*Se,Qe=Xe*ge*Se;break;default:Ie=Me,Re=De,Ye=ze*ge,Qe=Xe*ge,lt=Oe*ge*Te,xt=Be*ge*Te}var Wt=Ae[Ie+Ye+lt],ar=Ae[Ie+Ye+xt],Dt=Ae[Ie+Qe+lt],Ne=Ae[Ie+Qe+xt],qe=Ae[Re+Ye+lt],pe=Ae[Re+Ye+xt],be=Ae[Re+Qe+lt],Fe=Ae[Re+Qe+xt],Ve=e.create(),Ke=e.create(),Ge=e.create(),ct=e.create();e.lerp(Ve,Wt,qe,Nt),e.lerp(Ke,ar,pe,Nt),e.lerp(Ge,Dt,be,Nt),e.lerp(ct,Ne,Fe,Nt);var st=e.create(),Mt=e.create();e.lerp(st,Ve,Ge,qt),e.lerp(Mt,Ke,ct,qt);var Ot=e.create();return e.lerp(Ot,st,Mt,Jt),Ot}(oe,l,_)},T=l.getDivergence||function(oe,de){var ce=e.create(),ve=1e-4;e.add(ce,oe,[ve,0,0]);var Ae=b(ce);e.subtract(Ae,Ae,de),e.scale(Ae,Ae,1/ve),e.add(ce,oe,[0,ve,0]);var fe=b(ce);e.subtract(fe,fe,de),e.scale(fe,fe,1/ve),e.add(ce,oe,[0,0,ve]);var me=b(ce);return e.subtract(me,me,de),e.scale(me,me,1/ve),e.add(ce,Ae,fe),e.add(ce,ce,me),ce},k=[],L=o[0][0],A=o[0][1],I=o[0][2],P=o[1][0],S=o[1][1],E=o[1][2],z=function(oe){var de=oe[0],ce=oe[1],ve=oe[2];return!(de<L||de>P||ce<A||ce>S||ve<I||ve>E)},D=10*e.distance(o[0],o[1])/c,j=D*D,V=1,Z=0,Q=p.length;Q>1&&(V=function(oe){for(var de=[],ce=[],ve=[],Ae={},fe={},me={},_e=oe.length,le=0;le<_e;le++){var ge=oe[le],Te=ge[0],Se=ge[1],Me=ge[2];Ae[Te]||(de.push(Te),Ae[Te]=!0),fe[Se]||(ce.push(Se),fe[Se]=!0),me[Me]||(ve.push(Me),me[Me]=!0)}var ze=u(de),Oe=u(ce),De=u(ve),Xe=Math.min(ze,Oe,De);return isFinite(Xe)?Xe:1}(p));for(var K=0;K<Q;K++){var $=e.create();e.copy($,p[K]);var ne=[$],H=[],N=b($),U=$;H.push(N);var te=[],B=T($,N),X=e.length(B);isFinite(X)&&X>Z&&(Z=X),te.push(X),k.push({points:ne,velocities:H,divergences:te});for(var J=0;J<100*c&&ne.length<c&&z($);){J++;var ee=e.clone(N),re=e.squaredLength(ee);if(re===0)break;re>j&&e.scale(ee,ee,D/Math.sqrt(re)),e.add(ee,ee,$),N=b(ee),e.squaredDistance(U,ee)-j>-1e-4*j&&(ne.push(ee),U=ee,H.push(N),B=T(ee,N),X=e.length(B),isFinite(X)&&X>Z&&(Z=X),te.push(X)),$=ee}}var se=a(k,l.colormap,Z,V);return x?se.tubeScale=x:(Z===0&&(Z=1),se.tubeScale=.5*i*V/Z),se};var s=v("./lib/shaders"),h=v("gl-cone3d").createMesh;w.exports.createTubeMesh=function(l,o){return h(l,o,{shaders:s,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(v,w,y){var e=v("gl-shader"),t=v("glslify"),n=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),a=t([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),r=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),g=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);y.createShader=function(u){var s=e(u,n,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},y.createPickShader=function(u){var s=e(u,n,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s.attributes.normal.location=2,s},y.createContourShader=function(u){var s=e(u,r,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s},y.createPickContourShader=function(u){var s=e(u,r,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return s.attributes.uv.location=0,s.attributes.f.location=1,s}},{"gl-shader":132,glslify:231}],145:[function(v,w,y){w.exports=function(N){var U=N.gl,te=f(U),B=b(U),X=_(U),J=T(U),ee=t(U),re=n(U,[{buffer:ee,size:4,stride:40,offset:0},{buffer:ee,size:3,stride:40,offset:16},{buffer:ee,size:3,stride:40,offset:28}]),se=t(U),oe=n(U,[{buffer:se,size:4,stride:20,offset:0},{buffer:se,size:1,stride:20,offset:16}]),de=t(U),ce=n(U,[{buffer:de,size:2,type:U.FLOAT}]),ve=a(U,1,256,U.RGBA,U.UNSIGNED_BYTE);ve.minFilter=U.LINEAR,ve.magFilter=U.LINEAR;var Ae=new P(U,[0,0],[[0,0,0],[0,0,0]],te,B,ee,re,ve,X,J,se,oe,de,ce,[0,0,0]),fe={levels:[[],[],[]]};for(var me in N)fe[me]=N[me];return fe.colormap=fe.colormap||"jet",Ae.update(fe),Ae};var e=v("bit-twiddle"),t=v("gl-buffer"),n=v("gl-vao"),a=v("gl-texture2d"),r=v("typedarray-pool"),g=v("colormap"),u=v("ndarray-ops"),s=v("ndarray-pack"),h=v("ndarray"),l=v("surface-nets"),o=v("gl-mat4/multiply"),p=v("gl-mat4/invert"),c=v("binary-search-bounds"),i=v("ndarray-gradient"),x=v("./lib/shaders"),f=x.createShader,_=x.createContourShader,b=x.createPickShader,T=x.createPickContourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function I(N,U,te,B,X){this.position=N,this.index=U,this.uv=te,this.level=B,this.dataCoordinate=X}(function(){for(var N=0;N<3;++N){var U=A[N],te=(N+2)%3;U[(N+1)%3+0]=1,U[te+3]=1,U[N+6]=1}})();function P(N,U,te,B,X,J,ee,re,se,oe,de,ce,ve,Ae,fe){this.gl=N,this.shape=U,this.bounds=te,this.objectOffset=fe,this.intensityBounds=[],this._shader=B,this._pickShader=X,this._coordinateBuffer=J,this._vao=ee,this._colorMap=re,this._contourShader=se,this._contourPickShader=oe,this._contourBuffer=de,this._contourVAO=ce,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new I([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=ve,this._dynamicVAO=Ae,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[h(r.mallocFloat(1024),[0,0]),h(r.mallocFloat(1024),[0,0]),h(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var S=P.prototype;S.genColormap=function(N,U){var te=!1,B=s([g({colormap:N,nshades:256,format:"rgba"}).map(function(X,J){var ee=U?function(re,se){if(!se||!se.length)return 1;for(var oe=0;oe<se.length;++oe){if(se.length<2)return 1;if(se[oe][0]===re)return se[oe][1];if(se[oe][0]>re&&oe>0){var de=(se[oe][0]-re)/(se[oe][0]-se[oe-1][0]);return se[oe][1]*(1-de)+de*se[oe-1][1]}}return 1}(J/255,U):X[3];return ee<1&&(te=!0),[X[0],X[1],X[2],255*ee]})]);return u.divseq(B,255),this.hasAlphaScale=te,B},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(N){this.pickId=N};var E=[0,0,0],z={showSurface:!1,showContour:!1,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function D(N,U){var te,B,X,J=U.axes&&U.axes.lastCubeProps.axis||E,ee=U.showSurface,re=U.showContour;for(te=0;te<3;++te)for(ee=ee||U.surfaceProject[te],B=0;B<3;++B)re=re||U.contourProject[te][B];for(te=0;te<3;++te){var se=z.projections[te];for(B=0;B<16;++B)se[B]=0;for(B=0;B<4;++B)se[5*B]=1;se[5*te]=0,se[12+te]=U.axesBounds[+(J[te]>0)][te],o(se,N.model,se);var oe=z.clipBounds[te];for(X=0;X<2;++X)for(B=0;B<3;++B)oe[X][B]=N.clipBounds[X][B];oe[0][te]=-1e8,oe[1][te]=1e8}return z.showSurface=ee,z.showContour=re,z}var j={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},V=k.slice(),Z=[1,0,0,0,1,0,0,0,1];function Q(N,U){N=N||{};var te=this.gl;te.disable(te.CULL_FACE),this._colorMap.bind(0);var B=j;B.model=N.model||k,B.view=N.view||k,B.projection=N.projection||k,B.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],B.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],B.objectOffset=this.objectOffset,B.contourColor=this.contourColor[0],B.inverseModel=p(B.inverseModel,B.model);for(var X=0;X<2;++X)for(var J=B.clipBounds[X],ee=0;ee<3;++ee)J[ee]=Math.min(Math.max(this.clipBounds[X][ee],-1e8),1e8);B.kambient=this.ambientLight,B.kdiffuse=this.diffuseLight,B.kspecular=this.specularLight,B.roughness=this.roughness,B.fresnel=this.fresnel,B.opacity=this.opacity,B.height=0,B.permutation=Z,B.vertexColor=this.vertexColor;var re=V;for(o(re,B.view,B.model),o(re,B.projection,re),p(re,re),X=0;X<3;++X)B.eyePosition[X]=re[12+X]/re[15];var se=re[15];for(X=0;X<3;++X)se+=this.lightPosition[X]*re[4*X+3];for(X=0;X<3;++X){var oe=re[12+X];for(ee=0;ee<3;++ee)oe+=re[4*ee+X]*this.lightPosition[ee];B.lightPosition[X]=oe/se}var de=D(B,this);if(de.showSurface){for(this._shader.bind(),this._shader.uniforms=B,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(te.TRIANGLES,this._vertexCount),X=0;X<3;++X)this.surfaceProject[X]&&this.vertexCount&&(this._shader.uniforms.model=de.projections[X],this._shader.uniforms.clipBounds=de.clipBounds[X],this._vao.draw(te.TRIANGLES,this._vertexCount));this._vao.unbind()}if(de.showContour){var ce=this._contourShader;B.kambient=1,B.kdiffuse=0,B.kspecular=0,B.opacity=1,ce.bind(),ce.uniforms=B;var ve=this._contourVAO;for(ve.bind(),X=0;X<3;++X)for(ce.uniforms.permutation=A[X],te.lineWidth(this.contourWidth[X]*this.pixelRatio),ee=0;ee<this.contourLevels[X].length;++ee)ee===this.highlightLevel[X]?(ce.uniforms.contourColor=this.highlightColor[X],ce.uniforms.contourTint=this.highlightTint[X]):ee!==0&&ee-1!==this.highlightLevel[X]||(ce.uniforms.contourColor=this.contourColor[X],ce.uniforms.contourTint=this.contourTint[X]),this._contourCounts[X][ee]&&(ce.uniforms.height=this.contourLevels[X][ee],ve.draw(te.LINES,this._contourCounts[X][ee],this._contourOffsets[X][ee]));for(X=0;X<3;++X)for(ce.uniforms.model=de.projections[X],ce.uniforms.clipBounds=de.clipBounds[X],ee=0;ee<3;++ee)if(this.contourProject[X][ee]){ce.uniforms.permutation=A[ee],te.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var Ae=0;Ae<this.contourLevels[ee].length;++Ae)Ae===this.highlightLevel[ee]?(ce.uniforms.contourColor=this.highlightColor[ee],ce.uniforms.contourTint=this.highlightTint[ee]):Ae!==0&&Ae-1!==this.highlightLevel[ee]||(ce.uniforms.contourColor=this.contourColor[ee],ce.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][Ae]&&(ce.uniforms.height=this.contourLevels[ee][Ae],ve.draw(te.LINES,this._contourCounts[ee][Ae],this._contourOffsets[ee][Ae]))}for(ve.unbind(),(ve=this._dynamicVAO).bind(),X=0;X<3;++X)if(this._dynamicCounts[X]!==0)for(ce.uniforms.model=B.model,ce.uniforms.clipBounds=B.clipBounds,ce.uniforms.permutation=A[X],te.lineWidth(this.dynamicWidth[X]*this.pixelRatio),ce.uniforms.contourColor=this.dynamicColor[X],ce.uniforms.contourTint=this.dynamicTint[X],ce.uniforms.height=this.dynamicLevel[X],ve.draw(te.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]),ee=0;ee<3;++ee)this.contourProject[ee][X]&&(ce.uniforms.model=de.projections[ee],ce.uniforms.clipBounds=de.clipBounds[ee],ve.draw(te.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]));ve.unbind()}}S.draw=function(N){return Q.call(this,N,!1)},S.drawTransparent=function(N){return Q.call(this,N,!0)};var K={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function $(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function ne(N){return Array.isArray(N)?N.length===3?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function H(N){if(Array.isArray(N)){if(Array.isArray(N))return[ne(N[0]),ne(N[1]),ne(N[2])];var U=ne(N);return[U.slice(),U.slice(),U.slice()]}}S.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var te=K;te.model=N.model||k,te.view=N.view||k,te.projection=N.projection||k,te.shape=this._field[2].shape,te.pickId=this.pickId/255,te.lowerBound=this.bounds[0],te.upperBound=this.bounds[1],te.objectOffset=this.objectOffset,te.permutation=Z;for(var B=0;B<2;++B)for(var X=te.clipBounds[B],J=0;J<3;++J)X[J]=Math.min(Math.max(this.clipBounds[B][J],-1e8),1e8);var ee=D(te,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=te,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),B=0;B<3;++B)this.surfaceProject[B]&&(this._pickShader.uniforms.model=ee.projections[B],this._pickShader.uniforms.clipBounds=ee.clipBounds[B],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var re=this._contourPickShader;re.bind(),re.uniforms=te;var se=this._contourVAO;for(se.bind(),J=0;J<3;++J)for(U.lineWidth(this.contourWidth[J]*this.pixelRatio),re.uniforms.permutation=A[J],B=0;B<this.contourLevels[J].length;++B)this._contourCounts[J][B]&&(re.uniforms.height=this.contourLevels[J][B],se.draw(U.LINES,this._contourCounts[J][B],this._contourOffsets[J][B]));for(B=0;B<3;++B)for(re.uniforms.model=ee.projections[B],re.uniforms.clipBounds=ee.clipBounds[B],J=0;J<3;++J)if(this.contourProject[B][J]){re.uniforms.permutation=A[J],U.lineWidth(this.contourWidth[J]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[J].length;++oe)this._contourCounts[J][oe]&&(re.uniforms.height=this.contourLevels[J][oe],se.draw(U.LINES,this._contourCounts[J][oe],this._contourOffsets[J][oe]))}se.unbind()}},S.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,te=this._pickResult,B=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,X=Math.floor(B),J=B-X,ee=U[1]*(N.value[1]+(15&N.value[2])/16)/255,re=Math.floor(ee),se=ee-re;X+=1,re+=1;var oe=te.position;oe[0]=oe[1]=oe[2]=0;for(var de=0;de<2;++de)for(var ce=de?J:1-J,ve=0;ve<2;++ve)for(var Ae=X+de,fe=re+ve,me=ce*(ve?se:1-se),_e=0;_e<3;++_e)oe[_e]+=this._field[_e].get(Ae,fe)*me;for(var le=this._pickResult.level,ge=0;ge<3;++ge)if(le[ge]=c.le(this.contourLevels[ge],oe[ge]),le[ge]<0)this.contourLevels[ge].length>0&&(le[ge]=0);else if(le[ge]<this.contourLevels[ge].length-1){var Te=this.contourLevels[ge][le[ge]],Se=this.contourLevels[ge][le[ge]+1];Math.abs(Te-oe[ge])>Math.abs(Se-oe[ge])&&(le[ge]+=1)}for(te.index[0]=J<.5?X:X+1,te.index[1]=se<.5?re:re+1,te.uv[0]=B/U[0],te.uv[1]=ee/U[1],_e=0;_e<3;++_e)te.dataCoordinate[_e]=this._field[_e].get(te.index[0],te.index[1]);return te},S.padField=function(N,U){var te=U.shape.slice(),B=N.shape.slice();u.assign(N.lo(1,1).hi(te[0],te[1]),U),u.assign(N.lo(1).hi(te[0],1),U.hi(te[0],1)),u.assign(N.lo(1,B[1]-1).hi(te[0],1),U.lo(0,te[1]-1).hi(te[0],1)),u.assign(N.lo(0,1).hi(1,te[1]),U.hi(1)),u.assign(N.lo(B[0]-1,1).hi(1,te[1]),U.lo(te[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,B[1]-1,U.get(0,te[1]-1)),N.set(B[0]-1,0,U.get(te[0]-1,0)),N.set(B[0]-1,B[1]-1,U.get(te[0]-1,te[1]-1))},S.update=function(N){N=N||{},this.objectOffset=N.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=$(N.contourWidth,Number)),"showContour"in N&&(this.showContour=$(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=$(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=H(N.contourColor)),"contourProject"in N&&(this.contourProject=$(N.contourProject,function(Kt){return $(Kt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=H(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=$(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=$(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,te=!1;if(U||(U=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in N||"coords"in N){var B=(U.shape[0]+2)*(U.shape[1]+2);B>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(e.nextPow2(B))),this._field[2]=h(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var X=this.shape,J=0;J<2;++J)this._field[2].size>this._field[J].data.length&&(r.freeFloat(this._field[J].data),this._field[J].data=r.mallocFloat(this._field[2].size)),this._field[J]=h(this._field[J].data,[X[0]+2,X[1]+2]);if(N.coords){var ee=N.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(J=0;J<2;++J){var re=ee[J];for(ve=0;ve<2;++ve)if(re.shape[ve]!==X[ve])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[J],re)}}else if(N.ticks){var se=N.ticks;if(!Array.isArray(se)||se.length!==2)throw new Error("gl-surface: invalid ticks");for(J=0;J<2;++J){var oe=se[J];if((Array.isArray(oe)||oe.length)&&(oe=h(oe)),oe.shape[0]!==X[J])throw new Error("gl-surface: invalid tick length");var de=h(oe.data,X);de.stride[J]=oe.stride[0],de.stride[1^J]=0,this.padField(this._field[J],de)}}else{for(J=0;J<2;++J){var ce=[0,0];ce[J]=1,this._field[J]=h(this._field[J].data,[X[0]+2,X[1]+2],ce,0)}this._field[0].set(0,0,0);for(var ve=0;ve<X[0];++ve)this._field[0].set(ve+1,0,ve);for(this._field[0].set(X[0]+1,0,X[0]-1),this._field[1].set(0,0,0),ve=0;ve<X[1];++ve)this._field[1].set(0,ve+1,ve);this._field[1].set(0,X[1]+1,X[1]-1)}var Ae=this._field,fe=h(r.mallocFloat(3*Ae[2].size*2),[3,X[0]+2,X[1]+2,2]);for(J=0;J<3;++J)i(fe.pick(J),Ae[J],"mirror");var me=h(r.mallocFloat(3*Ae[2].size),[X[0]+2,X[1]+2,3]);for(J=0;J<X[0]+2;++J)for(ve=0;ve<X[1]+2;++ve){var _e=fe.get(0,J,ve,0),le=fe.get(0,J,ve,1),ge=fe.get(1,J,ve,0),Te=fe.get(1,J,ve,1),Se=fe.get(2,J,ve,0),Me=fe.get(2,J,ve,1),ze=ge*Me-Te*Se,Oe=Se*le-Me*_e,De=_e*Te-le*ge,Xe=Math.sqrt(ze*ze+Oe*Oe+De*De);Xe<1e-8?(Xe=Math.max(Math.abs(ze),Math.abs(Oe),Math.abs(De)))<1e-8?(De=1,Oe=ze=0,Xe=1):Xe=1/Xe:Xe=1/Math.sqrt(Xe),me.set(J,ve,0,ze*Xe),me.set(J,ve,1,Oe*Xe),me.set(J,ve,2,De*Xe)}r.free(fe.data);var Be=[1/0,1/0,1/0],Ie=[-1/0,-1/0,-1/0],Re=1/0,Ye=-1/0,Qe=(X[0]-1)*(X[1]-1)*6,lt=r.mallocFloat(e.nextPow2(10*Qe)),xt=0,wt=0;for(J=0;J<X[0]-1;++J)e:for(ve=0;ve<X[1]-1;++ve){for(var bt=0;bt<2;++bt)for(var nt=0;nt<2;++nt)for(var $e=0;$e<3;++$e){var vt=this._field[$e].get(1+J+bt,1+ve+nt);if(isNaN(vt)||!isFinite(vt))continue e}for($e=0;$e<6;++$e){var Nt=J+L[$e][0],qt=ve+L[$e][1],Jt=this._field[0].get(Nt+1,qt+1),Wt=this._field[1].get(Nt+1,qt+1);vt=this._field[2].get(Nt+1,qt+1),ze=me.get(Nt+1,qt+1,0),Oe=me.get(Nt+1,qt+1,1),De=me.get(Nt+1,qt+1,2),N.intensity&&(ar=N.intensity.get(Nt,qt));var ar=N.intensity?N.intensity.get(Nt,qt):vt+this.objectOffset[2];lt[xt++]=Nt,lt[xt++]=qt,lt[xt++]=Jt,lt[xt++]=Wt,lt[xt++]=vt,lt[xt++]=0,lt[xt++]=ar,lt[xt++]=ze,lt[xt++]=Oe,lt[xt++]=De,Be[0]=Math.min(Be[0],Jt+this.objectOffset[0]),Be[1]=Math.min(Be[1],Wt+this.objectOffset[1]),Be[2]=Math.min(Be[2],vt+this.objectOffset[2]),Re=Math.min(Re,ar),Ie[0]=Math.max(Ie[0],Jt+this.objectOffset[0]),Ie[1]=Math.max(Ie[1],Wt+this.objectOffset[1]),Ie[2]=Math.max(Ie[2],vt+this.objectOffset[2]),Ye=Math.max(Ye,ar),wt+=1}}for(N.intensityBounds&&(Re=+N.intensityBounds[0],Ye=+N.intensityBounds[1]),J=6;J<xt;J+=10)lt[J]=(lt[J]-Re)/(Ye-Re);this._vertexCount=wt,this._coordinateBuffer.update(lt.subarray(0,xt)),r.freeFloat(lt),r.free(me.data),this.bounds=[Be,Ie],this.intensity=N.intensity||this._field[2],this.intensityBounds[0]===Re&&this.intensityBounds[1]===Ye||(te=!0),this.intensityBounds=[Re,Ye]}if("levels"in N){var Dt=N.levels;for(Dt=Array.isArray(Dt[0])?Dt.slice():[[],[],Dt],J=0;J<3;++J)Dt[J]=Dt[J].slice(),Dt[J].sort(function(Kt,Ht){return Kt-Ht});for(J=0;J<3;++J)for(ve=0;ve<Dt[J].length;++ve)Dt[J][ve]-=this.objectOffset[J];e:for(J=0;J<3;++J){if(Dt[J].length!==this.contourLevels[J].length){te=!0;break}for(ve=0;ve<Dt[J].length;++ve)if(Dt[J][ve]!==this.contourLevels[J][ve]){te=!0;break e}}this.contourLevels=Dt}if(te){Ae=this._field,X=this.shape;for(var Ne=[],qe=0;qe<3;++qe){var pe=this.contourLevels[qe],be=[],Fe=[],Ve=[0,0,0];for(J=0;J<pe.length;++J){var Ke=l(this._field[qe],pe[J]);be.push(Ne.length/5|0),wt=0;e:for(ve=0;ve<Ke.cells.length;++ve){var Ge=Ke.cells[ve];for($e=0;$e<2;++$e){var ct=Ke.positions[Ge[$e]],st=ct[0],Mt=0|Math.floor(st),Ot=st-Mt,it=ct[1],ht=0|Math.floor(it),jt=it-ht,kt=!1;t:for(var Pt=0;Pt<3;++Pt){Ve[Pt]=0;var Ee=(qe+Pt+1)%3;for(bt=0;bt<2;++bt){var Ze=bt?Ot:1-Ot;for(Nt=0|Math.min(Math.max(Mt+bt,0),X[0]),nt=0;nt<2;++nt){var at=nt?jt:1-jt;if(qt=0|Math.min(Math.max(ht+nt,0),X[1]),vt=Pt<2?this._field[Ee].get(Nt,qt):(this.intensity.get(Nt,qt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(vt)||isNaN(vt)){kt=!0;break t}var pt=Ze*at;Ve[Pt]+=pt*vt}}}if(kt){if($e>0){for(var St=0;St<5;++St)Ne.pop();wt-=1}continue e}Ne.push(Ve[0],Ve[1],ct[0],ct[1],Ve[2]),wt+=1}}Fe.push(wt)}this._contourOffsets[qe]=be,this._contourCounts[qe]=Fe}var Ut=r.mallocFloat(Ne.length);for(J=0;J<Ne.length;++J)Ut[J]=Ne[J];this._contourBuffer.update(Ut),r.freeFloat(Ut)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)r.freeFloat(this._field[N].data)},S.highlight=function(N){var U,te;if(!N)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=N.level[U]:this.highlightLevel[U]=-1;for(te=this.snapToData?N.dataCoordinate:N.position,U=0;U<3;++U)te[U]-=this.objectOffset[U];if(this.enableDynamic[0]&&te[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&te[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&te[2]!==this.dynamicLevel[2]){for(var B=0,X=this.shape,J=r.mallocFloat(12*X[0]*X[1]),ee=0;ee<3;++ee)if(this.enableDynamic[ee]){this.dynamicLevel[ee]=te[ee];var re=(ee+1)%3,se=(ee+2)%3,oe=this._field[ee],de=this._field[re],ce=this._field[se],ve=l(oe,te[ee]),Ae=ve.cells,fe=ve.positions;for(this._dynamicOffsets[ee]=B,U=0;U<Ae.length;++U)for(var me=Ae[U],_e=0;_e<2;++_e){var le=fe[me[_e]],ge=+le[0],Te=0|ge,Se=0|Math.min(Te+1,X[0]),Me=ge-Te,ze=1-Me,Oe=+le[1],De=0|Oe,Xe=0|Math.min(De+1,X[1]),Be=Oe-De,Ie=1-Be,Re=ze*Ie,Ye=ze*Be,Qe=Me*Ie,lt=Me*Be,xt=Re*de.get(Te,De)+Ye*de.get(Te,Xe)+Qe*de.get(Se,De)+lt*de.get(Se,Xe),wt=Re*ce.get(Te,De)+Ye*ce.get(Te,Xe)+Qe*ce.get(Se,De)+lt*ce.get(Se,Xe);if(isNaN(xt)||isNaN(wt)){_e&&(B-=1);break}J[2*B+0]=xt,J[2*B+1]=wt,B+=1}this._dynamicCounts[ee]=B-this._dynamicOffsets[ee]}else this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;this._dynamicBuffer.update(J.subarray(0,2*B)),r.freeFloat(J)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(v,w,y){var e=v("ndarray"),t=v("ndarray-ops"),n=v("typedarray-pool");w.exports=function(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(a||u(b),typeof arguments[1]=="number")return x(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return x(b,0|arguments[1][0],0|arguments[1][1],arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var T=arguments[1],k=s(T)?T:T.raw;if(k)return f(b,k,0|T.width,0|T.height,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(T.shape&&T.data&&T.stride)return _(b,T)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var a=null,r=null,g=null;function u(b){a=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],r=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],g=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function s(b){return typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&b instanceof HTMLVideoElement||typeof ImageData<"u"&&b instanceof ImageData}var h=function(b,T){t.muls(b,T,255)};function l(b,T,k){var L=b.gl,A=L.getParameter(L.MAX_TEXTURE_SIZE);if(T<0||T>A||k<0||k>A)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[T,k],b.bind(),L.texImage2D(L.TEXTURE_2D,0,b.format,T,k,0,b.format,b.type,null),b._mipLevels=[0],b}function o(b,T,k,L,A,I){this.gl=b,this.handle=T,this.format=A,this.type=I,this._shape=[k,L],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var P=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return P._wrapS},set:function(z){return P.wrapS=z}},{get:function(){return P._wrapT},set:function(z){return P.wrapT=z}}]),this._wrapVector=S;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return P._shape[0]},set:function(z){return P.width=z}},{get:function(){return P._shape[1]},set:function(z){return P.height=z}}]),this._shapeVector=E}var p=o.prototype;function c(b,T){return b.length===3?T[2]===1&&T[1]===b[0]*b[2]&&T[0]===b[2]:T[0]===1&&T[1]===b[0]}function i(b){var T=b.createTexture();return b.bindTexture(b.TEXTURE_2D,T),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),T}function x(b,T,k,L,A){var I=b.getParameter(b.MAX_TEXTURE_SIZE);if(T<0||T>I||k<0||k>I)throw new Error("gl-texture2d: Invalid texture shape");if(A===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,L,T,k,0,L,A,null),new o(b,P,T,k,L,A)}function f(b,T,k,L,A,I){var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,A,A,I,T),new o(b,P,k,L,A,I)}function _(b,T){var k=T.dtype,L=T.shape.slice(),A=b.getParameter(b.MAX_TEXTURE_SIZE);if(L[0]<0||L[0]>A||L[1]<0||L[1]>A)throw new Error("gl-texture2d: Invalid texture size");var I=c(L,T.stride.slice()),P=0;k==="float32"?P=b.FLOAT:k==="float64"?(P=b.FLOAT,I=!1,k="float32"):k==="uint8"?P=b.UNSIGNED_BYTE:(P=b.UNSIGNED_BYTE,I=!1,k="uint8");var S,E,z=0;if(L.length===2)z=b.LUMINANCE,L=[L[0],L[1],1],T=e(T.data,L,[T.stride[0],T.stride[1],1],T.offset);else{if(L.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(L[2]===1)z=b.ALPHA;else if(L[2]===2)z=b.LUMINANCE_ALPHA;else if(L[2]===3)z=b.RGB;else{if(L[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");z=b.RGBA}}P!==b.FLOAT||b.getExtension("OES_texture_float")||(P=b.UNSIGNED_BYTE,I=!1);var D=T.size;if(I)S=T.offset===0&&T.data.length===D?T.data:T.data.subarray(T.offset,T.offset+D);else{var j=[L[2],L[2]*L[0],1];E=n.malloc(D,k);var V=e(E,L,j,0);k!=="float32"&&k!=="float64"||P!==b.UNSIGNED_BYTE?t.assign(V,T):h(V,T),S=E.subarray(0,D)}var Z=i(b);return b.texImage2D(b.TEXTURE_2D,0,z,L[0],L[1],0,z,P,S),I||n.free(E),new o(b,Z,L[0],L[1],z,P)}Object.defineProperties(p,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var T=this.gl;if(this.type===T.FLOAT&&a.indexOf(b)>=0&&(T.getExtension("OES_texture_float_linear")||(b=T.NEAREST)),r.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var T=this.gl;if(this.type===T.FLOAT&&a.indexOf(b)>=0&&(T.getExtension("OES_texture_float_linear")||(b=T.NEAREST)),r.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var T=this._anisoSamples;if(this._anisoSamples=0|Math.max(b,1),T!==this._anisoSamples){var k=this.gl.getExtension("EXT_texture_filter_anisotropic");k&&this.gl.texParameterf(this.gl.TEXTURE_2D,k.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),g.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),g.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),b.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var T=0;T<2;++T)if(g.indexOf(b[T])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var k=this.gl;return this.bind(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,this._wrapS),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(Array.isArray(b)){if(b.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else b=[0|b,0|b];return l(this,0|b[0],0|b[1]),[0|b[0],0|b[1]]}},width:{get:function(){return this._shape[0]},set:function(b){return l(this,b|=0,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return b|=0,l(this,this._shape[0],b),b}}}),p.bind=function(b){var T=this.gl;return b!==void 0&&T.activeTexture(T.TEXTURE0+(0|b)),T.bindTexture(T.TEXTURE_2D,this.handle),b!==void 0?0|b:T.getParameter(T.ACTIVE_TEXTURE)-T.TEXTURE0},p.dispose=function(){this.gl.deleteTexture(this.handle)},p.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),T=0;b>0;++T,b>>>=1)this._mipLevels.indexOf(T)<0&&this._mipLevels.push(T)},p.setPixels=function(b,T,k,L){var A=this.gl;this.bind(),Array.isArray(T)?(L=k,k=0|T[1],T=0|T[0]):(T=T||0,k=k||0),L=L||0;var I=s(b)?b:b.raw;if(I)this._mipLevels.indexOf(L)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,I),this._mipLevels.push(L)):A.texSubImage2D(A.TEXTURE_2D,L,T,k,this.format,this.type,I);else{if(!(b.shape&&b.stride&&b.data))throw new Error("gl-texture2d: Unsupported data type");if(b.shape.length<2||T+b.shape[1]>this._shape[1]>>>L||k+b.shape[0]>this._shape[0]>>>L||T<0||k<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(P,S,E,z,D,j,V,Z){var Q=Z.dtype,K=Z.shape.slice();if(K.length<2||K.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var $=0,ne=0,H=c(K,Z.stride.slice());if(Q==="float32"?$=P.FLOAT:Q==="float64"?($=P.FLOAT,H=!1,Q="float32"):Q==="uint8"?$=P.UNSIGNED_BYTE:($=P.UNSIGNED_BYTE,H=!1,Q="uint8"),K.length===2)ne=P.LUMINANCE,K=[K[0],K[1],1],Z=e(Z.data,K,[Z.stride[0],Z.stride[1],1],Z.offset);else{if(K.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(K[2]===1)ne=P.ALPHA;else if(K[2]===2)ne=P.LUMINANCE_ALPHA;else if(K[2]===3)ne=P.RGB;else{if(K[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");ne=P.RGBA}K[2]}if(ne!==P.LUMINANCE&&ne!==P.ALPHA||D!==P.LUMINANCE&&D!==P.ALPHA||(ne=D),ne!==D)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var N=Z.size,U=V.indexOf(z)<0;if(U&&V.push(z),$===j&&H)Z.offset===0&&Z.data.length===N?U?P.texImage2D(P.TEXTURE_2D,z,D,K[0],K[1],0,D,j,Z.data):P.texSubImage2D(P.TEXTURE_2D,z,S,E,K[0],K[1],D,j,Z.data):U?P.texImage2D(P.TEXTURE_2D,z,D,K[0],K[1],0,D,j,Z.data.subarray(Z.offset,Z.offset+N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,K[0],K[1],D,j,Z.data.subarray(Z.offset,Z.offset+N));else{var te;te=j===P.FLOAT?n.mallocFloat32(N):n.mallocUint8(N);var B=e(te,K,[K[2],K[2]*K[0],1]);$===P.FLOAT&&j===P.UNSIGNED_BYTE?h(B,Z):t.assign(B,Z),U?P.texImage2D(P.TEXTURE_2D,z,D,K[0],K[1],0,D,j,te.subarray(0,N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,K[0],K[1],D,j,te.subarray(0,N)),j===P.FLOAT?n.freeFloat32(te):n.freeUint8(te)}})(A,T,k,L,this.format,this.type,this._mipLevels,b)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(v,w,y){w.exports=function(e,t,n){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var a=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(n){if(n.length>a)throw new Error("gl-vao: Too many vertex attributes");for(var r=0;r<n.length;++r){var g=n[r];if(g.buffer){var u=g.buffer,s=g.size||4,h=g.type||e.FLOAT,l=!!g.normalized,o=g.stride||0,p=g.offset||0;u.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,s,h,l,o,p)}else{if(typeof g=="number")e.vertexAttrib1f(r,g);else if(g.length===1)e.vertexAttrib1f(r,g[0]);else if(g.length===2)e.vertexAttrib2f(r,g[0],g[1]);else if(g.length===3)e.vertexAttrib3f(r,g[0],g[1],g[2]);else{if(g.length!==4)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(r,g[0],g[1],g[2],g[3])}e.disableVertexAttribArray(r)}}for(;r<a;++r)e.disableVertexAttribArray(r)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),r=0;r<a;++r)e.disableVertexAttribArray(r)}},{}],148:[function(v,w,y){var e=v("./do-bind.js");function t(n){this.gl=n,this._elements=null,this._attributes=null,this._elementsType=n.UNSIGNED_SHORT}t.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},t.prototype.update=function(n,a,r){this._elements=a,this._attributes=n,this._elementsType=r||this.gl.UNSIGNED_SHORT},t.prototype.dispose=function(){},t.prototype.unbind=function(){},t.prototype.draw=function(n,a,r){r=r||0;var g=this.gl;this._elements?g.drawElements(n,a,this._elementsType,r):g.drawArrays(n,r,a)},w.exports=function(n){return new t(n)}},{"./do-bind.js":147}],149:[function(v,w,y){var e=v("./do-bind.js");function t(a,r,g,u,s,h){this.location=a,this.dimension=r,this.a=g,this.b=u,this.c=s,this.d=h}function n(a,r,g){this.gl=a,this._ext=r,this.handle=g,this._attribs=[],this._useElements=!1,this._elementsType=a.UNSIGNED_SHORT}t.prototype.bind=function(a){switch(this.dimension){case 1:a.vertexAttrib1f(this.location,this.a);break;case 2:a.vertexAttrib2f(this.location,this.a,this.b);break;case 3:a.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:a.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var a=0;a<this._attribs.length;++a)this._attribs[a].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(a,r,g){if(this.bind(),e(this.gl,r,a),this.unbind(),this._attribs.length=0,a)for(var u=0;u<a.length;++u){var s=a[u];typeof s=="number"?this._attribs.push(new t(u,1,s)):Array.isArray(s)&&this._attribs.push(new t(u,s.length,s[0],s[1],s[2],s[3]))}this._useElements=!!r,this._elementsType=g||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(a,r,g){g=g||0;var u=this.gl;this._useElements?u.drawElements(a,r,this._elementsType,g):u.drawArrays(a,g,r)},w.exports=function(a,r){return new n(a,r,r.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(v,w,y){var e=v("./lib/vao-native.js"),t=v("./lib/vao-emulated.js");function n(a){this.bindVertexArrayOES=a.bindVertexArray.bind(a),this.createVertexArrayOES=a.createVertexArray.bind(a),this.deleteVertexArrayOES=a.deleteVertexArray.bind(a)}w.exports=function(a,r,g,u){var s,h=a.createVertexArray?new n(a):a.getExtension("OES_vertex_array_object");return(s=h?e(a,h):t(a)).update(r,g,u),s}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],152:[function(v,w,y){w.exports=function(a,r){var g=e(a[0],a[1],a[2]),u=e(r[0],r[1],r[2]);t(g,g),t(u,u);var s=n(g,u);return s>1?0:Math.acos(s)};var e=v("./fromValues"),t=v("./normalize"),n=v("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},{}],154:[function(v,w,y){w.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],155:[function(v,w,y){w.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],156:[function(v,w,y){w.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=n[0],s=n[1],h=n[2];return e[0]=r*h-g*s,e[1]=g*u-a*h,e[2]=a*s-r*u,e}},{}],158:[function(v,w,y){w.exports=v("./distance")},{"./distance":159}],159:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+a*a+r*r)}},{}],160:[function(v,w,y){w.exports=v("./divide")},{"./divide":161}],161:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},{}],162:[function(v,w,y){w.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],163:[function(v,w,y){w.exports=1e-6},{}],164:[function(v,w,y){w.exports=function(t,n){var a=t[0],r=t[1],g=t[2],u=n[0],s=n[1],h=n[2];return Math.abs(a-u)<=e*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-s)<=e*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(g-h)<=e*Math.max(1,Math.abs(g),Math.abs(h))};var e=v("./epsilon")},{"./epsilon":163}],165:[function(v,w,y){w.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],166:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},{}],167:[function(v,w,y){w.exports=function(t,n,a,r,g,u){var s,h;for(n||(n=3),a||(a=0),h=r?Math.min(r*n+a,t.length):t.length,s=a;s<h;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],g(e,e,u),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t};var e=v("./create")()},{"./create":156}],168:[function(v,w,y){w.exports=function(e,t,n){var a=new Float32Array(3);return a[0]=e,a[1]=t,a[2]=n,a}},{}],169:[function(v,w,y){w.exports={EPSILON:v("./epsilon"),create:v("./create"),clone:v("./clone"),angle:v("./angle"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),equals:v("./equals"),exactEquals:v("./exactEquals"),add:v("./add"),subtract:v("./subtract"),sub:v("./sub"),multiply:v("./multiply"),mul:v("./mul"),divide:v("./divide"),div:v("./div"),min:v("./min"),max:v("./max"),floor:v("./floor"),ceil:v("./ceil"),round:v("./round"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),dist:v("./dist"),squaredDistance:v("./squaredDistance"),sqrDist:v("./sqrDist"),length:v("./length"),len:v("./len"),squaredLength:v("./squaredLength"),sqrLen:v("./sqrLen"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),cross:v("./cross"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformMat3:v("./transformMat3"),transformQuat:v("./transformQuat"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),forEach:v("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(v,w,y){w.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],171:[function(v,w,y){w.exports=v("./length")},{"./length":172}],172:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],a=e[2];return Math.sqrt(t*t+n*n+a*a)}},{}],173:[function(v,w,y){w.exports=function(e,t,n,a){var r=t[0],g=t[1],u=t[2];return e[0]=r+a*(n[0]-r),e[1]=g+a*(n[1]-g),e[2]=u+a*(n[2]-u),e}},{}],174:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},{}],175:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},{}],176:[function(v,w,y){w.exports=v("./multiply")},{"./multiply":177}],177:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},{}],178:[function(v,w,y){w.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],179:[function(v,w,y){w.exports=function(e,t){var n=t[0],a=t[1],r=t[2],g=n*n+a*a+r*r;return g>0&&(g=1/Math.sqrt(g),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g),e}},{}],180:[function(v,w,y){w.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,a=2*Math.random()-1,r=Math.sqrt(1-a*a)*t;return e[0]=Math.cos(n)*r,e[1]=Math.sin(n)*r,e[2]=a*t,e}},{}],181:[function(v,w,y){w.exports=function(e,t,n,a){var r=n[1],g=n[2],u=t[1]-r,s=t[2]-g,h=Math.sin(a),l=Math.cos(a);return e[0]=t[0],e[1]=r+u*l-s*h,e[2]=g+u*h+s*l,e}},{}],182:[function(v,w,y){w.exports=function(e,t,n,a){var r=n[0],g=n[2],u=t[0]-r,s=t[2]-g,h=Math.sin(a),l=Math.cos(a);return e[0]=r+s*h+u*l,e[1]=t[1],e[2]=g+s*l-u*h,e}},{}],183:[function(v,w,y){w.exports=function(e,t,n,a){var r=n[0],g=n[1],u=t[0]-r,s=t[1]-g,h=Math.sin(a),l=Math.cos(a);return e[0]=r+u*l-s*h,e[1]=g+u*h+s*l,e[2]=t[2],e}},{}],184:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},{}],185:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},{}],186:[function(v,w,y){w.exports=function(e,t,n,a){return e[0]=t[0]+n[0]*a,e[1]=t[1]+n[1]*a,e[2]=t[2]+n[2]*a,e}},{}],187:[function(v,w,y){w.exports=function(e,t,n,a){return e[0]=t,e[1]=n,e[2]=a,e}},{}],188:[function(v,w,y){w.exports=v("./squaredDistance")},{"./squaredDistance":190}],189:[function(v,w,y){w.exports=v("./squaredLength")},{"./squaredLength":191}],190:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2];return n*n+a*a+r*r}},{}],191:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],a=e[2];return t*t+n*n+a*a}},{}],192:[function(v,w,y){w.exports=v("./subtract")},{"./subtract":193}],193:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},{}],194:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2];return e[0]=a*n[0]+r*n[3]+g*n[6],e[1]=a*n[1]+r*n[4]+g*n[7],e[2]=a*n[2]+r*n[5]+g*n[8],e}},{}],195:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=n[3]*a+n[7]*r+n[11]*g+n[15];return u=u||1,e[0]=(n[0]*a+n[4]*r+n[8]*g+n[12])/u,e[1]=(n[1]*a+n[5]*r+n[9]*g+n[13])/u,e[2]=(n[2]*a+n[6]*r+n[10]*g+n[14])/u,e}},{}],196:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=n[0],s=n[1],h=n[2],l=n[3],o=l*a+s*g-h*r,p=l*r+h*a-u*g,c=l*g+u*r-s*a,i=-u*a-s*r-h*g;return e[0]=o*l+i*-u+p*-h-c*-s,e[1]=p*l+i*-s+c*-u-o*-h,e[2]=c*l+i*-h+o*-s-p*-u,e}},{}],197:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}},{}],198:[function(v,w,y){w.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],199:[function(v,w,y){w.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],200:[function(v,w,y){w.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2],g=t[3]-e[3];return Math.sqrt(n*n+a*a+r*r+g*g)}},{}],202:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}},{}],203:[function(v,w,y){w.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],204:[function(v,w,y){w.exports=function(e,t,n,a){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=a,r}},{}],205:[function(v,w,y){w.exports={create:v("./create"),clone:v("./clone"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),add:v("./add"),subtract:v("./subtract"),multiply:v("./multiply"),divide:v("./divide"),min:v("./min"),max:v("./max"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),squaredDistance:v("./squaredDistance"),length:v("./length"),squaredLength:v("./squaredLength"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformQuat:v("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(v,w,y){w.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}},{}],207:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],a=e[2],r=e[3];return Math.sqrt(t*t+n*n+a*a+r*r)}},{}],208:[function(v,w,y){w.exports=function(e,t,n,a){var r=t[0],g=t[1],u=t[2],s=t[3];return e[0]=r+a*(n[0]-r),e[1]=g+a*(n[1]-g),e[2]=u+a*(n[2]-u),e[3]=s+a*(n[3]-s),e}},{}],209:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}},{}],210:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}},{}],211:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}},{}],212:[function(v,w,y){w.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}},{}],213:[function(v,w,y){w.exports=function(e,t){var n=t[0],a=t[1],r=t[2],g=t[3],u=n*n+a*a+r*r+g*g;return u>0&&(u=1/Math.sqrt(u),e[0]=n*u,e[1]=a*u,e[2]=r*u,e[3]=g*u),e}},{}],214:[function(v,w,y){var e=v("./normalize"),t=v("./scale");w.exports=function(n,a){return a=a||1,n[0]=Math.random(),n[1]=Math.random(),n[2]=Math.random(),n[3]=Math.random(),e(n,n),t(n,n,a),n}},{"./normalize":213,"./scale":215}],215:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}},{}],216:[function(v,w,y){w.exports=function(e,t,n,a){return e[0]=t[0]+n[0]*a,e[1]=t[1]+n[1]*a,e[2]=t[2]+n[2]*a,e[3]=t[3]+n[3]*a,e}},{}],217:[function(v,w,y){w.exports=function(e,t,n,a,r){return e[0]=t,e[1]=n,e[2]=a,e[3]=r,e}},{}],218:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2],g=t[3]-e[3];return n*n+a*a+r*r+g*g}},{}],219:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],a=e[2],r=e[3];return t*t+n*n+a*a+r*r}},{}],220:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}},{}],221:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=t[3];return e[0]=n[0]*a+n[4]*r+n[8]*g+n[12]*u,e[1]=n[1]*a+n[5]*r+n[9]*g+n[13]*u,e[2]=n[2]*a+n[6]*r+n[10]*g+n[14]*u,e[3]=n[3]*a+n[7]*r+n[11]*g+n[15]*u,e}},{}],222:[function(v,w,y){w.exports=function(e,t,n){var a=t[0],r=t[1],g=t[2],u=n[0],s=n[1],h=n[2],l=n[3],o=l*a+s*g-h*r,p=l*r+h*a-u*g,c=l*g+u*r-s*a,i=-u*a-s*r-h*g;return e[0]=o*l+i*-u+p*-h-c*-s,e[1]=p*l+i*-s+c*-u-o*-h,e[2]=c*l+i*-h+o*-s-p*-u,e[3]=t[3],e}},{}],223:[function(v,w,y){var e=v("glsl-tokenizer"),t=v("atob-lite");w.exports=function(n){for(var a=Array.isArray(n)?n:e(n),r=0;r<a.length;r++){var g=a[r];if(g.type==="preprocessor"){var u=g.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(u&&u[2]){var s=u[1],h=u[2];return(s?t(h):h).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(v,w,y){w.exports=function(u){var s,h,l,o=0,p=0,c=999,i=[],x=[],f=1,_=0,b=0,T=!1,k=!1,L="",A=n,I=e;(u=u||{}).version==="300 es"&&(A=r,I=a);var P={},S={};for(o=0;o<A.length;o++)P[A[o]]=!0;for(o=0;o<I.length;o++)S[I[o]]=!0;return function(N){return x=[],N!==null?function(U){o=0,U.toString&&(U=U.toString());var te;for(L+=U.replace(/\r\n/g,`
`),l=L.length;s=L[o],o<l;){switch(te=o,c){case 0:o=V();break;case 1:case 2:o=j();break;case 3:o=Z();break;case 4:o=$();break;case 11:o=K();break;case 5:o=ne();break;case 9999:o=H();break;case 9:o=D();break;case 999:o=z()}if(te!==o)switch(L[te]){case`
`:_=0,++f;break;default:++_}}return p+=o,L=L.slice(o),x}(N):function(U){return i.length&&E(i.join("")),c=10,E("(eof)"),x}()};function E(N){N.length&&x.push({type:g[c],data:N,position:b,line:f,column:_})}function z(){return i=i.length?[]:i,h==="/"&&s==="*"?(b=p+o-1,c=0,h=s,o+1):h==="/"&&s==="/"?(b=p+o-1,c=1,h=s,o+1):s==="#"?(c=2,b=p+o,o):/\s/.test(s)?(c=9,b=p+o,o):(T=/\d/.test(s),k=/[^\w_]/.test(s),b=p+o,c=T?4:k?3:9999,o)}function D(){return/[^\s]/g.test(s)?(E(i.join("")),c=999,o):(i.push(s),h=s,o+1)}function j(){return s!=="\r"&&s!==`
`||h==="\\"?(i.push(s),h=s,o+1):(E(i.join("")),c=999,o)}function V(){return s==="/"&&h==="*"?(i.push(s),E(i.join("")),c=999,o+1):(i.push(s),h=s,o+1)}function Z(){if(h==="."&&/\d/.test(s))return c=5,o;if(h==="/"&&s==="*")return c=0,o;if(h==="/"&&s==="/")return c=1,o;if(s==="."&&i.length){for(;Q(i););return c=5,o}if(s===";"||s===")"||s==="("){if(i.length)for(;Q(i););return E(s),c=999,o+1}var N=i.length===2&&s!=="=";if(/[\w_\d\s]/.test(s)||N){for(;Q(i););return c=999,o}return i.push(s),h=s,o+1}function Q(N){for(var U,te,B=0;;){if(U=t.indexOf(N.slice(0,N.length+B).join("")),te=t[U],U===-1){if(B--+N.length>0)continue;te=N.slice(0,1).join("")}return E(te),b+=te.length,(i=i.slice(te.length)).length}}function K(){return/[^a-fA-F0-9]/.test(s)?(E(i.join("")),c=999,o):(i.push(s),h=s,o+1)}function $(){return s==="."||/[eE]/.test(s)?(i.push(s),c=5,h=s,o+1):s==="x"&&i.length===1&&i[0]==="0"?(c=11,i.push(s),h=s,o+1):/[^\d]/.test(s)?(E(i.join("")),c=999,o):(i.push(s),h=s,o+1)}function ne(){return s==="f"&&(i.push(s),h=s,o+=1),/[eE]/.test(s)?(i.push(s),h=s,o+1):(s!=="-"&&s!=="+"||!/[eE]/.test(h))&&/[^\d]/.test(s)?(E(i.join("")),c=999,o):(i.push(s),h=s,o+1)}function H(){if(/[^\d\w_]/.test(s)){var N=i.join("");return c=S[N]?8:P[N]?7:6,E(i.join("")),c=999,o}return i.push(s),h=s,o+1}};var e=v("./lib/literals"),t=v("./lib/operators"),n=v("./lib/builtins"),a=v("./lib/literals-300es"),r=v("./lib/builtins-300es"),g=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(v,w,y){var e=v("./builtins");e=e.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)}),w.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(v,w,y){w.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(v,w,y){var e=v("./literals");w.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(v,w,y){w.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(v,w,y){w.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(v,w,y){var e=v("./index");w.exports=function(t,n){var a=e(n),r=[];return r=(r=r.concat(a(t))).concat(a(null))}},{"./index":224}],231:[function(v,w,y){w.exports=function(e){typeof e=="string"&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],a=0;a<e.length-1;a++)n.push(e[a],t[a]||"");return n.push(e[a]),n.join("")}},{}],232:[function(v,w,y){var e=v("is-browser");w.exports=e&&function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{t=!1}return t}()},{"is-browser":236}],233:[function(v,w,y){w.exports=function(h,l){var o=h.length;if(o===0)throw new Error("Must have at least d+1 points");var p=h[0].length;if(o<=p)throw new Error("Must input at least d+1 points");var c=h.slice(0,p+1),i=e.apply(void 0,c);if(i===0)throw new Error("Input not in general position");for(var x=new Array(p+1),f=0;f<=p;++f)x[f]=f;i<0&&(x[0]=1,x[1]=0);var _=new n(x,new Array(p+1),!1),b=_.adjacent,T=new Array(p+2);for(f=0;f<=p;++f){for(var k=x.slice(),L=0;L<=p;++L)L===f&&(k[L]=-1);var A=k[0];k[0]=k[1],k[1]=A;var I=new n(k,new Array(p+1),!0);b[f]=I,T[f]=I}for(T[p+1]=_,f=0;f<=p;++f){k=b[f].vertices;var P=b[f].adjacent;for(L=0;L<=p;++L){var S=k[L];if(S<0)P[L]=_;else for(var E=0;E<=p;++E)b[E].vertices.indexOf(S)<0&&(P[L]=b[E])}}var z=new u(p,c,T),D=!!l;for(f=p+1;f<o;++f)z.insert(h[f],D);return z.boundary()};var e=v("robust-orientation"),t=v("simplicial-complex").compareCells;function n(h,l,o){this.vertices=h,this.adjacent=l,this.boundary=o,this.lastVisited=-1}function a(h,l,o){this.vertices=h,this.cell=l,this.index=o}function r(h,l){return t(h.vertices,l.vertices)}n.prototype.flip=function(){var h=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=h;var l=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=l};var g=[];function u(h,l,o){this.dimension=h,this.vertices=l,this.simplices=o,this.interior=o.filter(function(x){return!x.boundary}),this.tuple=new Array(h+1);for(var p=0;p<=h;++p)this.tuple[p]=this.vertices[p];var c,i=g[h];i||(i=g[h]=((c=e[h+1])||(c=e),function(x){return function(){var f=this.tuple;return x.apply(this,f)}}(c))),this.orient=i}var s=u.prototype;s.handleBoundaryDegeneracy=function(h,l){var o=this.dimension,p=this.vertices.length-1,c=this.tuple,i=this.vertices,x=[h];for(h.lastVisited=-p;x.length>0;)for(var f=(h=x.pop()).adjacent,_=0;_<=o;++_){var b=f[_];if(b.boundary&&!(b.lastVisited<=-p)){for(var T=b.vertices,k=0;k<=o;++k){var L=T[k];c[k]=L<0?l:i[L]}var A=this.orient();if(A>0)return b;b.lastVisited=-p,A===0&&x.push(b)}}return null},s.walk=function(h,l){var o=this.vertices.length-1,p=this.dimension,c=this.vertices,i=this.tuple,x=l?this.interior.length*Math.random()|0:this.interior.length-1,f=this.interior[x];e:for(;!f.boundary;){for(var _=f.vertices,b=f.adjacent,T=0;T<=p;++T)i[T]=c[_[T]];for(f.lastVisited=o,T=0;T<=p;++T){var k=b[T];if(!(k.lastVisited>=o)){var L=i[T];i[T]=h;var A=this.orient();if(i[T]=L,A<0){f=k;continue e}k.boundary?k.lastVisited=-o:k.lastVisited=o}}return}return f},s.addPeaks=function(h,l){var o=this.vertices.length-1,p=this.dimension,c=this.vertices,i=this.tuple,x=this.interior,f=this.simplices,_=[l];l.lastVisited=o,l.vertices[l.vertices.indexOf(-1)]=o,l.boundary=!1,x.push(l);for(var b=[];_.length>0;){var T=(l=_.pop()).vertices,k=l.adjacent,L=T.indexOf(o);if(!(L<0)){for(var A=0;A<=p;++A)if(A!==L){var I=k[A];if(I.boundary&&!(I.lastVisited>=o)){var P=I.vertices;if(I.lastVisited!==-o){for(var S=0,E=0;E<=p;++E)P[E]<0?(S=E,i[E]=h):i[E]=c[P[E]];if(this.orient()>0){P[S]=o,I.boundary=!1,x.push(I),_.push(I),I.lastVisited=o;continue}I.lastVisited=-o}var z=I.adjacent,D=T.slice(),j=k.slice(),V=new n(D,j,!0);f.push(V);var Z=z.indexOf(l);if(!(Z<0))for(z[Z]=V,j[L]=I,D[A]=-1,j[A]=l,k[A]=V,V.flip(),E=0;E<=p;++E){var Q=D[E];if(!(Q<0||Q===o)){for(var K=new Array(p-1),$=0,ne=0;ne<=p;++ne){var H=D[ne];H<0||ne===E||(K[$++]=H)}b.push(new a(K,V,E))}}}}}}for(b.sort(r),A=0;A+1<b.length;A+=2){var N=b[A],U=b[A+1],te=N.index,B=U.index;te<0||B<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},s.insert=function(h,l){var o=this.vertices;o.push(h);var p=this.walk(h,l);if(p){for(var c=this.dimension,i=this.tuple,x=0;x<=c;++x){var f=p.vertices[x];i[x]=f<0?h:o[f]}var _=this.orient(i);_<0||(_!==0||(p=this.handleBoundaryDegeneracy(p,h)))&&this.addPeaks(h,p)}},s.boundary=function(){for(var h=this.dimension,l=[],o=this.simplices,p=o.length,c=0;c<p;++c){var i=o[c];if(i.boundary){for(var x=new Array(h),f=i.vertices,_=0,b=0,T=0;T<=h;++T)f[T]>=0?x[_++]=f[T]:b=1&T;if(b===(1&h)){var k=x[0];x[0]=x[1],x[1]=k}l.push(x)}}return l}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(v,w,y){var e=v("binary-search-bounds");function t(_,b,T,k,L){this.mid=_,this.left=b,this.right=T,this.leftPoints=k,this.rightPoints=L,this.count=(b?b.count:0)+(T?T.count:0)+k.length}w.exports=function(_){return!_||_.length===0?new x(null):new x(i(_))};var n=t.prototype;function a(_,b){_.mid=b.mid,_.left=b.left,_.right=b.right,_.leftPoints=b.leftPoints,_.rightPoints=b.rightPoints,_.count=b.count}function r(_,b){var T=i(b);_.mid=T.mid,_.left=T.left,_.right=T.right,_.leftPoints=T.leftPoints,_.rightPoints=T.rightPoints,_.count=T.count}function g(_,b){var T=_.intervals([]);T.push(b),r(_,T)}function u(_,b){var T=_.intervals([]),k=T.indexOf(b);return k<0?0:(T.splice(k,1),r(_,T),1)}function s(_,b,T){for(var k=0;k<_.length&&_[k][0]<=b;++k){var L=T(_[k]);if(L)return L}}function h(_,b,T){for(var k=_.length-1;k>=0&&_[k][1]>=b;--k){var L=T(_[k]);if(L)return L}}function l(_,b){for(var T=0;T<_.length;++T){var k=b(_[T]);if(k)return k}}function o(_,b){return _-b}function p(_,b){var T=_[0]-b[0];return T||_[1]-b[1]}function c(_,b){var T=_[1]-b[1];return T||_[0]-b[0]}function i(_){if(_.length===0)return null;for(var b=[],T=0;T<_.length;++T)b.push(_[T][0],_[T][1]);b.sort(o);var k=b[b.length>>1],L=[],A=[],I=[];for(T=0;T<_.length;++T){var P=_[T];P[1]<k?L.push(P):k<P[0]?A.push(P):I.push(P)}var S=I,E=I.slice();return S.sort(p),E.sort(c),new t(k,i(L),i(A),S,E)}function x(_){this.root=_}n.intervals=function(_){return _.push.apply(_,this.leftPoints),this.left&&this.left.intervals(_),this.right&&this.right.intervals(_),_},n.insert=function(_){var b=this.count-this.leftPoints.length;if(this.count+=1,_[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?g(this,_):this.left.insert(_):this.left=i([_]);else if(_[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?g(this,_):this.right.insert(_):this.right=i([_]);else{var T=e.ge(this.leftPoints,_,p),k=e.ge(this.rightPoints,_,c);this.leftPoints.splice(T,0,_),this.rightPoints.splice(k,0,_)}},n.remove=function(_){var b=this.count-this.leftPoints;if(_[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(b-1)?u(this,_):(A=this.left.remove(_))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(_[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(b-1)?u(this,_):(A=this.right.remove(_))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===_?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===_){if(this.left&&this.right){for(var T=this,k=this.left;k.right;)T=k,k=k.right;if(T===this)k.right=this.right;else{var L=this.left,A=this.right;T.count-=k.count,T.right=k.left,k.left=L,k.right=A}a(this,k),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?a(this,this.left):a(this,this.right);return 1}for(L=e.ge(this.leftPoints,_,p);L<this.leftPoints.length&&this.leftPoints[L][0]===_[0];++L)if(this.leftPoints[L]===_){for(this.count-=1,this.leftPoints.splice(L,1),A=e.ge(this.rightPoints,_,c);A<this.rightPoints.length&&this.rightPoints[A][1]===_[1];++A)if(this.rightPoints[A]===_)return this.rightPoints.splice(A,1),1}return 0},n.queryPoint=function(_,b){if(_<this.mid)return this.left&&(T=this.left.queryPoint(_,b))?T:s(this.leftPoints,_,b);if(_>this.mid){var T;return this.right&&(T=this.right.queryPoint(_,b))?T:h(this.rightPoints,_,b)}return l(this.leftPoints,b)},n.queryInterval=function(_,b,T){var k;return _<this.mid&&this.left&&(k=this.left.queryInterval(_,b,T))||b>this.mid&&this.right&&(k=this.right.queryInterval(_,b,T))?k:b<this.mid?s(this.leftPoints,b,T):_>this.mid?h(this.rightPoints,_,T):l(this.leftPoints,T)};var f=x.prototype;f.insert=function(_){this.root?this.root.insert(_):this.root=new t(_[0],null,null,[_],[_])},f.remove=function(_){if(this.root){var b=this.root.remove(_);return b===2&&(this.root=null),b!==0}return!1},f.queryPoint=function(_,b){if(this.root)return this.root.queryPoint(_,b)},f.queryInterval=function(_,b,T){if(_<=b&&this.root)return this.root.queryInterval(_,b,T)},Object.defineProperty(f,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(f,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(v,w,y){w.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},{}],236:[function(v,w,y){w.exports=!0},{}],237:[function(v,w,y){function e(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */w.exports=function(t){return t!=null&&(e(t)||function(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}(t)||!!t._isBuffer)}},{}],238:[function(v,w,y){w.exports=n,w.exports.isMobile=n,w.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(a){a||(a={});var r=a.ua;if(r||typeof navigator>"u"||(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),typeof r!="string")return!1;var g=a.tablet?t.test(r):e.test(r);return!g&&a.tablet&&a.featureDetect&&navigator&&navigator.maxTouchPoints>1&&r.indexOf("Macintosh")!==-1&&r.indexOf("Safari")!==-1&&(g=!0),g}},{}],239:[function(v,w,y){w.exports=function(e){for(var t,n=e.length,a=0;a<n;a++)if(((t=e.charCodeAt(a))<9||t>13)&&t!==32&&t!==133&&t!==160&&t!==5760&&t!==6158&&(t<8192||t>8205)&&t!==8232&&t!==8233&&t!==8239&&t!==8287&&t!==8288&&t!==12288&&t!==65279)return!1;return!0}},{}],240:[function(v,w,y){w.exports=function(e,t,n){return e*(1-n)+t*n}},{}],241:[function(v,w,y){var e=v("./normalize"),t=v("gl-mat4/create"),n=v("gl-mat4/clone"),a=v("gl-mat4/determinant"),r=v("gl-mat4/invert"),g=v("gl-mat4/transpose"),u={length:v("gl-vec3/length"),normalize:v("gl-vec3/normalize"),dot:v("gl-vec3/dot"),cross:v("gl-vec3/cross")},s=t(),h=t(),l=[0,0,0,0],o=[[0,0,0],[0,0,0],[0,0,0]],p=[0,0,0];function c(i,x,f,_,b){i[0]=x[0]*_+f[0]*b,i[1]=x[1]*_+f[1]*b,i[2]=x[2]*_+f[2]*b}w.exports=function(i,x,f,_,b,T){if(x||(x=[0,0,0]),f||(f=[0,0,0]),_||(_=[0,0,0]),b||(b=[0,0,0,1]),T||(T=[0,0,0,1]),!e(s,i)||(n(h,s),h[3]=0,h[7]=0,h[11]=0,h[15]=1,Math.abs(a(h)<1e-8)))return!1;var k,L,A,I,P,S,E,z=s[3],D=s[7],j=s[11],V=s[12],Z=s[13],Q=s[14],K=s[15];if(z!==0||D!==0||j!==0){if(l[0]=z,l[1]=D,l[2]=j,l[3]=K,!r(h,h))return!1;g(h,h),k=b,A=h,I=(L=l)[0],P=L[1],S=L[2],E=L[3],k[0]=A[0]*I+A[4]*P+A[8]*S+A[12]*E,k[1]=A[1]*I+A[5]*P+A[9]*S+A[13]*E,k[2]=A[2]*I+A[6]*P+A[10]*S+A[14]*E,k[3]=A[3]*I+A[7]*P+A[11]*S+A[15]*E}else b[0]=b[1]=b[2]=0,b[3]=1;if(x[0]=V,x[1]=Z,x[2]=Q,function(ne,H){ne[0][0]=H[0],ne[0][1]=H[1],ne[0][2]=H[2],ne[1][0]=H[4],ne[1][1]=H[5],ne[1][2]=H[6],ne[2][0]=H[8],ne[2][1]=H[9],ne[2][2]=H[10]}(o,s),f[0]=u.length(o[0]),u.normalize(o[0],o[0]),_[0]=u.dot(o[0],o[1]),c(o[1],o[1],o[0],1,-_[0]),f[1]=u.length(o[1]),u.normalize(o[1],o[1]),_[0]/=f[1],_[1]=u.dot(o[0],o[2]),c(o[2],o[2],o[0],1,-_[1]),_[2]=u.dot(o[1],o[2]),c(o[2],o[2],o[1],1,-_[2]),f[2]=u.length(o[2]),u.normalize(o[2],o[2]),_[1]/=f[2],_[2]/=f[2],u.cross(p,o[1],o[2]),u.dot(o[0],p)<0)for(var $=0;$<3;$++)f[$]*=-1,o[$][0]*=-1,o[$][1]*=-1,o[$][2]*=-1;return T[0]=.5*Math.sqrt(Math.max(1+o[0][0]-o[1][1]-o[2][2],0)),T[1]=.5*Math.sqrt(Math.max(1-o[0][0]+o[1][1]-o[2][2],0)),T[2]=.5*Math.sqrt(Math.max(1-o[0][0]-o[1][1]+o[2][2],0)),T[3]=.5*Math.sqrt(Math.max(1+o[0][0]+o[1][1]+o[2][2],0)),o[2][1]>o[1][2]&&(T[0]=-T[0]),o[0][2]>o[2][0]&&(T[1]=-T[1]),o[1][0]>o[0][1]&&(T[2]=-T[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(v,w,y){w.exports=function(e,t){var n=t[15];if(n===0)return!1;for(var a=1/n,r=0;r<16;r++)e[r]=t[r]*a;return!0}},{}],243:[function(v,w,y){var e=v("gl-vec3/lerp"),t=v("mat4-recompose"),n=v("mat4-decompose"),a=v("gl-mat4/determinant"),r=v("quat-slerp"),g=h(),u=h(),s=h();function h(){return{translate:l(),scale:l(1),skew:l(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function l(o){return[o||0,o||0,o||0]}w.exports=function(o,p,c,i){if(a(p)===0||a(c)===0)return!1;var x=n(p,g.translate,g.scale,g.skew,g.perspective,g.quaternion),f=n(c,u.translate,u.scale,u.skew,u.perspective,u.quaternion);return!(!x||!f)&&(e(s.translate,g.translate,u.translate,i),e(s.skew,g.skew,u.skew,i),e(s.scale,g.scale,u.scale,i),e(s.perspective,g.perspective,u.perspective,i),r(s.quaternion,g.quaternion,u.quaternion,i),t(o,s.translate,s.scale,s.skew,s.perspective,s.quaternion),!0)}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(v,w,y){var e={identity:v("gl-mat4/identity"),translate:v("gl-mat4/translate"),multiply:v("gl-mat4/multiply"),create:v("gl-mat4/create"),scale:v("gl-mat4/scale"),fromRotationTranslation:v("gl-mat4/fromRotationTranslation")},t=(e.create(),e.create());w.exports=function(n,a,r,g,u,s){return e.identity(n),e.fromRotationTranslation(n,s,a),n[3]=u[0],n[7]=u[1],n[11]=u[2],n[15]=u[3],e.identity(t),g[2]!==0&&(t[9]=g[2],e.multiply(n,n,t)),g[1]!==0&&(t[9]=0,t[8]=g[1],e.multiply(n,n,t)),g[0]!==0&&(t[8]=0,t[4]=g[0],e.multiply(n,n,t)),e.scale(n,n,r),n}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(v,w,y){var e=v("binary-search-bounds"),t=v("mat4-interpolate"),n=v("gl-mat4/invert"),a=v("gl-mat4/rotateX"),r=v("gl-mat4/rotateY"),g=v("gl-mat4/rotateZ"),u=v("gl-mat4/lookAt"),s=v("gl-mat4/translate"),h=(v("gl-mat4/scale"),v("gl-vec3/normalize")),l=[0,0,0];function o(i){this._components=i.slice(),this._time=[0],this.prevMatrix=i.slice(),this.nextMatrix=i.slice(),this.computedMatrix=i.slice(),this.computedInverse=i.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}w.exports=function(i){return new o((i=i||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var p=o.prototype;p.recalcMatrix=function(i){var x=this._time,f=e.le(x,i),_=this.computedMatrix;if(!(f<0)){var b=this._components;if(f===x.length-1)for(var T=16*f,k=0;k<16;++k)_[k]=b[T++];else{var L=x[f+1]-x[f],A=(T=16*f,this.prevMatrix),I=!0;for(k=0;k<16;++k)A[k]=b[T++];var P=this.nextMatrix;for(k=0;k<16;++k)P[k]=b[T++],I=I&&A[k]===P[k];if(L<1e-6||I)for(k=0;k<16;++k)_[k]=A[k];else t(_,A,P,(i-x[f])/L)}var S=this.computedUp;S[0]=_[1],S[1]=_[5],S[2]=_[9],h(S,S);var E=this.computedInverse;n(E,_);var z=this.computedEye,D=E[15];z[0]=E[12]/D,z[1]=E[13]/D,z[2]=E[14]/D;var j=this.computedCenter,V=Math.exp(this.computedRadius[0]);for(k=0;k<3;++k)j[k]=z[k]-_[2+4*k]*V}},p.idle=function(i){if(!(i<this.lastT())){for(var x=this._components,f=x.length-16,_=0;_<16;++_)x.push(x[f++]);this._time.push(i)}},p.flush=function(i){var x=e.gt(this._time,i)-2;x<0||(this._time.splice(0,x),this._components.splice(0,16*x))},p.lastT=function(){return this._time[this._time.length-1]},p.lookAt=function(i,x,f,_){this.recalcMatrix(i),x=x||this.computedEye,f=f||l,_=_||this.computedUp,this.setMatrix(i,u(this.computedMatrix,x,f,_));for(var b=0,T=0;T<3;++T)b+=Math.pow(f[T]-x[T],2);b=Math.log(Math.sqrt(b)),this.computedRadius[0]=b},p.rotate=function(i,x,f,_){this.recalcMatrix(i);var b=this.computedInverse;x&&r(b,b,x),f&&a(b,b,f),_&&g(b,b,_),this.setMatrix(i,n(this.computedMatrix,b))};var c=[0,0,0];p.pan=function(i,x,f,_){c[0]=-(x||0),c[1]=-(f||0),c[2]=-(_||0),this.recalcMatrix(i);var b=this.computedInverse;s(b,b,c),this.setMatrix(i,n(b,b))},p.translate=function(i,x,f,_){c[0]=x||0,c[1]=f||0,c[2]=_||0,this.recalcMatrix(i);var b=this.computedMatrix;s(b,b,c),this.setMatrix(i,b)},p.setMatrix=function(i,x){if(!(i<this.lastT())){this._time.push(i);for(var f=0;f<16;++f)this._components.push(x[f])}},p.setDistance=function(i,x){this.computedRadius[0]=x},p.setDistanceLimits=function(i,x){var f=this._limits;f[0]=i,f[1]=x},p.getDistanceLimits=function(i){var x=this._limits;return i?(i[0]=x[0],i[1]=x[1],i):x}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(v,w,y){w.exports=function(t){var n=t.length;if(n<3){for(var a=new Array(n),r=0;r<n;++r)a[r]=r;return n===2&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:a}var g=new Array(n);for(r=0;r<n;++r)g[r]=r;g.sort(function(x,f){var _=t[x][0]-t[f][0];return _||t[x][1]-t[f][1]});var u=[g[0],g[1]],s=[g[0],g[1]];for(r=2;r<n;++r){for(var h=g[r],l=t[h],o=u.length;o>1&&e(t[u[o-2]],t[u[o-1]],l)<=0;)o-=1,u.pop();for(u.push(h),o=s.length;o>1&&e(t[s[o-2]],t[s[o-1]],l)>=0;)o-=1,s.pop();s.push(h)}a=new Array(s.length+u.length-2);for(var p=0,c=(r=0,u.length);r<c;++r)a[p++]=u[r];for(var i=s.length-2;i>0;--i)a[p++]=s[i];return a};var e=v("robust-orientation")[3]},{"robust-orientation":284}],247:[function(v,w,y){w.exports=function(t,n){n||(n=t,t=window);var a=0,r=0,g=0,u={shift:!1,alt:!1,control:!1,meta:!1},s=!1;function h(T){var k=!1;return"altKey"in T&&(k=k||T.altKey!==u.alt,u.alt=!!T.altKey),"shiftKey"in T&&(k=k||T.shiftKey!==u.shift,u.shift=!!T.shiftKey),"ctrlKey"in T&&(k=k||T.ctrlKey!==u.control,u.control=!!T.ctrlKey),"metaKey"in T&&(k=k||T.metaKey!==u.meta,u.meta=!!T.metaKey),k}function l(T,k){var L=e.x(k),A=e.y(k);"buttons"in k&&(T=0|k.buttons),(T!==a||L!==r||A!==g||h(k))&&(a=0|T,r=L||0,g=A||0,n&&n(a,r,g,u))}function o(T){l(0,T)}function p(){(a||r||g||u.shift||u.alt||u.meta||u.control)&&(r=g=0,a=0,u.shift=u.alt=u.control=u.meta=!1,n&&n(0,0,0,u))}function c(T){h(T)&&n&&n(a,r,g,u)}function i(T){e.buttons(T)===0?l(0,T):l(a,T)}function x(T){l(a|e.buttons(T),T)}function f(T){l(a&~e.buttons(T),T)}function _(){s||(s=!0,t.addEventListener("mousemove",i),t.addEventListener("mousedown",x),t.addEventListener("mouseup",f),t.addEventListener("mouseleave",o),t.addEventListener("mouseenter",o),t.addEventListener("mouseout",o),t.addEventListener("mouseover",o),t.addEventListener("blur",p),t.addEventListener("keyup",c),t.addEventListener("keydown",c),t.addEventListener("keypress",c),t!==window&&(window.addEventListener("blur",p),window.addEventListener("keyup",c),window.addEventListener("keydown",c),window.addEventListener("keypress",c)))}_();var b={element:t};return Object.defineProperties(b,{enabled:{get:function(){return s},set:function(T){T?_():function(){!s||(s=!1,t.removeEventListener("mousemove",i),t.removeEventListener("mousedown",x),t.removeEventListener("mouseup",f),t.removeEventListener("mouseleave",o),t.removeEventListener("mouseenter",o),t.removeEventListener("mouseout",o),t.removeEventListener("mouseover",o),t.removeEventListener("blur",p),t.removeEventListener("keyup",c),t.removeEventListener("keydown",c),t.removeEventListener("keypress",c),t!==window&&(window.removeEventListener("blur",p),window.removeEventListener("keyup",c),window.removeEventListener("keydown",c),window.removeEventListener("keypress",c)))}()},enumerable:!0},buttons:{get:function(){return a},enumerable:!0},x:{get:function(){return r},enumerable:!0},y:{get:function(){return g},enumerable:!0},mods:{get:function(){return u},enumerable:!0}}),b};var e=v("mouse-event")},{"mouse-event":249}],248:[function(v,w,y){var e={left:0,top:0};w.exports=function(t,n,a){n=n||t.currentTarget||t.srcElement,Array.isArray(a)||(a=[0,0]);var r=t.clientX||0,g=t.clientY||0,u=(s=n,s===window||s===document||s===document.body?e:s.getBoundingClientRect()),s;return a[0]=r-u.left,a[1]=g-u.top,a}},{}],249:[function(v,w,y){function e(t){return t.target||t.srcElement||window}y.buttons=function(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){if((n=t.which)===2)return 4;if(n===3)return 2;if(n>0)return 1<<n-1}else if("button"in t){var n;if((n=t.button)===1)return 4;if(n===2)return 2;if(n>=0)return 1<<n}}return 0},y.element=e,y.x=function(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var n=e(t).getBoundingClientRect();return t.clientX-n.left}return 0},y.y=function(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var n=e(t).getBoundingClientRect();return t.clientY-n.top}return 0}},{}],250:[function(v,w,y){var e=v("to-px");w.exports=function(t,n,a){typeof t=="function"&&(a=!!n,n=t,t=window);var r=e("ex",t),g=function(u){a&&u.preventDefault();var s=u.deltaX||0,h=u.deltaY||0,l=u.deltaZ||0,o=1;switch(u.deltaMode){case 1:o=r;break;case 2:o=window.innerHeight}if(h*=o,l*=o,(s*=o)||h||l)return n(s,h,l,u)};return t.addEventListener("wheel",g),g}},{"to-px":304}],251:[function(v,w,y){var e=v("typedarray-pool");w.exports=function(n){function a(o){throw new Error("ndarray-extract-contour: "+o)}typeof n!="object"&&a("Must specify arguments");var r=n.order;Array.isArray(r)||a("Must specify order");var g=n.arrayArguments||1;g<1&&a("Must have at least one array argument");var u=n.scalarArguments||0;u<0&&a("Scalar arg count must be > 0"),typeof n.vertex!="function"&&a("Must specify vertex creation function"),typeof n.cell!="function"&&a("Must specify cell creation function"),typeof n.phase!="function"&&a("Must specify phase function");for(var s=n.getters||[],h=new Array(g),l=0;l<g;++l)s.indexOf(l)>=0?h[l]=!0:h[l]=!1;return function(o,p,c,i,x,f){var _=[f,x].join(",");return(0,t[_])(o,p,c,e.mallocUint32,e.freeUint32)}(n.vertex,n.cell,n.phase,0,r,h)};var t={"false,0,1":function(n,a,r,g,u){return function(s,h,l,o){var p,c=0|s.shape[0],i=0|s.shape[1],x=s.data,f=0|s.offset,_=0|s.stride[0],b=0|s.stride[1],T=f,k=0|-_,L=0,A=0|-b,I=0,P=-_-b|0,S=0,E=0|_,z=b-_*c|0,D=0,j=0,V=0,Z=2*c|0,Q=g(Z),K=g(Z),$=0,ne=0,H=-1,N=-1,U=0,te=0|-c,B=0|c,X=0,J=-c-1|0,ee=c-1|0,re=0,se=0,oe=0;for(D=0;D<c;++D)Q[$++]=r(x[T],h,l,o),T+=E;if(T+=z,i>0){if(j=1,Q[$++]=r(x[T],h,l,o),T+=E,c>0)for(D=1,p=x[T],ne=Q[$]=r(p,h,l,o),U=Q[$+H],X=Q[$+te],re=Q[$+J],ne===U&&ne===X&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,U,X,re,h,l,o),se=K[$]=V++),$+=1,T+=E,D=2;D<c;++D)p=x[T],ne=Q[$]=r(p,h,l,o),U=Q[$+H],X=Q[$+te],re=Q[$+J],ne===U&&ne===X&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,U,X,re,h,l,o),se=K[$]=V++,re!==U&&a(K[$+H],se,S,L,re,U,h,l,o)),$+=1,T+=E;for(T+=z,$=0,oe=H,H=N,N=oe,oe=te,te=B,B=oe,oe=J,J=ee,ee=oe,j=2;j<i;++j){if(Q[$++]=r(x[T],h,l,o),T+=E,c>0)for(D=1,p=x[T],ne=Q[$]=r(p,h,l,o),U=Q[$+H],X=Q[$+te],re=Q[$+J],ne===U&&ne===X&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,U,X,re,h,l,o),se=K[$]=V++,re!==X&&a(K[$+te],se,I,S,X,re,h,l,o)),$+=1,T+=E,D=2;D<c;++D)p=x[T],ne=Q[$]=r(p,h,l,o),U=Q[$+H],X=Q[$+te],re=Q[$+J],ne===U&&ne===X&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,U,X,re,h,l,o),se=K[$]=V++,re!==X&&a(K[$+te],se,I,S,X,re,h,l,o),re!==U&&a(K[$+H],se,S,L,re,U,h,l,o)),$+=1,T+=E;1&j&&($=0),oe=H,H=N,N=oe,oe=te,te=B,B=oe,oe=J,J=ee,ee=oe,T+=z}}u(K),u(Q)}},"false,1,0":function(n,a,r,g,u){return function(s,h,l,o){var p,c=0|s.shape[0],i=0|s.shape[1],x=s.data,f=0|s.offset,_=0|s.stride[0],b=0|s.stride[1],T=f,k=0|-_,L=0,A=0|-b,I=0,P=-_-b|0,S=0,E=0|b,z=_-b*i|0,D=0,j=0,V=0,Z=2*i|0,Q=g(Z),K=g(Z),$=0,ne=0,H=-1,N=-1,U=0,te=0|-i,B=0|i,X=0,J=-i-1|0,ee=i-1|0,re=0,se=0,oe=0;for(j=0;j<i;++j)Q[$++]=r(x[T],h,l,o),T+=E;if(T+=z,c>0){if(D=1,Q[$++]=r(x[T],h,l,o),T+=E,i>0)for(j=1,p=x[T],ne=Q[$]=r(p,h,l,o),X=Q[$+te],U=Q[$+H],re=Q[$+J],ne===X&&ne===U&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,X,U,re,h,l,o),se=K[$]=V++),$+=1,T+=E,j=2;j<i;++j)p=x[T],ne=Q[$]=r(p,h,l,o),X=Q[$+te],U=Q[$+H],re=Q[$+J],ne===X&&ne===U&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,X,U,re,h,l,o),se=K[$]=V++,re!==U&&a(K[$+H],se,I,S,U,re,h,l,o)),$+=1,T+=E;for(T+=z,$=0,oe=te,te=B,B=oe,oe=H,H=N,N=oe,oe=J,J=ee,ee=oe,D=2;D<c;++D){if(Q[$++]=r(x[T],h,l,o),T+=E,i>0)for(j=1,p=x[T],ne=Q[$]=r(p,h,l,o),X=Q[$+te],U=Q[$+H],re=Q[$+J],ne===X&&ne===U&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,X,U,re,h,l,o),se=K[$]=V++,re!==X&&a(K[$+te],se,S,L,re,X,h,l,o)),$+=1,T+=E,j=2;j<i;++j)p=x[T],ne=Q[$]=r(p,h,l,o),X=Q[$+te],U=Q[$+H],re=Q[$+J],ne===X&&ne===U&&ne===re||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,ne,X,U,re,h,l,o),se=K[$]=V++,re!==U&&a(K[$+H],se,I,S,U,re,h,l,o),re!==X&&a(K[$+te],se,S,L,re,X,h,l,o)),$+=1,T+=E;1&D&&($=0),oe=te,te=B,B=oe,oe=H,H=N,N=oe,oe=J,J=ee,ee=oe,T+=z}}u(K),u(Q)}}}},{"typedarray-pool":308}],252:[function(v,w,y){var e=v("dup"),t={zero:function(c,i,x,f){var _=c[0];f|=0;var b=0,T=x[0];for(b=0;b<_;++b)i[f]=0,f+=T},fdTemplate1:function(c,i,x,f,_,b,T){var k=c[0],L=x[0],A=-1*L,I=L;f|=0,T|=0;var P=0,S=L,E=b[0];for(P=0;P<k;++P)_[T]=.5*(i[f+A]-i[f+I]),f+=S,T+=E},fdTemplate2:function(c,i,x,f,_,b,T,k,L,A){var I=c[0],P=c[1],S=x[0],E=x[1],z=b[0],D=b[1],j=L[0],V=L[1],Z=-1*S,Q=S,K=-1*E,$=E;f|=0,T|=0,A|=0;var ne=0,H=0,N=E,U=S-P*E,te=D,B=z-P*D,X=V,J=j-P*V;for(H=0;H<I;++H){for(ne=0;ne<P;++ne)_[T]=.5*(i[f+Z]-i[f+Q]),k[A]=.5*(i[f+K]-i[f+$]),f+=N,T+=te,A+=X;f+=U,T+=B,A+=J}}},n={cdiff:function(c){var i={};return function(x,f,_){var b=x.dtype,T=x.order,k=f.dtype,L=f.order,A=_.dtype,I=_.order,P=[b,T.join(),k,L.join(),A,I.join()].join(),S=i[P];return S||(i[P]=S=c([b,T,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset,_.data,_.stride,0|_.offset)}},zero:function(c){var i={};return function(x){var f=x.dtype,_=x.order,b=[f,_.join()].join(),T=i[b];return T||(i[b]=T=c([f,_])),T(x.shape.slice(0),x.data,x.stride,0|x.offset)}},fdTemplate1:function(c){var i={};return function(x,f){var _=x.dtype,b=x.order,T=f.dtype,k=f.order,L=[_,b.join(),T,k.join()].join(),A=i[L];return A||(i[L]=A=c([_,b,T,k])),A(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset)}},fdTemplate2:function(c){var i={};return function(x,f,_){var b=x.dtype,T=x.order,k=f.dtype,L=f.order,A=_.dtype,I=_.order,P=[b,T.join(),k,L.join(),A,I.join()].join(),S=i[P];return S||(i[P]=S=c([b,T,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset,_.data,_.stride,0|_.offset)}}};function a(c){return(0,n[c.funcName])(r.bind(void 0,c))}function r(c){return t[c.funcName]}function g(c){return a({funcName:c.funcName})}var u={},s={},h=g({funcName:"cdiff"}),l=g({funcName:"zero"});function o(c){return c in u?u[c]:u[c]=g({funcName:"fdTemplate"+c})}function p(c,i,x,f){return function(_,b){var T=b.shape.slice();return T[0]>2&&T[1]>2&&f(b.pick(-1,-1).lo(1,1).hi(T[0]-2,T[1]-2),_.pick(-1,-1,0).lo(1,1).hi(T[0]-2,T[1]-2),_.pick(-1,-1,1).lo(1,1).hi(T[0]-2,T[1]-2)),T[1]>2&&(x(b.pick(0,-1).lo(1).hi(T[1]-2),_.pick(0,-1,1).lo(1).hi(T[1]-2)),i(_.pick(0,-1,0).lo(1).hi(T[1]-2))),T[1]>2&&(x(b.pick(T[0]-1,-1).lo(1).hi(T[1]-2),_.pick(T[0]-1,-1,1).lo(1).hi(T[1]-2)),i(_.pick(T[0]-1,-1,0).lo(1).hi(T[1]-2))),T[0]>2&&(x(b.pick(-1,0).lo(1).hi(T[0]-2),_.pick(-1,0,0).lo(1).hi(T[0]-2)),i(_.pick(-1,0,1).lo(1).hi(T[0]-2))),T[0]>2&&(x(b.pick(-1,T[1]-1).lo(1).hi(T[0]-2),_.pick(-1,T[1]-1,0).lo(1).hi(T[0]-2)),i(_.pick(-1,T[1]-1,1).lo(1).hi(T[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(T[0]-1,0,0,0),_.set(T[0]-1,0,1,0),_.set(0,T[1]-1,0,0),_.set(0,T[1]-1,1,0),_.set(T[0]-1,T[1]-1,0,0),_.set(T[0]-1,T[1]-1,1,0),_}}w.exports=function(c,i,x){return Array.isArray(x)||(x=e(i.dimension,typeof x=="string"?x:"clamp")),i.size===0?c:i.dimension===0?(c.set(0),c):function(f){var _=f.join();if(L=s[_])return L;for(var b=f.length,T=[h,l],k=1;k<=b;++k)T.push(o(k));var L=p.apply(void 0,T);return s[_]=L,L}(x)(c,i)}},{dup:65}],253:[function(v,w,y){function e(r,g){var u=Math.floor(g),s=g-u,h=0<=u&&u<r.shape[0],l=0<=u+1&&u+1<r.shape[0];return(1-s)*(h?+r.get(u):0)+s*(l?+r.get(u+1):0)}function t(r,g,u){var s=Math.floor(g),h=g-s,l=0<=s&&s<r.shape[0],o=0<=s+1&&s+1<r.shape[0],p=Math.floor(u),c=u-p,i=0<=p&&p<r.shape[1],x=0<=p+1&&p+1<r.shape[1],f=l&&i?r.get(s,p):0,_=l&&x?r.get(s,p+1):0;return(1-c)*((1-h)*f+h*(o&&i?r.get(s+1,p):0))+c*((1-h)*_+h*(o&&x?r.get(s+1,p+1):0))}function n(r,g,u,s){var h=Math.floor(g),l=g-h,o=0<=h&&h<r.shape[0],p=0<=h+1&&h+1<r.shape[0],c=Math.floor(u),i=u-c,x=0<=c&&c<r.shape[1],f=0<=c+1&&c+1<r.shape[1],_=Math.floor(s),b=s-_,T=0<=_&&_<r.shape[2],k=0<=_+1&&_+1<r.shape[2],L=o&&x&&T?r.get(h,c,_):0,A=o&&f&&T?r.get(h,c+1,_):0,I=p&&x&&T?r.get(h+1,c,_):0,P=p&&f&&T?r.get(h+1,c+1,_):0,S=o&&x&&k?r.get(h,c,_+1):0,E=o&&f&&k?r.get(h,c+1,_+1):0;return(1-b)*((1-i)*((1-l)*L+l*I)+i*((1-l)*A+l*P))+b*((1-i)*((1-l)*S+l*(p&&x&&k?r.get(h+1,c,_+1):0))+i*((1-l)*E+l*(p&&f&&k?r.get(h+1,c+1,_+1):0)))}function a(r){var g,u,s=0|r.shape.length,h=new Array(s),l=new Array(s),o=new Array(s),p=new Array(s);for(g=0;g<s;++g)u=+arguments[g+1],h[g]=Math.floor(u),l[g]=u-h[g],o[g]=0<=h[g]&&h[g]<r.shape[g],p[g]=0<=h[g]+1&&h[g]+1<r.shape[g];var c,i,x,f=0;e:for(g=0;g<1<<s;++g){for(i=1,x=r.offset,c=0;c<s;++c)if(g&1<<c){if(!p[c])continue e;i*=l[c],x+=r.stride[c]*(h[c]+1)}else{if(!o[c])continue e;i*=1-l[c],x+=r.stride[c]*h[c]}f+=i*r.data[x]}return f}w.exports=function(r,g,u,s){switch(r.shape.length){case 0:return 0;case 1:return e(r,g);case 2:return t(r,g,u);case 3:return n(r,g,u,s);default:return a.apply(void 0,arguments)}},w.exports.d1=e,w.exports.d2=t,w.exports.d3=n},{}],254:[function(v,w,y){var e={"float64,2,1,0":function(){return function(g,u,s,h,l){var o=g[0],p=g[1],c=g[2],i=s[0],x=s[1],f=s[2];h|=0;var _=0,b=0,T=0,k=f,L=x-c*f,A=i-p*x;for(T=0;T<o;++T){for(b=0;b<p;++b){for(_=0;_<c;++_)u[h]/=l,h+=k;h+=L}h+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(g,u,s,h,l,o,p,c){for(var i=g[0],x=g[1],f=g[2],_=s[0],b=s[1],T=s[2],k=o[0],L=o[1],A=o[2],I=h|=0,P=p|=0,S=0|g[0];S>0;){S<64?(i=S,S=0):(i=64,S-=64);for(var E=0|g[1];E>0;){E<64?(x=E,E=0):(x=64,E-=64),h=I+S*_+E*b,p=P+S*k+E*L;var z=0,D=0,j=0,V=T,Z=_-f*T,Q=b-i*_,K=A,$=k-f*A,ne=L-i*k;for(j=0;j<x;++j){for(D=0;D<i;++D){for(z=0;z<f;++z)u[h]=l[p]*c,h+=V,p+=K;h+=Z,p+=$}h+=Q,p+=ne}}}}},"float32,1,0,float32,1,0":function(){return function(g,u,s,h,l,o,p){var c=g[0],i=g[1],x=s[0],f=s[1],_=o[0],b=o[1];h|=0,p|=0;var T=0,k=0,L=f,A=x-i*f,I=b,P=_-i*b;for(k=0;k<c;++k){for(T=0;T<i;++T)u[h]=l[p],h+=L,p+=I;h+=A,p+=P}}},"float32,1,0,float32,0,1":function(){return function(g,u,s,h,l,o,p){for(var c=g[0],i=g[1],x=s[0],f=s[1],_=o[0],b=o[1],T=h|=0,k=p|=0,L=0|g[1];L>0;){L<64?(i=L,L=0):(i=64,L-=64);for(var A=0|g[0];A>0;){A<64?(c=A,A=0):(c=64,A-=64),h=T+L*f+A*x,p=k+L*b+A*_;var I=0,P=0,S=f,E=x-i*f,z=b,D=_-i*b;for(P=0;P<c;++P){for(I=0;I<i;++I)u[h]=l[p],h+=S,p+=z;h+=E,p+=D}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(g,u,s,h,l,o,p){for(var c=g[0],i=g[1],x=g[2],f=s[0],_=s[1],b=s[2],T=o[0],k=o[1],L=o[2],A=h|=0,I=p|=0,P=0|g[2];P>0;){P<64?(x=P,P=0):(x=64,P-=64);for(var S=0|g[0];S>0;){S<64?(c=S,S=0):(c=64,S-=64);for(var E=0|g[1];E>0;){E<64?(i=E,E=0):(i=64,E-=64),h=A+P*b+S*f+E*_,p=I+P*L+S*T+E*k;var z=0,D=0,j=0,V=b,Z=f-x*b,Q=_-c*f,K=L,$=T-x*L,ne=k-c*T;for(j=0;j<i;++j){for(D=0;D<c;++D){for(z=0;z<x;++z)u[h]=l[p],h+=V,p+=K;h+=Z,p+=$}h+=Q,p+=ne}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(g,u,s,h,l,o,p){var c=g[0],i=g[1],x=g[2],f=s[0],_=s[1],b=s[2],T=o[0],k=o[1],L=o[2];h|=0,p|=0;var A=0,I=0,P=0,S=b,E=f-x*b,z=_-c*f,D=L,j=T-x*L,V=k-c*T;for(P=0;P<i;++P){for(I=0;I<c;++I){for(A=0;A<x;++A)u[h]=l[p],h+=S,p+=D;h+=E,p+=j}h+=z,p+=V}}}},t=function(g,u){var s=u.join(",");return(0,e[s])()},n={mul:function(g){var u={};return function(s,h,l){var o=s.dtype,p=s.order,c=h.dtype,i=h.order,x=l.dtype,f=l.order,_=[o,p.join(),c,i.join(),x,f.join()].join(),b=u[_];return b||(u[_]=b=g([o,p,c,i,x,f])),b(s.shape.slice(0),s.data,s.stride,0|s.offset,h.data,h.stride,0|h.offset,l.data,l.stride,0|l.offset)}},muls:function(g){var u={};return function(s,h,l){var o=s.dtype,p=s.order,c=h.dtype,i=h.order,x=[o,p.join(),c,i.join()].join(),f=u[x];return f||(u[x]=f=g([o,p,c,i])),f(s.shape.slice(0),s.data,s.stride,0|s.offset,h.data,h.stride,0|h.offset,l)}},mulseq:function(g){var u={};return function(s,h){var l=s.dtype,o=s.order,p=[l,o.join()].join(),c=u[p];return c||(u[p]=c=g([l,o])),c(s.shape.slice(0),s.data,s.stride,0|s.offset,h)}},div:function(g){var u={};return function(s,h,l){var o=s.dtype,p=s.order,c=h.dtype,i=h.order,x=l.dtype,f=l.order,_=[o,p.join(),c,i.join(),x,f.join()].join(),b=u[_];return b||(u[_]=b=g([o,p,c,i,x,f])),b(s.shape.slice(0),s.data,s.stride,0|s.offset,h.data,h.stride,0|h.offset,l.data,l.stride,0|l.offset)}},divs:function(g){var u={};return function(s,h,l){var o=s.dtype,p=s.order,c=h.dtype,i=h.order,x=[o,p.join(),c,i.join()].join(),f=u[x];return f||(u[x]=f=g([o,p,c,i])),f(s.shape.slice(0),s.data,s.stride,0|s.offset,h.data,h.stride,0|h.offset,l)}},divseq:function(g){var u={};return function(s,h){var l=s.dtype,o=s.order,p=[l,o.join()].join(),c=u[p];return c||(u[p]=c=g([l,o])),c(s.shape.slice(0),s.data,s.stride,0|s.offset,h)}},assign:function(g){var u={};return function(s,h){var l=s.dtype,o=s.order,p=h.dtype,c=h.order,i=[l,o.join(),p,c.join()].join(),x=u[i];return x||(u[i]=x=g([l,o,p,c])),x(s.shape.slice(0),s.data,s.stride,0|s.offset,h.data,h.stride,0|h.offset)}}};function a(g){return u={funcName:g.funcName},(0,n[u.funcName])(t.bind(void 0,u));var u}var r={mul:"*",div:"/"};(function(){for(var g in r)y[g]=a({funcName:g}),y[g+"s"]=a({funcName:g+"s"}),y[g+"seq"]=a({funcName:g+"seq"})})(),y.assign=a({funcName:"assign"})},{}],255:[function(v,w,y){var e=v("ndarray"),t=v("./doConvert.js");w.exports=function(n,a){for(var r=[],g=n,u=1;Array.isArray(g);)r.push(g.length),u*=g.length,g=g[0];return r.length===0?e():(a||(a=e(new Float64Array(u),r)),t(a,n),a)}},{"./doConvert.js":256,ndarray:259}],256:[function(v,w,y){var e,t=function(){return function(n,a,r,g,u){var s=n[0],h=n[1],l=n[2],o=r[0],p=r[1],c=r[2],i=[0,0,0];g|=0;var x=0,f=0,_=0,b=c,T=p-l*c,k=o-h*p;for(_=0;_<s;++_){for(f=0;f<h;++f){for(x=0;x<l;++x){var L,A=u;for(L=0;L<i.length-1;++L)A=A[i[L]];a[g]=A[i[i.length-1]],g+=b,++i[2]}g+=T,i[2]-=l,++i[1]}g+=k,i[1]-=h,++i[0]}}};w.exports=(e={funcName:"convert"},function(n){var a={};return function(r,g){var u=r.dtype,s=r.order,h=[u,s.join()].join(),l=a[h];return l||(a[h]=l=n([u,s])),l(r.shape.slice(0),r.data,r.stride,0|r.offset,g)}}(t.bind(void 0,e)))},{}],257:[function(v,w,y){var e=v("typedarray-pool");function t(g){switch(g){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(g,u){return function(s,h,l,o,p,c,i,x,f,_,b){var T,k,L,A,I,P,S,E,z=s*p+o,D=g(x);for(T=s+1;T<=h;++T){for(k=T,L=z+=p,I=0,P=z,A=0;A<x;++A)D[I++]=l[P],P+=f;e:for(;k-- >s;){I=0,P=L-p;t:for(A=0;A<x;++A){if((S=l[P])<(E=D[I]))break e;if(S>E)break t;P+=_,I+=b}for(I=L,P=L-p,A=0;A<x;++A)l[I]=l[P],I+=f,P+=f;L-=p}for(I=L,P=0,A=0;A<x;++A)l[I]=D[P++],I+=f}u(D)}}},a={"uint32,1,0":function(g,u,s){return function h(l,o,p,c,i,x,f,_,b,T,k){var L,A,I,P,S,E,z,D,j,V,Z,Q,K,$,ne,H,N,U,te,B,X,J,ee,re,se,oe=(o-l+1)/6|0,de=l+oe,ce=o-oe,ve=l+o>>1,Ae=ve-oe,fe=ve+oe,me=de,_e=Ae,le=ve,ge=fe,Te=ce,Se=l+1,Me=o-1,ze=!0,Oe=0,De=0,Xe=0,Be=_,Ie=u(Be),Re=u(Be);Z=i*me,Q=i*_e,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=me,me=_e,_e=A;break e}if(Xe<0)break e;se+=T}Z=i*ge,Q=i*Te,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=ge,ge=Te,Te=A;break e}if(Xe<0)break e;se+=T}Z=i*me,Q=i*le,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=me,me=le,le=A;break e}if(Xe<0)break e;se+=T}Z=i*_e,Q=i*le,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=_e,_e=le,le=A;break e}if(Xe<0)break e;se+=T}Z=i*me,Q=i*ge,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=me,me=ge,ge=A;break e}if(Xe<0)break e;se+=T}Z=i*le,Q=i*ge,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=le,le=ge,ge=A;break e}if(Xe<0)break e;se+=T}Z=i*_e,Q=i*Te,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=_e,_e=Te,Te=A;break e}if(Xe<0)break e;se+=T}Z=i*_e,Q=i*le,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=_e,_e=le,le=A;break e}if(Xe<0)break e;se+=T}Z=i*ge,Q=i*Te,se=c;e:for(V=0;V<_;++V){if(D=Q+se,(Xe=p[z=Z+se]-p[D])>0){A=ge,ge=Te,Te=A;break e}if(Xe<0)break e;se+=T}for(Z=i*me,Q=i*_e,K=i*le,$=i*ge,ne=i*Te,H=i*de,N=i*ve,U=i*ce,re=0,se=c,V=0;V<_;++V)z=Z+se,D=Q+se,j=K+se,te=$+se,B=ne+se,X=H+se,J=N+se,ee=U+se,Ie[re]=p[D],Re[re]=p[te],ze=ze&&Ie[re]===Re[re],I=p[z],P=p[j],S=p[B],p[X]=I,p[J]=P,p[ee]=S,++re,se+=b;for(Z=i*Ae,Q=i*l,se=c,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],se+=b;for(Z=i*fe,Q=i*o,se=c,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],se+=b;if(ze)for(E=Se;E<=Me;++E){for(z=c+E*i,re=0,V=0;V<_&&(Xe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(Xe!==0)if(Xe<0){if(E!==Se)for(Z=i*E,Q=i*Se,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++Se}else for(;;){for(z=c+Me*i,re=0,V=0;V<_&&(Xe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(!(Xe>0)){if(Xe<0){for(Z=i*E,Q=i*Se,K=i*Me,se=c,V=0;V<_;++V)D=Q+se,j=K+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++Se,--Me;break}for(Z=i*E,Q=i*Me,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--Me;break}Me--}}else for(E=Se;E<=Me;++E){for(z=c+E*i,re=0,V=0;V<_&&(Oe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(Oe<0){if(E!==Se)for(Z=i*E,Q=i*Se,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++Se}else{for(z=c+E*i,re=0,V=0;V<_&&(De=p[z]-Re[re])===0;++V)re+=k,z+=T;if(De>0)for(;;){for(z=c+Me*i,re=0,V=0;V<_&&(Xe=p[z]-Re[re])===0;++V)re+=k,z+=T;if(!(Xe>0)){for(z=c+Me*i,re=0,V=0;V<_&&(Xe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(Xe<0){for(Z=i*E,Q=i*Se,K=i*Me,se=c,V=0;V<_;++V)D=Q+se,j=K+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++Se,--Me}else{for(Z=i*E,Q=i*Me,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--Me}break}if(--Me<E)break}}}for(Z=i*l,Q=i*(Se-1),re=0,se=c,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],p[D]=Ie[re],++re,se+=b;for(Z=i*o,Q=i*(Me+1),re=0,se=c,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],p[D]=Re[re],++re,se+=b;if(Se-2-l<=32?g(l,Se-2,p,c,i,x,f,_,b,T,k):h(l,Se-2,p,c,i,x,f,_,b,T,k),o-(Me+2)<=32?g(Me+2,o,p,c,i,x,f,_,b,T,k):h(Me+2,o,p,c,i,x,f,_,b,T,k),ze)return s(Ie),void s(Re);if(Se<de&&Me>ce){e:for(;;){for(z=c+Se*i,re=0,se=c,V=0;V<_;++V){if(p[z]!==Ie[re])break e;++re,z+=b}++Se}e:for(;;){for(z=c+Me*i,re=0,se=c,V=0;V<_;++V){if(p[z]!==Re[re])break e;++re,z+=b}--Me}for(E=Se;E<=Me;++E){for(z=c+E*i,re=0,V=0;V<_&&(Oe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(Oe===0){if(E!==Se)for(Z=i*E,Q=i*Se,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++Se}else{for(z=c+E*i,re=0,V=0;V<_&&(De=p[z]-Re[re])===0;++V)re+=k,z+=T;if(De===0)for(;;){for(z=c+Me*i,re=0,V=0;V<_&&(Xe=p[z]-Re[re])===0;++V)re+=k,z+=T;if(Xe!==0){for(z=c+Me*i,re=0,V=0;V<_&&(Xe=p[z]-Ie[re])===0;++V)re+=k,z+=T;if(Xe<0){for(Z=i*E,Q=i*Se,K=i*Me,se=c,V=0;V<_;++V)D=Q+se,j=K+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++Se,--Me}else{for(Z=i*E,Q=i*Me,se=c,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--Me}break}if(--Me<E)break}}}}s(Ie),s(Re),Me-Se<=32?g(Se,Me,p,c,i,x,f,_,b,T,k):h(Se,Me,p,c,i,x,f,_,b,T,k)}}},r={"uint32,1,0":function(g,u){return function(s){var h=s.data,l=0|s.offset,o=s.shape,p=s.stride,c=0|p[0],i=0|o[0],x=0|p[1],f=0|o[1],_=x,b=x;i<=32?g(0,i-1,h,l,c,x,i,f,_,b,1):u(0,i-1,h,l,c,x,i,f,_,b,1)}}};w.exports=function(g,u){var s=[u,g].join(","),h=r[s],l=function(p,c){var i=t(c),x=[c,p].join(","),f=n[x];return i?f(i[0],i[1]):f()}(g,u),o=function(p,c,i){var x=t(c),f=[c,p].join(","),_=a[f];return p.length>1&&x?_(i,x[0],x[1]):_(i)}(g,u,l);return h(l,o)}},{"typedarray-pool":308}],258:[function(v,w,y){var e=v("./lib/compile_sort.js"),t={};w.exports=function(n){var a=n.order,r=n.dtype,g=[a,r].join(":"),u=t[g];return u||(t[g]=u=e(a,r)),u(n),n}},{"./lib/compile_sort.js":257}],259:[function(v,w,y){var e=v("is-buffer"),t=typeof Float64Array<"u";function n(s,h){return s[0]-h[0]}function a(){var s,h=this.stride,l=new Array(h.length);for(s=0;s<l.length;++s)l[s]=[Math.abs(h[s]),s];l.sort(n);var o=new Array(l.length);for(s=0;s<o.length;++s)o[s]=l[s][1];return o}var r={T:function(s){function h(o){this.data=o}var l=h.prototype;return l.dtype=s,l.index=function(){return-1},l.size=0,l.dimension=-1,l.shape=l.stride=l.order=[],l.lo=l.hi=l.transpose=l.step=function(){return new h(this.data)},l.get=l.set=function(){},l.pick=function(){return null},function(o){return new h(o)}},0:function(s,h){function l(p,c){this.data=p,this.offset=c}var o=l.prototype;return o.dtype=s,o.index=function(){return this.offset},o.dimension=0,o.size=1,o.shape=o.stride=o.order=[],o.lo=o.hi=o.transpose=o.step=function(){return new l(this.data,this.offset)},o.pick=function(){return h(this.data)},o.valueOf=o.get=function(){return s==="generic"?this.data.get(this.offset):this.data[this.offset]},o.set=function(p){return s==="generic"?this.data.set(this.offset,p):this.data[this.offset]=p},function(p,c,i,x){return new l(p,x)}},1:function(s,h,l){function o(c,i,x,f){this.data=c,this.shape=[i],this.stride=[x],this.offset=0|f}var p=o.prototype;return p.dtype=s,p.dimension=1,Object.defineProperty(p,"size",{get:function(){return this.shape[0]}}),p.order=[0],p.set=function(c,i){return s==="generic"?this.data.set(this.offset+this.stride[0]*c,i):this.data[this.offset+this.stride[0]*c]=i},p.get=function(c){return s==="generic"?this.data.get(this.offset+this.stride[0]*c):this.data[this.offset+this.stride[0]*c]},p.index=function(c){return this.offset+this.stride[0]*c},p.hi=function(c){return new o(this.data,typeof c!="number"||c<0?this.shape[0]:0|c,this.stride[0],this.offset)},p.lo=function(c){var i=this.offset,x=0,f=this.shape[0],_=this.stride[0];return typeof c=="number"&&c>=0&&(i+=_*(x=0|c),f-=x),new o(this.data,f,_,i)},p.step=function(c){var i=this.shape[0],x=this.stride[0],f=this.offset,_=0,b=Math.ceil;return typeof c=="number"&&((_=0|c)<0?(f+=x*(i-1),i=b(-i/_)):i=b(i/_),x*=_),new o(this.data,i,x,f)},p.transpose=function(c){c=c===void 0?0:0|c;var i=this.shape,x=this.stride;return new o(this.data,i[c],x[c],this.offset)},p.pick=function(c){var i=[],x=[],f=this.offset;return typeof c=="number"&&c>=0?f=f+this.stride[0]*c|0:(i.push(this.shape[0]),x.push(this.stride[0])),(0,h[i.length+1])(this.data,i,x,f)},function(c,i,x,f){return new o(c,i[0],x[0],f)}},2:function(s,h,l){function o(c,i,x,f,_,b){this.data=c,this.shape=[i,x],this.stride=[f,_],this.offset=0|b}var p=o.prototype;return p.dtype=s,p.dimension=2,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(p,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),p.set=function(c,i,x){return s==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i,x):this.data[this.offset+this.stride[0]*c+this.stride[1]*i]=x},p.get=function(c,i){return s==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i):this.data[this.offset+this.stride[0]*c+this.stride[1]*i]},p.index=function(c,i){return this.offset+this.stride[0]*c+this.stride[1]*i},p.hi=function(c,i){return new o(this.data,typeof c!="number"||c<0?this.shape[0]:0|c,typeof i!="number"||i<0?this.shape[1]:0|i,this.stride[0],this.stride[1],this.offset)},p.lo=function(c,i){var x=this.offset,f=0,_=this.shape[0],b=this.shape[1],T=this.stride[0],k=this.stride[1];return typeof c=="number"&&c>=0&&(x+=T*(f=0|c),_-=f),typeof i=="number"&&i>=0&&(x+=k*(f=0|i),b-=f),new o(this.data,_,b,T,k,x)},p.step=function(c,i){var x=this.shape[0],f=this.shape[1],_=this.stride[0],b=this.stride[1],T=this.offset,k=0,L=Math.ceil;return typeof c=="number"&&((k=0|c)<0?(T+=_*(x-1),x=L(-x/k)):x=L(x/k),_*=k),typeof i=="number"&&((k=0|i)<0?(T+=b*(f-1),f=L(-f/k)):f=L(f/k),b*=k),new o(this.data,x,f,_,b,T)},p.transpose=function(c,i){c=c===void 0?0:0|c,i=i===void 0?1:0|i;var x=this.shape,f=this.stride;return new o(this.data,x[c],x[i],f[c],f[i],this.offset)},p.pick=function(c,i){var x=[],f=[],_=this.offset;return typeof c=="number"&&c>=0?_=_+this.stride[0]*c|0:(x.push(this.shape[0]),f.push(this.stride[0])),typeof i=="number"&&i>=0?_=_+this.stride[1]*i|0:(x.push(this.shape[1]),f.push(this.stride[1])),(0,h[x.length+1])(this.data,x,f,_)},function(c,i,x,f){return new o(c,i[0],i[1],x[0],x[1],f)}},3:function(s,h,l){function o(c,i,x,f,_,b,T,k){this.data=c,this.shape=[i,x,f],this.stride=[_,b,T],this.offset=0|k}var p=o.prototype;return p.dtype=s,p.dimension=3,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(p,"order",{get:function(){var c=Math.abs(this.stride[0]),i=Math.abs(this.stride[1]),x=Math.abs(this.stride[2]);return c>i?i>x?[2,1,0]:c>x?[1,2,0]:[1,0,2]:c>x?[2,0,1]:x>i?[0,1,2]:[0,2,1]}}),p.set=function(c,i,x,f){return s==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x,f):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x]=f},p.get=function(c,i,x){return s==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x]},p.index=function(c,i,x){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x},p.hi=function(c,i,x){return new o(this.data,typeof c!="number"||c<0?this.shape[0]:0|c,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,this.stride[0],this.stride[1],this.stride[2],this.offset)},p.lo=function(c,i,x){var f=this.offset,_=0,b=this.shape[0],T=this.shape[1],k=this.shape[2],L=this.stride[0],A=this.stride[1],I=this.stride[2];return typeof c=="number"&&c>=0&&(f+=L*(_=0|c),b-=_),typeof i=="number"&&i>=0&&(f+=A*(_=0|i),T-=_),typeof x=="number"&&x>=0&&(f+=I*(_=0|x),k-=_),new o(this.data,b,T,k,L,A,I,f)},p.step=function(c,i,x){var f=this.shape[0],_=this.shape[1],b=this.shape[2],T=this.stride[0],k=this.stride[1],L=this.stride[2],A=this.offset,I=0,P=Math.ceil;return typeof c=="number"&&((I=0|c)<0?(A+=T*(f-1),f=P(-f/I)):f=P(f/I),T*=I),typeof i=="number"&&((I=0|i)<0?(A+=k*(_-1),_=P(-_/I)):_=P(_/I),k*=I),typeof x=="number"&&((I=0|x)<0?(A+=L*(b-1),b=P(-b/I)):b=P(b/I),L*=I),new o(this.data,f,_,b,T,k,L,A)},p.transpose=function(c,i,x){c=c===void 0?0:0|c,i=i===void 0?1:0|i,x=x===void 0?2:0|x;var f=this.shape,_=this.stride;return new o(this.data,f[c],f[i],f[x],_[c],_[i],_[x],this.offset)},p.pick=function(c,i,x){var f=[],_=[],b=this.offset;return typeof c=="number"&&c>=0?b=b+this.stride[0]*c|0:(f.push(this.shape[0]),_.push(this.stride[0])),typeof i=="number"&&i>=0?b=b+this.stride[1]*i|0:(f.push(this.shape[1]),_.push(this.stride[1])),typeof x=="number"&&x>=0?b=b+this.stride[2]*x|0:(f.push(this.shape[2]),_.push(this.stride[2])),(0,h[f.length+1])(this.data,f,_,b)},function(c,i,x,f){return new o(c,i[0],i[1],i[2],x[0],x[1],x[2],f)}},4:function(s,h,l){function o(c,i,x,f,_,b,T,k,L,A){this.data=c,this.shape=[i,x,f,_],this.stride=[b,T,k,L],this.offset=0|A}var p=o.prototype;return p.dtype=s,p.dimension=4,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(p,"order",{get:l}),p.set=function(c,i,x,f,_){return s==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f,_):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f]=_},p.get=function(c,i,x,f){return s==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f]},p.index=function(c,i,x,f){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f},p.hi=function(c,i,x,f){return new o(this.data,typeof c!="number"||c<0?this.shape[0]:0|c,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,typeof f!="number"||f<0?this.shape[3]:0|f,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},p.lo=function(c,i,x,f){var _=this.offset,b=0,T=this.shape[0],k=this.shape[1],L=this.shape[2],A=this.shape[3],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3];return typeof c=="number"&&c>=0&&(_+=I*(b=0|c),T-=b),typeof i=="number"&&i>=0&&(_+=P*(b=0|i),k-=b),typeof x=="number"&&x>=0&&(_+=S*(b=0|x),L-=b),typeof f=="number"&&f>=0&&(_+=E*(b=0|f),A-=b),new o(this.data,T,k,L,A,I,P,S,E,_)},p.step=function(c,i,x,f){var _=this.shape[0],b=this.shape[1],T=this.shape[2],k=this.shape[3],L=this.stride[0],A=this.stride[1],I=this.stride[2],P=this.stride[3],S=this.offset,E=0,z=Math.ceil;return typeof c=="number"&&((E=0|c)<0?(S+=L*(_-1),_=z(-_/E)):_=z(_/E),L*=E),typeof i=="number"&&((E=0|i)<0?(S+=A*(b-1),b=z(-b/E)):b=z(b/E),A*=E),typeof x=="number"&&((E=0|x)<0?(S+=I*(T-1),T=z(-T/E)):T=z(T/E),I*=E),typeof f=="number"&&((E=0|f)<0?(S+=P*(k-1),k=z(-k/E)):k=z(k/E),P*=E),new o(this.data,_,b,T,k,L,A,I,P,S)},p.transpose=function(c,i,x,f){c=c===void 0?0:0|c,i=i===void 0?1:0|i,x=x===void 0?2:0|x,f=f===void 0?3:0|f;var _=this.shape,b=this.stride;return new o(this.data,_[c],_[i],_[x],_[f],b[c],b[i],b[x],b[f],this.offset)},p.pick=function(c,i,x,f){var _=[],b=[],T=this.offset;return typeof c=="number"&&c>=0?T=T+this.stride[0]*c|0:(_.push(this.shape[0]),b.push(this.stride[0])),typeof i=="number"&&i>=0?T=T+this.stride[1]*i|0:(_.push(this.shape[1]),b.push(this.stride[1])),typeof x=="number"&&x>=0?T=T+this.stride[2]*x|0:(_.push(this.shape[2]),b.push(this.stride[2])),typeof f=="number"&&f>=0?T=T+this.stride[3]*f|0:(_.push(this.shape[3]),b.push(this.stride[3])),(0,h[_.length+1])(this.data,_,b,T)},function(c,i,x,f){return new o(c,i[0],i[1],i[2],i[3],x[0],x[1],x[2],x[3],f)}},5:function(s,h,l){function o(c,i,x,f,_,b,T,k,L,A,I,P){this.data=c,this.shape=[i,x,f,_,b],this.stride=[T,k,L,A,I],this.offset=0|P}var p=o.prototype;return p.dtype=s,p.dimension=5,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(p,"order",{get:l}),p.set=function(c,i,x,f,_,b){return s==="generic"?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_,b):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_]=b},p.get=function(c,i,x,f,_){return s==="generic"?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_]},p.index=function(c,i,x,f,_){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_},p.hi=function(c,i,x,f,_){return new o(this.data,typeof c!="number"||c<0?this.shape[0]:0|c,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,typeof f!="number"||f<0?this.shape[3]:0|f,typeof _!="number"||_<0?this.shape[4]:0|_,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},p.lo=function(c,i,x,f,_){var b=this.offset,T=0,k=this.shape[0],L=this.shape[1],A=this.shape[2],I=this.shape[3],P=this.shape[4],S=this.stride[0],E=this.stride[1],z=this.stride[2],D=this.stride[3],j=this.stride[4];return typeof c=="number"&&c>=0&&(b+=S*(T=0|c),k-=T),typeof i=="number"&&i>=0&&(b+=E*(T=0|i),L-=T),typeof x=="number"&&x>=0&&(b+=z*(T=0|x),A-=T),typeof f=="number"&&f>=0&&(b+=D*(T=0|f),I-=T),typeof _=="number"&&_>=0&&(b+=j*(T=0|_),P-=T),new o(this.data,k,L,A,I,P,S,E,z,D,j,b)},p.step=function(c,i,x,f,_){var b=this.shape[0],T=this.shape[1],k=this.shape[2],L=this.shape[3],A=this.shape[4],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3],z=this.stride[4],D=this.offset,j=0,V=Math.ceil;return typeof c=="number"&&((j=0|c)<0?(D+=I*(b-1),b=V(-b/j)):b=V(b/j),I*=j),typeof i=="number"&&((j=0|i)<0?(D+=P*(T-1),T=V(-T/j)):T=V(T/j),P*=j),typeof x=="number"&&((j=0|x)<0?(D+=S*(k-1),k=V(-k/j)):k=V(k/j),S*=j),typeof f=="number"&&((j=0|f)<0?(D+=E*(L-1),L=V(-L/j)):L=V(L/j),E*=j),typeof _=="number"&&((j=0|_)<0?(D+=z*(A-1),A=V(-A/j)):A=V(A/j),z*=j),new o(this.data,b,T,k,L,A,I,P,S,E,z,D)},p.transpose=function(c,i,x,f,_){c=c===void 0?0:0|c,i=i===void 0?1:0|i,x=x===void 0?2:0|x,f=f===void 0?3:0|f,_=_===void 0?4:0|_;var b=this.shape,T=this.stride;return new o(this.data,b[c],b[i],b[x],b[f],b[_],T[c],T[i],T[x],T[f],T[_],this.offset)},p.pick=function(c,i,x,f,_){var b=[],T=[],k=this.offset;return typeof c=="number"&&c>=0?k=k+this.stride[0]*c|0:(b.push(this.shape[0]),T.push(this.stride[0])),typeof i=="number"&&i>=0?k=k+this.stride[1]*i|0:(b.push(this.shape[1]),T.push(this.stride[1])),typeof x=="number"&&x>=0?k=k+this.stride[2]*x|0:(b.push(this.shape[2]),T.push(this.stride[2])),typeof f=="number"&&f>=0?k=k+this.stride[3]*f|0:(b.push(this.shape[3]),T.push(this.stride[3])),typeof _=="number"&&_>=0?k=k+this.stride[4]*_|0:(b.push(this.shape[4]),T.push(this.stride[4])),(0,h[b.length+1])(this.data,b,T,k)},function(c,i,x,f){return new o(c,i[0],i[1],i[2],i[3],i[4],x[0],x[1],x[2],x[3],x[4],f)}}};function g(s,h){var l=h===-1?"T":String(h),o=r[l];return h===-1?o(s):h===0?o(s,u[s][0]):o(s,u[s],a)}var u={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};w.exports=function(s,h,l,o){if(s===void 0)return(0,u.array[0])([]);typeof s=="number"&&(s=[s]),h===void 0&&(h=[s.length]);var p=h.length;if(l===void 0){l=new Array(p);for(var c=p-1,i=1;c>=0;--c)l[c]=i,i*=h[c]}if(o===void 0)for(o=0,c=0;c<p;++c)l[c]<0&&(o-=(h[c]-1)*l[c]);for(var x=function(_){if(e(_))return"buffer";if(t)switch(Object.prototype.toString.call(_)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(_)?"array":"generic"}(s),f=u[x];f.length<=p+1;)f.push(g(x,f.length-1));return(0,f[p+1])(s,h,l,o)}},{"is-buffer":237}],260:[function(v,w,y){var e=v("double-bits"),t=Math.pow(2,-1074);w.exports=function(n,a){if(isNaN(n)||isNaN(a))return NaN;if(n===a)return n;if(n===0)return a<0?-t:t;var r=e.hi(n),g=e.lo(n);return a>n==n>0?g===-1>>>0?(r+=1,g=0):g+=1:g===0?(g=-1>>>0,r-=1):g-=1,e.pack(g,r)}},{"double-bits":64}],261:[function(v,w,y){y.vertexNormals=function(e,t,n){for(var a=t.length,r=new Array(a),g=n===void 0?1e-6:n,u=0;u<a;++u)r[u]=[0,0,0];for(u=0;u<e.length;++u)for(var s=e[u],h=0,l=s[s.length-1],o=s[0],p=0;p<s.length;++p){h=l,l=o,o=s[(p+1)%s.length];for(var c=t[h],i=t[l],x=t[o],f=new Array(3),_=0,b=new Array(3),T=0,k=0;k<3;++k)f[k]=c[k]-i[k],_+=f[k]*f[k],b[k]=x[k]-i[k],T+=b[k]*b[k];if(_*T>g){var L=r[l],A=1/Math.sqrt(_*T);for(k=0;k<3;++k){var I=(k+1)%3,P=(k+2)%3;L[k]+=A*(b[I]*f[P]-b[P]*f[I])}}}for(u=0;u<a;++u){L=r[u];var S=0;for(k=0;k<3;++k)S+=L[k]*L[k];if(S>g)for(A=1/Math.sqrt(S),k=0;k<3;++k)L[k]*=A;else for(k=0;k<3;++k)L[k]=0}return r},y.faceNormals=function(e,t,n){for(var a=e.length,r=new Array(a),g=n===void 0?1e-6:n,u=0;u<a;++u){for(var s=e[u],h=new Array(3),l=0;l<3;++l)h[l]=t[s[l]];var o=new Array(3),p=new Array(3);for(l=0;l<3;++l)o[l]=h[1][l]-h[0][l],p[l]=h[2][l]-h[0][l];var c=new Array(3),i=0;for(l=0;l<3;++l){var x=(l+1)%3,f=(l+2)%3;c[l]=o[x]*p[f]-o[f]*p[x],i+=c[l]*c[l]}for(i=i>g?1/Math.sqrt(i):0,l=0;l<3;++l)c[l]*=i;r[u]=c}return r}},{}],262:[function(v,w,y){w.exports=function(e,t,n,a,r,g,u,s,h,l){var o=t+g+l;if(p>0){var p=Math.sqrt(o+1);e[0]=.5*(u-h)/p,e[1]=.5*(s-a)/p,e[2]=.5*(n-g)/p,e[3]=.5*p}else{var c=Math.max(t,g,l);p=Math.sqrt(2*c-o+1),t>=c?(e[0]=.5*p,e[1]=.5*(r+n)/p,e[2]=.5*(s+a)/p,e[3]=.5*(u-h)/p):g>=c?(e[0]=.5*(n+r)/p,e[1]=.5*p,e[2]=.5*(h+u)/p,e[3]=.5*(s-a)/p):(e[0]=.5*(a+s)/p,e[1]=.5*(u+h)/p,e[2]=.5*p,e[3]=.5*(n-r)/p)}return e}},{}],263:[function(v,w,y){w.exports=function(o){var p=(o=o||{}).center||[0,0,0],c=o.rotation||[0,0,0,1],i=o.radius||1;p=[].slice.call(p,0,3),s(c=[].slice.call(c,0,4),c);var x=new h(c,p,Math.log(i));return x.setDistanceLimits(o.zoomMin,o.zoomMax),("eye"in o||"up"in o)&&x.lookAt(0,o.eye,o.center,o.up),x};var e=v("filtered-vector"),t=v("gl-mat4/lookAt"),n=v("gl-mat4/fromQuat"),a=v("gl-mat4/invert"),r=v("./lib/quatFromFrame");function g(o,p,c){return Math.sqrt(Math.pow(o,2)+Math.pow(p,2)+Math.pow(c,2))}function u(o,p,c,i){return Math.sqrt(Math.pow(o,2)+Math.pow(p,2)+Math.pow(c,2)+Math.pow(i,2))}function s(o,p){var c=p[0],i=p[1],x=p[2],f=p[3],_=u(c,i,x,f);_>1e-6?(o[0]=c/_,o[1]=i/_,o[2]=x/_,o[3]=f/_):(o[0]=o[1]=o[2]=0,o[3]=1)}function h(o,p,c){this.radius=e([c]),this.center=e(p),this.rotation=e(o),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var l=h.prototype;l.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},l.recalcMatrix=function(o){this.radius.curve(o),this.center.curve(o),this.rotation.curve(o);var p=this.computedRotation;s(p,p);var c=this.computedMatrix;n(c,p);var i=this.computedCenter,x=this.computedEye,f=this.computedUp,_=Math.exp(this.computedRadius[0]);x[0]=i[0]+_*c[2],x[1]=i[1]+_*c[6],x[2]=i[2]+_*c[10],f[0]=c[1],f[1]=c[5],f[2]=c[9];for(var b=0;b<3;++b){for(var T=0,k=0;k<3;++k)T+=c[b+4*k]*x[k];c[12+b]=-T}},l.getMatrix=function(o,p){this.recalcMatrix(o);var c=this.computedMatrix;if(p){for(var i=0;i<16;++i)p[i]=c[i];return p}return c},l.idle=function(o){this.center.idle(o),this.radius.idle(o),this.rotation.idle(o)},l.flush=function(o){this.center.flush(o),this.radius.flush(o),this.rotation.flush(o)},l.pan=function(o,p,c,i){p=p||0,c=c||0,i=i||0,this.recalcMatrix(o);var x=this.computedMatrix,f=x[1],_=x[5],b=x[9],T=g(f,_,b);f/=T,_/=T,b/=T;var k=x[0],L=x[4],A=x[8],I=k*f+L*_+A*b,P=g(k-=f*I,L-=_*I,A-=b*I);k/=P,L/=P,A/=P,x[2],x[6],x[10];var S=k*p+f*c,E=L*p+_*c,z=A*p+b*c;this.center.move(o,S,E,z);var D=Math.exp(this.computedRadius[0]);D=Math.max(1e-4,D+i),this.radius.set(o,Math.log(D))},l.rotate=function(o,p,c,i){this.recalcMatrix(o),p=p||0,c=c||0;var x=this.computedMatrix,f=x[0],_=x[4],b=x[8],T=x[1],k=x[5],L=x[9],A=x[2],I=x[6],P=x[10],S=p*f+c*T,E=p*_+c*k,z=p*b+c*L,D=-(I*z-P*E),j=-(P*S-A*z),V=-(A*E-I*S),Z=Math.sqrt(Math.max(0,1-Math.pow(D,2)-Math.pow(j,2)-Math.pow(V,2))),Q=u(D,j,V,Z);Q>1e-6?(D/=Q,j/=Q,V/=Q,Z/=Q):(D=j=V=0,Z=1);var K=this.computedRotation,$=K[0],ne=K[1],H=K[2],N=K[3],U=$*Z+N*D+ne*V-H*j,te=ne*Z+N*j+H*D-$*V,B=H*Z+N*V+$*j-ne*D,X=N*Z-$*D-ne*j-H*V;if(i){D=A,j=I,V=P;var J=Math.sin(i)/g(D,j,V);D*=J,j*=J,V*=J,X=X*(Z=Math.cos(p))-(U=U*Z+X*D+te*V-B*j)*D-(te=te*Z+X*j+B*D-U*V)*j-(B=B*Z+X*V+U*j-te*D)*V}var ee=u(U,te,B,X);ee>1e-6?(U/=ee,te/=ee,B/=ee,X/=ee):(U=te=B=0,X=1),this.rotation.set(o,U,te,B,X)},l.lookAt=function(o,p,c,i){this.recalcMatrix(o),c=c||this.computedCenter,p=p||this.computedEye,i=i||this.computedUp;var x=this.computedMatrix;t(x,p,c,i);var f=this.computedRotation;r(f,x[0],x[1],x[2],x[4],x[5],x[6],x[8],x[9],x[10]),s(f,f),this.rotation.set(o,f[0],f[1],f[2],f[3]);for(var _=0,b=0;b<3;++b)_+=Math.pow(c[b]-p[b],2);this.radius.set(o,.5*Math.log(Math.max(_,1e-6))),this.center.set(o,c[0],c[1],c[2])},l.translate=function(o,p,c,i){this.center.move(o,p||0,c||0,i||0)},l.setMatrix=function(o,p){var c=this.computedRotation;r(c,p[0],p[1],p[2],p[4],p[5],p[6],p[8],p[9],p[10]),s(c,c),this.rotation.set(o,c[0],c[1],c[2],c[3]);var i=this.computedMatrix;a(i,p);var x=i[15];if(Math.abs(x)>1e-6){var f=i[12]/x,_=i[13]/x,b=i[14]/x;this.recalcMatrix(o);var T=Math.exp(this.computedRadius[0]);this.center.set(o,f-i[2]*T,_-i[6]*T,b-i[10]*T),this.radius.idle(o)}else this.center.idle(o),this.radius.idle(o)},l.setDistance=function(o,p){p>0&&this.radius.set(o,Math.log(p))},l.setDistanceLimits=function(o,p){o=o>0?Math.log(o):-1/0,p=p>0?Math.log(p):1/0,p=Math.max(p,o),this.radius.bounds[0][0]=o,this.radius.bounds[1][0]=p},l.getDistanceLimits=function(o){var p=this.radius.bounds;return o?(o[0]=Math.exp(p[0][0]),o[1]=Math.exp(p[1][0]),o):[Math.exp(p[0][0]),Math.exp(p[1][0])]},l.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},l.fromJSON=function(o){var p=this.lastT(),c=o.center;c&&this.center.set(p,c[0],c[1],c[2]);var i=o.rotation;i&&this.rotation.set(p,i[0],i[1],i[2],i[3]);var x=o.distance;x&&x>0&&this.radius.set(p,Math.log(x)),this.setDistanceLimits(o.zoomMin,o.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(v,w,y){var e=v("repeat-string");w.exports=function(t,n,a){return e(a=a!==void 0?a+"":" ",n)+t}},{"repeat-string":277}],265:[function(v,w,y){w.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],266:[function(v,w,y){w.exports=function(t,n){for(var a=0|n.length,r=t.length,g=[new Array(a),new Array(a)],u=0;u<a;++u)g[0][u]=[],g[1][u]=[];for(u=0;u<r;++u){var s=t[u];g[0][s[0]].push(s),g[1][s[1]].push(s)}var h=[];for(u=0;u<a;++u)g[0][u].length+g[1][u].length===0&&h.push([u]);function l(_,b){var T=g[b][_[b]];T.splice(T.indexOf(_),1)}function o(_,b,T){for(var k,L,A,I=0;I<2;++I)if(g[I][b].length>0){k=g[I][b][0],A=I;break}L=k[1^A];for(var P=0;P<2;++P)for(var S=g[P][b],E=0;E<S.length;++E){var z=S[E],D=z[1^P];e(n[_],n[b],n[L],n[D])>0&&(k=z,L=D,A=P)}return T||k&&l(k,A),L}function p(_,b){var T=g[b][_][0],k=[_];l(T,b);for(var L=T[1^b];;){for(;L!==_;)k.push(L),L=o(k[k.length-2],L,!1);if(g[0][_].length+g[1][_].length===0)break;var A=k[k.length-1],I=_,P=k[1],S=o(A,I,!0);if(e(n[A],n[I],n[P],n[S])<0)break;k.push(_),L=o(A,I)}return k}function c(_,b){return b[1]===b[b.length-1]}for(u=0;u<a;++u)for(var i=0;i<2;++i){for(var x=[];g[i][u].length>0;){g[0][u].length;var f=p(u,i);c(0,f)?x.push.apply(x,f):(x.length>0&&h.push(x),x=f)}x.length>0&&h.push(x)}return h};var e=v("compare-angle")},{"compare-angle":54}],267:[function(v,w,y){w.exports=function(t,n){for(var a=e(t,n.length),r=new Array(n.length),g=new Array(n.length),u=[],s=0;s<n.length;++s){var h=a[s].length;g[s]=h,r[s]=!0,h<=1&&u.push(s)}for(;u.length>0;){var l=u.pop();r[l]=!1;var o=a[l];for(s=0;s<o.length;++s){var p=o[s];--g[p]==0&&u.push(p)}}var c=new Array(n.length),i=[];for(s=0;s<n.length;++s)r[s]?(l=i.length,c[s]=l,i.push(n[s])):c[s]=-1;var x=[];for(s=0;s<t.length;++s){var f=t[s];r[f[0]]&&r[f[1]]&&x.push([c[f[0]],c[f[1]]])}return[x,i]};var e=v("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(v,w,y){w.exports=function(h,l){var o=u(h,l);h=o[0];for(var p=(l=o[1]).length,c=(h.length,e(h,l.length)),i=0;i<p;++i)if(c[i].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var x=t(h,l),f=(x=x.filter(function(oe){for(var de=oe.length,ce=[0],ve=0;ve<de;++ve){var Ae=l[oe[ve]],fe=l[oe[(ve+1)%de]],me=a(-Ae[0],Ae[1]),_e=a(-Ae[0],fe[1]),le=a(fe[0],Ae[1]),ge=a(fe[0],fe[1]);ce=r(ce,r(r(me,_e),r(le,ge)))}return ce[ce.length-1]>0})).length,_=new Array(f),b=new Array(f);for(i=0;i<f;++i){_[i]=i;var T=new Array(f),k=x[i].map(function(oe){return l[oe]}),L=n([k]),A=0;e:for(var I=0;I<f;++I)if(T[I]=0,i!==I){for(var P=(re=x[I]).length,S=0;S<P;++S){var E=L(l[re[S]]);if(E!==0){E<0&&(T[I]=1,A+=1);continue e}}T[I]=1,A+=1}b[i]=[A,i,T]}for(b.sort(function(oe,de){return de[0]-oe[0]}),i=0;i<f;++i){var z=(T=b[i])[1],D=T[2];for(I=0;I<f;++I)D[I]&&(_[I]=z)}var j=function(oe){for(var de=new Array(oe),ce=0;ce<oe;++ce)de[ce]=[];return de}(f);for(i=0;i<f;++i)j[i].push(_[i]),j[_[i]].push(i);var V={},Z=s(p,!1);for(i=0;i<f;++i)for(P=(re=x[i]).length,I=0;I<P;++I){var Q=re[I],K=re[(I+1)%P],$=Math.min(Q,K)+":"+Math.max(Q,K);if($ in V){var ne=V[$];j[ne].push(i),j[i].push(ne),Z[Q]=Z[K]=!0}else V[$]=i}function H(oe){for(var de=oe.length,ce=0;ce<de;++ce)if(!Z[oe[ce]])return!1;return!0}var N=[],U=s(f,-1);for(i=0;i<f;++i)_[i]!==i||H(x[i])?U[i]=-1:(N.push(i),U[i]=0);for(o=[];N.length>0;){var te=N.pop(),B=j[te];g(B,function(oe,de){return oe-de});var X,J=B.length,ee=U[te];if(ee===0){var re=x[te];X=[re]}for(i=0;i<J;++i){var se=B[i];U[se]>=0||(U[se]=1^ee,N.push(se),ee===0&&(H(re=x[se])||(re.reverse(),X.push(re))))}ee===0&&o.push(X)}return o};var e=v("edges-to-adjacency-list"),t=v("planar-dual"),n=v("point-in-big-polygon"),a=v("two-product"),r=v("robust-sum"),g=v("uniq"),u=v("./lib/trim-leaves");function s(h,l){for(var o=new Array(h),p=0;p<h;++p)o[p]=l;return o}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(v,w,y){w.exports=function(s){for(var h=s.length,l=[],o=[],p=0;p<h;++p)for(var c=s[p],i=c.length,x=i-1,f=0;f<i;x=f++){var _=c[x],b=c[f];_[0]===b[0]?o.push([_,b]):l.push([_,b])}if(l.length===0)return o.length===0?u:(T=g(o),function(A){return T(A[0],A[1])?0:1});var T,k=t(l),L=function(A,I){return function(P){var S=a.le(I,P[0]);if(S<0)return 1;var E=A[S];if(!E){if(!(S>0&&I[S]===P[0]))return 1;E=A[S-1]}for(var z=1;E;){var D=E.key,j=e(P,D[0],D[1]);if(D[0][0]<D[1][0])if(j<0)E=E.left;else{if(!(j>0))return 0;z=-1,E=E.right}else if(j>0)E=E.left;else{if(!(j<0))return 0;z=1,E=E.right}}return z}}(k.slabs,k.coordinates);return o.length===0?L:function(A,I){return function(P){return A(P[0],P[1])?0:I(P)}}(g(o),L)};var e=v("robust-orientation")[3],t=v("slab-decomposition"),n=v("interval-tree-1d"),a=v("binary-search-bounds");function r(){return!0}function g(s){for(var h={},l=0;l<s.length;++l){var o=s[l],p=o[0][0],c=o[0][1],i=o[1][1],x=[Math.min(c,i),Math.max(c,i)];p in h?h[p].push(x):h[p]=[x]}var f={},_=Object.keys(h);for(l=0;l<_.length;++l){var b=h[_[l]];f[_[l]]=n(b)}return function(T){return function(k,L){var A=T[k];return!!A&&!!A.queryPoint(L,r)}}(f)}function u(s){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(v,w,y){var e=new Float64Array(4),t=new Float64Array(4),n=new Float64Array(4);w.exports=function(a,r,g,u,s){e.length<u.length&&(e=new Float64Array(u.length),t=new Float64Array(u.length),n=new Float64Array(u.length));for(var h=0;h<u.length;++h)e[h]=a[h]-u[h],t[h]=r[h]-a[h],n[h]=g[h]-a[h];var l=0,o=0,p=0,c=0,i=0,x=0;for(h=0;h<u.length;++h){var f=t[h],_=n[h],b=e[h];l+=f*f,o+=f*_,p+=_*_,c+=b*f,i+=b*_,x+=b*b}var T,k,L,A,I,P=Math.abs(l*p-o*o),S=o*i-p*c,E=o*c-l*i;if(S+E<=P)if(S<0)E<0&&c<0?(E=0,-c>=l?(S=1,T=l+2*c+x):T=c*(S=-c/l)+x):(S=0,i>=0?(E=0,T=x):-i>=p?(E=1,T=p+2*i+x):T=i*(E=-i/p)+x);else if(E<0)E=0,c>=0?(S=0,T=x):-c>=l?(S=1,T=l+2*c+x):T=c*(S=-c/l)+x;else{var z=1/P;T=(S*=z)*(l*S+o*(E*=z)+2*c)+E*(o*S+p*E+2*i)+x}else S<0?(L=p+i)>(k=o+c)?(A=L-k)>=(I=l-2*o+p)?(S=1,E=0,T=l+2*c+x):T=(S=A/I)*(l*S+o*(E=1-S)+2*c)+E*(o*S+p*E+2*i)+x:(S=0,L<=0?(E=1,T=p+2*i+x):i>=0?(E=0,T=x):T=i*(E=-i/p)+x):E<0?(L=l+c)>(k=o+i)?(A=L-k)>=(I=l-2*o+p)?(E=1,S=0,T=p+2*i+x):T=(S=1-(E=A/I))*(l*S+o*E+2*c)+E*(o*S+p*E+2*i)+x:(E=0,L<=0?(S=1,T=l+2*c+x):c>=0?(S=0,T=x):T=c*(S=-c/l)+x):(A=p+i-o-c)<=0?(S=0,E=1,T=p+2*i+x):A>=(I=l-2*o+p)?(S=1,E=0,T=l+2*c+x):T=(S=A/I)*(l*S+o*(E=1-S)+2*c)+E*(o*S+p*E+2*i)+x;var D=1-S-E;for(h=0;h<u.length;++h)s[h]=D*a[h]+S*r[h]+E*g[h];return T<0?0:T}},{}],271:[function(v,w,y){w.exports=v("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(v,w,y){var e=v("big-rat/add");w.exports=function(t,n){for(var a=t.length,r=new Array(a),g=0;g<a;++g)r[g]=e(t[g],n[g]);return r}},{"big-rat/add":15}],273:[function(v,w,y){w.exports=function(t){for(var n=new Array(t.length),a=0;a<t.length;++a)n[a]=e(t[a]);return n};var e=v("big-rat")},{"big-rat":18}],274:[function(v,w,y){var e=v("big-rat"),t=v("big-rat/mul");w.exports=function(n,a){for(var r=e(a),g=n.length,u=new Array(g),s=0;s<g;++s)u[s]=t(n[s],r);return u}},{"big-rat":18,"big-rat/mul":27}],275:[function(v,w,y){var e=v("big-rat/sub");w.exports=function(t,n){for(var a=t.length,r=new Array(a),g=0;g<a;++g)r[g]=e(t[g],n[g]);return r}},{"big-rat/sub":29}],276:[function(v,w,y){var e=v("compare-cell"),t=v("compare-oriented-cell"),n=v("cell-orientation");w.exports=function(a){a.sort(t);for(var r=a.length,g=0,u=0;u<r;++u){var s=a[u],h=n(s);if(h!==0){if(g>0){var l=a[g-1];if(e(s,l)===0&&n(l)!==h){g-=1;continue}}a[g++]=s}}return a.length=g,a}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(v,w,y){var e,t="";w.exports=function(n,a){if(typeof n!="string")throw new TypeError("expected a string");if(a===1)return n;if(a===2)return n+n;var r=n.length*a;if(e!==n||e===void 0)e=n,t="";else if(t.length>=r)return t.substr(0,r);for(;r>t.length&&a>1;)1&a&&(t+=n),a>>=1,n+=n;return t=(t+=n).substr(0,r)}},{}],278:[function(v,w,y){(function(e){(function(){w.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,d!==void 0?d:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(v,w,y){w.exports=function(e){for(var t=e.length,n=e[e.length-1],a=t,r=t-2;r>=0;--r){var g=n,u=e[r];(h=u-((n=g+u)-g))&&(e[--a]=n,n=h)}var s=0;for(r=a;r<t;++r){var h;g=e[r],(h=(u=n)-((n=g+u)-g))&&(e[s++]=h)}return e[s++]=n,e.length=s,e}},{}],280:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-scale"),a=v("robust-compress");function r(p,c,i,x){return function(f){return x(p(i(f[0][0],f[1][1]),i(-f[0][1],f[1][0])))}}function g(p,c,i,x){return function(f){return x(p(c(p(i(f[1][1],f[2][2]),i(-f[1][2],f[2][1])),f[0][0]),p(c(p(i(f[1][0],f[2][2]),i(-f[1][2],f[2][0])),-f[0][1]),c(p(i(f[1][0],f[2][1]),i(-f[1][1],f[2][0])),f[0][2]))))}}function u(p,c,i,x){return function(f){return x(p(p(c(p(c(p(i(f[2][2],f[3][3]),i(-f[2][3],f[3][2])),f[1][1]),p(c(p(i(f[2][1],f[3][3]),i(-f[2][3],f[3][1])),-f[1][2]),c(p(i(f[2][1],f[3][2]),i(-f[2][2],f[3][1])),f[1][3]))),f[0][0]),c(p(c(p(i(f[2][2],f[3][3]),i(-f[2][3],f[3][2])),f[1][0]),p(c(p(i(f[2][0],f[3][3]),i(-f[2][3],f[3][0])),-f[1][2]),c(p(i(f[2][0],f[3][2]),i(-f[2][2],f[3][0])),f[1][3]))),-f[0][1])),p(c(p(c(p(i(f[2][1],f[3][3]),i(-f[2][3],f[3][1])),f[1][0]),p(c(p(i(f[2][0],f[3][3]),i(-f[2][3],f[3][0])),-f[1][1]),c(p(i(f[2][0],f[3][1]),i(-f[2][1],f[3][0])),f[1][3]))),f[0][2]),c(p(c(p(i(f[2][1],f[3][2]),i(-f[2][2],f[3][1])),f[1][0]),p(c(p(i(f[2][0],f[3][2]),i(-f[2][2],f[3][0])),-f[1][1]),c(p(i(f[2][0],f[3][1]),i(-f[2][1],f[3][0])),f[1][2]))),-f[0][3]))))}}function s(p,c,i,x){return function(f){return x(p(p(c(p(p(c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][2]),p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),-f[2][3]),c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][4]))),f[1][1]),c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][1]),p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][3]),c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][4]))),-f[1][2])),p(c(p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][1]),p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][2]),c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][4]))),f[1][3]),c(p(c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][1]),p(c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),-f[2][2]),c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][3]))),-f[1][4]))),f[0][0]),c(p(p(c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][2]),p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),-f[2][3]),c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][4]))),f[1][0]),c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][3]),c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),f[2][4]))),-f[1][2])),p(c(p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][2]),c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][4]))),f[1][3]),c(p(c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][0]),p(c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][2]),c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][3]))),-f[1][4]))),-f[0][1])),p(c(p(p(c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][1]),p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][3]),c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][4]))),f[1][0]),c(p(c(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][3]),c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),f[2][4]))),-f[1][1])),p(c(p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][4]))),f[1][3]),c(p(c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][3]))),-f[1][4]))),f[0][2]),p(c(p(p(c(p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][1]),p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][2]),c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][4]))),f[1][0]),c(p(c(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][2]),c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][4]))),-f[1][1])),p(c(p(c(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][4]))),f[1][2]),c(p(c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][2]))),-f[1][4]))),-f[0][3]),c(p(p(c(p(c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][1]),p(c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),-f[2][2]),c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][3]))),f[1][0]),c(p(c(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][0]),p(c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][2]),c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][3]))),-f[1][1])),p(c(p(c(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][3]))),f[1][2]),c(p(c(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][0]),p(c(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),-f[2][1]),c(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][2]))),-f[1][3]))),f[0][4])))))}}function h(p){return(p===2?r:p===3?g:p===4?u:p===5?s:void 0)(t,n,e,a)}var l=[function(){return[0]},function(p){return[p[0][0]]}];function o(p,c,i,x,f,_,b,T){return function(k){switch(k.length){case 0:return p(k);case 1:return c(k);case 2:return i(k);case 3:return x(k);case 4:return f(k);case 5:return _(k)}var L=b[k.length];return L||(L=b[k.length]=T(k.length)),L(k)}}(function(){for(;l.length<6;)l.push(h(l.length));w.exports=o.apply(void 0,l.concat([l,h]));for(var p=0;p<l.length;++p)w.exports[p]=l[p]})()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(v,w,y){var e=v("two-product"),t=v("robust-sum");w.exports=function(n,a){for(var r=e(n[0],a[0]),g=1;g<n.length;++g)r=t(r,e(n[g],a[g]));return r}},{"robust-sum":289,"two-product":306}],282:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-subtract"),a=v("robust-scale");function r(c){return(c===3?g:c===4?u:c===5?s:h)(t,n,e,a)}function g(c,i,x,f){return function(_,b,T){var k=x(_[0],_[0]),L=f(k,b[0]),A=f(k,T[0]),I=x(b[0],b[0]),P=f(I,_[0]),S=f(I,T[0]),E=x(T[0],T[0]),z=f(E,_[0]),D=f(E,b[0]),j=c(i(D,S),i(P,L)),V=i(z,A),Z=i(j,V);return Z[Z.length-1]}}function u(c,i,x,f){return function(_,b,T,k){var L=c(x(_[0],_[0]),x(_[1],_[1])),A=f(L,b[0]),I=f(L,T[0]),P=f(L,k[0]),S=c(x(b[0],b[0]),x(b[1],b[1])),E=f(S,_[0]),z=f(S,T[0]),D=f(S,k[0]),j=c(x(T[0],T[0]),x(T[1],T[1])),V=f(j,_[0]),Z=f(j,b[0]),Q=f(j,k[0]),K=c(x(k[0],k[0]),x(k[1],k[1])),$=f(K,_[0]),ne=f(K,b[0]),H=f(K,T[0]),N=c(c(f(i(H,Q),b[1]),c(f(i(ne,D),-T[1]),f(i(Z,z),k[1]))),c(f(i(ne,D),_[1]),c(f(i($,P),-b[1]),f(i(E,A),k[1])))),U=c(c(f(i(H,Q),_[1]),c(f(i($,P),-T[1]),f(i(V,I),k[1]))),c(f(i(Z,z),_[1]),c(f(i(V,I),-b[1]),f(i(E,A),T[1])))),te=i(N,U);return te[te.length-1]}}function s(c,i,x,f){return function(_,b,T,k,L){var A=c(x(_[0],_[0]),c(x(_[1],_[1]),x(_[2],_[2]))),I=f(A,b[0]),P=f(A,T[0]),S=f(A,k[0]),E=f(A,L[0]),z=c(x(b[0],b[0]),c(x(b[1],b[1]),x(b[2],b[2]))),D=f(z,_[0]),j=f(z,T[0]),V=f(z,k[0]),Z=f(z,L[0]),Q=c(x(T[0],T[0]),c(x(T[1],T[1]),x(T[2],T[2]))),K=f(Q,_[0]),$=f(Q,b[0]),ne=f(Q,k[0]),H=f(Q,L[0]),N=c(x(k[0],k[0]),c(x(k[1],k[1]),x(k[2],k[2]))),U=f(N,_[0]),te=f(N,b[0]),B=f(N,T[0]),X=f(N,L[0]),J=c(x(L[0],L[0]),c(x(L[1],L[1]),x(L[2],L[2]))),ee=f(J,_[0]),re=f(J,b[0]),se=f(J,T[0]),oe=f(J,k[0]),de=c(c(c(f(c(f(i(oe,X),T[1]),c(f(i(se,H),-k[1]),f(i(B,ne),L[1]))),b[2]),c(f(c(f(i(oe,X),b[1]),c(f(i(re,Z),-k[1]),f(i(te,V),L[1]))),-T[2]),f(c(f(i(se,H),b[1]),c(f(i(re,Z),-T[1]),f(i($,j),L[1]))),k[2]))),c(f(c(f(i(B,ne),b[1]),c(f(i(te,V),-T[1]),f(i($,j),k[1]))),-L[2]),c(f(c(f(i(oe,X),b[1]),c(f(i(re,Z),-k[1]),f(i(te,V),L[1]))),_[2]),f(c(f(i(oe,X),_[1]),c(f(i(ee,E),-k[1]),f(i(U,S),L[1]))),-b[2])))),c(c(f(c(f(i(re,Z),_[1]),c(f(i(ee,E),-b[1]),f(i(D,I),L[1]))),k[2]),c(f(c(f(i(te,V),_[1]),c(f(i(U,S),-b[1]),f(i(D,I),k[1]))),-L[2]),f(c(f(i(B,ne),b[1]),c(f(i(te,V),-T[1]),f(i($,j),k[1]))),_[2]))),c(f(c(f(i(B,ne),_[1]),c(f(i(U,S),-T[1]),f(i(K,P),k[1]))),-b[2]),c(f(c(f(i(te,V),_[1]),c(f(i(U,S),-b[1]),f(i(D,I),k[1]))),T[2]),f(c(f(i($,j),_[1]),c(f(i(K,P),-b[1]),f(i(D,I),T[1]))),-k[2]))))),ce=c(c(c(f(c(f(i(oe,X),T[1]),c(f(i(se,H),-k[1]),f(i(B,ne),L[1]))),_[2]),f(c(f(i(oe,X),_[1]),c(f(i(ee,E),-k[1]),f(i(U,S),L[1]))),-T[2])),c(f(c(f(i(se,H),_[1]),c(f(i(ee,E),-T[1]),f(i(K,P),L[1]))),k[2]),f(c(f(i(B,ne),_[1]),c(f(i(U,S),-T[1]),f(i(K,P),k[1]))),-L[2]))),c(c(f(c(f(i(se,H),b[1]),c(f(i(re,Z),-T[1]),f(i($,j),L[1]))),_[2]),f(c(f(i(se,H),_[1]),c(f(i(ee,E),-T[1]),f(i(K,P),L[1]))),-b[2])),c(f(c(f(i(re,Z),_[1]),c(f(i(ee,E),-b[1]),f(i(D,I),L[1]))),T[2]),f(c(f(i($,j),_[1]),c(f(i(K,P),-b[1]),f(i(D,I),T[1]))),-L[2])))),ve=i(de,ce);return ve[ve.length-1]}}function h(c,i,x,f){return function(_,b,T,k,L,A){var I=c(c(x(_[0],_[0]),x(_[1],_[1])),c(x(_[2],_[2]),x(_[3],_[3]))),P=f(I,b[0]),S=f(I,T[0]),E=f(I,k[0]),z=f(I,L[0]),D=f(I,A[0]),j=c(c(x(b[0],b[0]),x(b[1],b[1])),c(x(b[2],b[2]),x(b[3],b[3]))),V=f(j,_[0]),Z=f(j,T[0]),Q=f(j,k[0]),K=f(j,L[0]),$=f(j,A[0]),ne=c(c(x(T[0],T[0]),x(T[1],T[1])),c(x(T[2],T[2]),x(T[3],T[3]))),H=f(ne,_[0]),N=f(ne,b[0]),U=f(ne,k[0]),te=f(ne,L[0]),B=f(ne,A[0]),X=c(c(x(k[0],k[0]),x(k[1],k[1])),c(x(k[2],k[2]),x(k[3],k[3]))),J=f(X,_[0]),ee=f(X,b[0]),re=f(X,T[0]),se=f(X,L[0]),oe=f(X,A[0]),de=c(c(x(L[0],L[0]),x(L[1],L[1])),c(x(L[2],L[2]),x(L[3],L[3]))),ce=f(de,_[0]),ve=f(de,b[0]),Ae=f(de,T[0]),fe=f(de,k[0]),me=f(de,A[0]),_e=c(c(x(A[0],A[0]),x(A[1],A[1])),c(x(A[2],A[2]),x(A[3],A[3]))),le=f(_e,_[0]),ge=f(_e,b[0]),Te=f(_e,T[0]),Se=f(_e,k[0]),Me=f(_e,L[0]),ze=c(c(c(f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),T[2]),f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),-k[2])),c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),L[2]),f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),-A[2]))),b[3]),c(f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),b[2]),f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),-k[2])),c(f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),L[2]),f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),-A[2]))),-T[3]),f(c(c(f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),b[2]),f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),-T[2])),c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),L[2]),f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),-A[2]))),k[3]))),c(c(f(c(c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),b[2]),f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),-T[2])),c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),k[2]),f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-A[2]))),-L[3]),f(c(c(f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),b[2]),f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),-T[2])),c(f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),k[2]),f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-L[2]))),A[3])),c(f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),b[2]),f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),-k[2])),c(f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),L[2]),f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),-A[2]))),_[3]),f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-k[2])),c(f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),L[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-A[2]))),-b[3])))),c(c(c(f(c(c(f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),L[2]),f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),-A[2]))),k[3]),f(c(c(f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),_[2]),f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),k[2]),f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-A[2]))),-L[3])),c(f(c(c(f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),_[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-b[2])),c(f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),k[2]),f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-L[2]))),A[3]),f(c(c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),b[2]),f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),-T[2])),c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),k[2]),f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-A[2]))),_[3]))),c(c(f(c(c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),_[2]),f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-T[2])),c(f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),k[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-A[2]))),-b[3]),f(c(c(f(c(f(i(Se,oe),b[1]),c(f(i(ge,$),-k[1]),f(i(ee,Q),A[1]))),_[2]),f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),k[2]),f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-A[2]))),T[3])),c(f(c(c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),_[2]),f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-A[2]))),-k[3]),f(c(c(f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),_[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-b[2])),c(f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-k[2]))),A[3]))))),Oe=c(c(c(f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),T[2]),f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),-k[2])),c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),L[2]),f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),-A[2]))),_[3]),c(f(c(c(f(c(f(i(Me,me),k[1]),c(f(i(Se,oe),-L[1]),f(i(fe,se),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-k[2])),c(f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),L[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-A[2]))),-T[3]),f(c(c(f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-T[2])),c(f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),L[2]),f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-A[2]))),k[3]))),c(c(f(c(c(f(c(f(i(Se,oe),T[1]),c(f(i(Te,B),-k[1]),f(i(re,U),A[1]))),_[2]),f(c(f(i(Se,oe),_[1]),c(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-T[2])),c(f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),k[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-A[2]))),-L[3]),f(c(c(f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),_[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-T[2])),c(f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),k[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-L[2]))),A[3])),c(f(c(c(f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),b[2]),f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),-T[2])),c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),L[2]),f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),-A[2]))),_[3]),f(c(c(f(c(f(i(Me,me),T[1]),c(f(i(Te,B),-L[1]),f(i(Ae,te),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-T[2])),c(f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),L[2]),f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-A[2]))),-b[3])))),c(c(c(f(c(c(f(c(f(i(Me,me),b[1]),c(f(i(ge,$),-L[1]),f(i(ve,K),A[1]))),_[2]),f(c(f(i(Me,me),_[1]),c(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),L[2]),f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),-A[2]))),T[3]),f(c(c(f(c(f(i(Te,B),b[1]),c(f(i(ge,$),-T[1]),f(i(N,Z),A[1]))),_[2]),f(c(f(i(Te,B),_[1]),c(f(i(le,D),-T[1]),f(i(H,S),A[1]))),-b[2])),c(f(c(f(i(ge,$),_[1]),c(f(i(le,D),-b[1]),f(i(V,P),A[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-A[2]))),-L[3])),c(f(c(c(f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),_[2]),f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-b[2])),c(f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-L[2]))),A[3]),f(c(c(f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),b[2]),f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),-T[2])),c(f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),k[2]),f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-L[2]))),_[3]))),c(c(f(c(c(f(c(f(i(fe,se),T[1]),c(f(i(Ae,te),-k[1]),f(i(re,U),L[1]))),_[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-T[2])),c(f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),k[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-L[2]))),-b[3]),f(c(c(f(c(f(i(fe,se),b[1]),c(f(i(ve,K),-k[1]),f(i(ee,Q),L[1]))),_[2]),f(c(f(i(fe,se),_[1]),c(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-b[2])),c(f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),k[2]),f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-L[2]))),T[3])),c(f(c(c(f(c(f(i(Ae,te),b[1]),c(f(i(ve,K),-T[1]),f(i(N,Z),L[1]))),_[2]),f(c(f(i(Ae,te),_[1]),c(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-b[2])),c(f(c(f(i(ve,K),_[1]),c(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-L[2]))),-k[3]),f(c(c(f(c(f(i(re,U),b[1]),c(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),_[2]),f(c(f(i(re,U),_[1]),c(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-b[2])),c(f(c(f(i(ee,Q),_[1]),c(f(i(J,E),-b[1]),f(i(V,P),k[1]))),T[2]),f(c(f(i(N,Z),_[1]),c(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-k[2]))),L[3]))))),De=i(ze,Oe);return De[De.length-1]}}var l=[function(){return 0},function(){return 0},function(){return 0}];function o(c){var i=l[c.length];return i||(i=l[c.length]=r(c.length)),i.apply(void 0,c)}function p(c,i,x,f,_,b,T,k){return function(L,A,I,P,S,E){switch(arguments.length){case 0:case 1:return 0;case 2:return f(L,A);case 3:return _(L,A,I);case 4:return b(L,A,I,P);case 5:return T(L,A,I,P,S);case 6:return k(L,A,I,P,S,E)}for(var z=new Array(arguments.length),D=0;D<arguments.length;++D)z[D]=arguments[D];return c(z)}}(function(){for(;l.length<=6;)l.push(r(l.length));w.exports=p.apply(void 0,[o].concat(l));for(var c=0;c<=6;++c)w.exports[c]=l[c]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(v,w,y){var e=v("robust-determinant");function t(l){var o=l===2?n:l===3?a:l===4?r:l===5?g:u;return o(l<6?e[l]:e)}function n(l){return function(o,p){return[l([[+p[0],+o[0][1]],[+p[1],+o[1][1]]]),l([[+o[0][0],+p[0]],[+o[1][0],+p[1]]]),l(o)]}}function a(l){return function(o,p){return[l([[+p[0],+o[0][1],+o[0][2]],[+p[1],+o[1][1],+o[1][2]],[+p[2],+o[2][1],+o[2][2]]]),l([[+o[0][0],+p[0],+o[0][2]],[+o[1][0],+p[1],+o[1][2]],[+o[2][0],+p[2],+o[2][2]]]),l([[+o[0][0],+o[0][1],+p[0]],[+o[1][0],+o[1][1],+p[1]],[+o[2][0],+o[2][1],+p[2]]]),l(o)]}}function r(l){return function(o,p){return[l([[+p[0],+o[0][1],+o[0][2],+o[0][3]],[+p[1],+o[1][1],+o[1][2],+o[1][3]],[+p[2],+o[2][1],+o[2][2],+o[2][3]],[+p[3],+o[3][1],+o[3][2],+o[3][3]]]),l([[+o[0][0],+p[0],+o[0][2],+o[0][3]],[+o[1][0],+p[1],+o[1][2],+o[1][3]],[+o[2][0],+p[2],+o[2][2],+o[2][3]],[+o[3][0],+p[3],+o[3][2],+o[3][3]]]),l([[+o[0][0],+o[0][1],+p[0],+o[0][3]],[+o[1][0],+o[1][1],+p[1],+o[1][3]],[+o[2][0],+o[2][1],+p[2],+o[2][3]],[+o[3][0],+o[3][1],+p[3],+o[3][3]]]),l([[+o[0][0],+o[0][1],+o[0][2],+p[0]],[+o[1][0],+o[1][1],+o[1][2],+p[1]],[+o[2][0],+o[2][1],+o[2][2],+p[2]],[+o[3][0],+o[3][1],+o[3][2],+p[3]]]),l(o)]}}function g(l){return function(o,p){return[l([[+p[0],+o[0][1],+o[0][2],+o[0][3],+o[0][4]],[+p[1],+o[1][1],+o[1][2],+o[1][3],+o[1][4]],[+p[2],+o[2][1],+o[2][2],+o[2][3],+o[2][4]],[+p[3],+o[3][1],+o[3][2],+o[3][3],+o[3][4]],[+p[4],+o[4][1],+o[4][2],+o[4][3],+o[4][4]]]),l([[+o[0][0],+p[0],+o[0][2],+o[0][3],+o[0][4]],[+o[1][0],+p[1],+o[1][2],+o[1][3],+o[1][4]],[+o[2][0],+p[2],+o[2][2],+o[2][3],+o[2][4]],[+o[3][0],+p[3],+o[3][2],+o[3][3],+o[3][4]],[+o[4][0],+p[4],+o[4][2],+o[4][3],+o[4][4]]]),l([[+o[0][0],+o[0][1],+p[0],+o[0][3],+o[0][4]],[+o[1][0],+o[1][1],+p[1],+o[1][3],+o[1][4]],[+o[2][0],+o[2][1],+p[2],+o[2][3],+o[2][4]],[+o[3][0],+o[3][1],+p[3],+o[3][3],+o[3][4]],[+o[4][0],+o[4][1],+p[4],+o[4][3],+o[4][4]]]),l([[+o[0][0],+o[0][1],+o[0][2],+p[0],+o[0][4]],[+o[1][0],+o[1][1],+o[1][2],+p[1],+o[1][4]],[+o[2][0],+o[2][1],+o[2][2],+p[2],+o[2][4]],[+o[3][0],+o[3][1],+o[3][2],+p[3],+o[3][4]],[+o[4][0],+o[4][1],+o[4][2],+p[4],+o[4][4]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+p[0]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+p[1]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+p[2]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+p[3]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+p[4]]]),l(o)]}}function u(l){return function(o,p){return[l([[+p[0],+o[0][1],+o[0][2],+o[0][3],+o[0][4],+o[0][5]],[+p[1],+o[1][1],+o[1][2],+o[1][3],+o[1][4],+o[1][5]],[+p[2],+o[2][1],+o[2][2],+o[2][3],+o[2][4],+o[2][5]],[+p[3],+o[3][1],+o[3][2],+o[3][3],+o[3][4],+o[3][5]],[+p[4],+o[4][1],+o[4][2],+o[4][3],+o[4][4],+o[4][5]],[+p[5],+o[5][1],+o[5][2],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+p[0],+o[0][2],+o[0][3],+o[0][4],+o[0][5]],[+o[1][0],+p[1],+o[1][2],+o[1][3],+o[1][4],+o[1][5]],[+o[2][0],+p[2],+o[2][2],+o[2][3],+o[2][4],+o[2][5]],[+o[3][0],+p[3],+o[3][2],+o[3][3],+o[3][4],+o[3][5]],[+o[4][0],+p[4],+o[4][2],+o[4][3],+o[4][4],+o[4][5]],[+o[5][0],+p[5],+o[5][2],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+p[0],+o[0][3],+o[0][4],+o[0][5]],[+o[1][0],+o[1][1],+p[1],+o[1][3],+o[1][4],+o[1][5]],[+o[2][0],+o[2][1],+p[2],+o[2][3],+o[2][4],+o[2][5]],[+o[3][0],+o[3][1],+p[3],+o[3][3],+o[3][4],+o[3][5]],[+o[4][0],+o[4][1],+p[4],+o[4][3],+o[4][4],+o[4][5]],[+o[5][0],+o[5][1],+p[5],+o[5][3],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+p[0],+o[0][4],+o[0][5]],[+o[1][0],+o[1][1],+o[1][2],+p[1],+o[1][4],+o[1][5]],[+o[2][0],+o[2][1],+o[2][2],+p[2],+o[2][4],+o[2][5]],[+o[3][0],+o[3][1],+o[3][2],+p[3],+o[3][4],+o[3][5]],[+o[4][0],+o[4][1],+o[4][2],+p[4],+o[4][4],+o[4][5]],[+o[5][0],+o[5][1],+o[5][2],+p[5],+o[5][4],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+p[0],+o[0][5]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+p[1],+o[1][5]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+p[2],+o[2][5]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+p[3],+o[3][5]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+p[4],+o[4][5]],[+o[5][0],+o[5][1],+o[5][2],+o[5][3],+p[5],+o[5][5]]]),l([[+o[0][0],+o[0][1],+o[0][2],+o[0][3],+o[0][4],+p[0]],[+o[1][0],+o[1][1],+o[1][2],+o[1][3],+o[1][4],+p[1]],[+o[2][0],+o[2][1],+o[2][2],+o[2][3],+o[2][4],+p[2]],[+o[3][0],+o[3][1],+o[3][2],+o[3][3],+o[3][4],+p[3]],[+o[4][0],+o[4][1],+o[4][2],+o[4][3],+o[4][4],+p[4]],[+o[5][0],+o[5][1],+o[5][2],+o[5][3],+o[5][4],+p[5]]]),l(o)]}}var s=[function(){return[[0]]},function(l,o){return[[o[0]],[l[0][0]]]}];function h(l,o,p,c,i,x,f,_){return function(b,T){switch(b.length){case 0:return l(b,T);case 1:return o(b,T);case 2:return p(b,T);case 3:return c(b,T);case 4:return i(b,T);case 5:return x(b,T)}var k=f[b.length];return k||(k=f[b.length]=_(b.length)),k(b,T)}}(function(){for(;s.length<6;)s.push(t(s.length));w.exports=h.apply(void 0,s.concat([s,t]));for(var l=0;l<6;++l)w.exports[l]=s[l]})()},{"robust-determinant":280}],284:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-scale"),a=v("robust-subtract");function r(i,x,f,_){return function(b,T,k){var L=i(i(x(T[1],k[0]),x(-k[1],T[0])),i(x(b[1],T[0]),x(-T[1],b[0]))),A=i(x(b[1],k[0]),x(-k[1],b[0])),I=_(L,A);return I[I.length-1]}}function g(i,x,f,_){return function(b,T,k,L){var A=i(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2])))),I=i(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2])))),P=_(A,I);return P[P.length-1]}}function u(i,x,f,_){return function(b,T,k,L,A){var I=i(i(i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),k[2]),i(f(i(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),f(i(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),T[3]),i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-L[2]),f(i(x(T[1],L[0]),x(-L[1],T[0])),A[2]))),-k[3]),f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),A[2]))),L[3]))),i(f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),-A[3]),i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-L[2]),f(i(x(T[1],L[0]),x(-L[1],T[0])),A[2]))),b[3]),f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-L[2]),f(i(x(b[1],L[0]),x(-L[1],b[0])),A[2]))),-T[3])))),i(i(f(i(f(i(x(T[1],A[0]),x(-A[1],T[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),A[2]))),L[3]),i(f(i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2]))),-A[3]),f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),b[3]))),i(f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),-T[3]),i(f(i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2]))),k[3]),f(i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2]))),-L[3]))))),P=i(i(i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),k[2]),i(f(i(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),f(i(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),b[3]),f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-L[2]),f(i(x(b[1],L[0]),x(-L[1],b[0])),A[2]))),-k[3])),i(f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),A[2]))),L[3]),f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),-A[3]))),i(i(f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),A[2]))),b[3]),f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),A[2]))),-T[3])),i(f(i(f(i(x(T[1],A[0]),x(-A[1],T[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),A[2]))),k[3]),f(i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2]))),-A[3])))),S=_(I,P);return S[S.length-1]}}function s(i){return(i===3?r:i===4?g:u)(t,e,n,a)}var h=s(3),l=s(4),o=[function(){return 0},function(){return 0},function(i,x){return x[0]-i[0]},function(i,x,f){var _,b=(i[1]-f[1])*(x[0]-f[0]),T=(i[0]-f[0])*(x[1]-f[1]),k=b-T;if(b>0){if(T<=0)return k;_=b+T}else{if(!(b<0)||T>=0)return k;_=-(b+T)}var L=33306690738754716e-32*_;return k>=L||k<=-L?k:h(i,x,f)},function(i,x,f,_){var b=i[0]-_[0],T=x[0]-_[0],k=f[0]-_[0],L=i[1]-_[1],A=x[1]-_[1],I=f[1]-_[1],P=i[2]-_[2],S=x[2]-_[2],E=f[2]-_[2],z=T*I,D=k*A,j=k*L,V=b*I,Z=b*A,Q=T*L,K=P*(z-D)+S*(j-V)+E*(Z-Q),$=7771561172376103e-31*((Math.abs(z)+Math.abs(D))*Math.abs(P)+(Math.abs(j)+Math.abs(V))*Math.abs(S)+(Math.abs(Z)+Math.abs(Q))*Math.abs(E));return K>$||-K>$?K:l(i,x,f,_)}];function p(i){var x=o[i.length];return x||(x=o[i.length]=s(i.length)),x.apply(void 0,i)}function c(i,x,f,_,b,T,k){return function(L,A,I,P,S){switch(arguments.length){case 0:case 1:return 0;case 2:return _(L,A);case 3:return b(L,A,I);case 4:return T(L,A,I,P);case 5:return k(L,A,I,P,S)}for(var E=new Array(arguments.length),z=0;z<arguments.length;++z)E[z]=arguments[z];return i(E)}}(function(){for(;o.length<=5;)o.push(s(o.length));w.exports=c.apply(void 0,[p].concat(o));for(var i=0;i<=5;++i)w.exports[i]=o[i]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(v,w,y){var e=v("robust-sum"),t=v("robust-scale");w.exports=function(n,a){if(n.length===1)return t(a,n[0]);if(a.length===1)return t(n,a[0]);if(n.length===0||a.length===0)return[0];var r=[0];if(n.length<a.length)for(var g=0;g<n.length;++g)r=e(r,t(a,n[g]));else for(g=0;g<a.length;++g)r=e(r,t(n,a[g]));return r}},{"robust-scale":286,"robust-sum":289}],286:[function(v,w,y){var e=v("two-product"),t=v("two-sum");w.exports=function(n,a){var r=n.length;if(r===1){var g=e(n[0],a);return g[0]?g:[g[1]]}var u=new Array(2*r),s=[.1,.1],h=[.1,.1],l=0;e(n[0],a,s),s[0]&&(u[l++]=s[0]);for(var o=1;o<r;++o){e(n[o],a,h);var p=s[1];t(p,h[0],s),s[0]&&(u[l++]=s[0]);var c=h[1],i=s[1],x=c+i,f=i-(x-c);s[1]=x,f&&(u[l++]=f)}return s[1]&&(u[l++]=s[1]),l===0&&(u[l++]=0),u.length=l,u}},{"two-product":306,"two-sum":307}],287:[function(v,w,y){w.exports=function(t,n,a,r){var g=e(t,a,r),u=e(n,a,r);if(g>0&&u>0||g<0&&u<0)return!1;var s=e(a,t,n),h=e(r,t,n);return s>0&&h>0||s<0&&h<0?!1:g===0&&u===0&&s===0&&h===0?function(l,o,p,c){for(var i=0;i<2;++i){var x=l[i],f=o[i],_=Math.min(x,f),b=Math.max(x,f),T=p[i],k=c[i],L=Math.min(T,k);if(Math.max(T,k)<_||b<L)return!1}return!0}(t,n,a,r):!0};var e=v("robust-orientation")[3]},{"robust-orientation":284}],288:[function(v,w,y){w.exports=function(e,t){var n=0|e.length,a=0|t.length;if(n===1&&a===1)return function(I,P){var S=I+P,E=S-I,z=I-(S-E)+(P-E);return z?[z,S]:[S]}(e[0],-t[0]);var r,g,u=new Array(n+a),s=0,h=0,l=0,o=Math.abs,p=e[h],c=o(p),i=-t[l],x=o(i);c<x?(g=p,(h+=1)<n&&(p=e[h],c=o(p))):(g=i,(l+=1)<a&&(i=-t[l],x=o(i))),h<n&&c<x||l>=a?(r=p,(h+=1)<n&&(p=e[h],c=o(p))):(r=i,(l+=1)<a&&(i=-t[l],x=o(i)));for(var f,_,b=r+g,T=b-r,k=g-T,L=k,A=b;h<n&&l<a;)c<x?(r=p,(h+=1)<n&&(p=e[h],c=o(p))):(r=i,(l+=1)<a&&(i=-t[l],x=o(i))),(k=(g=L)-(T=(b=r+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f;for(;h<n;)(k=(g=L)-(T=(b=(r=p)+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(h+=1)<n&&(p=e[h]);for(;l<a;)(k=(g=L)-(T=(b=(r=i)+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(l+=1)<a&&(i=-t[l]);return L&&(u[s++]=L),A&&(u[s++]=A),s||(u[s++]=0),u.length=s,u}},{}],289:[function(v,w,y){w.exports=function(e,t){var n=0|e.length,a=0|t.length;if(n===1&&a===1)return function(I,P){var S=I+P,E=S-I,z=I-(S-E)+(P-E);return z?[z,S]:[S]}(e[0],t[0]);var r,g,u=new Array(n+a),s=0,h=0,l=0,o=Math.abs,p=e[h],c=o(p),i=t[l],x=o(i);c<x?(g=p,(h+=1)<n&&(p=e[h],c=o(p))):(g=i,(l+=1)<a&&(i=t[l],x=o(i))),h<n&&c<x||l>=a?(r=p,(h+=1)<n&&(p=e[h],c=o(p))):(r=i,(l+=1)<a&&(i=t[l],x=o(i)));for(var f,_,b=r+g,T=b-r,k=g-T,L=k,A=b;h<n&&l<a;)c<x?(r=p,(h+=1)<n&&(p=e[h],c=o(p))):(r=i,(l+=1)<a&&(i=t[l],x=o(i))),(k=(g=L)-(T=(b=r+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f;for(;h<n;)(k=(g=L)-(T=(b=(r=p)+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(h+=1)<n&&(p=e[h]);for(;l<a;)(k=(g=L)-(T=(b=(r=i)+g)-r))&&(u[s++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(l+=1)<a&&(i=t[l]);return L&&(u[s++]=L),A&&(u[s++]=A),s||(u[s++]=0),u.length=s,u}},{}],290:[function(v,w,y){w.exports=function(n){return t(e(n))};var e=v("boundary-cells"),t=v("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(v,w,y){w.exports=function(r,g,u,s){if(u=u||0,s===void 0&&(s=function(f){for(var _=f.length,b=0,T=0;T<_;++T)b=0|Math.max(b,f[T].length);return b-1}(r)),r.length===0||s<1)return{cells:[],vertexIds:[],vertexWeights:[]};var h=function(f,_){for(var b=f.length,T=t.mallocUint8(b),k=0;k<b;++k)T[k]=f[k]<_|0;return T}(g,+u),l=function(f,_){for(var b=f.length,T=_*(_+1)/2*b|0,k=t.mallocUint32(2*T),L=0,A=0;A<b;++A)for(var I=f[A],P=(_=I.length,0);P<_;++P)for(var S=0;S<P;++S){var E=I[S],z=I[P];k[L++]=0|Math.min(E,z),k[L++]=0|Math.max(E,z)}n(e(k,[L/2|0,2]));var D=2;for(A=2;A<L;A+=2)k[A-2]===k[A]&&k[A-1]===k[A+1]||(k[D++]=k[A],k[D++]=k[A+1]);return e(k,[D/2|0,2])}(r,s),o=function(f,_,b,T){for(var k=f.data,L=f.shape[0],A=t.mallocDouble(L),I=0,P=0;P<L;++P){var S=k[2*P],E=k[2*P+1];if(b[S]!==b[E]){var z=_[S],D=_[E];k[2*I]=S,k[2*I+1]=E,A[I++]=(D-T)/(D-z)}}return f.shape[0]=I,e(A,[I])}(l,g,h,+u),p=function(f,_){var b=t.mallocInt32(2*_),T=f.shape[0],k=f.data;b[0]=0;for(var L=0,A=0;A<T;++A){var I=k[2*A];if(I!==L){for(b[2*L+1]=A;++L<I;)b[2*L]=A,b[2*L+1]=A;b[2*L]=A}}for(b[2*L+1]=T;++L<_;)b[2*L]=b[2*L+1]=T;return b}(l,0|g.length),c=a(s)(r,l.data,p,h),i=function(f){for(var _=0|f.shape[0],b=f.data,T=new Array(_),k=0;k<_;++k)T[k]=[b[2*k],b[2*k+1]];return T}(l),x=[].slice.call(o.data,0,o.shape[0]);return t.free(h),t.free(l.data),t.free(o.data),t.free(p),{cells:c,vertexIds:i,vertexWeights:x}};var e=v("ndarray"),t=v("typedarray-pool"),n=v("ndarray-sort"),a=v("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(v,w,y){w.exports=function(t){return e[t]()};var e=[function(){return function(t,n,a,r){for(var g=t.length,u=0;u<g;++u)t[u].length;return[]}},function(){function t(n,a,r,g){for(var u=0|Math.min(r,g),s=0|Math.max(r,g),h=n[2*u],l=n[2*u+1];h<l;){var o=h+l>>1,p=a[2*o+1];if(p===s)return o;s<p?l=o:h=o+1}return h}return function(n,a,r,g){for(var u=n.length,s=[],h=0;h<u;++h){var l=n[h];if(l.length===2){var o=(g[l[0]]<<0)+(g[l[1]]<<1);if(o===0||o===3)continue;switch(o){case 0:break;case 1:s.push([t(r,a,l[0],l[1])]);break;case 2:s.push([t(r,a,l[1],l[0])])}}}return s}},function(){function t(n,a,r,g){for(var u=0|Math.min(r,g),s=0|Math.max(r,g),h=n[2*u],l=n[2*u+1];h<l;){var o=h+l>>1,p=a[2*o+1];if(p===s)return o;s<p?l=o:h=o+1}return h}return function(n,a,r,g){for(var u=n.length,s=[],h=0;h<u;++h){var l=n[h],o=l.length;if(o===3){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2))===0||p===7)continue;switch(p){case 0:break;case 1:s.push([t(r,a,l[0],l[2]),t(r,a,l[0],l[1])]);break;case 2:s.push([t(r,a,l[1],l[0]),t(r,a,l[1],l[2])]);break;case 3:s.push([t(r,a,l[0],l[2]),t(r,a,l[1],l[2])]);break;case 4:s.push([t(r,a,l[2],l[1]),t(r,a,l[2],l[0])]);break;case 5:s.push([t(r,a,l[2],l[1]),t(r,a,l[0],l[1])]);break;case 6:s.push([t(r,a,l[1],l[0]),t(r,a,l[2],l[0])])}}else if(o===2){var p;if((p=(g[l[0]]<<0)+(g[l[1]]<<1))===0||p===3)continue;switch(p){case 0:break;case 1:s.push([t(r,a,l[0],l[1])]);break;case 2:s.push([t(r,a,l[1],l[0])])}}}return s}},function(){function t(n,a,r,g){for(var u=0|Math.min(r,g),s=0|Math.max(r,g),h=n[2*u],l=n[2*u+1];h<l;){var o=h+l>>1,p=a[2*o+1];if(p===s)return o;s<p?l=o:h=o+1}return h}return function(n,a,r,g){for(var u=n.length,s=[],h=0;h<u;++h){var l=n[h],o=l.length;if(o===4){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2)+(g[l[3]]<<3))===0||p===15)continue;switch(p){case 0:break;case 1:s.push([t(r,a,l[0],l[1]),t(r,a,l[0],l[2]),t(r,a,l[0],l[3])]);break;case 2:s.push([t(r,a,l[1],l[2]),t(r,a,l[1],l[0]),t(r,a,l[1],l[3])]);break;case 3:s.push([t(r,a,l[1],l[2]),t(r,a,l[0],l[2]),t(r,a,l[0],l[3])],[t(r,a,l[1],l[3]),t(r,a,l[1],l[2]),t(r,a,l[0],l[3])]);break;case 4:s.push([t(r,a,l[2],l[0]),t(r,a,l[2],l[1]),t(r,a,l[2],l[3])]);break;case 5:s.push([t(r,a,l[0],l[1]),t(r,a,l[2],l[1]),t(r,a,l[0],l[3])],[t(r,a,l[2],l[1]),t(r,a,l[2],l[3]),t(r,a,l[0],l[3])]);break;case 6:s.push([t(r,a,l[2],l[0]),t(r,a,l[1],l[0]),t(r,a,l[1],l[3])],[t(r,a,l[2],l[3]),t(r,a,l[2],l[0]),t(r,a,l[1],l[3])]);break;case 7:s.push([t(r,a,l[0],l[3]),t(r,a,l[1],l[3]),t(r,a,l[2],l[3])]);break;case 8:s.push([t(r,a,l[3],l[1]),t(r,a,l[3],l[0]),t(r,a,l[3],l[2])]);break;case 9:s.push([t(r,a,l[3],l[1]),t(r,a,l[0],l[1]),t(r,a,l[0],l[2])],[t(r,a,l[3],l[2]),t(r,a,l[3],l[1]),t(r,a,l[0],l[2])]);break;case 10:s.push([t(r,a,l[1],l[0]),t(r,a,l[3],l[0]),t(r,a,l[1],l[2])],[t(r,a,l[3],l[0]),t(r,a,l[3],l[2]),t(r,a,l[1],l[2])]);break;case 11:s.push([t(r,a,l[1],l[2]),t(r,a,l[0],l[2]),t(r,a,l[3],l[2])]);break;case 12:s.push([t(r,a,l[3],l[0]),t(r,a,l[2],l[0]),t(r,a,l[2],l[1])],[t(r,a,l[3],l[1]),t(r,a,l[3],l[0]),t(r,a,l[2],l[1])]);break;case 13:s.push([t(r,a,l[0],l[1]),t(r,a,l[2],l[1]),t(r,a,l[3],l[1])]);break;case 14:s.push([t(r,a,l[2],l[0]),t(r,a,l[1],l[0]),t(r,a,l[3],l[0])])}}else if(o===3){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2))===0||p===7)continue;switch(p){case 0:break;case 1:s.push([t(r,a,l[0],l[2]),t(r,a,l[0],l[1])]);break;case 2:s.push([t(r,a,l[1],l[0]),t(r,a,l[1],l[2])]);break;case 3:s.push([t(r,a,l[0],l[2]),t(r,a,l[1],l[2])]);break;case 4:s.push([t(r,a,l[2],l[1]),t(r,a,l[2],l[0])]);break;case 5:s.push([t(r,a,l[2],l[1]),t(r,a,l[0],l[1])]);break;case 6:s.push([t(r,a,l[1],l[0]),t(r,a,l[2],l[0])])}}else if(o===2){var p;if((p=(g[l[0]]<<0)+(g[l[1]]<<1))===0||p===3)continue;switch(p){case 0:break;case 1:s.push([t(r,a,l[0],l[1])]);break;case 2:s.push([t(r,a,l[1],l[0])])}}}return s}}]},{}],293:[function(v,w,y){var e=v("bit-twiddle"),t=v("union-find");function n(l,o){var p=l.length,c=l.length-o.length,i=Math.min;if(c)return c;switch(p){case 0:return 0;case 1:return l[0]-o[0];case 2:return(_=l[0]+l[1]-o[0]-o[1])||i(l[0],l[1])-i(o[0],o[1]);case 3:var x=l[0]+l[1],f=o[0]+o[1];if(_=x+l[2]-(f+o[2]))return _;var _,b=i(l[0],l[1]),T=i(o[0],o[1]);return(_=i(b,l[2])-i(T,o[2]))||i(b+l[2],x)-i(T+o[2],f);default:var k=l.slice(0);k.sort();var L=o.slice(0);L.sort();for(var A=0;A<p;++A)if(c=k[A]-L[A])return c;return 0}}function a(l,o){return n(l[0],o[0])}function r(l,o){if(o){for(var p=l.length,c=new Array(p),i=0;i<p;++i)c[i]=[l[i],o[i]];for(c.sort(a),i=0;i<p;++i)l[i]=c[i][0],o[i]=c[i][1];return l}return l.sort(n),l}function g(l){if(l.length===0)return[];for(var o=1,p=l.length,c=1;c<p;++c){var i=l[c];if(n(i,l[c-1])){if(c===o){o++;continue}l[o++]=i}}return l.length=o,l}function u(l,o){for(var p=0,c=l.length-1,i=-1;p<=c;){var x=p+c>>1,f=n(l[x],o);f<=0?(f===0&&(i=x),p=x+1):f>0&&(c=x-1)}return i}function s(l,o){for(var p=new Array(l.length),c=0,i=p.length;c<i;++c)p[c]=[];for(var x=[],f=(c=0,o.length);c<f;++c)for(var _=o[c],b=_.length,T=1,k=1<<b;T<k;++T){x.length=e.popCount(T);for(var L=0,A=0;A<b;++A)T&1<<A&&(x[L++]=_[A]);var I=u(l,x);if(!(I<0))for(;p[I++].push(c),!(I>=l.length||n(l[I],x)!==0););}return p}function h(l,o){if(o<0)return[];for(var p=[],c=(1<<o+1)-1,i=0;i<l.length;++i)for(var x=l[i],f=c;f<1<<x.length;f=e.nextCombination(f)){for(var _=new Array(o+1),b=0,T=0;T<x.length;++T)f&1<<T&&(_[b++]=x[T]);p.push(_)}return r(p)}y.dimension=function(l){for(var o=0,p=Math.max,c=0,i=l.length;c<i;++c)o=p(o,l[c].length);return o-1},y.countVertices=function(l){for(var o=-1,p=Math.max,c=0,i=l.length;c<i;++c)for(var x=l[c],f=0,_=x.length;f<_;++f)o=p(o,x[f]);return o+1},y.cloneCells=function(l){for(var o=new Array(l.length),p=0,c=l.length;p<c;++p)o[p]=l[p].slice(0);return o},y.compareCells=n,y.normalize=r,y.unique=g,y.findCell=u,y.incidence=s,y.dual=function(l,o){if(!o)return s(g(h(l,0)),l);for(var p=new Array(o),c=0;c<o;++c)p[c]=[];c=0;for(var i=l.length;c<i;++c)for(var x=l[c],f=0,_=x.length;f<_;++f)p[x[f]].push(c);return p},y.explode=function(l){for(var o=[],p=0,c=l.length;p<c;++p)for(var i=l[p],x=0|i.length,f=1,_=1<<x;f<_;++f){for(var b=[],T=0;T<x;++T)f>>>T&1&&b.push(i[T]);o.push(b)}return r(o)},y.skeleton=h,y.boundary=function(l){for(var o=[],p=0,c=l.length;p<c;++p)for(var i=l[p],x=0,f=i.length;x<f;++x){for(var _=new Array(i.length-1),b=0,T=0;b<f;++b)b!==x&&(_[T++]=i[b]);o.push(_)}return r(o)},y.connectedComponents=function(l,o){return o?function(p,c){for(var i=new t(c),x=0;x<p.length;++x)for(var f=p[x],_=0;_<f.length;++_)for(var b=_+1;b<f.length;++b)i.link(f[_],f[b]);var T=[],k=i.ranks;for(x=0;x<k.length;++x)k[x]=-1;for(x=0;x<p.length;++x){var L=i.find(p[x][0]);k[L]<0?(k[L]=T.length,T.push([p[x].slice(0)])):T[k[L]].push(p[x].slice(0))}return T}(l,o):function(p){for(var c=g(r(h(p,0))),i=new t(c.length),x=0;x<p.length;++x)for(var f=p[x],_=0;_<f.length;++_)for(var b=u(c,[f[_]]),T=_+1;T<f.length;++T)i.link(b,u(c,[f[T]]));var k=[],L=i.ranks;for(x=0;x<L.length;++x)L[x]=-1;for(x=0;x<p.length;++x){var A=i.find(u(c,[p[x][0]]));L[A]<0?(L[A]=k.length,k.push([p[x].slice(0)])):k[L[A]].push(p[x].slice(0))}return k}(l)}},{"bit-twiddle":32,"union-find":309}],294:[function(v,w,y){arguments[4][32][0].apply(y,arguments)},{dup:32}],295:[function(v,w,y){arguments[4][293][0].apply(y,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(v,w,y){function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var n=0;n<t;++n)this.roots[n]=n,this.ranks[n]=0}w.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},e.prototype.find=function(t){for(var n=this.roots;n[t]!==t;){var a=n[t];n[t]=n[a],t=a}return t},e.prototype.link=function(t,n){var a=this.find(t),r=this.find(n);if(a!==r){var g=this.ranks,u=this.roots,s=g[a],h=g[r];s<h?u[a]=r:h<s?u[r]=a:(u[r]=a,++g[a])}}},{}],297:[function(v,w,y){w.exports=function(n,a,r){for(var g=a.length,u=n.length,s=new Array(g),h=new Array(g),l=new Array(g),o=new Array(g),p=0;p<g;++p)s[p]=h[p]=-1,l[p]=1/0,o[p]=!1;for(p=0;p<u;++p){var c=n[p];if(c.length!==2)throw new Error("Input must be a graph");var i=c[1],x=c[0];h[x]!==-1?h[x]=-2:h[x]=i,s[i]!==-1?s[i]=-2:s[i]=x}function f(Q){if(o[Q])return 1/0;var K,$,ne,H,N,U=s[Q],te=h[Q];return U<0||te<0?1/0:(K=a[Q],$=a[U],ne=a[te],H=Math.abs(e(K,$,ne)),N=Math.sqrt(Math.pow($[0]-ne[0],2)+Math.pow($[1]-ne[1],2)),H/N)}function _(Q,K){var $=S[Q],ne=S[K];S[Q]=ne,S[K]=$,E[$]=K,E[ne]=Q}function b(Q){return l[S[Q]]}function T(Q){return 1&Q?Q-1>>1:(Q>>1)-1}function k(Q){for(var K=b(Q);;){var $=K,ne=2*Q+1,H=2*(Q+1),N=Q;if(ne<z){var U=b(ne);U<$&&(N=ne,$=U)}if(H<z&&b(H)<$&&(N=H),N===Q)return Q;_(Q,N),Q=N}}function L(Q){for(var K=b(Q);Q>0;){var $=T(Q);if($>=0&&K<b($)){_(Q,$),Q=$;continue}return Q}}function A(){if(z>0){var Q=S[0];return _(0,z-1),z-=1,k(0),Q}return-1}function I(Q,K){var $=S[Q];return l[$]===K?Q:(l[$]=-1/0,L(Q),A(),l[$]=K,L((z+=1)-1))}function P(Q){if(!o[Q]){o[Q]=!0;var K=s[Q],$=h[Q];s[$]>=0&&(s[$]=K),h[K]>=0&&(h[K]=$),E[K]>=0&&I(E[K],f(K)),E[$]>=0&&I(E[$],f($))}}var S=[],E=new Array(g);for(p=0;p<g;++p)(l[p]=f(p))<1/0?(E[p]=S.length,S.push(p)):E[p]=-1;var z=S.length;for(p=z>>1;p>=0;--p)k(p);for(;;){var D=A();if(D<0||l[D]>r)break;P(D)}var j=[];for(p=0;p<g;++p)o[p]||(E[p]=j.length,j.push(a[p].slice()));j.length;function V(Q,K){if(Q[K]<0)return K;var $=K,ne=K;do{var H=Q[ne];if(!o[ne]||H<0||H===ne||(H=Q[ne=H],!o[ne]||H<0||H===ne))break;ne=H,$=Q[$]}while($!==ne);for(var N=K;N!==ne;N=Q[N])Q[N]=ne;return ne}var Z=[];return n.forEach(function(Q){var K=V(s,Q[0]),$=V(h,Q[1]);if(K>=0&&$>=0&&K!==$){var ne=E[K],H=E[$];ne!==H&&Z.push([ne,H])}}),t.unique(t.normalize(Z)),{positions:j,edges:Z}};var e=v("robust-orientation"),t=v("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(v,w,y){w.exports=function(n,a){var r,g,u,s;if(a[0][0]<a[1][0])r=a[0],g=a[1];else{if(!(a[0][0]>a[1][0]))return t(a,n);r=a[1],g=a[0]}if(n[0][0]<n[1][0])u=n[0],s=n[1];else{if(!(n[0][0]>n[1][0]))return-t(n,a);u=n[1],s=n[0]}var h=e(r,g,s),l=e(r,g,u);if(h<0){if(l<=0)return h}else if(h>0){if(l>=0)return h}else if(l)return l;if(h=e(s,u,g),l=e(s,u,r),h<0){if(l<=0)return h}else if(h>0){if(l>=0)return h}else if(l)return l;return g[0]-s[0]};var e=v("robust-orientation");function t(n,a){var r,g,u,s;if(a[0][0]<a[1][0])r=a[0],g=a[1];else{if(!(a[0][0]>a[1][0])){var h=Math.min(n[0][1],n[1][1]),l=Math.max(n[0][1],n[1][1]),o=Math.min(a[0][1],a[1][1]),p=Math.max(a[0][1],a[1][1]);return l<o?l-o:h>p?h-p:l-p}r=a[1],g=a[0]}n[0][1]<n[1][1]?(u=n[0],s=n[1]):(u=n[1],s=n[0]);var c=e(g,r,u);return c||(c=e(g,r,s))||s-g}},{"robust-orientation":284}],299:[function(v,w,y){w.exports=function(l){for(var o=l.length,p=2*o,c=new Array(p),i=0;i<o;++i){var x=l[i],f=x[0][0]<x[1][0];c[2*i]=new h(x[0][0],x,f,i),c[2*i+1]=new h(x[1][0],x,!f,i)}c.sort(function(P,S){var E=P.x-S.x;return E||(E=P.create-S.create)||Math.min(P.segment[0][1],P.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var _=t(a),b=[],T=[],k=[];for(i=0;i<p;){for(var L=c[i].x,A=[];i<p;){var I=c[i];if(I.x!==L)break;i+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(A.push(new s(I.segment[0][1],I.index,!0,!0)),A.push(new s(I.segment[1][1],I.index,!1,!1))):(A.push(new s(I.segment[1][1],I.index,!0,!1)),A.push(new s(I.segment[0][1],I.index,!1,!0)))):_=I.create?_.insert(I.segment,I.index):_.remove(I.segment)}b.push(_.root),T.push(L),k.push(A)}return new r(b,T,k)};var e=v("binary-search-bounds"),t=v("functional-red-black-tree"),n=v("robust-orientation"),a=v("./lib/order-segments");function r(l,o,p){this.slabs=l,this.coordinates=o,this.horizontal=p}function g(l,o){return l.y-o}function u(l,o){for(var p=null;l;){var c,i,x=l.key;x[0][0]<x[1][0]?(c=x[0],i=x[1]):(c=x[1],i=x[0]);var f=n(c,i,o);if(f<0)l=l.left;else if(f>0)if(o[0]!==x[1][0])p=l,l=l.right;else{if(_=u(l.right,o))return _;l=l.left}else{if(o[0]!==x[1][0])return l;var _;if(_=u(l.right,o))return _;l=l.left}}return p}function s(l,o,p,c){this.y=l,this.index=o,this.start=p,this.closed=c}function h(l,o,p,c){this.x=l,this.segment=o,this.create=p,this.index=c}r.prototype.castUp=function(l){var o=e.le(this.coordinates,l[0]);if(o<0)return-1;this.slabs[o];var p=u(this.slabs[o],l),c=-1;if(p&&(c=p.value),this.coordinates[o]===l[0]){var i=null;if(p&&(i=p.key),o>0){var x=u(this.slabs[o-1],l);x&&(i?a(x.key,i)>0&&(i=x.key,c=x.value):(c=x.value,i=x.key))}var f=this.horizontal[o];if(f.length>0){var _=e.ge(f,l[1],g);if(_<f.length){var b=f[_];if(l[1]===b.y){if(b.closed)return b.index;for(;_<f.length-1&&f[_+1].y===l[1];)if((b=f[_+=1]).closed)return b.index;if(b.y===l[1]&&!b.start){if((_+=1)>=f.length)return c;b=f[_]}}if(b.start)if(i){var T=n(i[0],i[1],[l[0],b.y]);i[0][0]>i[1][0]&&(T=-T),T>0&&(c=b.index)}else c=b.index;else b.y!==l[1]&&(c=b.index)}}}return c}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(v,w,y){var e=v("robust-dot-product"),t=v("robust-sum");function n(r,g){var u=t(e(r,g),[g[g.length-1]]);return u[u.length-1]}function a(r,g,u,s){var h=-g/(s-g);h<0?h=0:h>1&&(h=1);for(var l=1-h,o=r.length,p=new Array(o),c=0;c<o;++c)p[c]=h*r[c]+l*u[c];return p}w.exports=function(r,g){for(var u=[],s=[],h=n(r[r.length-1],g),l=r[r.length-1],o=r[0],p=0;p<r.length;++p,l=o){var c=n(o=r[p],g);if(h<0&&c>0||h>0&&c<0){var i=a(l,c,o,h);u.push(i),s.push(i.slice())}c<0?s.push(o.slice()):c>0?u.push(o.slice()):(u.push(o.slice()),s.push(o.slice())),h=c}return{positive:u,negative:s}},w.exports.positive=function(r,g){for(var u=[],s=n(r[r.length-1],g),h=r[r.length-1],l=r[0],o=0;o<r.length;++o,h=l){var p=n(l=r[o],g);(s<0&&p>0||s>0&&p<0)&&u.push(a(h,p,l,s)),p>=0&&u.push(l.slice()),s=p}return u},w.exports.negative=function(r,g){for(var u=[],s=n(r[r.length-1],g),h=r[r.length-1],l=r[0],o=0;o<r.length;++o,h=l){var p=n(l=r[o],g);(s<0&&p>0||s>0&&p<0)&&u.push(a(h,p,l,s)),p<=0&&u.push(l.slice()),s=p}return u}},{"robust-dot-product":281,"robust-sum":289}],301:[function(v,w,y){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(u){return a(g(u),arguments)}function n(u,s){return t.apply(null,[u].concat(s||[]))}function a(u,s){var h,l,o,p,c,i,x,f,_,b=1,T=u.length,k="";for(l=0;l<T;l++)if(typeof u[l]=="string")k+=u[l];else if(typeof u[l]=="object"){if((p=u[l]).keys)for(h=s[b],o=0;o<p.keys.length;o++){if(h==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[o],p.keys[o-1]));h=h[p.keys[o]]}else h=p.param_no?s[p.param_no]:s[b++];if(e.not_type.test(p.type)&&e.not_primitive.test(p.type)&&h instanceof Function&&(h=h()),e.numeric_arg.test(p.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(t("[sprintf] expecting number but found %T",h));switch(e.number.test(p.type)&&(f=h>=0),p.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,p.width?parseInt(p.width):0);break;case"e":h=p.precision?parseFloat(h).toExponential(p.precision):parseFloat(h).toExponential();break;case"f":h=p.precision?parseFloat(h).toFixed(p.precision):parseFloat(h);break;case"g":h=p.precision?String(Number(h.toPrecision(p.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=p.precision?h.substring(0,p.precision):h;break;case"t":h=String(!!h),h=p.precision?h.substring(0,p.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=p.precision?h.substring(0,p.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=p.precision?h.substring(0,p.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase()}e.json.test(p.type)?k+=h:(!e.number.test(p.type)||f&&!p.sign?_="":(_=f?"+":"-",h=h.toString().replace(e.sign,"")),i=p.pad_char?p.pad_char==="0"?"0":p.pad_char.charAt(1):" ",x=p.width-(_+h).length,c=p.width&&x>0?i.repeat(x):"",k+=p.align?_+h+c:i==="0"?_+c+h:c+_+h)}return k}var r=Object.create(null);function g(u){if(r[u])return r[u];for(var s,h=u,l=[],o=0;h;){if((s=e.text.exec(h))!==null)l.push(s[0]);else if((s=e.modulo.exec(h))!==null)l.push("%");else{if((s=e.placeholder.exec(h))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(s[2]){o|=1;var p=[],c=s[2],i=[];if((i=e.key.exec(c))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(p.push(i[1]);(c=c.substring(i[0].length))!=="";)if((i=e.key_access.exec(c))!==null)p.push(i[1]);else{if((i=e.index_access.exec(c))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");p.push(i[1])}s[2]=p}else o|=2;if(o===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");l.push({placeholder:s[0],param_no:s[1],keys:s[2],sign:s[3],pad_char:s[4],align:s[5],width:s[6],precision:s[7],type:s[8]})}h=h.substring(s[0].length)}return r[u]=l}y!==void 0&&(y.sprintf=t,y.vsprintf=n),typeof window<"u"&&(window.sprintf=t,window.vsprintf=n)})()},{}],302:[function(v,w,y){w.exports=function(r,g){if(r.dimension<=0)return{positions:[],cells:[]};if(r.dimension===1)return function(h,l){for(var o=t(h,l),p=o.length,c=new Array(p),i=new Array(p),x=0;x<p;++x)c[x]=[o[x]],i[x]=[x];return{positions:c,cells:i}}(r,g);var u=r.order.join()+"-"+r.dtype,s=a[u];return g=+g||0,s||(s=a[u]=function(h,l){var o=h.length+"d",p=n[o];if(p)return p(e,h,l)}(r.order,r.dtype)),s(r,g)};var e=v("ndarray-extract-contour"),t=v("zero-crossings"),n={"2d":function(r,g,u){var s=r({order:g,scalarArguments:3,getters:u==="generic"?[0]:void 0,phase:function(h,l,o,p){return h>p|0},vertex:function(h,l,o,p,c,i,x,f,_,b,T,k,L){var A=(x<<0)+(f<<1)+(_<<2)+(b<<3)|0;if(A!==0&&A!==15)switch(A){case 0:T.push([h-.5,l-.5]);break;case 1:T.push([h-.25-.25*(p+o-2*L)/(o-p),l-.25-.25*(c+o-2*L)/(o-c)]);break;case 2:T.push([h-.75-.25*(-p-o+2*L)/(p-o),l-.25-.25*(i+p-2*L)/(p-i)]);break;case 3:T.push([h-.5,l-.5-.5*(c+o+i+p-4*L)/(o-c+p-i)]);break;case 4:T.push([h-.25-.25*(i+c-2*L)/(c-i),l-.75-.25*(-c-o+2*L)/(c-o)]);break;case 5:T.push([h-.5-.5*(p+o+i+c-4*L)/(o-p+c-i),l-.5]);break;case 6:T.push([h-.5-.25*(-p-o+i+c)/(p-o+c-i),l-.5-.25*(-c-o+i+p)/(c-o+p-i)]);break;case 7:T.push([h-.75-.25*(i+c-2*L)/(c-i),l-.75-.25*(i+p-2*L)/(p-i)]);break;case 8:T.push([h-.75-.25*(-i-c+2*L)/(i-c),l-.75-.25*(-i-p+2*L)/(i-p)]);break;case 9:T.push([h-.5-.25*(p+o+-i-c)/(o-p+i-c),l-.5-.25*(c+o+-i-p)/(o-c+i-p)]);break;case 10:T.push([h-.5-.5*(-p-o-i-c+4*L)/(p-o+i-c),l-.5]);break;case 11:T.push([h-.25-.25*(-i-c+2*L)/(i-c),l-.75-.25*(c+o-2*L)/(o-c)]);break;case 12:T.push([h-.5,l-.5-.5*(-c-o-i-p+4*L)/(c-o+i-p)]);break;case 13:T.push([h-.75-.25*(p+o-2*L)/(o-p),l-.25-.25*(-i-p+2*L)/(i-p)]);break;case 14:T.push([h-.25-.25*(-p-o+2*L)/(p-o),l-.25-.25*(-c-o+2*L)/(c-o)]);break;case 15:T.push([h-.5,l-.5])}},cell:function(h,l,o,p,c,i,x,f,_){c?f.push([h,l]):f.push([l,h])}});return function(h,l){var o=[],p=[];return s(h,o,p,l),{positions:o,cells:p}}}},a={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(v,w,y){(function(e){(function(){w.exports=function r(g,u,s){s=s||{};var h=a[g];h||(h=a[g]={" ":{data:new Float32Array(0),shape:.2}});var l=h[u];if(!l)if(u.length<=1||!/\d/.test(u))l=h[u]=function(L){for(var A=L.cells,I=L.positions,P=new Float32Array(6*A.length),S=0,E=0,z=0;z<A.length;++z)for(var D=A[z],j=0;j<3;++j){var V=I[D[j]];P[S++]=V[0],P[S++]=V[1]+1.4,E=Math.max(V[0],E)}return{data:P,shape:E}}(t(u,{triangles:!0,font:g,textAlign:s.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var o=u.split(/(\d|\s)/),p=new Array(o.length),c=0,i=0,x=0;x<o.length;++x)p[x]=r(g,o[x]),c+=p[x].data.length,i+=p[x].shape,x>0&&(i+=.02);var f=new Float32Array(c),_=0,b=-.5*i;for(x=0;x<p.length;++x){for(var T=p[x].data,k=0;k<T.length;k+=2)f[_++]=T[k]+b,f[_++]=T[k+1];b+=p[x].shape+.02}l=h[u]={data:f,shape:i}}return l};var t=v("vectorize-text"),n=window||e.global||{},a=n.__TEXT_CACHE||{};n.__TEXT_CACHE={}}).call(this)}).call(this,v("_process"))},{_process:5,"vectorize-text":311}],304:[function(v,w,y){var e=v("parse-unit");w.exports=n;function t(a,r){var g=e(getComputedStyle(a).getPropertyValue(r));return g[0]*n(g[1],a)}function n(a,r){switch(r=r||document.body,a=(a||"px").trim().toLowerCase(),r!==window&&r!==document||(r=document.body),a){case"%":return r.clientHeight/100;case"ch":case"ex":return function(g,u){var s=document.createElement("div");s.style["font-size"]="128"+g,u.appendChild(s);var h=t(s,"font-size")/128;return u.removeChild(s),h}(a,r);case"em":return t(r,"font-size");case"rem":return t(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":265}],305:[function(v,w,y){w.exports=function(c){var i=(c=c||{}).center||[0,0,0],x=c.up||[0,1,0],f=c.right||h(x),_=c.radius||1,b=c.theta||0,T=c.phi||0;if(i=[].slice.call(i,0,3),x=[].slice.call(x,0,3),r(x,x),f=[].slice.call(f,0,3),r(f,f),"eye"in c){var k=c.eye,L=[k[0]-i[0],k[1]-i[1],k[2]-i[2]];a(f,L,x),u(f[0],f[1],f[2])<1e-6?f=h(x):r(f,f),_=u(L[0],L[1],L[2]);var A=g(x,L)/_,I=g(f,L)/_;T=Math.acos(A),b=Math.acos(I)}return _=Math.log(_),new l(c.zoomMin,c.zoomMax,i,x,f,_,b,T)};var e=v("filtered-vector"),t=v("gl-mat4/invert"),n=v("gl-mat4/rotate"),a=v("gl-vec3/cross"),r=v("gl-vec3/normalize"),g=v("gl-vec3/dot");function u(c,i,x){return Math.sqrt(Math.pow(c,2)+Math.pow(i,2)+Math.pow(x,2))}function s(c){return Math.min(1,Math.max(-1,c))}function h(c){var i=Math.abs(c[0]),x=Math.abs(c[1]),f=Math.abs(c[2]),_=[0,0,0];i>Math.max(x,f)?_[2]=1:x>Math.max(i,f)?_[0]=1:_[1]=1;for(var b=0,T=0,k=0;k<3;++k)b+=c[k]*c[k],T+=_[k]*c[k];for(k=0;k<3;++k)_[k]-=T/b*c[k];return r(_,_),_}function l(c,i,x,f,_,b,T,k){this.center=e(x),this.up=e(f),this.right=e(_),this.radius=e([b]),this.angle=e([T,k]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(c,i),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var o=l.prototype;o.setDistanceLimits=function(c,i){c=c>0?Math.log(c):-1/0,i=i>0?Math.log(i):1/0,i=Math.max(i,c),this.radius.bounds[0][0]=c,this.radius.bounds[1][0]=i},o.getDistanceLimits=function(c){var i=this.radius.bounds[0];return c?(c[0]=Math.exp(i[0][0]),c[1]=Math.exp(i[1][0]),c):[Math.exp(i[0][0]),Math.exp(i[1][0])]},o.recalcMatrix=function(c){this.center.curve(c),this.up.curve(c),this.right.curve(c),this.radius.curve(c),this.angle.curve(c);for(var i=this.computedUp,x=this.computedRight,f=0,_=0,b=0;b<3;++b)_+=i[b]*x[b],f+=i[b]*i[b];var T=Math.sqrt(f),k=0;for(b=0;b<3;++b)x[b]-=i[b]*_/f,k+=x[b]*x[b],i[b]/=T;var L=Math.sqrt(k);for(b=0;b<3;++b)x[b]/=L;var A=this.computedToward;a(A,i,x),r(A,A);var I=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],S=this.computedAngle[1],E=Math.cos(P),z=Math.sin(P),D=Math.cos(S),j=Math.sin(S),V=this.computedCenter,Z=E*D,Q=z*D,K=j,$=-E*j,ne=-z*j,H=D,N=this.computedEye,U=this.computedMatrix;for(b=0;b<3;++b){var te=Z*x[b]+Q*A[b]+K*i[b];U[4*b+1]=$*x[b]+ne*A[b]+H*i[b],U[4*b+2]=te,U[4*b+3]=0}var B=U[1],X=U[5],J=U[9],ee=U[2],re=U[6],se=U[10],oe=X*se-J*re,de=J*ee-B*se,ce=B*re-X*ee,ve=u(oe,de,ce);for(oe/=ve,de/=ve,ce/=ve,U[0]=oe,U[4]=de,U[8]=ce,b=0;b<3;++b)N[b]=V[b]+U[2+4*b]*I;for(b=0;b<3;++b){k=0;for(var Ae=0;Ae<3;++Ae)k+=U[b+4*Ae]*N[Ae];U[12+b]=-k}U[15]=1},o.getMatrix=function(c,i){this.recalcMatrix(c);var x=this.computedMatrix;if(i){for(var f=0;f<16;++f)i[f]=x[f];return i}return x};var p=[0,0,0];o.rotate=function(c,i,x,f){if(this.angle.move(c,i,x),f){this.recalcMatrix(c);var _=this.computedMatrix;p[0]=_[2],p[1]=_[6],p[2]=_[10];for(var b=this.computedUp,T=this.computedRight,k=this.computedToward,L=0;L<3;++L)_[4*L]=b[L],_[4*L+1]=T[L],_[4*L+2]=k[L];for(n(_,_,f,p),L=0;L<3;++L)b[L]=_[4*L],T[L]=_[4*L+1];this.up.set(c,b[0],b[1],b[2]),this.right.set(c,T[0],T[1],T[2])}},o.pan=function(c,i,x,f){i=i||0,x=x||0,f=f||0,this.recalcMatrix(c);var _=this.computedMatrix,b=(Math.exp(this.computedRadius[0]),_[1]),T=_[5],k=_[9],L=u(b,T,k);b/=L,T/=L,k/=L;var A=_[0],I=_[4],P=_[8],S=A*b+I*T+P*k,E=u(A-=b*S,I-=T*S,P-=k*S),z=(A/=E)*i+b*x,D=(I/=E)*i+T*x,j=(P/=E)*i+k*x;this.center.move(c,z,D,j);var V=Math.exp(this.computedRadius[0]);V=Math.max(1e-4,V+f),this.radius.set(c,Math.log(V))},o.translate=function(c,i,x,f){this.center.move(c,i||0,x||0,f||0)},o.setMatrix=function(c,i,x,f){var _=1;typeof x=="number"&&(_=0|x),(_<0||_>3)&&(_=1);var b=(_+2)%3;i||(this.recalcMatrix(c),i=this.computedMatrix);var T=i[_],k=i[_+4],L=i[_+8];if(f){var A=Math.abs(T),I=Math.abs(k),P=Math.abs(L),S=Math.max(A,I,P);A===S?(T=T<0?-1:1,k=L=0):P===S?(L=L<0?-1:1,T=k=0):(k=k<0?-1:1,T=L=0)}else{var E=u(T,k,L);T/=E,k/=E,L/=E}var z,D,j=i[b],V=i[b+4],Z=i[b+8],Q=j*T+V*k+Z*L,K=u(j-=T*Q,V-=k*Q,Z-=L*Q),$=k*(Z/=K)-L*(V/=K),ne=L*(j/=K)-T*Z,H=T*V-k*j,N=u($,ne,H);if($/=N,ne/=N,H/=N,this.center.jump(c,le,ge,Te),this.radius.idle(c),this.up.jump(c,T,k,L),this.right.jump(c,j,V,Z),_===2){var U=i[1],te=i[5],B=i[9],X=U*j+te*V+B*Z,J=U*$+te*ne+B*H;z=oe<0?-Math.PI/2:Math.PI/2,D=Math.atan2(J,X)}else{var ee=i[2],re=i[6],se=i[10],oe=ee*T+re*k+se*L,de=ee*j+re*V+se*Z,ce=ee*$+re*ne+se*H;z=Math.asin(s(oe)),D=Math.atan2(ce,de)}this.angle.jump(c,D,z),this.recalcMatrix(c);var ve=i[2],Ae=i[6],fe=i[10],me=this.computedMatrix;t(me,i);var _e=me[15],le=me[12]/_e,ge=me[13]/_e,Te=me[14]/_e,Se=Math.exp(this.computedRadius[0]);this.center.jump(c,le-ve*Se,ge-Ae*Se,Te-fe*Se)},o.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},o.idle=function(c){this.center.idle(c),this.up.idle(c),this.right.idle(c),this.radius.idle(c),this.angle.idle(c)},o.flush=function(c){this.center.flush(c),this.up.flush(c),this.right.flush(c),this.radius.flush(c),this.angle.flush(c)},o.setDistance=function(c,i){i>0&&this.radius.set(c,Math.log(i))},o.lookAt=function(c,i,x,f){this.recalcMatrix(c),i=i||this.computedEye,x=x||this.computedCenter;var _=(f=f||this.computedUp)[0],b=f[1],T=f[2],k=u(_,b,T);if(!(k<1e-6)){_/=k,b/=k,T/=k;var L=i[0]-x[0],A=i[1]-x[1],I=i[2]-x[2],P=u(L,A,I);if(!(P<1e-6)){L/=P,A/=P,I/=P;var S=this.computedRight,E=S[0],z=S[1],D=S[2],j=_*E+b*z+T*D,V=u(E-=j*_,z-=j*b,D-=j*T);if(!(V<.01&&(V=u(E=b*I-T*A,z=T*L-_*I,D=_*A-b*L))<1e-6)){E/=V,z/=V,D/=V,this.up.set(c,_,b,T),this.right.set(c,E,z,D),this.center.set(c,x[0],x[1],x[2]),this.radius.set(c,Math.log(P));var Z=b*D-T*z,Q=T*E-_*D,K=_*z-b*E,$=u(Z,Q,K),ne=_*L+b*A+T*I,H=E*L+z*A+D*I,N=(Z/=$)*L+(Q/=$)*A+(K/=$)*I,U=Math.asin(s(ne)),te=Math.atan2(N,H),B=this.angle._state,X=B[B.length-1],J=B[B.length-2];X%=2*Math.PI;var ee=Math.abs(X+2*Math.PI-te),re=Math.abs(X-te),se=Math.abs(X-2*Math.PI-te);ee<re&&(X+=2*Math.PI),se<re&&(X-=2*Math.PI),this.angle.jump(this.angle.lastT(),X,J),this.angle.set(c,te,U)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(v,w,y){w.exports=function(t,n,a){var r=t*n,g=e*t,u=g-(g-t),s=t-u,h=e*n,l=h-(h-n),o=n-l,p=s*o-(r-u*l-s*l-u*o);return a?(a[0]=p,a[1]=r,a):[p,r]};var e=+(Math.pow(2,27)+1)},{}],307:[function(v,w,y){w.exports=function(e,t,n){var a=e+t,r=a-e,g=t-r,u=e-(a-r);return n?(n[0]=u+g,n[1]=a,n):[u+g,a]}},{}],308:[function(v,w,y){(function(e){(function(){var t=v("bit-twiddle"),n=v("dup"),a=v("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var r=typeof Uint8ClampedArray<"u",g=typeof BigUint64Array<"u",u=typeof BigInt64Array<"u",s=e.__TYPEDARRAY_POOL;s.UINT8C||(s.UINT8C=n([32,0])),s.BIGUINT64||(s.BIGUINT64=n([32,0])),s.BIGINT64||(s.BIGINT64=n([32,0])),s.BUFFER||(s.BUFFER=n([32,0]));var h=s.DATA,l=s.BUFFER;function o(E){if(E){var z=E.length||E.byteLength,D=t.log2(z);h[D].push(E)}}function p(E){E=t.nextPow2(E);var z=t.log2(E),D=h[z];return D.length>0?D.pop():new ArrayBuffer(E)}function c(E){return new Uint8Array(p(E),0,E)}function i(E){return new Uint16Array(p(2*E),0,E)}function x(E){return new Uint32Array(p(4*E),0,E)}function f(E){return new Int8Array(p(E),0,E)}function _(E){return new Int16Array(p(2*E),0,E)}function b(E){return new Int32Array(p(4*E),0,E)}function T(E){return new Float32Array(p(4*E),0,E)}function k(E){return new Float64Array(p(8*E),0,E)}function L(E){return r?new Uint8ClampedArray(p(E),0,E):c(E)}function A(E){return g?new BigUint64Array(p(8*E),0,E):null}function I(E){return u?new BigInt64Array(p(8*E),0,E):null}function P(E){return new DataView(p(E),0,E)}function S(E){E=t.nextPow2(E);var z=t.log2(E),D=l[z];return D.length>0?D.pop():new a(E)}y.free=function(E){if(a.isBuffer(E))l[t.log2(E.length)].push(E);else{if(Object.prototype.toString.call(E)!=="[object ArrayBuffer]"&&(E=E.buffer),!E)return;var z=E.length||E.byteLength,D=0|t.log2(z);h[D].push(E)}},y.freeUint8=y.freeUint16=y.freeUint32=y.freeBigUint64=y.freeInt8=y.freeInt16=y.freeInt32=y.freeBigInt64=y.freeFloat32=y.freeFloat=y.freeFloat64=y.freeDouble=y.freeUint8Clamped=y.freeDataView=function(E){o(E.buffer)},y.freeArrayBuffer=o,y.freeBuffer=function(E){l[t.log2(E.length)].push(E)},y.malloc=function(E,z){if(z===void 0||z==="arraybuffer")return p(E);switch(z){case"uint8":return c(E);case"uint16":return i(E);case"uint32":return x(E);case"int8":return f(E);case"int16":return _(E);case"int32":return b(E);case"float":case"float32":return T(E);case"double":case"float64":return k(E);case"uint8_clamped":return L(E);case"bigint64":return I(E);case"biguint64":return A(E);case"buffer":return S(E);case"data":case"dataview":return P(E);default:return null}return null},y.mallocArrayBuffer=p,y.mallocUint8=c,y.mallocUint16=i,y.mallocUint32=x,y.mallocInt8=f,y.mallocInt16=_,y.mallocInt32=b,y.mallocFloat32=y.mallocFloat=T,y.mallocFloat64=y.mallocDouble=k,y.mallocUint8Clamped=L,y.mallocBigUint64=A,y.mallocBigInt64=I,y.mallocDataView=P,y.mallocBuffer=S,y.clearCache=function(){for(var E=0;E<32;++E)s.UINT8[E].length=0,s.UINT16[E].length=0,s.UINT32[E].length=0,s.INT8[E].length=0,s.INT16[E].length=0,s.INT32[E].length=0,s.FLOAT[E].length=0,s.DOUBLE[E].length=0,s.BIGUINT64[E].length=0,s.BIGINT64[E].length=0,s.UINT8C[E].length=0,h[E].length=0,l[E].length=0}}).call(this)}).call(this,d!==void 0?d:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(v,w,y){function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var a=0;a<n;++a)this.roots[a]=a,this.ranks[a]=0}w.exports=e;var t=e.prototype;Object.defineProperty(t,"length",{get:function(){return this.roots.length}}),t.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},t.find=function(n){for(var a=n,r=this.roots;r[n]!==n;)n=r[n];for(;r[a]!==n;){var g=r[a];r[a]=n,a=g}return n},t.link=function(n,a){var r=this.find(n),g=this.find(a);if(r!==g){var u=this.ranks,s=this.roots,h=u[r],l=u[g];h<l?s[r]=g:l<h?s[g]=r:(s[g]=r,++u[r])}}},{}],310:[function(v,w,y){w.exports=function(e,t,n){return e.length===0?e:t?(n||e.sort(t),function(a,r){for(var g=1,u=a.length,s=a[0],h=a[0],l=1;l<u;++l)if(h=s,r(s=a[l],h)){if(l===g){g++;continue}a[g++]=s}return a.length=g,a}(e,t)):(n||e.sort(),function(a){for(var r=1,g=a.length,u=a[0],s=a[0],h=1;h<g;++h,s=u)if(s=u,(u=a[h])!==s){if(h===r){r++;continue}a[r++]=u}return a.length=r,a}(e))}},{}],311:[function(v,w,y){w.exports=function(a,r){return typeof r=="object"&&r!==null||(r={}),e(a,r.canvas||t,r.context||n,r)};var e=v("./lib/vtext"),t=null,n=null;typeof document<"u"&&((t=document.createElement("canvas")).width=8192,t.height=1024,n=t.getContext("2d"))},{"./lib/vtext":312}],312:[function(v,w,y){w.exports=function(o,p,c,i){var x=64,f=1.25,_={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return i&&(i.size&&i.size>0&&(x=i.size),i.lineSpacing&&i.lineSpacing>0&&(f=i.lineSpacing),i.styletags&&i.styletags.breaklines&&(_.breaklines=!!i.styletags.breaklines),i.styletags&&i.styletags.bolds&&(_.bolds=!!i.styletags.bolds),i.styletags&&i.styletags.italics&&(_.italics=!!i.styletags.italics),i.styletags&&i.styletags.subscripts&&(_.subscripts=!!i.styletags.subscripts),i.styletags&&i.styletags.superscripts&&(_.superscripts=!!i.styletags.superscripts)),c.font=[i.fontStyle,i.fontVariant,i.fontWeight,x+"px",i.font].filter(function(b){return b}).join(" "),c.textAlign="start",c.textBaseline="alphabetic",c.direction="ltr",l(function(b,T,k,L,A,I){k=k.replace(/\n/g,""),k=I.breaklines===!0?k.replace(/\<br\>/g,`
`):k.replace(/\<br\>/g," ");var P="",S=[];for(j=0;j<k.length;++j)S[j]=P;I.bolds===!0&&(S=u("b","b|",k,S)),I.italics===!0&&(S=u("i","i|",k,S)),I.superscripts===!0&&(S=u("sup","+1",k,S)),I.subscripts===!0&&(S=u("sub","-1",k,S));var E=[],z="";for(j=0;j<k.length;++j)S[j]!==null&&(z+=k[j],E.push(S[j]));var D,j,V,Z,Q,K=z.split(`
`),$=K.length,ne=Math.round(A*L),H=L,N=2*L,U=0,te=$*ne+N;b.height<te&&(b.height=te),T.fillStyle="#000",T.fillRect(0,0,b.width,b.height),T.fillStyle="#fff";var B=0,X="";function J(){if(X!==""){var Ae=T.measureText(X).width;T.fillText(X,H+V,N+Z),V+=Ae}}function ee(){return Math.round(Q)+"px "}function re(Ae,fe){var me=""+T.font;if(I.subscripts===!0){var _e=Ae.indexOf("-"),le=fe.indexOf("-"),ge=_e>-1?parseInt(Ae[1+_e]):0,Te=le>-1?parseInt(fe[1+le]):0;ge!==Te&&(me=me.replace(ee(),"?px "),Q*=Math.pow(.75,Te-ge),me=me.replace("?px ",ee())),Z+=.25*ne*(Te-ge)}if(I.superscripts===!0){var Se=Ae.indexOf("+"),Me=fe.indexOf("+"),ze=Se>-1?parseInt(Ae[1+Se]):0,Oe=Me>-1?parseInt(fe[1+Me]):0;ze!==Oe&&(me=me.replace(ee(),"?px "),Q*=Math.pow(.75,Oe-ze),me=me.replace("?px ",ee())),Z-=.25*ne*(Oe-ze)}if(I.bolds===!0){var De=Ae.indexOf("b|")>-1,Xe=fe.indexOf("b|")>-1;!De&&Xe&&(me=Be?me.replace("italic ","italic bold "):"bold "+me),De&&!Xe&&(me=me.replace("bold ",""))}if(I.italics===!0){var Be=Ae.indexOf("i|")>-1,Ie=fe.indexOf("i|")>-1;!Be&&Ie&&(me="italic "+me),Be&&!Ie&&(me=me.replace("italic ",""))}T.font=me}for(D=0;D<$;++D){var se=K[D]+`
`;for(V=0,Z=D*ne,Q=L,X="",j=0;j<se.length;++j){var oe=j+B<E.length?E[j+B]:E[E.length-1];P===oe?X+=se[j]:(J(),X=se[j],oe!==void 0&&(re(P,oe),P=oe))}J(),B+=se.length;var de=0|Math.round(V+2*H);U<de&&(U=de)}var ce=U,ve=N+ne*$;return t(T.getImageData(0,0,ce,ve).data,[ve,ce,4]).pick(-1,-1,0).transpose(1,0)}(p,c,o,x,f,_),i,x)},w.exports.processPixels=l;var e=v("surface-nets"),t=v("ndarray"),n=v("simplify-planar-graph"),a=v("clean-pslg"),r=v("cdt2d"),g=v("planar-graph-to-polyline");function u(o,p,c,i){for(var x="<"+o+">",f="</"+o+">",_=x.length,b=f.length,T=p[0]==="+"||p[0]==="-",k=0,L=-b;k>-1&&(k=c.indexOf(x,k))!==-1&&(L=c.indexOf(f,k+_))!==-1&&!(L<=k);){for(var A=k;A<L+b;++A)if(A<k+_||A>=L)i[A]=null,c=c.substr(0,A)+" "+c.substr(A+1);else if(i[A]!==null){var I=i[A].indexOf(p[0]);I===-1?i[A]+=p:T&&(i[A]=i[A].substr(0,I+1)+(1+parseInt(i[A][I+1]))+i[A].substr(I+2))}var P=k+_,S=c.substr(P,L-P).indexOf(x);k=S!==-1?S:L+b}return i}function s(o,p){var c=e(o,128);return p?n(c.cells,c.positions,.25):{edges:c.cells,positions:c.positions}}function h(o,p,c,i){var x=s(o,i),f=function(D,j,V){for(var Z=j.textAlign||"start",Q=j.textBaseline||"alphabetic",K=[1<<30,1<<30],$=[0,0],ne=D.length,H=0;H<ne;++H)for(var N=D[H],U=0;U<2;++U)K[U]=0|Math.min(K[U],N[U]),$[U]=0|Math.max($[U],N[U]);var te=0;switch(Z){case"center":te=-.5*(K[0]+$[0]);break;case"right":case"end":te=-$[0];break;case"left":case"start":te=-K[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+Z+"'")}var B=0;switch(Q){case"hanging":case"top":B=-K[1];break;case"middle":B=-.5*(K[1]+$[1]);break;case"alphabetic":case"ideographic":B=-3*V;break;case"bottom":B=-$[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+Q+"'")}var X=1/V;return"lineHeight"in j?X*=+j.lineHeight:"width"in j?X=j.width/($[0]-K[0]):"height"in j&&(X=j.height/($[1]-K[1])),D.map(function(J){return[X*(J[0]+te),X*(J[1]+B)]})}(x.positions,p,c),_=x.edges,b=p.orientation==="ccw";if(a(f,_),p.polygons||p.polygon||p.polyline){for(var T=g(_,f),k=new Array(T.length),L=0;L<T.length;++L){for(var A=T[L],I=new Array(A.length),P=0;P<A.length;++P){for(var S=A[P],E=new Array(S.length),z=0;z<S.length;++z)E[z]=f[S[z]].slice();b&&E.reverse(),I[P]=E}k[L]=I}return k}return p.triangles||p.triangulate||p.triangle?{cells:r(f,_,{delaunay:!1,exterior:!1,interior:!0}),positions:f}:{edges:_,positions:f}}function l(o,p,c){try{return h(o,p,c,!0)}catch{}try{return h(o,p,c,!1)}catch{}return p.polygons||p.polyline||p.polygon?[]:p.triangles||p.triangulate||p.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(v,w,y){(function(){if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=x);var e=!1;if(typeof WeakMap=="function"){var t=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var n=new t,a=Object.freeze({});if(n.set(a,1),n.get(a)===1)return void(w.exports=WeakMap);e=!0}}var r=Object.getOwnPropertyNames,g=Object.defineProperty,u=Object.isExtensible,s="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var h=new ArrayBuffer(25),l=new Uint8Array(h);crypto.getRandomValues(l),s="weakmap:rand:"+Array.prototype.map.call(l,function(k){return(k%36).toString(36)}).join("")+"___"}if(g(Object,"getOwnPropertyNames",{value:function(k){return r(k).filter(f)}}),"getPropertyNames"in Object){var o=Object.getPropertyNames;g(Object,"getPropertyNames",{value:function(k){return o(k).filter(f)}})}(function(){var k=Object.freeze;g(Object,"freeze",{value:function(I){return _(I),k(I)}});var L=Object.seal;g(Object,"seal",{value:function(I){return _(I),L(I)}});var A=Object.preventExtensions;g(Object,"preventExtensions",{value:function(I){return _(I),A(I)}})})();var p=!1,c=0,i=function(){this instanceof i||T();var k=[],L=[],A=c++;return Object.create(i.prototype,{get___:{value:b(function(I,P){var S,E=_(I);return E?A in E?E[A]:P:(S=k.indexOf(I))>=0?L[S]:P})},has___:{value:b(function(I){var P=_(I);return P?A in P:k.indexOf(I)>=0})},set___:{value:b(function(I,P){var S,E=_(I);return E?E[A]=P:(S=k.indexOf(I))>=0?L[S]=P:(S=k.length,L[S]=P,k[S]=I),this})},delete___:{value:b(function(I){var P,S,E=_(I);return E?A in E&&delete E[A]:!((P=k.indexOf(I))<0)&&(S=k.length-1,k[P]=void 0,L[P]=L[S],k[P]=k[S],k.length=S,L.length=S,!0)})}})};i.prototype=Object.create(Object.prototype,{get:{value:function(k,L){return this.get___(k,L)},writable:!0,configurable:!0},has:{value:function(k){return this.has___(k)},writable:!0,configurable:!0},set:{value:function(k,L){return this.set___(k,L)},writable:!0,configurable:!0},delete:{value:function(k){return this.delete___(k)},writable:!0,configurable:!0}}),typeof t=="function"?function(){function k(){this instanceof i||T();var L,A=new t,I=void 0,P=!1;return L=e?function(S,E){return A.set(S,E),A.has(S)||(I||(I=new i),I.set(S,E)),this}:function(S,E){if(P)try{A.set(S,E)}catch{I||(I=new i),I.set___(S,E)}else A.set(S,E);return this},Object.create(i.prototype,{get___:{value:b(function(S,E){return I?A.has(S)?A.get(S):I.get___(S,E):A.get(S,E)})},has___:{value:b(function(S){return A.has(S)||!!I&&I.has___(S)})},set___:{value:b(L)},delete___:{value:b(function(S){var E=!!A.delete(S);return I&&I.delete___(S)||E})},permitHostObjects___:{value:b(function(S){if(S!==x)throw new Error("bogus call to permitHostObjects___");P=!0})}})}e&&typeof Proxy<"u"&&(Proxy=void 0),k.prototype=i.prototype,w.exports=k,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),w.exports=i)}function x(k){k.permitHostObjects___&&k.permitHostObjects___(x)}function f(k){return!(k.substr(0,8)=="weakmap:"&&k.substr(k.length-3)==="___")}function _(k){if(k!==Object(k))throw new TypeError("Not an object: "+k);var L=k[s];if(L&&L.key===k)return L;if(u(k)){L={key:k};try{return g(k,s,{value:L,writable:!1,enumerable:!1,configurable:!1}),L}catch{return}}}function b(k){return k.prototype=null,Object.freeze(k)}function T(){p||typeof console>"u"||(p=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],314:[function(v,w,y){var e=v("./hidden-store.js");w.exports=function(){var t={};return function(n){if((typeof n!="object"||n===null)&&typeof n!="function")throw new Error("Weakmap-shim: Key must be object");var a=n.valueOf(t);return a&&a.identity===t?a:e(n,t)}}},{"./hidden-store.js":315}],315:[function(v,w,y){w.exports=function(e,t){var n={identity:t},a=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(r){return r!==t?a.apply(this,arguments):n},writable:!0}),n}},{}],316:[function(v,w,y){var e=v("./create-store.js");w.exports=function(){var t=e();return{get:function(n,a){var r=t(n);return r.hasOwnProperty("value")?r.value:a},set:function(n,a){return t(n).value=a,this},has:function(n){return"value"in t(n)},delete:function(n){return delete t(n).value}}}},{"./create-store.js":314}],317:[function(v,w,y){var e,t=function(){return function(n,a,r,g,u,s){var h=n[0],l=r[0],o=[0],p=l;g|=0;var c=0,i=l;for(c=0;c<h;++c){var x=a[g]-s,f=a[g+p]-s;x>=0!=f>=0&&u.push(o[0]+.5+.5*(x+f)/(x-f)),g+=i,++o[0]}}};w.exports=(e={funcName:"zeroCrossings"},function(n){var a={};return function(r,g,u){var s=r.dtype,h=r.order,l=[s,h.join()].join(),o=a[l];return o||(a[l]=o=n([s,h])),o(r.shape.slice(0),r.data,r.stride,0|r.offset,g,u)}}(t.bind(void 0,e)))},{}],318:[function(v,w,y){w.exports=function(t,n){var a=[];return n=+n||0,e(t.hi(t.shape[0]-1),a,n),a};var e=v("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(nm);const Ah=Ay(nm.exports);const Sy={data:function(){return{count:0,data:[{x:[1,2,3,4],y:[10,15,13,17],type:"scatter"}],attr:{displayModeBar:!0},layout:{title:"My graph :)"}}},methods:{button_click_func:function(){console.log("Clicked the button: "+this.count," y[0] = ",this.data[0].y[0]),this.count+=1,this.data[0].y[0]+=1,Ah.newPlot(this.$refs.plot1,this.data)}},mounted(){Ah.newPlot(this.$refs.plot1,this.data)},watch:{chart:{handler:function(){Ah.react(this.$refs.plot1,this.data)},deep:!0}}},Ey=Pe=>(z0("data-v-f4a5412b"),Pe=Pe(),R0(),Pe),Ly=Ey(()=>uc("div",{class:"text"}," some text ",-1)),Cy={ref:"plot1",id:"plot1"};function Py(Pe,et,m,G,W,d){return lp(),cp(Js,null,[Ly,uc("div",Cy,null,512),uc("button",{onClick:et[0]||(et[0]=(...v)=>d.button_click_func&&d.button_click_func(...v))},"nfdsjkf")],64)}const Iy=Of(Sy,[["render",Py],["__scopeId","data-v-f4a5412b"]]);const Oy={__name:"App",setup(Pe){return(et,m)=>(lp(),cp("main",null,[tl(yy),tl(My),tl(Iy)]))}},Dy=Of(Oy,[["__scopeId","data-v-2fb0c2a8"]]);cy(Dy).mount("#app");
